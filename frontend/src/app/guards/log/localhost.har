{
  "log": {
    "version": "1.2",
    "creator": {
      "name": "WebInspector",
      "version": "537.36"
    },
    "pages": [
      {
        "startedDateTime": "2026-02-09T00:51:09.302Z",
        "id": "page_46",
        "title": "https://accounts.google.com/ServiceLogin?app_domain=http%3A%2F%2Flocalhost%3A3333&authuser=0&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3Dunknown%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%23&dsh=S-603273572%3A1770598265735725&flowName=GeneralOAuthFlow&o2v=2&opparams=%253F&passive=true&redirect_uri=http%3A%2F%2Flocalhost%3A3333%2Fauth%2Fgoogle%2Fcallback&response_type=code&sacu=1&scope=openid%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile&service=lso&state=cIRToIhaP1iDSZunNohFrrdNUCUmPLb6",
        "pageTimings": {
          "onContentLoad": 1023.6390000209212,
          "onLoad": 1023.8569999928586
        }
      }
    ],
    "entries": [
      {
        "_connectionId": "15502",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "443",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "https://accounts.google.com/ServiceLogin?app_domain=http%3A%2F%2Flocalhost%3A3333&authuser=0&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3Dunknown%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%23&dsh=S-603273572%3A1770598265735725&flowName=GeneralOAuthFlow&o2v=2&opparams=%253F&passive=true&redirect_uri=http%3A%2F%2Flocalhost%3A3333%2Fauth%2Fgoogle%2Fcallback&response_type=code&sacu=1&scope=openid%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile&service=lso&state=cIRToIhaP1iDSZunNohFrrdNUCUmPLb6",
          "httpVersion": "h3",
          "headers": [
            {
              "name": ":authority",
              "value": "accounts.google.com"
            },
            {
              "name": ":method",
              "value": "GET"
            },
            {
              "name": ":path",
              "value": "/ServiceLogin?app_domain=http%3A%2F%2Flocalhost%3A3333&authuser=0&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3Dunknown%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%23&dsh=S-603273572%3A1770598265735725&flowName=GeneralOAuthFlow&o2v=2&opparams=%253F&passive=true&redirect_uri=http%3A%2F%2Flocalhost%3A3333%2Fauth%2Fgoogle%2Fcallback&response_type=code&sacu=1&scope=openid%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile&service=lso&state=cIRToIhaP1iDSZunNohFrrdNUCUmPLb6"
            },
            {
              "name": ":scheme",
              "value": "https"
            },
            {
              "name": "accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "accept-encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "accept-language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "priority",
              "value": "u=0, i"
            },
            {
              "name": "referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-arch",
              "value": "\"x86\""
            },
            {
              "name": "sec-ch-ua-bitness",
              "value": "\"64\""
            },
            {
              "name": "sec-ch-ua-form-factors",
              "value": "\"Desktop\""
            },
            {
              "name": "sec-ch-ua-full-version",
              "value": "\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-full-version-list",
              "value": "\"Not(A:Brand\";v=\"8.0.0.0\", \"Chromium\";v=\"144.0.7559.133\", \"Google Chrome\";v=\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-model",
              "value": "\"\""
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-ch-ua-platform-version",
              "value": "\"19.0.0\""
            },
            {
              "name": "sec-ch-ua-wow64",
              "value": "?0"
            },
            {
              "name": "sec-fetch-dest",
              "value": "document"
            },
            {
              "name": "sec-fetch-mode",
              "value": "navigate"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-origin"
            },
            {
              "name": "sec-fetch-user",
              "value": "?1"
            },
            {
              "name": "upgrade-insecure-requests",
              "value": "1"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "x-browser-channel",
              "value": "stable"
            },
            {
              "name": "x-browser-copyright",
              "value": "Copyright 2026 Google LLC. All Rights reserved."
            },
            {
              "name": "x-browser-validation",
              "value": "mbKdpV8Df6MeX3t+QoahfSgokv4="
            },
            {
              "name": "x-browser-year",
              "value": "2026"
            },
            {
              "name": "x-chrome-id-consistency-request",
              "value": "version=1,client_id=77185425430.apps.googleusercontent.com,device_id=0450851c-0513-40fb-b152-8c0d366de6b3,sync_account_id=100149859665997612966,signin_mode=all_accounts,signout_mode=show_confirmation"
            },
            {
              "name": "x-client-data",
              "value": "CP38ygE="
            }
          ],
          "queryString": [
            {
              "name": "app_domain",
              "value": "http%3A%2F%2Flocalhost%3A3333"
            },
            {
              "name": "authuser",
              "value": "0"
            },
            {
              "name": "client_id",
              "value": "939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com"
            },
            {
              "name": "continue",
              "value": "https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3Dunknown%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%23"
            },
            {
              "name": "dsh",
              "value": "S-603273572%3A1770598265735725"
            },
            {
              "name": "flowName",
              "value": "GeneralOAuthFlow"
            },
            {
              "name": "o2v",
              "value": "2"
            },
            {
              "name": "opparams",
              "value": "%253F"
            },
            {
              "name": "passive",
              "value": "true"
            },
            {
              "name": "redirect_uri",
              "value": "http%3A%2F%2Flocalhost%3A3333%2Fauth%2Fgoogle%2Fcallback"
            },
            {
              "name": "response_type",
              "value": "code"
            },
            {
              "name": "sacu",
              "value": "1"
            },
            {
              "name": "scope",
              "value": "openid%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile"
            },
            {
              "name": "service",
              "value": "lso"
            },
            {
              "name": "state",
              "value": "cIRToIhaP1iDSZunNohFrrdNUCUmPLb6"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "",
          "httpVersion": "h3",
          "headers": [
            {
              "name": "accept-ch",
              "value": "Sec-CH-UA-Arch, Sec-CH-UA-Bitness, Sec-CH-UA-Full-Version, Sec-CH-UA-Full-Version-List, Sec-CH-UA-Model, Sec-CH-UA-WoW64, Sec-CH-UA-Form-Factors, Sec-CH-UA-Platform, Sec-CH-UA-Platform-Version"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            },
            {
              "name": "cache-control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "name": "content-length",
              "value": "0"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'report-sample' 'nonce-2LkDqQQXQjmXCyd9pJRRsA' 'unsafe-inline';object-src 'none';base-uri 'self';report-uri /_/AccountsSigninPassiveLoginHttp/cspreport;worker-src 'self'"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'unsafe-inline' 'unsafe-eval' blob: data: 'self' https://apis.google.com https://ssl.gstatic.com https://www.google.com https://www.googletagmanager.com https://www.gstatic.com https://www.google-analytics.com;report-uri /_/AccountsSigninPassiveLoginHttp/cspreport/allowlist"
            },
            {
              "name": "content-security-policy",
              "value": "require-trusted-types-for 'script';report-uri /_/AccountsSigninPassiveLoginHttp/cspreport"
            },
            {
              "name": "content-type",
              "value": "application/binary"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "unsafe-none"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "cross-origin"
            },
            {
              "name": "date",
              "value": "Mon, 09 Feb 2026 00:51:07 GMT"
            },
            {
              "name": "expires",
              "value": "Mon, 01 Jan 1990 00:00:00 GMT"
            },
            {
              "name": "location",
              "value": "https://accounts.google.com/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572:1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=/signin/oauth/consent&pli=1#"
            },
            {
              "name": "permissions-policy",
              "value": "ch-ua-arch=*, ch-ua-bitness=*, ch-ua-full-version=*, ch-ua-full-version-list=*, ch-ua-model=*, ch-ua-wow64=*, ch-ua-form-factors=*, ch-ua-platform=*, ch-ua-platform-version=*"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "server",
              "value": "ESF"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-xss-protection",
              "value": "0"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "application/binary"
          },
          "redirectURL": "https://accounts.google.com/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572:1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=/signin/oauth/consent&pli=1#",
          "headersSize": -1,
          "bodySize": -1,
          "_transferSize": 38,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[2a00:1450:400c:c0b::54]",
        "startedDateTime": "2026-02-09T00:51:09.301Z",
        "time": 52.155999990645796,
        "timings": {
          "blocked": 1.6289999679774045,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.3540000000000001,
          "wait": 48.7190000106506,
          "receive": 1.4540000120177865,
          "_blocked_queueing": 1.0659999679774046,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "15502",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "443",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "https://accounts.google.com/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572:1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=/signin/oauth/consent&pli=1",
          "httpVersion": "h3",
          "headers": [
            {
              "name": ":authority",
              "value": "accounts.google.com"
            },
            {
              "name": ":method",
              "value": "GET"
            },
            {
              "name": ":path",
              "value": "/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572:1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=/signin/oauth/consent&pli=1"
            },
            {
              "name": ":scheme",
              "value": "https"
            },
            {
              "name": "accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "accept-encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "accept-language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "priority",
              "value": "u=0, i"
            },
            {
              "name": "referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-arch",
              "value": "\"x86\""
            },
            {
              "name": "sec-ch-ua-bitness",
              "value": "\"64\""
            },
            {
              "name": "sec-ch-ua-form-factors",
              "value": "\"Desktop\""
            },
            {
              "name": "sec-ch-ua-full-version",
              "value": "\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-full-version-list",
              "value": "\"Not(A:Brand\";v=\"8.0.0.0\", \"Chromium\";v=\"144.0.7559.133\", \"Google Chrome\";v=\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-model",
              "value": "\"\""
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-ch-ua-platform-version",
              "value": "\"19.0.0\""
            },
            {
              "name": "sec-ch-ua-wow64",
              "value": "?0"
            },
            {
              "name": "sec-fetch-dest",
              "value": "document"
            },
            {
              "name": "sec-fetch-mode",
              "value": "navigate"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-origin"
            },
            {
              "name": "sec-fetch-user",
              "value": "?1"
            },
            {
              "name": "upgrade-insecure-requests",
              "value": "1"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "x-browser-channel",
              "value": "stable"
            },
            {
              "name": "x-browser-copyright",
              "value": "Copyright 2026 Google LLC. All Rights reserved."
            },
            {
              "name": "x-browser-validation",
              "value": "mbKdpV8Df6MeX3t+QoahfSgokv4="
            },
            {
              "name": "x-browser-year",
              "value": "2026"
            },
            {
              "name": "x-chrome-id-consistency-request",
              "value": "version=1,client_id=77185425430.apps.googleusercontent.com,device_id=0450851c-0513-40fb-b152-8c0d366de6b3,sync_account_id=100149859665997612966,signin_mode=all_accounts,signout_mode=show_confirmation"
            },
            {
              "name": "x-client-data",
              "value": "CP38ygE="
            }
          ],
          "queryString": [
            {
              "name": "authuser",
              "value": "0"
            },
            {
              "name": "part",
              "value": "AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg"
            },
            {
              "name": "flowName",
              "value": "GeneralOAuthFlow"
            },
            {
              "name": "as",
              "value": "S-603273572:1770598265735725"
            },
            {
              "name": "client_id",
              "value": "939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com"
            },
            {
              "name": "requestPath",
              "value": "/signin/oauth/consent"
            },
            {
              "name": "pli",
              "value": "1"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "",
          "httpVersion": "h3",
          "headers": [
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            },
            {
              "name": "cache-control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "name": "content-encoding",
              "value": "gzip"
            },
            {
              "name": "content-length",
              "value": "899"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'report-sample' 'nonce-sxvJM4XonbodiaoH1vcqrA' 'unsafe-inline' 'unsafe-eval';object-src 'none';base-uri 'self';report-uri /cspreport"
            },
            {
              "name": "content-security-policy",
              "value": "require-trusted-types-for 'script';report-uri /cspreport"
            },
            {
              "name": "content-type",
              "value": "text/html; charset=UTF-8"
            },
            {
              "name": "cross-origin-opener-policy-report-only",
              "value": "same-origin; report-to=\"coop_gse_qebhlk\""
            },
            {
              "name": "date",
              "value": "Mon, 09 Feb 2026 00:51:07 GMT"
            },
            {
              "name": "expires",
              "value": "Mon, 01 Jan 1990 00:00:00 GMT"
            },
            {
              "name": "location",
              "value": "https://accounts.google.com/ServiceLogin?rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&authuser=0"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "report-to",
              "value": "{\"group\":\"coop_gse_qebhlk\",\"max_age\":2592000,\"endpoints\":[{\"url\":\"https://csp.withgoogle.com/csp/report-to/gse_qebhlk\"}]}"
            },
            {
              "name": "server",
              "value": "GSE"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "vary",
              "value": "Sec-Fetch-Dest, Sec-Fetch-Mode, Sec-Fetch-Site"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-frame-options",
              "value": "DENY"
            },
            {
              "name": "x-xss-protection",
              "value": "1; mode=block"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "text/html"
          },
          "redirectURL": "https://accounts.google.com/ServiceLogin?rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&authuser=0",
          "headersSize": -1,
          "bodySize": -1,
          "_transferSize": 43,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[2a00:1450:400c:c0b::54]",
        "startedDateTime": "2026-02-09T00:51:09.353Z",
        "time": 67.33499997062609,
        "timings": {
          "blocked": 1.2919999826550483,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.357,
          "wait": 64.40799997732789,
          "receive": 1.2780000106431544,
          "_blocked_queueing": 0.7009999826550484,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "15502",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "443",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "https://accounts.google.com/ServiceLogin?rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&authuser=0",
          "httpVersion": "h3",
          "headers": [
            {
              "name": ":authority",
              "value": "accounts.google.com"
            },
            {
              "name": ":method",
              "value": "GET"
            },
            {
              "name": ":path",
              "value": "/ServiceLogin?rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&authuser=0"
            },
            {
              "name": ":scheme",
              "value": "https"
            },
            {
              "name": "accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "accept-encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "accept-language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "priority",
              "value": "u=0, i"
            },
            {
              "name": "referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-arch",
              "value": "\"x86\""
            },
            {
              "name": "sec-ch-ua-bitness",
              "value": "\"64\""
            },
            {
              "name": "sec-ch-ua-form-factors",
              "value": "\"Desktop\""
            },
            {
              "name": "sec-ch-ua-full-version",
              "value": "\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-full-version-list",
              "value": "\"Not(A:Brand\";v=\"8.0.0.0\", \"Chromium\";v=\"144.0.7559.133\", \"Google Chrome\";v=\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-model",
              "value": "\"\""
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-ch-ua-platform-version",
              "value": "\"19.0.0\""
            },
            {
              "name": "sec-ch-ua-wow64",
              "value": "?0"
            },
            {
              "name": "sec-fetch-dest",
              "value": "document"
            },
            {
              "name": "sec-fetch-mode",
              "value": "navigate"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-origin"
            },
            {
              "name": "sec-fetch-user",
              "value": "?1"
            },
            {
              "name": "upgrade-insecure-requests",
              "value": "1"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "x-browser-channel",
              "value": "stable"
            },
            {
              "name": "x-browser-copyright",
              "value": "Copyright 2026 Google LLC. All Rights reserved."
            },
            {
              "name": "x-browser-validation",
              "value": "mbKdpV8Df6MeX3t+QoahfSgokv4="
            },
            {
              "name": "x-browser-year",
              "value": "2026"
            },
            {
              "name": "x-chrome-id-consistency-request",
              "value": "version=1,client_id=77185425430.apps.googleusercontent.com,device_id=0450851c-0513-40fb-b152-8c0d366de6b3,sync_account_id=100149859665997612966,signin_mode=all_accounts,signout_mode=show_confirmation"
            },
            {
              "name": "x-client-data",
              "value": "CP38ygE="
            }
          ],
          "queryString": [
            {
              "name": "rart",
              "value": "ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8"
            },
            {
              "name": "continue",
              "value": "https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1"
            },
            {
              "name": "authuser",
              "value": "0"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "",
          "httpVersion": "h3",
          "headers": [
            {
              "name": "accept-ch",
              "value": "Sec-CH-UA-Arch, Sec-CH-UA-Bitness, Sec-CH-UA-Full-Version, Sec-CH-UA-Full-Version-List, Sec-CH-UA-Model, Sec-CH-UA-WoW64, Sec-CH-UA-Form-Factors, Sec-CH-UA-Platform, Sec-CH-UA-Platform-Version"
            },
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            },
            {
              "name": "cache-control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "name": "content-length",
              "value": "0"
            },
            {
              "name": "content-security-policy",
              "value": "require-trusted-types-for 'script';report-uri /_/AccountsSigninPassiveLoginHttp/cspreport"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'report-sample' 'nonce-Mlj4ELjZJAgFpk6Oav9mWw' 'unsafe-inline';object-src 'none';base-uri 'self';report-uri /_/AccountsSigninPassiveLoginHttp/cspreport;worker-src 'self'"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'unsafe-inline' 'unsafe-eval' blob: data: 'self' https://apis.google.com https://ssl.gstatic.com https://www.google.com https://www.googletagmanager.com https://www.gstatic.com https://www.google-analytics.com;report-uri /_/AccountsSigninPassiveLoginHttp/cspreport/allowlist"
            },
            {
              "name": "content-type",
              "value": "application/binary"
            },
            {
              "name": "cross-origin-opener-policy",
              "value": "unsafe-none"
            },
            {
              "name": "cross-origin-resource-policy",
              "value": "cross-origin"
            },
            {
              "name": "date",
              "value": "Mon, 09 Feb 2026 00:51:07 GMT"
            },
            {
              "name": "expires",
              "value": "Mon, 01 Jan 1990 00:00:00 GMT"
            },
            {
              "name": "location",
              "value": "https://accounts.google.com/InteractiveLogin?authuser=0&continue=https://accounts.google.com/signin/oauth/consent?authuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&dsh=S453274941:1770598267814637&ifkv=AXbMIuD72fhYGC1L-Z36cv6llEtNsoTYxTKlnuDBmxulViBzqpQEnzDKsBMtuRRj_Lq_fZBS1nx-Zw"
            },
            {
              "name": "permissions-policy",
              "value": "ch-ua-arch=*, ch-ua-bitness=*, ch-ua-full-version=*, ch-ua-full-version-list=*, ch-ua-model=*, ch-ua-wow64=*, ch-ua-form-factors=*, ch-ua-platform=*, ch-ua-platform-version=*"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "server",
              "value": "ESF"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-xss-protection",
              "value": "0"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "application/binary"
          },
          "redirectURL": "https://accounts.google.com/InteractiveLogin?authuser=0&continue=https://accounts.google.com/signin/oauth/consent?authuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&dsh=S453274941:1770598267814637&ifkv=AXbMIuD72fhYGC1L-Z36cv6llEtNsoTYxTKlnuDBmxulViBzqpQEnzDKsBMtuRRj_Lq_fZBS1nx-Zw",
          "headersSize": -1,
          "bodySize": -1,
          "_transferSize": 42,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[2a00:1450:400c:c0b::54]",
        "startedDateTime": "2026-02-09T00:51:09.420Z",
        "time": 42.431000038050115,
        "timings": {
          "blocked": 1.0400000361129642,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.317,
          "wait": 39.68600002681464,
          "receive": 1.3879999751225114,
          "_blocked_queueing": 0.6010000361129642,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "15502",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "443",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "https://accounts.google.com/InteractiveLogin?authuser=0&continue=https://accounts.google.com/signin/oauth/consent?authuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&dsh=S453274941:1770598267814637&ifkv=AXbMIuD72fhYGC1L-Z36cv6llEtNsoTYxTKlnuDBmxulViBzqpQEnzDKsBMtuRRj_Lq_fZBS1nx-Zw",
          "httpVersion": "h3",
          "headers": [
            {
              "name": ":authority",
              "value": "accounts.google.com"
            },
            {
              "name": ":method",
              "value": "GET"
            },
            {
              "name": ":path",
              "value": "/InteractiveLogin?authuser=0&continue=https://accounts.google.com/signin/oauth/consent?authuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1&rart=ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8&dsh=S453274941:1770598267814637&ifkv=AXbMIuD72fhYGC1L-Z36cv6llEtNsoTYxTKlnuDBmxulViBzqpQEnzDKsBMtuRRj_Lq_fZBS1nx-Zw"
            },
            {
              "name": ":scheme",
              "value": "https"
            },
            {
              "name": "accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "accept-encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "accept-language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "priority",
              "value": "u=0, i"
            },
            {
              "name": "referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-arch",
              "value": "\"x86\""
            },
            {
              "name": "sec-ch-ua-bitness",
              "value": "\"64\""
            },
            {
              "name": "sec-ch-ua-form-factors",
              "value": "\"Desktop\""
            },
            {
              "name": "sec-ch-ua-full-version",
              "value": "\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-full-version-list",
              "value": "\"Not(A:Brand\";v=\"8.0.0.0\", \"Chromium\";v=\"144.0.7559.133\", \"Google Chrome\";v=\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-model",
              "value": "\"\""
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-ch-ua-platform-version",
              "value": "\"19.0.0\""
            },
            {
              "name": "sec-ch-ua-wow64",
              "value": "?0"
            },
            {
              "name": "sec-fetch-dest",
              "value": "document"
            },
            {
              "name": "sec-fetch-mode",
              "value": "navigate"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-origin"
            },
            {
              "name": "sec-fetch-user",
              "value": "?1"
            },
            {
              "name": "upgrade-insecure-requests",
              "value": "1"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "x-browser-channel",
              "value": "stable"
            },
            {
              "name": "x-browser-copyright",
              "value": "Copyright 2026 Google LLC. All Rights reserved."
            },
            {
              "name": "x-browser-validation",
              "value": "mbKdpV8Df6MeX3t+QoahfSgokv4="
            },
            {
              "name": "x-browser-year",
              "value": "2026"
            },
            {
              "name": "x-chrome-id-consistency-request",
              "value": "version=1,client_id=77185425430.apps.googleusercontent.com,device_id=0450851c-0513-40fb-b152-8c0d366de6b3,sync_account_id=100149859665997612966,signin_mode=all_accounts,signout_mode=show_confirmation"
            },
            {
              "name": "x-client-data",
              "value": "CP38ygE="
            }
          ],
          "queryString": [
            {
              "name": "authuser",
              "value": "0"
            },
            {
              "name": "continue",
              "value": "https://accounts.google.com/signin/oauth/consent?authuser%3D0%26part%3DAJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg%26flowName%3DGeneralOAuthFlow%26as%3DS-603273572%253A1770598265735725%26client_id%3D939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com%26requestPath%3D%252Fsignin%252Foauth%252Fconsent%26pli%3D1"
            },
            {
              "name": "rart",
              "value": "ANgoxccIf3Ts5gaBigEJYhx_mgGtft-R2b8IeZzksxufTfJNSbTOZzp9qH-haBySz8kqLWs_T0R3CzPsbtiOAqzTy3jtoKv3Ll1pG51WDIqyVcIHlyVWb-8"
            },
            {
              "name": "dsh",
              "value": "S453274941:1770598267814637"
            },
            {
              "name": "ifkv",
              "value": "AXbMIuD72fhYGC1L-Z36cv6llEtNsoTYxTKlnuDBmxulViBzqpQEnzDKsBMtuRRj_Lq_fZBS1nx-Zw"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "",
          "httpVersion": "h3",
          "headers": [
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            },
            {
              "name": "cache-control",
              "value": "no-cache, no-store"
            },
            {
              "name": "content-encoding",
              "value": "gzip"
            },
            {
              "name": "content-length",
              "value": "854"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'report-sample' 'nonce-85p-cP8Oglr1uPMjhf7K6w' 'unsafe-inline' 'unsafe-eval';object-src 'none';base-uri 'self';report-uri /cspreport"
            },
            {
              "name": "content-security-policy",
              "value": "require-trusted-types-for 'script';report-uri /cspreport"
            },
            {
              "name": "content-type",
              "value": "text/html; charset=UTF-8"
            },
            {
              "name": "cross-origin-opener-policy-report-only",
              "value": "same-origin; report-to=\"coop_gse_qebhlk\""
            },
            {
              "name": "date",
              "value": "Mon, 09 Feb 2026 00:51:08 GMT"
            },
            {
              "name": "expires",
              "value": "Mon, 01-Jan-1990 00:00:00 GMT"
            },
            {
              "name": "location",
              "value": "https://accounts.google.com/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572%3A1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=%2Fsignin%2Foauth%2Fconsent&pli=1&rapt=AEjHL4MS_qOEx5OldK9oOhUz_nUoy6XOeWnulqpyMSbKDX9HqawoLgz2MjzthVRpl4gfH9npxZldGZSi9gtSyZofeVYObXmJo6NawsHKf7N92Uk99R_lUF8"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "report-to",
              "value": "{\"group\":\"coop_gse_qebhlk\",\"max_age\":2592000,\"endpoints\":[{\"url\":\"https://csp.withgoogle.com/csp/report-to/gse_qebhlk\"}]}"
            },
            {
              "name": "server",
              "value": "GSE"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-frame-options",
              "value": "DENY"
            },
            {
              "name": "x-xss-protection",
              "value": "1; mode=block"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "text/html"
          },
          "redirectURL": "https://accounts.google.com/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572%3A1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=%2Fsignin%2Foauth%2Fconsent&pli=1&rapt=AEjHL4MS_qOEx5OldK9oOhUz_nUoy6XOeWnulqpyMSbKDX9HqawoLgz2MjzthVRpl4gfH9npxZldGZSi9gtSyZofeVYObXmJo6NawsHKf7N92Uk99R_lUF8",
          "headersSize": -1,
          "bodySize": -1,
          "_transferSize": 39,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[2a00:1450:400c:c0b::54]",
        "startedDateTime": "2026-02-09T00:51:09.463Z",
        "time": 280.02499998547137,
        "timings": {
          "blocked": 1.349999960321933,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.33799999999999997,
          "wait": 276.9910000205897,
          "receive": 1.3460000045597553,
          "_blocked_queueing": 0.720999960321933,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "15502",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "443",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "https://accounts.google.com/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572%3A1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=%2Fsignin%2Foauth%2Fconsent&pli=1&rapt=AEjHL4MS_qOEx5OldK9oOhUz_nUoy6XOeWnulqpyMSbKDX9HqawoLgz2MjzthVRpl4gfH9npxZldGZSi9gtSyZofeVYObXmJo6NawsHKf7N92Uk99R_lUF8",
          "httpVersion": "h3",
          "headers": [
            {
              "name": ":authority",
              "value": "accounts.google.com"
            },
            {
              "name": ":method",
              "value": "GET"
            },
            {
              "name": ":path",
              "value": "/signin/oauth/consent?authuser=0&part=AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg&flowName=GeneralOAuthFlow&as=S-603273572%3A1770598265735725&client_id=939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com&requestPath=%2Fsignin%2Foauth%2Fconsent&pli=1&rapt=AEjHL4MS_qOEx5OldK9oOhUz_nUoy6XOeWnulqpyMSbKDX9HqawoLgz2MjzthVRpl4gfH9npxZldGZSi9gtSyZofeVYObXmJo6NawsHKf7N92Uk99R_lUF8"
            },
            {
              "name": ":scheme",
              "value": "https"
            },
            {
              "name": "accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "accept-encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "accept-language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "priority",
              "value": "u=0, i"
            },
            {
              "name": "referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-arch",
              "value": "\"x86\""
            },
            {
              "name": "sec-ch-ua-bitness",
              "value": "\"64\""
            },
            {
              "name": "sec-ch-ua-form-factors",
              "value": "\"Desktop\""
            },
            {
              "name": "sec-ch-ua-full-version",
              "value": "\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-full-version-list",
              "value": "\"Not(A:Brand\";v=\"8.0.0.0\", \"Chromium\";v=\"144.0.7559.133\", \"Google Chrome\";v=\"144.0.7559.133\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-model",
              "value": "\"\""
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-ch-ua-platform-version",
              "value": "\"19.0.0\""
            },
            {
              "name": "sec-ch-ua-wow64",
              "value": "?0"
            },
            {
              "name": "sec-fetch-dest",
              "value": "document"
            },
            {
              "name": "sec-fetch-mode",
              "value": "navigate"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-origin"
            },
            {
              "name": "sec-fetch-user",
              "value": "?1"
            },
            {
              "name": "upgrade-insecure-requests",
              "value": "1"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "x-browser-channel",
              "value": "stable"
            },
            {
              "name": "x-browser-copyright",
              "value": "Copyright 2026 Google LLC. All Rights reserved."
            },
            {
              "name": "x-browser-validation",
              "value": "mbKdpV8Df6MeX3t+QoahfSgokv4="
            },
            {
              "name": "x-browser-year",
              "value": "2026"
            },
            {
              "name": "x-chrome-id-consistency-request",
              "value": "version=1,client_id=77185425430.apps.googleusercontent.com,device_id=0450851c-0513-40fb-b152-8c0d366de6b3,sync_account_id=100149859665997612966,signin_mode=all_accounts,signout_mode=show_confirmation"
            },
            {
              "name": "x-client-data",
              "value": "CP38ygE="
            }
          ],
          "queryString": [
            {
              "name": "authuser",
              "value": "0"
            },
            {
              "name": "part",
              "value": "AJi8hANr-twILkWQ4EK3ZYPaJlnED5N8CW_RPRyWMfDskcAFOF56dXabLkkQL8uTe5uETC8-J8sx6gWpt8c_gacyOBKfLtNpuTjyjamAmQ7J5hOV61a1JdguAcdmRp2kZqC93b4rXLm5Eud5gw9Zixz_RyfwGXMgbFnMCdxphB1srbMbjneomzWvOwILGVieVJQQw-LhnNPOzT8YhsQaEp6va83gOKFy1RH9tN91bXJHFv_9Uz33s6VixGqjrT7N27hgdl1nIsJocyk5Urc-AtY6GXjn-_dl2OjkDVn9qyG16L2FHKKrYak3zzx003I-yGfx8EvBYcKIklmuNFDiP4QMkfAkTNS_rPbLeMA38ABEAtTFKSsBwOTVsqOq86yVvdAmh2q5mbzHj7aXFhdHj01grknfkXc8KZ8tKjRFmQ_eBs8vNOldO5L_3Zw8fUHRANAnuNVGAsDzScCRHJKPqc0_9Dxa6LT5bg"
            },
            {
              "name": "flowName",
              "value": "GeneralOAuthFlow"
            },
            {
              "name": "as",
              "value": "S-603273572%3A1770598265735725"
            },
            {
              "name": "client_id",
              "value": "939061165666-lelndte3hnuhg55keqctf0hfnrden2h8.apps.googleusercontent.com"
            },
            {
              "name": "requestPath",
              "value": "%2Fsignin%2Foauth%2Fconsent"
            },
            {
              "name": "pli",
              "value": "1"
            },
            {
              "name": "rapt",
              "value": "AEjHL4MS_qOEx5OldK9oOhUz_nUoy6XOeWnulqpyMSbKDX9HqawoLgz2MjzthVRpl4gfH9npxZldGZSi9gtSyZofeVYObXmJo6NawsHKf7N92Uk99R_lUF8"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "",
          "httpVersion": "h3",
          "headers": [
            {
              "name": "alt-svc",
              "value": "h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000"
            },
            {
              "name": "cache-control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "name": "content-encoding",
              "value": "gzip"
            },
            {
              "name": "content-length",
              "value": "391"
            },
            {
              "name": "content-security-policy",
              "value": "script-src 'report-sample' 'nonce-T2465DFTbTwgBBxjzZRErg' 'unsafe-inline' 'unsafe-eval';object-src 'none';base-uri 'self';report-uri /cspreport"
            },
            {
              "name": "content-security-policy",
              "value": "require-trusted-types-for 'script';report-uri /cspreport"
            },
            {
              "name": "content-type",
              "value": "text/html; charset=UTF-8"
            },
            {
              "name": "cross-origin-opener-policy-report-only",
              "value": "same-origin; report-to=\"coop_gse_qebhlk\""
            },
            {
              "name": "date",
              "value": "Mon, 09 Feb 2026 00:51:08 GMT"
            },
            {
              "name": "expires",
              "value": "Mon, 01 Jan 1990 00:00:00 GMT"
            },
            {
              "name": "location",
              "value": "http://localhost:3333/auth/google/callback?state=cIRToIhaP1iDSZunNohFrrdNUCUmPLb6&code=4%2F0ASc3gC3FeIkY20QrDL3wTkXGiZ5nT6r4prRgQWkVy9utZ5AZ6Mgdcnu2CUKITRodV0WW1A&scope=email+profile+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&authuser=0&prompt=none"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "report-to",
              "value": "{\"group\":\"coop_gse_qebhlk\",\"max_age\":2592000,\"endpoints\":[{\"url\":\"https://csp.withgoogle.com/csp/report-to/gse_qebhlk\"}]}"
            },
            {
              "name": "server",
              "value": "GSE"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "vary",
              "value": "Sec-Fetch-Dest, Sec-Fetch-Mode, Sec-Fetch-Site"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-frame-options",
              "value": "DENY"
            },
            {
              "name": "x-xss-protection",
              "value": "1; mode=block"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "text/html"
          },
          "redirectURL": "http://localhost:3333/auth/google/callback?state=cIRToIhaP1iDSZunNohFrrdNUCUmPLb6&code=4%2F0ASc3gC3FeIkY20QrDL3wTkXGiZ5nT6r4prRgQWkVy9utZ5AZ6Mgdcnu2CUKITRodV0WW1A&scope=email+profile+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&authuser=0&prompt=none",
          "headersSize": -1,
          "bodySize": -1,
          "_transferSize": 43,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[2a00:1450:400c:c0b::54]",
        "startedDateTime": "2026-02-09T00:51:09.743Z",
        "time": 164.38099998049438,
        "timings": {
          "blocked": 1.0469999735094606,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.38600000000000007,
          "wait": 161.53300000089408,
          "receive": 1.4150000060908496,
          "_blocked_queueing": 0.6309999735094607,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "14888",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "3333",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:3333/auth/google/callback?state=cIRToIhaP1iDSZunNohFrrdNUCUmPLb6&code=4%2F0ASc3gC3FeIkY20QrDL3wTkXGiZ5nT6r4prRgQWkVy9utZ5AZ6Mgdcnu2CUKITRodV0WW1A&scope=email+profile+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&authuser=0&prompt=none",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:3333"
            },
            {
              "name": "Referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "document"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "navigate"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "cross-site"
            },
            {
              "name": "Sec-Fetch-User",
              "value": "?1"
            },
            {
              "name": "Upgrade-Insecure-Requests",
              "value": "1"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [
            {
              "name": "state",
              "value": "cIRToIhaP1iDSZunNohFrrdNUCUmPLb6"
            },
            {
              "name": "code",
              "value": "4%2F0ASc3gC3FeIkY20QrDL3wTkXGiZ5nT6r4prRgQWkVy9utZ5AZ6Mgdcnu2CUKITRodV0WW1A"
            },
            {
              "name": "scope",
              "value": "email+profile+openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email"
            },
            {
              "name": "authuser",
              "value": "0"
            },
            {
              "name": "prompt",
              "value": "none"
            }
          ],
          "cookies": [],
          "headersSize": 1240,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "Found",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "content-length",
              "value": "132"
            },
            {
              "name": "content-type",
              "value": "text/plain; charset=utf-8"
            },
            {
              "name": "location",
              "value": "http://localhost:4200/auth/callback?token=oat_MjU.OHh4NGlveUd6TnQyeFl6TFdUMVdHVEE1d0Jpd0tuT2RhOUNqQWxXYTM2MzAwMDIxNDg"
            },
            {
              "name": "x-request-id",
              "value": "dehw7swktc70f2dlphwqwf00"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "text/plain",
            "compression": 0
          },
          "redirectURL": "http://localhost:4200/auth/callback?token=oat_MjU.OHh4NGlveUd6TnQyeFl6TFdUMVdHVEE1d0Jpd0tuT2RhOUNqQWxXYTM2MzAwMDIxNDg",
          "headersSize": 453,
          "bodySize": 0,
          "_transferSize": 453,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:09.907Z",
        "time": 200.4760000272654,
        "timings": {
          "blocked": 1.1969999981969595,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.07800000000000007,
          "wait": 198.27699997819587,
          "receive": 0.9240000508725643,
          "_blocked_queueing": 0.4889999981969595,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16075",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/auth/callback?token=oat_MjU.OHh4NGlveUd6TnQyeFl6TFdUMVdHVEE1d0Jpd0tuT2RhOUNqQWxXYTM2MzAwMDIxNDg",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "Referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "document"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "navigate"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "cross-site"
            },
            {
              "name": "Sec-Fetch-User",
              "value": "?1"
            },
            {
              "name": "Upgrade-Insecure-Requests",
              "value": "1"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [
            {
              "name": "token",
              "value": "oat_MjU.OHh4NGlveUd6TnQyeFl6TFdUMVdHVEE1d0Jpd0tuT2RhOUNqQWxXYTM2MzAwMDIxNDg"
            }
          ],
          "cookies": [],
          "headersSize": 822,
          "bodySize": 0
        },
        "response": {
          "status": 302,
          "statusText": "Found",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "name": "Vary",
              "value": "Origin"
            },
            {
              "name": "Vary",
              "value": "Sec-Fetch-Dest"
            },
            {
              "name": "X-Powered-By",
              "value": "Express"
            },
            {
              "name": "location",
              "value": "/login"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "x-unknown",
            "compression": 0
          },
          "redirectURL": "/login",
          "headersSize": 211,
          "bodySize": 0,
          "_transferSize": 211,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.108Z",
        "time": 16.397999968957155,
        "timings": {
          "blocked": 0.5540000098533928,
          "dns": 0.0050000000000000044,
          "ssl": -1,
          "connect": 0.43800000000000006,
          "send": 0.14800000000000002,
          "wait": 14.45800001738593,
          "receive": 0.7949999417178333,
          "_blocked_queueing": 0.33000000985339284,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16075",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 136,
                "columnNumber": 320
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 770,
                "columnNumber": 76
              },
              {
                "functionName": "kRa",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 795,
                "columnNumber": 67
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 794,
                "columnNumber": 119
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1601,
                "columnNumber": 339
              },
              {
                "functionName": "",
                "scriptId": "31",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/ck=boq-identity.AccountsSignInUi.OI_ybsvYZsw.L.B1.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/exm=LEikZe,_b,_tp,byfTOb,lsjVmc/excm=_b,_tp,accountchooserview/ed=1/wt=2/ujg=1/rs=AOaEmlEobo2n2jAjGSAxbLw4YdATZMef5w/ee=ASJRFf:DAnQ7e;Al0B8:kibjWe;DaIJ8c:iAskyc;EVNhjf:pw70Gc;EkYFhd:GwYlN;EmZ2Bf:zr1jrb;JsbNhc:Xd8iUd;K5nYTd:ZDZcre;LBgRLc:XVMNvd;Me32dd:MEeYgc;NJ1rfe:yGfSdd;NPKaK:PVlQOd;NSEoX:lazG7b;Pjplud:EEDORb;QGR0gd:Mlhmy;SMDL4c:K0PMbc;SNUn3:ZwDk9d;ScI3Yc:e7Hzgb;UpnZUd:nnwwYc;Uvc8o:VDovNc;VlRiDf:j7ZRif;XdiAjb:NLiXbe;YIZmRd:A1yn5d;a56pNe:JEfCwb;cEt90b:ws9Tlc;dIoSBb:SpsfSb;dowIGb:ebZ3mb;eBAeSb:zbML3c;iFQyKf:vfuNJf;lOO0Vd:OTA3Ae;nTuGK:JKNPM;oGtAuc:sOXFj;oSUNyd:K0PMbc;oXZmbc:tUnxGc;pXdRYb:L9OGUe;qQEoOc:KUM7Z;qafBPd:yDVVkb;qddgKe:xQtZb;sHdTOe:nSePib;vNjB7d:YTxL4;wR5FRb:siKnQd;wc73nd:kqeOEd;yxTchf:KUM7Z/dti=1/m=n73qwf,SCuOPb,IZT63,vfuNJf,UUJqVe,ws9Tlc,KUM7Z,siKnQd,yGfSdd,mzzZzc,rCcCxc,cciGGe,m9oV,vjKJJ,y5vRwf,DqMihc,K1ZKnb,DiaQ5,Lic2t,Kg5Hhf,t2srLd,z0u0L,xiZRqc,L9OGUe,PrPYRd,MpJwZc,cYShmd,hc6Ubd,inNHtf,oLggrd,WpP9Yc,xQtZb,gJzDyc,lwddkf,SpsfSb,tUnxGc,EFQ78c,zbML3c,zr1jrb,vHEMJe,YTxL4,YHI3We,Uas9Hd,zy0vNb,K0PMbc,MY7mZe,qmdT9,GwYlN,NLiXbe,LDQI",
                "lineNumber": 1836,
                "columnNumber": 425
              },
              {
                "functionName": "Vh",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 234,
                "columnNumber": 41
              },
              {
                "functionName": "",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 235,
                "columnNumber": 104
              },
              {
                "functionName": "b",
                "scriptId": "17",
                "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                "lineNumber": 236,
                "columnNumber": 39
              }
            ],
            "parent": {
              "description": "Promise.then",
              "callFrames": [
                {
                  "functionName": "f",
                  "scriptId": "17",
                  "url": "https://www.gstatic.com/_/mss/boq-identity/_/js/k=boq-identity.AccountsSignInUi.fr.yKIErJknRsg.es5.O/am=Kf____8wAADQKeKXLMDxNwCAAQJgCTQBZAAAAAAAAAAAwAIAAG0E/d=1/excm=_b,_tp,accountchooserview/ed=1/dg=0/wt=2/ujg=1/rs=AOaEmlHaRqGhFH293URE1Wdqe6dg6En4ZQ/dti=1/m=_b,_tp",
                  "lineNumber": 236,
                  "columnNumber": 169
                }
              ]
            }
          }
        },
        "_priority": "VeryHigh",
        "_resourceType": "document",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/login",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "Referer",
              "value": "https://accounts.google.com/"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "document"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "navigate"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "cross-site"
            },
            {
              "name": "Sec-Fetch-User",
              "value": "?1"
            },
            {
              "name": "Upgrade-Insecure-Requests",
              "value": "1"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 732,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "name": "Vary",
              "value": "Origin"
            },
            {
              "name": "Vary",
              "value": "Sec-Fetch-Dest"
            },
            {
              "name": "X-Powered-By",
              "value": "Express"
            },
            {
              "name": "content-type",
              "value": "text/html;charset=UTF-8"
            }
          ],
          "cookies": [],
          "content": {
            "size": 2842,
            "mimeType": "text/html",
            "compression": -12,
            "text": "<!DOCTYPE html><html lang=\"en\"><head>\n  <script type=\"module\" src=\"/@vite/client\"></script>\n\n  <meta charset=\"utf-8\">\n  <title>Frontend</title>\n  <base href=\"/\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <link rel=\"icon\" type=\"image/x-icon\" href=\"favicon.ico\">\n<link rel=\"stylesheet\" href=\"styles.css\"></head>\n<body><!--nghm--><script type=\"text/javascript\" id=\"ng-event-dispatch-contract\">(()=>{function p(t,n,r,o,e,i,f,m){return{eventType:t,event:n,targetElement:r,eic:o,timeStamp:e,eia:i,eirp:f,eiack:m}}function u(t){let n=[],r=e=>{n.push(e)};return{c:t,q:n,et:[],etc:[],d:r,h:e=>{r(p(e.type,e,e.target,t,Date.now()))}}}function s(t,n,r){for(let o=0;o<n.length;o++){let e=n[o];(r?t.etc:t.et).push(e),t.c.addEventListener(e,t.h,r)}}function c(t,n,r,o,e=window){let i=u(t);e._ejsas||(e._ejsas={}),e._ejsas[n]=i,s(i,r),s(i,o,!0)}window.__jsaction_bootstrap=c;})();\n</script><script>window.__jsaction_bootstrap(document.body,\"ng\",[\"click\"],[]);</script>\n  <app-root ng-version=\"21.1.3\" ngh=\"1\" ng-server-context=\"ssg\"><router-outlet></router-outlet><app-login ngh=\"0\"><div class=\"min-h-screen bg-gray-900 flex items-center justify-center px-4\"><div class=\"max-w-md w-full\"><div class=\"text-center mb-8\"><h1 class=\"text-4xl font-bold text-white mb-2\">Scaffold</h1><p class=\"text-gray-400\">Gnrateur de tickets agile propuls par IA</p></div><div class=\"bg-gray-800 rounded-xl p-8 border border-gray-700 shadow-xl\"><h2 class=\"text-xl font-semibold text-white text-center mb-6\"> Connectez-vous pour continuer </h2><button class=\"w-full flex items-center justify-center gap-3 bg-white hover:bg-gray-100 text-gray-800 font-medium py-3 px-4 rounded-lg transition-colors\" jsaction=\"click:;\"><svg viewBox=\"0 0 24 24\" class=\"w-5 h-5\"><path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"></path><path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"></path><path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"></path><path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"></path></svg> Continuer avec Google </button><p class=\"text-gray-500 text-sm text-center mt-6\"> En vous connectant, vous acceptez nos conditions d'utilisation </p></div></div></div></app-login><!--container--></app-root>\n<script src=\"main.js\" type=\"module\"></script>\n<link rel=\"modulepreload\" href=\"chunk-K7W62EAA.js\">\n\n\n<script id=\"ng-state\" type=\"application/json\">{\"__nghData__\":[{},{\"c\":{\"0\":[{\"i\":\"c733996895\",\"r\":1}]}}]}</script></body></html>"
          },
          "redirectURL": "",
          "headersSize": 229,
          "bodySize": 2854,
          "_transferSize": 3083,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.124Z",
        "time": 22.93700003065169,
        "timings": {
          "blocked": 0.6210000321865081,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.08400000000000002,
          "wait": 21.99800002111122,
          "receive": 0.23399997735396028,
          "_blocked_queueing": 0.3100000321865082,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16089",
        "_initiator": {
          "type": "parser",
          "url": "http://localhost:4200/login",
          "lineNumber": 1
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@vite/client",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "If-None-Match",
              "value": "W/\"834e-RQvy+DmfSDISV6jU91ta54x4ly4\""
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/login"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 635,
          "bodySize": 0
        },
        "response": {
          "status": 304,
          "statusText": "Not Modified",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 177709,
            "mimeType": "text/javascript",
            "text": "import \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/node_modules/vite/dist/client/env.mjs\";\n\n//#region \\0@oxc-project+runtime@0.99.0/helpers/typeof.js\nfunction _typeof(o) {\n\t\"@babel/helpers - typeof\";\n\treturn _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function(o$1) {\n\t\treturn typeof o$1;\n\t} : function(o$1) {\n\t\treturn o$1 && \"function\" == typeof Symbol && o$1.constructor === Symbol && o$1 !== Symbol.prototype ? \"symbol\" : typeof o$1;\n\t}, _typeof(o);\n}\n\n//#endregion\n//#region \\0@oxc-project+runtime@0.99.0/helpers/toPrimitive.js\nfunction toPrimitive(t, r) {\n\tif (\"object\" != _typeof(t) || !t) return t;\n\tvar e = t[Symbol.toPrimitive];\n\tif (void 0 !== e) {\n\t\tvar i = e.call(t, r || \"default\");\n\t\tif (\"object\" != _typeof(i)) return i;\n\t\tthrow new TypeError(\"@@toPrimitive must return a primitive value.\");\n\t}\n\treturn (\"string\" === r ? String : Number)(t);\n}\n\n//#endregion\n//#region \\0@oxc-project+runtime@0.99.0/helpers/toPropertyKey.js\nfunction toPropertyKey(t) {\n\tvar i = toPrimitive(t, \"string\");\n\treturn \"symbol\" == _typeof(i) ? i : i + \"\";\n}\n\n//#endregion\n//#region \\0@oxc-project+runtime@0.99.0/helpers/defineProperty.js\nfunction _defineProperty(e, r, t) {\n\treturn (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n\t\tvalue: t,\n\t\tenumerable: !0,\n\t\tconfigurable: !0,\n\t\twritable: !0\n\t}) : e[r] = t, e;\n}\n\n//#endregion\n//#region src/shared/hmr.ts\nvar HMRContext = class {\n\tconstructor(hmrClient$1, ownerPath) {\n\t\tthis.hmrClient = hmrClient$1;\n\t\tthis.ownerPath = ownerPath;\n\t\t_defineProperty(this, \"newListeners\", void 0);\n\t\tif (!hmrClient$1.dataMap.has(ownerPath)) hmrClient$1.dataMap.set(ownerPath, {});\n\t\tconst mod = hmrClient$1.hotModulesMap.get(ownerPath);\n\t\tif (mod) mod.callbacks = [];\n\t\tconst staleListeners = hmrClient$1.ctxToListenersMap.get(ownerPath);\n\t\tif (staleListeners) for (const [event, staleFns] of staleListeners) {\n\t\t\tconst listeners = hmrClient$1.customListenersMap.get(event);\n\t\t\tif (listeners) hmrClient$1.customListenersMap.set(event, listeners.filter((l) => !staleFns.includes(l)));\n\t\t}\n\t\tthis.newListeners = /* @__PURE__ */ new Map();\n\t\thmrClient$1.ctxToListenersMap.set(ownerPath, this.newListeners);\n\t}\n\tget data() {\n\t\treturn this.hmrClient.dataMap.get(this.ownerPath);\n\t}\n\taccept(deps, callback) {\n\t\tif (typeof deps === \"function\" || !deps) this.acceptDeps([this.ownerPath], ([mod]) => deps?.(mod));\n\t\telse if (typeof deps === \"string\") this.acceptDeps([deps], ([mod]) => callback?.(mod));\n\t\telse if (Array.isArray(deps)) this.acceptDeps(deps, callback);\n\t\telse throw new Error(`invalid hot.accept() usage.`);\n\t}\n\tacceptExports(_, callback) {\n\t\tthis.acceptDeps([this.ownerPath], ([mod]) => callback?.(mod));\n\t}\n\tdispose(cb) {\n\t\tthis.hmrClient.disposeMap.set(this.ownerPath, cb);\n\t}\n\tprune(cb) {\n\t\tthis.hmrClient.pruneMap.set(this.ownerPath, cb);\n\t}\n\tdecline() {}\n\tinvalidate(message) {\n\t\tconst firstInvalidatedBy = this.hmrClient.currentFirstInvalidatedBy ?? this.ownerPath;\n\t\tthis.hmrClient.notifyListeners(\"vite:invalidate\", {\n\t\t\tpath: this.ownerPath,\n\t\t\tmessage,\n\t\t\tfirstInvalidatedBy\n\t\t});\n\t\tthis.send(\"vite:invalidate\", {\n\t\t\tpath: this.ownerPath,\n\t\t\tmessage,\n\t\t\tfirstInvalidatedBy\n\t\t});\n\t\tthis.hmrClient.logger.debug(`invalidate ${this.ownerPath}${message ? `: ${message}` : \"\"}`);\n\t}\n\ton(event, cb) {\n\t\tconst addToMap = (map) => {\n\t\t\tconst existing = map.get(event) || [];\n\t\t\texisting.push(cb);\n\t\t\tmap.set(event, existing);\n\t\t};\n\t\taddToMap(this.hmrClient.customListenersMap);\n\t\taddToMap(this.newListeners);\n\t}\n\toff(event, cb) {\n\t\tconst removeFromMap = (map) => {\n\t\t\tconst existing = map.get(event);\n\t\t\tif (existing === void 0) return;\n\t\t\tconst pruned = existing.filter((l) => l !== cb);\n\t\t\tif (pruned.length === 0) {\n\t\t\t\tmap.delete(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmap.set(event, pruned);\n\t\t};\n\t\tremoveFromMap(this.hmrClient.customListenersMap);\n\t\tremoveFromMap(this.newListeners);\n\t}\n\tsend(event, data) {\n\t\tthis.hmrClient.send({\n\t\t\ttype: \"custom\",\n\t\t\tevent,\n\t\t\tdata\n\t\t});\n\t}\n\tacceptDeps(deps, callback = () => {}) {\n\t\tconst mod = this.hmrClient.hotModulesMap.get(this.ownerPath) || {\n\t\t\tid: this.ownerPath,\n\t\t\tcallbacks: []\n\t\t};\n\t\tmod.callbacks.push({\n\t\t\tdeps,\n\t\t\tfn: callback\n\t\t});\n\t\tthis.hmrClient.hotModulesMap.set(this.ownerPath, mod);\n\t}\n};\nvar HMRClient = class {\n\tconstructor(logger, transport$1, importUpdatedModule) {\n\t\tthis.logger = logger;\n\t\tthis.transport = transport$1;\n\t\tthis.importUpdatedModule = importUpdatedModule;\n\t\t_defineProperty(this, \"hotModulesMap\", /* @__PURE__ */ new Map());\n\t\t_defineProperty(this, \"disposeMap\", /* @__PURE__ */ new Map());\n\t\t_defineProperty(this, \"pruneMap\", /* @__PURE__ */ new Map());\n\t\t_defineProperty(this, \"dataMap\", /* @__PURE__ */ new Map());\n\t\t_defineProperty(this, \"customListenersMap\", /* @__PURE__ */ new Map());\n\t\t_defineProperty(this, \"ctxToListenersMap\", /* @__PURE__ */ new Map());\n\t\t_defineProperty(this, \"currentFirstInvalidatedBy\", void 0);\n\t\t_defineProperty(this, \"updateQueue\", []);\n\t\t_defineProperty(this, \"pendingUpdateQueue\", false);\n\t}\n\tasync notifyListeners(event, data) {\n\t\tconst cbs = this.customListenersMap.get(event);\n\t\tif (cbs) await Promise.allSettled(cbs.map((cb) => cb(data)));\n\t}\n\tsend(payload) {\n\t\tthis.transport.send(payload).catch((err) => {\n\t\t\tthis.logger.error(err);\n\t\t});\n\t}\n\tclear() {\n\t\tthis.hotModulesMap.clear();\n\t\tthis.disposeMap.clear();\n\t\tthis.pruneMap.clear();\n\t\tthis.dataMap.clear();\n\t\tthis.customListenersMap.clear();\n\t\tthis.ctxToListenersMap.clear();\n\t}\n\tasync prunePaths(paths) {\n\t\tawait Promise.all(paths.map((path) => {\n\t\t\tconst disposer = this.disposeMap.get(path);\n\t\t\tif (disposer) return disposer(this.dataMap.get(path));\n\t\t}));\n\t\tawait Promise.all(paths.map((path) => {\n\t\t\tconst fn = this.pruneMap.get(path);\n\t\t\tif (fn) return fn(this.dataMap.get(path));\n\t\t}));\n\t}\n\twarnFailedUpdate(err, path) {\n\t\tif (!(err instanceof Error) || !err.message.includes(\"fetch\")) this.logger.error(err);\n\t\tthis.logger.error(`Failed to reload ${path}. This could be due to syntax errors or importing non-existent modules. (see errors above)`);\n\t}\n\t/**\n\t* buffer multiple hot updates triggered by the same src change\n\t* so that they are invoked in the same order they were sent.\n\t* (otherwise the order may be inconsistent because of the http request round trip)\n\t*/\n\tasync queueUpdate(payload) {\n\t\tthis.updateQueue.push(this.fetchUpdate(payload));\n\t\tif (!this.pendingUpdateQueue) {\n\t\t\tthis.pendingUpdateQueue = true;\n\t\t\tawait Promise.resolve();\n\t\t\tthis.pendingUpdateQueue = false;\n\t\t\tconst loading = [...this.updateQueue];\n\t\t\tthis.updateQueue = [];\n\t\t\t(await Promise.all(loading)).forEach((fn) => fn && fn());\n\t\t}\n\t}\n\tasync fetchUpdate(update) {\n\t\tconst { path, acceptedPath, firstInvalidatedBy } = update;\n\t\tconst mod = this.hotModulesMap.get(path);\n\t\tif (!mod) return;\n\t\tlet fetchedModule;\n\t\tconst isSelfUpdate = path === acceptedPath;\n\t\tconst qualifiedCallbacks = mod.callbacks.filter(({ deps }) => deps.includes(acceptedPath));\n\t\tif (isSelfUpdate || qualifiedCallbacks.length > 0) {\n\t\t\tconst disposer = this.disposeMap.get(acceptedPath);\n\t\t\tif (disposer) await disposer(this.dataMap.get(acceptedPath));\n\t\t\ttry {\n\t\t\t\tfetchedModule = await this.importUpdatedModule(update);\n\t\t\t} catch (e) {\n\t\t\t\tthis.warnFailedUpdate(e, acceptedPath);\n\t\t\t}\n\t\t}\n\t\treturn () => {\n\t\t\ttry {\n\t\t\t\tthis.currentFirstInvalidatedBy = firstInvalidatedBy;\n\t\t\t\tfor (const { deps, fn } of qualifiedCallbacks) fn(deps.map((dep) => dep === acceptedPath ? fetchedModule : void 0));\n\t\t\t\tconst loggedPath = isSelfUpdate ? path : `${acceptedPath} via ${path}`;\n\t\t\t\tthis.logger.debug(`hot updated: ${loggedPath}`);\n\t\t\t} finally {\n\t\t\t\tthis.currentFirstInvalidatedBy = void 0;\n\t\t\t}\n\t\t};\n\t}\n};\n\n//#endregion\n//#region ../../node_modules/.pnpm/nanoid@5.1.6/node_modules/nanoid/non-secure/index.js\nlet urlAlphabet = \"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict\";\nlet nanoid = (size = 21) => {\n\tlet id = \"\";\n\tlet i = size | 0;\n\twhile (i--) id += urlAlphabet[Math.random() * 64 | 0];\n\treturn id;\n};\n\n//#endregion\n//#region src/shared/constants.ts\nlet SOURCEMAPPING_URL = \"sourceMa\";\nSOURCEMAPPING_URL += \"ppingURL\";\n\n//#endregion\n//#region src/shared/utils.ts\nconst isWindows = typeof process !== \"undefined\" && process.platform === \"win32\";\nconst AsyncFunction = async function() {}.constructor;\nfunction promiseWithResolvers() {\n\tlet resolve;\n\tlet reject;\n\treturn {\n\t\tpromise: new Promise((_resolve, _reject) => {\n\t\t\tresolve = _resolve;\n\t\t\treject = _reject;\n\t\t}),\n\t\tresolve,\n\t\treject\n\t};\n}\n\n//#endregion\n//#region src/shared/moduleRunnerTransport.ts\nfunction reviveInvokeError(e) {\n\tconst error = new Error(e.message || \"Unknown invoke error\");\n\tObject.assign(error, e, { runnerError: /* @__PURE__ */ new Error(\"RunnerError\") });\n\treturn error;\n}\nconst createInvokeableTransport = (transport$1) => {\n\tif (transport$1.invoke) return {\n\t\t...transport$1,\n\t\tasync invoke(name, data) {\n\t\t\tconst result = await transport$1.invoke({\n\t\t\t\ttype: \"custom\",\n\t\t\t\tevent: \"vite:invoke\",\n\t\t\t\tdata: {\n\t\t\t\t\tid: \"send\",\n\t\t\t\t\tname,\n\t\t\t\t\tdata\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (\"error\" in result) throw reviveInvokeError(result.error);\n\t\t\treturn result.result;\n\t\t}\n\t};\n\tif (!transport$1.send || !transport$1.connect) throw new Error(\"transport must implement send and connect when invoke is not implemented\");\n\tconst rpcPromises = /* @__PURE__ */ new Map();\n\treturn {\n\t\t...transport$1,\n\t\tconnect({ onMessage, onDisconnection }) {\n\t\t\treturn transport$1.connect({\n\t\t\t\tonMessage(payload) {\n\t\t\t\t\tif (payload.type === \"custom\" && payload.event === \"vite:invoke\") {\n\t\t\t\t\t\tconst data = payload.data;\n\t\t\t\t\t\tif (data.id.startsWith(\"response:\")) {\n\t\t\t\t\t\t\tconst invokeId = data.id.slice(9);\n\t\t\t\t\t\t\tconst promise = rpcPromises.get(invokeId);\n\t\t\t\t\t\t\tif (!promise) return;\n\t\t\t\t\t\t\tif (promise.timeoutId) clearTimeout(promise.timeoutId);\n\t\t\t\t\t\t\trpcPromises.delete(invokeId);\n\t\t\t\t\t\t\tconst { error, result } = data.data;\n\t\t\t\t\t\t\tif (error) promise.reject(error);\n\t\t\t\t\t\t\telse promise.resolve(result);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tonMessage(payload);\n\t\t\t\t},\n\t\t\t\tonDisconnection\n\t\t\t});\n\t\t},\n\t\tdisconnect() {\n\t\t\trpcPromises.forEach((promise) => {\n\t\t\t\tpromise.reject(/* @__PURE__ */ new Error(`transport was disconnected, cannot call ${JSON.stringify(promise.name)}`));\n\t\t\t});\n\t\t\trpcPromises.clear();\n\t\t\treturn transport$1.disconnect?.();\n\t\t},\n\t\tsend(data) {\n\t\t\treturn transport$1.send(data);\n\t\t},\n\t\tasync invoke(name, data) {\n\t\t\tconst promiseId = nanoid();\n\t\t\tconst wrappedData = {\n\t\t\t\ttype: \"custom\",\n\t\t\t\tevent: \"vite:invoke\",\n\t\t\t\tdata: {\n\t\t\t\t\tname,\n\t\t\t\t\tid: `send:${promiseId}`,\n\t\t\t\t\tdata\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst sendPromise = transport$1.send(wrappedData);\n\t\t\tconst { promise, resolve, reject } = promiseWithResolvers();\n\t\t\tconst timeout = transport$1.timeout ?? 6e4;\n\t\t\tlet timeoutId;\n\t\t\tif (timeout > 0) {\n\t\t\t\ttimeoutId = setTimeout(() => {\n\t\t\t\t\trpcPromises.delete(promiseId);\n\t\t\t\t\treject(/* @__PURE__ */ new Error(`transport invoke timed out after ${timeout}ms (data: ${JSON.stringify(wrappedData)})`));\n\t\t\t\t}, timeout);\n\t\t\t\ttimeoutId?.unref?.();\n\t\t\t}\n\t\t\trpcPromises.set(promiseId, {\n\t\t\t\tresolve,\n\t\t\t\treject,\n\t\t\t\tname,\n\t\t\t\ttimeoutId\n\t\t\t});\n\t\t\tif (sendPromise) sendPromise.catch((err) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\trpcPromises.delete(promiseId);\n\t\t\t\treject(err);\n\t\t\t});\n\t\t\ttry {\n\t\t\t\treturn await promise;\n\t\t\t} catch (err) {\n\t\t\t\tthrow reviveInvokeError(err);\n\t\t\t}\n\t\t}\n\t};\n};\nconst normalizeModuleRunnerTransport = (transport$1) => {\n\tconst invokeableTransport = createInvokeableTransport(transport$1);\n\tlet isConnected = !invokeableTransport.connect;\n\tlet connectingPromise;\n\treturn {\n\t\t...transport$1,\n\t\t...invokeableTransport.connect ? { async connect(onMessage) {\n\t\t\tif (isConnected) return;\n\t\t\tif (connectingPromise) {\n\t\t\t\tawait connectingPromise;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst maybePromise = invokeableTransport.connect({\n\t\t\t\tonMessage: onMessage ?? (() => {}),\n\t\t\t\tonDisconnection() {\n\t\t\t\t\tisConnected = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (maybePromise) {\n\t\t\t\tconnectingPromise = maybePromise;\n\t\t\t\tawait connectingPromise;\n\t\t\t\tconnectingPromise = void 0;\n\t\t\t}\n\t\t\tisConnected = true;\n\t\t} } : {},\n\t\t...invokeableTransport.disconnect ? { async disconnect() {\n\t\t\tif (!isConnected) return;\n\t\t\tif (connectingPromise) await connectingPromise;\n\t\t\tisConnected = false;\n\t\t\tawait invokeableTransport.disconnect();\n\t\t} } : {},\n\t\tasync send(data) {\n\t\t\tif (!invokeableTransport.send) return;\n\t\t\tif (!isConnected) if (connectingPromise) await connectingPromise;\n\t\t\telse throw new Error(\"send was called before connect\");\n\t\t\tawait invokeableTransport.send(data);\n\t\t},\n\t\tasync invoke(name, data) {\n\t\t\tif (!isConnected) if (connectingPromise) await connectingPromise;\n\t\t\telse throw new Error(\"invoke was called before connect\");\n\t\t\treturn invokeableTransport.invoke(name, data);\n\t\t}\n\t};\n};\nconst createWebSocketModuleRunnerTransport = (options) => {\n\tconst pingInterval = options.pingInterval ?? 3e4;\n\tlet ws;\n\tlet pingIntervalId;\n\treturn {\n\t\tasync connect({ onMessage, onDisconnection }) {\n\t\t\tconst socket = options.createConnection();\n\t\t\tsocket.addEventListener(\"message\", async ({ data }) => {\n\t\t\t\tonMessage(JSON.parse(data));\n\t\t\t});\n\t\t\tlet isOpened = socket.readyState === socket.OPEN;\n\t\t\tif (!isOpened) await new Promise((resolve, reject) => {\n\t\t\t\tsocket.addEventListener(\"open\", () => {\n\t\t\t\t\tisOpened = true;\n\t\t\t\t\tresolve();\n\t\t\t\t}, { once: true });\n\t\t\t\tsocket.addEventListener(\"close\", async () => {\n\t\t\t\t\tif (!isOpened) {\n\t\t\t\t\t\treject(/* @__PURE__ */ new Error(\"WebSocket closed without opened.\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tonMessage({\n\t\t\t\t\t\ttype: \"custom\",\n\t\t\t\t\t\tevent: \"vite:ws:disconnect\",\n\t\t\t\t\t\tdata: { webSocket: socket }\n\t\t\t\t\t});\n\t\t\t\t\tonDisconnection();\n\t\t\t\t});\n\t\t\t});\n\t\t\tonMessage({\n\t\t\t\ttype: \"custom\",\n\t\t\t\tevent: \"vite:ws:connect\",\n\t\t\t\tdata: { webSocket: socket }\n\t\t\t});\n\t\t\tws = socket;\n\t\t\tpingIntervalId = setInterval(() => {\n\t\t\t\tif (socket.readyState === socket.OPEN) socket.send(JSON.stringify({ type: \"ping\" }));\n\t\t\t}, pingInterval);\n\t\t},\n\t\tdisconnect() {\n\t\t\tclearInterval(pingIntervalId);\n\t\t\tws?.close();\n\t\t},\n\t\tsend(data) {\n\t\t\tws.send(JSON.stringify(data));\n\t\t}\n\t};\n};\n\n//#endregion\n//#region src/shared/hmrHandler.ts\nfunction createHMRHandler(handler) {\n\tconst queue = new Queue();\n\treturn (payload) => queue.enqueue(() => handler(payload));\n}\nvar Queue = class {\n\tconstructor() {\n\t\t_defineProperty(this, \"queue\", []);\n\t\t_defineProperty(this, \"pending\", false);\n\t}\n\tenqueue(promise) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.queue.push({\n\t\t\t\tpromise,\n\t\t\t\tresolve,\n\t\t\t\treject\n\t\t\t});\n\t\t\tthis.dequeue();\n\t\t});\n\t}\n\tdequeue() {\n\t\tif (this.pending) return false;\n\t\tconst item = this.queue.shift();\n\t\tif (!item) return false;\n\t\tthis.pending = true;\n\t\titem.promise().then(item.resolve).catch(item.reject).finally(() => {\n\t\t\tthis.pending = false;\n\t\t\tthis.dequeue();\n\t\t});\n\t\treturn true;\n\t}\n};\n\n//#endregion\n//#region src/client/overlay.ts\nconst hmrConfigName = \"vite.config.js\";\nconst base$1 = \"/\" || \"/\";\nconst cspNonce = \"document\" in globalThis ? document.querySelector(\"meta[property=csp-nonce]\")?.nonce : void 0;\nfunction h(e, attrs = {}, ...children) {\n\tconst elem = document.createElement(e);\n\tfor (const [k, v] of Object.entries(attrs)) if (v !== void 0) elem.setAttribute(k, v);\n\telem.append(...children);\n\treturn elem;\n}\nconst templateStyle = `\n:host {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 99999;\n  --monospace: 'SFMono-Regular', Consolas,\n  'Liberation Mono', Menlo, Courier, monospace;\n  --red: #ff5555;\n  --yellow: #e2aa53;\n  --purple: #cfa4ff;\n  --cyan: #2dd9da;\n  --dim: #c9c9c9;\n\n  --window-background: #181818;\n  --window-color: #d8d8d8;\n}\n\n.backdrop {\n  position: fixed;\n  z-index: 99999;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow-y: scroll;\n  margin: 0;\n  background: rgba(0, 0, 0, 0.66);\n}\n\n.window {\n  font-family: var(--monospace);\n  line-height: 1.5;\n  max-width: 80vw;\n  color: var(--window-color);\n  box-sizing: border-box;\n  margin: 30px auto;\n  padding: 2.5vh 4vw;\n  position: relative;\n  background: var(--window-background);\n  border-radius: 6px 6px 8px 8px;\n  box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);\n  overflow: hidden;\n  border-top: 8px solid var(--red);\n  direction: ltr;\n  text-align: left;\n}\n\npre {\n  font-family: var(--monospace);\n  font-size: 16px;\n  margin-top: 0;\n  margin-bottom: 1em;\n  overflow-x: scroll;\n  scrollbar-width: none;\n}\n\npre::-webkit-scrollbar {\n  display: none;\n}\n\npre.frame::-webkit-scrollbar {\n  display: block;\n  height: 5px;\n}\n\npre.frame::-webkit-scrollbar-thumb {\n  background: #999;\n  border-radius: 5px;\n}\n\npre.frame {\n  scrollbar-width: thin;\n}\n\n.message {\n  line-height: 1.3;\n  font-weight: 600;\n  white-space: pre-wrap;\n}\n\n.message-body {\n  color: var(--red);\n}\n\n.plugin {\n  color: var(--purple);\n}\n\n.file {\n  color: var(--cyan);\n  margin-bottom: 0;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.frame {\n  color: var(--yellow);\n}\n\n.stack {\n  font-size: 13px;\n  color: var(--dim);\n}\n\n.tip {\n  font-size: 13px;\n  color: #999;\n  border-top: 1px dotted #999;\n  padding-top: 13px;\n  line-height: 1.8;\n}\n\ncode {\n  font-size: 13px;\n  font-family: var(--monospace);\n  color: var(--yellow);\n}\n\n.file-link {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\nkbd {\n  line-height: 1.5;\n  font-family: ui-monospace, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n  font-size: 0.75rem;\n  font-weight: 700;\n  background-color: rgb(38, 40, 44);\n  color: rgb(166, 167, 171);\n  padding: 0.15rem 0.3rem;\n  border-radius: 0.25rem;\n  border-width: 0.0625rem 0.0625rem 0.1875rem;\n  border-style: solid;\n  border-color: rgb(54, 57, 64);\n  border-image: initial;\n}\n`;\nconst createTemplate = () => h(\"div\", {\n\tclass: \"backdrop\",\n\tpart: \"backdrop\"\n}, h(\"div\", {\n\tclass: \"window\",\n\tpart: \"window\"\n}, h(\"pre\", {\n\tclass: \"message\",\n\tpart: \"message\"\n}, h(\"span\", {\n\tclass: \"plugin\",\n\tpart: \"plugin\"\n}), h(\"span\", {\n\tclass: \"message-body\",\n\tpart: \"message-body\"\n})), h(\"pre\", {\n\tclass: \"file\",\n\tpart: \"file\"\n}), h(\"pre\", {\n\tclass: \"frame\",\n\tpart: \"frame\"\n}), h(\"pre\", {\n\tclass: \"stack\",\n\tpart: \"stack\"\n}), h(\"div\", {\n\tclass: \"tip\",\n\tpart: \"tip\"\n}, \"Click outside, press \", h(\"kbd\", {}, \"Esc\"), \" key, or fix the code to dismiss.\", h(\"br\"), )), h(\"style\", { nonce: cspNonce }, templateStyle));\nconst fileRE = /(?:file:\\/\\/)?(?:[a-zA-Z]:\\\\|\\/).*?:\\d+:\\d+/g;\nconst codeframeRE = /^(?:>?\\s*\\d+\\s+\\|.*|\\s+\\|\\s*\\^.*)\\r?\\n/gm;\nconst { HTMLElement = class {} } = globalThis;\nvar ErrorOverlay = class extends HTMLElement {\n\tconstructor(err, links = true) {\n\t\tsuper();\n\t\t_defineProperty(this, \"root\", void 0);\n\t\t_defineProperty(this, \"closeOnEsc\", void 0);\n\t\tthis.root = this.attachShadow({ mode: \"open\" });\n\t\tthis.root.appendChild(createTemplate());\n\t\tcodeframeRE.lastIndex = 0;\n\t\tconst hasFrame = err.frame && codeframeRE.test(err.frame);\n\t\tconst message = hasFrame ? err.message.replace(codeframeRE, \"\") : err.message;\n\t\tif (err.plugin) this.text(\".plugin\", `[plugin:${err.plugin}] `);\n\t\tthis.text(\".message-body\", message.trim());\n\t\tconst [file] = (err.loc?.file || err.id || \"unknown file\").split(`?`);\n\t\tif (err.loc) this.text(\".file\", `${file}:${err.loc.line}:${err.loc.column}`, links);\n\t\telse if (err.id) this.text(\".file\", file);\n\t\tif (hasFrame) this.text(\".frame\", err.frame.trim());\n\t\tthis.text(\".stack\", err.stack, links);\n\t\tthis.root.querySelector(\".window\").addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t});\n\t\tthis.addEventListener(\"click\", () => {\n\t\t\tthis.close();\n\t\t});\n\t\tthis.closeOnEsc = (e) => {\n\t\t\tif (e.key === \"Escape\" || e.code === \"Escape\") this.close();\n\t\t};\n\t\tdocument.addEventListener(\"keydown\", this.closeOnEsc);\n\t}\n\ttext(selector, text, linkFiles = false) {\n\t\tconst el = this.root.querySelector(selector);\n\t\tif (!linkFiles) el.textContent = text;\n\t\telse {\n\t\t\tlet curIndex = 0;\n\t\t\tlet match;\n\t\t\tfileRE.lastIndex = 0;\n\t\t\twhile (match = fileRE.exec(text)) {\n\t\t\t\tconst { 0: file, index } = match;\n\t\t\t\tconst frag = text.slice(curIndex, index);\n\t\t\t\tel.appendChild(document.createTextNode(frag));\n\t\t\t\tconst link = document.createElement(\"a\");\n\t\t\t\tlink.textContent = file;\n\t\t\t\tlink.className = \"file-link\";\n\t\t\t\tlink.onclick = () => {\n\t\t\t\t\tfetch(new URL(`${base$1}__open-in-editor?file=${encodeURIComponent(file)}`, import.meta.url));\n\t\t\t\t};\n\t\t\t\tel.appendChild(link);\n\t\t\t\tcurIndex += frag.length + file.length;\n\t\t\t}\n\t\t\tif (curIndex < text.length) el.appendChild(document.createTextNode(text.slice(curIndex)));\n\t\t}\n\t}\n\tclose() {\n\t\tthis.parentNode?.removeChild(this);\n\t\tdocument.removeEventListener(\"keydown\", this.closeOnEsc);\n\t}\n};\nconst overlayId = \"vite-error-overlay\";\nconst { customElements } = globalThis;\nif (customElements && !customElements.get(overlayId)) customElements.define(overlayId, ErrorOverlay);\n\n//#endregion\n//#region src/client/client.ts\nconsole.debug(\"[vite] connecting...\");\nconst importMetaUrl = new URL(import.meta.url);\nconst serverHost = \"localhost:4200/\";\nconst socketProtocol = null || (importMetaUrl.protocol === \"https:\" ? \"wss\" : \"ws\");\nconst hmrPort = null;\nconst socketHost = `${null || importMetaUrl.hostname}:${hmrPort || importMetaUrl.port}${\"/\"}`;\nconst directSocketHost = \"localhost:4200/\";\nconst base = \"/\" || \"/\";\nconst hmrTimeout = 30000;\nconst wsToken = \"hXrsy4jP80NF\";\nconst transport = normalizeModuleRunnerTransport((() => {\n\tlet wsTransport = createWebSocketModuleRunnerTransport({\n\t\tcreateConnection: () => new WebSocket(`${socketProtocol}://${socketHost}?token=${wsToken}`, \"vite-hmr\"),\n\t\tpingInterval: hmrTimeout\n\t});\n\treturn {\n\t\tasync connect(handlers) {\n\t\t\ttry {\n\t\t\t\tawait wsTransport.connect(handlers);\n\t\t\t} catch (e) {\n\t\t\t\tif (!hmrPort) {\n\t\t\t\t\twsTransport = createWebSocketModuleRunnerTransport({\n\t\t\t\t\t\tcreateConnection: () => new WebSocket(`${socketProtocol}://${directSocketHost}?token=${wsToken}`, \"vite-hmr\"),\n\t\t\t\t\t\tpingInterval: hmrTimeout\n\t\t\t\t\t});\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait wsTransport.connect(handlers);\n\t\t\t\t\t\tconsole.info(\"[vite] Direct websocket connection fallback. Check out https://vite.dev/config/server-options.html#server-hmr to remove the previous connection error.\");\n\t\t\t\t\t} catch (e$1) {\n\t\t\t\t\t\tif (e$1 instanceof Error && e$1.message.includes(\"WebSocket closed without opened.\")) {\n\t\t\t\t\t\t\tconst currentScriptHostURL = new URL(import.meta.url);\n\t\t\t\t\t\t\tconst currentScriptHost = currentScriptHostURL.host + currentScriptHostURL.pathname.replace(/@vite\\/client$/, \"\");\n\t\t\t\t\t\t\tconsole.error(`[vite] failed to connect to websocket.\nyour current setup:\n  (browser) ${currentScriptHost} <--[HTTP]--> ${serverHost} (server)\\n  (browser) ${socketHost} <--[WebSocket (failing)]--> ${directSocketHost} (server)\\nCheck out your Vite / network configuration and https://vite.dev/config/server-options.html#server-hmr .`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconsole.error(`[vite] failed to connect to websocket (${e}). `);\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t},\n\t\tasync disconnect() {\n\t\t\tawait wsTransport.disconnect();\n\t\t},\n\t\tsend(data) {\n\t\t\twsTransport.send(data);\n\t\t}\n\t};\n})());\nlet willUnload = false;\nif (typeof window !== \"undefined\") window.addEventListener?.(\"beforeunload\", () => {\n\twillUnload = true;\n});\nfunction cleanUrl(pathname) {\n\tconst url = new URL(pathname, \"http://vite.dev\");\n\turl.searchParams.delete(\"direct\");\n\treturn url.pathname + url.search;\n}\nlet isFirstUpdate = true;\nconst outdatedLinkTags = /* @__PURE__ */ new WeakSet();\nconst debounceReload = (time) => {\n\tlet timer;\n\treturn () => {\n\t\tif (timer) {\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = null;\n\t\t}\n\t\ttimer = setTimeout(() => {\n\t\t\tlocation.reload();\n\t\t}, time);\n\t};\n};\nconst pageReload = debounceReload(20);\nconst hmrClient = new HMRClient({\n\terror: (err) => console.error(\"[vite]\", err),\n\tdebug: (...msg) => console.debug(\"[vite]\", ...msg)\n}, transport, async function importUpdatedModule({ acceptedPath, timestamp, explicitImportRequired, isWithinCircularImport }) {\n\tconst [acceptedPathWithoutQuery, query] = acceptedPath.split(`?`);\n\tconst importPromise = import(\n\t\t/* @vite-ignore */\n\t\tbase + acceptedPathWithoutQuery.slice(1) + `?${explicitImportRequired ? \"import&\" : \"\"}t=${timestamp}${query ? `&${query}` : \"\"}`\n);\n\tif (isWithinCircularImport) importPromise.catch(() => {\n\t\tconsole.info(`[hmr] ${acceptedPath} failed to apply HMR as it's within a circular import. Reloading page to reset the execution order. To debug and break the circular import, you can run \\`vite --debug hmr\\` to log the circular dependency path if a file change triggered it.`);\n\t\tpageReload();\n\t});\n\treturn await importPromise;\n});\ntransport.connect(createHMRHandler(handleMessage));\nasync function handleMessage(payload) {\n\tswitch (payload.type) {\n\t\tcase \"connected\":\n\t\t\tconsole.debug(`[vite] connected.`);\n\t\t\tbreak;\n\t\tcase \"update\":\n\t\t\tawait hmrClient.notifyListeners(\"vite:beforeUpdate\", payload);\n\t\t\tif (hasDocument) if (isFirstUpdate && hasErrorOverlay()) {\n\t\t\t\tlocation.reload();\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tif (enableOverlay) clearErrorOverlay();\n\t\t\t\tisFirstUpdate = false;\n\t\t\t}\n\t\t\tawait Promise.all(payload.updates.map(async (update) => {\n\t\t\t\tif (update.type === \"js-update\") return hmrClient.queueUpdate(update);\n\t\t\t\tconst { path, timestamp } = update;\n\t\t\t\tconst searchUrl = cleanUrl(path);\n\t\t\t\tconst el = Array.from(document.querySelectorAll(\"link\")).find((e) => !outdatedLinkTags.has(e) && cleanUrl(e.href).includes(searchUrl));\n\t\t\t\tif (!el) return;\n\t\t\t\tconst newPath = `${base}${searchUrl.slice(1)}${searchUrl.includes(\"?\") ? \"&\" : \"?\"}t=${timestamp}`;\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst newLinkTag = el.cloneNode();\n\t\t\t\t\tnewLinkTag.href = new URL(newPath, el.href).href;\n\t\t\t\t\tconst removeOldEl = () => {\n\t\t\t\t\t\tel.remove();\n\t\t\t\t\t\tconsole.debug(`[vite] css hot updated: ${searchUrl}`);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t};\n\t\t\t\t\tnewLinkTag.addEventListener(\"load\", removeOldEl);\n\t\t\t\t\tnewLinkTag.addEventListener(\"error\", removeOldEl);\n\t\t\t\t\toutdatedLinkTags.add(el);\n\t\t\t\t\tel.after(newLinkTag);\n\t\t\t\t});\n\t\t\t}));\n\t\t\tawait hmrClient.notifyListeners(\"vite:afterUpdate\", payload);\n\t\t\tbreak;\n\t\tcase \"custom\":\n\t\t\tawait hmrClient.notifyListeners(payload.event, payload.data);\n\t\t\tif (payload.event === \"vite:ws:disconnect\") {\n\t\t\t\tif (hasDocument && !willUnload) {\n\t\t\t\t\tconsole.log(`[vite] server connection lost. Polling for restart...`);\n\t\t\t\t\tconst socket = payload.data.webSocket;\n\t\t\t\t\tconst url = new URL(socket.url);\n\t\t\t\t\turl.search = \"\";\n\t\t\t\t\tawait waitForSuccessfulPing(url.href);\n\t\t\t\t\tlocation.reload();\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"full-reload\":\n\t\t\tawait hmrClient.notifyListeners(\"vite:beforeFullReload\", payload);\n\t\t\tif (hasDocument) if (payload.path && payload.path.endsWith(\".html\")) {\n\t\t\t\tconst pagePath = decodeURI(location.pathname);\n\t\t\t\tconst payloadPath = base + payload.path.slice(1);\n\t\t\t\tif (pagePath === payloadPath || payload.path === \"/index.html\" || pagePath.endsWith(\"/\") && pagePath + \"index.html\" === payloadPath) pageReload();\n\t\t\t\treturn;\n\t\t\t} else pageReload();\n\t\t\tbreak;\n\t\tcase \"prune\":\n\t\t\tawait hmrClient.notifyListeners(\"vite:beforePrune\", payload);\n\t\t\tawait hmrClient.prunePaths(payload.paths);\n\t\t\tbreak;\n\t\tcase \"error\":\n\t\t\tawait hmrClient.notifyListeners(\"vite:error\", payload);\n\t\t\tif (hasDocument) {\n\t\t\t\tconst err = payload.err;\n\t\t\t\tif (enableOverlay) createErrorOverlay(err);\n\t\t\t\telse console.error(`[vite] Internal Server Error\\n${err.message}\\n${err.stack}`);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"ping\": break;\n\t\tdefault: return payload;\n\t}\n}\nconst enableOverlay = true;\nconst hasDocument = \"document\" in globalThis;\nfunction createErrorOverlay(err) {\n\tclearErrorOverlay();\n\tconst { customElements: customElements$1 } = globalThis;\n\tif (customElements$1) {\n\t\tconst ErrorOverlayConstructor = customElements$1.get(overlayId);\n\t\tdocument.body.appendChild(new ErrorOverlayConstructor(err));\n\t}\n}\nfunction clearErrorOverlay() {\n\tdocument.querySelectorAll(overlayId).forEach((n) => n.close());\n}\nfunction hasErrorOverlay() {\n\treturn document.querySelectorAll(overlayId).length;\n}\nfunction waitForSuccessfulPing(socketUrl) {\n\tif (typeof SharedWorker === \"undefined\") {\n\t\tconst visibilityManager = {\n\t\t\tcurrentState: document.visibilityState,\n\t\t\tlisteners: /* @__PURE__ */ new Set()\n\t\t};\n\t\tconst onVisibilityChange = () => {\n\t\t\tvisibilityManager.currentState = document.visibilityState;\n\t\t\tfor (const listener of visibilityManager.listeners) listener(visibilityManager.currentState);\n\t\t};\n\t\tdocument.addEventListener(\"visibilitychange\", onVisibilityChange);\n\t\treturn waitForSuccessfulPingInternal(socketUrl, visibilityManager);\n\t}\n\tconst blob = new Blob([\n\t\t\"\\\"use strict\\\";\",\n\t\t`const waitForSuccessfulPingInternal = ${waitForSuccessfulPingInternal.toString()};`,\n\t\t`const fn = ${pingWorkerContentMain.toString()};`,\n\t\t`fn(${JSON.stringify(socketUrl)})`\n\t], { type: \"application/javascript\" });\n\tconst objURL = URL.createObjectURL(blob);\n\tconst sharedWorker = new SharedWorker(objURL);\n\treturn new Promise((resolve, reject) => {\n\t\tconst onVisibilityChange = () => {\n\t\t\tsharedWorker.port.postMessage({ visibility: document.visibilityState });\n\t\t};\n\t\tdocument.addEventListener(\"visibilitychange\", onVisibilityChange);\n\t\tsharedWorker.port.addEventListener(\"message\", (event) => {\n\t\t\tdocument.removeEventListener(\"visibilitychange\", onVisibilityChange);\n\t\t\tsharedWorker.port.close();\n\t\t\tconst data = event.data;\n\t\t\tif (data.type === \"error\") {\n\t\t\t\treject(data.error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresolve();\n\t\t});\n\t\tonVisibilityChange();\n\t\tsharedWorker.port.start();\n\t});\n}\nfunction pingWorkerContentMain(socketUrl) {\n\tself.addEventListener(\"connect\", (_event) => {\n\t\tconst port = _event.ports[0];\n\t\tif (!socketUrl) {\n\t\t\tport.postMessage({\n\t\t\t\ttype: \"error\",\n\t\t\t\terror: /* @__PURE__ */ new Error(\"socketUrl not found\")\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst visibilityManager = {\n\t\t\tcurrentState: \"visible\",\n\t\t\tlisteners: /* @__PURE__ */ new Set()\n\t\t};\n\t\tport.addEventListener(\"message\", (event) => {\n\t\t\tconst { visibility } = event.data;\n\t\t\tvisibilityManager.currentState = visibility;\n\t\t\tconsole.debug(\"[vite] new window visibility\", visibility);\n\t\t\tfor (const listener of visibilityManager.listeners) listener(visibility);\n\t\t});\n\t\tport.start();\n\t\tconsole.debug(\"[vite] connected from window\");\n\t\twaitForSuccessfulPingInternal(socketUrl, visibilityManager).then(() => {\n\t\t\tconsole.debug(\"[vite] ping successful\");\n\t\t\ttry {\n\t\t\t\tport.postMessage({ type: \"success\" });\n\t\t\t} catch (error) {\n\t\t\t\tport.postMessage({\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\terror\n\t\t\t\t});\n\t\t\t}\n\t\t}, (error) => {\n\t\t\tconsole.debug(\"[vite] error happened\", error);\n\t\t\ttry {\n\t\t\t\tport.postMessage({\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\terror\n\t\t\t\t});\n\t\t\t} catch (error$1) {\n\t\t\t\tport.postMessage({\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\terror: error$1\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n}\nasync function waitForSuccessfulPingInternal(socketUrl, visibilityManager, ms = 1e3) {\n\tfunction wait(ms$1) {\n\t\treturn new Promise((resolve) => setTimeout(resolve, ms$1));\n\t}\n\tasync function ping() {\n\t\ttry {\n\t\t\tconst socket = new WebSocket(socketUrl, \"vite-ping\");\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tfunction onOpen() {\n\t\t\t\t\tresolve(true);\n\t\t\t\t\tclose();\n\t\t\t\t}\n\t\t\t\tfunction onError() {\n\t\t\t\t\tresolve(false);\n\t\t\t\t\tclose();\n\t\t\t\t}\n\t\t\t\tfunction close() {\n\t\t\t\t\tsocket.removeEventListener(\"open\", onOpen);\n\t\t\t\t\tsocket.removeEventListener(\"error\", onError);\n\t\t\t\t\tsocket.close();\n\t\t\t\t}\n\t\t\t\tsocket.addEventListener(\"open\", onOpen);\n\t\t\t\tsocket.addEventListener(\"error\", onError);\n\t\t\t});\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t}\n\tfunction waitForWindowShow(visibilityManager$1) {\n\t\treturn new Promise((resolve) => {\n\t\t\tconst onChange = (newVisibility) => {\n\t\t\t\tif (newVisibility === \"visible\") {\n\t\t\t\t\tresolve();\n\t\t\t\t\tvisibilityManager$1.listeners.delete(onChange);\n\t\t\t\t}\n\t\t\t};\n\t\t\tvisibilityManager$1.listeners.add(onChange);\n\t\t});\n\t}\n\tif (await ping()) return;\n\tawait wait(ms);\n\twhile (true) if (visibilityManager.currentState === \"visible\") {\n\t\tif (await ping()) break;\n\t\tawait wait(ms);\n\t} else await waitForWindowShow(visibilityManager);\n}\nconst sheetsMap = /* @__PURE__ */ new Map();\nconst linkSheetsMap = /* @__PURE__ */ new Map();\nif (\"document\" in globalThis) {\n\tdocument.querySelectorAll(\"style[data-vite-dev-id]\").forEach((el) => {\n\t\tsheetsMap.set(el.getAttribute(\"data-vite-dev-id\"), el);\n\t});\n\tdocument.querySelectorAll(\"link[rel=\\\"stylesheet\\\"][data-vite-dev-id]\").forEach((el) => {\n\t\tlinkSheetsMap.set(el.getAttribute(\"data-vite-dev-id\"), el);\n\t});\n}\nlet lastInsertedStyle;\nfunction updateStyle(id, content) {\n\tif (linkSheetsMap.has(id)) return;\n\tlet style = sheetsMap.get(id);\n\tif (!style) {\n\t\tstyle = document.createElement(\"style\");\n\t\tstyle.setAttribute(\"type\", \"text/css\");\n\t\tstyle.setAttribute(\"data-vite-dev-id\", id);\n\t\tstyle.textContent = content;\n\t\tif (cspNonce) style.setAttribute(\"nonce\", cspNonce);\n\t\tif (!lastInsertedStyle) {\n\t\t\tdocument.head.appendChild(style);\n\t\t\tsetTimeout(() => {\n\t\t\t\tlastInsertedStyle = void 0;\n\t\t\t}, 0);\n\t\t} else lastInsertedStyle.insertAdjacentElement(\"afterend\", style);\n\t\tlastInsertedStyle = style;\n\t} else style.textContent = content;\n\tsheetsMap.set(id, style);\n}\nfunction removeStyle(id) {\n\tif (linkSheetsMap.has(id)) {\n\t\tdocument.querySelectorAll(`link[rel=\"stylesheet\"][data-vite-dev-id]`).forEach((el) => {\n\t\t\tif (el.getAttribute(\"data-vite-dev-id\") === id) el.remove();\n\t\t});\n\t\tlinkSheetsMap.delete(id);\n\t}\n\tconst style = sheetsMap.get(id);\n\tif (style) {\n\t\tdocument.head.removeChild(style);\n\t\tsheetsMap.delete(id);\n\t}\n}\nfunction createHotContext(ownerPath) {\n\treturn new HMRContext(hmrClient, ownerPath);\n}\n/**\n* urls here are dynamic import() urls that couldn't be statically analyzed\n*/\nfunction injectQuery(url, queryToInject) {\n\tif (url[0] !== \".\" && url[0] !== \"/\") return url;\n\tconst pathname = url.replace(/[?#].*$/, \"\");\n\tconst { search, hash } = new URL(url, \"http://vite.dev\");\n\treturn `${pathname}?${queryToInject}${search ? `&` + search.slice(1) : \"\"}${hash || \"\"}`;\n}\n\n//#endregion\nexport { ErrorOverlay, createHotContext, injectQuery, removeStyle, updateStyle };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXCIvQGZzL0M6L1VzZXJzL21vdXJhL0RvY3VtZW50cy9TY2FmZm9sZC9mcm9udGVuZC9ub2RlX21vZHVsZXMvdml0ZS9kaXN0L2NsaWVudC9lbnYubWpzXCI7XG5cbi8vI3JlZ2lvbiBcXDBAb3hjLXByb2plY3QrcnVudGltZUAwLjk5LjAvaGVscGVycy90eXBlb2YuanNcbmZ1bmN0aW9uIF90eXBlb2Yobykge1xuXHRcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cdHJldHVybiBfdHlwZW9mID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgXCJzeW1ib2xcIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24obyQxKSB7XG5cdFx0cmV0dXJuIHR5cGVvZiBvJDE7XG5cdH0gOiBmdW5jdGlvbihvJDEpIHtcblx0XHRyZXR1cm4gbyQxICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgU3ltYm9sICYmIG8kMS5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8kMSAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2YgbyQxO1xuXHR9LCBfdHlwZW9mKG8pO1xufVxuXG4vLyNlbmRyZWdpb25cbi8vI3JlZ2lvbiBcXDBAb3hjLXByb2plY3QrcnVudGltZUAwLjk5LjAvaGVscGVycy90b1ByaW1pdGl2ZS5qc1xuZnVuY3Rpb24gdG9QcmltaXRpdmUodCwgcikge1xuXHRpZiAoXCJvYmplY3RcIiAhPSBfdHlwZW9mKHQpIHx8ICF0KSByZXR1cm4gdDtcblx0dmFyIGUgPSB0W1N5bWJvbC50b1ByaW1pdGl2ZV07XG5cdGlmICh2b2lkIDAgIT09IGUpIHtcblx0XHR2YXIgaSA9IGUuY2FsbCh0LCByIHx8IFwiZGVmYXVsdFwiKTtcblx0XHRpZiAoXCJvYmplY3RcIiAhPSBfdHlwZW9mKGkpKSByZXR1cm4gaTtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIik7XG5cdH1cblx0cmV0dXJuIChcInN0cmluZ1wiID09PSByID8gU3RyaW5nIDogTnVtYmVyKSh0KTtcbn1cblxuLy8jZW5kcmVnaW9uXG4vLyNyZWdpb24gXFwwQG94Yy1wcm9qZWN0K3J1bnRpbWVAMC45OS4wL2hlbHBlcnMvdG9Qcm9wZXJ0eUtleS5qc1xuZnVuY3Rpb24gdG9Qcm9wZXJ0eUtleSh0KSB7XG5cdHZhciBpID0gdG9QcmltaXRpdmUodCwgXCJzdHJpbmdcIik7XG5cdHJldHVybiBcInN5bWJvbFwiID09IF90eXBlb2YoaSkgPyBpIDogaSArIFwiXCI7XG59XG5cbi8vI2VuZHJlZ2lvblxuLy8jcmVnaW9uIFxcMEBveGMtcHJvamVjdCtydW50aW1lQDAuOTkuMC9oZWxwZXJzL2RlZmluZVByb3BlcnR5LmpzXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkoZSwgciwgdCkge1xuXHRyZXR1cm4gKHIgPSB0b1Byb3BlcnR5S2V5KHIpKSBpbiBlID8gT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIHtcblx0XHR2YWx1ZTogdCxcblx0XHRlbnVtZXJhYmxlOiAhMCxcblx0XHRjb25maWd1cmFibGU6ICEwLFxuXHRcdHdyaXRhYmxlOiAhMFxuXHR9KSA6IGVbcl0gPSB0LCBlO1xufVxuXG4vLyNlbmRyZWdpb25cbi8vI3JlZ2lvbiBzcmMvc2hhcmVkL2htci50c1xudmFyIEhNUkNvbnRleHQgPSBjbGFzcyB7XG5cdGNvbnN0cnVjdG9yKGhtckNsaWVudCQxLCBvd25lclBhdGgpIHtcblx0XHR0aGlzLmhtckNsaWVudCA9IGhtckNsaWVudCQxO1xuXHRcdHRoaXMub3duZXJQYXRoID0gb3duZXJQYXRoO1xuXHRcdF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5ld0xpc3RlbmVyc1wiLCB2b2lkIDApO1xuXHRcdGlmICghaG1yQ2xpZW50JDEuZGF0YU1hcC5oYXMob3duZXJQYXRoKSkgaG1yQ2xpZW50JDEuZGF0YU1hcC5zZXQob3duZXJQYXRoLCB7fSk7XG5cdFx0Y29uc3QgbW9kID0gaG1yQ2xpZW50JDEuaG90TW9kdWxlc01hcC5nZXQob3duZXJQYXRoKTtcblx0XHRpZiAobW9kKSBtb2QuY2FsbGJhY2tzID0gW107XG5cdFx0Y29uc3Qgc3RhbGVMaXN0ZW5lcnMgPSBobXJDbGllbnQkMS5jdHhUb0xpc3RlbmVyc01hcC5nZXQob3duZXJQYXRoKTtcblx0XHRpZiAoc3RhbGVMaXN0ZW5lcnMpIGZvciAoY29uc3QgW2V2ZW50LCBzdGFsZUZuc10gb2Ygc3RhbGVMaXN0ZW5lcnMpIHtcblx0XHRcdGNvbnN0IGxpc3RlbmVycyA9IGhtckNsaWVudCQxLmN1c3RvbUxpc3RlbmVyc01hcC5nZXQoZXZlbnQpO1xuXHRcdFx0aWYgKGxpc3RlbmVycykgaG1yQ2xpZW50JDEuY3VzdG9tTGlzdGVuZXJzTWFwLnNldChldmVudCwgbGlzdGVuZXJzLmZpbHRlcigobCkgPT4gIXN0YWxlRm5zLmluY2x1ZGVzKGwpKSk7XG5cdFx0fVxuXHRcdHRoaXMubmV3TGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcblx0XHRobXJDbGllbnQkMS5jdHhUb0xpc3RlbmVyc01hcC5zZXQob3duZXJQYXRoLCB0aGlzLm5ld0xpc3RlbmVycyk7XG5cdH1cblx0Z2V0IGRhdGEoKSB7XG5cdFx0cmV0dXJuIHRoaXMuaG1yQ2xpZW50LmRhdGFNYXAuZ2V0KHRoaXMub3duZXJQYXRoKTtcblx0fVxuXHRhY2NlcHQoZGVwcywgY2FsbGJhY2spIHtcblx0XHRpZiAodHlwZW9mIGRlcHMgPT09IFwiZnVuY3Rpb25cIiB8fCAhZGVwcykgdGhpcy5hY2NlcHREZXBzKFt0aGlzLm93bmVyUGF0aF0sIChbbW9kXSkgPT4gZGVwcz8uKG1vZCkpO1xuXHRcdGVsc2UgaWYgKHR5cGVvZiBkZXBzID09PSBcInN0cmluZ1wiKSB0aGlzLmFjY2VwdERlcHMoW2RlcHNdLCAoW21vZF0pID0+IGNhbGxiYWNrPy4obW9kKSk7XG5cdFx0ZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkZXBzKSkgdGhpcy5hY2NlcHREZXBzKGRlcHMsIGNhbGxiYWNrKTtcblx0XHRlbHNlIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBob3QuYWNjZXB0KCkgdXNhZ2UuYCk7XG5cdH1cblx0YWNjZXB0RXhwb3J0cyhfLCBjYWxsYmFjaykge1xuXHRcdHRoaXMuYWNjZXB0RGVwcyhbdGhpcy5vd25lclBhdGhdLCAoW21vZF0pID0+IGNhbGxiYWNrPy4obW9kKSk7XG5cdH1cblx0ZGlzcG9zZShjYikge1xuXHRcdHRoaXMuaG1yQ2xpZW50LmRpc3Bvc2VNYXAuc2V0KHRoaXMub3duZXJQYXRoLCBjYik7XG5cdH1cblx0cHJ1bmUoY2IpIHtcblx0XHR0aGlzLmhtckNsaWVudC5wcnVuZU1hcC5zZXQodGhpcy5vd25lclBhdGgsIGNiKTtcblx0fVxuXHRkZWNsaW5lKCkge31cblx0aW52YWxpZGF0ZShtZXNzYWdlKSB7XG5cdFx0Y29uc3QgZmlyc3RJbnZhbGlkYXRlZEJ5ID0gdGhpcy5obXJDbGllbnQuY3VycmVudEZpcnN0SW52YWxpZGF0ZWRCeSA/PyB0aGlzLm93bmVyUGF0aDtcblx0XHR0aGlzLmhtckNsaWVudC5ub3RpZnlMaXN0ZW5lcnMoXCJ2aXRlOmludmFsaWRhdGVcIiwge1xuXHRcdFx0cGF0aDogdGhpcy5vd25lclBhdGgsXG5cdFx0XHRtZXNzYWdlLFxuXHRcdFx0Zmlyc3RJbnZhbGlkYXRlZEJ5XG5cdFx0fSk7XG5cdFx0dGhpcy5zZW5kKFwidml0ZTppbnZhbGlkYXRlXCIsIHtcblx0XHRcdHBhdGg6IHRoaXMub3duZXJQYXRoLFxuXHRcdFx0bWVzc2FnZSxcblx0XHRcdGZpcnN0SW52YWxpZGF0ZWRCeVxuXHRcdH0pO1xuXHRcdHRoaXMuaG1yQ2xpZW50LmxvZ2dlci5kZWJ1ZyhgaW52YWxpZGF0ZSAke3RoaXMub3duZXJQYXRofSR7bWVzc2FnZSA/IGA6ICR7bWVzc2FnZX1gIDogXCJcIn1gKTtcblx0fVxuXHRvbihldmVudCwgY2IpIHtcblx0XHRjb25zdCBhZGRUb01hcCA9IChtYXApID0+IHtcblx0XHRcdGNvbnN0IGV4aXN0aW5nID0gbWFwLmdldChldmVudCkgfHwgW107XG5cdFx0XHRleGlzdGluZy5wdXNoKGNiKTtcblx0XHRcdG1hcC5zZXQoZXZlbnQsIGV4aXN0aW5nKTtcblx0XHR9O1xuXHRcdGFkZFRvTWFwKHRoaXMuaG1yQ2xpZW50LmN1c3RvbUxpc3RlbmVyc01hcCk7XG5cdFx0YWRkVG9NYXAodGhpcy5uZXdMaXN0ZW5lcnMpO1xuXHR9XG5cdG9mZihldmVudCwgY2IpIHtcblx0XHRjb25zdCByZW1vdmVGcm9tTWFwID0gKG1hcCkgPT4ge1xuXHRcdFx0Y29uc3QgZXhpc3RpbmcgPSBtYXAuZ2V0KGV2ZW50KTtcblx0XHRcdGlmIChleGlzdGluZyA9PT0gdm9pZCAwKSByZXR1cm47XG5cdFx0XHRjb25zdCBwcnVuZWQgPSBleGlzdGluZy5maWx0ZXIoKGwpID0+IGwgIT09IGNiKTtcblx0XHRcdGlmIChwcnVuZWQubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdG1hcC5kZWxldGUoZXZlbnQpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRtYXAuc2V0KGV2ZW50LCBwcnVuZWQpO1xuXHRcdH07XG5cdFx0cmVtb3ZlRnJvbU1hcCh0aGlzLmhtckNsaWVudC5jdXN0b21MaXN0ZW5lcnNNYXApO1xuXHRcdHJlbW92ZUZyb21NYXAodGhpcy5uZXdMaXN0ZW5lcnMpO1xuXHR9XG5cdHNlbmQoZXZlbnQsIGRhdGEpIHtcblx0XHR0aGlzLmhtckNsaWVudC5zZW5kKHtcblx0XHRcdHR5cGU6IFwiY3VzdG9tXCIsXG5cdFx0XHRldmVudCxcblx0XHRcdGRhdGFcblx0XHR9KTtcblx0fVxuXHRhY2NlcHREZXBzKGRlcHMsIGNhbGxiYWNrID0gKCkgPT4ge30pIHtcblx0XHRjb25zdCBtb2QgPSB0aGlzLmhtckNsaWVudC5ob3RNb2R1bGVzTWFwLmdldCh0aGlzLm93bmVyUGF0aCkgfHwge1xuXHRcdFx0aWQ6IHRoaXMub3duZXJQYXRoLFxuXHRcdFx0Y2FsbGJhY2tzOiBbXVxuXHRcdH07XG5cdFx0bW9kLmNhbGxiYWNrcy5wdXNoKHtcblx0XHRcdGRlcHMsXG5cdFx0XHRmbjogY2FsbGJhY2tcblx0XHR9KTtcblx0XHR0aGlzLmhtckNsaWVudC5ob3RNb2R1bGVzTWFwLnNldCh0aGlzLm93bmVyUGF0aCwgbW9kKTtcblx0fVxufTtcbnZhciBITVJDbGllbnQgPSBjbGFzcyB7XG5cdGNvbnN0cnVjdG9yKGxvZ2dlciwgdHJhbnNwb3J0JDEsIGltcG9ydFVwZGF0ZWRNb2R1bGUpIHtcblx0XHR0aGlzLmxvZ2dlciA9IGxvZ2dlcjtcblx0XHR0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydCQxO1xuXHRcdHRoaXMuaW1wb3J0VXBkYXRlZE1vZHVsZSA9IGltcG9ydFVwZGF0ZWRNb2R1bGU7XG5cdFx0X2RlZmluZVByb3BlcnR5KHRoaXMsIFwiaG90TW9kdWxlc01hcFwiLCAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKTtcblx0XHRfZGVmaW5lUHJvcGVydHkodGhpcywgXCJkaXNwb3NlTWFwXCIsIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpO1xuXHRcdF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBydW5lTWFwXCIsIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpO1xuXHRcdF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRhdGFNYXBcIiwgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSk7XG5cdFx0X2RlZmluZVByb3BlcnR5KHRoaXMsIFwiY3VzdG9tTGlzdGVuZXJzTWFwXCIsIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpO1xuXHRcdF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImN0eFRvTGlzdGVuZXJzTWFwXCIsIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpO1xuXHRcdF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImN1cnJlbnRGaXJzdEludmFsaWRhdGVkQnlcIiwgdm9pZCAwKTtcblx0XHRfZGVmaW5lUHJvcGVydHkodGhpcywgXCJ1cGRhdGVRdWV1ZVwiLCBbXSk7XG5cdFx0X2RlZmluZVByb3BlcnR5KHRoaXMsIFwicGVuZGluZ1VwZGF0ZVF1ZXVlXCIsIGZhbHNlKTtcblx0fVxuXHRhc3luYyBub3RpZnlMaXN0ZW5lcnMoZXZlbnQsIGRhdGEpIHtcblx0XHRjb25zdCBjYnMgPSB0aGlzLmN1c3RvbUxpc3RlbmVyc01hcC5nZXQoZXZlbnQpO1xuXHRcdGlmIChjYnMpIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChjYnMubWFwKChjYikgPT4gY2IoZGF0YSkpKTtcblx0fVxuXHRzZW5kKHBheWxvYWQpIHtcblx0XHR0aGlzLnRyYW5zcG9ydC5zZW5kKHBheWxvYWQpLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdHRoaXMubG9nZ2VyLmVycm9yKGVycik7XG5cdFx0fSk7XG5cdH1cblx0Y2xlYXIoKSB7XG5cdFx0dGhpcy5ob3RNb2R1bGVzTWFwLmNsZWFyKCk7XG5cdFx0dGhpcy5kaXNwb3NlTWFwLmNsZWFyKCk7XG5cdFx0dGhpcy5wcnVuZU1hcC5jbGVhcigpO1xuXHRcdHRoaXMuZGF0YU1hcC5jbGVhcigpO1xuXHRcdHRoaXMuY3VzdG9tTGlzdGVuZXJzTWFwLmNsZWFyKCk7XG5cdFx0dGhpcy5jdHhUb0xpc3RlbmVyc01hcC5jbGVhcigpO1xuXHR9XG5cdGFzeW5jIHBydW5lUGF0aHMocGF0aHMpIHtcblx0XHRhd2FpdCBQcm9taXNlLmFsbChwYXRocy5tYXAoKHBhdGgpID0+IHtcblx0XHRcdGNvbnN0IGRpc3Bvc2VyID0gdGhpcy5kaXNwb3NlTWFwLmdldChwYXRoKTtcblx0XHRcdGlmIChkaXNwb3NlcikgcmV0dXJuIGRpc3Bvc2VyKHRoaXMuZGF0YU1hcC5nZXQocGF0aCkpO1xuXHRcdH0pKTtcblx0XHRhd2FpdCBQcm9taXNlLmFsbChwYXRocy5tYXAoKHBhdGgpID0+IHtcblx0XHRcdGNvbnN0IGZuID0gdGhpcy5wcnVuZU1hcC5nZXQocGF0aCk7XG5cdFx0XHRpZiAoZm4pIHJldHVybiBmbih0aGlzLmRhdGFNYXAuZ2V0KHBhdGgpKTtcblx0XHR9KSk7XG5cdH1cblx0d2FybkZhaWxlZFVwZGF0ZShlcnIsIHBhdGgpIHtcblx0XHRpZiAoIShlcnIgaW5zdGFuY2VvZiBFcnJvcikgfHwgIWVyci5tZXNzYWdlLmluY2x1ZGVzKFwiZmV0Y2hcIikpIHRoaXMubG9nZ2VyLmVycm9yKGVycik7XG5cdFx0dGhpcy5sb2dnZXIuZXJyb3IoYEZhaWxlZCB0byByZWxvYWQgJHtwYXRofS4gVGhpcyBjb3VsZCBiZSBkdWUgdG8gc3ludGF4IGVycm9ycyBvciBpbXBvcnRpbmcgbm9uLWV4aXN0ZW50IG1vZHVsZXMuIChzZWUgZXJyb3JzIGFib3ZlKWApO1xuXHR9XG5cdC8qKlxuXHQqIGJ1ZmZlciBtdWx0aXBsZSBob3QgdXBkYXRlcyB0cmlnZ2VyZWQgYnkgdGhlIHNhbWUgc3JjIGNoYW5nZVxuXHQqIHNvIHRoYXQgdGhleSBhcmUgaW52b2tlZCBpbiB0aGUgc2FtZSBvcmRlciB0aGV5IHdlcmUgc2VudC5cblx0KiAob3RoZXJ3aXNlIHRoZSBvcmRlciBtYXkgYmUgaW5jb25zaXN0ZW50IGJlY2F1c2Ugb2YgdGhlIGh0dHAgcmVxdWVzdCByb3VuZCB0cmlwKVxuXHQqL1xuXHRhc3luYyBxdWV1ZVVwZGF0ZShwYXlsb2FkKSB7XG5cdFx0dGhpcy51cGRhdGVRdWV1ZS5wdXNoKHRoaXMuZmV0Y2hVcGRhdGUocGF5bG9hZCkpO1xuXHRcdGlmICghdGhpcy5wZW5kaW5nVXBkYXRlUXVldWUpIHtcblx0XHRcdHRoaXMucGVuZGluZ1VwZGF0ZVF1ZXVlID0gdHJ1ZTtcblx0XHRcdGF3YWl0IFByb21pc2UucmVzb2x2ZSgpO1xuXHRcdFx0dGhpcy5wZW5kaW5nVXBkYXRlUXVldWUgPSBmYWxzZTtcblx0XHRcdGNvbnN0IGxvYWRpbmcgPSBbLi4udGhpcy51cGRhdGVRdWV1ZV07XG5cdFx0XHR0aGlzLnVwZGF0ZVF1ZXVlID0gW107XG5cdFx0XHQoYXdhaXQgUHJvbWlzZS5hbGwobG9hZGluZykpLmZvckVhY2goKGZuKSA9PiBmbiAmJiBmbigpKTtcblx0XHR9XG5cdH1cblx0YXN5bmMgZmV0Y2hVcGRhdGUodXBkYXRlKSB7XG5cdFx0Y29uc3QgeyBwYXRoLCBhY2NlcHRlZFBhdGgsIGZpcnN0SW52YWxpZGF0ZWRCeSB9ID0gdXBkYXRlO1xuXHRcdGNvbnN0IG1vZCA9IHRoaXMuaG90TW9kdWxlc01hcC5nZXQocGF0aCk7XG5cdFx0aWYgKCFtb2QpIHJldHVybjtcblx0XHRsZXQgZmV0Y2hlZE1vZHVsZTtcblx0XHRjb25zdCBpc1NlbGZVcGRhdGUgPSBwYXRoID09PSBhY2NlcHRlZFBhdGg7XG5cdFx0Y29uc3QgcXVhbGlmaWVkQ2FsbGJhY2tzID0gbW9kLmNhbGxiYWNrcy5maWx0ZXIoKHsgZGVwcyB9KSA9PiBkZXBzLmluY2x1ZGVzKGFjY2VwdGVkUGF0aCkpO1xuXHRcdGlmIChpc1NlbGZVcGRhdGUgfHwgcXVhbGlmaWVkQ2FsbGJhY2tzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IGRpc3Bvc2VyID0gdGhpcy5kaXNwb3NlTWFwLmdldChhY2NlcHRlZFBhdGgpO1xuXHRcdFx0aWYgKGRpc3Bvc2VyKSBhd2FpdCBkaXNwb3Nlcih0aGlzLmRhdGFNYXAuZ2V0KGFjY2VwdGVkUGF0aCkpO1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0ZmV0Y2hlZE1vZHVsZSA9IGF3YWl0IHRoaXMuaW1wb3J0VXBkYXRlZE1vZHVsZSh1cGRhdGUpO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHR0aGlzLndhcm5GYWlsZWRVcGRhdGUoZSwgYWNjZXB0ZWRQYXRoKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuICgpID0+IHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudEZpcnN0SW52YWxpZGF0ZWRCeSA9IGZpcnN0SW52YWxpZGF0ZWRCeTtcblx0XHRcdFx0Zm9yIChjb25zdCB7IGRlcHMsIGZuIH0gb2YgcXVhbGlmaWVkQ2FsbGJhY2tzKSBmbihkZXBzLm1hcCgoZGVwKSA9PiBkZXAgPT09IGFjY2VwdGVkUGF0aCA/IGZldGNoZWRNb2R1bGUgOiB2b2lkIDApKTtcblx0XHRcdFx0Y29uc3QgbG9nZ2VkUGF0aCA9IGlzU2VsZlVwZGF0ZSA/IHBhdGggOiBgJHthY2NlcHRlZFBhdGh9IHZpYSAke3BhdGh9YDtcblx0XHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoYGhvdCB1cGRhdGVkOiAke2xvZ2dlZFBhdGh9YCk7XG5cdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRGaXJzdEludmFsaWRhdGVkQnkgPSB2b2lkIDA7XG5cdFx0XHR9XG5cdFx0fTtcblx0fVxufTtcblxuLy8jZW5kcmVnaW9uXG4vLyNyZWdpb24gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL25hbm9pZEA1LjEuNi9ub2RlX21vZHVsZXMvbmFub2lkL25vbi1zZWN1cmUvaW5kZXguanNcbmxldCB1cmxBbHBoYWJldCA9IFwidXNlYW5kb20tMjZUMTk4MzQwUFg3NXB4SkFDS1ZFUllNSU5EQlVTSFdPTEZfR1FaYmZnaGprbHF2d3l6cmljdFwiO1xubGV0IG5hbm9pZCA9IChzaXplID0gMjEpID0+IHtcblx0bGV0IGlkID0gXCJcIjtcblx0bGV0IGkgPSBzaXplIHwgMDtcblx0d2hpbGUgKGktLSkgaWQgKz0gdXJsQWxwaGFiZXRbTWF0aC5yYW5kb20oKSAqIDY0IHwgMF07XG5cdHJldHVybiBpZDtcbn07XG5cbi8vI2VuZHJlZ2lvblxuLy8jcmVnaW9uIHNyYy9zaGFyZWQvY29uc3RhbnRzLnRzXG5sZXQgU09VUkNFTUFQUElOR19VUkwgPSBcInNvdXJjZU1hXCI7XG5TT1VSQ0VNQVBQSU5HX1VSTCArPSBcInBwaW5nVVJMXCI7XG5cbi8vI2VuZHJlZ2lvblxuLy8jcmVnaW9uIHNyYy9zaGFyZWQvdXRpbHMudHNcbmNvbnN0IGlzV2luZG93cyA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MucGxhdGZvcm0gPT09IFwid2luMzJcIjtcbmNvbnN0IEFzeW5jRnVuY3Rpb24gPSBhc3luYyBmdW5jdGlvbigpIHt9LmNvbnN0cnVjdG9yO1xuZnVuY3Rpb24gcHJvbWlzZVdpdGhSZXNvbHZlcnMoKSB7XG5cdGxldCByZXNvbHZlO1xuXHRsZXQgcmVqZWN0O1xuXHRyZXR1cm4ge1xuXHRcdHByb21pc2U6IG5ldyBQcm9taXNlKChfcmVzb2x2ZSwgX3JlamVjdCkgPT4ge1xuXHRcdFx0cmVzb2x2ZSA9IF9yZXNvbHZlO1xuXHRcdFx0cmVqZWN0ID0gX3JlamVjdDtcblx0XHR9KSxcblx0XHRyZXNvbHZlLFxuXHRcdHJlamVjdFxuXHR9O1xufVxuXG4vLyNlbmRyZWdpb25cbi8vI3JlZ2lvbiBzcmMvc2hhcmVkL21vZHVsZVJ1bm5lclRyYW5zcG9ydC50c1xuZnVuY3Rpb24gcmV2aXZlSW52b2tlRXJyb3IoZSkge1xuXHRjb25zdCBlcnJvciA9IG5ldyBFcnJvcihlLm1lc3NhZ2UgfHwgXCJVbmtub3duIGludm9rZSBlcnJvclwiKTtcblx0T2JqZWN0LmFzc2lnbihlcnJvciwgZSwgeyBydW5uZXJFcnJvcjogLyogQF9fUFVSRV9fICovIG5ldyBFcnJvcihcIlJ1bm5lckVycm9yXCIpIH0pO1xuXHRyZXR1cm4gZXJyb3I7XG59XG5jb25zdCBjcmVhdGVJbnZva2VhYmxlVHJhbnNwb3J0ID0gKHRyYW5zcG9ydCQxKSA9PiB7XG5cdGlmICh0cmFuc3BvcnQkMS5pbnZva2UpIHJldHVybiB7XG5cdFx0Li4udHJhbnNwb3J0JDEsXG5cdFx0YXN5bmMgaW52b2tlKG5hbWUsIGRhdGEpIHtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRyYW5zcG9ydCQxLmludm9rZSh7XG5cdFx0XHRcdHR5cGU6IFwiY3VzdG9tXCIsXG5cdFx0XHRcdGV2ZW50OiBcInZpdGU6aW52b2tlXCIsXG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRpZDogXCJzZW5kXCIsXG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRkYXRhXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKFwiZXJyb3JcIiBpbiByZXN1bHQpIHRocm93IHJldml2ZUludm9rZUVycm9yKHJlc3VsdC5lcnJvcik7XG5cdFx0XHRyZXR1cm4gcmVzdWx0LnJlc3VsdDtcblx0XHR9XG5cdH07XG5cdGlmICghdHJhbnNwb3J0JDEuc2VuZCB8fCAhdHJhbnNwb3J0JDEuY29ubmVjdCkgdGhyb3cgbmV3IEVycm9yKFwidHJhbnNwb3J0IG11c3QgaW1wbGVtZW50IHNlbmQgYW5kIGNvbm5lY3Qgd2hlbiBpbnZva2UgaXMgbm90IGltcGxlbWVudGVkXCIpO1xuXHRjb25zdCBycGNQcm9taXNlcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5cdHJldHVybiB7XG5cdFx0Li4udHJhbnNwb3J0JDEsXG5cdFx0Y29ubmVjdCh7IG9uTWVzc2FnZSwgb25EaXNjb25uZWN0aW9uIH0pIHtcblx0XHRcdHJldHVybiB0cmFuc3BvcnQkMS5jb25uZWN0KHtcblx0XHRcdFx0b25NZXNzYWdlKHBheWxvYWQpIHtcblx0XHRcdFx0XHRpZiAocGF5bG9hZC50eXBlID09PSBcImN1c3RvbVwiICYmIHBheWxvYWQuZXZlbnQgPT09IFwidml0ZTppbnZva2VcIikge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGF0YSA9IHBheWxvYWQuZGF0YTtcblx0XHRcdFx0XHRcdGlmIChkYXRhLmlkLnN0YXJ0c1dpdGgoXCJyZXNwb25zZTpcIikpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgaW52b2tlSWQgPSBkYXRhLmlkLnNsaWNlKDkpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwcm9taXNlID0gcnBjUHJvbWlzZXMuZ2V0KGludm9rZUlkKTtcblx0XHRcdFx0XHRcdFx0aWYgKCFwcm9taXNlKSByZXR1cm47XG5cdFx0XHRcdFx0XHRcdGlmIChwcm9taXNlLnRpbWVvdXRJZCkgY2xlYXJUaW1lb3V0KHByb21pc2UudGltZW91dElkKTtcblx0XHRcdFx0XHRcdFx0cnBjUHJvbWlzZXMuZGVsZXRlKGludm9rZUlkKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgeyBlcnJvciwgcmVzdWx0IH0gPSBkYXRhLmRhdGE7XG5cdFx0XHRcdFx0XHRcdGlmIChlcnJvcikgcHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuXHRcdFx0XHRcdFx0XHRlbHNlIHByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdG9uTWVzc2FnZShwYXlsb2FkKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0b25EaXNjb25uZWN0aW9uXG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGRpc2Nvbm5lY3QoKSB7XG5cdFx0XHRycGNQcm9taXNlcy5mb3JFYWNoKChwcm9taXNlKSA9PiB7XG5cdFx0XHRcdHByb21pc2UucmVqZWN0KC8qIEBfX1BVUkVfXyAqLyBuZXcgRXJyb3IoYHRyYW5zcG9ydCB3YXMgZGlzY29ubmVjdGVkLCBjYW5ub3QgY2FsbCAke0pTT04uc3RyaW5naWZ5KHByb21pc2UubmFtZSl9YCkpO1xuXHRcdFx0fSk7XG5cdFx0XHRycGNQcm9taXNlcy5jbGVhcigpO1xuXHRcdFx0cmV0dXJuIHRyYW5zcG9ydCQxLmRpc2Nvbm5lY3Q/LigpO1xuXHRcdH0sXG5cdFx0c2VuZChkYXRhKSB7XG5cdFx0XHRyZXR1cm4gdHJhbnNwb3J0JDEuc2VuZChkYXRhKTtcblx0XHR9LFxuXHRcdGFzeW5jIGludm9rZShuYW1lLCBkYXRhKSB7XG5cdFx0XHRjb25zdCBwcm9taXNlSWQgPSBuYW5vaWQoKTtcblx0XHRcdGNvbnN0IHdyYXBwZWREYXRhID0ge1xuXHRcdFx0XHR0eXBlOiBcImN1c3RvbVwiLFxuXHRcdFx0XHRldmVudDogXCJ2aXRlOmludm9rZVwiLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRpZDogYHNlbmQ6JHtwcm9taXNlSWR9YCxcblx0XHRcdFx0XHRkYXRhXG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRjb25zdCBzZW5kUHJvbWlzZSA9IHRyYW5zcG9ydCQxLnNlbmQod3JhcHBlZERhdGEpO1xuXHRcdFx0Y29uc3QgeyBwcm9taXNlLCByZXNvbHZlLCByZWplY3QgfSA9IHByb21pc2VXaXRoUmVzb2x2ZXJzKCk7XG5cdFx0XHRjb25zdCB0aW1lb3V0ID0gdHJhbnNwb3J0JDEudGltZW91dCA/PyA2ZTQ7XG5cdFx0XHRsZXQgdGltZW91dElkO1xuXHRcdFx0aWYgKHRpbWVvdXQgPiAwKSB7XG5cdFx0XHRcdHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdHJwY1Byb21pc2VzLmRlbGV0ZShwcm9taXNlSWQpO1xuXHRcdFx0XHRcdHJlamVjdCgvKiBAX19QVVJFX18gKi8gbmV3IEVycm9yKGB0cmFuc3BvcnQgaW52b2tlIHRpbWVkIG91dCBhZnRlciAke3RpbWVvdXR9bXMgKGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkod3JhcHBlZERhdGEpfSlgKSk7XG5cdFx0XHRcdH0sIHRpbWVvdXQpO1xuXHRcdFx0XHR0aW1lb3V0SWQ/LnVucmVmPy4oKTtcblx0XHRcdH1cblx0XHRcdHJwY1Byb21pc2VzLnNldChwcm9taXNlSWQsIHtcblx0XHRcdFx0cmVzb2x2ZSxcblx0XHRcdFx0cmVqZWN0LFxuXHRcdFx0XHRuYW1lLFxuXHRcdFx0XHR0aW1lb3V0SWRcblx0XHRcdH0pO1xuXHRcdFx0aWYgKHNlbmRQcm9taXNlKSBzZW5kUHJvbWlzZS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuXHRcdFx0XHRycGNQcm9taXNlcy5kZWxldGUocHJvbWlzZUlkKTtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHJldHVybiBhd2FpdCBwcm9taXNlO1xuXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdHRocm93IHJldml2ZUludm9rZUVycm9yKGVycik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xufTtcbmNvbnN0IG5vcm1hbGl6ZU1vZHVsZVJ1bm5lclRyYW5zcG9ydCA9ICh0cmFuc3BvcnQkMSkgPT4ge1xuXHRjb25zdCBpbnZva2VhYmxlVHJhbnNwb3J0ID0gY3JlYXRlSW52b2tlYWJsZVRyYW5zcG9ydCh0cmFuc3BvcnQkMSk7XG5cdGxldCBpc0Nvbm5lY3RlZCA9ICFpbnZva2VhYmxlVHJhbnNwb3J0LmNvbm5lY3Q7XG5cdGxldCBjb25uZWN0aW5nUHJvbWlzZTtcblx0cmV0dXJuIHtcblx0XHQuLi50cmFuc3BvcnQkMSxcblx0XHQuLi5pbnZva2VhYmxlVHJhbnNwb3J0LmNvbm5lY3QgPyB7IGFzeW5jIGNvbm5lY3Qob25NZXNzYWdlKSB7XG5cdFx0XHRpZiAoaXNDb25uZWN0ZWQpIHJldHVybjtcblx0XHRcdGlmIChjb25uZWN0aW5nUHJvbWlzZSkge1xuXHRcdFx0XHRhd2FpdCBjb25uZWN0aW5nUHJvbWlzZTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0Y29uc3QgbWF5YmVQcm9taXNlID0gaW52b2tlYWJsZVRyYW5zcG9ydC5jb25uZWN0KHtcblx0XHRcdFx0b25NZXNzYWdlOiBvbk1lc3NhZ2UgPz8gKCgpID0+IHt9KSxcblx0XHRcdFx0b25EaXNjb25uZWN0aW9uKCkge1xuXHRcdFx0XHRcdGlzQ29ubmVjdGVkID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKG1heWJlUHJvbWlzZSkge1xuXHRcdFx0XHRjb25uZWN0aW5nUHJvbWlzZSA9IG1heWJlUHJvbWlzZTtcblx0XHRcdFx0YXdhaXQgY29ubmVjdGluZ1Byb21pc2U7XG5cdFx0XHRcdGNvbm5lY3RpbmdQcm9taXNlID0gdm9pZCAwO1xuXHRcdFx0fVxuXHRcdFx0aXNDb25uZWN0ZWQgPSB0cnVlO1xuXHRcdH0gfSA6IHt9LFxuXHRcdC4uLmludm9rZWFibGVUcmFuc3BvcnQuZGlzY29ubmVjdCA/IHsgYXN5bmMgZGlzY29ubmVjdCgpIHtcblx0XHRcdGlmICghaXNDb25uZWN0ZWQpIHJldHVybjtcblx0XHRcdGlmIChjb25uZWN0aW5nUHJvbWlzZSkgYXdhaXQgY29ubmVjdGluZ1Byb21pc2U7XG5cdFx0XHRpc0Nvbm5lY3RlZCA9IGZhbHNlO1xuXHRcdFx0YXdhaXQgaW52b2tlYWJsZVRyYW5zcG9ydC5kaXNjb25uZWN0KCk7XG5cdFx0fSB9IDoge30sXG5cdFx0YXN5bmMgc2VuZChkYXRhKSB7XG5cdFx0XHRpZiAoIWludm9rZWFibGVUcmFuc3BvcnQuc2VuZCkgcmV0dXJuO1xuXHRcdFx0aWYgKCFpc0Nvbm5lY3RlZCkgaWYgKGNvbm5lY3RpbmdQcm9taXNlKSBhd2FpdCBjb25uZWN0aW5nUHJvbWlzZTtcblx0XHRcdGVsc2UgdGhyb3cgbmV3IEVycm9yKFwic2VuZCB3YXMgY2FsbGVkIGJlZm9yZSBjb25uZWN0XCIpO1xuXHRcdFx0YXdhaXQgaW52b2tlYWJsZVRyYW5zcG9ydC5zZW5kKGRhdGEpO1xuXHRcdH0sXG5cdFx0YXN5bmMgaW52b2tlKG5hbWUsIGRhdGEpIHtcblx0XHRcdGlmICghaXNDb25uZWN0ZWQpIGlmIChjb25uZWN0aW5nUHJvbWlzZSkgYXdhaXQgY29ubmVjdGluZ1Byb21pc2U7XG5cdFx0XHRlbHNlIHRocm93IG5ldyBFcnJvcihcImludm9rZSB3YXMgY2FsbGVkIGJlZm9yZSBjb25uZWN0XCIpO1xuXHRcdFx0cmV0dXJuIGludm9rZWFibGVUcmFuc3BvcnQuaW52b2tlKG5hbWUsIGRhdGEpO1xuXHRcdH1cblx0fTtcbn07XG5jb25zdCBjcmVhdGVXZWJTb2NrZXRNb2R1bGVSdW5uZXJUcmFuc3BvcnQgPSAob3B0aW9ucykgPT4ge1xuXHRjb25zdCBwaW5nSW50ZXJ2YWwgPSBvcHRpb25zLnBpbmdJbnRlcnZhbCA/PyAzZTQ7XG5cdGxldCB3cztcblx0bGV0IHBpbmdJbnRlcnZhbElkO1xuXHRyZXR1cm4ge1xuXHRcdGFzeW5jIGNvbm5lY3QoeyBvbk1lc3NhZ2UsIG9uRGlzY29ubmVjdGlvbiB9KSB7XG5cdFx0XHRjb25zdCBzb2NrZXQgPSBvcHRpb25zLmNyZWF0ZUNvbm5lY3Rpb24oKTtcblx0XHRcdHNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBhc3luYyAoeyBkYXRhIH0pID0+IHtcblx0XHRcdFx0b25NZXNzYWdlKEpTT04ucGFyc2UoZGF0YSkpO1xuXHRcdFx0fSk7XG5cdFx0XHRsZXQgaXNPcGVuZWQgPSBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0Lk9QRU47XG5cdFx0XHRpZiAoIWlzT3BlbmVkKSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwib3BlblwiLCAoKSA9PiB7XG5cdFx0XHRcdFx0aXNPcGVuZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0fSwgeyBvbmNlOiB0cnVlIH0pO1xuXHRcdFx0XHRzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsb3NlXCIsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRpZiAoIWlzT3BlbmVkKSB7XG5cdFx0XHRcdFx0XHRyZWplY3QoLyogQF9fUFVSRV9fICovIG5ldyBFcnJvcihcIldlYlNvY2tldCBjbG9zZWQgd2l0aG91dCBvcGVuZWQuXCIpKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0b25NZXNzYWdlKHtcblx0XHRcdFx0XHRcdHR5cGU6IFwiY3VzdG9tXCIsXG5cdFx0XHRcdFx0XHRldmVudDogXCJ2aXRlOndzOmRpc2Nvbm5lY3RcIixcblx0XHRcdFx0XHRcdGRhdGE6IHsgd2ViU29ja2V0OiBzb2NrZXQgfVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdG9uRGlzY29ubmVjdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdFx0b25NZXNzYWdlKHtcblx0XHRcdFx0dHlwZTogXCJjdXN0b21cIixcblx0XHRcdFx0ZXZlbnQ6IFwidml0ZTp3czpjb25uZWN0XCIsXG5cdFx0XHRcdGRhdGE6IHsgd2ViU29ja2V0OiBzb2NrZXQgfVxuXHRcdFx0fSk7XG5cdFx0XHR3cyA9IHNvY2tldDtcblx0XHRcdHBpbmdJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuXHRcdFx0XHRpZiAoc29ja2V0LnJlYWR5U3RhdGUgPT09IHNvY2tldC5PUEVOKSBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwicGluZ1wiIH0pKTtcblx0XHRcdH0sIHBpbmdJbnRlcnZhbCk7XG5cdFx0fSxcblx0XHRkaXNjb25uZWN0KCkge1xuXHRcdFx0Y2xlYXJJbnRlcnZhbChwaW5nSW50ZXJ2YWxJZCk7XG5cdFx0XHR3cz8uY2xvc2UoKTtcblx0XHR9LFxuXHRcdHNlbmQoZGF0YSkge1xuXHRcdFx0d3Muc2VuZChKU09OLnN0cmluZ2lmeShkYXRhKSk7XG5cdFx0fVxuXHR9O1xufTtcblxuLy8jZW5kcmVnaW9uXG4vLyNyZWdpb24gc3JjL3NoYXJlZC9obXJIYW5kbGVyLnRzXG5mdW5jdGlvbiBjcmVhdGVITVJIYW5kbGVyKGhhbmRsZXIpIHtcblx0Y29uc3QgcXVldWUgPSBuZXcgUXVldWUoKTtcblx0cmV0dXJuIChwYXlsb2FkKSA9PiBxdWV1ZS5lbnF1ZXVlKCgpID0+IGhhbmRsZXIocGF5bG9hZCkpO1xufVxudmFyIFF1ZXVlID0gY2xhc3Mge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHRfZGVmaW5lUHJvcGVydHkodGhpcywgXCJxdWV1ZVwiLCBbXSk7XG5cdFx0X2RlZmluZVByb3BlcnR5KHRoaXMsIFwicGVuZGluZ1wiLCBmYWxzZSk7XG5cdH1cblx0ZW5xdWV1ZShwcm9taXNlKSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdHRoaXMucXVldWUucHVzaCh7XG5cdFx0XHRcdHByb21pc2UsXG5cdFx0XHRcdHJlc29sdmUsXG5cdFx0XHRcdHJlamVjdFxuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLmRlcXVldWUoKTtcblx0XHR9KTtcblx0fVxuXHRkZXF1ZXVlKCkge1xuXHRcdGlmICh0aGlzLnBlbmRpbmcpIHJldHVybiBmYWxzZTtcblx0XHRjb25zdCBpdGVtID0gdGhpcy5xdWV1ZS5zaGlmdCgpO1xuXHRcdGlmICghaXRlbSkgcmV0dXJuIGZhbHNlO1xuXHRcdHRoaXMucGVuZGluZyA9IHRydWU7XG5cdFx0aXRlbS5wcm9taXNlKCkudGhlbihpdGVtLnJlc29sdmUpLmNhdGNoKGl0ZW0ucmVqZWN0KS5maW5hbGx5KCgpID0+IHtcblx0XHRcdHRoaXMucGVuZGluZyA9IGZhbHNlO1xuXHRcdFx0dGhpcy5kZXF1ZXVlKCk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cbn07XG5cbi8vI2VuZHJlZ2lvblxuLy8jcmVnaW9uIHNyYy9jbGllbnQvb3ZlcmxheS50c1xuY29uc3QgaG1yQ29uZmlnTmFtZSA9IFwidml0ZS5jb25maWcuanNcIjtcbmNvbnN0IGJhc2UkMSA9IFwiL1wiIHx8IFwiL1wiO1xuY29uc3QgY3NwTm9uY2UgPSBcImRvY3VtZW50XCIgaW4gZ2xvYmFsVGhpcyA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtZXRhW3Byb3BlcnR5PWNzcC1ub25jZV1cIik/Lm5vbmNlIDogdm9pZCAwO1xuZnVuY3Rpb24gaChlLCBhdHRycyA9IHt9LCAuLi5jaGlsZHJlbikge1xuXHRjb25zdCBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChlKTtcblx0Zm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMoYXR0cnMpKSBpZiAodiAhPT0gdm9pZCAwKSBlbGVtLnNldEF0dHJpYnV0ZShrLCB2KTtcblx0ZWxlbS5hcHBlbmQoLi4uY2hpbGRyZW4pO1xuXHRyZXR1cm4gZWxlbTtcbn1cbmNvbnN0IHRlbXBsYXRlU3R5bGUgPSBgXG46aG9zdCB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICB6LWluZGV4OiA5OTk5OTtcbiAgLS1tb25vc3BhY2U6ICdTRk1vbm8tUmVndWxhcicsIENvbnNvbGFzLFxuICAnTGliZXJhdGlvbiBNb25vJywgTWVubG8sIENvdXJpZXIsIG1vbm9zcGFjZTtcbiAgLS1yZWQ6ICNmZjU1NTU7XG4gIC0teWVsbG93OiAjZTJhYTUzO1xuICAtLXB1cnBsZTogI2NmYTRmZjtcbiAgLS1jeWFuOiAjMmRkOWRhO1xuICAtLWRpbTogI2M5YzljOTtcblxuICAtLXdpbmRvdy1iYWNrZ3JvdW5kOiAjMTgxODE4O1xuICAtLXdpbmRvdy1jb2xvcjogI2Q4ZDhkODtcbn1cblxuLmJhY2tkcm9wIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB6LWluZGV4OiA5OTk5OTtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICBvdmVyZmxvdy15OiBzY3JvbGw7XG4gIG1hcmdpbjogMDtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjY2KTtcbn1cblxuLndpbmRvdyB7XG4gIGZvbnQtZmFtaWx5OiB2YXIoLS1tb25vc3BhY2UpO1xuICBsaW5lLWhlaWdodDogMS41O1xuICBtYXgtd2lkdGg6IDgwdnc7XG4gIGNvbG9yOiB2YXIoLS13aW5kb3ctY29sb3IpO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBtYXJnaW46IDMwcHggYXV0bztcbiAgcGFkZGluZzogMi41dmggNHZ3O1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGJhY2tncm91bmQ6IHZhcigtLXdpbmRvdy1iYWNrZ3JvdW5kKTtcbiAgYm9yZGVyLXJhZGl1czogNnB4IDZweCA4cHggOHB4O1xuICBib3gtc2hhZG93OiAwIDE5cHggMzhweCByZ2JhKDAsMCwwLDAuMzApLCAwIDE1cHggMTJweCByZ2JhKDAsMCwwLDAuMjIpO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBib3JkZXItdG9wOiA4cHggc29saWQgdmFyKC0tcmVkKTtcbiAgZGlyZWN0aW9uOiBsdHI7XG4gIHRleHQtYWxpZ246IGxlZnQ7XG59XG5cbnByZSB7XG4gIGZvbnQtZmFtaWx5OiB2YXIoLS1tb25vc3BhY2UpO1xuICBmb250LXNpemU6IDE2cHg7XG4gIG1hcmdpbi10b3A6IDA7XG4gIG1hcmdpbi1ib3R0b206IDFlbTtcbiAgb3ZlcmZsb3cteDogc2Nyb2xsO1xuICBzY3JvbGxiYXItd2lkdGg6IG5vbmU7XG59XG5cbnByZTo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG5wcmUuZnJhbWU6Oi13ZWJraXQtc2Nyb2xsYmFyIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIGhlaWdodDogNXB4O1xufVxuXG5wcmUuZnJhbWU6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcbiAgYmFja2dyb3VuZDogIzk5OTtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xufVxuXG5wcmUuZnJhbWUge1xuICBzY3JvbGxiYXItd2lkdGg6IHRoaW47XG59XG5cbi5tZXNzYWdlIHtcbiAgbGluZS1oZWlnaHQ6IDEuMztcbiAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xufVxuXG4ubWVzc2FnZS1ib2R5IHtcbiAgY29sb3I6IHZhcigtLXJlZCk7XG59XG5cbi5wbHVnaW4ge1xuICBjb2xvcjogdmFyKC0tcHVycGxlKTtcbn1cblxuLmZpbGUge1xuICBjb2xvcjogdmFyKC0tY3lhbik7XG4gIG1hcmdpbi1ib3R0b206IDA7XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbiAgd29yZC1icmVhazogYnJlYWstYWxsO1xufVxuXG4uZnJhbWUge1xuICBjb2xvcjogdmFyKC0teWVsbG93KTtcbn1cblxuLnN0YWNrIHtcbiAgZm9udC1zaXplOiAxM3B4O1xuICBjb2xvcjogdmFyKC0tZGltKTtcbn1cblxuLnRpcCB7XG4gIGZvbnQtc2l6ZTogMTNweDtcbiAgY29sb3I6ICM5OTk7XG4gIGJvcmRlci10b3A6IDFweCBkb3R0ZWQgIzk5OTtcbiAgcGFkZGluZy10b3A6IDEzcHg7XG4gIGxpbmUtaGVpZ2h0OiAxLjg7XG59XG5cbmNvZGUge1xuICBmb250LXNpemU6IDEzcHg7XG4gIGZvbnQtZmFtaWx5OiB2YXIoLS1tb25vc3BhY2UpO1xuICBjb2xvcjogdmFyKC0teWVsbG93KTtcbn1cblxuLmZpbGUtbGluayB7XG4gIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmtiZCB7XG4gIGxpbmUtaGVpZ2h0OiAxLjU7XG4gIGZvbnQtZmFtaWx5OiB1aS1tb25vc3BhY2UsIE1lbmxvLCBNb25hY28sIENvbnNvbGFzLCBcIkxpYmVyYXRpb24gTW9ub1wiLCBcIkNvdXJpZXIgTmV3XCIsIG1vbm9zcGFjZTtcbiAgZm9udC1zaXplOiAwLjc1cmVtO1xuICBmb250LXdlaWdodDogNzAwO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMzgsIDQwLCA0NCk7XG4gIGNvbG9yOiByZ2IoMTY2LCAxNjcsIDE3MSk7XG4gIHBhZGRpbmc6IDAuMTVyZW0gMC4zcmVtO1xuICBib3JkZXItcmFkaXVzOiAwLjI1cmVtO1xuICBib3JkZXItd2lkdGg6IDAuMDYyNXJlbSAwLjA2MjVyZW0gMC4xODc1cmVtO1xuICBib3JkZXItc3R5bGU6IHNvbGlkO1xuICBib3JkZXItY29sb3I6IHJnYig1NCwgNTcsIDY0KTtcbiAgYm9yZGVyLWltYWdlOiBpbml0aWFsO1xufVxuYDtcbmNvbnN0IGNyZWF0ZVRlbXBsYXRlID0gKCkgPT4gaChcImRpdlwiLCB7XG5cdGNsYXNzOiBcImJhY2tkcm9wXCIsXG5cdHBhcnQ6IFwiYmFja2Ryb3BcIlxufSwgaChcImRpdlwiLCB7XG5cdGNsYXNzOiBcIndpbmRvd1wiLFxuXHRwYXJ0OiBcIndpbmRvd1wiXG59LCBoKFwicHJlXCIsIHtcblx0Y2xhc3M6IFwibWVzc2FnZVwiLFxuXHRwYXJ0OiBcIm1lc3NhZ2VcIlxufSwgaChcInNwYW5cIiwge1xuXHRjbGFzczogXCJwbHVnaW5cIixcblx0cGFydDogXCJwbHVnaW5cIlxufSksIGgoXCJzcGFuXCIsIHtcblx0Y2xhc3M6IFwibWVzc2FnZS1ib2R5XCIsXG5cdHBhcnQ6IFwibWVzc2FnZS1ib2R5XCJcbn0pKSwgaChcInByZVwiLCB7XG5cdGNsYXNzOiBcImZpbGVcIixcblx0cGFydDogXCJmaWxlXCJcbn0pLCBoKFwicHJlXCIsIHtcblx0Y2xhc3M6IFwiZnJhbWVcIixcblx0cGFydDogXCJmcmFtZVwiXG59KSwgaChcInByZVwiLCB7XG5cdGNsYXNzOiBcInN0YWNrXCIsXG5cdHBhcnQ6IFwic3RhY2tcIlxufSksIGgoXCJkaXZcIiwge1xuXHRjbGFzczogXCJ0aXBcIixcblx0cGFydDogXCJ0aXBcIlxufSwgXCJDbGljayBvdXRzaWRlLCBwcmVzcyBcIiwgaChcImtiZFwiLCB7fSwgXCJFc2NcIiksIFwiIGtleSwgb3IgZml4IHRoZSBjb2RlIHRvIGRpc21pc3MuXCIsIGgoXCJiclwiKSwgKSksIGgoXCJzdHlsZVwiLCB7IG5vbmNlOiBjc3BOb25jZSB9LCB0ZW1wbGF0ZVN0eWxlKSk7XG5jb25zdCBmaWxlUkUgPSAvKD86ZmlsZTpcXC9cXC8pPyg/OlthLXpBLVpdOlxcXFx8XFwvKS4qPzpcXGQrOlxcZCsvZztcbmNvbnN0IGNvZGVmcmFtZVJFID0gL14oPzo+P1xccypcXGQrXFxzK1xcfC4qfFxccytcXHxcXHMqXFxeLiopXFxyP1xcbi9nbTtcbmNvbnN0IHsgSFRNTEVsZW1lbnQgPSBjbGFzcyB7fSB9ID0gZ2xvYmFsVGhpcztcbnZhciBFcnJvck92ZXJsYXkgPSBjbGFzcyBleHRlbmRzIEhUTUxFbGVtZW50IHtcblx0Y29uc3RydWN0b3IoZXJyLCBsaW5rcyA9IHRydWUpIHtcblx0XHRzdXBlcigpO1xuXHRcdF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJvb3RcIiwgdm9pZCAwKTtcblx0XHRfZGVmaW5lUHJvcGVydHkodGhpcywgXCJjbG9zZU9uRXNjXCIsIHZvaWQgMCk7XG5cdFx0dGhpcy5yb290ID0gdGhpcy5hdHRhY2hTaGFkb3coeyBtb2RlOiBcIm9wZW5cIiB9KTtcblx0XHR0aGlzLnJvb3QuYXBwZW5kQ2hpbGQoY3JlYXRlVGVtcGxhdGUoKSk7XG5cdFx0Y29kZWZyYW1lUkUubGFzdEluZGV4ID0gMDtcblx0XHRjb25zdCBoYXNGcmFtZSA9IGVyci5mcmFtZSAmJiBjb2RlZnJhbWVSRS50ZXN0KGVyci5mcmFtZSk7XG5cdFx0Y29uc3QgbWVzc2FnZSA9IGhhc0ZyYW1lID8gZXJyLm1lc3NhZ2UucmVwbGFjZShjb2RlZnJhbWVSRSwgXCJcIikgOiBlcnIubWVzc2FnZTtcblx0XHRpZiAoZXJyLnBsdWdpbikgdGhpcy50ZXh0KFwiLnBsdWdpblwiLCBgW3BsdWdpbjoke2Vyci5wbHVnaW59XSBgKTtcblx0XHR0aGlzLnRleHQoXCIubWVzc2FnZS1ib2R5XCIsIG1lc3NhZ2UudHJpbSgpKTtcblx0XHRjb25zdCBbZmlsZV0gPSAoZXJyLmxvYz8uZmlsZSB8fCBlcnIuaWQgfHwgXCJ1bmtub3duIGZpbGVcIikuc3BsaXQoYD9gKTtcblx0XHRpZiAoZXJyLmxvYykgdGhpcy50ZXh0KFwiLmZpbGVcIiwgYCR7ZmlsZX06JHtlcnIubG9jLmxpbmV9OiR7ZXJyLmxvYy5jb2x1bW59YCwgbGlua3MpO1xuXHRcdGVsc2UgaWYgKGVyci5pZCkgdGhpcy50ZXh0KFwiLmZpbGVcIiwgZmlsZSk7XG5cdFx0aWYgKGhhc0ZyYW1lKSB0aGlzLnRleHQoXCIuZnJhbWVcIiwgZXJyLmZyYW1lLnRyaW0oKSk7XG5cdFx0dGhpcy50ZXh0KFwiLnN0YWNrXCIsIGVyci5zdGFjaywgbGlua3MpO1xuXHRcdHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKFwiLndpbmRvd1wiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdH0pO1xuXHRcdHRoaXMuY2xvc2VPbkVzYyA9IChlKSA9PiB7XG5cdFx0XHRpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIgfHwgZS5jb2RlID09PSBcIkVzY2FwZVwiKSB0aGlzLmNsb3NlKCk7XG5cdFx0fTtcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmNsb3NlT25Fc2MpO1xuXHR9XG5cdHRleHQoc2VsZWN0b3IsIHRleHQsIGxpbmtGaWxlcyA9IGZhbHNlKSB7XG5cdFx0Y29uc3QgZWwgPSB0aGlzLnJvb3QucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG5cdFx0aWYgKCFsaW5rRmlsZXMpIGVsLnRleHRDb250ZW50ID0gdGV4dDtcblx0XHRlbHNlIHtcblx0XHRcdGxldCBjdXJJbmRleCA9IDA7XG5cdFx0XHRsZXQgbWF0Y2g7XG5cdFx0XHRmaWxlUkUubGFzdEluZGV4ID0gMDtcblx0XHRcdHdoaWxlIChtYXRjaCA9IGZpbGVSRS5leGVjKHRleHQpKSB7XG5cdFx0XHRcdGNvbnN0IHsgMDogZmlsZSwgaW5kZXggfSA9IG1hdGNoO1xuXHRcdFx0XHRjb25zdCBmcmFnID0gdGV4dC5zbGljZShjdXJJbmRleCwgaW5kZXgpO1xuXHRcdFx0XHRlbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShmcmFnKSk7XG5cdFx0XHRcdGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcblx0XHRcdFx0bGluay50ZXh0Q29udGVudCA9IGZpbGU7XG5cdFx0XHRcdGxpbmsuY2xhc3NOYW1lID0gXCJmaWxlLWxpbmtcIjtcblx0XHRcdFx0bGluay5vbmNsaWNrID0gKCkgPT4ge1xuXHRcdFx0XHRcdGZldGNoKG5ldyBVUkwoYCR7YmFzZSQxfV9fb3Blbi1pbi1lZGl0b3I/ZmlsZT0ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlKX1gLCBpbXBvcnQubWV0YS51cmwpKTtcblx0XHRcdFx0fTtcblx0XHRcdFx0ZWwuYXBwZW5kQ2hpbGQobGluayk7XG5cdFx0XHRcdGN1ckluZGV4ICs9IGZyYWcubGVuZ3RoICsgZmlsZS5sZW5ndGg7XG5cdFx0XHR9XG5cdFx0XHRpZiAoY3VySW5kZXggPCB0ZXh0Lmxlbmd0aCkgZWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dC5zbGljZShjdXJJbmRleCkpKTtcblx0XHR9XG5cdH1cblx0Y2xvc2UoKSB7XG5cdFx0dGhpcy5wYXJlbnROb2RlPy5yZW1vdmVDaGlsZCh0aGlzKTtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmNsb3NlT25Fc2MpO1xuXHR9XG59O1xuY29uc3Qgb3ZlcmxheUlkID0gXCJ2aXRlLWVycm9yLW92ZXJsYXlcIjtcbmNvbnN0IHsgY3VzdG9tRWxlbWVudHMgfSA9IGdsb2JhbFRoaXM7XG5pZiAoY3VzdG9tRWxlbWVudHMgJiYgIWN1c3RvbUVsZW1lbnRzLmdldChvdmVybGF5SWQpKSBjdXN0b21FbGVtZW50cy5kZWZpbmUob3ZlcmxheUlkLCBFcnJvck92ZXJsYXkpO1xuXG4vLyNlbmRyZWdpb25cbi8vI3JlZ2lvbiBzcmMvY2xpZW50L2NsaWVudC50c1xuY29uc29sZS5kZWJ1ZyhcIlt2aXRlXSBjb25uZWN0aW5nLi4uXCIpO1xuY29uc3QgaW1wb3J0TWV0YVVybCA9IG5ldyBVUkwoaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IHNlcnZlckhvc3QgPSBcImxvY2FsaG9zdDo0MjAwL1wiO1xuY29uc3Qgc29ja2V0UHJvdG9jb2wgPSBudWxsIHx8IChpbXBvcnRNZXRhVXJsLnByb3RvY29sID09PSBcImh0dHBzOlwiID8gXCJ3c3NcIiA6IFwid3NcIik7XG5jb25zdCBobXJQb3J0ID0gbnVsbDtcbmNvbnN0IHNvY2tldEhvc3QgPSBgJHtudWxsIHx8IGltcG9ydE1ldGFVcmwuaG9zdG5hbWV9OiR7aG1yUG9ydCB8fCBpbXBvcnRNZXRhVXJsLnBvcnR9JHtcIi9cIn1gO1xuY29uc3QgZGlyZWN0U29ja2V0SG9zdCA9IFwibG9jYWxob3N0OjQyMDAvXCI7XG5jb25zdCBiYXNlID0gXCIvXCIgfHwgXCIvXCI7XG5jb25zdCBobXJUaW1lb3V0ID0gMzAwMDA7XG5jb25zdCB3c1Rva2VuID0gXCJoWHJzeTRqUDgwTkZcIjtcbmNvbnN0IHRyYW5zcG9ydCA9IG5vcm1hbGl6ZU1vZHVsZVJ1bm5lclRyYW5zcG9ydCgoKCkgPT4ge1xuXHRsZXQgd3NUcmFuc3BvcnQgPSBjcmVhdGVXZWJTb2NrZXRNb2R1bGVSdW5uZXJUcmFuc3BvcnQoe1xuXHRcdGNyZWF0ZUNvbm5lY3Rpb246ICgpID0+IG5ldyBXZWJTb2NrZXQoYCR7c29ja2V0UHJvdG9jb2x9Oi8vJHtzb2NrZXRIb3N0fT90b2tlbj0ke3dzVG9rZW59YCwgXCJ2aXRlLWhtclwiKSxcblx0XHRwaW5nSW50ZXJ2YWw6IGhtclRpbWVvdXRcblx0fSk7XG5cdHJldHVybiB7XG5cdFx0YXN5bmMgY29ubmVjdChoYW5kbGVycykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgd3NUcmFuc3BvcnQuY29ubmVjdChoYW5kbGVycyk7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGlmICghaG1yUG9ydCkge1xuXHRcdFx0XHRcdHdzVHJhbnNwb3J0ID0gY3JlYXRlV2ViU29ja2V0TW9kdWxlUnVubmVyVHJhbnNwb3J0KHtcblx0XHRcdFx0XHRcdGNyZWF0ZUNvbm5lY3Rpb246ICgpID0+IG5ldyBXZWJTb2NrZXQoYCR7c29ja2V0UHJvdG9jb2x9Oi8vJHtkaXJlY3RTb2NrZXRIb3N0fT90b2tlbj0ke3dzVG9rZW59YCwgXCJ2aXRlLWhtclwiKSxcblx0XHRcdFx0XHRcdHBpbmdJbnRlcnZhbDogaG1yVGltZW91dFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB3c1RyYW5zcG9ydC5jb25uZWN0KGhhbmRsZXJzKTtcblx0XHRcdFx0XHRcdGNvbnNvbGUuaW5mbyhcIlt2aXRlXSBEaXJlY3Qgd2Vic29ja2V0IGNvbm5lY3Rpb24gZmFsbGJhY2suIENoZWNrIG91dCBodHRwczovL3ZpdGUuZGV2L2NvbmZpZy9zZXJ2ZXItb3B0aW9ucy5odG1sI3NlcnZlci1obXIgdG8gcmVtb3ZlIHRoZSBwcmV2aW91cyBjb25uZWN0aW9uIGVycm9yLlwiKTtcblx0XHRcdFx0XHR9IGNhdGNoIChlJDEpIHtcblx0XHRcdFx0XHRcdGlmIChlJDEgaW5zdGFuY2VvZiBFcnJvciAmJiBlJDEubWVzc2FnZS5pbmNsdWRlcyhcIldlYlNvY2tldCBjbG9zZWQgd2l0aG91dCBvcGVuZWQuXCIpKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRTY3JpcHRIb3N0VVJMID0gbmV3IFVSTChpbXBvcnQubWV0YS51cmwpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50U2NyaXB0SG9zdCA9IGN1cnJlbnRTY3JpcHRIb3N0VVJMLmhvc3QgKyBjdXJyZW50U2NyaXB0SG9zdFVSTC5wYXRobmFtZS5yZXBsYWNlKC9Adml0ZVxcL2NsaWVudCQvLCBcIlwiKTtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihgW3ZpdGVdIGZhaWxlZCB0byBjb25uZWN0IHRvIHdlYnNvY2tldC5cbnlvdXIgY3VycmVudCBzZXR1cDpcbiAgKGJyb3dzZXIpICR7Y3VycmVudFNjcmlwdEhvc3R9IDwtLVtIVFRQXS0tPiAke3NlcnZlckhvc3R9IChzZXJ2ZXIpXFxuICAoYnJvd3NlcikgJHtzb2NrZXRIb3N0fSA8LS1bV2ViU29ja2V0IChmYWlsaW5nKV0tLT4gJHtkaXJlY3RTb2NrZXRIb3N0fSAoc2VydmVyKVxcbkNoZWNrIG91dCB5b3VyIFZpdGUgLyBuZXR3b3JrIGNvbmZpZ3VyYXRpb24gYW5kIGh0dHBzOi8vdml0ZS5kZXYvY29uZmlnL3NlcnZlci1vcHRpb25zLmh0bWwjc2VydmVyLWhtciAuYCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zb2xlLmVycm9yKGBbdml0ZV0gZmFpbGVkIHRvIGNvbm5lY3QgdG8gd2Vic29ja2V0ICgke2V9KS4gYCk7XG5cdFx0XHRcdHRocm93IGU7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRhc3luYyBkaXNjb25uZWN0KCkge1xuXHRcdFx0YXdhaXQgd3NUcmFuc3BvcnQuZGlzY29ubmVjdCgpO1xuXHRcdH0sXG5cdFx0c2VuZChkYXRhKSB7XG5cdFx0XHR3c1RyYW5zcG9ydC5zZW5kKGRhdGEpO1xuXHRcdH1cblx0fTtcbn0pKCkpO1xubGV0IHdpbGxVbmxvYWQgPSBmYWxzZTtcbmlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcj8uKFwiYmVmb3JldW5sb2FkXCIsICgpID0+IHtcblx0d2lsbFVubG9hZCA9IHRydWU7XG59KTtcbmZ1bmN0aW9uIGNsZWFuVXJsKHBhdGhuYW1lKSB7XG5cdGNvbnN0IHVybCA9IG5ldyBVUkwocGF0aG5hbWUsIFwiaHR0cDovL3ZpdGUuZGV2XCIpO1xuXHR1cmwuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImRpcmVjdFwiKTtcblx0cmV0dXJuIHVybC5wYXRobmFtZSArIHVybC5zZWFyY2g7XG59XG5sZXQgaXNGaXJzdFVwZGF0ZSA9IHRydWU7XG5jb25zdCBvdXRkYXRlZExpbmtUYWdzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrU2V0KCk7XG5jb25zdCBkZWJvdW5jZVJlbG9hZCA9ICh0aW1lKSA9PiB7XG5cdGxldCB0aW1lcjtcblx0cmV0dXJuICgpID0+IHtcblx0XHRpZiAodGltZXIpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHR0aW1lciA9IG51bGw7XG5cdFx0fVxuXHRcdHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRsb2NhdGlvbi5yZWxvYWQoKTtcblx0XHR9LCB0aW1lKTtcblx0fTtcbn07XG5jb25zdCBwYWdlUmVsb2FkID0gZGVib3VuY2VSZWxvYWQoMjApO1xuY29uc3QgaG1yQ2xpZW50ID0gbmV3IEhNUkNsaWVudCh7XG5cdGVycm9yOiAoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiW3ZpdGVdXCIsIGVyciksXG5cdGRlYnVnOiAoLi4ubXNnKSA9PiBjb25zb2xlLmRlYnVnKFwiW3ZpdGVdXCIsIC4uLm1zZylcbn0sIHRyYW5zcG9ydCwgYXN5bmMgZnVuY3Rpb24gaW1wb3J0VXBkYXRlZE1vZHVsZSh7IGFjY2VwdGVkUGF0aCwgdGltZXN0YW1wLCBleHBsaWNpdEltcG9ydFJlcXVpcmVkLCBpc1dpdGhpbkNpcmN1bGFySW1wb3J0IH0pIHtcblx0Y29uc3QgW2FjY2VwdGVkUGF0aFdpdGhvdXRRdWVyeSwgcXVlcnldID0gYWNjZXB0ZWRQYXRoLnNwbGl0KGA/YCk7XG5cdGNvbnN0IGltcG9ydFByb21pc2UgPSBpbXBvcnQoXG5cdFx0LyogQHZpdGUtaWdub3JlICovXG5cdFx0YmFzZSArIGFjY2VwdGVkUGF0aFdpdGhvdXRRdWVyeS5zbGljZSgxKSArIGA/JHtleHBsaWNpdEltcG9ydFJlcXVpcmVkID8gXCJpbXBvcnQmXCIgOiBcIlwifXQ9JHt0aW1lc3RhbXB9JHtxdWVyeSA/IGAmJHtxdWVyeX1gIDogXCJcIn1gXG4pO1xuXHRpZiAoaXNXaXRoaW5DaXJjdWxhckltcG9ydCkgaW1wb3J0UHJvbWlzZS5jYXRjaCgoKSA9PiB7XG5cdFx0Y29uc29sZS5pbmZvKGBbaG1yXSAke2FjY2VwdGVkUGF0aH0gZmFpbGVkIHRvIGFwcGx5IEhNUiBhcyBpdCdzIHdpdGhpbiBhIGNpcmN1bGFyIGltcG9ydC4gUmVsb2FkaW5nIHBhZ2UgdG8gcmVzZXQgdGhlIGV4ZWN1dGlvbiBvcmRlci4gVG8gZGVidWcgYW5kIGJyZWFrIHRoZSBjaXJjdWxhciBpbXBvcnQsIHlvdSBjYW4gcnVuIFxcYHZpdGUgLS1kZWJ1ZyBobXJcXGAgdG8gbG9nIHRoZSBjaXJjdWxhciBkZXBlbmRlbmN5IHBhdGggaWYgYSBmaWxlIGNoYW5nZSB0cmlnZ2VyZWQgaXQuYCk7XG5cdFx0cGFnZVJlbG9hZCgpO1xuXHR9KTtcblx0cmV0dXJuIGF3YWl0IGltcG9ydFByb21pc2U7XG59KTtcbnRyYW5zcG9ydC5jb25uZWN0KGNyZWF0ZUhNUkhhbmRsZXIoaGFuZGxlTWVzc2FnZSkpO1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlTWVzc2FnZShwYXlsb2FkKSB7XG5cdHN3aXRjaCAocGF5bG9hZC50eXBlKSB7XG5cdFx0Y2FzZSBcImNvbm5lY3RlZFwiOlxuXHRcdFx0Y29uc29sZS5kZWJ1ZyhgW3ZpdGVdIGNvbm5lY3RlZC5gKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJ1cGRhdGVcIjpcblx0XHRcdGF3YWl0IGhtckNsaWVudC5ub3RpZnlMaXN0ZW5lcnMoXCJ2aXRlOmJlZm9yZVVwZGF0ZVwiLCBwYXlsb2FkKTtcblx0XHRcdGlmIChoYXNEb2N1bWVudCkgaWYgKGlzRmlyc3RVcGRhdGUgJiYgaGFzRXJyb3JPdmVybGF5KCkpIHtcblx0XHRcdFx0bG9jYXRpb24ucmVsb2FkKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChlbmFibGVPdmVybGF5KSBjbGVhckVycm9yT3ZlcmxheSgpO1xuXHRcdFx0XHRpc0ZpcnN0VXBkYXRlID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRhd2FpdCBQcm9taXNlLmFsbChwYXlsb2FkLnVwZGF0ZXMubWFwKGFzeW5jICh1cGRhdGUpID0+IHtcblx0XHRcdFx0aWYgKHVwZGF0ZS50eXBlID09PSBcImpzLXVwZGF0ZVwiKSByZXR1cm4gaG1yQ2xpZW50LnF1ZXVlVXBkYXRlKHVwZGF0ZSk7XG5cdFx0XHRcdGNvbnN0IHsgcGF0aCwgdGltZXN0YW1wIH0gPSB1cGRhdGU7XG5cdFx0XHRcdGNvbnN0IHNlYXJjaFVybCA9IGNsZWFuVXJsKHBhdGgpO1xuXHRcdFx0XHRjb25zdCBlbCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImxpbmtcIikpLmZpbmQoKGUpID0+ICFvdXRkYXRlZExpbmtUYWdzLmhhcyhlKSAmJiBjbGVhblVybChlLmhyZWYpLmluY2x1ZGVzKHNlYXJjaFVybCkpO1xuXHRcdFx0XHRpZiAoIWVsKSByZXR1cm47XG5cdFx0XHRcdGNvbnN0IG5ld1BhdGggPSBgJHtiYXNlfSR7c2VhcmNoVXJsLnNsaWNlKDEpfSR7c2VhcmNoVXJsLmluY2x1ZGVzKFwiP1wiKSA/IFwiJlwiIDogXCI/XCJ9dD0ke3RpbWVzdGFtcH1gO1xuXHRcdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdFx0XHRjb25zdCBuZXdMaW5rVGFnID0gZWwuY2xvbmVOb2RlKCk7XG5cdFx0XHRcdFx0bmV3TGlua1RhZy5ocmVmID0gbmV3IFVSTChuZXdQYXRoLCBlbC5ocmVmKS5ocmVmO1xuXHRcdFx0XHRcdGNvbnN0IHJlbW92ZU9sZEVsID0gKCkgPT4ge1xuXHRcdFx0XHRcdFx0ZWwucmVtb3ZlKCk7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmRlYnVnKGBbdml0ZV0gY3NzIGhvdCB1cGRhdGVkOiAke3NlYXJjaFVybH1gKTtcblx0XHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdG5ld0xpbmtUYWcuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgcmVtb3ZlT2xkRWwpO1xuXHRcdFx0XHRcdG5ld0xpbmtUYWcuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIHJlbW92ZU9sZEVsKTtcblx0XHRcdFx0XHRvdXRkYXRlZExpbmtUYWdzLmFkZChlbCk7XG5cdFx0XHRcdFx0ZWwuYWZ0ZXIobmV3TGlua1RhZyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSkpO1xuXHRcdFx0YXdhaXQgaG1yQ2xpZW50Lm5vdGlmeUxpc3RlbmVycyhcInZpdGU6YWZ0ZXJVcGRhdGVcIiwgcGF5bG9hZCk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwiY3VzdG9tXCI6XG5cdFx0XHRhd2FpdCBobXJDbGllbnQubm90aWZ5TGlzdGVuZXJzKHBheWxvYWQuZXZlbnQsIHBheWxvYWQuZGF0YSk7XG5cdFx0XHRpZiAocGF5bG9hZC5ldmVudCA9PT0gXCJ2aXRlOndzOmRpc2Nvbm5lY3RcIikge1xuXHRcdFx0XHRpZiAoaGFzRG9jdW1lbnQgJiYgIXdpbGxVbmxvYWQpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhgW3ZpdGVdIHNlcnZlciBjb25uZWN0aW9uIGxvc3QuIFBvbGxpbmcgZm9yIHJlc3RhcnQuLi5gKTtcblx0XHRcdFx0XHRjb25zdCBzb2NrZXQgPSBwYXlsb2FkLmRhdGEud2ViU29ja2V0O1xuXHRcdFx0XHRcdGNvbnN0IHVybCA9IG5ldyBVUkwoc29ja2V0LnVybCk7XG5cdFx0XHRcdFx0dXJsLnNlYXJjaCA9IFwiXCI7XG5cdFx0XHRcdFx0YXdhaXQgd2FpdEZvclN1Y2Nlc3NmdWxQaW5nKHVybC5ocmVmKTtcblx0XHRcdFx0XHRsb2NhdGlvbi5yZWxvYWQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImZ1bGwtcmVsb2FkXCI6XG5cdFx0XHRhd2FpdCBobXJDbGllbnQubm90aWZ5TGlzdGVuZXJzKFwidml0ZTpiZWZvcmVGdWxsUmVsb2FkXCIsIHBheWxvYWQpO1xuXHRcdFx0aWYgKGhhc0RvY3VtZW50KSBpZiAocGF5bG9hZC5wYXRoICYmIHBheWxvYWQucGF0aC5lbmRzV2l0aChcIi5odG1sXCIpKSB7XG5cdFx0XHRcdGNvbnN0IHBhZ2VQYXRoID0gZGVjb2RlVVJJKGxvY2F0aW9uLnBhdGhuYW1lKTtcblx0XHRcdFx0Y29uc3QgcGF5bG9hZFBhdGggPSBiYXNlICsgcGF5bG9hZC5wYXRoLnNsaWNlKDEpO1xuXHRcdFx0XHRpZiAocGFnZVBhdGggPT09IHBheWxvYWRQYXRoIHx8IHBheWxvYWQucGF0aCA9PT0gXCIvaW5kZXguaHRtbFwiIHx8IHBhZ2VQYXRoLmVuZHNXaXRoKFwiL1wiKSAmJiBwYWdlUGF0aCArIFwiaW5kZXguaHRtbFwiID09PSBwYXlsb2FkUGF0aCkgcGFnZVJlbG9hZCgpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2UgcGFnZVJlbG9hZCgpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcInBydW5lXCI6XG5cdFx0XHRhd2FpdCBobXJDbGllbnQubm90aWZ5TGlzdGVuZXJzKFwidml0ZTpiZWZvcmVQcnVuZVwiLCBwYXlsb2FkKTtcblx0XHRcdGF3YWl0IGhtckNsaWVudC5wcnVuZVBhdGhzKHBheWxvYWQucGF0aHMpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImVycm9yXCI6XG5cdFx0XHRhd2FpdCBobXJDbGllbnQubm90aWZ5TGlzdGVuZXJzKFwidml0ZTplcnJvclwiLCBwYXlsb2FkKTtcblx0XHRcdGlmIChoYXNEb2N1bWVudCkge1xuXHRcdFx0XHRjb25zdCBlcnIgPSBwYXlsb2FkLmVycjtcblx0XHRcdFx0aWYgKGVuYWJsZU92ZXJsYXkpIGNyZWF0ZUVycm9yT3ZlcmxheShlcnIpO1xuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoYFt2aXRlXSBJbnRlcm5hbCBTZXJ2ZXIgRXJyb3JcXG4ke2Vyci5tZXNzYWdlfVxcbiR7ZXJyLnN0YWNrfWApO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcInBpbmdcIjogYnJlYWs7XG5cdFx0ZGVmYXVsdDogcmV0dXJuIHBheWxvYWQ7XG5cdH1cbn1cbmNvbnN0IGVuYWJsZU92ZXJsYXkgPSB0cnVlO1xuY29uc3QgaGFzRG9jdW1lbnQgPSBcImRvY3VtZW50XCIgaW4gZ2xvYmFsVGhpcztcbmZ1bmN0aW9uIGNyZWF0ZUVycm9yT3ZlcmxheShlcnIpIHtcblx0Y2xlYXJFcnJvck92ZXJsYXkoKTtcblx0Y29uc3QgeyBjdXN0b21FbGVtZW50czogY3VzdG9tRWxlbWVudHMkMSB9ID0gZ2xvYmFsVGhpcztcblx0aWYgKGN1c3RvbUVsZW1lbnRzJDEpIHtcblx0XHRjb25zdCBFcnJvck92ZXJsYXlDb25zdHJ1Y3RvciA9IGN1c3RvbUVsZW1lbnRzJDEuZ2V0KG92ZXJsYXlJZCk7XG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChuZXcgRXJyb3JPdmVybGF5Q29uc3RydWN0b3IoZXJyKSk7XG5cdH1cbn1cbmZ1bmN0aW9uIGNsZWFyRXJyb3JPdmVybGF5KCkge1xuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG92ZXJsYXlJZCkuZm9yRWFjaCgobikgPT4gbi5jbG9zZSgpKTtcbn1cbmZ1bmN0aW9uIGhhc0Vycm9yT3ZlcmxheSgpIHtcblx0cmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3ZlcmxheUlkKS5sZW5ndGg7XG59XG5mdW5jdGlvbiB3YWl0Rm9yU3VjY2Vzc2Z1bFBpbmcoc29ja2V0VXJsKSB7XG5cdGlmICh0eXBlb2YgU2hhcmVkV29ya2VyID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0Y29uc3QgdmlzaWJpbGl0eU1hbmFnZXIgPSB7XG5cdFx0XHRjdXJyZW50U3RhdGU6IGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSxcblx0XHRcdGxpc3RlbmVyczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKVxuXHRcdH07XG5cdFx0Y29uc3Qgb25WaXNpYmlsaXR5Q2hhbmdlID0gKCkgPT4ge1xuXHRcdFx0dmlzaWJpbGl0eU1hbmFnZXIuY3VycmVudFN0YXRlID0gZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlO1xuXHRcdFx0Zm9yIChjb25zdCBsaXN0ZW5lciBvZiB2aXNpYmlsaXR5TWFuYWdlci5saXN0ZW5lcnMpIGxpc3RlbmVyKHZpc2liaWxpdHlNYW5hZ2VyLmN1cnJlbnRTdGF0ZSk7XG5cdFx0fTtcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCBvblZpc2liaWxpdHlDaGFuZ2UpO1xuXHRcdHJldHVybiB3YWl0Rm9yU3VjY2Vzc2Z1bFBpbmdJbnRlcm5hbChzb2NrZXRVcmwsIHZpc2liaWxpdHlNYW5hZ2VyKTtcblx0fVxuXHRjb25zdCBibG9iID0gbmV3IEJsb2IoW1xuXHRcdFwiXFxcInVzZSBzdHJpY3RcXFwiO1wiLFxuXHRcdGBjb25zdCB3YWl0Rm9yU3VjY2Vzc2Z1bFBpbmdJbnRlcm5hbCA9ICR7d2FpdEZvclN1Y2Nlc3NmdWxQaW5nSW50ZXJuYWwudG9TdHJpbmcoKX07YCxcblx0XHRgY29uc3QgZm4gPSAke3BpbmdXb3JrZXJDb250ZW50TWFpbi50b1N0cmluZygpfTtgLFxuXHRcdGBmbigke0pTT04uc3RyaW5naWZ5KHNvY2tldFVybCl9KWBcblx0XSwgeyB0eXBlOiBcImFwcGxpY2F0aW9uL2phdmFzY3JpcHRcIiB9KTtcblx0Y29uc3Qgb2JqVVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblx0Y29uc3Qgc2hhcmVkV29ya2VyID0gbmV3IFNoYXJlZFdvcmtlcihvYmpVUkwpO1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdGNvbnN0IG9uVmlzaWJpbGl0eUNoYW5nZSA9ICgpID0+IHtcblx0XHRcdHNoYXJlZFdvcmtlci5wb3J0LnBvc3RNZXNzYWdlKHsgdmlzaWJpbGl0eTogZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlIH0pO1xuXHRcdH07XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgb25WaXNpYmlsaXR5Q2hhbmdlKTtcblx0XHRzaGFyZWRXb3JrZXIucG9ydC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCAoZXZlbnQpID0+IHtcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIG9uVmlzaWJpbGl0eUNoYW5nZSk7XG5cdFx0XHRzaGFyZWRXb3JrZXIucG9ydC5jbG9zZSgpO1xuXHRcdFx0Y29uc3QgZGF0YSA9IGV2ZW50LmRhdGE7XG5cdFx0XHRpZiAoZGF0YS50eXBlID09PSBcImVycm9yXCIpIHtcblx0XHRcdFx0cmVqZWN0KGRhdGEuZXJyb3IpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRyZXNvbHZlKCk7XG5cdFx0fSk7XG5cdFx0b25WaXNpYmlsaXR5Q2hhbmdlKCk7XG5cdFx0c2hhcmVkV29ya2VyLnBvcnQuc3RhcnQoKTtcblx0fSk7XG59XG5mdW5jdGlvbiBwaW5nV29ya2VyQ29udGVudE1haW4oc29ja2V0VXJsKSB7XG5cdHNlbGYuYWRkRXZlbnRMaXN0ZW5lcihcImNvbm5lY3RcIiwgKF9ldmVudCkgPT4ge1xuXHRcdGNvbnN0IHBvcnQgPSBfZXZlbnQucG9ydHNbMF07XG5cdFx0aWYgKCFzb2NrZXRVcmwpIHtcblx0XHRcdHBvcnQucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0XHR0eXBlOiBcImVycm9yXCIsXG5cdFx0XHRcdGVycm9yOiAvKiBAX19QVVJFX18gKi8gbmV3IEVycm9yKFwic29ja2V0VXJsIG5vdCBmb3VuZFwiKVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGNvbnN0IHZpc2liaWxpdHlNYW5hZ2VyID0ge1xuXHRcdFx0Y3VycmVudFN0YXRlOiBcInZpc2libGVcIixcblx0XHRcdGxpc3RlbmVyczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKVxuXHRcdH07XG5cdFx0cG9ydC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCAoZXZlbnQpID0+IHtcblx0XHRcdGNvbnN0IHsgdmlzaWJpbGl0eSB9ID0gZXZlbnQuZGF0YTtcblx0XHRcdHZpc2liaWxpdHlNYW5hZ2VyLmN1cnJlbnRTdGF0ZSA9IHZpc2liaWxpdHk7XG5cdFx0XHRjb25zb2xlLmRlYnVnKFwiW3ZpdGVdIG5ldyB3aW5kb3cgdmlzaWJpbGl0eVwiLCB2aXNpYmlsaXR5KTtcblx0XHRcdGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdmlzaWJpbGl0eU1hbmFnZXIubGlzdGVuZXJzKSBsaXN0ZW5lcih2aXNpYmlsaXR5KTtcblx0XHR9KTtcblx0XHRwb3J0LnN0YXJ0KCk7XG5cdFx0Y29uc29sZS5kZWJ1ZyhcIlt2aXRlXSBjb25uZWN0ZWQgZnJvbSB3aW5kb3dcIik7XG5cdFx0d2FpdEZvclN1Y2Nlc3NmdWxQaW5nSW50ZXJuYWwoc29ja2V0VXJsLCB2aXNpYmlsaXR5TWFuYWdlcikudGhlbigoKSA9PiB7XG5cdFx0XHRjb25zb2xlLmRlYnVnKFwiW3ZpdGVdIHBpbmcgc3VjY2Vzc2Z1bFwiKTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHBvcnQucG9zdE1lc3NhZ2UoeyB0eXBlOiBcInN1Y2Nlc3NcIiB9KTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdHBvcnQucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0XHRcdHR5cGU6IFwiZXJyb3JcIixcblx0XHRcdFx0XHRlcnJvclxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9LCAoZXJyb3IpID0+IHtcblx0XHRcdGNvbnNvbGUuZGVidWcoXCJbdml0ZV0gZXJyb3IgaGFwcGVuZWRcIiwgZXJyb3IpO1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0cG9ydC5wb3N0TWVzc2FnZSh7XG5cdFx0XHRcdFx0dHlwZTogXCJlcnJvclwiLFxuXHRcdFx0XHRcdGVycm9yXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IkMSkge1xuXHRcdFx0XHRwb3J0LnBvc3RNZXNzYWdlKHtcblx0XHRcdFx0XHR0eXBlOiBcImVycm9yXCIsXG5cdFx0XHRcdFx0ZXJyb3I6IGVycm9yJDFcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gd2FpdEZvclN1Y2Nlc3NmdWxQaW5nSW50ZXJuYWwoc29ja2V0VXJsLCB2aXNpYmlsaXR5TWFuYWdlciwgbXMgPSAxZTMpIHtcblx0ZnVuY3Rpb24gd2FpdChtcyQxKSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zJDEpKTtcblx0fVxuXHRhc3luYyBmdW5jdGlvbiBwaW5nKCkge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KHNvY2tldFVybCwgXCJ2aXRlLXBpbmdcIik7XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdFx0ZnVuY3Rpb24gb25PcGVuKCkge1xuXHRcdFx0XHRcdHJlc29sdmUodHJ1ZSk7XG5cdFx0XHRcdFx0Y2xvc2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRmdW5jdGlvbiBvbkVycm9yKCkge1xuXHRcdFx0XHRcdHJlc29sdmUoZmFsc2UpO1xuXHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZnVuY3Rpb24gY2xvc2UoKSB7XG5cdFx0XHRcdFx0c29ja2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJvcGVuXCIsIG9uT3Blbik7XG5cdFx0XHRcdFx0c29ja2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBvbkVycm9yKTtcblx0XHRcdFx0XHRzb2NrZXQuY2xvc2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihcIm9wZW5cIiwgb25PcGVuKTtcblx0XHRcdFx0c29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBvbkVycm9yKTtcblx0XHRcdH0pO1xuXHRcdH0gY2F0Y2gge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXHRmdW5jdGlvbiB3YWl0Rm9yV2luZG93U2hvdyh2aXNpYmlsaXR5TWFuYWdlciQxKSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0XHRjb25zdCBvbkNoYW5nZSA9IChuZXdWaXNpYmlsaXR5KSA9PiB7XG5cdFx0XHRcdGlmIChuZXdWaXNpYmlsaXR5ID09PSBcInZpc2libGVcIikge1xuXHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0XHR2aXNpYmlsaXR5TWFuYWdlciQxLmxpc3RlbmVycy5kZWxldGUob25DaGFuZ2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0dmlzaWJpbGl0eU1hbmFnZXIkMS5saXN0ZW5lcnMuYWRkKG9uQ2hhbmdlKTtcblx0XHR9KTtcblx0fVxuXHRpZiAoYXdhaXQgcGluZygpKSByZXR1cm47XG5cdGF3YWl0IHdhaXQobXMpO1xuXHR3aGlsZSAodHJ1ZSkgaWYgKHZpc2liaWxpdHlNYW5hZ2VyLmN1cnJlbnRTdGF0ZSA9PT0gXCJ2aXNpYmxlXCIpIHtcblx0XHRpZiAoYXdhaXQgcGluZygpKSBicmVhaztcblx0XHRhd2FpdCB3YWl0KG1zKTtcblx0fSBlbHNlIGF3YWl0IHdhaXRGb3JXaW5kb3dTaG93KHZpc2liaWxpdHlNYW5hZ2VyKTtcbn1cbmNvbnN0IHNoZWV0c01hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5jb25zdCBsaW5rU2hlZXRzTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbmlmIChcImRvY3VtZW50XCIgaW4gZ2xvYmFsVGhpcykge1xuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic3R5bGVbZGF0YS12aXRlLWRldi1pZF1cIikuZm9yRWFjaCgoZWwpID0+IHtcblx0XHRzaGVldHNNYXAuc2V0KGVsLmdldEF0dHJpYnV0ZShcImRhdGEtdml0ZS1kZXYtaWRcIiksIGVsKTtcblx0fSk7XG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJsaW5rW3JlbD1cXFwic3R5bGVzaGVldFxcXCJdW2RhdGEtdml0ZS1kZXYtaWRdXCIpLmZvckVhY2goKGVsKSA9PiB7XG5cdFx0bGlua1NoZWV0c01hcC5zZXQoZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS12aXRlLWRldi1pZFwiKSwgZWwpO1xuXHR9KTtcbn1cbmxldCBsYXN0SW5zZXJ0ZWRTdHlsZTtcbmZ1bmN0aW9uIHVwZGF0ZVN0eWxlKGlkLCBjb250ZW50KSB7XG5cdGlmIChsaW5rU2hlZXRzTWFwLmhhcyhpZCkpIHJldHVybjtcblx0bGV0IHN0eWxlID0gc2hlZXRzTWFwLmdldChpZCk7XG5cdGlmICghc3R5bGUpIHtcblx0XHRzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcblx0XHRzdHlsZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dC9jc3NcIik7XG5cdFx0c3R5bGUuc2V0QXR0cmlidXRlKFwiZGF0YS12aXRlLWRldi1pZFwiLCBpZCk7XG5cdFx0c3R5bGUudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdGlmIChjc3BOb25jZSkgc3R5bGUuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgY3NwTm9uY2UpO1xuXHRcdGlmICghbGFzdEluc2VydGVkU3R5bGUpIHtcblx0XHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGxhc3RJbnNlcnRlZFN0eWxlID0gdm9pZCAwO1xuXHRcdFx0fSwgMCk7XG5cdFx0fSBlbHNlIGxhc3RJbnNlcnRlZFN0eWxlLmluc2VydEFkamFjZW50RWxlbWVudChcImFmdGVyZW5kXCIsIHN0eWxlKTtcblx0XHRsYXN0SW5zZXJ0ZWRTdHlsZSA9IHN0eWxlO1xuXHR9IGVsc2Ugc3R5bGUudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRzaGVldHNNYXAuc2V0KGlkLCBzdHlsZSk7XG59XG5mdW5jdGlvbiByZW1vdmVTdHlsZShpZCkge1xuXHRpZiAobGlua1NoZWV0c01hcC5oYXMoaWQpKSB7XG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgbGlua1tyZWw9XCJzdHlsZXNoZWV0XCJdW2RhdGEtdml0ZS1kZXYtaWRdYCkuZm9yRWFjaCgoZWwpID0+IHtcblx0XHRcdGlmIChlbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXZpdGUtZGV2LWlkXCIpID09PSBpZCkgZWwucmVtb3ZlKCk7XG5cdFx0fSk7XG5cdFx0bGlua1NoZWV0c01hcC5kZWxldGUoaWQpO1xuXHR9XG5cdGNvbnN0IHN0eWxlID0gc2hlZXRzTWFwLmdldChpZCk7XG5cdGlmIChzdHlsZSkge1xuXHRcdGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQoc3R5bGUpO1xuXHRcdHNoZWV0c01hcC5kZWxldGUoaWQpO1xuXHR9XG59XG5mdW5jdGlvbiBjcmVhdGVIb3RDb250ZXh0KG93bmVyUGF0aCkge1xuXHRyZXR1cm4gbmV3IEhNUkNvbnRleHQoaG1yQ2xpZW50LCBvd25lclBhdGgpO1xufVxuLyoqXG4qIHVybHMgaGVyZSBhcmUgZHluYW1pYyBpbXBvcnQoKSB1cmxzIHRoYXQgY291bGRuJ3QgYmUgc3RhdGljYWxseSBhbmFseXplZFxuKi9cbmZ1bmN0aW9uIGluamVjdFF1ZXJ5KHVybCwgcXVlcnlUb0luamVjdCkge1xuXHRpZiAodXJsWzBdICE9PSBcIi5cIiAmJiB1cmxbMF0gIT09IFwiL1wiKSByZXR1cm4gdXJsO1xuXHRjb25zdCBwYXRobmFtZSA9IHVybC5yZXBsYWNlKC9bPyNdLiokLywgXCJcIik7XG5cdGNvbnN0IHsgc2VhcmNoLCBoYXNoIH0gPSBuZXcgVVJMKHVybCwgXCJodHRwOi8vdml0ZS5kZXZcIik7XG5cdHJldHVybiBgJHtwYXRobmFtZX0/JHtxdWVyeVRvSW5qZWN0fSR7c2VhcmNoID8gYCZgICsgc2VhcmNoLnNsaWNlKDEpIDogXCJcIn0ke2hhc2ggfHwgXCJcIn1gO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IEVycm9yT3ZlcmxheSwgY3JlYXRlSG90Q29udGV4dCwgaW5qZWN0UXVlcnksIHJlbW92ZVN0eWxlLCB1cGRhdGVTdHlsZSB9OyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUM7O0FBRTlGLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO0FBQ3ZELFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDcEIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQzFCLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDcEcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzdILENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUNkOztBQUVBLENBQUMsQ0FBQyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFDNUQsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMzQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDM0MsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQztBQUM5QixDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNuQixDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNuQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN0QyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ3JFLENBQUM7QUFDRCxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzdDOztBQUVBLENBQUMsQ0FBQyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdB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TUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNwRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN4RixDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQztBQUMvRCxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDckQsQ0FBQztBQUNELENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzVCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMs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QyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN2QyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNsRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUztBQUNyQixDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0FBQ2YsQ0FBQyxDQUFDLENBQUM7QUFDSCxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQyxDQUFDLENBQUMsSUFBSTtBQUNQLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUN2RCxDQUFDO0FBQ0QsQ0FBQztBQUNELEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUN0QixDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQztBQUN2RCxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTTtBQUN0QixDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDOUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsbUJBQW1CO0FBQ2hELENBQUMsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxhQUFhLENB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Q0FBQyxDQUFDLENBQUMsTUFBTTtBQUMzRCxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDO0FBQzFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU07QUFDbEIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxhQUFhO0FBQ25CLENBQUMsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZO0FBQzVDLENBQUMsQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQzVGLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNyRCxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUM7QUFDckQsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUMvRCxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLENBQUM7QUFDMUQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFD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QUFDO0FBQzlCLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUM3RCxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNuRixDQUFDLE1BQU0sQ0FBQyxLQUFLO0FBQ2I7QUFDQSxLQUFLLENBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ25ELENBQUMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUM7QUFDaEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ2hCLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzNCLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUMzQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ2xCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBQ3hCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDVixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtBQUNULENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztBQUMvRCxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU07QUFDdkIsQ0FBQyxDQUFDO0FBQ0YsQ0FBQyxDQUFDO0FBQ0YsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUMzSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUM5QyxDQUFDLE1BQU0sQ0FBQztBQUNSLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNoQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzlCLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUN2RSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSTtBQUMvQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzNDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ3hDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUM7QUFDaEQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU07QUFDM0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDN0QsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQztBQUNuQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUk7QUFDMUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztBQUN2QyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNuQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU07QUFDYixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDO0FBQ3ZCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUNILENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0FBQ2YsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN4SCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdEIsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNiLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7QUFDaEMsQ0FBQyxDQUFDLENBQUM7QUFDSCxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMzQixDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUM3QixDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztBQUN2QixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ2xCLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBQ3hCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDVixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtBQUNULENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDNUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7QUFDcEQsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBQzlELENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc7QUFDN0MsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVM7QUFDaEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNwQixDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2pDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQztBQUNsQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM5SCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxD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LENBQUMsU0FBUyxDQUFDO0FBQ2IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUNsQixDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUM7QUFDNUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQzlCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTTtBQUNkLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3RDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDeEYsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7QUFDZixDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDO0FBQ2hDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ2QsQ0FBQyxDQUFDLENBQUM7QUFDSCxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElB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LENBQUMsQ0FBQyxDQUFDO0FBQ2IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUNmLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLO0FBQ2IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQ2IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUNmLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLO0FBQ2IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQ2IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNiLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHO0FBQ1gsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ2xKLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzdELEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtBQUM5RCxLQUFLLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVTtBQUM3QyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUM3QyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2hDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNULENBQUMsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDdkMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUM3QyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakQsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7QUFDekMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDM0IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO0FBQzNELENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPO0FBQy9FLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQzVDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN2RSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUNyRixDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUMzQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDckQsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUN2QyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdEUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ3RCLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN2QyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDM0IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDOUQsQ0FBQyxDQUFDLENBQUM7QUFDSCxDQUFDLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO0FBQ3ZELENBQUM7QUFDRCxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3pDLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUM7QUFDOUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSTtBQUN2QyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNuQixDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSztBQUNaLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdkIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDckMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUs7QUFDcEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUM1QyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNqRCxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM1QyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUk7QUFDM0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7QUFDaEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN6QixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLElB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QUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzVGLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBQzVELENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN4SCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxTQUFTO0FBQzNELElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSztBQUNsQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENB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Q0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDMUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU07QUFDbkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDdEcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDdEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUk7QUFDckQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQy9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLENB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QUFDO0FBQ3BFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN4RSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO0FBQ2pELENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDcEQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3JKLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTTtBQUNWLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDdEIsQ0FBQyxDQUFDLENBQUMsS0FBSztBQUNSLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUM7QUFDZCxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMs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QztBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQztBQUMxRCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyxNQUFNO0FBQ1QsQ0FBQyxDQUFDO0FBQ0YsQ0FBQyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7QUFDNUIsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDMUIsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztBQUN0QyxDQUFDLENBQUMsQ0FBQztBQUNILENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDOUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSTtBQUNwQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLFVBQVU7QUFDOUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQztBQUM1RCxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxD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"
          },
          "redirectURL": "",
          "headersSize": 179,
          "bodySize": 0,
          "_transferSize": 179,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.161Z",
        "time": 34.04700001386926,
        "timings": {
          "blocked": 30.880999995522203,
          "dns": 0.0050000000000000044,
          "ssl": -1,
          "connect": 0.7210000000000001,
          "send": 0.18399999999999994,
          "wait": 1.241999980662018,
          "receive": 1.0140000376850367,
          "_blocked_queueing": 30.5919999955222,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16089",
        "_initiator": {
          "type": "parser",
          "url": "http://localhost:4200/login",
          "lineNumber": 8
        },
        "_priority": "VeryHigh",
        "_resourceType": "stylesheet",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/styles.css",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "text/css,*/*;q=0.1"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "If-None-Match",
              "value": "W/\"44573-+FLWwTev1ns\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/login"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "style"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "no-cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 604,
          "bodySize": 0
        },
        "response": {
          "status": 304,
          "statusText": "Not Modified",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 44573,
            "mimeType": "text/css",
            "text": "/* src/styles.css */\n/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */\n@layer properties;\n@layer theme, base, components, utilities;\n@layer theme {\n  :root,\n  :host {\n    --font-sans:\n      ui-sans-serif,\n      system-ui,\n      sans-serif,\n      \"Apple Color Emoji\",\n      \"Segoe UI Emoji\",\n      \"Segoe UI Symbol\",\n      \"Noto Color Emoji\";\n    --font-mono:\n      ui-monospace,\n      SFMono-Regular,\n      Menlo,\n      Monaco,\n      Consolas,\n      \"Liberation Mono\",\n      \"Courier New\",\n      monospace;\n    --color-red-100: oklch(93.6% 0.032 17.717);\n    --color-red-400: oklch(70.4% 0.191 22.216);\n    --color-red-500: oklch(63.7% 0.237 25.331);\n    --color-red-700: oklch(50.5% 0.213 27.518);\n    --color-orange-100: oklch(95.4% 0.038 75.164);\n    --color-orange-400: oklch(75% 0.183 55.934);\n    --color-orange-500: oklch(70.5% 0.213 47.604);\n    --color-orange-600: oklch(64.6% 0.222 41.116);\n    --color-orange-700: oklch(55.3% 0.195 38.402);\n    --color-yellow-100: oklch(97.3% 0.071 103.193);\n    --color-yellow-500: oklch(79.5% 0.184 86.047);\n    --color-yellow-700: oklch(55.4% 0.135 66.442);\n    --color-green-100: oklch(96.2% 0.044 156.743);\n    --color-green-500: oklch(72.3% 0.219 149.579);\n    --color-green-600: oklch(62.7% 0.194 149.214);\n    --color-green-700: oklch(52.7% 0.154 150.069);\n    --color-blue-100: oklch(93.2% 0.032 255.585);\n    --color-blue-500: oklch(62.3% 0.214 259.815);\n    --color-blue-600: oklch(54.6% 0.245 262.881);\n    --color-indigo-50: oklch(96.2% 0.018 272.314);\n    --color-indigo-100: oklch(93% 0.034 272.788);\n    --color-indigo-300: oklch(78.5% 0.115 274.713);\n    --color-indigo-400: oklch(67.3% 0.182 276.935);\n    --color-indigo-500: oklch(58.5% 0.233 277.117);\n    --color-indigo-600: oklch(51.1% 0.262 276.966);\n    --color-indigo-700: oklch(45.7% 0.24 277.023);\n    --color-purple-500: oklch(62.7% 0.265 303.9);\n    --color-purple-600: oklch(55.8% 0.288 302.321);\n    --color-purple-700: oklch(49.6% 0.265 301.924);\n    --color-slate-50: oklch(98.4% 0.003 247.858);\n    --color-slate-300: oklch(86.9% 0.022 252.894);\n    --color-slate-400: oklch(70.4% 0.04 256.788);\n    --color-slate-500: oklch(55.4% 0.046 257.417);\n    --color-slate-800: oklch(27.9% 0.041 260.031);\n    --color-slate-900: oklch(20.8% 0.042 265.755);\n    --color-gray-50: oklch(98.5% 0.002 247.839);\n    --color-gray-100: oklch(96.7% 0.003 264.542);\n    --color-gray-200: oklch(92.8% 0.006 264.531);\n    --color-gray-300: oklch(87.2% 0.01 258.338);\n    --color-gray-400: oklch(70.7% 0.022 261.325);\n    --color-gray-500: oklch(55.1% 0.027 264.364);\n    --color-gray-600: oklch(44.6% 0.03 256.802);\n    --color-gray-700: oklch(37.3% 0.034 259.733);\n    --color-gray-800: oklch(27.8% 0.033 256.848);\n    --color-gray-900: oklch(21% 0.034 264.665);\n    --color-black: #000;\n    --color-white: #fff;\n    --spacing: 0.25rem;\n    --container-md: 28rem;\n    --container-xl: 36rem;\n    --container-2xl: 42rem;\n    --text-xs: 0.75rem;\n    --text-xs--line-height: calc(1 / 0.75);\n    --text-sm: 0.875rem;\n    --text-sm--line-height: calc(1.25 / 0.875);\n    --text-base: 1rem;\n    --text-base--line-height: calc(1.5 / 1);\n    --text-lg: 1.125rem;\n    --text-lg--line-height: calc(1.75 / 1.125);\n    --text-xl: 1.25rem;\n    --text-xl--line-height: calc(1.75 / 1.25);\n    --text-2xl: 1.5rem;\n    --text-2xl--line-height: calc(2 / 1.5);\n    --text-4xl: 2.25rem;\n    --text-4xl--line-height: calc(2.5 / 2.25);\n    --font-weight-medium: 500;\n    --font-weight-semibold: 600;\n    --font-weight-bold: 700;\n    --leading-snug: 1.375;\n    --radius-lg: 0.5rem;\n    --radius-xl: 0.75rem;\n    --radius-2xl: 1rem;\n    --animate-spin: spin 1s linear infinite;\n    --animate-pulse: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n    --blur-sm: 8px;\n    --blur-xl: 24px;\n    --default-transition-duration: 150ms;\n    --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    --default-font-family: var(--font-sans);\n    --default-mono-font-family: var(--font-mono);\n  }\n}\n@layer base {\n  *,\n  ::after,\n  ::before,\n  ::backdrop,\n  ::file-selector-button {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n    border: 0 solid;\n  }\n  html,\n  :host {\n    line-height: 1.5;\n    -webkit-text-size-adjust: 100%;\n    tab-size: 4;\n    font-family: var(--default-font-family, ui-sans-serif, system-ui, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\");\n    font-feature-settings: var(--default-font-feature-settings, normal);\n    font-variation-settings: var(--default-font-variation-settings, normal);\n    -webkit-tap-highlight-color: transparent;\n  }\n  hr {\n    height: 0;\n    color: inherit;\n    border-top-width: 1px;\n  }\n  abbr:where([title]) {\n    -webkit-text-decoration: underline dotted;\n    text-decoration: underline dotted;\n  }\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    font-size: inherit;\n    font-weight: inherit;\n  }\n  a {\n    color: inherit;\n    -webkit-text-decoration: inherit;\n    text-decoration: inherit;\n  }\n  b,\n  strong {\n    font-weight: bolder;\n  }\n  code,\n  kbd,\n  samp,\n  pre {\n    font-family: var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace);\n    font-feature-settings: var(--default-mono-font-feature-settings, normal);\n    font-variation-settings: var(--default-mono-font-variation-settings, normal);\n    font-size: 1em;\n  }\n  small {\n    font-size: 80%;\n  }\n  sub,\n  sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n  sub {\n    bottom: -0.25em;\n  }\n  sup {\n    top: -0.5em;\n  }\n  table {\n    text-indent: 0;\n    border-color: inherit;\n    border-collapse: collapse;\n  }\n  :-moz-focusring {\n    outline: auto;\n  }\n  progress {\n    vertical-align: baseline;\n  }\n  summary {\n    display: list-item;\n  }\n  ol,\n  ul,\n  menu {\n    list-style: none;\n  }\n  img,\n  svg,\n  video,\n  canvas,\n  audio,\n  iframe,\n  embed,\n  object {\n    display: block;\n    vertical-align: middle;\n  }\n  img,\n  video {\n    max-width: 100%;\n    height: auto;\n  }\n  button,\n  input,\n  select,\n  optgroup,\n  textarea,\n  ::file-selector-button {\n    font: inherit;\n    font-feature-settings: inherit;\n    font-variation-settings: inherit;\n    letter-spacing: inherit;\n    color: inherit;\n    border-radius: 0;\n    background-color: transparent;\n    opacity: 1;\n  }\n  :where(select:is([multiple], [size])) optgroup {\n    font-weight: bolder;\n  }\n  :where(select:is([multiple], [size])) optgroup option {\n    padding-inline-start: 20px;\n  }\n  ::file-selector-button {\n    margin-inline-end: 4px;\n  }\n  ::placeholder {\n    opacity: 1;\n  }\n  @supports (not (-webkit-appearance: -apple-pay-button)) or (contain-intrinsic-size: 1px) {\n    ::placeholder {\n      color: currentcolor;\n    }\n    @supports (color: color-mix(in lab, red, red)) {\n      ::placeholder {\n        color: color-mix(in oklab, currentcolor 50%, transparent);\n      }\n    }\n  }\n  textarea {\n    resize: vertical;\n  }\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n  ::-webkit-date-and-time-value {\n    min-height: 1lh;\n    text-align: inherit;\n  }\n  ::-webkit-datetime-edit {\n    display: inline-flex;\n  }\n  ::-webkit-datetime-edit-fields-wrapper {\n    padding: 0;\n  }\n  ::-webkit-datetime-edit,\n  ::-webkit-datetime-edit-year-field,\n  ::-webkit-datetime-edit-month-field,\n  ::-webkit-datetime-edit-day-field,\n  ::-webkit-datetime-edit-hour-field,\n  ::-webkit-datetime-edit-minute-field,\n  ::-webkit-datetime-edit-second-field,\n  ::-webkit-datetime-edit-millisecond-field,\n  ::-webkit-datetime-edit-meridiem-field {\n    padding-block: 0;\n  }\n  ::-webkit-calendar-picker-indicator {\n    line-height: 1;\n  }\n  :-moz-ui-invalid {\n    box-shadow: none;\n  }\n  button,\n  input:where([type=button], [type=reset], [type=submit]),\n  ::file-selector-button {\n    appearance: button;\n  }\n  ::-webkit-inner-spin-button,\n  ::-webkit-outer-spin-button {\n    height: auto;\n  }\n  [hidden]:where(:not([hidden=until-found])) {\n    display: none !important;\n  }\n}\n@layer utilities {\n  .absolute {\n    position: absolute;\n  }\n  .fixed {\n    position: fixed;\n  }\n  .relative {\n    position: relative;\n  }\n  .static {\n    position: static;\n  }\n  .inset-0 {\n    inset: calc(var(--spacing) * 0);\n  }\n  .top-1 {\n    top: calc(var(--spacing) * 1);\n  }\n  .top-1\\/2 {\n    top: calc(1/2 * 100%);\n  }\n  .right-1 {\n    right: calc(var(--spacing) * 1);\n  }\n  .left-3 {\n    left: calc(var(--spacing) * 3);\n  }\n  .z-50 {\n    z-index: 50;\n  }\n  .m-0 {\n    margin: calc(var(--spacing) * 0);\n  }\n  .m-4 {\n    margin: calc(var(--spacing) * 4);\n  }\n  .mx-auto {\n    margin-inline: auto;\n  }\n  .mt-1 {\n    margin-top: calc(var(--spacing) * 1);\n  }\n  .mt-3 {\n    margin-top: calc(var(--spacing) * 3);\n  }\n  .mt-4 {\n    margin-top: calc(var(--spacing) * 4);\n  }\n  .mt-6 {\n    margin-top: calc(var(--spacing) * 6);\n  }\n  .mb-1 {\n    margin-bottom: calc(var(--spacing) * 1);\n  }\n  .mb-2 {\n    margin-bottom: calc(var(--spacing) * 2);\n  }\n  .mb-3 {\n    margin-bottom: calc(var(--spacing) * 3);\n  }\n  .mb-4 {\n    margin-bottom: calc(var(--spacing) * 4);\n  }\n  .mb-6 {\n    margin-bottom: calc(var(--spacing) * 6);\n  }\n  .mb-8 {\n    margin-bottom: calc(var(--spacing) * 8);\n  }\n  .ml-4 {\n    margin-left: calc(var(--spacing) * 4);\n  }\n  .line-clamp-2 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 2;\n  }\n  .block {\n    display: block;\n  }\n  .flex {\n    display: flex;\n  }\n  .grid {\n    display: grid;\n  }\n  .inline-block {\n    display: inline-block;\n  }\n  .h-2 {\n    height: calc(var(--spacing) * 2);\n  }\n  .h-3 {\n    height: calc(var(--spacing) * 3);\n  }\n  .h-4 {\n    height: calc(var(--spacing) * 4);\n  }\n  .h-5 {\n    height: calc(var(--spacing) * 5);\n  }\n  .h-6 {\n    height: calc(var(--spacing) * 6);\n  }\n  .h-8 {\n    height: calc(var(--spacing) * 8);\n  }\n  .h-10 {\n    height: calc(var(--spacing) * 10);\n  }\n  .h-12 {\n    height: calc(var(--spacing) * 12);\n  }\n  .h-16 {\n    height: calc(var(--spacing) * 16);\n  }\n  .h-48 {\n    height: calc(var(--spacing) * 48);\n  }\n  .h-screen {\n    height: 100vh;\n  }\n  .max-h-\\[calc\\(100vh-300px\\)\\] {\n    max-height: calc(100vh - 300px);\n  }\n  .min-h-screen {\n    min-height: 100vh;\n  }\n  .w-2 {\n    width: calc(var(--spacing) * 2);\n  }\n  .w-3 {\n    width: calc(var(--spacing) * 3);\n  }\n  .w-4 {\n    width: calc(var(--spacing) * 4);\n  }\n  .w-5 {\n    width: calc(var(--spacing) * 5);\n  }\n  .w-6 {\n    width: calc(var(--spacing) * 6);\n  }\n  .w-8 {\n    width: calc(var(--spacing) * 8);\n  }\n  .w-10 {\n    width: calc(var(--spacing) * 10);\n  }\n  .w-12 {\n    width: calc(var(--spacing) * 12);\n  }\n  .w-16 {\n    width: calc(var(--spacing) * 16);\n  }\n  .w-64 {\n    width: calc(var(--spacing) * 64);\n  }\n  .w-72 {\n    width: calc(var(--spacing) * 72);\n  }\n  .w-80 {\n    width: calc(var(--spacing) * 80);\n  }\n  .w-full {\n    width: 100%;\n  }\n  .max-w-2xl {\n    max-width: var(--container-2xl);\n  }\n  .max-w-md {\n    max-width: var(--container-md);\n  }\n  .max-w-xl {\n    max-width: var(--container-xl);\n  }\n  .min-w-0 {\n    min-width: calc(var(--spacing) * 0);\n  }\n  .min-w-64 {\n    min-width: calc(var(--spacing) * 64);\n  }\n  .min-w-72 {\n    min-width: calc(var(--spacing) * 72);\n  }\n  .min-w-80 {\n    min-width: calc(var(--spacing) * 80);\n  }\n  .flex-1 {\n    flex: 1;\n  }\n  .flex-shrink-0 {\n    flex-shrink: 0;\n  }\n  .-translate-y-1\\/2 {\n    --tw-translate-y: calc(calc(1/2 * 100%) * -1);\n    translate: var(--tw-translate-x) var(--tw-translate-y);\n  }\n  .rotate-180 {\n    rotate: 180deg;\n  }\n  .transform {\n    transform: var(--tw-rotate-x,) var(--tw-rotate-y,) var(--tw-rotate-z,) var(--tw-skew-x,) var(--tw-skew-y,);\n  }\n  .animate-pulse {\n    animation: var(--animate-pulse);\n  }\n  .animate-spin {\n    animation: var(--animate-spin);\n  }\n  .cursor-pointer {\n    cursor: pointer;\n  }\n  .resize-none {\n    resize: none;\n  }\n  .appearance-none {\n    appearance: none;\n  }\n  .grid-cols-1 {\n    grid-template-columns: repeat(1, minmax(0, 1fr));\n  }\n  .grid-cols-2 {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n  }\n  .flex-col {\n    flex-direction: column;\n  }\n  .flex-wrap {\n    flex-wrap: wrap;\n  }\n  .items-center {\n    align-items: center;\n  }\n  .items-start {\n    align-items: flex-start;\n  }\n  .justify-between {\n    justify-content: space-between;\n  }\n  .justify-center {\n    justify-content: center;\n  }\n  .justify-end {\n    justify-content: flex-end;\n  }\n  .gap-1 {\n    gap: calc(var(--spacing) * 1);\n  }\n  .gap-2 {\n    gap: calc(var(--spacing) * 2);\n  }\n  .gap-3 {\n    gap: calc(var(--spacing) * 3);\n  }\n  .gap-4 {\n    gap: calc(var(--spacing) * 4);\n  }\n  .gap-6 {\n    gap: calc(var(--spacing) * 6);\n  }\n  :where(.space-y-1 > :not(:last-child)) {\n    --tw-space-y-reverse: 0;\n    margin-block-start: calc(calc(var(--spacing) * 1) * var(--tw-space-y-reverse));\n    margin-block-end: calc(calc(var(--spacing) * 1) * calc(1 - var(--tw-space-y-reverse)));\n  }\n  :where(.space-y-2 > :not(:last-child)) {\n    --tw-space-y-reverse: 0;\n    margin-block-start: calc(calc(var(--spacing) * 2) * var(--tw-space-y-reverse));\n    margin-block-end: calc(calc(var(--spacing) * 2) * calc(1 - var(--tw-space-y-reverse)));\n  }\n  :where(.space-y-3 > :not(:last-child)) {\n    --tw-space-y-reverse: 0;\n    margin-block-start: calc(calc(var(--spacing) * 3) * var(--tw-space-y-reverse));\n    margin-block-end: calc(calc(var(--spacing) * 3) * calc(1 - var(--tw-space-y-reverse)));\n  }\n  :where(.space-y-4 > :not(:last-child)) {\n    --tw-space-y-reverse: 0;\n    margin-block-start: calc(calc(var(--spacing) * 4) * var(--tw-space-y-reverse));\n    margin-block-end: calc(calc(var(--spacing) * 4) * calc(1 - var(--tw-space-y-reverse)));\n  }\n  :where(.space-y-6 > :not(:last-child)) {\n    --tw-space-y-reverse: 0;\n    margin-block-start: calc(calc(var(--spacing) * 6) * var(--tw-space-y-reverse));\n    margin-block-end: calc(calc(var(--spacing) * 6) * calc(1 - var(--tw-space-y-reverse)));\n  }\n  :where(.-space-x-2 > :not(:last-child)) {\n    --tw-space-x-reverse: 0;\n    margin-inline-start: calc(calc(var(--spacing) * -2) * var(--tw-space-x-reverse));\n    margin-inline-end: calc(calc(var(--spacing) * -2) * calc(1 - var(--tw-space-x-reverse)));\n  }\n  .truncate {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  .overflow-hidden {\n    overflow: hidden;\n  }\n  .overflow-x-auto {\n    overflow-x: auto;\n  }\n  .overflow-y-auto {\n    overflow-y: auto;\n  }\n  .rounded {\n    border-radius: 0.25rem;\n  }\n  .rounded-2xl {\n    border-radius: var(--radius-2xl);\n  }\n  .rounded-full {\n    border-radius: calc(infinity * 1px);\n  }\n  .rounded-lg {\n    border-radius: var(--radius-lg);\n  }\n  .rounded-xl {\n    border-radius: var(--radius-xl);\n  }\n  .border {\n    border-style: var(--tw-border-style);\n    border-width: 1px;\n  }\n  .border-2 {\n    border-style: var(--tw-border-style);\n    border-width: 2px;\n  }\n  .border-4 {\n    border-style: var(--tw-border-style);\n    border-width: 4px;\n  }\n  .border-t {\n    border-top-style: var(--tw-border-style);\n    border-top-width: 1px;\n  }\n  .border-r {\n    border-right-style: var(--tw-border-style);\n    border-right-width: 1px;\n  }\n  .border-b {\n    border-bottom-style: var(--tw-border-style);\n    border-bottom-width: 1px;\n  }\n  .border-l {\n    border-left-style: var(--tw-border-style);\n    border-left-width: 1px;\n  }\n  .border-dashed {\n    --tw-border-style: dashed;\n    border-style: dashed;\n  }\n  .border-gray-100 {\n    border-color: var(--color-gray-100);\n  }\n  .border-gray-200 {\n    border-color: var(--color-gray-200);\n  }\n  .border-gray-300 {\n    border-color: var(--color-gray-300);\n  }\n  .border-gray-600 {\n    border-color: var(--color-gray-600);\n  }\n  .border-gray-700 {\n    border-color: var(--color-gray-700);\n  }\n  .border-white {\n    border-color: var(--color-white);\n  }\n  .border-white\\/10 {\n    border-color: color-mix(in srgb, #fff 10%, transparent);\n  }\n  @supports (color: color-mix(in lab, red, red)) {\n    .border-white\\/10 {\n      border-color: color-mix(in oklab, var(--color-white) 10%, transparent);\n    }\n  }\n  .border-t-blue-500 {\n    border-top-color: var(--color-blue-500);\n  }\n  .border-t-indigo-500 {\n    border-top-color: var(--color-indigo-500);\n  }\n  .border-t-transparent {\n    border-top-color: transparent;\n  }\n  .bg-black\\/50 {\n    background-color: color-mix(in srgb, #000 50%, transparent);\n  }\n  @supports (color: color-mix(in lab, red, red)) {\n    .bg-black\\/50 {\n      background-color: color-mix(in oklab, var(--color-black) 50%, transparent);\n    }\n  }\n  .bg-blue-100 {\n    background-color: var(--color-blue-100);\n  }\n  .bg-blue-500 {\n    background-color: var(--color-blue-500);\n  }\n  .bg-gray-50 {\n    background-color: var(--color-gray-50);\n  }\n  .bg-gray-100 {\n    background-color: var(--color-gray-100);\n  }\n  .bg-gray-200 {\n    background-color: var(--color-gray-200);\n  }\n  .bg-gray-300 {\n    background-color: var(--color-gray-300);\n  }\n  .bg-gray-400 {\n    background-color: var(--color-gray-400);\n  }\n  .bg-gray-800 {\n    background-color: var(--color-gray-800);\n  }\n  .bg-gray-900 {\n    background-color: var(--color-gray-900);\n  }\n  .bg-green-100 {\n    background-color: var(--color-green-100);\n  }\n  .bg-green-500 {\n    background-color: var(--color-green-500);\n  }\n  .bg-indigo-50 {\n    background-color: var(--color-indigo-50);\n  }\n  .bg-indigo-100 {\n    background-color: var(--color-indigo-100);\n  }\n  .bg-indigo-400 {\n    background-color: var(--color-indigo-400);\n  }\n  .bg-indigo-500 {\n    background-color: var(--color-indigo-500);\n  }\n  .bg-indigo-600 {\n    background-color: var(--color-indigo-600);\n  }\n  .bg-orange-100 {\n    background-color: var(--color-orange-100);\n  }\n  .bg-orange-500 {\n    background-color: var(--color-orange-500);\n  }\n  .bg-red-100 {\n    background-color: var(--color-red-100);\n  }\n  .bg-red-500 {\n    background-color: var(--color-red-500);\n  }\n  .bg-slate-400 {\n    background-color: var(--color-slate-400);\n  }\n  .bg-slate-800\\/50 {\n    background-color: color-mix(in srgb, oklch(27.9% 0.041 260.031) 50%, transparent);\n  }\n  @supports (color: color-mix(in lab, red, red)) {\n    .bg-slate-800\\/50 {\n      background-color: color-mix(in oklab, var(--color-slate-800) 50%, transparent);\n    }\n  }\n  .bg-slate-900 {\n    background-color: var(--color-slate-900);\n  }\n  .bg-slate-900\\/80 {\n    background-color: color-mix(in srgb, oklch(20.8% 0.042 265.755) 80%, transparent);\n  }\n  @supports (color: color-mix(in lab, red, red)) {\n    .bg-slate-900\\/80 {\n      background-color: color-mix(in oklab, var(--color-slate-900) 80%, transparent);\n    }\n  }\n  .bg-white {\n    background-color: var(--color-white);\n  }\n  .bg-white\\/5 {\n    background-color: color-mix(in srgb, #fff 5%, transparent);\n  }\n  @supports (color: color-mix(in lab, red, red)) {\n    .bg-white\\/5 {\n      background-color: color-mix(in oklab, var(--color-white) 5%, transparent);\n    }\n  }\n  .bg-yellow-100 {\n    background-color: var(--color-yellow-100);\n  }\n  .bg-yellow-500 {\n    background-color: var(--color-yellow-500);\n  }\n  .bg-gradient-to-br {\n    --tw-gradient-position: to bottom right in oklab;\n    background-image: linear-gradient(var(--tw-gradient-stops));\n  }\n  .bg-gradient-to-r {\n    --tw-gradient-position: to right in oklab;\n    background-image: linear-gradient(var(--tw-gradient-stops));\n  }\n  .from-indigo-500 {\n    --tw-gradient-from: var(--color-indigo-500);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .from-orange-400 {\n    --tw-gradient-from: var(--color-orange-400);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .from-purple-500 {\n    --tw-gradient-from: var(--color-purple-500);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .from-purple-600 {\n    --tw-gradient-from: var(--color-purple-600);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .to-indigo-600 {\n    --tw-gradient-to: var(--color-indigo-600);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .to-purple-600 {\n    --tw-gradient-to: var(--color-purple-600);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .to-red-500 {\n    --tw-gradient-to: var(--color-red-500);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .p-1 {\n    padding: calc(var(--spacing) * 1);\n  }\n  .p-2 {\n    padding: calc(var(--spacing) * 2);\n  }\n  .p-3 {\n    padding: calc(var(--spacing) * 3);\n  }\n  .p-4 {\n    padding: calc(var(--spacing) * 4);\n  }\n  .p-6 {\n    padding: calc(var(--spacing) * 6);\n  }\n  .p-8 {\n    padding: calc(var(--spacing) * 8);\n  }\n  .p-12 {\n    padding: calc(var(--spacing) * 12);\n  }\n  .px-2 {\n    padding-inline: calc(var(--spacing) * 2);\n  }\n  .px-3 {\n    padding-inline: calc(var(--spacing) * 3);\n  }\n  .px-4 {\n    padding-inline: calc(var(--spacing) * 4);\n  }\n  .px-6 {\n    padding-inline: calc(var(--spacing) * 6);\n  }\n  .py-0\\.5 {\n    padding-block: calc(var(--spacing) * 0.5);\n  }\n  .py-1 {\n    padding-block: calc(var(--spacing) * 1);\n  }\n  .py-2 {\n    padding-block: calc(var(--spacing) * 2);\n  }\n  .py-3 {\n    padding-block: calc(var(--spacing) * 3);\n  }\n  .py-4 {\n    padding-block: calc(var(--spacing) * 4);\n  }\n  .py-8 {\n    padding-block: calc(var(--spacing) * 8);\n  }\n  .py-12 {\n    padding-block: calc(var(--spacing) * 12);\n  }\n  .pt-3 {\n    padding-top: calc(var(--spacing) * 3);\n  }\n  .pt-4 {\n    padding-top: calc(var(--spacing) * 4);\n  }\n  .pr-4 {\n    padding-right: calc(var(--spacing) * 4);\n  }\n  .pb-4 {\n    padding-bottom: calc(var(--spacing) * 4);\n  }\n  .pl-10 {\n    padding-left: calc(var(--spacing) * 10);\n  }\n  .text-center {\n    text-align: center;\n  }\n  .text-left {\n    text-align: left;\n  }\n  .font-mono {\n    font-family: var(--font-mono);\n  }\n  .text-2xl {\n    font-size: var(--text-2xl);\n    line-height: var(--tw-leading, var(--text-2xl--line-height));\n  }\n  .text-4xl {\n    font-size: var(--text-4xl);\n    line-height: var(--tw-leading, var(--text-4xl--line-height));\n  }\n  .text-base {\n    font-size: var(--text-base);\n    line-height: var(--tw-leading, var(--text-base--line-height));\n  }\n  .text-lg {\n    font-size: var(--text-lg);\n    line-height: var(--tw-leading, var(--text-lg--line-height));\n  }\n  .text-sm {\n    font-size: var(--text-sm);\n    line-height: var(--tw-leading, var(--text-sm--line-height));\n  }\n  .text-xl {\n    font-size: var(--text-xl);\n    line-height: var(--tw-leading, var(--text-xl--line-height));\n  }\n  .text-xs {\n    font-size: var(--text-xs);\n    line-height: var(--tw-leading, var(--text-xs--line-height));\n  }\n  .text-\\[10px\\] {\n    font-size: 10px;\n  }\n  .leading-snug {\n    --tw-leading: var(--leading-snug);\n    line-height: var(--leading-snug);\n  }\n  .font-bold {\n    --tw-font-weight: var(--font-weight-bold);\n    font-weight: var(--font-weight-bold);\n  }\n  .font-medium {\n    --tw-font-weight: var(--font-weight-medium);\n    font-weight: var(--font-weight-medium);\n  }\n  .font-semibold {\n    --tw-font-weight: var(--font-weight-semibold);\n    font-weight: var(--font-weight-semibold);\n  }\n  .text-blue-600 {\n    color: var(--color-blue-600);\n  }\n  .text-gray-400 {\n    color: var(--color-gray-400);\n  }\n  .text-gray-500 {\n    color: var(--color-gray-500);\n  }\n  .text-gray-600 {\n    color: var(--color-gray-600);\n  }\n  .text-gray-700 {\n    color: var(--color-gray-700);\n  }\n  .text-gray-800 {\n    color: var(--color-gray-800);\n  }\n  .text-green-600 {\n    color: var(--color-green-600);\n  }\n  .text-green-700 {\n    color: var(--color-green-700);\n  }\n  .text-indigo-600 {\n    color: var(--color-indigo-600);\n  }\n  .text-indigo-700 {\n    color: var(--color-indigo-700);\n  }\n  .text-orange-600 {\n    color: var(--color-orange-600);\n  }\n  .text-orange-700 {\n    color: var(--color-orange-700);\n  }\n  .text-red-400 {\n    color: var(--color-red-400);\n  }\n  .text-red-700 {\n    color: var(--color-red-700);\n  }\n  .text-slate-50 {\n    color: var(--color-slate-50);\n  }\n  .text-slate-300 {\n    color: var(--color-slate-300);\n  }\n  .text-slate-400 {\n    color: var(--color-slate-400);\n  }\n  .text-white {\n    color: var(--color-white);\n  }\n  .text-yellow-700 {\n    color: var(--color-yellow-700);\n  }\n  .uppercase {\n    text-transform: uppercase;\n  }\n  .placeholder-slate-500::placeholder {\n    color: var(--color-slate-500);\n  }\n  .shadow-2xl {\n    --tw-shadow: 0 25px 50px -12px var(--tw-shadow-color, rgb(0 0 0 / 0.25));\n    box-shadow:\n      var(--tw-inset-shadow),\n      var(--tw-inset-ring-shadow),\n      var(--tw-ring-offset-shadow),\n      var(--tw-ring-shadow),\n      var(--tw-shadow);\n  }\n  .shadow-lg {\n    --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 4px 6px -4px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow:\n      var(--tw-inset-shadow),\n      var(--tw-inset-ring-shadow),\n      var(--tw-ring-offset-shadow),\n      var(--tw-ring-shadow),\n      var(--tw-shadow);\n  }\n  .shadow-sm {\n    --tw-shadow: 0 1px 3px 0 var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 1px 2px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow:\n      var(--tw-inset-shadow),\n      var(--tw-inset-ring-shadow),\n      var(--tw-ring-offset-shadow),\n      var(--tw-ring-shadow),\n      var(--tw-shadow);\n  }\n  .shadow-xl {\n    --tw-shadow: 0 20px 25px -5px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 8px 10px -6px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow:\n      var(--tw-inset-shadow),\n      var(--tw-inset-ring-shadow),\n      var(--tw-ring-offset-shadow),\n      var(--tw-ring-shadow),\n      var(--tw-shadow);\n  }\n  .shadow-indigo-500\\/20 {\n    --tw-shadow-color: color-mix(in srgb, oklch(58.5% 0.233 277.117) 20%, transparent);\n  }\n  @supports (color: color-mix(in lab, red, red)) {\n    .shadow-indigo-500\\/20 {\n      --tw-shadow-color: color-mix(in oklab, color-mix(in oklab, var(--color-indigo-500) 20%, transparent) var(--tw-shadow-alpha), transparent);\n    }\n  }\n  .backdrop-blur-sm {\n    --tw-backdrop-blur: blur(var(--blur-sm));\n    -webkit-backdrop-filter: var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,);\n    backdrop-filter: var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,);\n  }\n  .backdrop-blur-xl {\n    --tw-backdrop-blur: blur(var(--blur-xl));\n    -webkit-backdrop-filter: var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,);\n    backdrop-filter: var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,);\n  }\n  .transition-all {\n    transition-property: all;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-colors {\n    transition-property:\n      color,\n      background-color,\n      border-color,\n      outline-color,\n      text-decoration-color,\n      fill,\n      stroke,\n      --tw-gradient-from,\n      --tw-gradient-via,\n      --tw-gradient-to;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-shadow {\n    transition-property: box-shadow;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-transform {\n    transition-property:\n      transform,\n      translate,\n      scale,\n      rotate;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .duration-200 {\n    --tw-duration: 200ms;\n    transition-duration: 200ms;\n  }\n  .outline-none {\n    --tw-outline-style: none;\n    outline-style: none;\n  }\n  @media (hover: hover) {\n    .group-hover\\:text-indigo-300:is(:where(.group):hover *) {\n      color: var(--color-indigo-300);\n    }\n  }\n  @media (hover: hover) {\n    .group-hover\\:text-indigo-600:is(:where(.group):hover *) {\n      color: var(--color-indigo-600);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:-translate-y-1:hover {\n      --tw-translate-y: calc(var(--spacing) * -1);\n      translate: var(--tw-translate-x) var(--tw-translate-y);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:border-indigo-300:hover {\n      border-color: var(--color-indigo-300);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:bg-gray-50:hover {\n      background-color: var(--color-gray-50);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:bg-gray-100:hover {\n      background-color: var(--color-gray-100);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:bg-gray-200:hover {\n      background-color: var(--color-gray-200);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:bg-indigo-500:hover {\n      background-color: var(--color-indigo-500);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:bg-indigo-700:hover {\n      background-color: var(--color-indigo-700);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:bg-white\\/10:hover {\n      background-color: color-mix(in srgb, #fff 10%, transparent);\n    }\n    @supports (color: color-mix(in lab, red, red)) {\n      .hover\\:bg-white\\/10:hover {\n        background-color: color-mix(in oklab, var(--color-white) 10%, transparent);\n      }\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:from-purple-700:hover {\n      --tw-gradient-from: var(--color-purple-700);\n      --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:to-indigo-700:hover {\n      --tw-gradient-to: var(--color-indigo-700);\n      --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:text-gray-600:hover {\n      color: var(--color-gray-600);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:text-gray-700:hover {\n      color: var(--color-gray-700);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:text-white:hover {\n      color: var(--color-white);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:shadow-lg:hover {\n      --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 4px 6px -4px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n      box-shadow:\n        var(--tw-inset-shadow),\n        var(--tw-inset-ring-shadow),\n        var(--tw-ring-offset-shadow),\n        var(--tw-ring-shadow),\n        var(--tw-shadow);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:shadow-md:hover {\n      --tw-shadow: 0 4px 6px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 2px 4px -2px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n      box-shadow:\n        var(--tw-inset-shadow),\n        var(--tw-inset-ring-shadow),\n        var(--tw-ring-offset-shadow),\n        var(--tw-ring-shadow),\n        var(--tw-shadow);\n    }\n  }\n  @media (hover: hover) {\n    .hover\\:shadow-xl:hover {\n      --tw-shadow: 0 20px 25px -5px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 8px 10px -6px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n      box-shadow:\n        var(--tw-inset-shadow),\n        var(--tw-inset-ring-shadow),\n        var(--tw-ring-offset-shadow),\n        var(--tw-ring-shadow),\n        var(--tw-shadow);\n    }\n  }\n  .focus\\:border-indigo-500:focus {\n    border-color: var(--color-indigo-500);\n  }\n  .focus\\:ring-2:focus {\n    --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n    box-shadow:\n      var(--tw-inset-shadow),\n      var(--tw-inset-ring-shadow),\n      var(--tw-ring-offset-shadow),\n      var(--tw-ring-shadow),\n      var(--tw-shadow);\n  }\n  .focus\\:ring-indigo-500:focus {\n    --tw-ring-color: var(--color-indigo-500);\n  }\n  .focus\\:outline-none:focus {\n    --tw-outline-style: none;\n    outline-style: none;\n  }\n  .disabled\\:cursor-not-allowed:disabled {\n    cursor: not-allowed;\n  }\n  .disabled\\:bg-gray-300:disabled {\n    background-color: var(--color-gray-300);\n  }\n  .disabled\\:from-gray-400:disabled {\n    --tw-gradient-from: var(--color-gray-400);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .disabled\\:to-gray-500:disabled {\n    --tw-gradient-to: var(--color-gray-500);\n    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));\n  }\n  .disabled\\:opacity-50:disabled {\n    opacity: 50%;\n  }\n  @media (width >= 48rem) {\n    .md\\:grid-cols-2 {\n      grid-template-columns: repeat(2, minmax(0, 1fr));\n    }\n  }\n  @media (width >= 48rem) {\n    .md\\:grid-cols-4 {\n      grid-template-columns: repeat(4, minmax(0, 1fr));\n    }\n  }\n  @media (width >= 64rem) {\n    .lg\\:grid-cols-3 {\n      grid-template-columns: repeat(3, minmax(0, 1fr));\n    }\n  }\n  @media (width >= 80rem) {\n    .xl\\:grid-cols-4 {\n      grid-template-columns: repeat(4, minmax(0, 1fr));\n    }\n  }\n}\nhtml,\nbody {\n  height: 100%;\n  margin: 0;\n  background-color: #0f172a;\n  color: #f8fafc;\n  font-family:\n    \"Inter\",\n    system-ui,\n    sans-serif;\n}\n@layer theme, base, components, utilities;\n@layer theme;\n@layer base {\n  *,\n  ::after,\n  ::before,\n  ::backdrop,\n  ::file-selector-button {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n    border: 0 solid;\n  }\n  html,\n  :host {\n    line-height: 1.5;\n    -webkit-text-size-adjust: 100%;\n    tab-size: 4;\n    font-family: var(--default-font-family, ui-sans-serif, system-ui, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\");\n    font-feature-settings: var(--default-font-feature-settings, normal);\n    font-variation-settings: var(--default-font-variation-settings, normal);\n    -webkit-tap-highlight-color: transparent;\n  }\n  hr {\n    height: 0;\n    color: inherit;\n    border-top-width: 1px;\n  }\n  abbr:where([title]) {\n    -webkit-text-decoration: underline dotted;\n    text-decoration: underline dotted;\n  }\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    font-size: inherit;\n    font-weight: inherit;\n  }\n  a {\n    color: inherit;\n    -webkit-text-decoration: inherit;\n    text-decoration: inherit;\n  }\n  b,\n  strong {\n    font-weight: bolder;\n  }\n  code,\n  kbd,\n  samp,\n  pre {\n    font-family: var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace);\n    font-feature-settings: var(--default-mono-font-feature-settings, normal);\n    font-variation-settings: var(--default-mono-font-variation-settings, normal);\n    font-size: 1em;\n  }\n  small {\n    font-size: 80%;\n  }\n  sub,\n  sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n  sub {\n    bottom: -0.25em;\n  }\n  sup {\n    top: -0.5em;\n  }\n  table {\n    text-indent: 0;\n    border-color: inherit;\n    border-collapse: collapse;\n  }\n  :-moz-focusring {\n    outline: auto;\n  }\n  progress {\n    vertical-align: baseline;\n  }\n  summary {\n    display: list-item;\n  }\n  ol,\n  ul,\n  menu {\n    list-style: none;\n  }\n  img,\n  svg,\n  video,\n  canvas,\n  audio,\n  iframe,\n  embed,\n  object {\n    display: block;\n    vertical-align: middle;\n  }\n  img,\n  video {\n    max-width: 100%;\n    height: auto;\n  }\n  button,\n  input,\n  select,\n  optgroup,\n  textarea,\n  ::file-selector-button {\n    font: inherit;\n    font-feature-settings: inherit;\n    font-variation-settings: inherit;\n    letter-spacing: inherit;\n    color: inherit;\n    border-radius: 0;\n    background-color: transparent;\n    opacity: 1;\n  }\n  :where(select:is([multiple], [size])) optgroup {\n    font-weight: bolder;\n  }\n  :where(select:is([multiple], [size])) optgroup option {\n    padding-inline-start: 20px;\n  }\n  ::file-selector-button {\n    margin-inline-end: 4px;\n  }\n  ::placeholder {\n    opacity: 1;\n  }\n  @supports (not (-webkit-appearance: -apple-pay-button)) or (contain-intrinsic-size: 1px) {\n    ::placeholder {\n      color: currentcolor;\n    }\n    @supports (color: color-mix(in lab, red, red)) {\n      ::placeholder {\n        color: color-mix(in oklab, currentcolor 50%, transparent);\n      }\n    }\n  }\n  textarea {\n    resize: vertical;\n  }\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n  ::-webkit-date-and-time-value {\n    min-height: 1lh;\n    text-align: inherit;\n  }\n  ::-webkit-datetime-edit {\n    display: inline-flex;\n  }\n  ::-webkit-datetime-edit-fields-wrapper {\n    padding: 0;\n  }\n  ::-webkit-datetime-edit,\n  ::-webkit-datetime-edit-year-field,\n  ::-webkit-datetime-edit-month-field,\n  ::-webkit-datetime-edit-day-field,\n  ::-webkit-datetime-edit-hour-field,\n  ::-webkit-datetime-edit-minute-field,\n  ::-webkit-datetime-edit-second-field,\n  ::-webkit-datetime-edit-millisecond-field,\n  ::-webkit-datetime-edit-meridiem-field {\n    padding-block: 0;\n  }\n  ::-webkit-calendar-picker-indicator {\n    line-height: 1;\n  }\n  :-moz-ui-invalid {\n    box-shadow: none;\n  }\n  button,\n  input:where([type=button], [type=reset], [type=submit]),\n  ::file-selector-button {\n    appearance: button;\n  }\n  ::-webkit-inner-spin-button,\n  ::-webkit-outer-spin-button {\n    height: auto;\n  }\n  [hidden]:where(:not([hidden=until-found])) {\n    display: none !important;\n  }\n}\n@layer utilities;\n@property --tw-translate-x { syntax: \"*\"; inherits: false; initial-value: 0; }\n@property --tw-translate-y { syntax: \"*\"; inherits: false; initial-value: 0; }\n@property --tw-translate-z { syntax: \"*\"; inherits: false; initial-value: 0; }\n@property --tw-rotate-x { syntax: \"*\"; inherits: false; }\n@property --tw-rotate-y { syntax: \"*\"; inherits: false; }\n@property --tw-rotate-z { syntax: \"*\"; inherits: false; }\n@property --tw-skew-x { syntax: \"*\"; inherits: false; }\n@property --tw-skew-y { syntax: \"*\"; inherits: false; }\n@property --tw-space-y-reverse { syntax: \"*\"; inherits: false; initial-value: 0; }\n@property --tw-space-x-reverse { syntax: \"*\"; inherits: false; initial-value: 0; }\n@property --tw-border-style { syntax: \"*\"; inherits: false; initial-value: solid; }\n@property --tw-gradient-position { syntax: \"*\"; inherits: false; }\n@property --tw-gradient-from { syntax: \"<color>\"; inherits: false; initial-value: #0000; }\n@property --tw-gradient-via { syntax: \"<color>\"; inherits: false; initial-value: #0000; }\n@property --tw-gradient-to { syntax: \"<color>\"; inherits: false; initial-value: #0000; }\n@property --tw-gradient-stops { syntax: \"*\"; inherits: false; }\n@property --tw-gradient-via-stops { syntax: \"*\"; inherits: false; }\n@property --tw-gradient-from-position { syntax: \"<length-percentage>\"; inherits: false; initial-value: 0%; }\n@property --tw-gradient-via-position { syntax: \"<length-percentage>\"; inherits: false; initial-value: 50%; }\n@property --tw-gradient-to-position { syntax: \"<length-percentage>\"; inherits: false; initial-value: 100%; }\n@property --tw-leading { syntax: \"*\"; inherits: false; }\n@property --tw-font-weight { syntax: \"*\"; inherits: false; }\n@property --tw-shadow { syntax: \"*\"; inherits: false; initial-value: 0 0 #0000; }\n@property --tw-shadow-color { syntax: \"*\"; inherits: false; }\n@property --tw-shadow-alpha { syntax: \"<percentage>\"; inherits: false; initial-value: 100%; }\n@property --tw-inset-shadow { syntax: \"*\"; inherits: false; initial-value: 0 0 #0000; }\n@property --tw-inset-shadow-color { syntax: \"*\"; inherits: false; }\n@property --tw-inset-shadow-alpha { syntax: \"<percentage>\"; inherits: false; initial-value: 100%; }\n@property --tw-ring-color { syntax: \"*\"; inherits: false; }\n@property --tw-ring-shadow { syntax: \"*\"; inherits: false; initial-value: 0 0 #0000; }\n@property --tw-inset-ring-color { syntax: \"*\"; inherits: false; }\n@property --tw-inset-ring-shadow { syntax: \"*\"; inherits: false; initial-value: 0 0 #0000; }\n@property --tw-ring-inset { syntax: \"*\"; inherits: false; }\n@property --tw-ring-offset-width { syntax: \"<length>\"; inherits: false; initial-value: 0px; }\n@property --tw-ring-offset-color { syntax: \"*\"; inherits: false; initial-value: #fff; }\n@property --tw-ring-offset-shadow { syntax: \"*\"; inherits: false; initial-value: 0 0 #0000; }\n@property --tw-backdrop-blur { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-brightness { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-contrast { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-grayscale { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-hue-rotate { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-invert { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-opacity { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-saturate { syntax: \"*\"; inherits: false; }\n@property --tw-backdrop-sepia { syntax: \"*\"; inherits: false; }\n@property --tw-duration { syntax: \"*\"; inherits: false; }\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n@keyframes pulse {\n  50% {\n    opacity: 0.5;\n  }\n}\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n@keyframes pulse {\n  50% {\n    opacity: 0.5;\n  }\n}\n@layer properties {\n  @supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))) {\n    *,\n    ::before,\n    ::after,\n    ::backdrop {\n      --tw-translate-x: 0;\n      --tw-translate-y: 0;\n      --tw-translate-z: 0;\n      --tw-rotate-x: initial;\n      --tw-rotate-y: initial;\n      --tw-rotate-z: initial;\n      --tw-skew-x: initial;\n      --tw-skew-y: initial;\n      --tw-space-y-reverse: 0;\n      --tw-space-x-reverse: 0;\n      --tw-border-style: solid;\n      --tw-gradient-position: initial;\n      --tw-gradient-from: #0000;\n      --tw-gradient-via: #0000;\n      --tw-gradient-to: #0000;\n      --tw-gradient-stops: initial;\n      --tw-gradient-via-stops: initial;\n      --tw-gradient-from-position: 0%;\n      --tw-gradient-via-position: 50%;\n      --tw-gradient-to-position: 100%;\n      --tw-leading: initial;\n      --tw-font-weight: initial;\n      --tw-shadow: 0 0 #0000;\n      --tw-shadow-color: initial;\n      --tw-shadow-alpha: 100%;\n      --tw-inset-shadow: 0 0 #0000;\n      --tw-inset-shadow-color: initial;\n      --tw-inset-shadow-alpha: 100%;\n      --tw-ring-color: initial;\n      --tw-ring-shadow: 0 0 #0000;\n      --tw-inset-ring-color: initial;\n      --tw-inset-ring-shadow: 0 0 #0000;\n      --tw-ring-inset: initial;\n      --tw-ring-offset-width: 0px;\n      --tw-ring-offset-color: #fff;\n      --tw-ring-offset-shadow: 0 0 #0000;\n      --tw-backdrop-blur: initial;\n      --tw-backdrop-brightness: initial;\n      --tw-backdrop-contrast: initial;\n      --tw-backdrop-grayscale: initial;\n      --tw-backdrop-hue-rotate: initial;\n      --tw-backdrop-invert: initial;\n      --tw-backdrop-opacity: initial;\n      --tw-backdrop-saturate: initial;\n      --tw-backdrop-sepia: initial;\n      --tw-duration: initial;\n    }\n  }\n}\n\n/* angular:styles/global:styles */\n/*# sourceMappingURL=styles.css.map */\n"
          },
          "redirectURL": "",
          "headersSize": 127,
          "bodySize": 0,
          "_transferSize": 127,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.161Z",
        "time": 36.58799995901064,
        "timings": {
          "blocked": 33.533999970257284,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.136,
          "wait": 2.432000013399869,
          "receive": 0.4859999753534794,
          "_blocked_queueing": 32.98899997025728,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16075",
        "_initiator": {
          "type": "parser",
          "url": "http://localhost:4200/login",
          "lineNumber": 12
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/main.js",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "If-None-Match",
              "value": "W/\"1a8b-+RCjJIQTnwBmkpSD4P+LYS3r7bk\""
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/login"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 630,
          "bodySize": 0
        },
        "response": {
          "status": 304,
          "statusText": "Not Modified",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 16698,
            "mimeType": "text/javascript",
            "text": "import { injectQuery as __vite__injectQuery } from \"/@vite/client\";import { createHotContext as __vite__createHotContext } from \"/@vite/client\";import.meta.hot = __vite__createHotContext(\"/main.js\");import {\n  AuthService,\n  __spreadValues\n} from \"/chunk-KOJ36IQF.js\";\n\n// src/main.ts\nimport { bootstrapApplication } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b\";\n\n// src/app/app.config.ts\nimport { provideBrowserGlobalErrorListeners } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nimport { provideRouter } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_router.js?v=a3ec8c6b\";\nimport { provideHttpClient, withFetch, withInterceptors } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common_http.js?v=a3ec8c6b\";\n\n// src/app/guards/auth.guard.ts\nimport { isPlatformBrowser } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common.js?v=a3ec8c6b\";\nimport { inject, PLATFORM_ID } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nimport { Router } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_router.js?v=a3ec8c6b\";\nvar authGuard = (_route, state) => {\n  const platformId = inject(PLATFORM_ID);\n  const authService = inject(AuthService);\n  const router = inject(Router);\n  if (!isPlatformBrowser(platformId)) {\n    console.log(\"[authGuard] SSR mode - passing through\");\n    return true;\n  }\n  const token = authService.getToken();\n  console.log(\"[authGuard] Token:\", token ? \"EXISTS\" : \"NONE\");\n  if (authService.isAuthenticated()) {\n    console.log(\"[authGuard] Authenticated - allowing access\");\n    return true;\n  }\n  console.log(\"[authGuard] Not authenticated - redirecting to login\");\n  return router.createUrlTree([\"/login\"], {\n    queryParams: { returnUrl: state.url }\n  });\n};\nvar guestGuard = () => {\n  const platformId = inject(PLATFORM_ID);\n  const authService = inject(AuthService);\n  const router = inject(Router);\n  if (!isPlatformBrowser(platformId)) {\n    return true;\n  }\n  if (!authService.isAuthenticated()) {\n    return true;\n  }\n  return router.createUrlTree([\"/\"]);\n};\n\n// src/app/app.routes.ts\nvar routes = [\n  __spreadValues({\n    path: \"\",\n    loadComponent: () => import(\"/chunk-BAMQFQZA.js\").then((m) => m.DashboardComponent),\n    canActivate: [authGuard]\n  }, false ? { \\u0275entryName: \"src/app/pages/dashboard/dashboard.component.ts\" } : {}),\n  __spreadValues({\n    path: \"login\",\n    loadComponent: () => import(\"/chunk-K7W62EAA.js\").then((m) => m.LoginComponent),\n    canActivate: [guestGuard]\n  }, false ? { \\u0275entryName: \"src/app/pages/login/login.component.ts\" } : {}),\n  __spreadValues({\n    path: \"projects/:id\",\n    loadComponent: () => import(\"/chunk-NVRNB2WO.js\").then((m) => m.ProjectDetails),\n    canActivate: [authGuard]\n  }, false ? { \\u0275entryName: \"src/app/pages/project-details/project-details.ts\" } : {}),\n  __spreadValues({\n    path: \"auth/callback\",\n    loadComponent: () => import(\"/chunk-EKLCFUJH.js\").then((m) => m.AuthCallbackComponent)\n  }, false ? { \\u0275entryName: \"src/app/pages/auth-callback/auth-callback.component.ts\" } : {}),\n  {\n    path: \"**\",\n    redirectTo: \"\"\n  }\n];\n\n// src/app/app.config.ts\nimport { provideClientHydration, withEventReplay } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b\";\n\n// src/app/interceptors/auth-interceptor.ts\nimport { isPlatformBrowser as isPlatformBrowser2 } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common.js?v=a3ec8c6b\";\nimport { inject as inject2, PLATFORM_ID as PLATFORM_ID2 } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nvar authInterceptor = (req, next) => {\n  const platformId = inject2(PLATFORM_ID2);\n  if (isPlatformBrowser2(platformId)) {\n    const token = localStorage.getItem(\"auth_token\");\n    if (token) {\n      req = req.clone({\n        setHeaders: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n    }\n  }\n  return next(req);\n};\n\n// src/app/app.config.ts\nvar appConfig = {\n  providers: [\n    provideBrowserGlobalErrorListeners(),\n    provideRouter(routes),\n    provideClientHydration(withEventReplay()),\n    provideHttpClient(withFetch(), withInterceptors([authInterceptor]))\n  ]\n};\n\n// src/app/app.ts\nimport { Component, signal } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nimport { RouterOutlet } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_router.js?v=a3ec8c6b\";\nimport * as i0 from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nvar App = class _App {\n  title = signal(\"frontend\", ...ngDevMode ? [{ debugName: \"title\" }] : []);\n  static \\u0275fac = function App_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _App)();\n  };\n  static \\u0275cmp = /* @__PURE__ */ i0.\\u0275\\u0275defineComponent({ type: _App, selectors: [[\"app-root\"]], decls: 1, vars: 0, template: function App_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.\\u0275\\u0275element(0, \"router-outlet\");\n    }\n  }, dependencies: [RouterOutlet], encapsulation: 2 });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\\u0275setClassMetadata(App, [{\n    type: Component,\n    args: [{ selector: \"app-root\", imports: [RouterOutlet], template: \"<router-outlet />\\r\\n\" }]\n  }], null, null);\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\\u0275setClassDebugInfo(App, { className: \"App\", filePath: \"src/app/app.ts\", lineNumber: 10 });\n})();\n(() => {\n  const id = \"src%2Fapp%2Fapp.ts%40App\";\n  function App_HmrLoad(t) {\n    import(\n      /* @vite-ignore */\n      __vite__injectQuery(i0.\\u0275\\u0275getReplaceMetadataURL(id, t, import.meta.url), 'import')\n    ).then((m) => m.default && i0.\\u0275\\u0275replaceMetadata(App, m.default, [i0], [RouterOutlet, Component], import.meta, id));\n  }\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && App_HmrLoad(Date.now());\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && (import.meta.hot && import.meta.hot.on(\"angular:component-update\", (d) => d.id === id && App_HmrLoad(d.timestamp)));\n})();\n\n// src/main.ts\nbootstrapApplication(App, appConfig).catch((err) => console.error(err));\n\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tYWluLnRzIiwic3JjL2FwcC9hcHAuY29uZmlnLnRzIiwic3JjL2FwcC9ndWFyZHMvYXV0aC5ndWFyZC50cyIsInNyYy9hcHAvYXBwLnJvdXRlcy50cyIsInNyYy9hcHAvaW50ZXJjZXB0b3JzL2F1dGgtaW50ZXJjZXB0b3IudHMiLCJzcmMvYXBwL2FwcC50cyIsInNyYy9hcHAvYXBwLmh0bWwiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYm9vdHN0cmFwQXBwbGljYXRpb24gfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuaW1wb3J0IHsgYXBwQ29uZmlnIH0gZnJvbSAnLi9hcHAvYXBwLmNvbmZpZyc7XHJcbmltcG9ydCB7IEFwcCB9IGZyb20gJy4vYXBwL2FwcCc7XHJcblxyXG5ib290c3RyYXBBcHBsaWNhdGlvbihBcHAsIGFwcENvbmZpZylcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuIiwiaW1wb3J0IHsgQXBwbGljYXRpb25Db25maWcsIHByb3ZpZGVCcm93c2VyR2xvYmFsRXJyb3JMaXN0ZW5lcnMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgcHJvdmlkZVJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IHByb3ZpZGVIdHRwQ2xpZW50LCB3aXRoRmV0Y2gsIHdpdGhJbnRlcmNlcHRvcnMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcblxyXG5pbXBvcnQgeyByb3V0ZXMgfSBmcm9tICcuL2FwcC5yb3V0ZXMnO1xyXG5pbXBvcnQgeyBwcm92aWRlQ2xpZW50SHlkcmF0aW9uLCB3aXRoRXZlbnRSZXBsYXkgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuaW1wb3J0IHsgYXV0aEludGVyY2VwdG9yIH0gZnJvbSAnLi9pbnRlcmNlcHRvcnMvYXV0aC1pbnRlcmNlcHRvcic7XHJcblxyXG5leHBvcnQgY29uc3QgYXBwQ29uZmlnOiBBcHBsaWNhdGlvbkNvbmZpZyA9IHtcclxuICBwcm92aWRlcnM6IFtcclxuICAgIHByb3ZpZGVCcm93c2VyR2xvYmFsRXJyb3JMaXN0ZW5lcnMoKSxcclxuICAgIHByb3ZpZGVSb3V0ZXIocm91dGVzKSxcclxuICAgIHByb3ZpZGVDbGllbnRIeWRyYXRpb24od2l0aEV2ZW50UmVwbGF5KCkpLFxyXG4gICAgcHJvdmlkZUh0dHBDbGllbnQod2l0aEZldGNoKCksIHdpdGhJbnRlcmNlcHRvcnMoW2F1dGhJbnRlcmNlcHRvcl0pKVxyXG4gIF1cclxufTtcclxuIiwiaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgaW5qZWN0LCBQTEFURk9STV9JRCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2FuQWN0aXZhdGVGbiwgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IEF1dGhTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvYXV0aCc7XG5cbi8qKlxuICogR3VhcmQgcG91ciBsZXMgcGFnZXMgcHJvdMOpZ8OpZXMgKGRhc2hib2FyZCwgcHJvamVjdHMpXG4gKiBSZWRpcmlnZSB2ZXJzIC9sb2dpbiBzaSBub24gY29ubmVjdMOpXG4gKi9cbmV4cG9ydCBjb25zdCBhdXRoR3VhcmQ6IENhbkFjdGl2YXRlRm4gPSAoX3JvdXRlLCBzdGF0ZSkgPT4ge1xuICBjb25zdCBwbGF0Zm9ybUlkID0gaW5qZWN0KFBMQVRGT1JNX0lEKTtcbiAgY29uc3QgYXV0aFNlcnZpY2UgPSBpbmplY3QoQXV0aFNlcnZpY2UpO1xuICBjb25zdCByb3V0ZXIgPSBpbmplY3QoUm91dGVyKTtcblxuICAvLyBDw7R0w6kgc2VydmV1ciAoU1NSKSwgb24gbGFpc3NlIHBhc3NlciBwb3VyIGxlIHJlbmR1IGluaXRpYWxcbiAgaWYgKCFpc1BsYXRmb3JtQnJvd3NlcihwbGF0Zm9ybUlkKSkge1xuICAgIGNvbnNvbGUubG9nKCdbYXV0aEd1YXJkXSBTU1IgbW9kZSAtIHBhc3NpbmcgdGhyb3VnaCcpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICBjb25zb2xlLmxvZygnW2F1dGhHdWFyZF0gVG9rZW46JywgdG9rZW4gPyAnRVhJU1RTJyA6ICdOT05FJyk7XG5cbiAgLy8gVXRpbGlzYXRldXIgY29ubmVjdMOpIOKGkiBhY2PDqHMgYXV0b3Jpc8OpXG4gIGlmIChhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgIGNvbnNvbGUubG9nKCdbYXV0aEd1YXJkXSBBdXRoZW50aWNhdGVkIC0gYWxsb3dpbmcgYWNjZXNzJyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBOb24gY29ubmVjdMOpIOKGkiByZWRpcmVjdGlvbiB2ZXJzIGxvZ2luIGF2ZWMgcmV0dXJuVXJsXG4gIGNvbnNvbGUubG9nKCdbYXV0aEd1YXJkXSBOb3QgYXV0aGVudGljYXRlZCAtIHJlZGlyZWN0aW5nIHRvIGxvZ2luJyk7XG4gIHJldHVybiByb3V0ZXIuY3JlYXRlVXJsVHJlZShbJy9sb2dpbiddLCB7XG4gICAgcXVlcnlQYXJhbXM6IHsgcmV0dXJuVXJsOiBzdGF0ZS51cmwgfSxcbiAgfSk7XG59O1xuXG4vKipcbiAqIEd1YXJkIHBvdXIgbGEgcGFnZSBsb2dpblxuICogUmVkaXJpZ2UgdmVycyAvIHNpIGTDqWrDoCBjb25uZWN0w6lcbiAqL1xuZXhwb3J0IGNvbnN0IGd1ZXN0R3VhcmQ6IENhbkFjdGl2YXRlRm4gPSAoKSA9PiB7XG4gIGNvbnN0IHBsYXRmb3JtSWQgPSBpbmplY3QoUExBVEZPUk1fSUQpO1xuICBjb25zdCBhdXRoU2VydmljZSA9IGluamVjdChBdXRoU2VydmljZSk7XG4gIGNvbnN0IHJvdXRlciA9IGluamVjdChSb3V0ZXIpO1xuXG4gIC8vIEPDtHTDqSBzZXJ2ZXVyIChTU1IpLCBvbiBsYWlzc2UgcGFzc2VyXG4gIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIocGxhdGZvcm1JZCkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIE5vbiBjb25uZWN0w6kg4oaSIGFjY8OocyBhdXRvcmlzw6kgw6AgbGEgcGFnZSBsb2dpblxuICBpZiAoIWF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBEw6lqw6AgY29ubmVjdMOpIOKGkiByZWRpcmVjdGlvbiB2ZXJzIGRhc2hib2FyZFxuICByZXR1cm4gcm91dGVyLmNyZWF0ZVVybFRyZWUoWycvJ10pO1xufTtcbiIsImltcG9ydCB7IFJvdXRlcyB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IGF1dGhHdWFyZCwgZ3Vlc3RHdWFyZCB9IGZyb20gJy4vZ3VhcmRzL2F1dGguZ3VhcmQnO1xyXG5cclxuZXhwb3J0IGNvbnN0IHJvdXRlczogUm91dGVzID0gW1xyXG4gIHtcclxuICAgIHBhdGg6ICcnLFxyXG4gICAgbG9hZENvbXBvbmVudDogKCkgPT5cclxuICAgICAgaW1wb3J0KCcuL3BhZ2VzL2Rhc2hib2FyZC9kYXNoYm9hcmQuY29tcG9uZW50JykudGhlbigobSkgPT4gbS5EYXNoYm9hcmRDb21wb25lbnQpLFxyXG4gICAgY2FuQWN0aXZhdGU6IFthdXRoR3VhcmRdLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgcGF0aDogJ2xvZ2luJyxcclxuICAgIGxvYWRDb21wb25lbnQ6ICgpID0+XHJcbiAgICAgIGltcG9ydCgnLi9wYWdlcy9sb2dpbi9sb2dpbi5jb21wb25lbnQnKS50aGVuKChtKSA9PiBtLkxvZ2luQ29tcG9uZW50KSxcclxuICAgIGNhbkFjdGl2YXRlOiBbZ3Vlc3RHdWFyZF0sXHJcbiAgfSxcclxuICB7XHJcbiAgICBwYXRoOiAncHJvamVjdHMvOmlkJyxcclxuICAgIGxvYWRDb21wb25lbnQ6ICgpID0+XHJcbiAgICAgIGltcG9ydCgnLi9wYWdlcy9wcm9qZWN0LWRldGFpbHMvcHJvamVjdC1kZXRhaWxzJykudGhlbigobSkgPT4gbS5Qcm9qZWN0RGV0YWlscyksXHJcbiAgICBjYW5BY3RpdmF0ZTogW2F1dGhHdWFyZF0sXHJcbiAgfSxcclxuICB7XHJcbiAgICBwYXRoOiAnYXV0aC9jYWxsYmFjaycsXHJcbiAgICBsb2FkQ29tcG9uZW50OiAoKSA9PlxyXG4gICAgICBpbXBvcnQoJy4vcGFnZXMvYXV0aC1jYWxsYmFjay9hdXRoLWNhbGxiYWNrLmNvbXBvbmVudCcpLnRoZW4oKG0pID0+IG0uQXV0aENhbGxiYWNrQ29tcG9uZW50KSxcclxuICB9LFxyXG4gIHtcclxuICAgIHBhdGg6ICcqKicsXHJcbiAgICByZWRpcmVjdFRvOiAnJyxcclxuICB9LFxyXG5dO1xyXG4iLCJpbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IEh0dHBJbnRlcmNlcHRvckZuIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBpbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5leHBvcnQgY29uc3QgYXV0aEludGVyY2VwdG9yOiBIdHRwSW50ZXJjZXB0b3JGbiA9IChyZXEsIG5leHQpID0+IHtcclxuICBjb25zdCBwbGF0Zm9ybUlkID0gaW5qZWN0KFBMQVRGT1JNX0lEKTtcclxuXHJcbiAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHBsYXRmb3JtSWQpKSB7XHJcbiAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhdXRoX3Rva2VuJyk7XHJcbiAgICBpZiAodG9rZW4pIHtcclxuICAgICAgcmVxID0gcmVxLmNsb25lKHtcclxuICAgICAgICBzZXRIZWFkZXJzOiB7XHJcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YCxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBuZXh0KHJlcSk7XHJcbn07XHJcbiIsImltcG9ydCB7IENvbXBvbmVudCwgc2lnbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFJvdXRlck91dGxldCB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1yb290JyxcclxuICBpbXBvcnRzOiBbUm91dGVyT3V0bGV0XSxcclxuICB0ZW1wbGF0ZVVybDogJy4vYXBwLmh0bWwnLFxyXG4gIHN0eWxlVXJsOiAnLi9hcHAuY3NzJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgQXBwIHtcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgdGl0bGUgPSBzaWduYWwoJ2Zyb250ZW5kJyk7XHJcbn1cclxuIiwiPHJvdXRlci1vdXRsZXQgLz5cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxTQUFTLDRCQUE0Qjs7O0FDQXJDLFNBQTRCLDBDQUEwQztBQUN0RSxTQUFTLHFCQUFxQjtBQUM5QixTQUFTLG1CQUFtQixXQUFXLHdCQUF3Qjs7O0FDRi9ELFNBQVMseUJBQXlCO0FBQ2xDLFNBQVMsUUFBUSxtQkFBbUI7QUFDcEMsU0FBd0IsY0FBYztBQU8vQixJQUFNLFlBQTJCLENBQUMsUUFBUSxVQUFTO0FBQ3hELFFBQU0sYUFBYSxPQUFPLFdBQVc7QUFDckMsUUFBTSxjQUFjLE9BQU8sV0FBVztBQUN0QyxRQUFNLFNBQVMsT0FBTyxNQUFNO0FBRzVCLE1BQUksQ0FBQyxrQkFBa0IsVUFBVSxHQUFHO0FBQ2xDLFlBQVEsSUFBSSx3Q0FBd0M7QUFDcEQsV0FBTztFQUNUO0FBRUEsUUFBTSxRQUFRLFlBQVksU0FBUTtBQUNsQyxVQUFRLElBQUksc0JBQXNCLFFBQVEsV0FBVyxNQUFNO0FBRzNELE1BQUksWUFBWSxnQkFBZSxHQUFJO0FBQ2pDLFlBQVEsSUFBSSw2Q0FBNkM7QUFDekQsV0FBTztFQUNUO0FBR0EsVUFBUSxJQUFJLHNEQUFzRDtBQUNsRSxTQUFPLE9BQU8sY0FBYyxDQUFDLFFBQVEsR0FBRztJQUN0QyxhQUFhLEVBQUUsV0FBVyxNQUFNLElBQUc7R0FDcEM7QUFDSDtBQU1PLElBQU0sYUFBNEIsTUFBSztBQUM1QyxRQUFNLGFBQWEsT0FBTyxXQUFXO0FBQ3JDLFFBQU0sY0FBYyxPQUFPLFdBQVc7QUFDdEMsUUFBTSxTQUFTLE9BQU8sTUFBTTtBQUc1QixNQUFJLENBQUMsa0JBQWtCLFVBQVUsR0FBRztBQUNsQyxXQUFPO0VBQ1Q7QUFHQSxNQUFJLENBQUMsWUFBWSxnQkFBZSxHQUFJO0FBQ2xDLFdBQU87RUFDVDtBQUdBLFNBQU8sT0FBTyxjQUFjLENBQUMsR0FBRyxDQUFDO0FBQ25DOzs7QUN0RE8sSUFBTSxTQUFpQjtFQUM1QjtJQUNFLE1BQU07SUFDTixlQUFlLE1BQ2IsT0FBTyxxQkFBdUMsRUFBRSxLQUFLLENBQUMsTUFBTSxFQUFFLGtCQUFrQjtJQUNsRixhQUFhLENBQUMsU0FBUzs7RUFFekI7SUFDRSxNQUFNO0lBQ04sZUFBZSxNQUNiLE9BQU8scUJBQStCLEVBQUUsS0FBSyxDQUFDLE1BQU0sRUFBRSxjQUFjO0lBQ3RFLGFBQWEsQ0FBQyxVQUFVOztFQUUxQjtJQUNFLE1BQU07SUFDTixlQUFlLE1BQ2IsT0FBTyxxQkFBeUMsRUFBRSxLQUFLLENBQUMsTUFBTSxFQUFFLGNBQWM7SUFDaEYsYUFBYSxDQUFDLFNBQVM7O0VBRXpCO0lBQ0UsTUFBTTtJQUNOLGVBQWUsTUFDYixPQUFPLHFCQUErQyxFQUFFLEtBQUssQ0FBQyxNQUFNLEVBQUUscUJBQXFCOztFQUUvRjtJQUNFLE1BQU07SUFDTixZQUFZOzs7OztBRnhCaEIsU0FBUyx3QkFBd0IsdUJBQXVCOzs7QUdMeEQsU0FBUyxxQkFBQUEsMEJBQXlCO0FBRWxDLFNBQVMsVUFBQUMsU0FBUSxlQUFBQyxvQkFBbUI7QUFFN0IsSUFBTSxrQkFBcUMsQ0FBQyxLQUFLLFNBQVE7QUFDOUQsUUFBTSxhQUFhRCxRQUFPQyxZQUFXO0FBRXJDLE1BQUlGLG1CQUFrQixVQUFVLEdBQUc7QUFDakMsVUFBTSxRQUFRLGFBQWEsUUFBUSxZQUFZO0FBQy9DLFFBQUksT0FBTztBQUNULFlBQU0sSUFBSSxNQUFNO1FBQ2QsWUFBWTtVQUNWLGVBQWUsVUFBVSxLQUFLOztPQUVqQztJQUNIO0VBQ0Y7QUFFQSxTQUFPLEtBQUssR0FBRztBQUNqQjs7O0FIWE8sSUFBTSxZQUErQjtFQUMxQyxXQUFXO0lBQ1QsbUNBQWtDO0lBQ2xDLGNBQWMsTUFBTTtJQUNwQix1QkFBdUIsZ0JBQWUsQ0FBRTtJQUN4QyxrQkFBa0IsVUFBUyxHQUFJLGlCQUFpQixDQUFDLGVBQWUsQ0FBQyxDQUFDOzs7OztBSWJ0RSxTQUFTLFdBQVcsY0FBYztBQUNsQyxTQUFTLG9CQUFvQjs7QUFRdkIsSUFBTyxNQUFQLE1BQU8sS0FBRztFQUNLLFFBQVEsT0FBTyxZQUFVLEdBQUEsWUFBQSxDQUFBLEVBQUEsV0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7O3FDQURqQyxNQUFHO0VBQUE7NEVBQUgsTUFBRyxXQUFBLENBQUEsQ0FBQSxVQUFBLENBQUEsR0FBQSxPQUFBLEdBQUEsTUFBQSxHQUFBLFVBQUEsU0FBQSxhQUFBLElBQUEsS0FBQTtBQUFBLFFBQUEsS0FBQSxHQUFBO0FDVGhCLE1BQUEsdUJBQUEsR0FBQSxlQUFBOztvQkRLWSxZQUFZLEdBQUEsZUFBQSxFQUFBLENBQUE7OzsrRUFJWCxLQUFHLENBQUE7VUFOZjt1QkFDVyxZQUFVLFNBQ1gsQ0FBQyxZQUFZLEdBQUMsVUFBQSx3QkFBQSxDQUFBOzs7O2dGQUlaLEtBQUcsRUFBQSxXQUFBLE9BQUEsVUFBQSxrQkFBQSxZQUFBLEdBQUEsQ0FBQTtBQUFBLEdBQUE7Ozs7Ozs7OERBQUgsS0FBRyxFQUFBLFNBQUEsQ0FBQSxFQUFBLEdBQUEsQ0FBQSxjQUFBLFNBQUEsR0FBQSxhQUFBLEVBQUEsQ0FBQTtFQUFBO0FBQUEsR0FBQSxPQUFBLGNBQUEsZUFBQSxjQUFBLFlBQUEsS0FBQSxJQUFBLENBQUE7QUFBQSxHQUFBLE9BQUEsY0FBQSxlQUFBLGVBQUEsWUFBQSxPQUFBLFlBQUEsSUFBQSxHQUFBLDRCQUFBLE9BQUEsRUFBQSxPQUFBLE1BQUEsWUFBQSxFQUFBLFNBQUEsQ0FBQTtBQUFBLEdBQUE7OztBTExoQixxQkFBcUIsS0FBSyxTQUFTLEVBQ2hDLE1BQU0sQ0FBQyxRQUFRLFFBQVEsTUFBTSxHQUFHLENBQUM7IiwibmFtZXMiOlsiaXNQbGF0Zm9ybUJyb3dzZXIiLCJpbmplY3QiLCJQTEFURk9STV9JRCJdfQ=="
          },
          "redirectURL": "",
          "headersSize": 179,
          "bodySize": 0,
          "_transferSize": 179,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.161Z",
        "time": 37.065999989863485,
        "timings": {
          "blocked": 35.77000000868365,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.14000000000000012,
          "wait": 0.7989999985657632,
          "receive": 0.3569999826140702,
          "_blocked_queueing": 33.12400000868365,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16111",
        "_initiator": {
          "type": "parser",
          "url": "http://localhost:4200/login",
          "lineNumber": 13
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/chunk-K7W62EAA.js",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "If-None-Match",
              "value": "W/\"1be9-U+kAtrq9M9ah2IWk9BMUlrK93bw\""
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/login"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 640,
          "bodySize": 0
        },
        "response": {
          "status": 304,
          "statusText": "Not Modified",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 13496,
            "mimeType": "text/javascript",
            "text": "import { injectQuery as __vite__injectQuery } from \"/@vite/client\";import { createHotContext as __vite__createHotContext } from \"/@vite/client\";import.meta.hot = __vite__createHotContext(\"/chunk-K7W62EAA.js\");import {\n  AuthService\n} from \"/chunk-KOJ36IQF.js\";\n\n// src/app/pages/login/login.component.ts\nimport { Component, inject } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nimport { ActivatedRoute } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_router.js?v=a3ec8c6b\";\nimport * as i0 from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nvar LoginComponent = class _LoginComponent {\n  authService = inject(AuthService);\n  route = inject(ActivatedRoute);\n  login() {\n    const returnUrl = this.route.snapshot.queryParams[\"returnUrl\"];\n    this.authService.googleLogin(returnUrl);\n  }\n  static \\u0275fac = function LoginComponent_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _LoginComponent)();\n  };\n  static \\u0275cmp = /* @__PURE__ */ i0.\\u0275\\u0275defineComponent({ type: _LoginComponent, selectors: [[\"app-login\"]], decls: 19, vars: 0, consts: [[1, \"min-h-screen\", \"bg-gray-900\", \"flex\", \"items-center\", \"justify-center\", \"px-4\"], [1, \"max-w-md\", \"w-full\"], [1, \"text-center\", \"mb-8\"], [1, \"text-4xl\", \"font-bold\", \"text-white\", \"mb-2\"], [1, \"text-gray-400\"], [1, \"bg-gray-800\", \"rounded-xl\", \"p-8\", \"border\", \"border-gray-700\", \"shadow-xl\"], [1, \"text-xl\", \"font-semibold\", \"text-white\", \"text-center\", \"mb-6\"], [1, \"w-full\", \"flex\", \"items-center\", \"justify-center\", \"gap-3\", \"bg-white\", \"hover:bg-gray-100\", \"text-gray-800\", \"font-medium\", \"py-3\", \"px-4\", \"rounded-lg\", \"transition-colors\", 3, \"click\"], [\"viewBox\", \"0 0 24 24\", 1, \"w-5\", \"h-5\"], [\"fill\", \"#4285F4\", \"d\", \"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"], [\"fill\", \"#34A853\", \"d\", \"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"], [\"fill\", \"#FBBC05\", \"d\", \"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"], [\"fill\", \"#EA4335\", \"d\", \"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"], [1, \"text-gray-500\", \"text-sm\", \"text-center\", \"mt-6\"]], template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.\\u0275\\u0275domElementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h1\", 3);\n      i0.\\u0275\\u0275text(4, \"Scaffold\");\n      i0.\\u0275\\u0275domElementEnd();\n      i0.\\u0275\\u0275domElementStart(5, \"p\", 4);\n      i0.\\u0275\\u0275text(6, \"G\\xE9n\\xE9rateur de tickets agile propuls\\xE9 par IA\");\n      i0.\\u0275\\u0275domElementEnd()();\n      i0.\\u0275\\u0275domElementStart(7, \"div\", 5)(8, \"h2\", 6);\n      i0.\\u0275\\u0275text(9, \" Connectez-vous pour continuer \");\n      i0.\\u0275\\u0275domElementEnd();\n      i0.\\u0275\\u0275domElementStart(10, \"button\", 7);\n      i0.\\u0275\\u0275domListener(\"click\", function LoginComponent_Template_button_click_10_listener() {\n        return ctx.login();\n      });\n      i0.\\u0275\\u0275namespaceSVG();\n      i0.\\u0275\\u0275domElementStart(11, \"svg\", 8);\n      i0.\\u0275\\u0275domElement(12, \"path\", 9)(13, \"path\", 10)(14, \"path\", 11)(15, \"path\", 12);\n      i0.\\u0275\\u0275domElementEnd();\n      i0.\\u0275\\u0275text(16, \" Continuer avec Google \");\n      i0.\\u0275\\u0275domElementEnd();\n      i0.\\u0275\\u0275namespaceHTML();\n      i0.\\u0275\\u0275domElementStart(17, \"p\", 13);\n      i0.\\u0275\\u0275text(18, \" En vous connectant, vous acceptez nos conditions d'utilisation \");\n      i0.\\u0275\\u0275domElementEnd()()()();\n    }\n  }, encapsulation: 2 });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\\u0275setClassMetadata(LoginComponent, [{\n    type: Component,\n    args: [{\n      selector: \"app-login\",\n      standalone: true,\n      template: `\n    <div class=\"min-h-screen bg-gray-900 flex items-center justify-center px-4\">\n      <div class=\"max-w-md w-full\">\n        <!-- Logo / Titre -->\n        <div class=\"text-center mb-8\">\n          <h1 class=\"text-4xl font-bold text-white mb-2\">Scaffold</h1>\n          <p class=\"text-gray-400\">G\\xE9n\\xE9rateur de tickets agile propuls\\xE9 par IA</p>\n        </div>\n\n        <!-- Card de connexion -->\n        <div class=\"bg-gray-800 rounded-xl p-8 border border-gray-700 shadow-xl\">\n          <h2 class=\"text-xl font-semibold text-white text-center mb-6\">\n            Connectez-vous pour continuer\n          </h2>\n\n          <!-- Bouton Google -->\n          <button\n            (click)=\"login()\"\n            class=\"w-full flex items-center justify-center gap-3 bg-white hover:bg-gray-100 text-gray-800 font-medium py-3 px-4 rounded-lg transition-colors\"\n          >\n            <svg class=\"w-5 h-5\" viewBox=\"0 0 24 24\">\n              <path\n                fill=\"#4285F4\"\n                d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n              />\n              <path\n                fill=\"#34A853\"\n                d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n              />\n              <path\n                fill=\"#FBBC05\"\n                d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n              />\n              <path\n                fill=\"#EA4335\"\n                d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n              />\n            </svg>\n            Continuer avec Google\n          </button>\n\n          <p class=\"text-gray-500 text-sm text-center mt-6\">\n            En vous connectant, vous acceptez nos conditions d'utilisation\n          </p>\n        </div>\n      </div>\n    </div>\n  `\n    }]\n  }], null, null);\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\\u0275setClassDebugInfo(LoginComponent, { className: \"LoginComponent\", filePath: \"src/app/pages/login/login.component.ts\", lineNumber: 57 });\n})();\n(() => {\n  const id = \"src%2Fapp%2Fpages%2Flogin%2Flogin.component.ts%40LoginComponent\";\n  function LoginComponent_HmrLoad(t) {\n    import(\n      /* @vite-ignore */\n      __vite__injectQuery(i0.\\u0275\\u0275getReplaceMetadataURL(id, t, import.meta.url), 'import')\n    ).then((m) => m.default && i0.\\u0275\\u0275replaceMetadata(LoginComponent, m.default, [i0], [Component], import.meta, id));\n  }\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && LoginComponent_HmrLoad(Date.now());\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && (import.meta.hot && import.meta.hot.on(\"angular:component-update\", (d) => d.id === id && LoginComponent_HmrLoad(d.timestamp)));\n})();\nexport {\n  LoginComponent\n};\n\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbG9naW4vbG9naW4uY29tcG9uZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgaW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBBdXRoU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2F1dGgnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhcHAtbG9naW4nLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXYgY2xhc3M9XCJtaW4taC1zY3JlZW4gYmctZ3JheS05MDAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcHgtNFwiPlxuICAgICAgPGRpdiBjbGFzcz1cIm1heC13LW1kIHctZnVsbFwiPlxuICAgICAgICA8IS0tIExvZ28gLyBUaXRyZSAtLT5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRleHQtY2VudGVyIG1iLThcIj5cbiAgICAgICAgICA8aDEgY2xhc3M9XCJ0ZXh0LTR4bCBmb250LWJvbGQgdGV4dC13aGl0ZSBtYi0yXCI+U2NhZmZvbGQ8L2gxPlxuICAgICAgICAgIDxwIGNsYXNzPVwidGV4dC1ncmF5LTQwMFwiPkfDqW7DqXJhdGV1ciBkZSB0aWNrZXRzIGFnaWxlIHByb3B1bHPDqSBwYXIgSUE8L3A+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDwhLS0gQ2FyZCBkZSBjb25uZXhpb24gLS0+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJiZy1ncmF5LTgwMCByb3VuZGVkLXhsIHAtOCBib3JkZXIgYm9yZGVyLWdyYXktNzAwIHNoYWRvdy14bFwiPlxuICAgICAgICAgIDxoMiBjbGFzcz1cInRleHQteGwgZm9udC1zZW1pYm9sZCB0ZXh0LXdoaXRlIHRleHQtY2VudGVyIG1iLTZcIj5cbiAgICAgICAgICAgIENvbm5lY3Rlei12b3VzIHBvdXIgY29udGludWVyXG4gICAgICAgICAgPC9oMj5cblxuICAgICAgICAgIDwhLS0gQm91dG9uIEdvb2dsZSAtLT5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAoY2xpY2spPVwibG9naW4oKVwiXG4gICAgICAgICAgICBjbGFzcz1cInctZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBnYXAtMyBiZy13aGl0ZSBob3ZlcjpiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwIGZvbnQtbWVkaXVtIHB5LTMgcHgtNCByb3VuZGVkLWxnIHRyYW5zaXRpb24tY29sb3JzXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8c3ZnIGNsYXNzPVwidy01IGgtNVwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cbiAgICAgICAgICAgICAgPHBhdGhcbiAgICAgICAgICAgICAgICBmaWxsPVwiIzQyODVGNFwiXG4gICAgICAgICAgICAgICAgZD1cIk0yMi41NiAxMi4yNWMwLS43OC0uMDctMS41My0uMi0yLjI1SDEydjQuMjZoNS45MmMtLjI2IDEuMzctMS4wNCAyLjUzLTIuMjEgMy4zMXYyLjc3aDMuNTdjMi4wOC0xLjkyIDMuMjgtNC43NCAzLjI4LTguMDl6XCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPHBhdGhcbiAgICAgICAgICAgICAgICBmaWxsPVwiIzM0QTg1M1wiXG4gICAgICAgICAgICAgICAgZD1cIk0xMiAyM2MyLjk3IDAgNS40Ni0uOTggNy4yOC0yLjY2bC0zLjU3LTIuNzdjLS45OC42Ni0yLjIzIDEuMDYtMy43MSAxLjA2LTIuODYgMC01LjI5LTEuOTMtNi4xNi00LjUzSDIuMTh2Mi44NEMzLjk5IDIwLjUzIDcuNyAyMyAxMiAyM3pcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8cGF0aFxuICAgICAgICAgICAgICAgIGZpbGw9XCIjRkJCQzA1XCJcbiAgICAgICAgICAgICAgICBkPVwiTTUuODQgMTQuMDljLS4yMi0uNjYtLjM1LTEuMzYtLjM1LTIuMDlzLjEzLTEuNDMuMzUtMi4wOVY3LjA3SDIuMThDMS40MyA4LjU1IDEgMTAuMjIgMSAxMnMuNDMgMy40NSAxLjE4IDQuOTNsMi44NS0yLjIyLjgxLS42MnpcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8cGF0aFxuICAgICAgICAgICAgICAgIGZpbGw9XCIjRUE0MzM1XCJcbiAgICAgICAgICAgICAgICBkPVwiTTEyIDUuMzhjMS42MiAwIDMuMDYuNTYgNC4yMSAxLjY0bDMuMTUtMy4xNUMxNy40NSAyLjA5IDE0Ljk3IDEgMTIgMSA3LjcgMSAzLjk5IDMuNDcgMi4xOCA3LjA3bDMuNjYgMi44NGMuODctMi42IDMuMy00LjUzIDYuMTYtNC41M3pcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICBDb250aW51ZXIgYXZlYyBHb29nbGVcbiAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgIDxwIGNsYXNzPVwidGV4dC1ncmF5LTUwMCB0ZXh0LXNtIHRleHQtY2VudGVyIG10LTZcIj5cbiAgICAgICAgICAgIEVuIHZvdXMgY29ubmVjdGFudCwgdm91cyBhY2NlcHRleiBub3MgY29uZGl0aW9ucyBkJ3V0aWxpc2F0aW9uXG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICBgLFxufSlcbmV4cG9ydCBjbGFzcyBMb2dpbkNvbXBvbmVudCB7XG4gIHByaXZhdGUgYXV0aFNlcnZpY2UgPSBpbmplY3QoQXV0aFNlcnZpY2UpO1xuICBwcml2YXRlIHJvdXRlID0gaW5qZWN0KEFjdGl2YXRlZFJvdXRlKTtcblxuICBsb2dpbigpOiB2b2lkIHtcbiAgICBjb25zdCByZXR1cm5VcmwgPSB0aGlzLnJvdXRlLnNuYXBzaG90LnF1ZXJ5UGFyYW1zWydyZXR1cm5VcmwnXTtcbiAgICB0aGlzLmF1dGhTZXJ2aWNlLmdvb2dsZUxvZ2luKHJl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"
          },
          "redirectURL": "",
          "headersSize": 179,
          "bodySize": 0,
          "_transferSize": 179,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.161Z",
        "time": 37.08899998005108,
        "timings": {
          "blocked": 34.529999979756774,
          "dns": 0.009000000000000119,
          "ssl": -1,
          "connect": 1.36,
          "send": 0.40700000000000003,
          "wait": 0.4999999990761279,
          "receive": 0.2830000012181699,
          "_blocked_queueing": 33.18899997975677,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16111",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/@vite/client",
          "lineNumber": 0
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/node_modules/vite/dist/client/env.mjs",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "If-None-Match",
              "value": "W/\"25b-V2bmMiQli1AsiiEb1NEXbTMk57g\""
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/@vite/client"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 713,
          "bodySize": 0
        },
        "response": {
          "status": 304,
          "statusText": "Not Modified",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 3478,
            "mimeType": "text/javascript",
            "text": "//#region src/client/env.ts\nconst context = (() => {\n\tif (typeof globalThis !== \"undefined\") return globalThis;\n\telse if (typeof self !== \"undefined\") return self;\n\telse if (typeof window !== \"undefined\") return window;\n\telse return Function(\"return this\")();\n})();\nconst defines = {};\nObject.keys(defines).forEach((key) => {\n\tconst segments = key.split(\".\");\n\tlet target = context;\n\tfor (let i = 0; i < segments.length; i++) {\n\t\tconst segment = segments[i];\n\t\tif (i === segments.length - 1) target[segment] = defines[key];\n\t\telse target = target[segment] || (target[segment] = {});\n\t}\n});\n\n//#endregion\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVudi5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8jcmVnaW9uIHNyYy9jbGllbnQvZW52LnRzXG5jb25zdCBjb250ZXh0ID0gKCgpID0+IHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzICE9PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0ZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpIHJldHVybiBzZWxmO1xuXHRlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gd2luZG93O1xuXHRlbHNlIHJldHVybiBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG59KSgpO1xuY29uc3QgZGVmaW5lcyA9IHt9O1xuT2JqZWN0LmtleXMoZGVmaW5lcykuZm9yRWFjaCgoa2V5KSA9PiB7XG5cdGNvbnN0IHNlZ21lbnRzID0ga2V5LnNwbGl0KFwiLlwiKTtcblx0bGV0IHRhcmdldCA9IGNvbnRleHQ7XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgc2VnbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRjb25zdCBzZWdtZW50ID0gc2VnbWVudHNbaV07XG5cdFx0aWYgKGkgPT09IHNlZ21lbnRzLmxlbmd0aCAtIDEpIHRhcmdldFtzZWdtZW50XSA9IGRlZmluZXNba2V5XTtcblx0XHRlbHNlIHRhcmdldCA9IHRhcmdldFtzZWdtZW50XSB8fCAodGFyZ2V0W3NlZ21lbnRdID0ge30pO1xuXHR9XG59KTtcblxuLy8jZW5kcmVnaW9uIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztBQUN6QixLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3ZCLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBVTtBQUN6RCxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJO0FBQ2xELENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU07QUFDdEQsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdEMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNKLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNsQixNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3RDLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2hDLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsT0FBTztBQUNyQixDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMzQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUM3QixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO0FBQy9ELENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pELENBQUM7QUFDRCxDQUFDLENBQUM7O0FBRUYsQ0FBQyxDQUFDLENBQUMifQ=="
          },
          "redirectURL": "",
          "headersSize": 179,
          "bodySize": 0,
          "_transferSize": 179,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.208Z",
        "time": 1.9450000254437327,
        "timings": {
          "blocked": 0.8370000472590327,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.13100000000000006,
          "wait": 0.664999988976866,
          "receive": 0.311999989207834,
          "_blocked_queueing": 0.4190000472590327,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16111",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/main.js",
          "lineNumber": 3
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/chunk-KOJ36IQF.js",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "If-None-Match",
              "value": "W/\"1441-uLRyeNVGQkq1I4K1fd0VHHu/4o0\""
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [],
          "cookies": [],
          "headersSize": 642,
          "bodySize": 0
        },
        "response": {
          "status": 304,
          "statusText": "Not Modified",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 13580,
            "mimeType": "text/javascript",
            "text": "var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b ||= {})\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\n\n// src/app/services/auth.ts\nimport { isPlatformBrowser } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common.js?v=a3ec8c6b\";\nimport { HttpClient } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common_http.js?v=a3ec8c6b\";\nimport { inject, Injectable, PLATFORM_ID, signal } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nimport { Router } from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_router.js?v=a3ec8c6b\";\n\n// src/environments/environment.development.ts\nvar environment = {\n  apiUrl: \"http://localhost:3333\",\n  apiBaseUrl: \"http://localhost:3333/api\"\n};\n\n// src/app/services/auth.ts\nimport * as i0 from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b\";\nvar AuthService = class _AuthService {\n  TOKEN_KEY = \"auth_token\";\n  RETURN_URL_KEY = \"return_url\";\n  platformId = inject(PLATFORM_ID);\n  http = inject(HttpClient);\n  router = inject(Router);\n  user = signal(null, ...ngDevMode ? [{ debugName: \"user\" }] : []);\n  constructor() {\n    if (this.isBrowser() && this.getToken()) {\n      this.loadUser();\n    }\n  }\n  isBrowser() {\n    return isPlatformBrowser(this.platformId);\n  }\n  isBrowserCheck = () => isPlatformBrowser(this.platformId);\n  /**\n   * Redirige vers Google OAuth\n   */\n  googleLogin(returnUrl) {\n    if (this.isBrowser()) {\n      if (returnUrl) {\n        localStorage.setItem(this.RETURN_URL_KEY, returnUrl);\n      }\n      window.location.href = `${environment.apiUrl}/auth/google`;\n    }\n  }\n  /**\n   * Gre le callback aprs authentification Google\n   */\n  handleCallback(token, returnUrl = \"/\") {\n    this.saveToken(token);\n    this.http.get(`${environment.apiUrl}/api/auth/me`).subscribe({\n      next: (user) => {\n        this.user.set(user);\n        this.router.navigate([returnUrl]);\n      },\n      error: () => {\n        this.clearToken();\n        this.user.set(null);\n        this.router.navigate([\"/login\"]);\n      }\n    });\n  }\n  /**\n   * Charge les infos utilisateur depuis l'API\n   */\n  loadUser() {\n    if (!this.isBrowser() || !this.getToken()) {\n      return;\n    }\n    this.http.get(`${environment.apiUrl}/api/auth/me`).subscribe({\n      next: (user) => this.user.set(user),\n      error: () => {\n        this.clearToken();\n        this.user.set(null);\n      }\n    });\n  }\n  /**\n   * Dconnexion\n   */\n  logout() {\n    this.http.post(`${environment.apiUrl}/api/auth/logout`, {}).subscribe({\n      next: () => {\n        this.clearToken();\n        this.user.set(null);\n        this.router.navigate([\"/login\"]);\n      },\n      error: () => {\n        this.clearToken();\n        this.user.set(null);\n        this.router.navigate([\"/login\"]);\n      }\n    });\n  }\n  /**\n   * Rcupre le token du localStorage\n   */\n  getToken() {\n    if (!this.isBrowser())\n      return null;\n    return localStorage.getItem(this.TOKEN_KEY);\n  }\n  /**\n   * Sauvegarde le token dans localStorage\n   */\n  saveToken(token) {\n    if (this.isBrowser()) {\n      localStorage.setItem(this.TOKEN_KEY, token);\n    }\n  }\n  /**\n   * Supprime le token du localStorage\n   */\n  clearToken() {\n    if (this.isBrowser()) {\n      localStorage.removeItem(this.TOKEN_KEY);\n    }\n  }\n  /**\n   * Vrifie si l'utilisateur est connect\n   */\n  isAuthenticated() {\n    return !!this.getToken();\n  }\n  /**\n   * Rcupre et nettoie l'URL de retour stocke\n   */\n  getAndClearReturnUrl() {\n    if (!this.isBrowser())\n      return null;\n    const url = localStorage.getItem(this.RETURN_URL_KEY);\n    localStorage.removeItem(this.RETURN_URL_KEY);\n    return url;\n  }\n  static \\u0275fac = function AuthService_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _AuthService)();\n  };\n  static \\u0275prov = /* @__PURE__ */ i0.\\u0275\\u0275defineInjectable({ token: _AuthService, factory: _AuthService.\\u0275fac, providedIn: \"root\" });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.\\u0275setClassMetadata(AuthService, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [], null);\n})();\n\nexport {\n  __spreadValues,\n  __spreadProps,\n  environment,\n  AuthService\n};\n\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc2VydmljZXMvYXV0aC50cyIsInNyYy9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQuZGV2ZWxvcG1lbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBpbmplY3QsIEluamVjdGFibGUsIFBMQVRGT1JNX0lELCBzaWduYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQuZGV2ZWxvcG1lbnQnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVc2VyIHtcclxuICBpZDogbnVtYmVyO1xyXG4gIGZ1bGxOYW1lOiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxuICBhdmF0YXI6IHN0cmluZztcclxufVxyXG5cclxuQEluamVjdGFibGUoe1xyXG4gIHByb3ZpZGVkSW46ICdyb290JyxcclxufSlcclxuZXhwb3J0IGNsYXNzIEF1dGhTZXJ2aWNlIHtcclxuICBwcml2YXRlIHJlYWRvbmx5IFRPS0VOX0tFWSA9ICdhdXRoX3Rva2VuJztcclxuICBwcml2YXRlIHJlYWRvbmx5IFJFVFVSTl9VUkxfS0VZID0gJ3JldHVybl91cmwnO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcGxhdGZvcm1JZCA9IGluamVjdChQTEFURk9STV9JRCk7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBodHRwID0gaW5qZWN0KEh0dHBDbGllbnQpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcm91dGVyID0gaW5qZWN0KFJvdXRlcik7XHJcblxyXG4gIHVzZXIgPSBzaWduYWw8VXNlciB8IG51bGw+KG51bGwpO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIC8vIENoYXJnZSBsJ3V0aWxpc2F0ZXVyIGF1IGTDqW1hcnJhZ2Ugc2kgdW4gdG9rZW4gZXhpc3RlIChjw7R0w6kgYnJvd3NlciB1bmlxdWVtZW50KVxyXG4gICAgaWYgKHRoaXMuaXNCcm93c2VyKCkgJiYgdGhpcy5nZXRUb2tlbigpKSB7XHJcbiAgICAgIHRoaXMubG9hZFVzZXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgaXNCcm93c2VyKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGlzQnJvd3NlckNoZWNrID0gKCkgPT4gaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZGlyaWdlIHZlcnMgR29vZ2xlIE9BdXRoXHJcbiAgICovXHJcbiAgZ29vZ2xlTG9naW4ocmV0dXJuVXJsPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5pc0Jyb3dzZXIoKSkge1xyXG4gICAgICBpZiAocmV0dXJuVXJsKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5SRVRVUk5fVVJMX0tFWSwgcmV0dXJuVXJsKTtcclxuICAgICAgfVxyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGAke2Vudmlyb25tZW50LmFwaVVybH0vYXV0aC9nb29nbGVgO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR8OocmUgbGUgY2FsbGJhY2sgYXByw6hzIGF1dGhlbnRpZmljYXRpb24gR29vZ2xlXHJcbiAgICovXHJcbiAgaGFuZGxlQ2FsbGJhY2sodG9rZW46IHN0cmluZywgcmV0dXJuVXJsOiBzdHJpbmcgPSAnLycpOiB2b2lkIHtcclxuICAgIHRoaXMuc2F2ZVRva2VuKHRva2VuKTtcclxuICAgIC8vIENoYXJnZXIgbGUgdXNlciBwdWlzIHJlZGlyaWdlclxyXG4gICAgdGhpcy5odHRwLmdldDxVc2VyPihgJHtlbnZpcm9ubWVudC5hcGlVcmx9L2FwaS9hdXRoL21lYCkuc3Vic2NyaWJlKHtcclxuICAgICAgbmV4dDogKHVzZXIpID0+IHtcclxuICAgICAgICB0aGlzLnVzZXIuc2V0KHVzZXIpO1xyXG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtyZXR1cm5VcmxdKTtcclxuICAgICAgfSxcclxuICAgICAgZXJyb3I6ICgpID0+IHtcclxuICAgICAgICB0aGlzLmNsZWFyVG9rZW4oKTtcclxuICAgICAgICB0aGlzLnVzZXIuc2V0KG51bGwpO1xyXG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnL2xvZ2luJ10pO1xyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGFyZ2UgbGVzIGluZm9zIHV0aWxpc2F0ZXVyIGRlcHVpcyBsJ0FQSVxyXG4gICAqL1xyXG4gIGxvYWRVc2VyKCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmlzQnJvd3NlcigpIHx8ICF0aGlzLmdldFRva2VuKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5odHRwLmdldDxVc2VyPihgJHtlbnZpcm9ubWVudC5hcGlVcmx9L2FwaS9hdXRoL21lYCkuc3Vic2NyaWJlKHtcclxuICAgICAgbmV4dDogKHVzZXIpID0+IHRoaXMudXNlci5zZXQodXNlciksXHJcbiAgICAgIGVycm9yOiAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbGVhclRva2VuKCk7XHJcbiAgICAgICAgdGhpcy51c2VyLnNldChudWxsKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRMOpY29ubmV4aW9uXHJcbiAgICovXHJcbiAgbG9nb3V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5odHRwLnBvc3QoYCR7ZW52aXJvbm1lbnQuYXBpVXJsfS9hcGkvYXV0aC9sb2dvdXRgLCB7fSkuc3Vic2NyaWJlKHtcclxuICAgICAgbmV4dDogKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xlYXJUb2tlbigpO1xyXG4gICAgICAgIHRoaXMudXNlci5zZXQobnVsbCk7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycvbG9naW4nXSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGVycm9yOiAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbGVhclRva2VuKCk7XHJcbiAgICAgICAgdGhpcy51c2VyLnNldChudWxsKTtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy9sb2dpbiddKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUsOpY3Vww6hyZSBsZSB0b2tlbiBkdSBsb2NhbFN0b3JhZ2VcclxuICAgKi9cclxuICBnZXRUb2tlbigpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGlmICghdGhpcy5pc0Jyb3dzZXIoKSkgcmV0dXJuIG51bGw7XHJcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5UT0tFTl9LRVkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2F1dmVnYXJkZSBsZSB0b2tlbiBkYW5zIGxvY2FsU3RvcmFnZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2F2ZVRva2VuKHRva2VuOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmlzQnJvd3NlcigpKSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuVE9LRU5fS0VZLCB0b2tlbik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdXBwcmltZSBsZSB0b2tlbiBkdSBsb2NhbFN0b3JhZ2VcclxuICAgKi9cclxuICBwcml2YXRlIGNsZWFyVG9rZW4oKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5pc0Jyb3dzZXIoKSkge1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLlRPS0VOX0tFWSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWw6lyaWZpZSBzaSBsJ3V0aWxpc2F0ZXVyIGVzdCBjb25uZWN0w6lcclxuICAgKi9cclxuICBpc0F1dGhlbnRpY2F0ZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gISF0aGlzLmdldFRva2VuKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSw6ljdXDDqHJlIGV0IG5ldHRvaWUgbCdVUkwgZGUgcmV0b3VyIHN0b2Nrw6llXHJcbiAgICovXHJcbiAgZ2V0QW5kQ2xlYXJSZXR1cm5VcmwoKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBpZiAoIXRoaXMuaXNCcm93c2VyKCkpIHJldHVybiBudWxsO1xyXG4gICAgY29uc3QgdXJsID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5SRVRVUk5fVVJMX0tFWSk7XHJcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLlJFVFVSTl9VUkxfS0VZKTtcclxuICAgIHJldHVybiB1cmw7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBlbnZpcm9ubWVudCA9IHtcbiAgICBhcGlVcmw6ICdodHRwOi8vbG9jYWxob3N0OjMzMzMnLFxuICAgIGFwaUJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0OjMzMzMvYXBpJyxcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLFNBQVMseUJBQXlCO0FBQ2xDLFNBQVMsa0JBQWtCO0FBQzNCLFNBQVMsUUFBUSxZQUFZLGFBQWEsY0FBYztBQUN4RCxTQUFTLGNBQWM7OztBQ0hoQixJQUFNLGNBQWM7RUFDdkIsUUFBUTtFQUNSLFlBQVk7Ozs7O0FEY1YsSUFBTyxjQUFQLE1BQU8sYUFBVztFQUNMLFlBQVk7RUFDWixpQkFBaUI7RUFDakIsYUFBYSxPQUFPLFdBQVc7RUFDL0IsT0FBTyxPQUFPLFVB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"
          },
          "redirectURL": "",
          "headersSize": 179,
          "bodySize": 0,
          "_transferSize": 179,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.210Z",
        "time": 2.5449999957345426,
        "timings": {
          "blocked": 1.2809999967068433,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.14600000000000002,
          "wait": 0.8789999836012721,
          "receive": 0.23900001542642713,
          "_blocked_queueing": 0.7639999967068434,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/main.js",
          "lineNumber": 6
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "9923"
            },
            {
              "name": "Etag",
              "value": "W/\"934-Jk4R+x6lq4i8RI7rv5a7Pic0t6k\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 9923,
            "mimeType": "text/javascript",
            "text": "import {\n  BrowserDomAdapter,\n  BrowserGetTestability,\n  BrowserModule,\n  By,\n  DomEventsPlugin,\n  DomRendererFactory2,\n  DomSanitizer,\n  DomSanitizerImpl,\n  EVENT_MANAGER_PLUGINS,\n  EventManager,\n  EventManagerPlugin,\n  HAMMER_GESTURE_CONFIG,\n  HAMMER_LOADER,\n  HammerGestureConfig,\n  HammerGesturesPlugin,\n  HammerModule,\n  HydrationFeatureKind,\n  KeyEventsPlugin,\n  Meta,\n  REMOVE_STYLES_ON_COMPONENT_DESTROY,\n  SharedStylesHost,\n  Title,\n  VERSION,\n  bootstrapApplication,\n  createApplication,\n  disableDebugTools,\n  enableDebugTools,\n  platformBrowser,\n  provideClientHydration,\n  provideProtractorTestingSupport,\n  withEventReplay,\n  withHttpTransferCacheOptions,\n  withI18nSupport,\n  withIncrementalHydration,\n  withNoHttpTransferCache\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-SXEFOV7B.js?v=a3ec8c6b\";\nimport \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-CGVE6HH2.js?v=a3ec8c6b\";\nimport \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-43XS5UPA.js?v=a3ec8c6b\";\nimport {\n  getDOM\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\nexport {\n  BrowserModule,\n  By,\n  DomSanitizer,\n  EVENT_MANAGER_PLUGINS,\n  EventManager,\n  EventManagerPlugin,\n  HAMMER_GESTURE_CONFIG,\n  HAMMER_LOADER,\n  HammerGestureConfig,\n  HammerModule,\n  HydrationFeatureKind,\n  Meta,\n  REMOVE_STYLES_ON_COMPONENT_DESTROY,\n  Title,\n  VERSION,\n  bootstrapApplication,\n  createApplication,\n  disableDebugTools,\n  enableDebugTools,\n  platformBrowser,\n  provideClientHydration,\n  provideProtractorTestingSupport,\n  withEventReplay,\n  withHttpTransferCacheOptions,\n  withI18nSupport,\n  withIncrementalHydration,\n  withNoHttpTransferCache,\n  BrowserDomAdapter as BrowserDomAdapter,\n  BrowserGetTestability as BrowserGetTestability,\n  DomEventsPlugin as DomEventsPlugin,\n  DomRendererFactory2 as DomRendererFactory2,\n  DomSanitizerImpl as DomSanitizerImpl,\n  HammerGesturesPlugin as HammerGesturesPlugin,\n  KeyEventsPlugin as KeyEventsPlugin,\n  SharedStylesHost as SharedStylesHost,\n  getDOM as getDOM\n};\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkBhbmd1bGFyX3BsYXRmb3JtLWJyb3dzZXIuanM/dj1hM2VjOGM2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBCcm93c2VyRG9tQWRhcHRlcixcbiAgQnJvd3NlckdldFRlc3RhYmlsaXR5LFxuICBCcm93c2VyTW9kdWxlLFxuICBCeSxcbiAgRG9tRXZlbnRzUGx1Z2luLFxuICBEb21SZW5kZXJlckZhY3RvcnkyLFxuICBEb21TYW5pdGl6ZXIsXG4gIERvbVNhbml0aXplckltcGwsXG4gIEVWRU5UX01BTkFHRVJfUExVR0lOUyxcbiAgRXZlbnRNYW5hZ2VyLFxuICBFdmVudE1hbmFnZXJQbHVnaW4sXG4gIEhBTU1FUl9HRVNUVVJFX0NPTkZJRyxcbiAgSEFNTUVSX0xPQURFUixcbiAgSGFtbWVyR2VzdHVyZUNvbmZpZyxcbiAgSGFtbWVyR2VzdHVyZXNQbHVnaW4sXG4gIEhhbW1lck1vZHVsZSxcbiAgSHlkcmF0aW9uRmVhdHVyZUtpbmQsXG4gIEtleUV2ZW50c1BsdWdpbixcbiAgTWV0YSxcbiAgUkVNT1ZFX1NUWUxFU19PTl9DT01QT05FTlRfREVTVFJPWSxcbiAgU2hhcmVkU3R5bGVzSG9zdCxcbiAgVGl0bGUsXG4gIFZFUlNJT04sXG4gIGJvb3RzdHJhcEFwcGxpY2F0aW9uLFxuICBjcmVhdGVBcHBsaWNhdGlvbixcbiAgZGlzYWJsZURlYnVnVG9vbHMsXG4gIGVuYWJsZURlYnVnVG9vbHMsXG4gIHBsYXRmb3JtQnJvd3NlcixcbiAgcHJvdmlkZUNsaWVudEh5ZHJhdGlvbixcbiAgcHJvdmlkZVByb3RyYWN0b3JUZXN0aW5nU3VwcG9ydCxcbiAgd2l0aEV2ZW50UmVwbGF5LFxuICB3aXRoSHR0cFRyYW5zZmVyQ2FjaGVPcHRpb25zLFxuICB3aXRoSTE4blN1cHBvcnQsXG4gIHdpdGhJbmNyZW1lbnRhbEh5ZHJhdGlvbixcbiAgd2l0aE5vSHR0cFRyYW5zZmVyQ2FjaGVcbn0gZnJvbSBcIi9AZnMvQzovVXNlcnMvbW91cmEvRG9jdW1lbnRzL1NjYWZmb2xkL2Zyb250ZW5kLy5hbmd1bGFyL2NhY2hlLzIxLjEuMy9mcm9udGVuZC92aXRlL2RlcHMvY2h1bmstU1hFRk9WN0IuanM/dj1hM2VjOGM2YlwiO1xuaW1wb3J0IFwiL0Bmcy9DOi9Vc2Vycy9tb3VyYS9Eb2N1bWVudHMvU2NhZmZvbGQvZnJvbnRlbmQvLmFuZ3VsYXIvY2FjaGUvMjEuMS4zL2Zyb250ZW5kL3ZpdGUvZGVwcy9jaHVuay1DR1ZFNkhIMi5qcz92PWEzZWM4YzZiXCI7XG5pbXBvcnQgXCIvQGZzL0M6L1VzZXJzL21vdXJhL0RvY3VtZW50cy9TY2FmZm9sZC9mcm9udGVuZC8uYW5ndWxhci9jYWNoZS8yMS4xLjMvZnJvbnRlbmQvdml0ZS9kZXBzL2NodW5rLTQzWFM1VVBBLmpzP3Y9YTNlYzhjNmJcIjtcbmltcG9ydCB7XG4gIGdldERPTVxufSBmcm9tIFwiL0Bmcy9DOi9Vc2Vycy9tb3VyYS9Eb2N1bWVudHMvU2NhZmZvbGQvZnJvbnRlbmQvLmFuZ3VsYXIvY2FjaGUvMjEuMS4zL2Zyb250ZW5kL3ZpdGUvZGVwcy9jaHVuay1BQVg3TDZGWC5qcz92PWEzZWM4YzZiXCI7XG5pbXBvcnQgXCIvQGZzL0M6L1VzZXJzL21vdXJhL0RvY3VtZW50cy9TY2FmZm9sZC9mcm9udGVuZC8uYW5ndWxhci9jYWNoZS8yMS4xLjMvZnJvbnRlbmQvdml0ZS9kZXBzL2NodW5rLUxFSFJaN0lLLmpzP3Y9YTNlYzhjNmJcIjtcbmV4cG9ydCB7XG4gIEJyb3dzZXJNb2R1bGUsXG4gIEJ5LFxuICBEb21TYW5pdGl6ZXIsXG4gIEVWRU5UX01BTkFHRVJfUExVR0lOUyxcbiAgRXZlbnRNYW5hZ2VyLFxuICBFdmVudE1hbmFnZXJQbHVnaW4sXG4gIEhBTU1FUl9HRVNUVVJFX0NPTkZJRyxcbiAgSEFNTUVSX0xPQURFUixcbiAgSGFtbWVyR2VzdHVyZUNvbmZpZyxcbiAgSGFtbWVyTW9kdWxlLFxuICBIeWRyYXRpb25GZWF0dXJlS2luZCxcbiAgTWV0YSxcbiAgUkVNT1ZFX1NUWUxFU19PTl9DT01QT05FTlRfREVTVFJPWSxcbiAgVGl0bGUsXG4gIFZFUlNJT04sXG4gIGJvb3RzdHJhcEFwcGxpY2F0aW9uLFxuICBjcmVhdGVBcHBsaWNhdGlvbixcbiAgZGlzYWJsZURlYnVnVG9vbHMsXG4gIGVuYWJsZURlYnVnVG9vbHMsXG4gIHBsYXRmb3JtQnJvd3NlcixcbiAgcHJvdmlkZUNsaWVudEh5ZHJhdGlvbixcbiAgcHJvdmlkZVByb3RyYWN0b3JUZXN0aW5nU3VwcG9ydCxcbiAgd2l0aEV2ZW50UmVwbGF5LFxuICB3aXRoSHR0cFRyYW5zZmVyQ2FjaGVPcHRpb25zLFxuICB3aXRoSTE4blN1cHBvcnQsXG4gIHdpdGhJbmNyZW1lbnRhbEh5ZHJhdGlvbixcbiAgd2l0aE5vSHR0cFRyYW5zZmVyQ2FjaGUsXG4gIEJyb3dzZXJEb21BZGFwdGVyIGFzIMm1QnJvd3NlckRvbUFkYXB0ZXIsXG4gIEJyb3dzZXJHZXRUZXN0YWJpbGl0eSBhcyDJtUJyb3dzZXJHZXRUZXN0YWJpbGl0eSxcbiAgRG9tRXZlbnRzUGx1Z2luIGFzIMm1RG9tRXZlbnRzUGx1Z2luLFxuICBEb21SZW5kZXJlckZhY3RvcnkyIGFzIMm1RG9tUmVuZGVyZXJGYWN0b3J5MixcbiAgRG9tU2FuaXRpemVySW1wbCBhcyDJtURvbVNhbml0aXplckltcGwsXG4gIEhhbW1lckdlc3R1cmVzUGx1Z2luIGFzIMm1SGFtbWVyR2VzdHVyZXNQbHVnaW4sXG4gIEtleUV2ZW50c1BsdWdpbiBhcyDJtUtleUV2ZW50c1BsdWdpbixcbiAgU2hhcmVkU3R5bGVzSG9zdCBhcyDJtVNoYXJlZFN0eWxlc0hvc3QsXG4gIGdldERPTSBhcyDJtWdldERPTVxufTtcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLENBQUM7QUFDUCxDQUFDLENBQUMsaUJBQWlCO0FBQ25CLENBQUMsQ0FBQyxxQkFBcUI7QUFDdkIsQ0FBQyxDQUFDLGFBQWE7QUFDZixDQUFDLENBQUMsRUFBRTtBQUNKLENBQUMsQ0FBQyxlQUFlO0FBQ2pCLENBQUMsQ0FBQyxtQkFBbUI7QUFDckIsQ0FBQyxDQUFDLFlBQVk7QUFDZCxDQUFDLENBQUMsZ0JBQWdCO0FBQ2xCLENBQUMsQ0FBQyxxQkFBcUI7QUFDdkIsQ0FBQyxDQUFDLFlBQVk7QUFDZCxDQUFDLENBQUMsa0JBQWtCO0FBQ3BCLENBQUMsQ0FBQyxxQkFBcUI7QUFDdkIsQ0FBQyxDQUFDLGFBQWE7QUFDZixDQUFDLENBQUMsbUJBQW1CO0FBQ3JCLENBQUMsQ0FBQyxvQkFBb0I7QUFDdEIsQ0FBQyxDQUFDLFlBQVk7QUFDZCxDQUFDLENBQUMsb0JBQW9CO0FBQ3RCLENBQUMsQ0FBQyxlQUFlO0FBQ2pCLENBQUMsQ0FBQyxJQUFJO0FBQ04sQ0FBQyxDQUFDLGtDQUFrQztBQUNwQyxDQUFDLENBQUMsZ0JBQWdCO0FBQ2xCLENBQUMsQ0FBQyxLQUFLO0FBQ1AsQ0FBQyxDQUFDLE9BQU87QUFDVCxDQUFDLENBQUMsb0JBQW9CO0FBQ3RCLENBQUMsQ0FBQyxpQkFBaUI7QUFDbkIsQ0FBQyxDQUFDLGlCQUFpQjtBQUNuQixDQUFDLENBQUMsZ0JBQWdCO0FBQ2xCLENBQUMsQ0FBQyxlQUFlO0FBQ2pCLENBQUMsQ0FBQyxzQkFBc0I7QUFDeEIsQ0FBQyxDQUFDLCtCQUErQjtBQUNqQyxDQUFDLENBQUMsZUFBZTtBQUNqQixDQUFDLENBQUMsNEJBQTRCO0FBQzlCLENBQUMsQ0FBQyxlQUFlO0FBQ2pCLENBQUMsQ0FBQyx3QkFBd0I7QUFDMUIsQ0FBQyxDQUFDO0FBQ0YsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztBQUM5SCxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDOUgsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQzlILE1BQU0sQ0FBQztBQUNQLENBQUMsQ0FBQztBQUNGLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDOUgsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQzlILE1BQU0sQ0FBQztBQUNQLENBQUMsQ0FBQyxhQUFhO0FBQ2YsQ0FBQyxDQUFDLEVBQUU7QUFDSixDQUFDLENBQUMsWUFBWTtBQUNkLENBQUMsQ0FBQyxxQkFBcUI7QUFDdkIsQ0FBQyxDQUFDLFlBQVk7QUFDZCxDQUFDLENBQUMsa0JBQWtCO0FBQ3BCLENBQUMsQ0FBQyxxQkFBcUI7QUFDdkIsQ0FBQyxDQUFDLGFBQWE7QUFDZixDQUFDLENBQUMsbUJBQW1CO0FBQ3JCLENBQUMsQ0FBQyxZQUFZO0FBQ2QsQ0FBQyxDQUFDLG9CQUFvQjtBQUN0QixDQUFDLENBQUMsSUFBSTtBQUNOLENBQUMsQ0FBQyxrQ0FBa0M7QUFDcEMsQ0FBQyxDQUFDLEtBQUs7QUFDUCxDQUFDLENBQUMsT0FBTztBQUNULENBQUMsQ0FBQyxvQkFBb0I7QUFDdEIsQ0FBQyxDQUFDLGlCQUFpQjtBQUNuQixDQUFDLENBQUMsaUJBQWlCO0FBQ25CLENBQUMsQ0FBQyxnQkFBZ0I7QUFDbEIsQ0FBQyxDQUFDLGVBQWU7QUFDakIsQ0FBQyxDQUFDLHNCQUFzQjtBQUN4QixDQUFDLENBQUMsK0JBQStCO0FBQ2pDLENBQUMsQ0FBQyxlQUFlO0FBQ2pCLENBQUMsQ0FBQyw0QkFBNEI7QUFDOUIsQ0FBQyxDQUFDLGVBQWU7QUFDakIsQ0FBQyxDQUFDLHdCQUF3QjtBQUMxQixDQUFDLENBQUMsdUJBQXVCO0FBQ3pCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUMsQ0FBQyxpQkFBaUI7QUFDekMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxDQUFDLHFCQUFxQjtBQUNqRCxDQUFDLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDLGVBQWU7QUFDckMsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEVBQUUsQ0FBQyxDQUFDLG1CQUFtQjtBQUM3QyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLENBQUMsZ0JBQWdCO0FBQ3ZDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLENBQUMsQ0FBQyxvQkFBb0I7QUFDL0MsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxlQUFlO0FBQ3JDLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQyxnQkFBZ0I7QUFDdkMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNiLENBQUM7In0="
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.210Z",
        "time": 2.052999974694103,
        "timings": {
          "blocked": 1.4489999724142253,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.40199997755140066,
          "receive": 0.202000024728477,
          "_blocked_queueing": 1.3799999724142253,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/main.js",
          "lineNumber": 9
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_core.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "102044"
            },
            {
              "name": "Etag",
              "value": "W/\"64cd-VJP+WB+nwwf1219Hvn/malpe8+M\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 102044,
            "mimeType": "text/javascript",
            "text": "import {\n  ANIMATIONS_DISABLED,\n  ANIMATION_MODULE_TYPE,\n  APP_BOOTSTRAP_LISTENER,\n  APP_ID,\n  APP_INITIALIZER,\n  AcxChangeDetectionStrategy,\n  AcxViewEncapsulation,\n  AfterRenderManager,\n  ApplicationInitStatus,\n  ApplicationModule,\n  ApplicationRef,\n  Attribute,\n  CLIENT_RENDER_MODE_FLAG,\n  COMPILER_OPTIONS,\n  CONTAINER_HEADER_OFFSET,\n  CSP_NONCE,\n  CUSTOM_ELEMENTS_SCHEMA,\n  ChangeDetectionScheduler,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Compiler,\n  CompilerFactory,\n  Component,\n  ComponentFactory,\n  ComponentFactory$1,\n  ComponentFactoryResolver$1,\n  ComponentRef,\n  ComponentRef$1,\n  Console,\n  ContentChild,\n  ContentChildren,\n  DEFAULT_CURRENCY_CODE,\n  DEFAULT_LOCALE_ID,\n  DEFER_BLOCK_CONFIG,\n  DEFER_BLOCK_DEPENDENCY_INTERCEPTOR,\n  DEHYDRATED_BLOCK_REGISTRY,\n  DOCUMENT,\n  DebugElement,\n  DebugEventListener,\n  DebugNode,\n  DefaultIterableDiffer,\n  DeferBlockBehavior,\n  DeferBlockState,\n  DestroyRef,\n  Directive,\n  ENABLE_ROOT_COMPONENT_BOOTSTRAP,\n  ENVIRONMENT_INITIALIZER,\n  EVENT_REPLAY_QUEUE,\n  EffectScheduler,\n  ElementRef,\n  EmbeddedViewRef,\n  EnvironmentInjector,\n  ErrorHandler,\n  EventEmitter,\n  FactoryTarget,\n  Framework,\n  HOST_TAG_NAME,\n  Host,\n  HostAttributeToken,\n  HostBinding,\n  HostListener,\n  HydrationStatus,\n  IMAGE_CONFIG,\n  IMAGE_CONFIG_DEFAULTS,\n  INJECTOR$1,\n  INJECTOR_SCOPE,\n  INTERNAL_APPLICATION_ERROR_HANDLER,\n  IS_ENABLED_BLOCKING_INITIAL_NAVIGATION,\n  IS_HYDRATION_DOM_REUSE_ENABLED,\n  IS_INCREMENTAL_HYDRATION_ENABLED,\n  Inject,\n  Injectable,\n  InjectionToken,\n  Injector,\n  Input,\n  IterableDiffers,\n  JSACTION_BLOCK_ELEMENT_MAP,\n  JSACTION_EVENT_CONTRACT,\n  KeyValueDiffers,\n  LContext,\n  LOCALE_ID,\n  LocaleDataIndex,\n  MAX_ANIMATION_TIMEOUT,\n  MissingTranslationStrategy,\n  ModuleWithComponentFactories,\n  NG_COMP_DEF,\n  NG_DIR_DEF,\n  NG_ELEMENT_ID,\n  NG_INJ_DEF,\n  NG_MOD_DEF,\n  NG_PIPE_DEF,\n  NG_PROV_DEF,\n  NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR,\n  NO_CHANGE,\n  NO_ERRORS_SCHEMA,\n  NgModule,\n  NgModuleFactory,\n  NgModuleFactory$1,\n  NgModuleRef,\n  NgModuleRef$1,\n  NgZone,\n  NoopNgZone,\n  Optional,\n  Output,\n  OutputEmitterRef,\n  PERFORMANCE_MARK_PREFIX,\n  PLATFORM_ID,\n  PLATFORM_INITIALIZER,\n  PROVIDED_NG_ZONE,\n  PROVIDED_ZONELESS,\n  PendingTasks,\n  PendingTasksInternal,\n  Pipe,\n  PlatformRef,\n  ProfilerEvent,\n  Query,\n  QueryList,\n  R3Injector,\n  REQUEST,\n  REQUEST_CONTEXT,\n  RESPONSE_INIT,\n  ReflectionCapabilities,\n  Renderer2,\n  RendererFactory2,\n  RendererStyleFlags2,\n  ResourceImpl,\n  RuntimeError,\n  SIGNAL,\n  SSR_CONTENT_INTEGRITY_MARKER,\n  Sanitizer,\n  SecurityContext,\n  Self,\n  SimpleChange,\n  SkipSelf,\n  TESTABILITY,\n  TESTABILITY_GETTER,\n  TRANSLATIONS,\n  TRANSLATIONS_FORMAT,\n  TemplateRef,\n  Testability,\n  TestabilityRegistry,\n  TimerScheduler,\n  TracingAction,\n  TracingService,\n  TransferState,\n  Type,\n  VERSION,\n  Version,\n  ViewChild,\n  ViewChildren,\n  ViewContainerRef,\n  ViewEncapsulation,\n  ViewRef,\n  ViewRef2,\n  XSS_SECURITY_URL,\n  ZONELESS_ENABLED,\n  _global,\n  _sanitizeHtml,\n  _sanitizeUrl,\n  afterEveryRender,\n  afterNextRender,\n  afterRenderEffect,\n  allLeavingAnimations,\n  allowSanitizationBypassAndThrow,\n  annotateForHydration,\n  asNativeElements,\n  assertInInjectionContext,\n  assertNotInReactiveContext,\n  assertPlatform,\n  booleanAttribute,\n  bypassSanitizationTrustHtml,\n  bypassSanitizationTrustResourceUrl,\n  bypassSanitizationTrustScript,\n  bypassSanitizationTrustStyle,\n  bypassSanitizationTrustUrl,\n  clearResolutionOfComponentResourcesQueue,\n  compileComponent,\n  compileDirective,\n  compileNgModule,\n  compileNgModuleDefs,\n  compileNgModuleFactory,\n  compilePipe,\n  computed,\n  contentChild,\n  contentChildren,\n  convertToBitFlags,\n  createComponent,\n  createEnvironmentInjector,\n  createInjector,\n  createNgModule,\n  createNgModuleRef,\n  createOrReusePlatformInjector,\n  createPlatform,\n  createPlatformFactory,\n  defaultIterableDiffers,\n  defaultKeyValueDiffers,\n  depsTracker,\n  destroyPlatform,\n  devModeEqual,\n  disableProfiling,\n  effect,\n  enableProdMode,\n  enableProfiling,\n  enableProfiling2,\n  encapsulateResourceError,\n  findLocaleData,\n  flushModuleScopingQueueAsMuchAsPossible,\n  formatRuntimeError,\n  forwardRef,\n  generateStandaloneInDeclarationsError,\n  getAsyncClassMetadataFn,\n  getClosestComponentName,\n  getComponentDef,\n  getDebugNode,\n  getDeferBlocks$1,\n  getDirectives,\n  getDocument,\n  getHostElement,\n  getInjectableDef,\n  getLContext,\n  getLocaleCurrencyCode,\n  getLocalePluralCase,\n  getModuleFactory,\n  getNgModuleById,\n  getOutputDestroyRef,\n  getPlatform,\n  getSanitizationBypassType,\n  getTransferState,\n  importProvidersFrom,\n  inferTagNameFromDefinition,\n  inject,\n  injectChangeDetectorRef,\n  input,\n  inputBinding,\n  internalCreateApplication,\n  internalProvideZoneChangeDetection,\n  isBoundToModule,\n  isComponentDefPendingResolution,\n  isDevMode,\n  isEnvironmentProviders,\n  isInjectable,\n  isNgModule,\n  isPromise,\n  isSignal,\n  isStandalone,\n  isSubscribable,\n  isViewDirty,\n  isWritableSignal,\n  linkedSignal,\n  makeEnvironmentProviders,\n  makeStateKey,\n  markForRefresh,\n  mergeApplicationConfig,\n  model,\n  noSideEffects,\n  numberAttribute,\n  output,\n  outputBinding,\n  patchComponentDefWithScope,\n  performanceMarkFeature,\n  platformCore,\n  promiseWithResolvers,\n  provideAppInitializer,\n  provideBrowserGlobalErrorListeners,\n  provideCheckNoChangesConfig,\n  provideEnvironmentInitializer,\n  provideNgReflectAttributes,\n  providePlatformInitializer,\n  provideStabilityDebugging,\n  provideZoneChangeDetection,\n  provideZonelessChangeDetection,\n  provideZonelessChangeDetectionInternal,\n  publishExternalGlobalUtil,\n  readHydrationInfo,\n  reflectComponentType,\n  registerLocaleData,\n  registerNgModuleType,\n  renderDeferBlockState,\n  resetCompiledComponents,\n  resetIncrementalHydrationEnabledWarnedForTests,\n  resetJitOptions,\n  resolveComponentResources,\n  resolveForwardRef,\n  resource,\n  restoreComponentResolutionQueue,\n  runInInjectionContext,\n  setAllowDuplicateNgModuleIdsForTest,\n  setAlternateWeakRefImpl,\n  setClassMetadata,\n  setClassMetadataAsync,\n  setCurrentInjector,\n  setDocument,\n  setInjectorProfilerContext,\n  setLocaleId,\n  setTestabilityGetter,\n  signal,\n  startMeasuring,\n  stopMeasuring,\n  store,\n  stringify,\n  transitiveScopesFor,\n  triggerResourceLoading,\n  truncateMiddle,\n  twoWayBinding,\n  unregisterAllLocaleData,\n  untracked,\n  unwrapSafeValue,\n  viewChild,\n  viewChildren,\n  withDomHydration,\n  withEventReplay,\n  withI18nSupport,\n  withIncrementalHydration,\n  CONTROL,\n  INPUT_SIGNAL_BRAND_WRITE_TYPE,\n  assertType,\n  controlUpdate,\n  getUnknownElementStrictMode,\n  getUnknownPropertyStrictMode,\n  setClassDebugInfo,\n  setUnknownElementStrictMode,\n  setUnknownPropertyStrictMode,\n  unwrapWritableSignal,\n  ExternalStylesFeature,\n  HostDirectivesFeature,\n  InheritDefinitionFeature,\n  NgOnChangesFeature,\n  ProvidersFeature,\n  advance,\n  animateEnter,\n  animateEnterListener,\n  animateLeave,\n  animateLeaveListener,\n  ariaProperty,\n  attachSourceLocations,\n  attribute,\n  classMap,\n  classProp,\n  componentInstance,\n  conditional,\n  conditionalBranchCreate,\n  conditionalCreate,\n  contentQuery,\n  contentQuerySignal,\n  control,\n  controlCreate,\n  declareLet,\n  defer,\n  deferEnableTimerScheduling,\n  deferHydrateNever,\n  deferHydrateOnHover,\n  deferHydrateOnIdle,\n  deferHydrateOnImmediate,\n  deferHydrateOnInteraction,\n  deferHydrateOnTimer,\n  deferHydrateOnViewport,\n  deferHydrateWhen,\n  deferOnHover,\n  deferOnIdle,\n  deferOnImmediate,\n  deferOnInteraction,\n  deferOnTimer,\n  deferOnViewport,\n  deferPrefetchOnHover,\n  deferPrefetchOnIdle,\n  deferPrefetchOnImmediate,\n  deferPrefetchOnInteraction,\n  deferPrefetchOnTimer,\n  deferPrefetchOnViewport,\n  deferPrefetchWhen,\n  deferWhen,\n  defineComponent,\n  defineDirective,\n  defineInjectable,\n  defineInjector,\n  defineNgModule,\n  definePipe,\n  directiveInject,\n  disableBindings,\n  domElement,\n  domElementContainer,\n  domElementContainerEnd,\n  domElementContainerStart,\n  domElementEnd,\n  domElementStart,\n  domListener,\n  domProperty,\n  domTemplate,\n  element,\n  elementContainer,\n  elementContainerEnd,\n  elementContainerStart,\n  elementEnd,\n  elementStart,\n  enableBindings,\n  getComponentDepsFactory,\n  getCurrentView,\n  getInheritedFactory,\n  getReplaceMetadataURL,\n  i18n,\n  i18nApply,\n  i18nAttributes,\n  i18nEnd,\n  i18nExp,\n  i18nPostprocess,\n  i18nStart,\n  inject,\n  injectAttribute,\n  interpolate,\n  interpolate1,\n  interpolate2,\n  interpolate3,\n  interpolate4,\n  interpolate5,\n  interpolate6,\n  interpolate7,\n  interpolate8,\n  interpolateV,\n  invalidFactory,\n  invalidFactoryDep,\n  listener,\n  loadQuery,\n  namespaceHTML,\n  namespaceMathML,\n  namespaceSVG,\n  nextContext,\n  ngDeclareClassMetadata,\n  ngDeclareClassMetadataAsync,\n  ngDeclareComponent,\n  ngDeclareDirective,\n  ngDeclareFactory,\n  ngDeclareInjectable,\n  ngDeclareInjector,\n  ngDeclareNgModule,\n  ngDeclarePipe,\n  pipe,\n  pipeBind1,\n  pipeBind2,\n  pipeBind3,\n  pipeBind4,\n  pipeBindV,\n  projection,\n  projectionDef,\n  property,\n  pureFunction0,\n  pureFunction1,\n  pureFunction2,\n  pureFunction3,\n  pureFunction4,\n  pureFunction5,\n  pureFunction6,\n  pureFunction7,\n  pureFunction8,\n  pureFunctionV,\n  queryAdvance,\n  queryRefresh,\n  readContextLet,\n  reference,\n  repeater,\n  repeaterCreate,\n  repeaterTrackByIdentity,\n  repeaterTrackByIndex,\n  replaceMetadata,\n  resetView,\n  resolveBody,\n  resolveDocument,\n  resolveWindow,\n  restoreView,\n  sanitizeHtml,\n  sanitizeResourceUrl,\n  sanitizeScript,\n  sanitizeStyle,\n  sanitizeUrl,\n  sanitizeUrlOrResourceUrl,\n  setComponentScope,\n  setNgModuleScope,\n  storeLet,\n  styleMap,\n  styleProp,\n  syntheticHostListener,\n  syntheticHostProperty,\n  template,\n  templateRefExtractor,\n  text,\n  textInterpolate,\n  textInterpolate1,\n  textInterpolate2,\n  textInterpolate3,\n  textInterpolate4,\n  textInterpolate5,\n  textInterpolate6,\n  textInterpolate7,\n  textInterpolate8,\n  textInterpolateV,\n  trustConstantHtml,\n  trustConstantResourceUrl,\n  twoWayBindingSet,\n  twoWayListener,\n  twoWayProperty,\n  validateAttribute,\n  viewQuery,\n  viewQuerySignal\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\nexport {\n  ANIMATION_MODULE_TYPE,\n  APP_BOOTSTRAP_LISTENER,\n  APP_ID,\n  APP_INITIALIZER,\n  ApplicationInitStatus,\n  ApplicationModule,\n  ApplicationRef,\n  Attribute,\n  COMPILER_OPTIONS,\n  CSP_NONCE,\n  CUSTOM_ELEMENTS_SCHEMA,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Compiler,\n  CompilerFactory,\n  Component,\n  ComponentFactory$1 as ComponentFactory,\n  ComponentFactoryResolver$1 as ComponentFactoryResolver,\n  ComponentRef$1 as ComponentRef,\n  ContentChild,\n  ContentChildren,\n  DEFAULT_CURRENCY_CODE,\n  DOCUMENT,\n  DebugElement,\n  DebugEventListener,\n  DebugNode,\n  DefaultIterableDiffer,\n  DestroyRef,\n  Directive,\n  ENVIRONMENT_INITIALIZER,\n  ElementRef,\n  EmbeddedViewRef,\n  EnvironmentInjector,\n  ErrorHandler,\n  EventEmitter,\n  HOST_TAG_NAME,\n  Host,\n  HostAttributeToken,\n  HostBinding,\n  HostListener,\n  INJECTOR$1 as INJECTOR,\n  Inject,\n  Injectable,\n  InjectionToken,\n  Injector,\n  Input,\n  IterableDiffers,\n  KeyValueDiffers,\n  LOCALE_ID,\n  MAX_ANIMATION_TIMEOUT,\n  MissingTranslationStrategy,\n  ModuleWithComponentFactories,\n  NO_ERRORS_SCHEMA,\n  NgModule,\n  NgModuleFactory$1 as NgModuleFactory,\n  NgModuleRef$1 as NgModuleRef,\n  NgZone,\n  Optional,\n  Output,\n  OutputEmitterRef,\n  PLATFORM_ID,\n  PLATFORM_INITIALIZER,\n  PendingTasks,\n  Pipe,\n  PlatformRef,\n  Query,\n  QueryList,\n  REQUEST,\n  REQUEST_CONTEXT,\n  RESPONSE_INIT,\n  Renderer2,\n  RendererFactory2,\n  RendererStyleFlags2,\n  Sanitizer,\n  SecurityContext,\n  Self,\n  SimpleChange,\n  SkipSelf,\n  TRANSLATIONS,\n  TRANSLATIONS_FORMAT,\n  TemplateRef,\n  Testability,\n  TestabilityRegistry,\n  TransferState,\n  Type,\n  VERSION,\n  Version,\n  ViewChild,\n  ViewChildren,\n  ViewContainerRef,\n  ViewEncapsulation,\n  ViewRef2 as ViewRef,\n  afterEveryRender,\n  afterNextRender,\n  afterRenderEffect,\n  asNativeElements,\n  assertInInjectionContext,\n  assertNotInReactiveContext,\n  assertPlatform,\n  booleanAttribute,\n  computed,\n  contentChild,\n  contentChildren,\n  createComponent,\n  createEnvironmentInjector,\n  createNgModule,\n  createNgModuleRef,\n  createPlatform,\n  createPlatformFactory,\n  destroyPlatform,\n  effect,\n  enableProdMode,\n  enableProfiling,\n  forwardRef,\n  getDebugNode,\n  getModuleFactory,\n  getNgModuleById,\n  getPlatform,\n  importProvidersFrom,\n  inject,\n  input,\n  inputBinding,\n  isDevMode,\n  isSignal,\n  isStandalone,\n  isWritableSignal,\n  linkedSignal,\n  makeEnvironmentProviders,\n  makeStateKey,\n  mergeApplicationConfig,\n  model,\n  numberAttribute,\n  output,\n  outputBinding,\n  platformCore,\n  provideAppInitializer,\n  provideBrowserGlobalErrorListeners,\n  provideCheckNoChangesConfig,\n  provideEnvironmentInitializer,\n  provideNgReflectAttributes,\n  providePlatformInitializer,\n  provideStabilityDebugging,\n  provideZoneChangeDetection,\n  provideZonelessChangeDetection,\n  reflectComponentType,\n  resolveForwardRef,\n  resource,\n  runInInjectionContext,\n  setTestabilityGetter,\n  signal,\n  twoWayBinding,\n  untracked,\n  viewChild,\n  viewChildren,\n  ANIMATIONS_DISABLED as ANIMATIONS_DISABLED,\n  AcxChangeDetectionStrategy as AcxChangeDetectionStrategy,\n  AcxViewEncapsulation as AcxViewEncapsulation,\n  AfterRenderManager as AfterRenderManager,\n  CLIENT_RENDER_MODE_FLAG as CLIENT_RENDER_MODE_FLAG,\n  CONTAINER_HEADER_OFFSET as CONTAINER_HEADER_OFFSET,\n  CONTROL,\n  ChangeDetectionScheduler as ChangeDetectionScheduler,\n  ComponentFactory$1 as ComponentFactory,\n  Console as Console,\n  DEFAULT_LOCALE_ID as DEFAULT_LOCALE_ID,\n  DEFER_BLOCK_CONFIG as DEFER_BLOCK_CONFIG,\n  DEFER_BLOCK_DEPENDENCY_INTERCEPTOR as DEFER_BLOCK_DEPENDENCY_INTERCEPTOR,\n  DEHYDRATED_BLOCK_REGISTRY as DEHYDRATED_BLOCK_REGISTRY,\n  DeferBlockBehavior as DeferBlockBehavior,\n  DeferBlockState as DeferBlockState,\n  ENABLE_ROOT_COMPONENT_BOOTSTRAP as ENABLE_ROOT_COMPONENT_BOOTSTRAP,\n  EVENT_REPLAY_QUEUE as EVENT_REPLAY_QUEUE,\n  EffectScheduler as EffectScheduler,\n  Framework as Framework,\n  HydrationStatus as HydrationStatus,\n  IMAGE_CONFIG as IMAGE_CONFIG,\n  IMAGE_CONFIG_DEFAULTS as IMAGE_CONFIG_DEFAULTS,\n  INJECTOR_SCOPE as INJECTOR_SCOPE,\n  INPUT_SIGNAL_BRAND_WRITE_TYPE,\n  INTERNAL_APPLICATION_ERROR_HANDLER as INTERNAL_APPLICATION_ERROR_HANDLER,\n  IS_ENABLED_BLOCKING_INITIAL_NAVIGATION as IS_ENABLED_BLOCKING_INITIAL_NAVIGATION,\n  IS_HYDRATION_DOM_REUSE_ENABLED as IS_HYDRATION_DOM_REUSE_ENABLED,\n  IS_INCREMENTAL_HYDRATION_ENABLED as IS_INCREMENTAL_HYDRATION_ENABLED,\n  JSACTION_BLOCK_ELEMENT_MAP as JSACTION_BLOCK_ELEMENT_MAP,\n  JSACTION_EVENT_CONTRACT as JSACTION_EVENT_CONTRACT,\n  LContext as LContext,\n  LocaleDataIndex as LocaleDataIndex,\n  NG_COMP_DEF as NG_COMP_DEF,\n  NG_DIR_DEF as NG_DIR_DEF,\n  NG_ELEMENT_ID as NG_ELEMENT_ID,\n  NG_INJ_DEF as NG_INJ_DEF,\n  NG_MOD_DEF as NG_MOD_DEF,\n  NG_PIPE_DEF as NG_PIPE_DEF,\n  NG_PROV_DEF as NG_PROV_DEF,\n  NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR as NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR,\n  NO_CHANGE as NO_CHANGE,\n  NgModuleFactory as NgModuleFactory,\n  NoopNgZone as NoopNgZone,\n  PERFORMANCE_MARK_PREFIX as PERFORMANCE_MARK_PREFIX,\n  PROVIDED_NG_ZONE as PROVIDED_NG_ZONE,\n  PROVIDED_ZONELESS as PROVIDED_ZONELESS,\n  PendingTasksInternal as PendingTasksInternal,\n  ProfilerEvent as ProfilerEvent,\n  R3Injector as R3Injector,\n  ReflectionCapabilities as ReflectionCapabilities,\n  ComponentFactory as Render3ComponentFactory,\n  ComponentRef as Render3ComponentRef,\n  NgModuleRef as Render3NgModuleRef,\n  ResourceImpl as ResourceImpl,\n  RuntimeError as RuntimeError,\n  SIGNAL as SIGNAL,\n  SSR_CONTENT_INTEGRITY_MARKER as SSR_CONTENT_INTEGRITY_MARKER,\n  TESTABILITY as TESTABILITY,\n  TESTABILITY_GETTER as TESTABILITY_GETTER,\n  TimerScheduler as TimerScheduler,\n  TracingAction as TracingAction,\n  TracingService as TracingService,\n  ViewRef as ViewRef,\n  XSS_SECURITY_URL as XSS_SECURITY_URL,\n  ZONELESS_ENABLED as ZONELESS_ENABLED,\n  _sanitizeHtml as _sanitizeHtml,\n  _sanitizeUrl as _sanitizeUrl,\n  allLeavingAnimations as allLeavingAnimations,\n  allowSanitizationBypassAndThrow as allowSanitizationBypassAndThrow,\n  annotateForHydration as annotateForHydration,\n  assertType,\n  bypassSanitizationTrustHtml as bypassSanitizationTrustHtml,\n  bypassSanitizationTrustResourceUrl as bypassSanitizationTrustResourceUrl,\n  bypassSanitizationTrustScript as bypassSanitizationTrustScript,\n  bypassSanitizationTrustStyle as bypassSanitizationTrustStyle,\n  bypassSanitizationTrustUrl as bypassSanitizationTrustUrl,\n  clearResolutionOfComponentResourcesQueue as clearResolutionOfComponentResourcesQueue,\n  compileComponent as compileComponent,\n  compileDirective as compileDirective,\n  compileNgModule as compileNgModule,\n  compileNgModuleDefs as compileNgModuleDefs,\n  compileNgModuleFactory as compileNgModuleFactory,\n  compilePipe as compilePipe,\n  controlUpdate,\n  convertToBitFlags as convertToBitFlags,\n  createInjector as createInjector,\n  createOrReusePlatformInjector as createOrReusePlatformInjector,\n  defaultIterableDiffers as defaultIterableDiffers,\n  defaultKeyValueDiffers as defaultKeyValueDiffers,\n  depsTracker as depsTracker,\n  devModeEqual as devModeEqual,\n  disableProfiling as disableProfiling,\n  enableProfiling2 as enableProfiling,\n  encapsulateResourceError as encapsulateResourceError,\n  findLocaleData as findLocaleData,\n  flushModuleScopingQueueAsMuchAsPossible as flushModuleScopingQueueAsMuchAsPossible,\n  formatRuntimeError as formatRuntimeError,\n  generateStandaloneInDeclarationsError as generateStandaloneInDeclarationsError,\n  getAsyncClassMetadataFn as getAsyncClassMetadataFn,\n  getClosestComponentName as getClosestComponentName,\n  getComponentDef as getComponentDef,\n  getDebugNode as getDebugNode,\n  getDeferBlocks$1 as getDeferBlocks,\n  getDirectives as getDirectives,\n  getDocument as getDocument,\n  getHostElement as getHostElement,\n  getInjectableDef as getInjectableDef,\n  getLContext as getLContext,\n  getLocaleCurrencyCode as getLocaleCurrencyCode,\n  getLocalePluralCase as getLocalePluralCase,\n  getOutputDestroyRef as getOutputDestroyRef,\n  getSanitizationBypassType as getSanitizationBypassType,\n  getTransferState as getTransferState,\n  getUnknownElementStrictMode,\n  getUnknownPropertyStrictMode,\n  _global as global,\n  inferTagNameFromDefinition as inferTagNameFromDefinition,\n  injectChangeDetectorRef as injectChangeDetectorRef,\n  internalCreateApplication as internalCreateApplication,\n  internalProvideZoneChangeDetection as internalProvideZoneChangeDetection,\n  isBoundToModule as isBoundToModule,\n  isComponentDefPendingResolution as isComponentDefPendingResolution,\n  isEnvironmentProviders as isEnvironmentProviders,\n  isInjectable as isInjectable,\n  isNgModule as isNgModule,\n  isPromise as isPromise,\n  isSubscribable as isSubscribable,\n  isViewDirty as isViewDirty,\n  markForRefresh as markForRefresh,\n  noSideEffects as noSideEffects,\n  patchComponentDefWithScope as patchComponentDefWithScope,\n  performanceMarkFeature as performanceMarkFeature,\n  promiseWithResolvers as promiseWithResolvers,\n  provideZonelessChangeDetectionInternal as provideZonelessChangeDetectionInternal,\n  publishExternalGlobalUtil as publishExternalGlobalUtil,\n  readHydrationInfo as readHydrationInfo,\n  registerLocaleData as registerLocaleData,\n  renderDeferBlockState as renderDeferBlockState,\n  resetCompiledComponents as resetCompiledComponents,\n  resetIncrementalHydrationEnabledWarnedForTests as resetIncrementalHydrationEnabledWarnedForTests,\n  resetJitOptions as resetJitOptions,\n  resolveComponentResources as resolveComponentResources,\n  restoreComponentResolutionQueue as restoreComponentResolutionQueue,\n  setAllowDuplicateNgModuleIdsForTest as setAllowDuplicateNgModuleIdsForTest,\n  setAlternateWeakRefImpl as setAlternateWeakRefImpl,\n  setClassDebugInfo,\n  setClassMetadata as setClassMetadata,\n  setClassMetadataAsync as setClassMetadataAsync,\n  setCurrentInjector as setCurrentInjector,\n  setDocument as setDocument,\n  setInjectorProfilerContext as setInjectorProfilerContext,\n  setLocaleId as setLocaleId,\n  setUnknownElementStrictMode,\n  setUnknownPropertyStrictMode,\n  startMeasuring as startMeasuring,\n  stopMeasuring as stopMeasuring,\n  store as store,\n  stringify as stringify,\n  transitiveScopesFor as transitiveScopesFor,\n  triggerResourceLoading as triggerResourceLoading,\n  truncateMiddle as truncateMiddle,\n  unregisterAllLocaleData as unregisterLocaleData,\n  unwrapSafeValue as unwrapSafeValue,\n  unwrapWritableSignal,\n  withDomHydration as withDomHydration,\n  withEventReplay as withEventReplay,\n  withI18nSupport as withI18nSupport,\n  withIncrementalHydration as withIncrementalHydration,\n  ExternalStylesFeature,\n  FactoryTarget as FactoryTarget,\n  HostDirectivesFeature,\n  InheritDefinitionFeature,\n  NgOnChangesFeature,\n  ProvidersFeature,\n  advance,\n  animateEnter,\n  animateEnterListener,\n  animateLeave,\n  animateLeaveListener,\n  ariaProperty,\n  attachSourceLocations,\n  attribute,\n  classMap,\n  classProp,\n  componentInstance,\n  conditional,\n  conditionalBranchCreate,\n  conditionalCreate,\n  contentQuery,\n  contentQuerySignal,\n  control,\n  controlCreate,\n  declareLet,\n  defer,\n  deferEnableTimerScheduling,\n  deferHydrateNever,\n  deferHydrateOnHover,\n  deferHydrateOnIdle,\n  deferHydrateOnImmediate,\n  deferHydrateOnInteraction,\n  deferHydrateOnTimer,\n  deferHydrateOnViewport,\n  deferHydrateWhen,\n  deferOnHover,\n  deferOnIdle,\n  deferOnImmediate,\n  deferOnInteraction,\n  deferOnTimer,\n  deferOnViewport,\n  deferPrefetchOnHover,\n  deferPrefetchOnIdle,\n  deferPrefetchOnImmediate,\n  deferPrefetchOnInteraction,\n  deferPrefetchOnTimer,\n  deferPrefetchOnViewport,\n  deferPrefetchWhen,\n  deferWhen,\n  defineComponent,\n  defineDirective,\n  defineInjectable,\n  defineInjector,\n  defineNgModule,\n  definePipe,\n  directiveInject,\n  disableBindings,\n  domElement,\n  domElementContainer,\n  domElementContainerEnd,\n  domElementContainerStart,\n  domElementEnd,\n  domElementStart,\n  domListener,\n  domProperty,\n  domTemplate,\n  element,\n  elementContainer,\n  elementContainerEnd,\n  elementContainerStart,\n  elementEnd,\n  elementStart,\n  enableBindings,\n  getComponentDepsFactory,\n  getCurrentView,\n  getInheritedFactory,\n  getReplaceMetadataURL,\n  i18n,\n  i18nApply,\n  i18nAttributes,\n  i18nEnd,\n  i18nExp,\n  i18nPostprocess,\n  i18nStart,\n  inject,\n  injectAttribute,\n  interpolate,\n  interpolate1,\n  interpolate2,\n  interpolate3,\n  interpolate4,\n  interpolate5,\n  interpolate6,\n  interpolate7,\n  interpolate8,\n  interpolateV,\n  invalidFactory,\n  invalidFactoryDep,\n  listener,\n  loadQuery,\n  namespaceHTML,\n  namespaceMathML,\n  namespaceSVG,\n  nextContext,\n  ngDeclareClassMetadata,\n  ngDeclareClassMetadataAsync,\n  ngDeclareComponent,\n  ngDeclareDirective,\n  ngDeclareFactory,\n  ngDeclareInjectable,\n  ngDeclareInjector,\n  ngDeclareNgModule,\n  ngDeclarePipe,\n  pipe,\n  pipeBind1,\n  pipeBind2,\n  pipeBind3,\n  pipeBind4,\n  pipeBindV,\n  projection,\n  projectionDef,\n  property,\n  pureFunction0,\n  pureFunction1,\n  pureFunction2,\n  pureFunction3,\n  pureFunction4,\n  pureFunction5,\n  pureFunction6,\n  pureFunction7,\n  pureFunction8,\n  pureFunctionV,\n  queryAdvance,\n  queryRefresh,\n  readContextLet,\n  reference,\n  registerNgModuleType as registerNgModuleType,\n  repeater,\n  repeaterCreate,\n  repeaterTrackByIdentity,\n  repeaterTrackByIndex,\n  replaceMetadata,\n  resetView,\n  resolveBody,\n  resolveDocument,\n  resolveWindow,\n  restoreView,\n  sanitizeHtml,\n  sanitizeResourceUrl,\n  sanitizeScript,\n  sanitizeStyle,\n  sanitizeUrl,\n  sanitizeUrlOrResourceUrl,\n  setComponentScope,\n  setNgModuleScope,\n  storeLet,\n  styleMap,\n  styleProp,\n  syntheticHostListener,\n  syntheticHostProperty,\n  template,\n  templateRefExtractor,\n  text,\n  textInterpolate,\n  textInterpolate1,\n  textInterpolate2,\n  textInterpolate3,\n  textInterpolate4,\n  textInterpolate5,\n  textInterpolate6,\n  textInterpolate7,\n  textInterpolate8,\n  textInterpolateV,\n  trustConstantHtml,\n  trustConstantResourceUrl,\n  twoWayBindingSet,\n  twoWayListener,\n  twoWayProperty,\n  validateAttribute,\n  viewQuery,\n  viewQuerySignal\n};\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkBhbmd1bGFyX2NvcmUuanM/dj1hM2VjOGM2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBTklNQVRJT05TX0RJU0FCTEVELFxuICBBTklNQVRJT05fTU9EVUxFX1RZUEUsXG4gIEFQUF9CT09UU1RSQVBfTElTVEVORVIsXG4gIEFQUF9JRCxcbiAgQVBQX0lOSVRJQUxJWkVSLFxuICBBY3hDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQWN4Vmlld0VuY2Fwc3VsYXRpb24sXG4gIEFmdGVyUmVuZGVyTWFuYWdlcixcbiAgQXBwbGljYXRpb25Jbml0U3RhdHVzLFxuICBBcHBsaWNhdGlvbk1vZHVsZSxcbiAgQXBwbGljYXRpb25SZWYsXG4gIEF0dHJpYnV0ZSxcbiAgQ0xJRU5UX1JFTkRFUl9NT0RFX0ZMQUcsXG4gIENPTVBJTEVSX09QVElPTlMsXG4gIENPTlRBSU5FUl9IRUFERVJfT0ZGU0VULFxuICBDU1BfTk9OQ0UsXG4gIENVU1RPTV9FTEVNRU5UU19TQ0hFTUEsXG4gIENoYW5nZURldGVjdGlvblNjaGVkdWxlcixcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21waWxlcixcbiAgQ29tcGlsZXJGYWN0b3J5LFxuICBDb21wb25lbnQsXG4gIENvbXBvbmVudEZhY3RvcnksXG4gIENvbXBvbmVudEZhY3RvcnkkMSxcbiAgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyJDEsXG4gIENvbXBvbmVudFJlZixcbiAgQ29tcG9uZW50UmVmJDEsXG4gIENvbnNvbGUsXG4gIENvbnRlbnRDaGlsZCxcbiAgQ29udGVudENoaWxkcmVuLFxuICBERUZBVUxUX0NVUlJFTkNZX0NPREUsXG4gIERFRkFVTFRfTE9DQUxFX0lELFxuICBERUZFUl9CTE9DS19DT05GSUcsXG4gIERFRkVSX0JMT0NLX0RFUEVOREVOQ1lfSU5URVJDRVBUT1IsXG4gIERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlksXG4gIERPQ1VNRU5ULFxuICBEZWJ1Z0VsZW1lbnQsXG4gIERlYnVnRXZlbnRMaXN0ZW5lcixcbiAgRGVidWdOb2RlLFxuICBEZWZhdWx0SXRlcmFibGVEaWZmZXIsXG4gIERlZmVyQmxvY2tCZWhhdmlvcixcbiAgRGVmZXJCbG9ja1N0YXRlLFxuICBEZXN0cm95UmVmLFxuICBEaXJlY3RpdmUsXG4gIEVOQUJMRV9ST09UX0NPTVBPTkVOVF9CT09UU1RSQVAsXG4gIEVOVklST05NRU5UX0lOSVRJQUxJWkVSLFxuICBFVkVOVF9SRVBMQVlfUVVFVUUsXG4gIEVmZmVjdFNjaGVkdWxlcixcbiAgRWxlbWVudFJlZixcbiAgRW1iZWRkZWRWaWV3UmVmLFxuICBFbnZpcm9ubWVudEluamVjdG9yLFxuICBFcnJvckhhbmRsZXIsXG4gIEV2ZW50RW1pdHRlcixcbiAgRmFjdG9yeVRhcmdldCxcbiAgRnJhbWV3b3JrLFxuICBIT1NUX1RBR19OQU1FLFxuICBIb3N0LFxuICBIb3N0QXR0cmlidXRlVG9rZW4sXG4gIEhvc3RCaW5kaW5nLFxuICBIb3N0TGlzdGVuZXIsXG4gIEh5ZHJhdGlvblN0YXR1cyxcbiAgSU1BR0VfQ09ORklHLFxuICBJTUFHRV9DT05GSUdfREVGQVVMVFMsXG4gIElOSkVDVE9SJDEsXG4gIElOSkVDVE9SX1NDT1BFLFxuICBJTlRFUk5BTF9BUFBMSUNBVElPTl9FUlJPUl9IQU5ETEVSLFxuICBJU19FTkFCTEVEX0JMT0NLSU5HX0lOSVRJQUxfTkFWSUdBVElPTixcbiAgSVNfSFlEUkFUSU9OX0RPTV9SRVVTRV9FTkFCTEVELFxuICBJU19JTkNSRU1FTlRBTF9IWURSQVRJT05fRU5BQkxFRCxcbiAgSW5qZWN0LFxuICBJbmplY3RhYmxlLFxuICBJbmplY3Rpb25Ub2tlbixcbiAgSW5qZWN0b3IsXG4gIElucHV0LFxuICBJdGVyYWJsZURpZmZlcnMsXG4gIEpTQUNUSU9OX0JMT0NLX0VMRU1FTlRfTUFQLFxuICBKU0FDVElPTl9FVkVOVF9DT05UUkFDVCxcbiAgS2V5VmFsdWVEaWZmZXJzLFxuICBMQ29udGV4dCxcbiAgTE9DQUxFX0lELFxuICBMb2NhbGVEYXRhSW5kZXgsXG4gIE1BWF9BTklNQVRJT05fVElNRU9VVCxcbiAgTWlzc2luZ1RyYW5zbGF0aW9uU3RyYXRlZ3ksXG4gIE1vZHVsZVdpdGhDb21wb25lbnRGYWN0b3JpZXMsXG4gIE5HX0NPTVBfREVGLFxuICBOR19ESVJfREVGLFxuICBOR19FTEVNRU5UX0lELFxuICBOR19JTkpfREVGLFxuICBOR19NT0RfREVGLFxuICBOR19QSVBFX0RFRixcbiAgTkdfUFJPVl9ERUYsXG4gIE5PVF9GT1VORF9DSEVDS19PTkxZX0VMRU1FTlRfSU5KRUNUT1IsXG4gIE5PX0NIQU5HRSxcbiAgTk9fRVJST1JTX1NDSEVNQSxcbiAgTmdNb2R1bGUsXG4gIE5nTW9kdWxlRmFjdG9yeSxcbiAgTmdNb2R1bGVGYWN0b3J5JDEsXG4gIE5nTW9kdWxlUmVmLFxuICBOZ01vZHVsZVJlZiQxLFxuICBOZ1pvbmUsXG4gIE5vb3BOZ1pvbmUsXG4gIE9wdGlvbmFsLFxuICBPdXRwdXQsXG4gIE91dHB1dEVtaXR0ZXJSZWYsXG4gIFBFUkZPUk1BTkNFX01BUktfUFJFRklYLFxuICBQTEFURk9STV9JRCxcbiAgUExBVEZPUk1fSU5JVElBTElaRVIsXG4gIFBST1ZJREVEX05HX1pPTkUsXG4gIFBST1ZJREVEX1pPTkVMRVNTLFxuICBQZW5kaW5nVGFza3MsXG4gIFBlbmRpbmdUYXNrc0ludGVybmFsLFxuICBQaXBlLFxuICBQbGF0Zm9ybVJlZixcbiAgUHJvZmlsZXJFdmVudCxcbiAgUXVlcnksXG4gIFF1ZXJ5TGlzdCxcbiAgUjNJbmplY3RvcixcbiAgUkVRVUVTVCxcbiAgUkVRVUVTVF9DT05URVhULFxuICBSRVNQT05TRV9JTklULFxuICBSZWZsZWN0aW9uQ2FwYWJpbGl0aWVzLFxuICBSZW5kZXJlcjIsXG4gIFJlbmRlcmVyRmFjdG9yeTIsXG4gIFJlbmRlcmVyU3R5bGVGbGFnczIsXG4gIFJlc291cmNlSW1wbCxcbiAgUnVudGltZUVycm9yLFxuICBTSUdOQUwsXG4gIFNTUl9DT05URU5UX0lOVEVHUklUWV9NQVJLRVIsXG4gIFNhbml0aXplcixcbiAgU2VjdXJpdHlDb250ZXh0LFxuICBTZWxmLFxuICBTaW1wbGVDaGFuZ2UsXG4gIFNraXBTZWxmLFxuICBURVNUQUJJTElUWSxcbiAgVEVTVEFCSUxJVFlfR0VUVEVSLFxuICBUUkFOU0xBVElPTlMsXG4gIFRSQU5TTEFUSU9OU19GT1JNQVQsXG4gIFRlbXBsYXRlUmVmLFxuICBUZXN0YWJpbGl0eSxcbiAgVGVzdGFiaWxpdHlSZWdpc3RyeSxcbiAgVGltZXJTY2hlZHVsZXIsXG4gIFRyYWNpbmdBY3Rpb24sXG4gIFRyYWNpbmdTZXJ2aWNlLFxuICBUcmFuc2ZlclN0YXRlLFxuICBUeXBlLFxuICBWRVJTSU9OLFxuICBWZXJzaW9uLFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdDaGlsZHJlbixcbiAgVmlld0NvbnRhaW5lclJlZixcbiAgVmlld0VuY2Fwc3VsYXRpb24sXG4gIFZpZXdSZWYsXG4gIFZpZXdSZWYyLFxuICBYU1NfU0VDVVJJVFlfVVJMLFxuICBaT05FTEVTU19FTkFCTEVELFxuICBfZ2xvYmFsLFxuICBfc2FuaXRpemVIdG1sLFxuICBfc2FuaXRpemVVcmwsXG4gIGFmdGVyRXZlcnlSZW5kZXIsXG4gIGFmdGVyTmV4dFJlbmRlcixcbiAgYWZ0ZXJSZW5kZXJFZmZlY3QsXG4gIGFsbExlYXZpbmdBbmltYXRpb25zLFxuICBhbGxvd1Nhbml0aXphdGlvbkJ5cGFzc0FuZFRocm93LFxuICBhbm5vdGF0ZUZvckh5ZHJhdGlvbixcbiAgYXNOYXRpdmVFbGVtZW50cyxcbiAgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0LFxuICBhc3NlcnROb3RJblJlYWN0aXZlQ29udGV4dCxcbiAgYXNzZXJ0UGxhdGZvcm0sXG4gIGJvb2xlYW5BdHRyaWJ1dGUsXG4gIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0SHRtbCxcbiAgYnlwYXNzU2FuaXRpemF0aW9uVHJ1c3RSZXNvdXJjZVVybCxcbiAgYnlwYXNzU2FuaXRpemF0aW9uVHJ1c3RTY3JpcHQsXG4gIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0U3R5bGUsXG4gIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0VXJsLFxuICBjbGVhclJlc29sdXRpb25PZkNvbXBvbmVudFJlc291cmNlc1F1ZXVlLFxuICBjb21waWxlQ29tcG9uZW50LFxuICBjb21waWxlRGlyZWN0aXZlLFxuICBjb21waWxlTmdNb2R1bGUsXG4gIGNvbXBpbGVOZ01vZHVsZURlZnMsXG4gIGNvbXBpbGVOZ01vZHVsZUZhY3RvcnksXG4gIGNvbXBpbGVQaXBlLFxuICBjb21wdXRlZCxcbiAgY29udGVudENoaWxkLFxuICBjb250ZW50Q2hpbGRyZW4sXG4gIGNvbnZlcnRUb0JpdEZsYWdzLFxuICBjcmVhdGVDb21wb25lbnQsXG4gIGNyZWF0ZUVudmlyb25tZW50SW5qZWN0b3IsXG4gIGNyZWF0ZUluamVjdG9yLFxuICBjcmVhdGVOZ01vZHVsZSxcbiAgY3JlYXRlTmdNb2R1bGVSZWYsXG4gIGNyZWF0ZU9yUmV1c2VQbGF0Zm9ybUluamVjdG9yLFxuICBjcmVhdGVQbGF0Zm9ybSxcbiAgY3JlYXRlUGxhdGZvcm1GYWN0b3J5LFxuICBkZWZhdWx0SXRlcmFibGVEaWZmZXJzLFxuICBkZWZhdWx0S2V5VmFsdWVEaWZmZXJzLFxuICBkZXBzVHJhY2tlcixcbiAgZGVzdHJveVBsYXRmb3JtLFxuICBkZXZNb2RlRXF1YWwsXG4gIGRpc2FibGVQcm9maWxpbmcsXG4gIGVmZmVjdCxcbiAgZW5hYmxlUHJvZE1vZGUsXG4gIGVuYWJsZVByb2ZpbGluZyxcbiAgZW5hYmxlUHJvZmlsaW5nMixcbiAgZW5jYXBzdWxhdGVSZXNvdXJjZUVycm9yLFxuICBmaW5kTG9jYWxlRGF0YSxcbiAgZmx1c2hNb2R1bGVTY29waW5nUXVldWVBc011Y2hBc1Bvc3NpYmxlLFxuICBmb3JtYXRSdW50aW1lRXJyb3IsXG4gIGZvcndhcmRSZWYsXG4gIGdlbmVyYXRlU3RhbmRhbG9uZUluRGVjbGFyYXRpb25zRXJyb3IsXG4gIGdldEFzeW5jQ2xhc3NNZXRhZGF0YUZuLFxuICBnZXRDbG9zZXN0Q29tcG9uZW50TmFtZSxcbiAgZ2V0Q29tcG9uZW50RGVmLFxuICBnZXREZWJ1Z05vZGUsXG4gIGdldERlZmVyQmxvY2tzJDEsXG4gIGdldERpcmVjdGl2ZXMsXG4gIGdldERvY3VtZW50LFxuICBnZXRIb3N0RWxlbWVudCxcbiAgZ2V0SW5qZWN0YWJsZURlZixcbiAgZ2V0TENvbnRleHQsXG4gIGdldExvY2FsZUN1cnJlbmN5Q29kZSxcbiAgZ2V0TG9jYWxlUGx1cmFsQ2FzZSxcbiAgZ2V0TW9kdWxlRmFjdG9yeSxcbiAgZ2V0TmdNb2R1bGVCeUlkLFxuICBnZXRPdXRwdXREZXN0cm95UmVmLFxuICBnZXRQbGF0Zm9ybSxcbiAgZ2V0U2FuaXRpemF0aW9uQnlwYXNzVHlwZSxcbiAgZ2V0VHJhbnNmZXJTdGF0ZSxcbiAgaW1wb3J0UHJvdmlkZXJzRnJvbSxcbiAgaW5mZXJUYWdOYW1lRnJvbURlZmluaXRpb24sXG4gIGluamVjdCxcbiAgaW5qZWN0Q2hhbmdlRGV0ZWN0b3JSZWYsXG4gIGlucHV0LFxuICBpbnB1dEJpbmRpbmcsXG4gIGludGVybmFsQ3JlYXRlQXBwbGljYXRpb24sXG4gIGludGVybmFsUHJvdmlkZVpvbmVDaGFuZ2VEZXRlY3Rpb24sXG4gIGlzQm91bmRUb01vZHVsZSxcbiAgaXNDb21wb25lbnREZWZQZW5kaW5nUmVzb2x1dGlvbixcbiAgaXNEZXZNb2RlLFxuICBpc0Vudmlyb25tZW50UHJvdmlkZXJzLFxuICBpc0luamVjdGFibGUsXG4gIGlzTmdNb2R1bGUsXG4gIGlzUHJvbWlzZSxcbiAgaXNTaWduYWwsXG4gIGlzU3RhbmRhbG9uZSxcbiAgaXNTdWJzY3JpYmFibGUsXG4gIGlzVmlld0RpcnR5LFxuICBpc1dyaXRhYmxlU2lnbmFsLFxuICBsaW5rZWRTaWduYWwsXG4gIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyxcbiAgbWFrZVN0YXRlS2V5LFxuICBtYXJrRm9yUmVmcmVzaCxcbiAgbWVyZ2VBcHBsaWNhdGlvbkNvbmZpZyxcbiAgbW9kZWwsXG4gIG5vU2lkZUVmZmVjdHMsXG4gIG51bWJlckF0dHJpYnV0ZSxcbiAgb3V0cHV0LFxuICBvdXRwdXRCaW5kaW5nLFxuICBwYXRjaENvbXBvbmVudERlZldpdGhTY29wZSxcbiAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSxcbiAgcGxhdGZvcm1Db3JlLFxuICBwcm9taXNlV2l0aFJlc29sdmVycyxcbiAgcHJvdmlkZUFwcEluaXRpYWxpemVyLFxuICBwcm92aWRlQnJvd3Nlckdsb2JhbEVycm9yTGlzdGVuZXJzLFxuICBwcm92aWRlQ2hlY2tOb0NoYW5nZXNDb25maWcsXG4gIHByb3ZpZGVFbnZpcm9ubWVudEluaXRpYWxpemVyLFxuICBwcm92aWRlTmdSZWZsZWN0QXR0cmlidXRlcyxcbiAgcHJvdmlkZVBsYXRmb3JtSW5pdGlhbGl6ZXIsXG4gIHByb3ZpZGVTdGFiaWxpdHlEZWJ1Z2dpbmcsXG4gIHByb3ZpZGVab25lQ2hhbmdlRGV0ZWN0aW9uLFxuICBwcm92aWRlWm9uZWxlc3NDaGFuZ2VEZXRlY3Rpb24sXG4gIHByb3ZpZGVab25lbGVzc0NoYW5nZURldGVjdGlvbkludGVybmFsLFxuICBwdWJsaXNoRXh0ZXJuYWxHbG9iYWxVdGlsLFxuICByZWFkSHlkcmF0aW9uSW5mbyxcbiAgcmVmbGVjdENvbXBvbmVudFR5cGUsXG4gIHJlZ2lzdGVyTG9jYWxlRGF0YSxcbiAgcmVnaXN0ZXJOZ01vZHVsZVR5cGUsXG4gIHJlbmRlckRlZmVyQmxvY2tTdGF0ZSxcbiAgcmVzZXRDb21waWxlZENvbXBvbmVudHMsXG4gIHJlc2V0SW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkV2FybmVkRm9yVGVzdHMsXG4gIHJlc2V0Sml0T3B0aW9ucyxcbiAgcmVzb2x2ZUNvbXBvbmVudFJlc291cmNlcyxcbiAgcmVzb2x2ZUZvcndhcmRSZWYsXG4gIHJlc291cmNlLFxuICByZXN0b3JlQ29tcG9uZW50UmVzb2x1dGlvblF1ZXVlLFxuICBydW5JbkluamVjdGlvbkNvbnRleHQsXG4gIHNldEFsbG93RHVwbGljYXRlTmdNb2R1bGVJZHNGb3JUZXN0LFxuICBzZXRBbHRlcm5hdGVXZWFrUmVmSW1wbCxcbiAgc2V0Q2xhc3NNZXRhZGF0YSxcbiAgc2V0Q2xhc3NNZXRhZGF0YUFzeW5jLFxuICBzZXRDdXJyZW50SW5qZWN0b3IsXG4gIHNldERvY3VtZW50LFxuICBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCxcbiAgc2V0TG9jYWxlSWQsXG4gIHNldFRlc3RhYmlsaXR5R2V0dGVyLFxuICBzaWduYWwsXG4gIHN0YXJ0TWVhc3VyaW5nLFxuICBzdG9wTWVhc3VyaW5nLFxuICBzdG9yZSxcbiAgc3RyaW5naWZ5LFxuICB0cmFuc2l0aXZlU2NvcGVzRm9yLFxuICB0cmlnZ2VyUmVzb3VyY2VMb2FkaW5nLFxuICB0cnVuY2F0ZU1pZGRsZSxcbiAgdHdvV2F5QmluZGluZyxcbiAgdW5yZWdpc3RlckFsbExvY2FsZURhdGEsXG4gIHVudHJhY2tlZCxcbiAgdW53cmFwU2FmZVZhbHVlLFxuICB2aWV3Q2hpbGQsXG4gIHZpZXdDaGlsZHJlbixcbiAgd2l0aERvbUh5ZHJhdGlvbixcbiAgd2l0aEV2ZW50UmVwbGF5LFxuICB3aXRoSTE4blN1cHBvcnQsXG4gIHdpdGhJbmNyZW1lbnRhbEh5ZHJhdGlvbixcbiAgybVDT05UUk9MLFxuICDJtUlOUFVUX1NJR05BTF9CUkFORF9XUklURV9UWVBFLFxuICDJtWFzc2VydFR5cGUsXG4gIMm1Y29udHJvbFVwZGF0ZSxcbiAgybVnZXRVbmtub3duRWxlbWVudFN0cmljdE1vZGUsXG4gIMm1Z2V0VW5rbm93blByb3BlcnR5U3RyaWN0TW9kZSxcbiAgybVzZXRDbGFzc0RlYnVnSW5mbyxcbiAgybVzZXRVbmtub3duRWxlbWVudFN0cmljdE1vZGUsXG4gIMm1c2V0VW5rbm93blByb3BlcnR5U3RyaWN0TW9kZSxcbiAgybV1bndyYXBXcml0YWJsZVNpZ25hbCxcbiAgybXJtUV4dGVybmFsU3R5bGVzRmVhdHVyZSxcbiAgybXJtUhvc3REaXJlY3RpdmVzRmVhdHVyZSxcbiAgybXJtUluaGVyaXREZWZpbml0aW9uRmVhdHVyZSxcbiAgybXJtU5nT25DaGFuZ2VzRmVhdHVyZSxcbiAgybXJtVByb3ZpZGVyc0ZlYXR1cmUsXG4gIMm1ybVhZHZhbmNlLFxuICDJtcm1YW5pbWF0ZUVudGVyLFxuICDJtcm1YW5pbWF0ZUVudGVyTGlzdGVuZXIsXG4gIMm1ybVhbmltYXRlTGVhdmUsXG4gIMm1ybVhbmltYXRlTGVhdmVMaXN0ZW5lcixcbiAgybXJtWFyaWFQcm9wZXJ0eSxcbiAgybXJtWF0dGFjaFNvdXJjZUxvY2F0aW9ucyxcbiAgybXJtWF0dHJpYnV0ZSxcbiAgybXJtWNsYXNzTWFwLFxuICDJtcm1Y2xhc3NQcm9wLFxuICDJtcm1Y29tcG9uZW50SW5zdGFuY2UsXG4gIMm1ybVjb25kaXRpb25hbCxcbiAgybXJtWNvbmRpdGlvbmFsQnJhbmNoQ3JlYXRlLFxuICDJtcm1Y29uZGl0aW9uYWxDcmVhdGUsXG4gIMm1ybVjb250ZW50UXVlcnksXG4gIMm1ybVjb250ZW50UXVlcnlTaWduYWwsXG4gIMm1ybVjb250cm9sLFxuICDJtcm1Y29udHJvbENyZWF0ZSxcbiAgybXJtWRlY2xhcmVMZXQsXG4gIMm1ybVkZWZlcixcbiAgybXJtWRlZmVyRW5hYmxlVGltZXJTY2hlZHVsaW5nLFxuICDJtcm1ZGVmZXJIeWRyYXRlTmV2ZXIsXG4gIMm1ybVkZWZlckh5ZHJhdGVPbkhvdmVyLFxuICDJtcm1ZGVmZXJIeWRyYXRlT25JZGxlLFxuICDJtcm1ZGVmZXJIeWRyYXRlT25JbW1lZGlhdGUsXG4gIMm1ybVkZWZlckh5ZHJhdGVPbkludGVyYWN0aW9uLFxuICDJtcm1ZGVmZXJIeWRyYXRlT25UaW1lcixcbiAgybXJtWRlZmVySHlkcmF0ZU9uVmlld3BvcnQsXG4gIMm1ybVkZWZlckh5ZHJhdGVXaGVuLFxuICDJtcm1ZGVmZXJPbkhvdmVyLFxuICDJtcm1ZGVmZXJPbklkbGUsXG4gIMm1ybVkZWZlck9uSW1tZWRpYXRlLFxuICDJtcm1ZGVmZXJPbkludGVyYWN0aW9uLFxuICDJtcm1ZGVmZXJPblRpbWVyLFxuICDJtcm1ZGVmZXJPblZpZXdwb3J0LFxuICDJtcm1ZGVmZXJQcmVmZXRjaE9uSG92ZXIsXG4gIMm1ybVkZWZlclByZWZldGNoT25JZGxlLFxuICDJtcm1ZGVmZXJQcmVmZXRjaE9uSW1tZWRpYXRlLFxuICDJtcm1ZGVmZXJQcmVmZXRjaE9uSW50ZXJhY3Rpb24sXG4gIMm1ybVkZWZlclByZWZldGNoT25UaW1lcixcbiAgybXJtWRlZmVyUHJlZmV0Y2hPblZpZXdwb3J0LFxuICDJtcm1ZGVmZXJQcmVmZXRjaFdoZW4sXG4gIMm1ybVkZWZlcldoZW4sXG4gIMm1ybVkZWZpbmVDb21wb25lbnQsXG4gIMm1ybVkZWZpbmVEaXJlY3RpdmUsXG4gIMm1ybVkZWZpbmVJbmplY3RhYmxlLFxuICDJtcm1ZGVmaW5lSW5qZWN0b3IsXG4gIMm1ybVkZWZpbmVOZ01vZHVsZSxcbiAgybXJtWRlZmluZVBpcGUsXG4gIMm1ybVkaXJlY3RpdmVJbmplY3QsXG4gIMm1ybVkaXNhYmxlQmluZGluZ3MsXG4gIMm1ybVkb21FbGVtZW50LFxuICDJtcm1ZG9tRWxlbWVudENvbnRhaW5lcixcbiAgybXJtWRvbUVsZW1lbnRDb250YWluZXJFbmQsXG4gIMm1ybVkb21FbGVtZW50Q29udGFpbmVyU3RhcnQsXG4gIMm1ybVkb21FbGVtZW50RW5kLFxuICDJtcm1ZG9tRWxlbWVudFN0YXJ0LFxuICDJtcm1ZG9tTGlzdGVuZXIsXG4gIMm1ybVkb21Qcm9wZXJ0eSxcbiAgybXJtWRvbVRlbXBsYXRlLFxuICDJtcm1ZWxlbWVudCxcbiAgybXJtWVsZW1lbnRDb250YWluZXIsXG4gIMm1ybVlbGVtZW50Q29udGFpbmVyRW5kLFxuICDJtcm1ZWxlbWVudENvbnRhaW5lclN0YXJ0LFxuICDJtcm1ZWxlbWVudEVuZCxcbiAgybXJtWVsZW1lbnRTdGFydCxcbiAgybXJtWVuYWJsZUJpbmRpbmdzLFxuICDJtcm1Z2V0Q29tcG9uZW50RGVwc0ZhY3RvcnksXG4gIMm1ybVnZXRDdXJyZW50VmlldyxcbiAgybXJtWdldEluaGVyaXRlZEZhY3RvcnksXG4gIMm1ybVnZXRSZXBsYWNlTWV0YWRhdGFVUkwsXG4gIMm1ybVpMThuLFxuICDJtcm1aTE4bkFwcGx5LFxuICDJtcm1aTE4bkF0dHJpYnV0ZXMsXG4gIMm1ybVpMThuRW5kLFxuICDJtcm1aTE4bkV4cCxcbiAgybXJtWkxOG5Qb3N0cHJvY2VzcyxcbiAgybXJtWkxOG5TdGFydCxcbiAgybXJtWluamVjdCxcbiAgybXJtWluamVjdEF0dHJpYnV0ZSxcbiAgybXJtWludGVycG9sYXRlLFxuICDJtcm1aW50ZXJwb2xhdGUxLFxuICDJtcm1aW50ZXJwb2xhdGUyLFxuICDJtcm1aW50ZXJwb2xhdGUzLFxuICDJtcm1aW50ZXJwb2xhdGU0LFxuICDJtcm1aW50ZXJwb2xhdGU1LFxuICDJtcm1aW50ZXJwb2xhdGU2LFxuICDJtcm1aW50ZXJwb2xhdGU3LFxuICDJtcm1aW50ZXJwb2xhdGU4LFxuICDJtcm1aW50ZXJwb2xhdGVWLFxuICDJtcm1aW52YWxpZEZhY3RvcnksXG4gIMm1ybVpbnZhbGlkRmFjdG9yeURlcCxcbiAgybXJtWxpc3RlbmVyLFxuICDJtcm1bG9hZFF1ZXJ5LFxuICDJtcm1bmFtZXNwYWNlSFRNTCxcbiAgybXJtW5hbWVzcGFjZU1hdGhNTCxcbiAgybXJtW5hbWVzcGFjZVNWRyxcbiAgybXJtW5leHRDb250ZXh0LFxuICDJtcm1bmdEZWNsYXJlQ2xhc3NNZXRhZGF0YSxcbiAgybXJtW5nRGVjbGFyZUNsYXNzTWV0YWRhdGFBc3luYyxcbiAgybXJtW5nRGVjbGFyZUNvbXBvbmVudCxcbiAgybXJtW5nRGVjbGFyZURpcmVjdGl2ZSxcbiAgybXJtW5nRGVjbGFyZUZhY3RvcnksXG4gIMm1ybVuZ0RlY2xhcmVJbmplY3RhYmxlLFxuICDJtcm1bmdEZWNsYXJlSW5qZWN0b3IsXG4gIMm1ybVuZ0RlY2xhcmVOZ01vZHVsZSxcbiAgybXJtW5nRGVjbGFyZVBpcGUsXG4gIMm1ybVwaXBlLFxuICDJtcm1cGlwZUJpbmQxLFxuICDJtcm1cGlwZUJpbmQyLFxuICDJtcm1cGlwZUJpbmQzLFxuICDJtcm1cGlwZUJpbmQ0LFxuICDJtcm1cGlwZUJpbmRWLFxuICDJtcm1cHJvamVjdGlvbixcbiAgybXJtXByb2plY3Rpb25EZWYsXG4gIMm1ybVwcm9wZXJ0eSxcbiAgybXJtXB1cmVGdW5jdGlvbjAsXG4gIMm1ybVwdXJlRnVuY3Rpb24xLFxuICDJtcm1cHVyZUZ1bmN0aW9uMixcbiAgybXJtXB1cmVGdW5jdGlvbjMsXG4gIMm1ybVwdXJlRnVuY3Rpb240LFxuICDJtcm1cHVyZUZ1bmN0aW9uNSxcbiAgybXJtXB1cmVGdW5jdGlvbjYsXG4gIMm1ybVwdXJlRnVuY3Rpb243LFxuICDJtcm1cHVyZUZ1bmN0aW9uOCxcbiAgybXJtXB1cmVGdW5jdGlvblYsXG4gIMm1ybVxdWVyeUFkdmFuY2UsXG4gIMm1ybVxdWVyeVJlZnJlc2gsXG4gIMm1ybVyZWFkQ29udGV4dExldCxcbiAgybXJtXJlZmVyZW5jZSxcbiAgybXJtXJlcGVhdGVyLFxuICDJtcm1cmVwZWF0ZXJDcmVhdGUsXG4gIMm1ybVyZXBlYXRlclRyYWNrQnlJZGVudGl0eSxcbiAgybXJtXJlcGVhdGVyVHJhY2tCeUluZGV4LFxuICDJtcm1cmVwbGFjZU1ldGFkYXRhLFxuICDJtcm1cmVzZXRWaWV3LFxuICDJtcm1cmVzb2x2ZUJvZHksXG4gIMm1ybVyZXNvbHZlRG9jdW1lbnQsXG4gIMm1ybVyZXNvbHZlV2luZG93LFxuICDJtcm1cmVzdG9yZVZpZXcsXG4gIMm1ybVzYW5pdGl6ZUh0bWwsXG4gIMm1ybVzYW5pdGl6ZVJlc291cmNlVXJsLFxuICDJtcm1c2FuaXRpemVTY3JpcHQsXG4gIMm1ybVzYW5pdGl6ZVN0eWxlLFxuICDJtcm1c2FuaXRpemVVcmwsXG4gIMm1ybVzYW5pdGl6ZVVybE9yUmVzb3VyY2VVcmwsXG4gIMm1ybVzZXRDb21wb25lbnRTY29wZSxcbiAgybXJtXNldE5nTW9kdWxlU2NvcGUsXG4gIMm1ybVzdG9yZUxldCxcbiAgybXJtXN0eWxlTWFwLFxuICDJtcm1c3R5bGVQcm9wLFxuICDJtcm1c3ludGhldGljSG9zdExpc3RlbmVyLFxuICDJtcm1c3ludGhldGljSG9zdFByb3BlcnR5LFxuICDJtcm1dGVtcGxhdGUsXG4gIMm1ybV0ZW1wbGF0ZVJlZkV4dHJhY3RvcixcbiAgybXJtXRleHQsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGUsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGUxLFxuICDJtcm1dGV4dEludGVycG9sYXRlMixcbiAgybXJtXRleHRJbnRlcnBvbGF0ZTMsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGU0LFxuICDJtcm1dGV4dEludGVycG9sYXRlNSxcbiAgybXJtXRleHRJbnRlcnBvbGF0ZTYsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGU3LFxuICDJtcm1dGV4dEludGVycG9sYXRlOCxcbiAgybXJtXRleHRJbnRlcnBvbGF0ZVYsXG4gIMm1ybV0cnVzdENvbnN0YW50SHRtbCxcbiAgybXJtXRydXN0Q29uc3RhbnRSZXNvdXJjZVVybCxcbiAgybXJtXR3b1dheUJpbmRpbmdTZXQsXG4gIMm1ybV0d29XYXlMaXN0ZW5lcixcbiAgybXJtXR3b1dheVByb3BlcnR5LFxuICDJtcm1dmFsaWRhdGVBdHRyaWJ1dGUsXG4gIMm1ybV2aWV3UXVlcnksXG4gIMm1ybV2aWV3UXVlcnlTaWduYWxcbn0gZnJvbSBcIi9AZnMvQzovVXNlcnMvbW91cmEvRG9jdW1lbnRzL1NjYWZmb2xkL2Zyb250ZW5kLy5hbmd1bGFyL2NhY2hlLzIxLjEuMy9mcm9udGVuZC92aXRlL2RlcHMvY2h1bmstTEVIUlo3SUsuanM/dj1hM2VjOGM2YlwiO1xuZXhwb3J0IHtcbiAgQU5JTUFUSU9OX01PRFVMRV9UWVBFLFxuICBBUFBfQk9PVFNUUkFQX0xJU1RFTkVSLFxuICBBUFBfSUQsXG4gIEFQUF9JTklUSUFMSVpFUixcbiAgQXBwbGljYXRpb25Jbml0U3RhdHVzLFxuICBBcHBsaWNhdGlvbk1vZHVsZSxcbiAgQXBwbGljYXRpb25SZWYsXG4gIEF0dHJpYnV0ZSxcbiAgQ09NUElMRVJfT1BUSU9OUyxcbiAgQ1NQX05PTkNFLFxuICBDVVNUT01fRUxFTUVOVFNfU0NIRU1BLFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBpbGVyLFxuICBDb21waWxlckZhY3RvcnksXG4gIENvbXBvbmVudCxcbiAgQ29tcG9uZW50RmFjdG9yeSQxIGFzIENvbXBvbmVudEZhY3RvcnksXG4gIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciQxIGFzIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgQ29tcG9uZW50UmVmJDEgYXMgQ29tcG9uZW50UmVmLFxuICBDb250ZW50Q2hpbGQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgREVGQVVMVF9DVVJSRU5DWV9DT0RFLFxuICBET0NVTUVOVCxcbiAgRGVidWdFbGVtZW50LFxuICBEZWJ1Z0V2ZW50TGlzdGVuZXIsXG4gIERlYnVnTm9kZSxcbiAgRGVmYXVsdEl0ZXJhYmxlRGlmZmVyLFxuICBEZXN0cm95UmVmLFxuICBEaXJlY3RpdmUsXG4gIEVOVklST05NRU5UX0lOSVRJQUxJWkVSLFxuICBFbGVtZW50UmVmLFxuICBFbWJlZGRlZFZpZXdSZWYsXG4gIEVudmlyb25tZW50SW5qZWN0b3IsXG4gIEVycm9ySGFuZGxlcixcbiAgRXZlbnRFbWl0dGVyLFxuICBIT1NUX1RBR19OQU1FLFxuICBIb3N0LFxuICBIb3N0QXR0cmlidXRlVG9rZW4sXG4gIEhvc3RCaW5kaW5nLFxuICBIb3N0TGlzdGVuZXIsXG4gIElOSkVDVE9SJDEgYXMgSU5KRUNUT1IsXG4gIEluamVjdCxcbiAgSW5qZWN0YWJsZSxcbiAgSW5qZWN0aW9uVG9rZW4sXG4gIEluamVjdG9yLFxuICBJbnB1dCxcbiAgSXRlcmFibGVEaWZmZXJzLFxuICBLZXlWYWx1ZURpZmZlcnMsXG4gIExPQ0FMRV9JRCxcbiAgTUFYX0FOSU1BVElPTl9USU1FT1VULFxuICBNaXNzaW5nVHJhbnNsYXRpb25TdHJhdGVneSxcbiAgTW9kdWxlV2l0aENvbXBvbmVudEZhY3RvcmllcyxcbiAgTk9fRVJST1JTX1NDSEVNQSxcbiAgTmdNb2R1bGUsXG4gIE5nTW9kdWxlRmFjdG9yeSQxIGFzIE5nTW9kdWxlRmFjdG9yeSxcbiAgTmdNb2R1bGVSZWYkMSBhcyBOZ01vZHVsZVJlZixcbiAgTmdab25lLFxuICBPcHRpb25hbCxcbiAgT3V0cHV0LFxuICBPdXRwdXRFbWl0dGVyUmVmLFxuICBQTEFURk9STV9JRCxcbiAgUExBVEZPUk1fSU5JVElBTElaRVIsXG4gIFBlbmRpbmdUYXNrcyxcbiAgUGlwZSxcbiAgUGxhdGZvcm1SZWYsXG4gIFF1ZXJ5LFxuICBRdWVyeUxpc3QsXG4gIFJFUVVFU1QsXG4gIFJFUVVFU1RfQ09OVEVYVCxcbiAgUkVTUE9OU0VfSU5JVCxcbiAgUmVuZGVyZXIyLFxuICBSZW5kZXJlckZhY3RvcnkyLFxuICBSZW5kZXJlclN0eWxlRmxhZ3MyLFxuICBTYW5pdGl6ZXIsXG4gIFNlY3VyaXR5Q29udGV4dCxcbiAgU2VsZixcbiAgU2ltcGxlQ2hhbmdlLFxuICBTa2lwU2VsZixcbiAgVFJBTlNMQVRJT05TLFxuICBUUkFOU0xBVElPTlNfRk9STUFULFxuICBUZW1wbGF0ZVJlZixcbiAgVGVzdGFiaWxpdHksXG4gIFRlc3RhYmlsaXR5UmVnaXN0cnksXG4gIFRyYW5zZmVyU3RhdGUsXG4gIFR5cGUsXG4gIFZFUlNJT04sXG4gIFZlcnNpb24sXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NoaWxkcmVuLFxuICBWaWV3Q29udGFpbmVyUmVmLFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgVmlld1JlZjIgYXMgVmlld1JlZixcbiAgYWZ0ZXJFdmVyeVJlbmRlcixcbiAgYWZ0ZXJOZXh0UmVuZGVyLFxuICBhZnRlclJlbmRlckVmZmVjdCxcbiAgYXNOYXRpdmVFbGVtZW50cyxcbiAgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0LFxuICBhc3NlcnROb3RJblJlYWN0aXZlQ29udGV4dCxcbiAgYXNzZXJ0UGxhdGZvcm0sXG4gIGJvb2xlYW5BdHRyaWJ1dGUsXG4gIGNvbXB1dGVkLFxuICBjb250ZW50Q2hpbGQsXG4gIGNvbnRlbnRDaGlsZHJlbixcbiAgY3JlYXRlQ29tcG9uZW50LFxuICBjcmVhdGVFbnZpcm9ubWVudEluamVjdG9yLFxuICBjcmVhdGVOZ01vZHVsZSxcbiAgY3JlYXRlTmdNb2R1bGVSZWYsXG4gIGNyZWF0ZVBsYXRmb3JtLFxuICBjcmVhdGVQbGF0Zm9ybUZhY3RvcnksXG4gIGRlc3Ryb3lQbGF0Zm9ybSxcbiAgZWZmZWN0LFxuICBlbmFibGVQcm9kTW9kZSxcbiAgZW5hYmxlUHJvZmlsaW5nLFxuICBmb3J3YXJkUmVmLFxuICBnZXREZWJ1Z05vZGUsXG4gIGdldE1vZHVsZUZhY3RvcnksXG4gIGdldE5nTW9kdWxlQnlJZCxcbiAgZ2V0UGxhdGZvcm0sXG4gIGltcG9ydFByb3ZpZGVyc0Zyb20sXG4gIGluamVjdCxcbiAgaW5wdXQsXG4gIGlucHV0QmluZGluZyxcbiAgaXNEZXZNb2RlLFxuICBpc1NpZ25hbCxcbiAgaXNTdGFuZGFsb25lLFxuICBpc1dyaXRhYmxlU2lnbmFsLFxuICBsaW5rZWRTaWduYWwsXG4gIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyxcbiAgbWFrZVN0YXRlS2V5LFxuICBtZXJnZUFwcGxpY2F0aW9uQ29uZmlnLFxuICBtb2RlbCxcbiAgbnVtYmVyQXR0cmlidXRlLFxuICBvdXRwdXQsXG4gIG91dHB1dEJpbmRpbmcsXG4gIHBsYXRmb3JtQ29yZSxcbiAgcHJvdmlkZUFwcEluaXRpYWxpemVyLFxuICBwcm92aWRlQnJvd3Nlckdsb2JhbEVycm9yTGlzdGVuZXJzLFxuICBwcm92aWRlQ2hlY2tOb0NoYW5nZXNDb25maWcsXG4gIHByb3ZpZGVFbnZpcm9ubWVudEluaXRpYWxpemVyLFxuICBwcm92aWRlTmdSZWZsZWN0QXR0cmlidXRlcyxcbiAgcHJvdmlkZVBsYXRmb3JtSW5pdGlhbGl6ZXIsXG4gIHByb3ZpZGVTdGFiaWxpdHlEZWJ1Z2dpbmcsXG4gIHByb3ZpZGVab25lQ2hhbmdlRGV0ZWN0aW9uLFxuICBwcm92aWRlWm9uZWxlc3NDaGFuZ2VEZXRlY3Rpb24sXG4gIHJlZmxlY3RDb21wb25lbnRUeXBlLFxuICByZXNvbHZlRm9yd2FyZFJlZixcbiAgcmVzb3VyY2UsXG4gIHJ1bkluSW5qZWN0aW9uQ29udGV4dCxcbiAgc2V0VGVzdGFiaWxpdHlHZXR0ZXIsXG4gIHNpZ25hbCxcbiAgdHdvV2F5QmluZGluZyxcbiAgdW50cmFja2VkLFxuICB2aWV3Q2hpbGQsXG4gIHZpZXdDaGlsZHJlbixcbiAgQU5JTUFUSU9OU19ESVNBQkxFRCBhcyDJtUFOSU1BVElPTlNfRElTQUJMRUQsXG4gIEFjeENoYW5nZURldGVjdGlvblN0cmF0ZWd5IGFzIMm1QWN4Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIEFjeFZpZXdFbmNhcHN1bGF0aW9uIGFzIMm1QWN4Vmlld0VuY2Fwc3VsYXRpb24sXG4gIEFmdGVyUmVuZGVyTWFuYWdlciBhcyDJtUFmdGVyUmVuZGVyTWFuYWdlcixcbiAgQ0xJRU5UX1JFTkRFUl9NT0RFX0ZMQUcgYXMgybVDTElFTlRfUkVOREVSX01PREVfRkxBRyxcbiAgQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQgYXMgybVDT05UQUlORVJfSEVBREVSX09GRlNFVCxcbiAgybVDT05UUk9MLFxuICBDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIgYXMgybVDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIsXG4gIENvbXBvbmVudEZhY3RvcnkkMSBhcyDJtUNvbXBvbmVudEZhY3RvcnksXG4gIENvbnNvbGUgYXMgybVDb25zb2xlLFxuICBERUZBVUxUX0xPQ0FMRV9JRCBhcyDJtURFRkFVTFRfTE9DQUxFX0lELFxuICBERUZFUl9CTE9DS19DT05GSUcgYXMgybVERUZFUl9CTE9DS19DT05GSUcsXG4gIERFRkVSX0JMT0NLX0RFUEVOREVOQ1lfSU5URVJDRVBUT1IgYXMgybVERUZFUl9CTE9DS19ERVBFTkRFTkNZX0lOVEVSQ0VQVE9SLFxuICBERUhZRFJBVEVEX0JMT0NLX1JFR0lTVFJZIGFzIMm1REVIWURSQVRFRF9CTE9DS19SRUdJU1RSWSxcbiAgRGVmZXJCbG9ja0JlaGF2aW9yIGFzIMm1RGVmZXJCbG9ja0JlaGF2aW9yLFxuICBEZWZlckJsb2NrU3RhdGUgYXMgybVEZWZlckJsb2NrU3RhdGUsXG4gIEVOQUJMRV9ST09UX0NPTVBPTkVOVF9CT09UU1RSQVAgYXMgybVFTkFCTEVfUk9PVF9DT01QT05FTlRfQk9PVFNUUkFQLFxuICBFVkVOVF9SRVBMQVlfUVVFVUUgYXMgybVFVkVOVF9SRVBMQVlfUVVFVUUsXG4gIEVmZmVjdFNjaGVkdWxlciBhcyDJtUVmZmVjdFNjaGVkdWxlcixcbiAgRnJhbWV3b3JrIGFzIMm1RnJhbWV3b3JrLFxuICBIeWRyYXRpb25TdGF0dXMgYXMgybVIeWRyYXRpb25TdGF0dXMsXG4gIElNQUdFX0NPTkZJRyBhcyDJtUlNQUdFX0NPTkZJRyxcbiAgSU1BR0VfQ09ORklHX0RFRkFVTFRTIGFzIMm1SU1BR0VfQ09ORklHX0RFRkFVTFRTLFxuICBJTkpFQ1RPUl9TQ09QRSBhcyDJtUlOSkVDVE9SX1NDT1BFLFxuICDJtUlOUFVUX1NJR05BTF9CUkFORF9XUklURV9UWVBFLFxuICBJTlRFUk5BTF9BUFBMSUNBVElPTl9FUlJPUl9IQU5ETEVSIGFzIMm1SU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUixcbiAgSVNfRU5BQkxFRF9CTE9DS0lOR19JTklUSUFMX05BVklHQVRJT04gYXMgybVJU19FTkFCTEVEX0JMT0NLSU5HX0lOSVRJQUxfTkFWSUdBVElPTixcbiAgSVNfSFlEUkFUSU9OX0RPTV9SRVVTRV9FTkFCTEVEIGFzIMm1SVNfSFlEUkFUSU9OX0RPTV9SRVVTRV9FTkFCTEVELFxuICBJU19JTkNSRU1FTlRBTF9IWURSQVRJT05fRU5BQkxFRCBhcyDJtUlTX0lOQ1JFTUVOVEFMX0hZRFJBVElPTl9FTkFCTEVELFxuICBKU0FDVElPTl9CTE9DS19FTEVNRU5UX01BUCBhcyDJtUpTQUNUSU9OX0JMT0NLX0VMRU1FTlRfTUFQLFxuICBKU0FDVElPTl9FVkVOVF9DT05UUkFDVCBhcyDJtUpTQUNUSU9OX0VWRU5UX0NPTlRSQUNULFxuICBMQ29udGV4dCBhcyDJtUxDb250ZXh0LFxuICBMb2NhbGVEYXRhSW5kZXggYXMgybVMb2NhbGVEYXRhSW5kZXgsXG4gIE5HX0NPTVBfREVGIGFzIMm1TkdfQ09NUF9ERUYsXG4gIE5HX0RJUl9ERUYgYXMgybVOR19ESVJfREVGLFxuICBOR19FTEVNRU5UX0lEIGFzIMm1TkdfRUxFTUVOVF9JRCxcbiAgTkdfSU5KX0RFRiBhcyDJtU5HX0lOSl9ERUYsXG4gIE5HX01PRF9ERUYgYXMgybVOR19NT0RfREVGLFxuICBOR19QSVBFX0RFRiBhcyDJtU5HX1BJUEVfREVGLFxuICBOR19QUk9WX0RFRiBhcyDJtU5HX1BST1ZfREVGLFxuICBOT1RfRk9VTkRfQ0hFQ0tfT05MWV9FTEVNRU5UX0lOSkVDVE9SIGFzIMm1Tk9UX0ZPVU5EX0NIRUNLX09OTFlfRUxFTUVOVF9JTkpFQ1RPUixcbiAgTk9fQ0hBTkdFIGFzIMm1Tk9fQ0hBTkdFLFxuICBOZ01vZHVsZUZhY3RvcnkgYXMgybVOZ01vZHVsZUZhY3RvcnksXG4gIE5vb3BOZ1pvbmUgYXMgybVOb29wTmdab25lLFxuICBQRVJGT1JNQU5DRV9NQVJLX1BSRUZJWCBhcyDJtVBFUkZPUk1BTkNFX01BUktfUFJFRklYLFxuICBQUk9WSURFRF9OR19aT05FIGFzIMm1UFJPVklERURfTkdfWk9ORSxcbiAgUFJPVklERURfWk9ORUxFU1MgYXMgybVQUk9WSURFRF9aT05FTEVTUyxcbiAgUGVuZGluZ1Rhc2tzSW50ZXJuYWwgYXMgybVQZW5kaW5nVGFza3NJbnRlcm5hbCxcbiAgUHJvZmlsZXJFdmVudCBhcyDJtVByb2ZpbGVyRXZlbnQsXG4gIFIzSW5qZWN0b3IgYXMgybVSM0luamVjdG9yLFxuICBSZWZsZWN0aW9uQ2FwYWJpbGl0aWVzIGFzIMm1UmVmbGVjdGlvbkNhcGFiaWxpdGllcyxcbiAgQ29tcG9uZW50RmFjdG9yeSBhcyDJtVJlbmRlcjNDb21wb25lbnRGYWN0b3J5LFxuICBDb21wb25lbnRSZWYgYXMgybVSZW5kZXIzQ29tcG9uZW50UmVmLFxuICBOZ01vZHVsZVJlZiBhcyDJtVJlbmRlcjNOZ01vZHVsZVJlZixcbiAgUmVzb3VyY2VJbXBsIGFzIMm1UmVzb3VyY2VJbXBsLFxuICBSdW50aW1lRXJyb3IgYXMgybVSdW50aW1lRXJyb3IsXG4gIFNJR05BTCBhcyDJtVNJR05BTCxcbiAgU1NSX0NPTlRFTlRfSU5URUdSSVRZX01BUktFUiBhcyDJtVNTUl9DT05URU5UX0lOVEVHUklUWV9NQVJLRVIsXG4gIFRFU1RBQklMSVRZIGFzIMm1VEVTVEFCSUxJVFksXG4gIFRFU1RBQklMSVRZX0dFVFRFUiBhcyDJtVRFU1RBQklMSVRZX0dFVFRFUixcbiAgVGltZXJTY2hlZHVsZXIgYXMgybVUaW1lclNjaGVkdWxlcixcbiAgVHJhY2luZ0FjdGlvbiBhcyDJtVRyYWNpbmdBY3Rpb24sXG4gIFRyYWNpbmdTZXJ2aWNlIGFzIMm1VHJhY2luZ1NlcnZpY2UsXG4gIFZpZXdSZWYgYXMgybVWaWV3UmVmLFxuICBYU1NfU0VDVVJJVFlfVVJMIGFzIMm1WFNTX1NFQ1VSSVRZX1VSTCxcbiAgWk9ORUxFU1NfRU5BQkxFRCBhcyDJtVpPTkVMRVNTX0VOQUJMRUQsXG4gIF9zYW5pdGl6ZUh0bWwgYXMgybVfc2FuaXRpemVIdG1sLFxuICBfc2FuaXRpemVVcmwgYXMgybVfc2FuaXRpemVVcmwsXG4gIGFsbExlYXZpbmdBbmltYXRpb25zIGFzIMm1YWxsTGVhdmluZ0FuaW1hdGlvbnMsXG4gIGFsbG93U2FuaXRpemF0aW9uQnlwYXNzQW5kVGhyb3cgYXMgybVhbGxvd1Nhbml0aXphdGlvbkJ5cGFzc0FuZFRocm93LFxuICBhbm5vdGF0ZUZvckh5ZHJhdGlvbiBhcyDJtWFubm90YXRlRm9ySHlkcmF0aW9uLFxuICDJtWFzc2VydFR5cGUsXG4gIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0SHRtbCBhcyDJtWJ5cGFzc1Nhbml0aXphdGlvblRydXN0SHRtbCxcbiAgYnlwYXNzU2FuaXRpemF0aW9uVHJ1c3RSZXNvdXJjZVVybCBhcyDJtWJ5cGFzc1Nhbml0aXphdGlvblRydXN0UmVzb3VyY2VVcmwsXG4gIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0U2NyaXB0IGFzIMm1YnlwYXNzU2FuaXRpemF0aW9uVHJ1c3RTY3JpcHQsXG4gIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0U3R5bGUgYXMgybVieXBhc3NTYW5pdGl6YXRpb25UcnVzdFN0eWxlLFxuICBieXBhc3NTYW5pdGl6YXRpb25UcnVzdFVybCBhcyDJtWJ5cGFzc1Nhbml0aXphdGlvblRydXN0VXJsLFxuICBjbGVhclJlc29sdXRpb25PZkNvbXBvbmVudFJlc291cmNlc1F1ZXVlIGFzIMm1Y2xlYXJSZXNvbHV0aW9uT2ZDb21wb25lbnRSZXNvdXJjZXNRdWV1ZSxcbiAgY29tcGlsZUNvbXBvbmVudCBhcyDJtWNvbXBpbGVDb21wb25lbnQsXG4gIGNvbXBpbGVEaXJlY3RpdmUgYXMgybVjb21waWxlRGlyZWN0aXZlLFxuICBjb21waWxlTmdNb2R1bGUgYXMgybVjb21waWxlTmdNb2R1bGUsXG4gIGNvbXBpbGVOZ01vZHVsZURlZnMgYXMgybVjb21waWxlTmdNb2R1bGVEZWZzLFxuICBjb21waWxlTmdNb2R1bGVGYWN0b3J5IGFzIMm1Y29tcGlsZU5nTW9kdWxlRmFjdG9yeSxcbiAgY29tcGlsZVBpcGUgYXMgybVjb21waWxlUGlwZSxcbiAgybVjb250cm9sVXBkYXRlLFxuICBjb252ZXJ0VG9CaXRGbGFncyBhcyDJtWNvbnZlcnRUb0JpdEZsYWdzLFxuICBjcmVhdGVJbmplY3RvciBhcyDJtWNyZWF0ZUluamVjdG9yLFxuICBjcmVhdGVPclJldXNlUGxhdGZvcm1JbmplY3RvciBhcyDJtWNyZWF0ZU9yUmV1c2VQbGF0Zm9ybUluamVjdG9yLFxuICBkZWZhdWx0SXRlcmFibGVEaWZmZXJzIGFzIMm1ZGVmYXVsdEl0ZXJhYmxlRGlmZmVycyxcbiAgZGVmYXVsdEtleVZhbHVlRGlmZmVycyBhcyDJtWRlZmF1bHRLZXlWYWx1ZURpZmZlcnMsXG4gIGRlcHNUcmFja2VyIGFzIMm1ZGVwc1RyYWNrZXIsXG4gIGRldk1vZGVFcXVhbCBhcyDJtWRldk1vZGVFcXVhbCxcbiAgZGlzYWJsZVByb2ZpbGluZyBhcyDJtWRpc2FibGVQcm9maWxpbmcsXG4gIGVuYWJsZVByb2ZpbGluZzIgYXMgybVlbmFibGVQcm9maWxpbmcsXG4gIGVuY2Fwc3VsYXRlUmVzb3VyY2VFcnJvciBhcyDJtWVuY2Fwc3VsYXRlUmVzb3VyY2VFcnJvcixcbiAgZmluZExvY2FsZURhdGEgYXMgybVmaW5kTG9jYWxlRGF0YSxcbiAgZmx1c2hNb2R1bGVTY29waW5nUXVldWVBc011Y2hBc1Bvc3NpYmxlIGFzIMm1Zmx1c2hNb2R1bGVTY29waW5nUXVldWVBc011Y2hBc1Bvc3NpYmxlLFxuICBmb3JtYXRSdW50aW1lRXJyb3IgYXMgybVmb3JtYXRSdW50aW1lRXJyb3IsXG4gIGdlbmVyYXRlU3RhbmRhbG9uZUluRGVjbGFyYXRpb25zRXJyb3IgYXMgybVnZW5lcmF0ZVN0YW5kYWxvbmVJbkRlY2xhcmF0aW9uc0Vycm9yLFxuICBnZXRBc3luY0NsYXNzTWV0YWRhdGFGbiBhcyDJtWdldEFzeW5jQ2xhc3NNZXRhZGF0YUZuLFxuICBnZXRDbG9zZXN0Q29tcG9uZW50TmFtZSBhcyDJtWdldENsb3Nlc3RDb21wb25lbnROYW1lLFxuICBnZXRDb21wb25lbnREZWYgYXMgybVnZXRDb21wb25lbnREZWYsXG4gIGdldERlYnVnTm9kZSBhcyDJtWdldERlYnVnTm9kZSxcbiAgZ2V0RGVmZXJCbG9ja3MkMSBhcyDJtWdldERlZmVyQmxvY2tzLFxuICBnZXREaXJlY3RpdmVzIGFzIMm1Z2V0RGlyZWN0aXZlcyxcbiAgZ2V0RG9jdW1lbnQgYXMgybVnZXREb2N1bWVudCxcbiAgZ2V0SG9zdEVsZW1lbnQgYXMgybVnZXRIb3N0RWxlbWVudCxcbiAgZ2V0SW5qZWN0YWJsZURlZiBhcyDJtWdldEluamVjdGFibGVEZWYsXG4gIGdldExDb250ZXh0IGFzIMm1Z2V0TENvbnRleHQsXG4gIGdldExvY2FsZUN1cnJlbmN5Q29kZSBhcyDJtWdldExvY2FsZUN1cnJlbmN5Q29kZSxcbiAgZ2V0TG9jYWxlUGx1cmFsQ2FzZSBhcyDJtWdldExvY2FsZVBsdXJhbENhc2UsXG4gIGdldE91dHB1dERlc3Ryb3lSZWYgYXMgybVnZXRPdXRwdXREZXN0cm95UmVmLFxuICBnZXRTYW5pdGl6YXRpb25CeXBhc3NUeXBlIGFzIMm1Z2V0U2FuaXRpemF0aW9uQnlwYXNzVHlwZSxcbiAgZ2V0VHJhbnNmZXJTdGF0ZSBhcyDJtWdldFRyYW5zZmVyU3RhdGUsXG4gIMm1Z2V0VW5rbm93bkVsZW1lbnRTdHJpY3RNb2RlLFxuICDJtWdldFVua25vd25Qcm9wZXJ0eVN0cmljdE1vZGUsXG4gIF9nbG9iYWwgYXMgybVnbG9iYWwsXG4gIGluZmVyVGFnTmFtZUZyb21EZWZpbml0aW9uIGFzIMm1aW5mZXJUYWdOYW1lRnJvbURlZmluaXRpb24sXG4gIGluamVjdENoYW5nZURldGVjdG9yUmVmIGFzIMm1aW5qZWN0Q2hhbmdlRGV0ZWN0b3JSZWYsXG4gIGludGVybmFsQ3JlYXRlQXBwbGljYXRpb24gYXMgybVpbnRlcm5hbENyZWF0ZUFwcGxpY2F0aW9uLFxuICBpbnRlcm5hbFByb3ZpZGVab25lQ2hhbmdlRGV0ZWN0aW9uIGFzIMm1aW50ZXJuYWxQcm92aWRlWm9uZUNoYW5nZURldGVjdGlvbixcbiAgaXNCb3VuZFRvTW9kdWxlIGFzIMm1aXNCb3VuZFRvTW9kdWxlLFxuICBpc0NvbXBvbmVudERlZlBlbmRpbmdSZXNvbHV0aW9uIGFzIMm1aXNDb21wb25lbnREZWZQZW5kaW5nUmVzb2x1dGlvbixcbiAgaXNFbnZpcm9ubWVudFByb3ZpZGVycyBhcyDJtWlzRW52aXJvbm1lbnRQcm92aWRlcnMsXG4gIGlzSW5qZWN0YWJsZSBhcyDJtWlzSW5qZWN0YWJsZSxcbiAgaXNOZ01vZHVsZSBhcyDJtWlzTmdNb2R1bGUsXG4gIGlzUHJvbWlzZSBhcyDJtWlzUHJvbWlzZSxcbiAgaXNTdWJzY3JpYmFibGUgYXMgybVpc1N1YnNjcmliYWJsZSxcbiAgaXNWaWV3RGlydHkgYXMgybVpc1ZpZXdEaXJ0eSxcbiAgbWFya0ZvclJlZnJlc2ggYXMgybVtYXJrRm9yUmVmcmVzaCxcbiAgbm9TaWRlRWZmZWN0cyBhcyDJtW5vU2lkZUVmZmVjdHMsXG4gIHBhdGNoQ29tcG9uZW50RGVmV2l0aFNjb3BlIGFzIMm1cGF0Y2hDb21wb25lbnREZWZXaXRoU2NvcGUsXG4gIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUgYXMgybVwZXJmb3JtYW5jZU1hcmtGZWF0dXJlLFxuICBwcm9taXNlV2l0aFJlc29sdmVycyBhcyDJtXByb21pc2VXaXRoUmVzb2x2ZXJzLFxuICBwcm92aWRlWm9uZWxlc3NDaGFuZ2VEZXRlY3Rpb25JbnRlcm5hbCBhcyDJtXByb3ZpZGVab25lbGVzc0NoYW5nZURldGVjdGlvbkludGVybmFsLFxuICBwdWJsaXNoRXh0ZXJuYWxHbG9iYWxVdGlsIGFzIMm1cHVibGlzaEV4dGVybmFsR2xvYmFsVXRpbCxcbiAgcmVhZEh5ZHJhdGlvbkluZm8gYXMgybVyZWFkSHlkcmF0aW9uSW5mbyxcbiAgcmVnaXN0ZXJMb2NhbGVEYXRhIGFzIMm1cmVnaXN0ZXJMb2NhbGVEYXRhLFxuICByZW5kZXJEZWZlckJsb2NrU3RhdGUgYXMgybVyZW5kZXJEZWZlckJsb2NrU3RhdGUsXG4gIHJlc2V0Q29tcGlsZWRDb21wb25lbnRzIGFzIMm1cmVzZXRDb21waWxlZENvbXBvbmVudHMsXG4gIHJlc2V0SW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkV2FybmVkRm9yVGVzdHMgYXMgybVyZXNldEluY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZFdhcm5lZEZvclRlc3RzLFxuICByZXNldEppdE9wdGlvbnMgYXMgybVyZXNldEppdE9wdGlvbnMsXG4gIHJlc29sdmVDb21wb25lbnRSZXNvdXJjZXMgYXMgybVyZXNvbHZlQ29tcG9uZW50UmVzb3VyY2VzLFxuICByZXN0b3JlQ29tcG9uZW50UmVzb2x1dGlvblF1ZXVlIGFzIMm1cmVzdG9yZUNvbXBvbmVudFJlc29sdXRpb25RdWV1ZSxcbiAgc2V0QWxsb3dEdXBsaWNhdGVOZ01vZHVsZUlkc0ZvclRlc3QgYXMgybVzZXRBbGxvd0R1cGxpY2F0ZU5nTW9kdWxlSWRzRm9yVGVzdCxcbiAgc2V0QWx0ZXJuYXRlV2Vha1JlZkltcGwgYXMgybVzZXRBbHRlcm5hdGVXZWFrUmVmSW1wbCxcbiAgybVzZXRDbGFzc0RlYnVnSW5mbyxcbiAgc2V0Q2xhc3NNZXRhZGF0YSBhcyDJtXNldENsYXNzTWV0YWRhdGEsXG4gIHNldENsYXNzTWV0YWRhdGFBc3luYyBhcyDJtXNldENsYXNzTWV0YWRhdGFBc3luYyxcbiAgc2V0Q3VycmVudEluamVjdG9yIGFzIMm1c2V0Q3VycmVudEluamVjdG9yLFxuICBzZXREb2N1bWVudCBhcyDJtXNldERvY3VtZW50LFxuICBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCBhcyDJtXNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0LFxuICBzZXRMb2NhbGVJZCBhcyDJtXNldExvY2FsZUlkLFxuICDJtXNldFVua25vd25FbGVtZW50U3RyaWN0TW9kZSxcbiAgybVzZXRVbmtub3duUHJvcGVydHlTdHJpY3RNb2RlLFxuICBzdGFydE1lYXN1cmluZyBhcyDJtXN0YXJ0TWVhc3VyaW5nLFxuICBzdG9wTWVhc3VyaW5nIGFzIMm1c3RvcE1lYXN1cmluZyxcbiAgc3RvcmUgYXMgybVzdG9yZSxcbiAgc3RyaW5naWZ5IGFzIMm1c3RyaW5naWZ5LFxuICB0cmFuc2l0aXZlU2NvcGVzRm9yIGFzIMm1dHJhbnNpdGl2ZVNjb3Blc0ZvcixcbiAgdHJpZ2dlclJlc291cmNlTG9hZGluZyBhcyDJtXRyaWdnZXJSZXNvdXJjZUxvYWRpbmcsXG4gIHRydW5jYXRlTWlkZGxlIGFzIMm1dHJ1bmNhdGVNaWRkbGUsXG4gIHVucmVnaXN0ZXJBbGxMb2NhbGVEYXRhIGFzIMm1dW5yZWdpc3RlckxvY2FsZURhdGEsXG4gIHVud3JhcFNhZmVWYWx1ZSBhcyDJtXVud3JhcFNhZmVWYWx1ZSxcbiAgybV1bndyYXBXcml0YWJsZVNpZ25hbCxcbiAgd2l0aERvbUh5ZHJhdGlvbiBhcyDJtXdpdGhEb21IeWRyYXRpb24sXG4gIHdpdGhFdmVudFJlcGxheSBhcyDJtXdpdGhFdmVudFJlcGxheSxcbiAgd2l0aEkxOG5TdXBwb3J0IGFzIMm1d2l0aEkxOG5TdXBwb3J0LFxuICB3aXRoSW5jcmVtZW50YWxIeWRyYXRpb24gYXMgybV3aXRoSW5jcmVtZW50YWxIeWRyYXRpb24sXG4gIMm1ybVFeHRlcm5hbFN0eWxlc0ZlYXR1cmUsXG4gIEZhY3RvcnlUYXJnZXQgYXMgybXJtUZhY3RvcnlUYXJnZXQsXG4gIMm1ybVIb3N0RGlyZWN0aXZlc0ZlYXR1cmUsXG4gIMm1ybVJbmhlcml0RGVmaW5pdGlvbkZlYXR1cmUsXG4gIMm1ybVOZ09uQ2hhbmdlc0ZlYXR1cmUsXG4gIMm1ybVQcm92aWRlcnNGZWF0dXJlLFxuICDJtcm1YWR2YW5jZSxcbiAgybXJtWFuaW1hdGVFbnRlcixcbiAgybXJtWFuaW1hdGVFbnRlckxpc3RlbmVyLFxuICDJtcm1YW5pbWF0ZUxlYXZlLFxuICDJtcm1YW5pbWF0ZUxlYXZlTGlzdGVuZXIsXG4gIMm1ybVhcmlhUHJvcGVydHksXG4gIMm1ybVhdHRhY2hTb3VyY2VMb2NhdGlvbnMsXG4gIMm1ybVhdHRyaWJ1dGUsXG4gIMm1ybVjbGFzc01hcCxcbiAgybXJtWNsYXNzUHJvcCxcbiAgybXJtWNvbXBvbmVudEluc3RhbmNlLFxuICDJtcm1Y29uZGl0aW9uYWwsXG4gIMm1ybVjb25kaXRpb25hbEJyYW5jaENyZWF0ZSxcbiAgybXJtWNvbmRpdGlvbmFsQ3JlYXRlLFxuICDJtcm1Y29udGVudFF1ZXJ5LFxuICDJtcm1Y29udGVudFF1ZXJ5U2lnbmFsLFxuICDJtcm1Y29udHJvbCxcbiAgybXJtWNvbnRyb2xDcmVhdGUsXG4gIMm1ybVkZWNsYXJlTGV0LFxuICDJtcm1ZGVmZXIsXG4gIMm1ybVkZWZlckVuYWJsZVRpbWVyU2NoZWR1bGluZyxcbiAgybXJtWRlZmVySHlkcmF0ZU5ldmVyLFxuICDJtcm1ZGVmZXJIeWRyYXRlT25Ib3ZlcixcbiAgybXJtWRlZmVySHlkcmF0ZU9uSWRsZSxcbiAgybXJtWRlZmVySHlkcmF0ZU9uSW1tZWRpYXRlLFxuICDJtcm1ZGVmZXJIeWRyYXRlT25JbnRlcmFjdGlvbixcbiAgybXJtWRlZmVySHlkcmF0ZU9uVGltZXIsXG4gIMm1ybVkZWZlckh5ZHJhdGVPblZpZXdwb3J0LFxuICDJtcm1ZGVmZXJIeWRyYXRlV2hlbixcbiAgybXJtWRlZmVyT25Ib3ZlcixcbiAgybXJtWRlZmVyT25JZGxlLFxuICDJtcm1ZGVmZXJPbkltbWVkaWF0ZSxcbiAgybXJtWRlZmVyT25JbnRlcmFjdGlvbixcbiAgybXJtWRlZmVyT25UaW1lcixcbiAgybXJtWRlZmVyT25WaWV3cG9ydCxcbiAgybXJtWRlZmVyUHJlZmV0Y2hPbkhvdmVyLFxuICDJtcm1ZGVmZXJQcmVmZXRjaE9uSWRsZSxcbiAgybXJtWRlZmVyUHJlZmV0Y2hPbkltbWVkaWF0ZSxcbiAgybXJtWRlZmVyUHJlZmV0Y2hPbkludGVyYWN0aW9uLFxuICDJtcm1ZGVmZXJQcmVmZXRjaE9uVGltZXIsXG4gIMm1ybVkZWZlclByZWZldGNoT25WaWV3cG9ydCxcbiAgybXJtWRlZmVyUHJlZmV0Y2hXaGVuLFxuICDJtcm1ZGVmZXJXaGVuLFxuICDJtcm1ZGVmaW5lQ29tcG9uZW50LFxuICDJtcm1ZGVmaW5lRGlyZWN0aXZlLFxuICDJtcm1ZGVmaW5lSW5qZWN0YWJsZSxcbiAgybXJtWRlZmluZUluamVjdG9yLFxuICDJtcm1ZGVmaW5lTmdNb2R1bGUsXG4gIMm1ybVkZWZpbmVQaXBlLFxuICDJtcm1ZGlyZWN0aXZlSW5qZWN0LFxuICDJtcm1ZGlzYWJsZUJpbmRpbmdzLFxuICDJtcm1ZG9tRWxlbWVudCxcbiAgybXJtWRvbUVsZW1lbnRDb250YWluZXIsXG4gIMm1ybVkb21FbGVtZW50Q29udGFpbmVyRW5kLFxuICDJtcm1ZG9tRWxlbWVudENvbnRhaW5lclN0YXJ0LFxuICDJtcm1ZG9tRWxlbWVudEVuZCxcbiAgybXJtWRvbUVsZW1lbnRTdGFydCxcbiAgybXJtWRvbUxpc3RlbmVyLFxuICDJtcm1ZG9tUHJvcGVydHksXG4gIMm1ybVkb21UZW1wbGF0ZSxcbiAgybXJtWVsZW1lbnQsXG4gIMm1ybVlbGVtZW50Q29udGFpbmVyLFxuICDJtcm1ZWxlbWVudENvbnRhaW5lckVuZCxcbiAgybXJtWVsZW1lbnRDb250YWluZXJTdGFydCxcbiAgybXJtWVsZW1lbnRFbmQsXG4gIMm1ybVlbGVtZW50U3RhcnQsXG4gIMm1ybVlbmFibGVCaW5kaW5ncyxcbiAgybXJtWdldENvbXBvbmVudERlcHNGYWN0b3J5LFxuICDJtcm1Z2V0Q3VycmVudFZpZXcsXG4gIMm1ybVnZXRJbmhlcml0ZWRGYWN0b3J5LFxuICDJtcm1Z2V0UmVwbGFjZU1ldGFkYXRhVVJMLFxuICDJtcm1aTE4bixcbiAgybXJtWkxOG5BcHBseSxcbiAgybXJtWkxOG5BdHRyaWJ1dGVzLFxuICDJtcm1aTE4bkVuZCxcbiAgybXJtWkxOG5FeHAsXG4gIMm1ybVpMThuUG9zdHByb2Nlc3MsXG4gIMm1ybVpMThuU3RhcnQsXG4gIMm1ybVpbmplY3QsXG4gIMm1ybVpbmplY3RBdHRyaWJ1dGUsXG4gIMm1ybVpbnRlcnBvbGF0ZSxcbiAgybXJtWludGVycG9sYXRlMSxcbiAgybXJtWludGVycG9sYXRlMixcbiAgybXJtWludGVycG9sYXRlMyxcbiAgybXJtWludGVycG9sYXRlNCxcbiAgybXJtWludGVycG9sYXRlNSxcbiAgybXJtWludGVycG9sYXRlNixcbiAgybXJtWludGVycG9sYXRlNyxcbiAgybXJtWludGVycG9sYXRlOCxcbiAgybXJtWludGVycG9sYXRlVixcbiAgybXJtWludmFsaWRGYWN0b3J5LFxuICDJtcm1aW52YWxpZEZhY3RvcnlEZXAsXG4gIMm1ybVsaXN0ZW5lcixcbiAgybXJtWxvYWRRdWVyeSxcbiAgybXJtW5hbWVzcGFjZUhUTUwsXG4gIMm1ybVuYW1lc3BhY2VNYXRoTUwsXG4gIMm1ybVuYW1lc3BhY2VTVkcsXG4gIMm1ybVuZXh0Q29udGV4dCxcbiAgybXJtW5nRGVjbGFyZUNsYXNzTWV0YWRhdGEsXG4gIMm1ybVuZ0RlY2xhcmVDbGFzc01ldGFkYXRhQXN5bmMsXG4gIMm1ybVuZ0RlY2xhcmVDb21wb25lbnQsXG4gIMm1ybVuZ0RlY2xhcmVEaXJlY3RpdmUsXG4gIMm1ybVuZ0RlY2xhcmVGYWN0b3J5LFxuICDJtcm1bmdEZWNsYXJlSW5qZWN0YWJsZSxcbiAgybXJtW5nRGVjbGFyZUluamVjdG9yLFxuICDJtcm1bmdEZWNsYXJlTmdNb2R1bGUsXG4gIMm1ybVuZ0RlY2xhcmVQaXBlLFxuICDJtcm1cGlwZSxcbiAgybXJtXBpcGVCaW5kMSxcbiAgybXJtXBpcGVCaW5kMixcbiAgybXJtXBpcGVCaW5kMyxcbiAgybXJtXBpcGVCaW5kNCxcbiAgybXJtXBpcGVCaW5kVixcbiAgybXJtXByb2plY3Rpb24sXG4gIMm1ybVwcm9qZWN0aW9uRGVmLFxuICDJtcm1cHJvcGVydHksXG4gIMm1ybVwdXJlRnVuY3Rpb24wLFxuICDJtcm1cHVyZUZ1bmN0aW9uMSxcbiAgybXJtXB1cmVGdW5jdGlvbjIsXG4gIMm1ybVwdXJlRnVuY3Rpb24zLFxuICDJtcm1cHVyZUZ1bmN0aW9uNCxcbiAgybXJtXB1cmVGdW5jdGlvbjUsXG4gIMm1ybVwdXJlRnVuY3Rpb242LFxuICDJtcm1cHVyZUZ1bmN0aW9uNyxcbiAgybXJtXB1cmVGdW5jdGlvbjgsXG4gIMm1ybVwdXJlRnVuY3Rpb25WLFxuICDJtcm1cXVlcnlBZHZhbmNlLFxuICDJtcm1cXVlcnlSZWZyZXNoLFxuICDJtcm1cmVhZENvbnRleHRMZXQsXG4gIMm1ybVyZWZlcmVuY2UsXG4gIHJlZ2lzdGVyTmdNb2R1bGVUeXBlIGFzIMm1ybVyZWdpc3Rlck5nTW9kdWxlVHlwZSxcbiAgybXJtXJlcGVhdGVyLFxuICDJtcm1cmVwZWF0ZXJDcmVhdGUsXG4gIMm1ybVyZXBlYXRlclRyYWNrQnlJZGVudGl0eSxcbiAgybXJtXJlcGVhdGVyVHJhY2tCeUluZGV4LFxuICDJtcm1cmVwbGFjZU1ldGFkYXRhLFxuICDJtcm1cmVzZXRWaWV3LFxuICDJtcm1cmVzb2x2ZUJvZHksXG4gIMm1ybVyZXNvbHZlRG9jdW1lbnQsXG4gIMm1ybVyZXNvbHZlV2luZG93LFxuICDJtcm1cmVzdG9yZVZpZXcsXG4gIMm1ybVzYW5pdGl6ZUh0bWwsXG4gIMm1ybVzYW5pdGl6ZVJlc291cmNlVXJsLFxuICDJtcm1c2FuaXRpemVTY3JpcHQsXG4gIMm1ybVzYW5pdGl6ZVN0eWxlLFxuICDJtcm1c2FuaXRpemVVcmwsXG4gIMm1ybVzYW5pdGl6ZVVybE9yUmVzb3VyY2VVcmwsXG4gIMm1ybVzZXRDb21wb25lbnRTY29wZSxcbiAgybXJtXNldE5nTW9kdWxlU2NvcGUsXG4gIMm1ybVzdG9yZUxldCxcbiAgybXJtXN0eWxlTWFwLFxuICDJtcm1c3R5bGVQcm9wLFxuICDJtcm1c3ludGhldGljSG9zdExpc3RlbmVyLFxuICDJtcm1c3ludGhldGljSG9zdFByb3BlcnR5LFxuICDJtcm1dGVtcGxhdGUsXG4gIMm1ybV0ZW1wbGF0ZVJlZkV4dHJhY3RvcixcbiAgybXJtXRleHQsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGUsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGUxLFxuICDJtcm1dGV4dEludGVycG9sYXRlMixcbiAgybXJtXRleHRJbnRlcnBvbGF0ZTMsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGU0LFxuICDJtcm1dGV4dEludGVycG9sYXRlNSxcbiAgybXJtXRleHRJbnRlcnBvbGF0ZTYsXG4gIMm1ybV0ZXh0SW50ZXJwb2xhdGU3LFxuICDJtcm1dGV4dEludGVycG9sYXRlOCxcbiAgybXJtXRleHRJbnRlcnBvbGF0ZVYsXG4gIMm1ybV0cnVzdENvbnN0YW50SHRtbCxcbiAgybXJtXRydXN0Q29uc3RhbnRSZXNvdXJjZVVybCxcbiAgybXJtXR3b1dheUJpbmRpbmdTZXQsXG4gIMm1ybV0d29XYXlMaXN0ZW5lcixcbiAgybXJtXR3b1dheVByb3BlcnR5LFxuICDJtcm1dmFsaWRhdGVBdHRyaWJ1dGUsXG4gIMm1ybV2aWV3UXVlcnksXG4gIMm1ybV2aWV3UXVlcnlTaWduYWxcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxDQUFDO0FBQ1AsQ0FBQyxDQUFDLG1CQUFtQjtBQUNyQixDQUFDLENBQUMscUJBQXFCO0FBQ3ZCLENBQUMsQ0FBQyxzQkFBc0I7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Q0FBQyxpQkFBaUI7QUFDckIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUI7QUFDckIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhO0FBQ2pCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtBQUNSLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUztBQUNiLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUztBQUNiLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUztBQUNiLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUztBQUNiLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUztBQUNiLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVTtBQUNkLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVE7QUFDWixDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWE7QUFDakIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhO0FBQ2pCLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWE7QUFDakIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhO0FBQ2pCLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWE7QUFDakIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhO0FBQ2pCLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWE7QUFDakIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZO0FBQ2hCLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWTtBQUNoQixDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWM7QUFDbEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTO0FBQ2IsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsb0JBQW9CO0FBQ2hELENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUTtBQUNaLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYztBQUNsQixDQUFDLENBQUMsQ0FBQyxDQUFDLHVCQUF1QjtBQUMzQixDQUFDLENBQUMsQ0FBQyxDQUFDLG9CQUFvQjtBQUN4QixDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWU7QUFDbkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTO0FBQ2IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXO0FBQ2YsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlO0FBQ25CLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVc7QUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVk7QUFDaEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxtQkFBbUI7QUFDdkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjO0FBQ2xCLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtBQUNqQixDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVc7QUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLHdCQUF3QjtBQUM1QixDQUFDLENBQUMsQ0FBQyxDQUFDLGlCQUFpQjtBQUNyQixDQUFDLENBQUMsQ0FBQyxDQUFDLGdCQUFnQjtBQUNwQixDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVE7QUFDWixDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVE7QUFDWixDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7QUFDYixDQUFDLENBQUMsQ0FBQyxDQUFDLHFCQUFxQjtBQUN6QixDQUFDLENBQUMsQ0FBQyxDQUFDLHFCQUFxQjtBQUN6QixDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVE7QUFDWixDQUFDLENBQUMsQ0FBQyxDQUFDLG9CQUFvQjtBQUN4QixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUk7QUFDUixDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWU7QUFDbkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUI7QUFDckIsQ0FBQyxDQUFDLENBQUMsQ0FBQyx3QkFBd0I7QUFDNUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjO0FBQ2xCLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYztBQUNsQixDQUFDLENBQUMsQ0FBQyxDQUFDLGlCQUFpQjtBQUNyQixDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7QUFDYixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQzsifQ=="
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.210Z",
        "time": 2.8169999714009464,
        "timings": {
          "blocked": 1.6579999622888864,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.5330000154674053,
          "receive": 0.6259999936446548,
          "_blocked_queueing": 1.6079999622888863,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/main.js",
          "lineNumber": 10
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_router.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "207470"
            },
            {
              "name": "Etag",
              "value": "W/\"32a6e-f7xzFy/OV9SkL7bHpz7JH2ZCwQE\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 207470,
            "mimeType": "text/javascript",
            "text": "import {\n  Title\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-SXEFOV7B.js?v=a3ec8c6b\";\nimport {\n  HashLocationStrategy,\n  Location,\n  LocationStrategy,\n  NavigationAdapterForLocation,\n  PRECOMMIT_HANDLER_SUPPORTED,\n  PathLocationStrategy,\n  PlatformNavigation,\n  ViewportScroller\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-CGVE6HH2.js?v=a3ec8c6b\";\nimport \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-43XS5UPA.js?v=a3ec8c6b\";\nimport {\n  LOCATION_INITIALIZED,\n  PlatformLocation\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport {\n  APP_BOOTSTRAP_LISTENER,\n  ApplicationRef,\n  Attribute,\n  BehaviorSubject,\n  ChangeDetectorRef,\n  Compiler,\n  Component,\n  Console,\n  ContentChildren,\n  DOCUMENT,\n  DestroyRef,\n  Directive,\n  EMPTY,\n  ENVIRONMENT_INITIALIZER,\n  ElementRef,\n  EmptyError,\n  EnvironmentInjector,\n  EventEmitter,\n  HostAttributeToken,\n  HostBinding,\n  HostListener,\n  INTERNAL_APPLICATION_ERROR_HANDLER,\n  IS_ENABLED_BLOCKING_INITIAL_NAVIGATION,\n  Injectable,\n  InjectionToken,\n  Injector,\n  Input,\n  NgModule,\n  NgModuleFactory$1,\n  NgZone,\n  Observable,\n  Output,\n  PendingTasksInternal,\n  Renderer2,\n  RuntimeError,\n  Subject,\n  Subscription,\n  Version,\n  ViewContainerRef,\n  __spreadProps,\n  __spreadValues,\n  afterNextRender,\n  booleanAttribute,\n  catchError,\n  combineLatest,\n  computed,\n  concat,\n  concatMap,\n  createEnvironmentInjector,\n  defer,\n  filter,\n  finalize,\n  first,\n  formatRuntimeError,\n  from,\n  inject,\n  input,\n  isInjectable,\n  isNgModule,\n  isObservable,\n  isPromise,\n  isStandalone,\n  makeEnvironmentProviders,\n  map,\n  mergeAll,\n  mergeMap,\n  of,\n  performanceMarkFeature,\n  pipe,\n  promiseWithResolvers,\n  provideAppInitializer,\n  provideEnvironmentInitializer,\n  publishExternalGlobalUtil,\n  reflectComponentType,\n  runInInjectionContext,\n  setClassMetadata,\n  signal,\n  startWith,\n  switchMap,\n  take,\n  takeLast,\n  takeUntil,\n  tap,\n  throwError,\n  untracked,\n  NgOnChangesFeature,\n  attribute,\n  contentQuery,\n  defineComponent,\n  defineDirective,\n  defineInjectable,\n  defineInjector,\n  defineNgModule,\n  directiveInject,\n  element,\n  getInheritedFactory,\n  inject,\n  injectAttribute,\n  invalidFactory,\n  listener,\n  loadQuery,\n  queryRefresh,\n  sanitizeUrlOrResourceUrl\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\n\n// node_modules/@angular/router/fesm2022/_router-chunk.mjs\nvar PRIMARY_OUTLET = \"primary\";\nvar RouteTitleKey = /* @__PURE__ */ Symbol(\"RouteTitle\");\nvar ParamsAsMap = class {\n  params;\n  constructor(params) {\n    this.params = params || {};\n  }\n  has(name) {\n    return Object.prototype.hasOwnProperty.call(this.params, name);\n  }\n  get(name) {\n    if (this.has(name)) {\n      const v = this.params[name];\n      return Array.isArray(v) ? v[0] : v;\n    }\n    return null;\n  }\n  getAll(name) {\n    if (this.has(name)) {\n      const v = this.params[name];\n      return Array.isArray(v) ? v : [v];\n    }\n    return [];\n  }\n  get keys() {\n    return Object.keys(this.params);\n  }\n};\nfunction convertToParamMap(params) {\n  return new ParamsAsMap(params);\n}\nfunction matchParts(routeParts, urlSegments, posParams) {\n  for (let i = 0; i < routeParts.length; i++) {\n    const part = routeParts[i];\n    const segment = urlSegments[i];\n    const isParameter = part[0] === \":\";\n    if (isParameter) {\n      posParams[part.substring(1)] = segment;\n    } else if (part !== segment.path) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction defaultUrlMatcher(segments, segmentGroup, route) {\n  const parts = route.path.split(\"/\");\n  const wildcardIndex = parts.indexOf(\"**\");\n  if (wildcardIndex === -1) {\n    if (parts.length > segments.length) {\n      return null;\n    }\n    if (route.pathMatch === \"full\" && (segmentGroup.hasChildren() || parts.length < segments.length)) {\n      return null;\n    }\n    const posParams2 = {};\n    const consumed = segments.slice(0, parts.length);\n    if (!matchParts(parts, consumed, posParams2)) {\n      return null;\n    }\n    return {\n      consumed,\n      posParams: posParams2\n    };\n  }\n  if (wildcardIndex !== parts.lastIndexOf(\"**\")) {\n    return null;\n  }\n  const pre = parts.slice(0, wildcardIndex);\n  const post = parts.slice(wildcardIndex + 1);\n  if (pre.length + post.length > segments.length) {\n    return null;\n  }\n  if (route.pathMatch === \"full\" && segmentGroup.hasChildren() && route.path !== \"**\") {\n    return null;\n  }\n  const posParams = {};\n  if (!matchParts(pre, segments.slice(0, pre.length), posParams)) {\n    return null;\n  }\n  if (!matchParts(post, segments.slice(segments.length - post.length), posParams)) {\n    return null;\n  }\n  return {\n    consumed: segments,\n    posParams\n  };\n}\nfunction firstValueFrom(source) {\n  return new Promise((resolve, reject) => {\n    source.pipe(first()).subscribe({\n      next: (value) => resolve(value),\n      error: (err) => reject(err)\n    });\n  });\n}\nfunction shallowEqualArrays(a, b) {\n  if (a.length !== b.length) return false;\n  for (let i = 0; i < a.length; ++i) {\n    if (!shallowEqual(a[i], b[i])) return false;\n  }\n  return true;\n}\nfunction shallowEqual(a, b) {\n  const k1 = a ? getDataKeys(a) : void 0;\n  const k2 = b ? getDataKeys(b) : void 0;\n  if (!k1 || !k2 || k1.length != k2.length) {\n    return false;\n  }\n  let key;\n  for (let i = 0; i < k1.length; i++) {\n    key = k1[i];\n    if (!equalArraysOrString(a[key], b[key])) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction getDataKeys(obj) {\n  return [...Object.keys(obj), ...Object.getOwnPropertySymbols(obj)];\n}\nfunction equalArraysOrString(a, b) {\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) return false;\n    const aSorted = [...a].sort();\n    const bSorted = [...b].sort();\n    return aSorted.every((val, index) => bSorted[index] === val);\n  } else {\n    return a === b;\n  }\n}\nfunction last(a) {\n  return a.length > 0 ? a[a.length - 1] : null;\n}\nfunction wrapIntoObservable(value) {\n  if (isObservable(value)) {\n    return value;\n  }\n  if (isPromise(value)) {\n    return from(Promise.resolve(value));\n  }\n  return of(value);\n}\nfunction wrapIntoPromise(value) {\n  if (isObservable(value)) {\n    return firstValueFrom(value);\n  }\n  return Promise.resolve(value);\n}\nvar pathCompareMap = {\n  \"exact\": equalSegmentGroups,\n  \"subset\": containsSegmentGroup\n};\nvar paramCompareMap = {\n  \"exact\": equalParams,\n  \"subset\": containsParams,\n  \"ignored\": () => true\n};\nfunction isActive(url, router, matchOptions) {\n  const urlTree = url instanceof UrlTree ? url : router.parseUrl(url);\n  return computed(() => containsTree(router.lastSuccessfulNavigation()?.finalUrl ?? new UrlTree(), urlTree, matchOptions));\n}\nfunction containsTree(container, containee, options) {\n  return pathCompareMap[options.paths](container.root, containee.root, options.matrixParams) && paramCompareMap[options.queryParams](container.queryParams, containee.queryParams) && !(options.fragment === \"exact\" && container.fragment !== containee.fragment);\n}\nfunction equalParams(container, containee) {\n  return shallowEqual(container, containee);\n}\nfunction equalSegmentGroups(container, containee, matrixParams) {\n  if (!equalPath(container.segments, containee.segments)) return false;\n  if (!matrixParamsMatch(container.segments, containee.segments, matrixParams)) {\n    return false;\n  }\n  if (container.numberOfChildren !== containee.numberOfChildren) return false;\n  for (const c in containee.children) {\n    if (!container.children[c]) return false;\n    if (!equalSegmentGroups(container.children[c], containee.children[c], matrixParams)) return false;\n  }\n  return true;\n}\nfunction containsParams(container, containee) {\n  return Object.keys(containee).length <= Object.keys(container).length && Object.keys(containee).every((key) => equalArraysOrString(container[key], containee[key]));\n}\nfunction containsSegmentGroup(container, containee, matrixParams) {\n  return containsSegmentGroupHelper(container, containee, containee.segments, matrixParams);\n}\nfunction containsSegmentGroupHelper(container, containee, containeePaths, matrixParams) {\n  if (container.segments.length > containeePaths.length) {\n    const current = container.segments.slice(0, containeePaths.length);\n    if (!equalPath(current, containeePaths)) return false;\n    if (containee.hasChildren()) return false;\n    if (!matrixParamsMatch(current, containeePaths, matrixParams)) return false;\n    return true;\n  } else if (container.segments.length === containeePaths.length) {\n    if (!equalPath(container.segments, containeePaths)) return false;\n    if (!matrixParamsMatch(container.segments, containeePaths, matrixParams)) return false;\n    for (const c in containee.children) {\n      if (!container.children[c]) return false;\n      if (!containsSegmentGroup(container.children[c], containee.children[c], matrixParams)) {\n        return false;\n      }\n    }\n    return true;\n  } else {\n    const current = containeePaths.slice(0, container.segments.length);\n    const next = containeePaths.slice(container.segments.length);\n    if (!equalPath(container.segments, current)) return false;\n    if (!matrixParamsMatch(container.segments, current, matrixParams)) return false;\n    if (!container.children[PRIMARY_OUTLET]) return false;\n    return containsSegmentGroupHelper(container.children[PRIMARY_OUTLET], containee, next, matrixParams);\n  }\n}\nfunction matrixParamsMatch(containerPaths, containeePaths, options) {\n  return containeePaths.every((containeeSegment, i) => {\n    return paramCompareMap[options](containerPaths[i].parameters, containeeSegment.parameters);\n  });\n}\nvar UrlTree = class {\n  root;\n  queryParams;\n  fragment;\n  _queryParamMap;\n  constructor(root = new UrlSegmentGroup([], {}), queryParams = {}, fragment = null) {\n    this.root = root;\n    this.queryParams = queryParams;\n    this.fragment = fragment;\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      if (root.segments.length > 0) {\n        throw new RuntimeError(4015, \"The root `UrlSegmentGroup` should not contain `segments`. Instead, these segments belong in the `children` so they can be associated with a named outlet.\");\n      }\n    }\n  }\n  get queryParamMap() {\n    this._queryParamMap ??= convertToParamMap(this.queryParams);\n    return this._queryParamMap;\n  }\n  toString() {\n    return DEFAULT_SERIALIZER.serialize(this);\n  }\n};\nvar UrlSegmentGroup = class {\n  segments;\n  children;\n  parent = null;\n  constructor(segments, children) {\n    this.segments = segments;\n    this.children = children;\n    Object.values(children).forEach((v) => v.parent = this);\n  }\n  hasChildren() {\n    return this.numberOfChildren > 0;\n  }\n  get numberOfChildren() {\n    return Object.keys(this.children).length;\n  }\n  toString() {\n    return serializePaths(this);\n  }\n};\nvar UrlSegment = class {\n  path;\n  parameters;\n  _parameterMap;\n  constructor(path, parameters) {\n    this.path = path;\n    this.parameters = parameters;\n  }\n  get parameterMap() {\n    this._parameterMap ??= convertToParamMap(this.parameters);\n    return this._parameterMap;\n  }\n  toString() {\n    return serializePath(this);\n  }\n};\nfunction equalSegments(as, bs) {\n  return equalPath(as, bs) && as.every((a, i) => shallowEqual(a.parameters, bs[i].parameters));\n}\nfunction equalPath(as, bs) {\n  if (as.length !== bs.length) return false;\n  return as.every((a, i) => a.path === bs[i].path);\n}\nfunction mapChildrenIntoArray(segment, fn) {\n  let res = [];\n  Object.entries(segment.children).forEach(([childOutlet, child]) => {\n    if (childOutlet === PRIMARY_OUTLET) {\n      res = res.concat(fn(child, childOutlet));\n    }\n  });\n  Object.entries(segment.children).forEach(([childOutlet, child]) => {\n    if (childOutlet !== PRIMARY_OUTLET) {\n      res = res.concat(fn(child, childOutlet));\n    }\n  });\n  return res;\n}\nvar UrlSerializer = class _UrlSerializer {\n  static fac = function UrlSerializer_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _UrlSerializer)();\n  };\n  static prov = defineInjectable({\n    token: _UrlSerializer,\n    factory: () => (() => new DefaultUrlSerializer())(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(UrlSerializer, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => new DefaultUrlSerializer()\n    }]\n  }], null, null);\n})();\nvar DefaultUrlSerializer = class {\n  parse(url) {\n    const p = new UrlParser(url);\n    return new UrlTree(p.parseRootSegment(), p.parseQueryParams(), p.parseFragment());\n  }\n  serialize(tree2) {\n    const segment = `/${serializeSegment(tree2.root, true)}`;\n    const query = serializeQueryParams(tree2.queryParams);\n    const fragment = typeof tree2.fragment === `string` ? `#${encodeUriFragment(tree2.fragment)}` : \"\";\n    return `${segment}${query}${fragment}`;\n  }\n};\nvar DEFAULT_SERIALIZER = new DefaultUrlSerializer();\nfunction serializePaths(segment) {\n  return segment.segments.map((p) => serializePath(p)).join(\"/\");\n}\nfunction serializeSegment(segment, root) {\n  if (!segment.hasChildren()) {\n    return serializePaths(segment);\n  }\n  if (root) {\n    const primary = segment.children[PRIMARY_OUTLET] ? serializeSegment(segment.children[PRIMARY_OUTLET], false) : \"\";\n    const children = [];\n    Object.entries(segment.children).forEach(([k, v]) => {\n      if (k !== PRIMARY_OUTLET) {\n        children.push(`${k}:${serializeSegment(v, false)}`);\n      }\n    });\n    return children.length > 0 ? `${primary}(${children.join(\"//\")})` : primary;\n  } else {\n    const children = mapChildrenIntoArray(segment, (v, k) => {\n      if (k === PRIMARY_OUTLET) {\n        return [serializeSegment(segment.children[PRIMARY_OUTLET], false)];\n      }\n      return [`${k}:${serializeSegment(v, false)}`];\n    });\n    if (Object.keys(segment.children).length === 1 && segment.children[PRIMARY_OUTLET] != null) {\n      return `${serializePaths(segment)}/${children[0]}`;\n    }\n    return `${serializePaths(segment)}/(${children.join(\"//\")})`;\n  }\n}\nfunction encodeUriString(s) {\n  return encodeURIComponent(s).replace(/%40/g, \"@\").replace(/%3A/gi, \":\").replace(/%24/g, \"$\").replace(/%2C/gi, \",\");\n}\nfunction encodeUriQuery(s) {\n  return encodeUriString(s).replace(/%3B/gi, \";\");\n}\nfunction encodeUriFragment(s) {\n  return encodeURI(s);\n}\nfunction encodeUriSegment(s) {\n  return encodeUriString(s).replace(/\\(/g, \"%28\").replace(/\\)/g, \"%29\").replace(/%26/gi, \"&\");\n}\nfunction decode(s) {\n  return decodeURIComponent(s);\n}\nfunction decodeQuery(s) {\n  return decode(s.replace(/\\+/g, \"%20\"));\n}\nfunction serializePath(path) {\n  return `${encodeUriSegment(path.path)}${serializeMatrixParams(path.parameters)}`;\n}\nfunction serializeMatrixParams(params) {\n  return Object.entries(params).map(([key, value]) => `;${encodeUriSegment(key)}=${encodeUriSegment(value)}`).join(\"\");\n}\nfunction serializeQueryParams(params) {\n  const strParams = Object.entries(params).map(([name, value]) => {\n    return Array.isArray(value) ? value.map((v) => `${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join(\"&\") : `${encodeUriQuery(name)}=${encodeUriQuery(value)}`;\n  }).filter((s) => s);\n  return strParams.length ? `?${strParams.join(\"&\")}` : \"\";\n}\nvar SEGMENT_RE = /^[^\\/()?;#]+/;\nfunction matchSegments(str) {\n  const match2 = str.match(SEGMENT_RE);\n  return match2 ? match2[0] : \"\";\n}\nvar MATRIX_PARAM_SEGMENT_RE = /^[^\\/()?;=#]+/;\nfunction matchMatrixKeySegments(str) {\n  const match2 = str.match(MATRIX_PARAM_SEGMENT_RE);\n  return match2 ? match2[0] : \"\";\n}\nvar QUERY_PARAM_RE = /^[^=?&#]+/;\nfunction matchQueryParams(str) {\n  const match2 = str.match(QUERY_PARAM_RE);\n  return match2 ? match2[0] : \"\";\n}\nvar QUERY_PARAM_VALUE_RE = /^[^&#]+/;\nfunction matchUrlQueryParamValue(str) {\n  const match2 = str.match(QUERY_PARAM_VALUE_RE);\n  return match2 ? match2[0] : \"\";\n}\nvar UrlParser = class {\n  url;\n  remaining;\n  constructor(url) {\n    this.url = url;\n    this.remaining = url;\n  }\n  parseRootSegment() {\n    this.consumeOptional(\"/\");\n    if (this.remaining === \"\" || this.peekStartsWith(\"?\") || this.peekStartsWith(\"#\")) {\n      return new UrlSegmentGroup([], {});\n    }\n    return new UrlSegmentGroup([], this.parseChildren());\n  }\n  parseQueryParams() {\n    const params = {};\n    if (this.consumeOptional(\"?\")) {\n      do {\n        this.parseQueryParam(params);\n      } while (this.consumeOptional(\"&\"));\n    }\n    return params;\n  }\n  parseFragment() {\n    return this.consumeOptional(\"#\") ? decodeURIComponent(this.remaining) : null;\n  }\n  parseChildren(depth = 0) {\n    if (depth > 50) {\n      throw new RuntimeError(4010, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"URL is too deep\");\n    }\n    if (this.remaining === \"\") {\n      return {};\n    }\n    this.consumeOptional(\"/\");\n    const segments = [];\n    if (!this.peekStartsWith(\"(\")) {\n      segments.push(this.parseSegment());\n    }\n    while (this.peekStartsWith(\"/\") && !this.peekStartsWith(\"//\") && !this.peekStartsWith(\"/(\")) {\n      this.capture(\"/\");\n      segments.push(this.parseSegment());\n    }\n    let children = {};\n    if (this.peekStartsWith(\"/(\")) {\n      this.capture(\"/\");\n      children = this.parseParens(true, depth);\n    }\n    let res = {};\n    if (this.peekStartsWith(\"(\")) {\n      res = this.parseParens(false, depth);\n    }\n    if (segments.length > 0 || Object.keys(children).length > 0) {\n      res[PRIMARY_OUTLET] = new UrlSegmentGroup(segments, children);\n    }\n    return res;\n  }\n  parseSegment() {\n    const path = matchSegments(this.remaining);\n    if (path === \"\" && this.peekStartsWith(\";\")) {\n      throw new RuntimeError(4009, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Empty path url segment cannot have parameters: '${this.remaining}'.`);\n    }\n    this.capture(path);\n    return new UrlSegment(decode(path), this.parseMatrixParams());\n  }\n  parseMatrixParams() {\n    const params = {};\n    while (this.consumeOptional(\";\")) {\n      this.parseParam(params);\n    }\n    return params;\n  }\n  parseParam(params) {\n    const key = matchMatrixKeySegments(this.remaining);\n    if (!key) {\n      return;\n    }\n    this.capture(key);\n    let value = \"\";\n    if (this.consumeOptional(\"=\")) {\n      const valueMatch = matchSegments(this.remaining);\n      if (valueMatch) {\n        value = valueMatch;\n        this.capture(value);\n      }\n    }\n    params[decode(key)] = decode(value);\n  }\n  parseQueryParam(params) {\n    const key = matchQueryParams(this.remaining);\n    if (!key) {\n      return;\n    }\n    this.capture(key);\n    let value = \"\";\n    if (this.consumeOptional(\"=\")) {\n      const valueMatch = matchUrlQueryParamValue(this.remaining);\n      if (valueMatch) {\n        value = valueMatch;\n        this.capture(value);\n      }\n    }\n    const decodedKey = decodeQuery(key);\n    const decodedVal = decodeQuery(value);\n    if (params.hasOwnProperty(decodedKey)) {\n      let currentVal = params[decodedKey];\n      if (!Array.isArray(currentVal)) {\n        currentVal = [currentVal];\n        params[decodedKey] = currentVal;\n      }\n      currentVal.push(decodedVal);\n    } else {\n      params[decodedKey] = decodedVal;\n    }\n  }\n  parseParens(allowPrimary, depth) {\n    const segments = {};\n    this.capture(\"(\");\n    while (!this.consumeOptional(\")\") && this.remaining.length > 0) {\n      const path = matchSegments(this.remaining);\n      const next = this.remaining[path.length];\n      if (next !== \"/\" && next !== \")\" && next !== \";\") {\n        throw new RuntimeError(4010, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Cannot parse url '${this.url}'`);\n      }\n      let outletName;\n      if (path.indexOf(\":\") > -1) {\n        outletName = path.slice(0, path.indexOf(\":\"));\n        this.capture(outletName);\n        this.capture(\":\");\n      } else if (allowPrimary) {\n        outletName = PRIMARY_OUTLET;\n      }\n      const children = this.parseChildren(depth + 1);\n      segments[outletName ?? PRIMARY_OUTLET] = Object.keys(children).length === 1 && children[PRIMARY_OUTLET] ? children[PRIMARY_OUTLET] : new UrlSegmentGroup([], children);\n      this.consumeOptional(\"//\");\n    }\n    return segments;\n  }\n  peekStartsWith(str) {\n    return this.remaining.startsWith(str);\n  }\n  consumeOptional(str) {\n    if (this.peekStartsWith(str)) {\n      this.remaining = this.remaining.substring(str.length);\n      return true;\n    }\n    return false;\n  }\n  capture(str) {\n    if (!this.consumeOptional(str)) {\n      throw new RuntimeError(4011, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Expected \"${str}\".`);\n    }\n  }\n};\nfunction createRoot(rootCandidate) {\n  return rootCandidate.segments.length > 0 ? new UrlSegmentGroup([], {\n    [PRIMARY_OUTLET]: rootCandidate\n  }) : rootCandidate;\n}\nfunction squashSegmentGroup(segmentGroup) {\n  const newChildren = {};\n  for (const [childOutlet, child] of Object.entries(segmentGroup.children)) {\n    const childCandidate = squashSegmentGroup(child);\n    if (childOutlet === PRIMARY_OUTLET && childCandidate.segments.length === 0 && childCandidate.hasChildren()) {\n      for (const [grandChildOutlet, grandChild] of Object.entries(childCandidate.children)) {\n        newChildren[grandChildOutlet] = grandChild;\n      }\n    } else if (childCandidate.segments.length > 0 || childCandidate.hasChildren()) {\n      newChildren[childOutlet] = childCandidate;\n    }\n  }\n  const s = new UrlSegmentGroup(segmentGroup.segments, newChildren);\n  return mergeTrivialChildren(s);\n}\nfunction mergeTrivialChildren(s) {\n  if (s.numberOfChildren === 1 && s.children[PRIMARY_OUTLET]) {\n    const c = s.children[PRIMARY_OUTLET];\n    return new UrlSegmentGroup(s.segments.concat(c.segments), c.children);\n  }\n  return s;\n}\nfunction isUrlTree(v) {\n  return v instanceof UrlTree;\n}\nfunction createUrlTreeFromSnapshot(relativeTo, commands, queryParams = null, fragment = null, urlSerializer = new DefaultUrlSerializer()) {\n  const relativeToUrlSegmentGroup = createSegmentGroupFromRoute(relativeTo);\n  return createUrlTreeFromSegmentGroup(relativeToUrlSegmentGroup, commands, queryParams, fragment, urlSerializer);\n}\nfunction createSegmentGroupFromRoute(route) {\n  let targetGroup;\n  function createSegmentGroupFromRouteRecursive(currentRoute) {\n    const childOutlets = {};\n    for (const childSnapshot of currentRoute.children) {\n      const root = createSegmentGroupFromRouteRecursive(childSnapshot);\n      childOutlets[childSnapshot.outlet] = root;\n    }\n    const segmentGroup = new UrlSegmentGroup(currentRoute.url, childOutlets);\n    if (currentRoute === route) {\n      targetGroup = segmentGroup;\n    }\n    return segmentGroup;\n  }\n  const rootCandidate = createSegmentGroupFromRouteRecursive(route.root);\n  const rootSegmentGroup = createRoot(rootCandidate);\n  return targetGroup ?? rootSegmentGroup;\n}\nfunction createUrlTreeFromSegmentGroup(relativeTo, commands, queryParams, fragment, urlSerializer) {\n  let root = relativeTo;\n  while (root.parent) {\n    root = root.parent;\n  }\n  if (commands.length === 0) {\n    return tree(root, root, root, queryParams, fragment, urlSerializer);\n  }\n  const nav = computeNavigation(commands);\n  if (nav.toRoot()) {\n    return tree(root, root, new UrlSegmentGroup([], {}), queryParams, fragment, urlSerializer);\n  }\n  const position = findStartingPositionForTargetGroup(nav, root, relativeTo);\n  const newSegmentGroup = position.processChildren ? updateSegmentGroupChildren(position.segmentGroup, position.index, nav.commands) : updateSegmentGroup(position.segmentGroup, position.index, nav.commands);\n  return tree(root, position.segmentGroup, newSegmentGroup, queryParams, fragment, urlSerializer);\n}\nfunction isMatrixParams(command) {\n  return typeof command === \"object\" && command != null && !command.outlets && !command.segmentPath;\n}\nfunction isCommandWithOutlets(command) {\n  return typeof command === \"object\" && command != null && command.outlets;\n}\nfunction normalizeQueryParams(k, v, urlSerializer) {\n  k ||= \"\";\n  const tree2 = new UrlTree();\n  tree2.queryParams = {\n    [k]: v\n  };\n  return urlSerializer.parse(urlSerializer.serialize(tree2)).queryParams[k];\n}\nfunction tree(oldRoot, oldSegmentGroup, newSegmentGroup, queryParams, fragment, urlSerializer) {\n  const qp = {};\n  for (const [key, value] of Object.entries(queryParams ?? {})) {\n    qp[key] = Array.isArray(value) ? value.map((v) => normalizeQueryParams(key, v, urlSerializer)) : normalizeQueryParams(key, value, urlSerializer);\n  }\n  let rootCandidate;\n  if (oldRoot === oldSegmentGroup) {\n    rootCandidate = newSegmentGroup;\n  } else {\n    rootCandidate = replaceSegment(oldRoot, oldSegmentGroup, newSegmentGroup);\n  }\n  const newRoot = createRoot(squashSegmentGroup(rootCandidate));\n  return new UrlTree(newRoot, qp, fragment);\n}\nfunction replaceSegment(current, oldSegment, newSegment) {\n  const children = {};\n  Object.entries(current.children).forEach(([outletName, c]) => {\n    if (c === oldSegment) {\n      children[outletName] = newSegment;\n    } else {\n      children[outletName] = replaceSegment(c, oldSegment, newSegment);\n    }\n  });\n  return new UrlSegmentGroup(current.segments, children);\n}\nvar Navigation = class {\n  isAbsolute;\n  numberOfDoubleDots;\n  commands;\n  constructor(isAbsolute, numberOfDoubleDots, commands) {\n    this.isAbsolute = isAbsolute;\n    this.numberOfDoubleDots = numberOfDoubleDots;\n    this.commands = commands;\n    if (isAbsolute && commands.length > 0 && isMatrixParams(commands[0])) {\n      throw new RuntimeError(4003, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Root segment cannot have matrix parameters\");\n    }\n    const cmdWithOutlet = commands.find(isCommandWithOutlets);\n    if (cmdWithOutlet && cmdWithOutlet !== last(commands)) {\n      throw new RuntimeError(4004, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"{outlets:{}} has to be the last command\");\n    }\n  }\n  toRoot() {\n    return this.isAbsolute && this.commands.length === 1 && this.commands[0] == \"/\";\n  }\n};\nfunction computeNavigation(commands) {\n  if (typeof commands[0] === \"string\" && commands.length === 1 && commands[0] === \"/\") {\n    return new Navigation(true, 0, commands);\n  }\n  let numberOfDoubleDots = 0;\n  let isAbsolute = false;\n  const res = commands.reduce((res2, cmd, cmdIdx) => {\n    if (typeof cmd === \"object\" && cmd != null) {\n      if (cmd.outlets) {\n        const outlets = {};\n        Object.entries(cmd.outlets).forEach(([name, commands2]) => {\n          outlets[name] = typeof commands2 === \"string\" ? commands2.split(\"/\") : commands2;\n        });\n        return [...res2, {\n          outlets\n        }];\n      }\n      if (cmd.segmentPath) {\n        return [...res2, cmd.segmentPath];\n      }\n    }\n    if (!(typeof cmd === \"string\")) {\n      return [...res2, cmd];\n    }\n    if (cmdIdx === 0) {\n      cmd.split(\"/\").forEach((urlPart, partIndex) => {\n        if (partIndex == 0 && urlPart === \".\") ;\n        else if (partIndex == 0 && urlPart === \"\") {\n          isAbsolute = true;\n        } else if (urlPart === \"..\") {\n          numberOfDoubleDots++;\n        } else if (urlPart != \"\") {\n          res2.push(urlPart);\n        }\n      });\n      return res2;\n    }\n    return [...res2, cmd];\n  }, []);\n  return new Navigation(isAbsolute, numberOfDoubleDots, res);\n}\nvar Position = class {\n  segmentGroup;\n  processChildren;\n  index;\n  constructor(segmentGroup, processChildren, index) {\n    this.segmentGroup = segmentGroup;\n    this.processChildren = processChildren;\n    this.index = index;\n  }\n};\nfunction findStartingPositionForTargetGroup(nav, root, target) {\n  if (nav.isAbsolute) {\n    return new Position(root, true, 0);\n  }\n  if (!target) {\n    return new Position(root, false, NaN);\n  }\n  if (target.parent === null) {\n    return new Position(target, true, 0);\n  }\n  const modifier = isMatrixParams(nav.commands[0]) ? 0 : 1;\n  const index = target.segments.length - 1 + modifier;\n  return createPositionApplyingDoubleDots(target, index, nav.numberOfDoubleDots);\n}\nfunction createPositionApplyingDoubleDots(group, index, numberOfDoubleDots) {\n  let g = group;\n  let ci = index;\n  let dd = numberOfDoubleDots;\n  while (dd > ci) {\n    dd -= ci;\n    g = g.parent;\n    if (!g) {\n      throw new RuntimeError(4005, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Invalid number of '../'\");\n    }\n    ci = g.segments.length;\n  }\n  return new Position(g, false, ci - dd);\n}\nfunction getOutlets(commands) {\n  if (isCommandWithOutlets(commands[0])) {\n    return commands[0].outlets;\n  }\n  return {\n    [PRIMARY_OUTLET]: commands\n  };\n}\nfunction updateSegmentGroup(segmentGroup, startIndex, commands) {\n  segmentGroup ??= new UrlSegmentGroup([], {});\n  if (segmentGroup.segments.length === 0 && segmentGroup.hasChildren()) {\n    return updateSegmentGroupChildren(segmentGroup, startIndex, commands);\n  }\n  const m = prefixedWith(segmentGroup, startIndex, commands);\n  const slicedCommands = commands.slice(m.commandIndex);\n  if (m.match && m.pathIndex < segmentGroup.segments.length) {\n    const g = new UrlSegmentGroup(segmentGroup.segments.slice(0, m.pathIndex), {});\n    g.children[PRIMARY_OUTLET] = new UrlSegmentGroup(segmentGroup.segments.slice(m.pathIndex), segmentGroup.children);\n    return updateSegmentGroupChildren(g, 0, slicedCommands);\n  } else if (m.match && slicedCommands.length === 0) {\n    return new UrlSegmentGroup(segmentGroup.segments, {});\n  } else if (m.match && !segmentGroup.hasChildren()) {\n    return createNewSegmentGroup(segmentGroup, startIndex, commands);\n  } else if (m.match) {\n    return updateSegmentGroupChildren(segmentGroup, 0, slicedCommands);\n  } else {\n    return createNewSegmentGroup(segmentGroup, startIndex, commands);\n  }\n}\nfunction updateSegmentGroupChildren(segmentGroup, startIndex, commands) {\n  if (commands.length === 0) {\n    return new UrlSegmentGroup(segmentGroup.segments, {});\n  } else {\n    const outlets = getOutlets(commands);\n    const children = {};\n    if (Object.keys(outlets).some((o) => o !== PRIMARY_OUTLET) && segmentGroup.children[PRIMARY_OUTLET] && segmentGroup.numberOfChildren === 1 && segmentGroup.children[PRIMARY_OUTLET].segments.length === 0) {\n      const childrenOfEmptyChild = updateSegmentGroupChildren(segmentGroup.children[PRIMARY_OUTLET], startIndex, commands);\n      return new UrlSegmentGroup(segmentGroup.segments, childrenOfEmptyChild.children);\n    }\n    Object.entries(outlets).forEach(([outlet, commands2]) => {\n      if (typeof commands2 === \"string\") {\n        commands2 = [commands2];\n      }\n      if (commands2 !== null) {\n        children[outlet] = updateSegmentGroup(segmentGroup.children[outlet], startIndex, commands2);\n      }\n    });\n    Object.entries(segmentGroup.children).forEach(([childOutlet, child]) => {\n      if (outlets[childOutlet] === void 0) {\n        children[childOutlet] = child;\n      }\n    });\n    return new UrlSegmentGroup(segmentGroup.segments, children);\n  }\n}\nfunction prefixedWith(segmentGroup, startIndex, commands) {\n  let currentCommandIndex = 0;\n  let currentPathIndex = startIndex;\n  const noMatch2 = {\n    match: false,\n    pathIndex: 0,\n    commandIndex: 0\n  };\n  while (currentPathIndex < segmentGroup.segments.length) {\n    if (currentCommandIndex >= commands.length) return noMatch2;\n    const path = segmentGroup.segments[currentPathIndex];\n    const command = commands[currentCommandIndex];\n    if (isCommandWithOutlets(command)) {\n      break;\n    }\n    const curr = `${command}`;\n    const next = currentCommandIndex < commands.length - 1 ? commands[currentCommandIndex + 1] : null;\n    if (currentPathIndex > 0 && curr === void 0) break;\n    if (curr && next && typeof next === \"object\" && next.outlets === void 0) {\n      if (!compare(curr, next, path)) return noMatch2;\n      currentCommandIndex += 2;\n    } else {\n      if (!compare(curr, {}, path)) return noMatch2;\n      currentCommandIndex++;\n    }\n    currentPathIndex++;\n  }\n  return {\n    match: true,\n    pathIndex: currentPathIndex,\n    commandIndex: currentCommandIndex\n  };\n}\nfunction createNewSegmentGroup(segmentGroup, startIndex, commands) {\n  const paths = segmentGroup.segments.slice(0, startIndex);\n  let i = 0;\n  while (i < commands.length) {\n    const command = commands[i];\n    if (isCommandWithOutlets(command)) {\n      const children = createNewSegmentChildren(command.outlets);\n      return new UrlSegmentGroup(paths, children);\n    }\n    if (i === 0 && isMatrixParams(commands[0])) {\n      const p = segmentGroup.segments[startIndex];\n      paths.push(new UrlSegment(p.path, stringify(commands[0])));\n      i++;\n      continue;\n    }\n    const curr = isCommandWithOutlets(command) ? command.outlets[PRIMARY_OUTLET] : `${command}`;\n    const next = i < commands.length - 1 ? commands[i + 1] : null;\n    if (curr && next && isMatrixParams(next)) {\n      paths.push(new UrlSegment(curr, stringify(next)));\n      i += 2;\n    } else {\n      paths.push(new UrlSegment(curr, {}));\n      i++;\n    }\n  }\n  return new UrlSegmentGroup(paths, {});\n}\nfunction createNewSegmentChildren(outlets) {\n  const children = {};\n  Object.entries(outlets).forEach(([outlet, commands]) => {\n    if (typeof commands === \"string\") {\n      commands = [commands];\n    }\n    if (commands !== null) {\n      children[outlet] = createNewSegmentGroup(new UrlSegmentGroup([], {}), 0, commands);\n    }\n  });\n  return children;\n}\nfunction stringify(params) {\n  const res = {};\n  Object.entries(params).forEach(([k, v]) => res[k] = `${v}`);\n  return res;\n}\nfunction compare(path, params, segment) {\n  return path == segment.path && shallowEqual(params, segment.parameters);\n}\nvar IMPERATIVE_NAVIGATION = \"imperative\";\nvar EventType;\n(function(EventType2) {\n  EventType2[EventType2[\"NavigationStart\"] = 0] = \"NavigationStart\";\n  EventType2[EventType2[\"NavigationEnd\"] = 1] = \"NavigationEnd\";\n  EventType2[EventType2[\"NavigationCancel\"] = 2] = \"NavigationCancel\";\n  EventType2[EventType2[\"NavigationError\"] = 3] = \"NavigationError\";\n  EventType2[EventType2[\"RoutesRecognized\"] = 4] = \"RoutesRecognized\";\n  EventType2[EventType2[\"ResolveStart\"] = 5] = \"ResolveStart\";\n  EventType2[EventType2[\"ResolveEnd\"] = 6] = \"ResolveEnd\";\n  EventType2[EventType2[\"GuardsCheckStart\"] = 7] = \"GuardsCheckStart\";\n  EventType2[EventType2[\"GuardsCheckEnd\"] = 8] = \"GuardsCheckEnd\";\n  EventType2[EventType2[\"RouteConfigLoadStart\"] = 9] = \"RouteConfigLoadStart\";\n  EventType2[EventType2[\"RouteConfigLoadEnd\"] = 10] = \"RouteConfigLoadEnd\";\n  EventType2[EventType2[\"ChildActivationStart\"] = 11] = \"ChildActivationStart\";\n  EventType2[EventType2[\"ChildActivationEnd\"] = 12] = \"ChildActivationEnd\";\n  EventType2[EventType2[\"ActivationStart\"] = 13] = \"ActivationStart\";\n  EventType2[EventType2[\"ActivationEnd\"] = 14] = \"ActivationEnd\";\n  EventType2[EventType2[\"Scroll\"] = 15] = \"Scroll\";\n  EventType2[EventType2[\"NavigationSkipped\"] = 16] = \"NavigationSkipped\";\n})(EventType || (EventType = {}));\nvar RouterEvent = class {\n  id;\n  url;\n  constructor(id, url) {\n    this.id = id;\n    this.url = url;\n  }\n};\nvar NavigationStart = class extends RouterEvent {\n  type = EventType.NavigationStart;\n  navigationTrigger;\n  restoredState;\n  constructor(id, url, navigationTrigger = \"imperative\", restoredState = null) {\n    super(id, url);\n    this.navigationTrigger = navigationTrigger;\n    this.restoredState = restoredState;\n  }\n  toString() {\n    return `NavigationStart(id: ${this.id}, url: '${this.url}')`;\n  }\n};\nvar NavigationEnd = class extends RouterEvent {\n  urlAfterRedirects;\n  type = EventType.NavigationEnd;\n  constructor(id, url, urlAfterRedirects) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n  }\n  toString() {\n    return `NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`;\n  }\n};\nvar NavigationCancellationCode;\n(function(NavigationCancellationCode2) {\n  NavigationCancellationCode2[NavigationCancellationCode2[\"Redirect\"] = 0] = \"Redirect\";\n  NavigationCancellationCode2[NavigationCancellationCode2[\"SupersededByNewNavigation\"] = 1] = \"SupersededByNewNavigation\";\n  NavigationCancellationCode2[NavigationCancellationCode2[\"NoDataFromResolver\"] = 2] = \"NoDataFromResolver\";\n  NavigationCancellationCode2[NavigationCancellationCode2[\"GuardRejected\"] = 3] = \"GuardRejected\";\n  NavigationCancellationCode2[NavigationCancellationCode2[\"Aborted\"] = 4] = \"Aborted\";\n})(NavigationCancellationCode || (NavigationCancellationCode = {}));\nvar NavigationSkippedCode;\n(function(NavigationSkippedCode2) {\n  NavigationSkippedCode2[NavigationSkippedCode2[\"IgnoredSameUrlNavigation\"] = 0] = \"IgnoredSameUrlNavigation\";\n  NavigationSkippedCode2[NavigationSkippedCode2[\"IgnoredByUrlHandlingStrategy\"] = 1] = \"IgnoredByUrlHandlingStrategy\";\n})(NavigationSkippedCode || (NavigationSkippedCode = {}));\nvar NavigationCancel = class extends RouterEvent {\n  reason;\n  code;\n  type = EventType.NavigationCancel;\n  constructor(id, url, reason, code) {\n    super(id, url);\n    this.reason = reason;\n    this.code = code;\n  }\n  toString() {\n    return `NavigationCancel(id: ${this.id}, url: '${this.url}')`;\n  }\n};\nfunction isRedirectingEvent(event) {\n  return event instanceof NavigationCancel && (event.code === NavigationCancellationCode.Redirect || event.code === NavigationCancellationCode.SupersededByNewNavigation);\n}\nvar NavigationSkipped = class extends RouterEvent {\n  reason;\n  code;\n  type = EventType.NavigationSkipped;\n  constructor(id, url, reason, code) {\n    super(id, url);\n    this.reason = reason;\n    this.code = code;\n  }\n};\nvar NavigationError = class extends RouterEvent {\n  error;\n  target;\n  type = EventType.NavigationError;\n  constructor(id, url, error, target) {\n    super(id, url);\n    this.error = error;\n    this.target = target;\n  }\n  toString() {\n    return `NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`;\n  }\n};\nvar RoutesRecognized = class extends RouterEvent {\n  urlAfterRedirects;\n  state;\n  type = EventType.RoutesRecognized;\n  constructor(id, url, urlAfterRedirects, state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n  }\n  toString() {\n    return `RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n};\nvar GuardsCheckStart = class extends RouterEvent {\n  urlAfterRedirects;\n  state;\n  type = EventType.GuardsCheckStart;\n  constructor(id, url, urlAfterRedirects, state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n  }\n  toString() {\n    return `GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n};\nvar GuardsCheckEnd = class extends RouterEvent {\n  urlAfterRedirects;\n  state;\n  shouldActivate;\n  type = EventType.GuardsCheckEnd;\n  constructor(id, url, urlAfterRedirects, state, shouldActivate) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n    this.shouldActivate = shouldActivate;\n  }\n  toString() {\n    return `GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`;\n  }\n};\nvar ResolveStart = class extends RouterEvent {\n  urlAfterRedirects;\n  state;\n  type = EventType.ResolveStart;\n  constructor(id, url, urlAfterRedirects, state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n  }\n  toString() {\n    return `ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n};\nvar ResolveEnd = class extends RouterEvent {\n  urlAfterRedirects;\n  state;\n  type = EventType.ResolveEnd;\n  constructor(id, url, urlAfterRedirects, state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n  }\n  toString() {\n    return `ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n};\nvar RouteConfigLoadStart = class {\n  route;\n  type = EventType.RouteConfigLoadStart;\n  constructor(route) {\n    this.route = route;\n  }\n  toString() {\n    return `RouteConfigLoadStart(path: ${this.route.path})`;\n  }\n};\nvar RouteConfigLoadEnd = class {\n  route;\n  type = EventType.RouteConfigLoadEnd;\n  constructor(route) {\n    this.route = route;\n  }\n  toString() {\n    return `RouteConfigLoadEnd(path: ${this.route.path})`;\n  }\n};\nvar ChildActivationStart = class {\n  snapshot;\n  type = EventType.ChildActivationStart;\n  constructor(snapshot) {\n    this.snapshot = snapshot;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || \"\";\n    return `ChildActivationStart(path: '${path}')`;\n  }\n};\nvar ChildActivationEnd = class {\n  snapshot;\n  type = EventType.ChildActivationEnd;\n  constructor(snapshot) {\n    this.snapshot = snapshot;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || \"\";\n    return `ChildActivationEnd(path: '${path}')`;\n  }\n};\nvar ActivationStart = class {\n  snapshot;\n  type = EventType.ActivationStart;\n  constructor(snapshot) {\n    this.snapshot = snapshot;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || \"\";\n    return `ActivationStart(path: '${path}')`;\n  }\n};\nvar ActivationEnd = class {\n  snapshot;\n  type = EventType.ActivationEnd;\n  constructor(snapshot) {\n    this.snapshot = snapshot;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || \"\";\n    return `ActivationEnd(path: '${path}')`;\n  }\n};\nvar Scroll = class {\n  routerEvent;\n  position;\n  anchor;\n  scrollBehavior;\n  type = EventType.Scroll;\n  constructor(routerEvent, position, anchor, scrollBehavior) {\n    this.routerEvent = routerEvent;\n    this.position = position;\n    this.anchor = anchor;\n    this.scrollBehavior = scrollBehavior;\n  }\n  toString() {\n    const pos = this.position ? `${this.position[0]}, ${this.position[1]}` : null;\n    return `Scroll(anchor: '${this.anchor}', position: '${pos}')`;\n  }\n};\nvar BeforeActivateRoutes = class {\n};\nvar RedirectRequest = class {\n  url;\n  navigationBehaviorOptions;\n  constructor(url, navigationBehaviorOptions) {\n    this.url = url;\n    this.navigationBehaviorOptions = navigationBehaviorOptions;\n  }\n};\nfunction isPublicRouterEvent(e) {\n  return !(e instanceof BeforeActivateRoutes) && !(e instanceof RedirectRequest);\n}\nfunction stringifyEvent(routerEvent) {\n  switch (routerEvent.type) {\n    case EventType.ActivationEnd:\n      return `ActivationEnd(path: '${routerEvent.snapshot.routeConfig?.path || \"\"}')`;\n    case EventType.ActivationStart:\n      return `ActivationStart(path: '${routerEvent.snapshot.routeConfig?.path || \"\"}')`;\n    case EventType.ChildActivationEnd:\n      return `ChildActivationEnd(path: '${routerEvent.snapshot.routeConfig?.path || \"\"}')`;\n    case EventType.ChildActivationStart:\n      return `ChildActivationStart(path: '${routerEvent.snapshot.routeConfig?.path || \"\"}')`;\n    case EventType.GuardsCheckEnd:\n      return `GuardsCheckEnd(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state}, shouldActivate: ${routerEvent.shouldActivate})`;\n    case EventType.GuardsCheckStart:\n      return `GuardsCheckStart(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.NavigationCancel:\n      return `NavigationCancel(id: ${routerEvent.id}, url: '${routerEvent.url}')`;\n    case EventType.NavigationSkipped:\n      return `NavigationSkipped(id: ${routerEvent.id}, url: '${routerEvent.url}')`;\n    case EventType.NavigationEnd:\n      return `NavigationEnd(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}')`;\n    case EventType.NavigationError:\n      return `NavigationError(id: ${routerEvent.id}, url: '${routerEvent.url}', error: ${routerEvent.error})`;\n    case EventType.NavigationStart:\n      return `NavigationStart(id: ${routerEvent.id}, url: '${routerEvent.url}')`;\n    case EventType.ResolveEnd:\n      return `ResolveEnd(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.ResolveStart:\n      return `ResolveStart(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.RouteConfigLoadEnd:\n      return `RouteConfigLoadEnd(path: ${routerEvent.route.path})`;\n    case EventType.RouteConfigLoadStart:\n      return `RouteConfigLoadStart(path: ${routerEvent.route.path})`;\n    case EventType.RoutesRecognized:\n      return `RoutesRecognized(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.Scroll:\n      const pos = routerEvent.position ? `${routerEvent.position[0]}, ${routerEvent.position[1]}` : null;\n      return `Scroll(anchor: '${routerEvent.anchor}', position: '${pos}')`;\n  }\n}\nvar OutletContext = class {\n  rootInjector;\n  outlet = null;\n  route = null;\n  children;\n  attachRef = null;\n  get injector() {\n    return this.route?.snapshot._environmentInjector ?? this.rootInjector;\n  }\n  constructor(rootInjector) {\n    this.rootInjector = rootInjector;\n    this.children = new ChildrenOutletContexts(this.rootInjector);\n  }\n};\nvar ChildrenOutletContexts = class _ChildrenOutletContexts {\n  rootInjector;\n  contexts = /* @__PURE__ */ new Map();\n  constructor(rootInjector) {\n    this.rootInjector = rootInjector;\n  }\n  onChildOutletCreated(childName, outlet) {\n    const context = this.getOrCreateContext(childName);\n    context.outlet = outlet;\n    this.contexts.set(childName, context);\n  }\n  onChildOutletDestroyed(childName) {\n    const context = this.getContext(childName);\n    if (context) {\n      context.outlet = null;\n      context.attachRef = null;\n    }\n  }\n  onOutletDeactivated() {\n    const contexts = this.contexts;\n    this.contexts = /* @__PURE__ */ new Map();\n    return contexts;\n  }\n  onOutletReAttached(contexts) {\n    this.contexts = contexts;\n  }\n  getOrCreateContext(childName) {\n    let context = this.getContext(childName);\n    if (!context) {\n      context = new OutletContext(this.rootInjector);\n      this.contexts.set(childName, context);\n    }\n    return context;\n  }\n  getContext(childName) {\n    return this.contexts.get(childName) || null;\n  }\n  static fac = function ChildrenOutletContexts_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _ChildrenOutletContexts)(inject(EnvironmentInjector));\n  };\n  static prov = defineInjectable({\n    token: _ChildrenOutletContexts,\n    factory: _ChildrenOutletContexts.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(ChildrenOutletContexts, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: EnvironmentInjector\n  }], null);\n})();\nvar Tree = class {\n  _root;\n  constructor(root) {\n    this._root = root;\n  }\n  get root() {\n    return this._root.value;\n  }\n  parent(t) {\n    const p = this.pathFromRoot(t);\n    return p.length > 1 ? p[p.length - 2] : null;\n  }\n  children(t) {\n    const n = findNode(t, this._root);\n    return n ? n.children.map((t2) => t2.value) : [];\n  }\n  firstChild(t) {\n    const n = findNode(t, this._root);\n    return n && n.children.length > 0 ? n.children[0].value : null;\n  }\n  siblings(t) {\n    const p = findPath(t, this._root);\n    if (p.length < 2) return [];\n    const c = p[p.length - 2].children.map((c2) => c2.value);\n    return c.filter((cc) => cc !== t);\n  }\n  pathFromRoot(t) {\n    return findPath(t, this._root).map((s) => s.value);\n  }\n};\nfunction findNode(value, node) {\n  if (value === node.value) return node;\n  for (const child of node.children) {\n    const node2 = findNode(value, child);\n    if (node2) return node2;\n  }\n  return null;\n}\nfunction findPath(value, node) {\n  if (value === node.value) return [node];\n  for (const child of node.children) {\n    const path = findPath(value, child);\n    if (path.length) {\n      path.unshift(node);\n      return path;\n    }\n  }\n  return [];\n}\nvar TreeNode = class {\n  value;\n  children;\n  constructor(value, children) {\n    this.value = value;\n    this.children = children;\n  }\n  toString() {\n    return `TreeNode(${this.value})`;\n  }\n};\nfunction nodeChildrenAsMap(node) {\n  const map2 = {};\n  if (node) {\n    node.children.forEach((child) => map2[child.value.outlet] = child);\n  }\n  return map2;\n}\nvar RouterState = class extends Tree {\n  snapshot;\n  constructor(root, snapshot) {\n    super(root);\n    this.snapshot = snapshot;\n    setRouterState(this, root);\n  }\n  toString() {\n    return this.snapshot.toString();\n  }\n};\nfunction createEmptyState(rootComponent, injector) {\n  const snapshot = createEmptyStateSnapshot(rootComponent, injector);\n  const emptyUrl = new BehaviorSubject([new UrlSegment(\"\", {})]);\n  const emptyParams = new BehaviorSubject({});\n  const emptyData = new BehaviorSubject({});\n  const emptyQueryParams = new BehaviorSubject({});\n  const fragment = new BehaviorSubject(\"\");\n  const activated = new ActivatedRoute(emptyUrl, emptyParams, emptyQueryParams, fragment, emptyData, PRIMARY_OUTLET, rootComponent, snapshot.root);\n  activated.snapshot = snapshot.root;\n  return new RouterState(new TreeNode(activated, []), snapshot);\n}\nfunction createEmptyStateSnapshot(rootComponent, injector) {\n  const emptyParams = {};\n  const emptyData = {};\n  const emptyQueryParams = {};\n  const fragment = \"\";\n  const activated = new ActivatedRouteSnapshot([], emptyParams, emptyQueryParams, fragment, emptyData, PRIMARY_OUTLET, rootComponent, null, {}, injector);\n  return new RouterStateSnapshot(\"\", new TreeNode(activated, []));\n}\nvar ActivatedRoute = class {\n  urlSubject;\n  paramsSubject;\n  queryParamsSubject;\n  fragmentSubject;\n  dataSubject;\n  outlet;\n  component;\n  snapshot;\n  _futureSnapshot;\n  _routerState;\n  _paramMap;\n  _queryParamMap;\n  title;\n  url;\n  params;\n  queryParams;\n  fragment;\n  data;\n  constructor(urlSubject, paramsSubject, queryParamsSubject, fragmentSubject, dataSubject, outlet, component, futureSnapshot) {\n    this.urlSubject = urlSubject;\n    this.paramsSubject = paramsSubject;\n    this.queryParamsSubject = queryParamsSubject;\n    this.fragmentSubject = fragmentSubject;\n    this.dataSubject = dataSubject;\n    this.outlet = outlet;\n    this.component = component;\n    this._futureSnapshot = futureSnapshot;\n    this.title = this.dataSubject?.pipe(map((d) => d[RouteTitleKey])) ?? of(void 0);\n    this.url = urlSubject;\n    this.params = paramsSubject;\n    this.queryParams = queryParamsSubject;\n    this.fragment = fragmentSubject;\n    this.data = dataSubject;\n  }\n  get routeConfig() {\n    return this._futureSnapshot.routeConfig;\n  }\n  get root() {\n    return this._routerState.root;\n  }\n  get parent() {\n    return this._routerState.parent(this);\n  }\n  get firstChild() {\n    return this._routerState.firstChild(this);\n  }\n  get children() {\n    return this._routerState.children(this);\n  }\n  get pathFromRoot() {\n    return this._routerState.pathFromRoot(this);\n  }\n  get paramMap() {\n    this._paramMap ??= this.params.pipe(map((p) => convertToParamMap(p)));\n    return this._paramMap;\n  }\n  get queryParamMap() {\n    this._queryParamMap ??= this.queryParams.pipe(map((p) => convertToParamMap(p)));\n    return this._queryParamMap;\n  }\n  toString() {\n    return this.snapshot ? this.snapshot.toString() : `Future(${this._futureSnapshot})`;\n  }\n};\nfunction getInherited(route, parent, paramsInheritanceStrategy = \"emptyOnly\") {\n  let inherited;\n  const {\n    routeConfig\n  } = route;\n  if (parent !== null && (paramsInheritanceStrategy === \"always\" || routeConfig?.path === \"\" || !parent.component && !parent.routeConfig?.loadComponent)) {\n    inherited = {\n      params: __spreadValues(__spreadValues({}, parent.params), route.params),\n      data: __spreadValues(__spreadValues({}, parent.data), route.data),\n      resolve: __spreadValues(__spreadValues(__spreadValues(__spreadValues({}, route.data), parent.data), routeConfig?.data), route._resolvedData)\n    };\n  } else {\n    inherited = {\n      params: __spreadValues({}, route.params),\n      data: __spreadValues({}, route.data),\n      resolve: __spreadValues(__spreadValues({}, route.data), route._resolvedData ?? {})\n    };\n  }\n  if (routeConfig && hasStaticTitle(routeConfig)) {\n    inherited.resolve[RouteTitleKey] = routeConfig.title;\n  }\n  return inherited;\n}\nvar ActivatedRouteSnapshot = class {\n  url;\n  params;\n  queryParams;\n  fragment;\n  data;\n  outlet;\n  component;\n  routeConfig;\n  _resolve;\n  _resolvedData;\n  _routerState;\n  _paramMap;\n  _queryParamMap;\n  _environmentInjector;\n  get title() {\n    return this.data?.[RouteTitleKey];\n  }\n  constructor(url, params, queryParams, fragment, data, outlet, component, routeConfig, resolve, environmentInjector) {\n    this.url = url;\n    this.params = params;\n    this.queryParams = queryParams;\n    this.fragment = fragment;\n    this.data = data;\n    this.outlet = outlet;\n    this.component = component;\n    this.routeConfig = routeConfig;\n    this._resolve = resolve;\n    this._environmentInjector = environmentInjector;\n  }\n  get root() {\n    return this._routerState.root;\n  }\n  get parent() {\n    return this._routerState.parent(this);\n  }\n  get firstChild() {\n    return this._routerState.firstChild(this);\n  }\n  get children() {\n    return this._routerState.children(this);\n  }\n  get pathFromRoot() {\n    return this._routerState.pathFromRoot(this);\n  }\n  get paramMap() {\n    this._paramMap ??= convertToParamMap(this.params);\n    return this._paramMap;\n  }\n  get queryParamMap() {\n    this._queryParamMap ??= convertToParamMap(this.queryParams);\n    return this._queryParamMap;\n  }\n  toString() {\n    const url = this.url.map((segment) => segment.toString()).join(\"/\");\n    const matched = this.routeConfig ? this.routeConfig.path : \"\";\n    return `Route(url:'${url}', path:'${matched}')`;\n  }\n};\nvar RouterStateSnapshot = class extends Tree {\n  url;\n  constructor(url, root) {\n    super(root);\n    this.url = url;\n    setRouterState(this, root);\n  }\n  toString() {\n    return serializeNode(this._root);\n  }\n};\nfunction setRouterState(state, node) {\n  node.value._routerState = state;\n  node.children.forEach((c) => setRouterState(state, c));\n}\nfunction serializeNode(node) {\n  const c = node.children.length > 0 ? ` { ${node.children.map(serializeNode).join(\", \")} } ` : \"\";\n  return `${node.value}${c}`;\n}\nfunction advanceActivatedRoute(route) {\n  if (route.snapshot) {\n    const currentSnapshot = route.snapshot;\n    const nextSnapshot = route._futureSnapshot;\n    route.snapshot = nextSnapshot;\n    if (!shallowEqual(currentSnapshot.queryParams, nextSnapshot.queryParams)) {\n      route.queryParamsSubject.next(nextSnapshot.queryParams);\n    }\n    if (currentSnapshot.fragment !== nextSnapshot.fragment) {\n      route.fragmentSubject.next(nextSnapshot.fragment);\n    }\n    if (!shallowEqual(currentSnapshot.params, nextSnapshot.params)) {\n      route.paramsSubject.next(nextSnapshot.params);\n    }\n    if (!shallowEqualArrays(currentSnapshot.url, nextSnapshot.url)) {\n      route.urlSubject.next(nextSnapshot.url);\n    }\n    if (!shallowEqual(currentSnapshot.data, nextSnapshot.data)) {\n      route.dataSubject.next(nextSnapshot.data);\n    }\n  } else {\n    route.snapshot = route._futureSnapshot;\n    route.dataSubject.next(route._futureSnapshot.data);\n  }\n}\nfunction equalParamsAndUrlSegments(a, b) {\n  const equalUrlParams = shallowEqual(a.params, b.params) && equalSegments(a.url, b.url);\n  const parentsMismatch = !a.parent !== !b.parent;\n  return equalUrlParams && !parentsMismatch && (!a.parent || equalParamsAndUrlSegments(a.parent, b.parent));\n}\nfunction hasStaticTitle(config) {\n  return typeof config.title === \"string\" || config.title === null;\n}\nvar ROUTER_OUTLET_DATA = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"RouterOutlet data\" : \"\");\nvar RouterOutlet = class _RouterOutlet {\n  activated = null;\n  get activatedComponentRef() {\n    return this.activated;\n  }\n  _activatedRoute = null;\n  name = PRIMARY_OUTLET;\n  activateEvents = new EventEmitter();\n  deactivateEvents = new EventEmitter();\n  attachEvents = new EventEmitter();\n  detachEvents = new EventEmitter();\n  routerOutletData = input(...ngDevMode ? [void 0, {\n    debugName: \"routerOutletData\"\n  }] : []);\n  parentContexts = inject(ChildrenOutletContexts);\n  location = inject(ViewContainerRef);\n  changeDetector = inject(ChangeDetectorRef);\n  inputBinder = inject(INPUT_BINDER, {\n    optional: true\n  });\n  supportsBindingToComponentInputs = true;\n  ngOnChanges(changes) {\n    if (changes[\"name\"]) {\n      const {\n        firstChange,\n        previousValue\n      } = changes[\"name\"];\n      if (firstChange) {\n        return;\n      }\n      if (this.isTrackedInParentContexts(previousValue)) {\n        this.deactivate();\n        this.parentContexts.onChildOutletDestroyed(previousValue);\n      }\n      this.initializeOutletWithName();\n    }\n  }\n  ngOnDestroy() {\n    if (this.isTrackedInParentContexts(this.name)) {\n      this.parentContexts.onChildOutletDestroyed(this.name);\n    }\n    this.inputBinder?.unsubscribeFromRouteData(this);\n  }\n  isTrackedInParentContexts(outletName) {\n    return this.parentContexts.getContext(outletName)?.outlet === this;\n  }\n  ngOnInit() {\n    this.initializeOutletWithName();\n  }\n  initializeOutletWithName() {\n    this.parentContexts.onChildOutletCreated(this.name, this);\n    if (this.activated) {\n      return;\n    }\n    const context = this.parentContexts.getContext(this.name);\n    if (context?.route) {\n      if (context.attachRef) {\n        this.attach(context.attachRef, context.route);\n      } else {\n        this.activateWith(context.route, context.injector);\n      }\n    }\n  }\n  get isActivated() {\n    return !!this.activated;\n  }\n  get component() {\n    if (!this.activated) throw new RuntimeError(4012, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Outlet is not activated\");\n    return this.activated.instance;\n  }\n  get activatedRoute() {\n    if (!this.activated) throw new RuntimeError(4012, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Outlet is not activated\");\n    return this._activatedRoute;\n  }\n  get activatedRouteData() {\n    if (this._activatedRoute) {\n      return this._activatedRoute.snapshot.data;\n    }\n    return {};\n  }\n  detach() {\n    if (!this.activated) throw new RuntimeError(4012, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Outlet is not activated\");\n    this.location.detach();\n    const cmp = this.activated;\n    this.activated = null;\n    this._activatedRoute = null;\n    this.detachEvents.emit(cmp.instance);\n    return cmp;\n  }\n  attach(ref, activatedRoute) {\n    this.activated = ref;\n    this._activatedRoute = activatedRoute;\n    this.location.insert(ref.hostView);\n    this.inputBinder?.bindActivatedRouteToOutletComponent(this);\n    this.attachEvents.emit(ref.instance);\n  }\n  deactivate() {\n    if (this.activated) {\n      const c = this.component;\n      this.activated.destroy();\n      this.activated = null;\n      this._activatedRoute = null;\n      this.deactivateEvents.emit(c);\n    }\n  }\n  activateWith(activatedRoute, environmentInjector) {\n    if (this.isActivated) {\n      throw new RuntimeError(4013, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Cannot activate an already activated outlet\");\n    }\n    this._activatedRoute = activatedRoute;\n    const location = this.location;\n    const snapshot = activatedRoute.snapshot;\n    const component = snapshot.component;\n    const childContexts = this.parentContexts.getOrCreateContext(this.name).children;\n    const injector = new OutletInjector(activatedRoute, childContexts, location.injector, this.routerOutletData);\n    this.activated = location.createComponent(component, {\n      index: location.length,\n      injector,\n      environmentInjector\n    });\n    this.changeDetector.markForCheck();\n    this.inputBinder?.bindActivatedRouteToOutletComponent(this);\n    this.activateEvents.emit(this.activated.instance);\n  }\n  static fac = function RouterOutlet_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouterOutlet)();\n  };\n  static dir = defineDirective({\n    type: _RouterOutlet,\n    selectors: [[\"router-outlet\"]],\n    inputs: {\n      name: \"name\",\n      routerOutletData: [1, \"routerOutletData\"]\n    },\n    outputs: {\n      activateEvents: \"activate\",\n      deactivateEvents: \"deactivate\",\n      attachEvents: \"attach\",\n      detachEvents: \"detach\"\n    },\n    exportAs: [\"outlet\"],\n    features: [NgOnChangesFeature]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterOutlet, [{\n    type: Directive,\n    args: [{\n      selector: \"router-outlet\",\n      exportAs: \"outlet\"\n    }]\n  }], null, {\n    name: [{\n      type: Input\n    }],\n    activateEvents: [{\n      type: Output,\n      args: [\"activate\"]\n    }],\n    deactivateEvents: [{\n      type: Output,\n      args: [\"deactivate\"]\n    }],\n    attachEvents: [{\n      type: Output,\n      args: [\"attach\"]\n    }],\n    detachEvents: [{\n      type: Output,\n      args: [\"detach\"]\n    }],\n    routerOutletData: [{\n      type: Input,\n      args: [{\n        isSignal: true,\n        alias: \"routerOutletData\",\n        required: false\n      }]\n    }]\n  });\n})();\nvar OutletInjector = class {\n  route;\n  childContexts;\n  parent;\n  outletData;\n  constructor(route, childContexts, parent, outletData) {\n    this.route = route;\n    this.childContexts = childContexts;\n    this.parent = parent;\n    this.outletData = outletData;\n  }\n  get(token, notFoundValue) {\n    if (token === ActivatedRoute) {\n      return this.route;\n    }\n    if (token === ChildrenOutletContexts) {\n      return this.childContexts;\n    }\n    if (token === ROUTER_OUTLET_DATA) {\n      return this.outletData;\n    }\n    return this.parent.get(token, notFoundValue);\n  }\n};\nvar INPUT_BINDER = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"Router Input Binder\" : \"\");\nvar RoutedComponentInputBinder = class _RoutedComponentInputBinder {\n  outletDataSubscriptions = /* @__PURE__ */ new Map();\n  bindActivatedRouteToOutletComponent(outlet) {\n    this.unsubscribeFromRouteData(outlet);\n    this.subscribeToRouteData(outlet);\n  }\n  unsubscribeFromRouteData(outlet) {\n    this.outletDataSubscriptions.get(outlet)?.unsubscribe();\n    this.outletDataSubscriptions.delete(outlet);\n  }\n  subscribeToRouteData(outlet) {\n    const {\n      activatedRoute\n    } = outlet;\n    const dataSubscription = combineLatest([activatedRoute.queryParams, activatedRoute.params, activatedRoute.data]).pipe(switchMap(([queryParams, params, data], index) => {\n      data = __spreadValues(__spreadValues(__spreadValues({}, queryParams), params), data);\n      if (index === 0) {\n        return of(data);\n      }\n      return Promise.resolve(data);\n    })).subscribe((data) => {\n      if (!outlet.isActivated || !outlet.activatedComponentRef || outlet.activatedRoute !== activatedRoute || activatedRoute.component === null) {\n        this.unsubscribeFromRouteData(outlet);\n        return;\n      }\n      const mirror = reflectComponentType(activatedRoute.component);\n      if (!mirror) {\n        this.unsubscribeFromRouteData(outlet);\n        return;\n      }\n      for (const {\n        templateName\n      } of mirror.inputs) {\n        outlet.activatedComponentRef.setInput(templateName, data[templateName]);\n      }\n    });\n    this.outletDataSubscriptions.set(outlet, dataSubscription);\n  }\n  static fac = function RoutedComponentInputBinder_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RoutedComponentInputBinder)();\n  };\n  static prov = defineInjectable({\n    token: _RoutedComponentInputBinder,\n    factory: _RoutedComponentInputBinder.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RoutedComponentInputBinder, [{\n    type: Injectable\n  }], null, null);\n})();\nvar EmptyOutletComponent = class _EmptyOutletComponent {\n  static fac = function EmptyOutletComponent_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _EmptyOutletComponent)();\n  };\n  static cmp = defineComponent({\n    type: _EmptyOutletComponent,\n    selectors: [[\"ng-component\"]],\n    exportAs: [\"emptyRouterOutlet\"],\n    decls: 1,\n    vars: 0,\n    template: function _EmptyOutletComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        element(0, \"router-outlet\");\n      }\n    },\n    dependencies: [RouterOutlet],\n    encapsulation: 2\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(EmptyOutletComponent, [{\n    type: Component,\n    args: [{\n      template: `<router-outlet />`,\n      imports: [RouterOutlet],\n      exportAs: \"emptyRouterOutlet\"\n    }]\n  }], null, null);\n})();\nfunction standardizeConfig(r) {\n  const children = r.children && r.children.map(standardizeConfig);\n  const c = children ? __spreadProps(__spreadValues({}, r), {\n    children\n  }) : __spreadValues({}, r);\n  if (!c.component && !c.loadComponent && (children || c.loadChildren) && c.outlet && c.outlet !== PRIMARY_OUTLET) {\n    c.component = EmptyOutletComponent;\n  }\n  return c;\n}\nfunction createRouterState(routeReuseStrategy, curr, prevState) {\n  const root = createNode(routeReuseStrategy, curr._root, prevState ? prevState._root : void 0);\n  return new RouterState(root, curr);\n}\nfunction createNode(routeReuseStrategy, curr, prevState) {\n  if (prevState && routeReuseStrategy.shouldReuseRoute(curr.value, prevState.value.snapshot)) {\n    const value = prevState.value;\n    value._futureSnapshot = curr.value;\n    const children = createOrReuseChildren(routeReuseStrategy, curr, prevState);\n    return new TreeNode(value, children);\n  } else {\n    if (routeReuseStrategy.shouldAttach(curr.value)) {\n      const detachedRouteHandle = routeReuseStrategy.retrieve(curr.value);\n      if (detachedRouteHandle !== null) {\n        const tree2 = detachedRouteHandle.route;\n        tree2.value._futureSnapshot = curr.value;\n        tree2.children = curr.children.map((c) => createNode(routeReuseStrategy, c));\n        return tree2;\n      }\n    }\n    const value = createActivatedRoute(curr.value);\n    const children = curr.children.map((c) => createNode(routeReuseStrategy, c));\n    return new TreeNode(value, children);\n  }\n}\nfunction createOrReuseChildren(routeReuseStrategy, curr, prevState) {\n  return curr.children.map((child) => {\n    for (const p of prevState.children) {\n      if (routeReuseStrategy.shouldReuseRoute(child.value, p.value.snapshot)) {\n        return createNode(routeReuseStrategy, child, p);\n      }\n    }\n    return createNode(routeReuseStrategy, child);\n  });\n}\nfunction createActivatedRoute(c) {\n  return new ActivatedRoute(new BehaviorSubject(c.url), new BehaviorSubject(c.params), new BehaviorSubject(c.queryParams), new BehaviorSubject(c.fragment), new BehaviorSubject(c.data), c.outlet, c.component, c);\n}\nvar RedirectCommand = class {\n  redirectTo;\n  navigationBehaviorOptions;\n  constructor(redirectTo, navigationBehaviorOptions) {\n    this.redirectTo = redirectTo;\n    this.navigationBehaviorOptions = navigationBehaviorOptions;\n  }\n};\nvar NAVIGATION_CANCELING_ERROR = \"ngNavigationCancelingError\";\nfunction redirectingNavigationError(urlSerializer, redirect) {\n  const {\n    redirectTo,\n    navigationBehaviorOptions\n  } = isUrlTree(redirect) ? {\n    redirectTo: redirect,\n    navigationBehaviorOptions: void 0\n  } : redirect;\n  const error = navigationCancelingError(ngDevMode && `Redirecting to \"${urlSerializer.serialize(redirectTo)}\"`, NavigationCancellationCode.Redirect);\n  error.url = redirectTo;\n  error.navigationBehaviorOptions = navigationBehaviorOptions;\n  return error;\n}\nfunction navigationCancelingError(message, code) {\n  const error = new Error(`NavigationCancelingError: ${message || \"\"}`);\n  error[NAVIGATION_CANCELING_ERROR] = true;\n  error.cancellationCode = code;\n  return error;\n}\nfunction isRedirectingNavigationCancelingError(error) {\n  return isNavigationCancelingError(error) && isUrlTree(error.url);\n}\nfunction isNavigationCancelingError(error) {\n  return !!error && error[NAVIGATION_CANCELING_ERROR];\n}\nvar warnedAboutUnsupportedInputBinding = false;\nvar ActivateRoutes = class {\n  routeReuseStrategy;\n  futureState;\n  currState;\n  forwardEvent;\n  inputBindingEnabled;\n  constructor(routeReuseStrategy, futureState, currState, forwardEvent, inputBindingEnabled) {\n    this.routeReuseStrategy = routeReuseStrategy;\n    this.futureState = futureState;\n    this.currState = currState;\n    this.forwardEvent = forwardEvent;\n    this.inputBindingEnabled = inputBindingEnabled;\n  }\n  activate(parentContexts) {\n    const futureRoot = this.futureState._root;\n    const currRoot = this.currState ? this.currState._root : null;\n    this.deactivateChildRoutes(futureRoot, currRoot, parentContexts);\n    advanceActivatedRoute(this.futureState.root);\n    this.activateChildRoutes(futureRoot, currRoot, parentContexts);\n  }\n  deactivateChildRoutes(futureNode, currNode, contexts) {\n    const children = nodeChildrenAsMap(currNode);\n    futureNode.children.forEach((futureChild) => {\n      const childOutletName = futureChild.value.outlet;\n      this.deactivateRoutes(futureChild, children[childOutletName], contexts);\n      delete children[childOutletName];\n    });\n    Object.values(children).forEach((v) => {\n      this.deactivateRouteAndItsChildren(v, contexts);\n    });\n  }\n  deactivateRoutes(futureNode, currNode, parentContext) {\n    const future = futureNode.value;\n    const curr = currNode ? currNode.value : null;\n    if (future === curr) {\n      if (future.component) {\n        const context = parentContext.getContext(future.outlet);\n        if (context) {\n          this.deactivateChildRoutes(futureNode, currNode, context.children);\n        }\n      } else {\n        this.deactivateChildRoutes(futureNode, currNode, parentContext);\n      }\n    } else {\n      if (curr) {\n        this.deactivateRouteAndItsChildren(currNode, parentContext);\n      }\n    }\n  }\n  deactivateRouteAndItsChildren(route, parentContexts) {\n    if (route.value.component && this.routeReuseStrategy.shouldDetach(route.value.snapshot)) {\n      this.detachAndStoreRouteSubtree(route, parentContexts);\n    } else {\n      this.deactivateRouteAndOutlet(route, parentContexts);\n    }\n  }\n  detachAndStoreRouteSubtree(route, parentContexts) {\n    const context = parentContexts.getContext(route.value.outlet);\n    const contexts = context && route.value.component ? context.children : parentContexts;\n    const children = nodeChildrenAsMap(route);\n    for (const treeNode of Object.values(children)) {\n      this.deactivateRouteAndItsChildren(treeNode, contexts);\n    }\n    if (context && context.outlet) {\n      const componentRef = context.outlet.detach();\n      const contexts2 = context.children.onOutletDeactivated();\n      this.routeReuseStrategy.store(route.value.snapshot, {\n        componentRef,\n        route,\n        contexts: contexts2\n      });\n    }\n  }\n  deactivateRouteAndOutlet(route, parentContexts) {\n    const context = parentContexts.getContext(route.value.outlet);\n    const contexts = context && route.value.component ? context.children : parentContexts;\n    const children = nodeChildrenAsMap(route);\n    for (const treeNode of Object.values(children)) {\n      this.deactivateRouteAndItsChildren(treeNode, contexts);\n    }\n    if (context) {\n      if (context.outlet) {\n        context.outlet.deactivate();\n        context.children.onOutletDeactivated();\n      }\n      context.attachRef = null;\n      context.route = null;\n    }\n  }\n  activateChildRoutes(futureNode, currNode, contexts) {\n    const children = nodeChildrenAsMap(currNode);\n    futureNode.children.forEach((c) => {\n      this.activateRoutes(c, children[c.value.outlet], contexts);\n      this.forwardEvent(new ActivationEnd(c.value.snapshot));\n    });\n    if (futureNode.children.length) {\n      this.forwardEvent(new ChildActivationEnd(futureNode.value.snapshot));\n    }\n  }\n  activateRoutes(futureNode, currNode, parentContexts) {\n    const future = futureNode.value;\n    const curr = currNode ? currNode.value : null;\n    advanceActivatedRoute(future);\n    if (future === curr) {\n      if (future.component) {\n        const context = parentContexts.getOrCreateContext(future.outlet);\n        this.activateChildRoutes(futureNode, currNode, context.children);\n      } else {\n        this.activateChildRoutes(futureNode, currNode, parentContexts);\n      }\n    } else {\n      if (future.component) {\n        const context = parentContexts.getOrCreateContext(future.outlet);\n        if (this.routeReuseStrategy.shouldAttach(future.snapshot)) {\n          const stored = this.routeReuseStrategy.retrieve(future.snapshot);\n          this.routeReuseStrategy.store(future.snapshot, null);\n          context.children.onOutletReAttached(stored.contexts);\n          context.attachRef = stored.componentRef;\n          context.route = stored.route.value;\n          if (context.outlet) {\n            context.outlet.attach(stored.componentRef, stored.route.value);\n          }\n          advanceActivatedRoute(stored.route.value);\n          this.activateChildRoutes(futureNode, null, context.children);\n        } else {\n          context.attachRef = null;\n          context.route = future;\n          if (context.outlet) {\n            context.outlet.activateWith(future, context.injector);\n          }\n          this.activateChildRoutes(futureNode, null, context.children);\n        }\n      } else {\n        this.activateChildRoutes(futureNode, null, parentContexts);\n      }\n    }\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      const context = parentContexts.getOrCreateContext(future.outlet);\n      const outlet = context.outlet;\n      if (outlet && this.inputBindingEnabled && !outlet.supportsBindingToComponentInputs && !warnedAboutUnsupportedInputBinding) {\n        console.warn(`'withComponentInputBinding' feature is enabled but this application is using an outlet that may not support binding to component inputs.`);\n        warnedAboutUnsupportedInputBinding = true;\n      }\n    }\n  }\n};\nvar CanActivate = class {\n  path;\n  route;\n  constructor(path) {\n    this.path = path;\n    this.route = this.path[this.path.length - 1];\n  }\n};\nvar CanDeactivate = class {\n  component;\n  route;\n  constructor(component, route) {\n    this.component = component;\n    this.route = route;\n  }\n};\nfunction getAllRouteGuards(future, curr, parentContexts) {\n  const futureRoot = future._root;\n  const currRoot = curr ? curr._root : null;\n  return getChildRouteGuards(futureRoot, currRoot, parentContexts, [futureRoot.value]);\n}\nfunction getCanActivateChild(p) {\n  const canActivateChild = p.routeConfig ? p.routeConfig.canActivateChild : null;\n  if (!canActivateChild || canActivateChild.length === 0) return null;\n  return {\n    node: p,\n    guards: canActivateChild\n  };\n}\nfunction getTokenOrFunctionIdentity(tokenOrFunction, injector) {\n  const NOT_FOUND = /* @__PURE__ */ Symbol();\n  const result = injector.get(tokenOrFunction, NOT_FOUND);\n  if (result === NOT_FOUND) {\n    if (typeof tokenOrFunction === \"function\" && !isInjectable(tokenOrFunction)) {\n      return tokenOrFunction;\n    } else {\n      return injector.get(tokenOrFunction);\n    }\n  }\n  return result;\n}\nfunction getChildRouteGuards(futureNode, currNode, contexts, futurePath, checks = {\n  canDeactivateChecks: [],\n  canActivateChecks: []\n}) {\n  const prevChildren = nodeChildrenAsMap(currNode);\n  futureNode.children.forEach((c) => {\n    getRouteGuards(c, prevChildren[c.value.outlet], contexts, futurePath.concat([c.value]), checks);\n    delete prevChildren[c.value.outlet];\n  });\n  Object.entries(prevChildren).forEach(([k, v]) => deactivateRouteAndItsChildren(v, contexts.getContext(k), checks));\n  return checks;\n}\nfunction getRouteGuards(futureNode, currNode, parentContexts, futurePath, checks = {\n  canDeactivateChecks: [],\n  canActivateChecks: []\n}) {\n  const future = futureNode.value;\n  const curr = currNode ? currNode.value : null;\n  const context = parentContexts ? parentContexts.getContext(futureNode.value.outlet) : null;\n  if (curr && future.routeConfig === curr.routeConfig) {\n    const shouldRun = shouldRunGuardsAndResolvers(curr, future, future.routeConfig.runGuardsAndResolvers);\n    if (shouldRun) {\n      checks.canActivateChecks.push(new CanActivate(futurePath));\n    } else {\n      future.data = curr.data;\n      future._resolvedData = curr._resolvedData;\n    }\n    if (future.component) {\n      getChildRouteGuards(futureNode, currNode, context ? context.children : null, futurePath, checks);\n    } else {\n      getChildRouteGuards(futureNode, currNode, parentContexts, futurePath, checks);\n    }\n    if (shouldRun && context && context.outlet && context.outlet.isActivated) {\n      checks.canDeactivateChecks.push(new CanDeactivate(context.outlet.component, curr));\n    }\n  } else {\n    if (curr) {\n      deactivateRouteAndItsChildren(currNode, context, checks);\n    }\n    checks.canActivateChecks.push(new CanActivate(futurePath));\n    if (future.component) {\n      getChildRouteGuards(futureNode, null, context ? context.children : null, futurePath, checks);\n    } else {\n      getChildRouteGuards(futureNode, null, parentContexts, futurePath, checks);\n    }\n  }\n  return checks;\n}\nfunction shouldRunGuardsAndResolvers(curr, future, mode) {\n  if (typeof mode === \"function\") {\n    return runInInjectionContext(future._environmentInjector, () => mode(curr, future));\n  }\n  switch (mode) {\n    case \"pathParamsChange\":\n      return !equalPath(curr.url, future.url);\n    case \"pathParamsOrQueryParamsChange\":\n      return !equalPath(curr.url, future.url) || !shallowEqual(curr.queryParams, future.queryParams);\n    case \"always\":\n      return true;\n    case \"paramsOrQueryParamsChange\":\n      return !equalParamsAndUrlSegments(curr, future) || !shallowEqual(curr.queryParams, future.queryParams);\n    case \"paramsChange\":\n    default:\n      return !equalParamsAndUrlSegments(curr, future);\n  }\n}\nfunction deactivateRouteAndItsChildren(route, context, checks) {\n  const children = nodeChildrenAsMap(route);\n  const r = route.value;\n  Object.entries(children).forEach(([childName, node]) => {\n    if (!r.component) {\n      deactivateRouteAndItsChildren(node, context, checks);\n    } else if (context) {\n      deactivateRouteAndItsChildren(node, context.children.getContext(childName), checks);\n    } else {\n      deactivateRouteAndItsChildren(node, null, checks);\n    }\n  });\n  if (!r.component) {\n    checks.canDeactivateChecks.push(new CanDeactivate(null, r));\n  } else if (context && context.outlet && context.outlet.isActivated) {\n    checks.canDeactivateChecks.push(new CanDeactivate(context.outlet.component, r));\n  } else {\n    checks.canDeactivateChecks.push(new CanDeactivate(null, r));\n  }\n}\nfunction isFunction(v) {\n  return typeof v === \"function\";\n}\nfunction isBoolean(v) {\n  return typeof v === \"boolean\";\n}\nfunction isCanLoad(guard) {\n  return guard && isFunction(guard.canLoad);\n}\nfunction isCanActivate(guard) {\n  return guard && isFunction(guard.canActivate);\n}\nfunction isCanActivateChild(guard) {\n  return guard && isFunction(guard.canActivateChild);\n}\nfunction isCanDeactivate(guard) {\n  return guard && isFunction(guard.canDeactivate);\n}\nfunction isCanMatch(guard) {\n  return guard && isFunction(guard.canMatch);\n}\nfunction isEmptyError(e) {\n  return e instanceof EmptyError || e?.name === \"EmptyError\";\n}\nvar INITIAL_VALUE = /* @__PURE__ */ Symbol(\"INITIAL_VALUE\");\nfunction prioritizedGuardValue() {\n  return switchMap((obs) => {\n    return combineLatest(obs.map((o) => o.pipe(take(1), startWith(INITIAL_VALUE)))).pipe(map((results) => {\n      for (const result of results) {\n        if (result === true) {\n          continue;\n        } else if (result === INITIAL_VALUE) {\n          return INITIAL_VALUE;\n        } else if (result === false || isRedirect(result)) {\n          return result;\n        }\n      }\n      return true;\n    }), filter((item) => item !== INITIAL_VALUE), take(1));\n  });\n}\nfunction isRedirect(val) {\n  return isUrlTree(val) || val instanceof RedirectCommand;\n}\nfunction abortSignalToObservable(signal2) {\n  if (signal2.aborted) {\n    return of(void 0).pipe(take(1));\n  }\n  return new Observable((subscriber) => {\n    const handler = () => {\n      subscriber.next();\n      subscriber.complete();\n    };\n    signal2.addEventListener(\"abort\", handler);\n    return () => signal2.removeEventListener(\"abort\", handler);\n  });\n}\nfunction takeUntilAbort(signal2) {\n  return takeUntil(abortSignalToObservable(signal2));\n}\nfunction checkGuards(forwardEvent) {\n  return mergeMap((t) => {\n    const {\n      targetSnapshot,\n      currentSnapshot,\n      guards: {\n        canActivateChecks,\n        canDeactivateChecks\n      }\n    } = t;\n    if (canDeactivateChecks.length === 0 && canActivateChecks.length === 0) {\n      return of(__spreadProps(__spreadValues({}, t), {\n        guardsResult: true\n      }));\n    }\n    return runCanDeactivateChecks(canDeactivateChecks, targetSnapshot, currentSnapshot).pipe(mergeMap((canDeactivate) => {\n      return canDeactivate && isBoolean(canDeactivate) ? runCanActivateChecks(targetSnapshot, canActivateChecks, forwardEvent) : of(canDeactivate);\n    }), map((guardsResult) => __spreadProps(__spreadValues({}, t), {\n      guardsResult\n    })));\n  });\n}\nfunction runCanDeactivateChecks(checks, futureRSS, currRSS) {\n  return from(checks).pipe(mergeMap((check) => runCanDeactivate(check.component, check.route, currRSS, futureRSS)), first((result) => {\n    return result !== true;\n  }, true));\n}\nfunction runCanActivateChecks(futureSnapshot, checks, forwardEvent) {\n  return from(checks).pipe(concatMap((check) => {\n    return concat(fireChildActivationStart(check.route.parent, forwardEvent), fireActivationStart(check.route, forwardEvent), runCanActivateChild(futureSnapshot, check.path), runCanActivate(futureSnapshot, check.route));\n  }), first((result) => {\n    return result !== true;\n  }, true));\n}\nfunction fireActivationStart(snapshot, forwardEvent) {\n  if (snapshot !== null && forwardEvent) {\n    forwardEvent(new ActivationStart(snapshot));\n  }\n  return of(true);\n}\nfunction fireChildActivationStart(snapshot, forwardEvent) {\n  if (snapshot !== null && forwardEvent) {\n    forwardEvent(new ChildActivationStart(snapshot));\n  }\n  return of(true);\n}\nfunction runCanActivate(futureRSS, futureARS) {\n  const canActivate = futureARS.routeConfig ? futureARS.routeConfig.canActivate : null;\n  if (!canActivate || canActivate.length === 0) return of(true);\n  const canActivateObservables = canActivate.map((canActivate2) => {\n    return defer(() => {\n      const closestInjector = futureARS._environmentInjector;\n      const guard = getTokenOrFunctionIdentity(canActivate2, closestInjector);\n      const guardVal = isCanActivate(guard) ? guard.canActivate(futureARS, futureRSS) : runInInjectionContext(closestInjector, () => guard(futureARS, futureRSS));\n      return wrapIntoObservable(guardVal).pipe(first());\n    });\n  });\n  return of(canActivateObservables).pipe(prioritizedGuardValue());\n}\nfunction runCanActivateChild(futureRSS, path) {\n  const futureARS = path[path.length - 1];\n  const canActivateChildGuards = path.slice(0, path.length - 1).reverse().map((p) => getCanActivateChild(p)).filter((_) => _ !== null);\n  const canActivateChildGuardsMapped = canActivateChildGuards.map((d) => {\n    return defer(() => {\n      const guardsMapped = d.guards.map((canActivateChild) => {\n        const closestInjector = d.node._environmentInjector;\n        const guard = getTokenOrFunctionIdentity(canActivateChild, closestInjector);\n        const guardVal = isCanActivateChild(guard) ? guard.canActivateChild(futureARS, futureRSS) : runInInjectionContext(closestInjector, () => guard(futureARS, futureRSS));\n        return wrapIntoObservable(guardVal).pipe(first());\n      });\n      return of(guardsMapped).pipe(prioritizedGuardValue());\n    });\n  });\n  return of(canActivateChildGuardsMapped).pipe(prioritizedGuardValue());\n}\nfunction runCanDeactivate(component, currARS, currRSS, futureRSS) {\n  const canDeactivate = currARS && currARS.routeConfig ? currARS.routeConfig.canDeactivate : null;\n  if (!canDeactivate || canDeactivate.length === 0) return of(true);\n  const canDeactivateObservables = canDeactivate.map((c) => {\n    const closestInjector = currARS._environmentInjector;\n    const guard = getTokenOrFunctionIdentity(c, closestInjector);\n    const guardVal = isCanDeactivate(guard) ? guard.canDeactivate(component, currARS, currRSS, futureRSS) : runInInjectionContext(closestInjector, () => guard(component, currARS, currRSS, futureRSS));\n    return wrapIntoObservable(guardVal).pipe(first());\n  });\n  return of(canDeactivateObservables).pipe(prioritizedGuardValue());\n}\nfunction runCanLoadGuards(injector, route, segments, urlSerializer, abortSignal) {\n  const canLoad = route.canLoad;\n  if (canLoad === void 0 || canLoad.length === 0) {\n    return of(true);\n  }\n  const canLoadObservables = canLoad.map((injectionToken) => {\n    const guard = getTokenOrFunctionIdentity(injectionToken, injector);\n    const guardVal = isCanLoad(guard) ? guard.canLoad(route, segments) : runInInjectionContext(injector, () => guard(route, segments));\n    const obs$ = wrapIntoObservable(guardVal);\n    return abortSignal ? obs$.pipe(takeUntilAbort(abortSignal)) : obs$;\n  });\n  return of(canLoadObservables).pipe(prioritizedGuardValue(), redirectIfUrlTree(urlSerializer));\n}\nfunction redirectIfUrlTree(urlSerializer) {\n  return pipe(tap((result) => {\n    if (typeof result === \"boolean\") return;\n    throw redirectingNavigationError(urlSerializer, result);\n  }), map((result) => result === true));\n}\nfunction runCanMatchGuards(injector, route, segments, urlSerializer, abortSignal) {\n  const canMatch = route.canMatch;\n  if (!canMatch || canMatch.length === 0) return of(true);\n  const canMatchObservables = canMatch.map((injectionToken) => {\n    const guard = getTokenOrFunctionIdentity(injectionToken, injector);\n    const guardVal = isCanMatch(guard) ? guard.canMatch(route, segments) : runInInjectionContext(injector, () => guard(route, segments));\n    return wrapIntoObservable(guardVal).pipe(takeUntilAbort(abortSignal));\n  });\n  return of(canMatchObservables).pipe(prioritizedGuardValue(), redirectIfUrlTree(urlSerializer));\n}\nvar NoMatch = class _NoMatch extends Error {\n  segmentGroup;\n  constructor(segmentGroup) {\n    super();\n    this.segmentGroup = segmentGroup || null;\n    Object.setPrototypeOf(this, _NoMatch.prototype);\n  }\n};\nvar AbsoluteRedirect = class _AbsoluteRedirect extends Error {\n  urlTree;\n  constructor(urlTree) {\n    super();\n    this.urlTree = urlTree;\n    Object.setPrototypeOf(this, _AbsoluteRedirect.prototype);\n  }\n};\nfunction namedOutletsRedirect(redirectTo) {\n  throw new RuntimeError(4e3, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Only absolute redirects can have named outlets. redirectTo: '${redirectTo}'`);\n}\nfunction canLoadFails(route) {\n  throw navigationCancelingError((typeof ngDevMode === \"undefined\" || ngDevMode) && `Cannot load children because the guard of the route \"path: '${route.path}'\" returned false`, NavigationCancellationCode.GuardRejected);\n}\nvar ApplyRedirects = class {\n  urlSerializer;\n  urlTree;\n  constructor(urlSerializer, urlTree) {\n    this.urlSerializer = urlSerializer;\n    this.urlTree = urlTree;\n  }\n  async lineralizeSegments(route, urlTree) {\n    let res = [];\n    let c = urlTree.root;\n    while (true) {\n      res = res.concat(c.segments);\n      if (c.numberOfChildren === 0) {\n        return res;\n      }\n      if (c.numberOfChildren > 1 || !c.children[PRIMARY_OUTLET]) {\n        throw namedOutletsRedirect(`${route.redirectTo}`);\n      }\n      c = c.children[PRIMARY_OUTLET];\n    }\n  }\n  async applyRedirectCommands(segments, redirectTo, posParams, currentSnapshot, injector) {\n    const redirect = await getRedirectResult(redirectTo, currentSnapshot, injector);\n    if (redirect instanceof UrlTree) {\n      throw new AbsoluteRedirect(redirect);\n    }\n    const newTree = this.applyRedirectCreateUrlTree(redirect, this.urlSerializer.parse(redirect), segments, posParams);\n    if (redirect[0] === \"/\") {\n      throw new AbsoluteRedirect(newTree);\n    }\n    return newTree;\n  }\n  applyRedirectCreateUrlTree(redirectTo, urlTree, segments, posParams) {\n    const newRoot = this.createSegmentGroup(redirectTo, urlTree.root, segments, posParams);\n    return new UrlTree(newRoot, this.createQueryParams(urlTree.queryParams, this.urlTree.queryParams), urlTree.fragment);\n  }\n  createQueryParams(redirectToParams, actualParams) {\n    const res = {};\n    Object.entries(redirectToParams).forEach(([k, v]) => {\n      const copySourceValue = typeof v === \"string\" && v[0] === \":\";\n      if (copySourceValue) {\n        const sourceName = v.substring(1);\n        res[k] = actualParams[sourceName];\n      } else {\n        res[k] = v;\n      }\n    });\n    return res;\n  }\n  createSegmentGroup(redirectTo, group, segments, posParams) {\n    const updatedSegments = this.createSegments(redirectTo, group.segments, segments, posParams);\n    let children = {};\n    Object.entries(group.children).forEach(([name, child]) => {\n      children[name] = this.createSegmentGroup(redirectTo, child, segments, posParams);\n    });\n    return new UrlSegmentGroup(updatedSegments, children);\n  }\n  createSegments(redirectTo, redirectToSegments, actualSegments, posParams) {\n    return redirectToSegments.map((s) => s.path[0] === \":\" ? this.findPosParam(redirectTo, s, posParams) : this.findOrReturn(s, actualSegments));\n  }\n  findPosParam(redirectTo, redirectToUrlSegment, posParams) {\n    const pos = posParams[redirectToUrlSegment.path.substring(1)];\n    if (!pos) throw new RuntimeError(4001, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Cannot redirect to '${redirectTo}'. Cannot find '${redirectToUrlSegment.path}'.`);\n    return pos;\n  }\n  findOrReturn(redirectToUrlSegment, actualSegments) {\n    let idx = 0;\n    for (const s of actualSegments) {\n      if (s.path === redirectToUrlSegment.path) {\n        actualSegments.splice(idx);\n        return s;\n      }\n      idx++;\n    }\n    return redirectToUrlSegment;\n  }\n};\nfunction getRedirectResult(redirectTo, currentSnapshot, injector) {\n  if (typeof redirectTo === \"string\") {\n    return Promise.resolve(redirectTo);\n  }\n  const redirectToFn = redirectTo;\n  const {\n    queryParams,\n    fragment,\n    routeConfig,\n    url,\n    outlet,\n    params,\n    data,\n    title,\n    paramMap,\n    queryParamMap\n  } = currentSnapshot;\n  return firstValueFrom(wrapIntoObservable(runInInjectionContext(injector, () => redirectToFn({\n    params,\n    data,\n    queryParams,\n    fragment,\n    routeConfig,\n    url,\n    outlet,\n    title,\n    paramMap,\n    queryParamMap\n  }))));\n}\nfunction getOrCreateRouteInjectorIfNeeded(route, currentInjector) {\n  if (route.providers && !route._injector) {\n    route._injector = createEnvironmentInjector(route.providers, currentInjector, `Route: ${route.path}`);\n  }\n  return route._injector ?? currentInjector;\n}\nfunction validateConfig(config, parentPath = \"\", requireStandaloneComponents = false) {\n  for (let i = 0; i < config.length; i++) {\n    const route = config[i];\n    const fullPath = getFullPath(parentPath, route);\n    validateNode(route, fullPath, requireStandaloneComponents);\n  }\n}\nfunction assertStandalone(fullPath, component) {\n  if (component && isNgModule(component)) {\n    throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}'. You are using 'loadComponent' with a module, but it must be used with standalone components. Use 'loadChildren' instead.`);\n  } else if (component && !isStandalone(component)) {\n    throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}'. The component must be standalone.`);\n  }\n}\nfunction validateNode(route, fullPath, requireStandaloneComponents) {\n  if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n    if (!route) {\n      throw new RuntimeError(4014, `\n      Invalid configuration of route '${fullPath}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);\n    }\n    if (Array.isArray(route)) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': Array cannot be specified`);\n    }\n    if (!route.redirectTo && !route.component && !route.loadComponent && !route.children && !route.loadChildren && route.outlet && route.outlet !== PRIMARY_OUTLET) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);\n    }\n    if (route.redirectTo && route.children) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': redirectTo and children cannot be used together`);\n    }\n    if (route.redirectTo && route.loadChildren) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': redirectTo and loadChildren cannot be used together`);\n    }\n    if (route.children && route.loadChildren) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': children and loadChildren cannot be used together`);\n    }\n    if (route.component && route.loadComponent) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': component and loadComponent cannot be used together`);\n    }\n    if (route.redirectTo) {\n      if (route.component || route.loadComponent) {\n        throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': redirectTo and component/loadComponent cannot be used together`);\n      }\n      if (route.canMatch || route.canActivate) {\n        throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': redirectTo and ${route.canMatch ? \"canMatch\" : \"canActivate\"} cannot be used together.Redirects happen before guards are executed.`);\n      }\n    }\n    if (route.path && route.matcher) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);\n    }\n    if (route.redirectTo === void 0 && !route.component && !route.loadComponent && !route.children && !route.loadChildren) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}'. One of the following must be provided: component, loadComponent, redirectTo, children or loadChildren`);\n    }\n    if (route.path === void 0 && route.matcher === void 0) {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': routes must have either a path or a matcher specified`);\n    }\n    if (typeof route.path === \"string\" && route.path.charAt(0) === \"/\") {\n      throw new RuntimeError(4014, `Invalid configuration of route '${fullPath}': path cannot start with a slash`);\n    }\n    if (route.path === \"\" && route.redirectTo !== void 0 && route.pathMatch === void 0) {\n      const exp = `The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`;\n      throw new RuntimeError(4014, `Invalid configuration of route '{path: \"${fullPath}\", redirectTo: \"${route.redirectTo}\"}': please provide 'pathMatch'. ${exp}`);\n    }\n    if (requireStandaloneComponents) {\n      assertStandalone(fullPath, route.component);\n    }\n  }\n  if (route.children) {\n    validateConfig(route.children, fullPath, requireStandaloneComponents);\n  }\n}\nfunction getFullPath(parentPath, currentRoute) {\n  if (!currentRoute) {\n    return parentPath;\n  }\n  if (!parentPath && !currentRoute.path) {\n    return \"\";\n  } else if (parentPath && !currentRoute.path) {\n    return `${parentPath}/`;\n  } else if (!parentPath && currentRoute.path) {\n    return currentRoute.path;\n  } else {\n    return `${parentPath}/${currentRoute.path}`;\n  }\n}\nfunction getOutlet(route) {\n  return route.outlet || PRIMARY_OUTLET;\n}\nfunction sortByMatchingOutlets(routes, outletName) {\n  const sortedConfig = routes.filter((r) => getOutlet(r) === outletName);\n  sortedConfig.push(...routes.filter((r) => getOutlet(r) !== outletName));\n  return sortedConfig;\n}\nvar noMatch = {\n  matched: false,\n  consumedSegments: [],\n  remainingSegments: [],\n  parameters: {},\n  positionalParamSegments: {}\n};\nfunction matchWithChecks(segmentGroup, route, segments, injector, urlSerializer, abortSignal) {\n  const result = match(segmentGroup, route, segments);\n  if (!result.matched) {\n    return of(result);\n  }\n  injector = getOrCreateRouteInjectorIfNeeded(route, injector);\n  return runCanMatchGuards(injector, route, segments, urlSerializer, abortSignal).pipe(map((v) => v === true ? result : __spreadValues({}, noMatch)));\n}\nfunction match(segmentGroup, route, segments) {\n  if (route.path === \"\") {\n    if (route.pathMatch === \"full\" && (segmentGroup.hasChildren() || segments.length > 0)) {\n      return __spreadValues({}, noMatch);\n    }\n    return {\n      matched: true,\n      consumedSegments: [],\n      remainingSegments: segments,\n      parameters: {},\n      positionalParamSegments: {}\n    };\n  }\n  const matcher = route.matcher || defaultUrlMatcher;\n  const res = matcher(segments, segmentGroup, route);\n  if (!res) return __spreadValues({}, noMatch);\n  const posParams = {};\n  Object.entries(res.posParams ?? {}).forEach(([k, v]) => {\n    posParams[k] = v.path;\n  });\n  const parameters = res.consumed.length > 0 ? __spreadValues(__spreadValues({}, posParams), res.consumed[res.consumed.length - 1].parameters) : posParams;\n  return {\n    matched: true,\n    consumedSegments: res.consumed,\n    remainingSegments: segments.slice(res.consumed.length),\n    parameters,\n    positionalParamSegments: res.posParams ?? {}\n  };\n}\nfunction split(segmentGroup, consumedSegments, slicedSegments, config) {\n  if (slicedSegments.length > 0 && containsEmptyPathMatchesWithNamedOutlets(segmentGroup, slicedSegments, config)) {\n    const s2 = new UrlSegmentGroup(consumedSegments, createChildrenForEmptyPaths(config, new UrlSegmentGroup(slicedSegments, segmentGroup.children)));\n    return {\n      segmentGroup: s2,\n      slicedSegments: []\n    };\n  }\n  if (slicedSegments.length === 0 && containsEmptyPathMatches(segmentGroup, slicedSegments, config)) {\n    const s2 = new UrlSegmentGroup(segmentGroup.segments, addEmptyPathsToChildrenIfNeeded(segmentGroup, slicedSegments, config, segmentGroup.children));\n    return {\n      segmentGroup: s2,\n      slicedSegments\n    };\n  }\n  const s = new UrlSegmentGroup(segmentGroup.segments, segmentGroup.children);\n  return {\n    segmentGroup: s,\n    slicedSegments\n  };\n}\nfunction addEmptyPathsToChildrenIfNeeded(segmentGroup, slicedSegments, routes, children) {\n  const res = {};\n  for (const r of routes) {\n    if (emptyPathMatch(segmentGroup, slicedSegments, r) && !children[getOutlet(r)]) {\n      const s = new UrlSegmentGroup([], {});\n      res[getOutlet(r)] = s;\n    }\n  }\n  return __spreadValues(__spreadValues({}, children), res);\n}\nfunction createChildrenForEmptyPaths(routes, primarySegment) {\n  const res = {};\n  res[PRIMARY_OUTLET] = primarySegment;\n  for (const r of routes) {\n    if (r.path === \"\" && getOutlet(r) !== PRIMARY_OUTLET) {\n      const s = new UrlSegmentGroup([], {});\n      res[getOutlet(r)] = s;\n    }\n  }\n  return res;\n}\nfunction containsEmptyPathMatchesWithNamedOutlets(segmentGroup, slicedSegments, routes) {\n  return routes.some((r) => emptyPathMatch(segmentGroup, slicedSegments, r) && getOutlet(r) !== PRIMARY_OUTLET);\n}\nfunction containsEmptyPathMatches(segmentGroup, slicedSegments, routes) {\n  return routes.some((r) => emptyPathMatch(segmentGroup, slicedSegments, r));\n}\nfunction emptyPathMatch(segmentGroup, slicedSegments, r) {\n  if ((segmentGroup.hasChildren() || slicedSegments.length > 0) && r.pathMatch === \"full\") {\n    return false;\n  }\n  return r.path === \"\";\n}\nfunction noLeftoversInUrl(segmentGroup, segments, outlet) {\n  return segments.length === 0 && !segmentGroup.children[outlet];\n}\nvar NoLeftoversInUrl = class {\n};\nasync function recognize$1(injector, configLoader, rootComponentType, config, urlTree, urlSerializer, paramsInheritanceStrategy = \"emptyOnly\", abortSignal) {\n  return new Recognizer(injector, configLoader, rootComponentType, config, urlTree, paramsInheritanceStrategy, urlSerializer, abortSignal).recognize();\n}\nvar MAX_ALLOWED_REDIRECTS = 31;\nvar Recognizer = class {\n  injector;\n  configLoader;\n  rootComponentType;\n  config;\n  urlTree;\n  paramsInheritanceStrategy;\n  urlSerializer;\n  abortSignal;\n  applyRedirects;\n  absoluteRedirectCount = 0;\n  allowRedirects = true;\n  constructor(injector, configLoader, rootComponentType, config, urlTree, paramsInheritanceStrategy, urlSerializer, abortSignal) {\n    this.injector = injector;\n    this.configLoader = configLoader;\n    this.rootComponentType = rootComponentType;\n    this.config = config;\n    this.urlTree = urlTree;\n    this.paramsInheritanceStrategy = paramsInheritanceStrategy;\n    this.urlSerializer = urlSerializer;\n    this.abortSignal = abortSignal;\n    this.applyRedirects = new ApplyRedirects(this.urlSerializer, this.urlTree);\n  }\n  noMatchError(e) {\n    return new RuntimeError(4002, typeof ngDevMode === \"undefined\" || ngDevMode ? `Cannot match any routes. URL Segment: '${e.segmentGroup}'` : `'${e.segmentGroup}'`);\n  }\n  async recognize() {\n    const rootSegmentGroup = split(this.urlTree.root, [], [], this.config).segmentGroup;\n    const {\n      children,\n      rootSnapshot\n    } = await this.match(rootSegmentGroup);\n    const rootNode = new TreeNode(rootSnapshot, children);\n    const routeState = new RouterStateSnapshot(\"\", rootNode);\n    const tree2 = createUrlTreeFromSnapshot(rootSnapshot, [], this.urlTree.queryParams, this.urlTree.fragment);\n    tree2.queryParams = this.urlTree.queryParams;\n    routeState.url = this.urlSerializer.serialize(tree2);\n    return {\n      state: routeState,\n      tree: tree2\n    };\n  }\n  async match(rootSegmentGroup) {\n    const rootSnapshot = new ActivatedRouteSnapshot([], Object.freeze({}), Object.freeze(__spreadValues({}, this.urlTree.queryParams)), this.urlTree.fragment, Object.freeze({}), PRIMARY_OUTLET, this.rootComponentType, null, {}, this.injector);\n    try {\n      const children = await this.processSegmentGroup(this.injector, this.config, rootSegmentGroup, PRIMARY_OUTLET, rootSnapshot);\n      return {\n        children,\n        rootSnapshot\n      };\n    } catch (e) {\n      if (e instanceof AbsoluteRedirect) {\n        this.urlTree = e.urlTree;\n        return this.match(e.urlTree.root);\n      }\n      if (e instanceof NoMatch) {\n        throw this.noMatchError(e);\n      }\n      throw e;\n    }\n  }\n  async processSegmentGroup(injector, config, segmentGroup, outlet, parentRoute) {\n    if (segmentGroup.segments.length === 0 && segmentGroup.hasChildren()) {\n      return this.processChildren(injector, config, segmentGroup, parentRoute);\n    }\n    const child = await this.processSegment(injector, config, segmentGroup, segmentGroup.segments, outlet, true, parentRoute);\n    return child instanceof TreeNode ? [child] : [];\n  }\n  async processChildren(injector, config, segmentGroup, parentRoute) {\n    const childOutlets = [];\n    for (const child of Object.keys(segmentGroup.children)) {\n      if (child === \"primary\") {\n        childOutlets.unshift(child);\n      } else {\n        childOutlets.push(child);\n      }\n    }\n    let children = [];\n    for (const childOutlet of childOutlets) {\n      const child = segmentGroup.children[childOutlet];\n      const sortedConfig = sortByMatchingOutlets(config, childOutlet);\n      const outletChildren = await this.processSegmentGroup(injector, sortedConfig, child, childOutlet, parentRoute);\n      children.push(...outletChildren);\n    }\n    const mergedChildren = mergeEmptyPathMatches(children);\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      checkOutletNameUniqueness(mergedChildren);\n    }\n    sortActivatedRouteSnapshots(mergedChildren);\n    return mergedChildren;\n  }\n  async processSegment(injector, routes, segmentGroup, segments, outlet, allowRedirects, parentRoute) {\n    for (const r of routes) {\n      try {\n        return await this.processSegmentAgainstRoute(r._injector ?? injector, routes, r, segmentGroup, segments, outlet, allowRedirects, parentRoute);\n      } catch (e) {\n        if (e instanceof NoMatch || isEmptyError(e)) {\n          continue;\n        }\n        throw e;\n      }\n    }\n    if (noLeftoversInUrl(segmentGroup, segments, outlet)) {\n      return new NoLeftoversInUrl();\n    }\n    throw new NoMatch(segmentGroup);\n  }\n  async processSegmentAgainstRoute(injector, routes, route, rawSegment, segments, outlet, allowRedirects, parentRoute) {\n    if (getOutlet(route) !== outlet && (outlet === PRIMARY_OUTLET || !emptyPathMatch(rawSegment, segments, route))) {\n      throw new NoMatch(rawSegment);\n    }\n    if (route.redirectTo === void 0) {\n      return this.matchSegmentAgainstRoute(injector, rawSegment, route, segments, outlet, parentRoute);\n    }\n    if (this.allowRedirects && allowRedirects) {\n      return this.expandSegmentAgainstRouteUsingRedirect(injector, rawSegment, routes, route, segments, outlet, parentRoute);\n    }\n    throw new NoMatch(rawSegment);\n  }\n  async expandSegmentAgainstRouteUsingRedirect(injector, segmentGroup, routes, route, segments, outlet, parentRoute) {\n    const {\n      matched,\n      parameters,\n      consumedSegments,\n      positionalParamSegments,\n      remainingSegments\n    } = match(segmentGroup, route, segments);\n    if (!matched) throw new NoMatch(segmentGroup);\n    if (typeof route.redirectTo === \"string\" && route.redirectTo[0] === \"/\") {\n      this.absoluteRedirectCount++;\n      if (this.absoluteRedirectCount > MAX_ALLOWED_REDIRECTS) {\n        if (ngDevMode) {\n          throw new RuntimeError(4016, `Detected possible infinite redirect when redirecting from '${this.urlTree}' to '${route.redirectTo}'.\nThis is currently a dev mode only error but will become a call stack size exceeded error in production in a future major version.`);\n        }\n        this.allowRedirects = false;\n      }\n    }\n    const currentSnapshot = new ActivatedRouteSnapshot(segments, parameters, Object.freeze(__spreadValues({}, this.urlTree.queryParams)), this.urlTree.fragment, getData(route), getOutlet(route), route.component ?? route._loadedComponent ?? null, route, getResolve(route), injector);\n    const inherited = getInherited(currentSnapshot, parentRoute, this.paramsInheritanceStrategy);\n    currentSnapshot.params = Object.freeze(inherited.params);\n    currentSnapshot.data = Object.freeze(inherited.data);\n    if (this.abortSignal.aborted) {\n      throw new Error(this.abortSignal.reason);\n    }\n    const newTree = await this.applyRedirects.applyRedirectCommands(consumedSegments, route.redirectTo, positionalParamSegments, currentSnapshot, injector);\n    const newSegments = await this.applyRedirects.lineralizeSegments(route, newTree);\n    return this.processSegment(injector, routes, segmentGroup, newSegments.concat(remainingSegments), outlet, false, parentRoute);\n  }\n  async matchSegmentAgainstRoute(injector, rawSegment, route, segments, outlet, parentRoute) {\n    if (this.abortSignal.aborted) {\n      throw new Error(this.abortSignal.reason);\n    }\n    const result = await firstValueFrom(matchWithChecks(rawSegment, route, segments, injector, this.urlSerializer, this.abortSignal));\n    if (route.path === \"**\") {\n      rawSegment.children = {};\n    }\n    if (!result?.matched) {\n      throw new NoMatch(rawSegment);\n    }\n    injector = route._injector ?? injector;\n    const {\n      routes: childConfig\n    } = await this.getChildConfig(injector, route, segments);\n    const childInjector = route._loadedInjector ?? injector;\n    const {\n      parameters,\n      consumedSegments,\n      remainingSegments\n    } = result;\n    const snapshot = new ActivatedRouteSnapshot(consumedSegments, parameters, Object.freeze(__spreadValues({}, this.urlTree.queryParams)), this.urlTree.fragment, getData(route), getOutlet(route), route.component ?? route._loadedComponent ?? null, route, getResolve(route), injector);\n    const inherited = getInherited(snapshot, parentRoute, this.paramsInheritanceStrategy);\n    snapshot.params = Object.freeze(inherited.params);\n    snapshot.data = Object.freeze(inherited.data);\n    const {\n      segmentGroup,\n      slicedSegments\n    } = split(rawSegment, consumedSegments, remainingSegments, childConfig);\n    if (slicedSegments.length === 0 && segmentGroup.hasChildren()) {\n      const children = await this.processChildren(childInjector, childConfig, segmentGroup, snapshot);\n      return new TreeNode(snapshot, children);\n    }\n    if (childConfig.length === 0 && slicedSegments.length === 0) {\n      return new TreeNode(snapshot, []);\n    }\n    const matchedOnOutlet = getOutlet(route) === outlet;\n    const child = await this.processSegment(childInjector, childConfig, segmentGroup, slicedSegments, matchedOnOutlet ? PRIMARY_OUTLET : outlet, true, snapshot);\n    return new TreeNode(snapshot, child instanceof TreeNode ? [child] : []);\n  }\n  async getChildConfig(injector, route, segments) {\n    if (route.children) {\n      return {\n        routes: route.children,\n        injector\n      };\n    }\n    if (route.loadChildren) {\n      if (route._loadedRoutes !== void 0) {\n        const ngModuleFactory = route._loadedNgModuleFactory;\n        if (ngModuleFactory && !route._loadedInjector) {\n          route._loadedInjector = ngModuleFactory.create(injector).injector;\n        }\n        return {\n          routes: route._loadedRoutes,\n          injector: route._loadedInjector\n        };\n      }\n      if (this.abortSignal.aborted) {\n        throw new Error(this.abortSignal.reason);\n      }\n      const shouldLoadResult = await firstValueFrom(runCanLoadGuards(injector, route, segments, this.urlSerializer, this.abortSignal));\n      if (shouldLoadResult) {\n        const cfg = await this.configLoader.loadChildren(injector, route);\n        route._loadedRoutes = cfg.routes;\n        route._loadedInjector = cfg.injector;\n        route._loadedNgModuleFactory = cfg.factory;\n        return cfg;\n      }\n      throw canLoadFails(route);\n    }\n    return {\n      routes: [],\n      injector\n    };\n  }\n};\nfunction sortActivatedRouteSnapshots(nodes) {\n  nodes.sort((a, b) => {\n    if (a.value.outlet === PRIMARY_OUTLET) return -1;\n    if (b.value.outlet === PRIMARY_OUTLET) return 1;\n    return a.value.outlet.localeCompare(b.value.outlet);\n  });\n}\nfunction hasEmptyPathConfig(node) {\n  const config = node.value.routeConfig;\n  return config && config.path === \"\";\n}\nfunction mergeEmptyPathMatches(nodes) {\n  const result = [];\n  const mergedNodes = /* @__PURE__ */ new Set();\n  for (const node of nodes) {\n    if (!hasEmptyPathConfig(node)) {\n      result.push(node);\n      continue;\n    }\n    const duplicateEmptyPathNode = result.find((resultNode) => node.value.routeConfig === resultNode.value.routeConfig);\n    if (duplicateEmptyPathNode !== void 0) {\n      duplicateEmptyPathNode.children.push(...node.children);\n      mergedNodes.add(duplicateEmptyPathNode);\n    } else {\n      result.push(node);\n    }\n  }\n  for (const mergedNode of mergedNodes) {\n    const mergedChildren = mergeEmptyPathMatches(mergedNode.children);\n    result.push(new TreeNode(mergedNode.value, mergedChildren));\n  }\n  return result.filter((n) => !mergedNodes.has(n));\n}\nfunction checkOutletNameUniqueness(nodes) {\n  const names = {};\n  nodes.forEach((n) => {\n    const routeWithSameOutletName = names[n.value.outlet];\n    if (routeWithSameOutletName) {\n      const p = routeWithSameOutletName.url.map((s) => s.toString()).join(\"/\");\n      const c = n.value.url.map((s) => s.toString()).join(\"/\");\n      throw new RuntimeError(4006, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Two segments cannot have the same outlet name: '${p}' and '${c}'.`);\n    }\n    names[n.value.outlet] = n.value;\n  });\n}\nfunction getData(route) {\n  return route.data || {};\n}\nfunction getResolve(route) {\n  return route.resolve || {};\n}\nfunction recognize(injector, configLoader, rootComponentType, config, serializer, paramsInheritanceStrategy, abortSignal) {\n  return mergeMap(async (t) => {\n    const {\n      state: targetSnapshot,\n      tree: urlAfterRedirects\n    } = await recognize$1(injector, configLoader, rootComponentType, config, t.extractedUrl, serializer, paramsInheritanceStrategy, abortSignal);\n    return __spreadProps(__spreadValues({}, t), {\n      targetSnapshot,\n      urlAfterRedirects\n    });\n  });\n}\nfunction resolveData(paramsInheritanceStrategy) {\n  return mergeMap((t) => {\n    const {\n      targetSnapshot,\n      guards: {\n        canActivateChecks\n      }\n    } = t;\n    if (!canActivateChecks.length) {\n      return of(t);\n    }\n    const routesWithResolversToRun = new Set(canActivateChecks.map((check) => check.route));\n    const routesNeedingDataUpdates = /* @__PURE__ */ new Set();\n    for (const route of routesWithResolversToRun) {\n      if (routesNeedingDataUpdates.has(route)) {\n        continue;\n      }\n      for (const newRoute of flattenRouteTree(route)) {\n        routesNeedingDataUpdates.add(newRoute);\n      }\n    }\n    let routesProcessed = 0;\n    return from(routesNeedingDataUpdates).pipe(concatMap((route) => {\n      if (routesWithResolversToRun.has(route)) {\n        return runResolve(route, targetSnapshot, paramsInheritanceStrategy);\n      } else {\n        route.data = getInherited(route, route.parent, paramsInheritanceStrategy).resolve;\n        return of(void 0);\n      }\n    }), tap(() => routesProcessed++), takeLast(1), mergeMap((_) => routesProcessed === routesNeedingDataUpdates.size ? of(t) : EMPTY));\n  });\n}\nfunction flattenRouteTree(route) {\n  const descendants = route.children.map((child) => flattenRouteTree(child)).flat();\n  return [route, ...descendants];\n}\nfunction runResolve(futureARS, futureRSS, paramsInheritanceStrategy) {\n  const config = futureARS.routeConfig;\n  const resolve = futureARS._resolve;\n  if (config?.title !== void 0 && !hasStaticTitle(config)) {\n    resolve[RouteTitleKey] = config.title;\n  }\n  return defer(() => {\n    futureARS.data = getInherited(futureARS, futureARS.parent, paramsInheritanceStrategy).resolve;\n    return resolveNode(resolve, futureARS, futureRSS).pipe(map((resolvedData) => {\n      futureARS._resolvedData = resolvedData;\n      futureARS.data = __spreadValues(__spreadValues({}, futureARS.data), resolvedData);\n      return null;\n    }));\n  });\n}\nfunction resolveNode(resolve, futureARS, futureRSS) {\n  const keys = getDataKeys(resolve);\n  if (keys.length === 0) {\n    return of({});\n  }\n  const data = {};\n  return from(keys).pipe(mergeMap((key) => getResolver(resolve[key], futureARS, futureRSS).pipe(first(), tap((value) => {\n    if (value instanceof RedirectCommand) {\n      throw redirectingNavigationError(new DefaultUrlSerializer(), value);\n    }\n    data[key] = value;\n  }))), takeLast(1), map(() => data), catchError((e) => isEmptyError(e) ? EMPTY : throwError(e)));\n}\nfunction getResolver(injectionToken, futureARS, futureRSS) {\n  const closestInjector = futureARS._environmentInjector;\n  const resolver = getTokenOrFunctionIdentity(injectionToken, closestInjector);\n  const resolverValue = resolver.resolve ? resolver.resolve(futureARS, futureRSS) : runInInjectionContext(closestInjector, () => resolver(futureARS, futureRSS));\n  return wrapIntoObservable(resolverValue);\n}\nfunction switchTap(next) {\n  return switchMap((v) => {\n    const nextResult = next(v);\n    if (nextResult) {\n      return from(nextResult).pipe(map(() => v));\n    }\n    return of(v);\n  });\n}\nvar TitleStrategy = class _TitleStrategy {\n  buildTitle(snapshot) {\n    let pageTitle;\n    let route = snapshot.root;\n    while (route !== void 0) {\n      pageTitle = this.getResolvedTitleForRoute(route) ?? pageTitle;\n      route = route.children.find((child) => child.outlet === PRIMARY_OUTLET);\n    }\n    return pageTitle;\n  }\n  getResolvedTitleForRoute(snapshot) {\n    return snapshot.data[RouteTitleKey];\n  }\n  static fac = function TitleStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _TitleStrategy)();\n  };\n  static prov = defineInjectable({\n    token: _TitleStrategy,\n    factory: () => (() => inject(DefaultTitleStrategy))(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(TitleStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => inject(DefaultTitleStrategy)\n    }]\n  }], null, null);\n})();\nvar DefaultTitleStrategy = class _DefaultTitleStrategy extends TitleStrategy {\n  title;\n  constructor(title) {\n    super();\n    this.title = title;\n  }\n  updateTitle(snapshot) {\n    const title = this.buildTitle(snapshot);\n    if (title !== void 0) {\n      this.title.setTitle(title);\n    }\n  }\n  static fac = function DefaultTitleStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DefaultTitleStrategy)(inject(Title));\n  };\n  static prov = defineInjectable({\n    token: _DefaultTitleStrategy,\n    factory: _DefaultTitleStrategy.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DefaultTitleStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: Title\n  }], null);\n})();\nvar ROUTER_CONFIGURATION = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"router config\" : \"\", {\n  factory: () => ({})\n});\nvar ROUTES = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"ROUTES\" : \"\");\nvar RouterConfigLoader = class _RouterConfigLoader {\n  componentLoaders = /* @__PURE__ */ new WeakMap();\n  childrenLoaders = /* @__PURE__ */ new WeakMap();\n  onLoadStartListener;\n  onLoadEndListener;\n  compiler = inject(Compiler);\n  async loadComponent(injector, route) {\n    if (this.componentLoaders.get(route)) {\n      return this.componentLoaders.get(route);\n    } else if (route._loadedComponent) {\n      return Promise.resolve(route._loadedComponent);\n    }\n    if (this.onLoadStartListener) {\n      this.onLoadStartListener(route);\n    }\n    const loader = (async () => {\n      try {\n        const loaded = await wrapIntoPromise(runInInjectionContext(injector, () => route.loadComponent()));\n        const component = await maybeResolveResources(maybeUnwrapDefaultExport(loaded));\n        if (this.onLoadEndListener) {\n          this.onLoadEndListener(route);\n        }\n        (typeof ngDevMode === \"undefined\" || ngDevMode) && assertStandalone(route.path ?? \"\", component);\n        route._loadedComponent = component;\n        return component;\n      } finally {\n        this.componentLoaders.delete(route);\n      }\n    })();\n    this.componentLoaders.set(route, loader);\n    return loader;\n  }\n  loadChildren(parentInjector, route) {\n    if (this.childrenLoaders.get(route)) {\n      return this.childrenLoaders.get(route);\n    } else if (route._loadedRoutes) {\n      return Promise.resolve({\n        routes: route._loadedRoutes,\n        injector: route._loadedInjector\n      });\n    }\n    if (this.onLoadStartListener) {\n      this.onLoadStartListener(route);\n    }\n    const loader = (async () => {\n      try {\n        const result = await loadChildren(route, this.compiler, parentInjector, this.onLoadEndListener);\n        route._loadedRoutes = result.routes;\n        route._loadedInjector = result.injector;\n        route._loadedNgModuleFactory = result.factory;\n        return result;\n      } finally {\n        this.childrenLoaders.delete(route);\n      }\n    })();\n    this.childrenLoaders.set(route, loader);\n    return loader;\n  }\n  static fac = function RouterConfigLoader_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouterConfigLoader)();\n  };\n  static prov = defineInjectable({\n    token: _RouterConfigLoader,\n    factory: _RouterConfigLoader.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterConfigLoader, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nasync function loadChildren(route, compiler, parentInjector, onLoadEndListener) {\n  const loaded = await wrapIntoPromise(runInInjectionContext(parentInjector, () => route.loadChildren()));\n  const t = await maybeResolveResources(maybeUnwrapDefaultExport(loaded));\n  let factoryOrRoutes;\n  if (t instanceof NgModuleFactory$1 || Array.isArray(t)) {\n    factoryOrRoutes = t;\n  } else {\n    factoryOrRoutes = await compiler.compileModuleAsync(t);\n  }\n  if (onLoadEndListener) {\n    onLoadEndListener(route);\n  }\n  let injector;\n  let rawRoutes;\n  let requireStandaloneComponents = false;\n  let factory = void 0;\n  if (Array.isArray(factoryOrRoutes)) {\n    rawRoutes = factoryOrRoutes;\n    requireStandaloneComponents = true;\n  } else {\n    injector = factoryOrRoutes.create(parentInjector).injector;\n    factory = factoryOrRoutes;\n    rawRoutes = injector.get(ROUTES, [], {\n      optional: true,\n      self: true\n    }).flat();\n  }\n  const routes = rawRoutes.map(standardizeConfig);\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && validateConfig(routes, route.path, requireStandaloneComponents);\n  return {\n    routes,\n    injector,\n    factory\n  };\n}\nfunction isWrappedDefaultExport(value) {\n  return value && typeof value === \"object\" && \"default\" in value;\n}\nfunction maybeUnwrapDefaultExport(input2) {\n  return isWrappedDefaultExport(input2) ? input2[\"default\"] : input2;\n}\nasync function maybeResolveResources(value) {\n  if (false) {\n    try {\n      await resolveComponentResources(fetch);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  return value;\n}\nvar UrlHandlingStrategy = class _UrlHandlingStrategy {\n  static fac = function UrlHandlingStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _UrlHandlingStrategy)();\n  };\n  static prov = defineInjectable({\n    token: _UrlHandlingStrategy,\n    factory: () => (() => inject(DefaultUrlHandlingStrategy))(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(UrlHandlingStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => inject(DefaultUrlHandlingStrategy)\n    }]\n  }], null, null);\n})();\nvar DefaultUrlHandlingStrategy = class _DefaultUrlHandlingStrategy {\n  shouldProcessUrl(url) {\n    return true;\n  }\n  extract(url) {\n    return url;\n  }\n  merge(newUrlPart, wholeUrl) {\n    return newUrlPart;\n  }\n  static fac = function DefaultUrlHandlingStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DefaultUrlHandlingStrategy)();\n  };\n  static prov = defineInjectable({\n    token: _DefaultUrlHandlingStrategy,\n    factory: _DefaultUrlHandlingStrategy.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DefaultUrlHandlingStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nvar CREATE_VIEW_TRANSITION = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"view transition helper\" : \"\");\nvar VIEW_TRANSITION_OPTIONS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"view transition options\" : \"\");\nfunction createViewTransition(injector, from2, to) {\n  const transitionOptions = injector.get(VIEW_TRANSITION_OPTIONS);\n  const document = injector.get(DOCUMENT);\n  if (!document.startViewTransition || transitionOptions.skipNextTransition) {\n    transitionOptions.skipNextTransition = false;\n    return new Promise((resolve) => setTimeout(resolve));\n  }\n  let resolveViewTransitionStarted;\n  const viewTransitionStarted = new Promise((resolve) => {\n    resolveViewTransitionStarted = resolve;\n  });\n  const transition = document.startViewTransition(() => {\n    resolveViewTransitionStarted();\n    return createRenderPromise(injector);\n  });\n  transition.updateCallbackDone.catch((error) => {\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      console.error(error);\n    }\n  });\n  transition.ready.catch((error) => {\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      console.error(error);\n    }\n  });\n  transition.finished.catch((error) => {\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      console.error(error);\n    }\n  });\n  const {\n    onViewTransitionCreated\n  } = transitionOptions;\n  if (onViewTransitionCreated) {\n    runInInjectionContext(injector, () => onViewTransitionCreated({\n      transition,\n      from: from2,\n      to\n    }));\n  }\n  return viewTransitionStarted;\n}\nfunction createRenderPromise(injector) {\n  return new Promise((resolve) => {\n    afterNextRender({\n      read: () => setTimeout(resolve)\n    }, {\n      injector\n    });\n  });\n}\nvar noop = () => {\n};\nvar NAVIGATION_ERROR_HANDLER = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"navigation error handler\" : \"\");\nvar NavigationTransitions = class _NavigationTransitions {\n  currentNavigation = signal(null, __spreadProps(__spreadValues({}, ngDevMode ? {\n    debugName: \"currentNavigation\"\n  } : {}), {\n    equal: () => false\n  }));\n  currentTransition = null;\n  lastSuccessfulNavigation = signal(null, ...ngDevMode ? [{\n    debugName: \"lastSuccessfulNavigation\"\n  }] : []);\n  events = new Subject();\n  transitionAbortWithErrorSubject = new Subject();\n  configLoader = inject(RouterConfigLoader);\n  environmentInjector = inject(EnvironmentInjector);\n  destroyRef = inject(DestroyRef);\n  urlSerializer = inject(UrlSerializer);\n  rootContexts = inject(ChildrenOutletContexts);\n  location = inject(Location);\n  inputBindingEnabled = inject(INPUT_BINDER, {\n    optional: true\n  }) !== null;\n  titleStrategy = inject(TitleStrategy);\n  options = inject(ROUTER_CONFIGURATION, {\n    optional: true\n  }) || {};\n  paramsInheritanceStrategy = this.options.paramsInheritanceStrategy || \"emptyOnly\";\n  urlHandlingStrategy = inject(UrlHandlingStrategy);\n  createViewTransition = inject(CREATE_VIEW_TRANSITION, {\n    optional: true\n  });\n  navigationErrorHandler = inject(NAVIGATION_ERROR_HANDLER, {\n    optional: true\n  });\n  navigationId = 0;\n  get hasRequestedNavigation() {\n    return this.navigationId !== 0;\n  }\n  transitions;\n  afterPreactivation = () => of(void 0);\n  rootComponentType = null;\n  destroyed = false;\n  constructor() {\n    const onLoadStart = (r) => this.events.next(new RouteConfigLoadStart(r));\n    const onLoadEnd = (r) => this.events.next(new RouteConfigLoadEnd(r));\n    this.configLoader.onLoadEndListener = onLoadEnd;\n    this.configLoader.onLoadStartListener = onLoadStart;\n    this.destroyRef.onDestroy(() => {\n      this.destroyed = true;\n    });\n  }\n  complete() {\n    this.transitions?.complete();\n  }\n  handleNavigationRequest(request) {\n    const id = ++this.navigationId;\n    untracked(() => {\n      this.transitions?.next(__spreadProps(__spreadValues({}, request), {\n        extractedUrl: this.urlHandlingStrategy.extract(request.rawUrl),\n        targetSnapshot: null,\n        targetRouterState: null,\n        guards: {\n          canActivateChecks: [],\n          canDeactivateChecks: []\n        },\n        guardsResult: null,\n        id\n      }));\n    });\n  }\n  setupNavigations(router) {\n    this.transitions = new BehaviorSubject(null);\n    return this.transitions.pipe(filter((t) => t !== null), switchMap((overallTransitionState) => {\n      let completedOrAborted = false;\n      const abortController = new AbortController();\n      const shouldContinueNavigation = () => {\n        return !completedOrAborted && this.currentTransition?.id === overallTransitionState.id;\n      };\n      return of(overallTransitionState).pipe(switchMap((t) => {\n        if (this.navigationId > overallTransitionState.id) {\n          const cancellationReason = typeof ngDevMode === \"undefined\" || ngDevMode ? `Navigation ID ${overallTransitionState.id} is not equal to the current navigation id ${this.navigationId}` : \"\";\n          this.cancelNavigationTransition(overallTransitionState, cancellationReason, NavigationCancellationCode.SupersededByNewNavigation);\n          return EMPTY;\n        }\n        this.currentTransition = overallTransitionState;\n        const lastSuccessfulNavigation = this.lastSuccessfulNavigation();\n        this.currentNavigation.set({\n          id: t.id,\n          initialUrl: t.rawUrl,\n          extractedUrl: t.extractedUrl,\n          targetBrowserUrl: typeof t.extras.browserUrl === \"string\" ? this.urlSerializer.parse(t.extras.browserUrl) : t.extras.browserUrl,\n          trigger: t.source,\n          extras: t.extras,\n          previousNavigation: !lastSuccessfulNavigation ? null : __spreadProps(__spreadValues({}, lastSuccessfulNavigation), {\n            previousNavigation: null\n          }),\n          abort: () => abortController.abort()\n        });\n        const urlTransition = !router.navigated || this.isUpdatingInternalState() || this.isUpdatedBrowserUrl();\n        const onSameUrlNavigation = t.extras.onSameUrlNavigation ?? router.onSameUrlNavigation;\n        if (!urlTransition && onSameUrlNavigation !== \"reload\") {\n          const reason = typeof ngDevMode === \"undefined\" || ngDevMode ? `Navigation to ${t.rawUrl} was ignored because it is the same as the current Router URL.` : \"\";\n          this.events.next(new NavigationSkipped(t.id, this.urlSerializer.serialize(t.rawUrl), reason, NavigationSkippedCode.IgnoredSameUrlNavigation));\n          t.resolve(false);\n          return EMPTY;\n        }\n        if (this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl)) {\n          return of(t).pipe(switchMap((t2) => {\n            this.events.next(new NavigationStart(t2.id, this.urlSerializer.serialize(t2.extractedUrl), t2.source, t2.restoredState));\n            if (t2.id !== this.navigationId) {\n              return EMPTY;\n            }\n            return Promise.resolve(t2);\n          }), recognize(this.environmentInjector, this.configLoader, this.rootComponentType, router.config, this.urlSerializer, this.paramsInheritanceStrategy, abortController.signal), tap((t2) => {\n            overallTransitionState.targetSnapshot = t2.targetSnapshot;\n            overallTransitionState.urlAfterRedirects = t2.urlAfterRedirects;\n            this.currentNavigation.update((nav) => {\n              nav.finalUrl = t2.urlAfterRedirects;\n              return nav;\n            });\n            const routesRecognized = new RoutesRecognized(t2.id, this.urlSerializer.serialize(t2.extractedUrl), this.urlSerializer.serialize(t2.urlAfterRedirects), t2.targetSnapshot);\n            this.events.next(routesRecognized);\n          }));\n        } else if (urlTransition && this.urlHandlingStrategy.shouldProcessUrl(t.currentRawUrl)) {\n          const {\n            id,\n            extractedUrl,\n            source,\n            restoredState,\n            extras\n          } = t;\n          const navStart = new NavigationStart(id, this.urlSerializer.serialize(extractedUrl), source, restoredState);\n          this.events.next(navStart);\n          const targetSnapshot = createEmptyState(this.rootComponentType, this.environmentInjector).snapshot;\n          this.currentTransition = overallTransitionState = __spreadProps(__spreadValues({}, t), {\n            targetSnapshot,\n            urlAfterRedirects: extractedUrl,\n            extras: __spreadProps(__spreadValues({}, extras), {\n              skipLocationChange: false,\n              replaceUrl: false\n            })\n          });\n          this.currentNavigation.update((nav) => {\n            nav.finalUrl = extractedUrl;\n            return nav;\n          });\n          return of(overallTransitionState);\n        } else {\n          const reason = typeof ngDevMode === \"undefined\" || ngDevMode ? `Navigation was ignored because the UrlHandlingStrategy indicated neither the current URL ${t.currentRawUrl} nor target URL ${t.rawUrl} should be processed.` : \"\";\n          this.events.next(new NavigationSkipped(t.id, this.urlSerializer.serialize(t.extractedUrl), reason, NavigationSkippedCode.IgnoredByUrlHandlingStrategy));\n          t.resolve(false);\n          return EMPTY;\n        }\n      }), map((t) => {\n        const guardsStart = new GuardsCheckStart(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n        this.events.next(guardsStart);\n        this.currentTransition = overallTransitionState = __spreadProps(__spreadValues({}, t), {\n          guards: getAllRouteGuards(t.targetSnapshot, t.currentSnapshot, this.rootContexts)\n        });\n        return overallTransitionState;\n      }), checkGuards((evt) => this.events.next(evt)), switchMap((t) => {\n        overallTransitionState.guardsResult = t.guardsResult;\n        if (t.guardsResult && typeof t.guardsResult !== \"boolean\") {\n          throw redirectingNavigationError(this.urlSerializer, t.guardsResult);\n        }\n        const guardsEnd = new GuardsCheckEnd(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot, !!t.guardsResult);\n        this.events.next(guardsEnd);\n        if (!shouldContinueNavigation()) {\n          return EMPTY;\n        }\n        if (!t.guardsResult) {\n          this.cancelNavigationTransition(t, \"\", NavigationCancellationCode.GuardRejected);\n          return EMPTY;\n        }\n        if (t.guards.canActivateChecks.length === 0) {\n          return of(t);\n        }\n        const resolveStart = new ResolveStart(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n        this.events.next(resolveStart);\n        if (!shouldContinueNavigation()) {\n          return EMPTY;\n        }\n        let dataResolved = false;\n        return of(t).pipe(resolveData(this.paramsInheritanceStrategy), tap({\n          next: () => {\n            dataResolved = true;\n            const resolveEnd = new ResolveEnd(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n            this.events.next(resolveEnd);\n          },\n          complete: () => {\n            if (!dataResolved) {\n              this.cancelNavigationTransition(t, typeof ngDevMode === \"undefined\" || ngDevMode ? `At least one route resolver didn't emit any value.` : \"\", NavigationCancellationCode.NoDataFromResolver);\n            }\n          }\n        }));\n      }), switchTap((t) => {\n        const loadComponents = (route) => {\n          const loaders2 = [];\n          if (route.routeConfig?._loadedComponent) {\n            route.component = route.routeConfig?._loadedComponent;\n          } else if (route.routeConfig?.loadComponent) {\n            const injector = route._environmentInjector;\n            loaders2.push(this.configLoader.loadComponent(injector, route.routeConfig).then((loadedComponent) => {\n              route.component = loadedComponent;\n            }));\n          }\n          for (const child of route.children) {\n            loaders2.push(...loadComponents(child));\n          }\n          return loaders2;\n        };\n        const loaders = loadComponents(t.targetSnapshot.root);\n        return loaders.length === 0 ? of(t) : from(Promise.all(loaders).then(() => t));\n      }), switchTap(() => this.afterPreactivation()), switchMap(() => {\n        const {\n          currentSnapshot,\n          targetSnapshot\n        } = overallTransitionState;\n        const viewTransitionStarted = this.createViewTransition?.(this.environmentInjector, currentSnapshot.root, targetSnapshot.root);\n        return viewTransitionStarted ? from(viewTransitionStarted).pipe(map(() => overallTransitionState)) : of(overallTransitionState);\n      }), take(1), map((t) => {\n        const targetRouterState = createRouterState(router.routeReuseStrategy, t.targetSnapshot, t.currentRouterState);\n        this.currentTransition = overallTransitionState = t = __spreadProps(__spreadValues({}, t), {\n          targetRouterState\n        });\n        this.currentNavigation.update((nav) => {\n          nav.targetRouterState = targetRouterState;\n          return nav;\n        });\n        this.events.next(new BeforeActivateRoutes());\n        if (!shouldContinueNavigation()) {\n          return;\n        }\n        new ActivateRoutes(router.routeReuseStrategy, overallTransitionState.targetRouterState, overallTransitionState.currentRouterState, (evt) => this.events.next(evt), this.inputBindingEnabled).activate(this.rootContexts);\n        if (!shouldContinueNavigation()) {\n          return;\n        }\n        completedOrAborted = true;\n        this.currentNavigation.update((nav) => {\n          nav.abort = noop;\n          return nav;\n        });\n        this.lastSuccessfulNavigation.set(untracked(this.currentNavigation));\n        this.events.next(new NavigationEnd(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects)));\n        this.titleStrategy?.updateTitle(t.targetRouterState.snapshot);\n        t.resolve(true);\n      }), takeUntil(abortSignalToObservable(abortController.signal).pipe(filter(() => !completedOrAborted && !overallTransitionState.targetRouterState), tap(() => {\n        this.cancelNavigationTransition(overallTransitionState, abortController.signal.reason + \"\", NavigationCancellationCode.Aborted);\n      }))), tap({\n        complete: () => {\n          completedOrAborted = true;\n        }\n      }), takeUntil(this.transitionAbortWithErrorSubject.pipe(tap((err) => {\n        throw err;\n      }))), finalize(() => {\n        abortController.abort();\n        if (!completedOrAborted) {\n          const cancelationReason = typeof ngDevMode === \"undefined\" || ngDevMode ? `Navigation ID ${overallTransitionState.id} is not equal to the current navigation id ${this.navigationId}` : \"\";\n          this.cancelNavigationTransition(overallTransitionState, cancelationReason, NavigationCancellationCode.SupersededByNewNavigation);\n        }\n        if (this.currentTransition?.id === overallTransitionState.id) {\n          this.currentNavigation.set(null);\n          this.currentTransition = null;\n        }\n      }), catchError((e) => {\n        completedOrAborted = true;\n        if (this.destroyed) {\n          overallTransitionState.resolve(false);\n          return EMPTY;\n        }\n        if (isNavigationCancelingError(e)) {\n          this.events.next(new NavigationCancel(overallTransitionState.id, this.urlSerializer.serialize(overallTransitionState.extractedUrl), e.message, e.cancellationCode));\n          if (!isRedirectingNavigationCancelingError(e)) {\n            overallTransitionState.resolve(false);\n          } else {\n            this.events.next(new RedirectRequest(e.url, e.navigationBehaviorOptions));\n          }\n        } else {\n          const navigationError = new NavigationError(overallTransitionState.id, this.urlSerializer.serialize(overallTransitionState.extractedUrl), e, overallTransitionState.targetSnapshot ?? void 0);\n          try {\n            const navigationErrorHandlerResult = runInInjectionContext(this.environmentInjector, () => this.navigationErrorHandler?.(navigationError));\n            if (navigationErrorHandlerResult instanceof RedirectCommand) {\n              const {\n                message,\n                cancellationCode\n              } = redirectingNavigationError(this.urlSerializer, navigationErrorHandlerResult);\n              this.events.next(new NavigationCancel(overallTransitionState.id, this.urlSerializer.serialize(overallTransitionState.extractedUrl), message, cancellationCode));\n              this.events.next(new RedirectRequest(navigationErrorHandlerResult.redirectTo, navigationErrorHandlerResult.navigationBehaviorOptions));\n            } else {\n              this.events.next(navigationError);\n              throw e;\n            }\n          } catch (ee) {\n            if (this.options.resolveNavigationPromiseOnError) {\n              overallTransitionState.resolve(false);\n            } else {\n              overallTransitionState.reject(ee);\n            }\n          }\n        }\n        return EMPTY;\n      }));\n    }));\n  }\n  cancelNavigationTransition(t, reason, code) {\n    const navCancel = new NavigationCancel(t.id, this.urlSerializer.serialize(t.extractedUrl), reason, code);\n    this.events.next(navCancel);\n    t.resolve(false);\n  }\n  isUpdatingInternalState() {\n    return this.currentTransition?.extractedUrl.toString() !== this.currentTransition?.currentUrlTree.toString();\n  }\n  isUpdatedBrowserUrl() {\n    const currentBrowserUrl = this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(true)));\n    const currentNavigation = untracked(this.currentNavigation);\n    const targetBrowserUrl = currentNavigation?.targetBrowserUrl ?? currentNavigation?.extractedUrl;\n    return currentBrowserUrl.toString() !== targetBrowserUrl?.toString() && !currentNavigation?.extras.skipLocationChange;\n  }\n  static fac = function NavigationTransitions_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NavigationTransitions)();\n  };\n  static prov = defineInjectable({\n    token: _NavigationTransitions,\n    factory: _NavigationTransitions.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NavigationTransitions, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [], null);\n})();\nfunction isBrowserTriggeredNavigation(source) {\n  return source !== IMPERATIVE_NAVIGATION;\n}\nvar ROUTE_INJECTOR_CLEANUP = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"RouteInjectorCleanup\" : \"\");\nfunction routeInjectorCleanup(routeReuseStrategy, routerState, config) {\n  const activeRoutes = /* @__PURE__ */ new Set();\n  if (routerState.snapshot.root) {\n    collectDescendants(routerState.snapshot.root, activeRoutes);\n  }\n  const storedHandles = routeReuseStrategy.retrieveStoredRouteHandles?.() || [];\n  for (const handle of storedHandles) {\n    const internalHandle = handle;\n    if (internalHandle?.route?.value?.snapshot) {\n      for (const snapshot of internalHandle.route.value.snapshot.pathFromRoot) {\n        if (snapshot.routeConfig) {\n          activeRoutes.add(snapshot.routeConfig);\n        }\n      }\n    }\n  }\n  destroyUnusedInjectors(config, activeRoutes, routeReuseStrategy, false);\n}\nfunction collectDescendants(snapshot, activeRoutes) {\n  if (snapshot.routeConfig) {\n    activeRoutes.add(snapshot.routeConfig);\n  }\n  for (const child of snapshot.children) {\n    collectDescendants(child, activeRoutes);\n  }\n}\nfunction destroyUnusedInjectors(routes, activeRoutes, strategy, inheritedForceDestroy) {\n  for (const route of routes) {\n    const shouldDestroyCurrentRoute = inheritedForceDestroy || !!((route._injector || route._loadedInjector) && !activeRoutes.has(route) && (strategy.shouldDestroyInjector?.(route) ?? false));\n    if (route.children) {\n      destroyUnusedInjectors(route.children, activeRoutes, strategy, shouldDestroyCurrentRoute);\n    }\n    if (route.loadChildren && route._loadedRoutes) {\n      destroyUnusedInjectors(route._loadedRoutes, activeRoutes, strategy, shouldDestroyCurrentRoute);\n    }\n    if (shouldDestroyCurrentRoute) {\n      if (route._injector) {\n        route._injector.destroy();\n        route._injector = void 0;\n      }\n      if (route._loadedInjector) {\n        route._loadedInjector.destroy();\n        route._loadedInjector = void 0;\n      }\n    }\n  }\n}\nfunction destroyDetachedRouteHandle(handle) {\n  const internalHandle = handle;\n  if (internalHandle && internalHandle.componentRef) {\n    internalHandle.componentRef.destroy();\n  }\n}\nvar RouteReuseStrategy = class _RouteReuseStrategy {\n  static fac = function RouteReuseStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouteReuseStrategy)();\n  };\n  static prov = defineInjectable({\n    token: _RouteReuseStrategy,\n    factory: () => (() => inject(DefaultRouteReuseStrategy))(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouteReuseStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => inject(DefaultRouteReuseStrategy)\n    }]\n  }], null, null);\n})();\nvar BaseRouteReuseStrategy = class {\n  shouldDetach(route) {\n    return false;\n  }\n  store(route, detachedTree) {\n  }\n  shouldAttach(route) {\n    return false;\n  }\n  retrieve(route) {\n    return null;\n  }\n  shouldReuseRoute(future, curr) {\n    return future.routeConfig === curr.routeConfig;\n  }\n  shouldDestroyInjector(route) {\n    return true;\n  }\n};\nvar DefaultRouteReuseStrategy = class _DefaultRouteReuseStrategy extends BaseRouteReuseStrategy {\n  static fac = /* @__PURE__ */ (() => {\n    let DefaultRouteReuseStrategy_BaseFactory;\n    return function DefaultRouteReuseStrategy_Factory(__ngFactoryType__) {\n      return (DefaultRouteReuseStrategy_BaseFactory || (DefaultRouteReuseStrategy_BaseFactory = getInheritedFactory(_DefaultRouteReuseStrategy)))(__ngFactoryType__ || _DefaultRouteReuseStrategy);\n    };\n  })();\n  static prov = defineInjectable({\n    token: _DefaultRouteReuseStrategy,\n    factory: _DefaultRouteReuseStrategy.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DefaultRouteReuseStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nvar StateManager = class _StateManager {\n  urlSerializer = inject(UrlSerializer);\n  options = inject(ROUTER_CONFIGURATION, {\n    optional: true\n  }) || {};\n  canceledNavigationResolution = this.options.canceledNavigationResolution || \"replace\";\n  location = inject(Location);\n  urlHandlingStrategy = inject(UrlHandlingStrategy);\n  urlUpdateStrategy = this.options.urlUpdateStrategy || \"deferred\";\n  currentUrlTree = new UrlTree();\n  getCurrentUrlTree() {\n    return this.currentUrlTree;\n  }\n  rawUrlTree = this.currentUrlTree;\n  getRawUrlTree() {\n    return this.rawUrlTree;\n  }\n  createBrowserPath({\n    finalUrl,\n    initialUrl,\n    targetBrowserUrl\n  }) {\n    const rawUrl = finalUrl !== void 0 ? this.urlHandlingStrategy.merge(finalUrl, initialUrl) : initialUrl;\n    const url = targetBrowserUrl ?? rawUrl;\n    const path = url instanceof UrlTree ? this.urlSerializer.serialize(url) : url;\n    return path;\n  }\n  commitTransition({\n    targetRouterState,\n    finalUrl,\n    initialUrl\n  }) {\n    if (finalUrl && targetRouterState) {\n      this.currentUrlTree = finalUrl;\n      this.rawUrlTree = this.urlHandlingStrategy.merge(finalUrl, initialUrl);\n      this.routerState = targetRouterState;\n    } else {\n      this.rawUrlTree = initialUrl;\n    }\n  }\n  routerState = createEmptyState(null, inject(EnvironmentInjector));\n  getRouterState() {\n    return this.routerState;\n  }\n  _stateMemento = this.createStateMemento();\n  get stateMemento() {\n    return this._stateMemento;\n  }\n  updateStateMemento() {\n    this._stateMemento = this.createStateMemento();\n  }\n  createStateMemento() {\n    return {\n      rawUrlTree: this.rawUrlTree,\n      currentUrlTree: this.currentUrlTree,\n      routerState: this.routerState\n    };\n  }\n  restoredState() {\n    return this.location.getState();\n  }\n  static fac = function StateManager_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _StateManager)();\n  };\n  static prov = defineInjectable({\n    token: _StateManager,\n    factory: () => (() => inject(HistoryStateManager))(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(StateManager, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => inject(HistoryStateManager)\n    }]\n  }], null, null);\n})();\nvar HistoryStateManager = class _HistoryStateManager extends StateManager {\n  currentPageId = 0;\n  lastSuccessfulId = -1;\n  get browserPageId() {\n    if (this.canceledNavigationResolution !== \"computed\") {\n      return this.currentPageId;\n    }\n    return this.restoredState()?.routerPageId ?? this.currentPageId;\n  }\n  registerNonRouterCurrentEntryChangeListener(listener) {\n    return this.location.subscribe((event) => {\n      if (event[\"type\"] === \"popstate\") {\n        setTimeout(() => {\n          listener(event[\"url\"], event.state, \"popstate\");\n        });\n      }\n    });\n  }\n  handleRouterEvent(e, currentTransition) {\n    if (e instanceof NavigationStart) {\n      this.updateStateMemento();\n    } else if (e instanceof NavigationSkipped) {\n      this.commitTransition(currentTransition);\n    } else if (e instanceof RoutesRecognized) {\n      if (this.urlUpdateStrategy === \"eager\") {\n        if (!currentTransition.extras.skipLocationChange) {\n          this.setBrowserUrl(this.createBrowserPath(currentTransition), currentTransition);\n        }\n      }\n    } else if (e instanceof BeforeActivateRoutes) {\n      this.commitTransition(currentTransition);\n      if (this.urlUpdateStrategy === \"deferred\" && !currentTransition.extras.skipLocationChange) {\n        this.setBrowserUrl(this.createBrowserPath(currentTransition), currentTransition);\n      }\n    } else if (e instanceof NavigationCancel && !isRedirectingEvent(e)) {\n      this.restoreHistory(currentTransition);\n    } else if (e instanceof NavigationError) {\n      this.restoreHistory(currentTransition, true);\n    } else if (e instanceof NavigationEnd) {\n      this.lastSuccessfulId = e.id;\n      this.currentPageId = this.browserPageId;\n    }\n  }\n  setBrowserUrl(path, {\n    extras,\n    id\n  }) {\n    const {\n      replaceUrl,\n      state\n    } = extras;\n    if (this.location.isCurrentPathEqualTo(path) || !!replaceUrl) {\n      const currentBrowserPageId = this.browserPageId;\n      const newState = __spreadValues(__spreadValues({}, state), this.generateNgRouterState(id, currentBrowserPageId));\n      this.location.replaceState(path, \"\", newState);\n    } else {\n      const newState = __spreadValues(__spreadValues({}, state), this.generateNgRouterState(id, this.browserPageId + 1));\n      this.location.go(path, \"\", newState);\n    }\n  }\n  restoreHistory(navigation, restoringFromCaughtError = false) {\n    if (this.canceledNavigationResolution === \"computed\") {\n      const currentBrowserPageId = this.browserPageId;\n      const targetPagePosition = this.currentPageId - currentBrowserPageId;\n      if (targetPagePosition !== 0) {\n        this.location.historyGo(targetPagePosition);\n      } else if (this.getCurrentUrlTree() === navigation.finalUrl && targetPagePosition === 0) {\n        this.resetInternalState(navigation);\n        this.resetUrlToCurrentUrlTree();\n      } else ;\n    } else if (this.canceledNavigationResolution === \"replace\") {\n      if (restoringFromCaughtError) {\n        this.resetInternalState(navigation);\n      }\n      this.resetUrlToCurrentUrlTree();\n    }\n  }\n  resetInternalState({\n    finalUrl\n  }) {\n    this.routerState = this.stateMemento.routerState;\n    this.currentUrlTree = this.stateMemento.currentUrlTree;\n    this.rawUrlTree = this.urlHandlingStrategy.merge(this.currentUrlTree, finalUrl ?? this.rawUrlTree);\n  }\n  resetUrlToCurrentUrlTree() {\n    this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()), \"\", this.generateNgRouterState(this.lastSuccessfulId, this.currentPageId));\n  }\n  generateNgRouterState(navigationId, routerPageId) {\n    if (this.canceledNavigationResolution === \"computed\") {\n      return {\n        navigationId,\n        routerPageId: routerPageId\n      };\n    }\n    return {\n      navigationId\n    };\n  }\n  static fac = /* @__PURE__ */ (() => {\n    let HistoryStateManager_BaseFactory;\n    return function HistoryStateManager_Factory(__ngFactoryType__) {\n      return (HistoryStateManager_BaseFactory || (HistoryStateManager_BaseFactory = getInheritedFactory(_HistoryStateManager)))(__ngFactoryType__ || _HistoryStateManager);\n    };\n  })();\n  static prov = defineInjectable({\n    token: _HistoryStateManager,\n    factory: _HistoryStateManager.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HistoryStateManager, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nfunction afterNextNavigation(router, action) {\n  router.events.pipe(filter((e) => e instanceof NavigationEnd || e instanceof NavigationCancel || e instanceof NavigationError || e instanceof NavigationSkipped), map((e) => {\n    if (e instanceof NavigationEnd || e instanceof NavigationSkipped) {\n      return 0;\n    }\n    const redirecting = e instanceof NavigationCancel ? e.code === NavigationCancellationCode.Redirect || e.code === NavigationCancellationCode.SupersededByNewNavigation : false;\n    return redirecting ? 2 : 1;\n  }), filter((result) => result !== 2), take(1)).subscribe(() => {\n    action();\n  });\n}\nvar exactMatchOptions = {\n  paths: \"exact\",\n  fragment: \"ignored\",\n  matrixParams: \"ignored\",\n  queryParams: \"exact\"\n};\nvar subsetMatchOptions = {\n  paths: \"subset\",\n  fragment: \"ignored\",\n  matrixParams: \"ignored\",\n  queryParams: \"subset\"\n};\nvar Router = class _Router {\n  get currentUrlTree() {\n    return this.stateManager.getCurrentUrlTree();\n  }\n  get rawUrlTree() {\n    return this.stateManager.getRawUrlTree();\n  }\n  disposed = false;\n  nonRouterCurrentEntryChangeSubscription;\n  console = inject(Console);\n  stateManager = inject(StateManager);\n  options = inject(ROUTER_CONFIGURATION, {\n    optional: true\n  }) || {};\n  pendingTasks = inject(PendingTasksInternal);\n  urlUpdateStrategy = this.options.urlUpdateStrategy || \"deferred\";\n  navigationTransitions = inject(NavigationTransitions);\n  urlSerializer = inject(UrlSerializer);\n  location = inject(Location);\n  urlHandlingStrategy = inject(UrlHandlingStrategy);\n  injector = inject(EnvironmentInjector);\n  _events = new Subject();\n  get events() {\n    return this._events;\n  }\n  get routerState() {\n    return this.stateManager.getRouterState();\n  }\n  navigated = false;\n  routeReuseStrategy = inject(RouteReuseStrategy);\n  injectorCleanup = inject(ROUTE_INJECTOR_CLEANUP, {\n    optional: true\n  });\n  onSameUrlNavigation = this.options.onSameUrlNavigation || \"ignore\";\n  config = inject(ROUTES, {\n    optional: true\n  })?.flat() ?? [];\n  componentInputBindingEnabled = !!inject(INPUT_BINDER, {\n    optional: true\n  });\n  currentNavigation = this.navigationTransitions.currentNavigation.asReadonly();\n  constructor() {\n    this.resetConfig(this.config);\n    this.navigationTransitions.setupNavigations(this).subscribe({\n      error: (e) => {\n      }\n    });\n    this.subscribeToNavigationEvents();\n  }\n  eventsSubscription = new Subscription();\n  subscribeToNavigationEvents() {\n    const subscription = this.navigationTransitions.events.subscribe((e) => {\n      try {\n        const currentTransition = this.navigationTransitions.currentTransition;\n        const currentNavigation = untracked(this.navigationTransitions.currentNavigation);\n        if (currentTransition !== null && currentNavigation !== null) {\n          this.stateManager.handleRouterEvent(e, currentNavigation);\n          if (e instanceof NavigationCancel && e.code !== NavigationCancellationCode.Redirect && e.code !== NavigationCancellationCode.SupersededByNewNavigation) {\n            this.navigated = true;\n          } else if (e instanceof NavigationEnd) {\n            this.navigated = true;\n            this.injectorCleanup?.(this.routeReuseStrategy, this.routerState, this.config);\n          } else if (e instanceof RedirectRequest) {\n            const opts = e.navigationBehaviorOptions;\n            const mergedTree = this.urlHandlingStrategy.merge(e.url, currentTransition.currentRawUrl);\n            const extras = __spreadValues({\n              scroll: currentTransition.extras.scroll,\n              browserUrl: currentTransition.extras.browserUrl,\n              info: currentTransition.extras.info,\n              skipLocationChange: currentTransition.extras.skipLocationChange,\n              replaceUrl: currentTransition.extras.replaceUrl || this.urlUpdateStrategy === \"eager\" || isBrowserTriggeredNavigation(currentTransition.source)\n            }, opts);\n            this.scheduleNavigation(mergedTree, IMPERATIVE_NAVIGATION, null, extras, {\n              resolve: currentTransition.resolve,\n              reject: currentTransition.reject,\n              promise: currentTransition.promise\n            });\n          }\n        }\n        if (isPublicRouterEvent(e)) {\n          this._events.next(e);\n        }\n      } catch (e2) {\n        this.navigationTransitions.transitionAbortWithErrorSubject.next(e2);\n      }\n    });\n    this.eventsSubscription.add(subscription);\n  }\n  resetRootComponentType(rootComponentType) {\n    this.routerState.root.component = rootComponentType;\n    this.navigationTransitions.rootComponentType = rootComponentType;\n  }\n  initialNavigation() {\n    this.setUpLocationChangeListener();\n    if (!this.navigationTransitions.hasRequestedNavigation) {\n      this.navigateToSyncWithBrowser(this.location.path(true), IMPERATIVE_NAVIGATION, this.stateManager.restoredState());\n    }\n  }\n  setUpLocationChangeListener() {\n    this.nonRouterCurrentEntryChangeSubscription ??= this.stateManager.registerNonRouterCurrentEntryChangeListener((url, state, source) => {\n      this.navigateToSyncWithBrowser(url, source, state);\n    });\n  }\n  navigateToSyncWithBrowser(url, source, state) {\n    const extras = {\n      replaceUrl: true\n    };\n    const restoredState = state?.navigationId ? state : null;\n    if (state) {\n      const stateCopy = __spreadValues({}, state);\n      delete stateCopy.navigationId;\n      delete stateCopy.routerPageId;\n      if (Object.keys(stateCopy).length !== 0) {\n        extras.state = stateCopy;\n      }\n    }\n    const urlTree = this.parseUrl(url);\n    this.scheduleNavigation(urlTree, source, restoredState, extras).catch((e) => {\n      if (this.disposed) {\n        return;\n      }\n      this.injector.get(INTERNAL_APPLICATION_ERROR_HANDLER)(e);\n    });\n  }\n  get url() {\n    return this.serializeUrl(this.currentUrlTree);\n  }\n  getCurrentNavigation() {\n    return untracked(this.navigationTransitions.currentNavigation);\n  }\n  get lastSuccessfulNavigation() {\n    return this.navigationTransitions.lastSuccessfulNavigation;\n  }\n  resetConfig(config) {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && validateConfig(config);\n    this.config = config.map(standardizeConfig);\n    this.navigated = false;\n  }\n  ngOnDestroy() {\n    this.dispose();\n  }\n  dispose() {\n    this._events.unsubscribe();\n    this.navigationTransitions.complete();\n    this.nonRouterCurrentEntryChangeSubscription?.unsubscribe();\n    this.nonRouterCurrentEntryChangeSubscription = void 0;\n    this.disposed = true;\n    this.eventsSubscription.unsubscribe();\n  }\n  createUrlTree(commands, navigationExtras = {}) {\n    const {\n      relativeTo,\n      queryParams,\n      fragment,\n      queryParamsHandling,\n      preserveFragment\n    } = navigationExtras;\n    const f = preserveFragment ? this.currentUrlTree.fragment : fragment;\n    let q = null;\n    switch (queryParamsHandling ?? this.options.defaultQueryParamsHandling) {\n      case \"merge\":\n        q = __spreadValues(__spreadValues({}, this.currentUrlTree.queryParams), queryParams);\n        break;\n      case \"preserve\":\n        q = this.currentUrlTree.queryParams;\n        break;\n      default:\n        q = queryParams || null;\n    }\n    if (q !== null) {\n      q = this.removeEmptyProps(q);\n    }\n    let relativeToUrlSegmentGroup;\n    try {\n      const relativeToSnapshot = relativeTo ? relativeTo.snapshot : this.routerState.snapshot.root;\n      relativeToUrlSegmentGroup = createSegmentGroupFromRoute(relativeToSnapshot);\n    } catch (e) {\n      if (typeof commands[0] !== \"string\" || commands[0][0] !== \"/\") {\n        commands = [];\n      }\n      relativeToUrlSegmentGroup = this.currentUrlTree.root;\n    }\n    return createUrlTreeFromSegmentGroup(relativeToUrlSegmentGroup, commands, q, f ?? null, this.urlSerializer);\n  }\n  navigateByUrl(url, extras = {\n    skipLocationChange: false\n  }) {\n    const urlTree = isUrlTree(url) ? url : this.parseUrl(url);\n    const mergedTree = this.urlHandlingStrategy.merge(urlTree, this.rawUrlTree);\n    return this.scheduleNavigation(mergedTree, IMPERATIVE_NAVIGATION, null, extras);\n  }\n  navigate(commands, extras = {\n    skipLocationChange: false\n  }) {\n    validateCommands(commands);\n    return this.navigateByUrl(this.createUrlTree(commands, extras), extras);\n  }\n  serializeUrl(url) {\n    return this.urlSerializer.serialize(url);\n  }\n  parseUrl(url) {\n    try {\n      return this.urlSerializer.parse(url);\n    } catch (e) {\n      this.console.warn(formatRuntimeError(4018, ngDevMode && `Error parsing URL ${url}. Falling back to '/' instead. \n` + e));\n      return this.urlSerializer.parse(\"/\");\n    }\n  }\n  isActive(url, matchOptions) {\n    let options;\n    if (matchOptions === true) {\n      options = __spreadValues({}, exactMatchOptions);\n    } else if (matchOptions === false) {\n      options = __spreadValues({}, subsetMatchOptions);\n    } else {\n      options = matchOptions;\n    }\n    if (isUrlTree(url)) {\n      return containsTree(this.currentUrlTree, url, options);\n    }\n    const urlTree = this.parseUrl(url);\n    return containsTree(this.currentUrlTree, urlTree, options);\n  }\n  removeEmptyProps(params) {\n    return Object.entries(params).reduce((result, [key, value]) => {\n      if (value !== null && value !== void 0) {\n        result[key] = value;\n      }\n      return result;\n    }, {});\n  }\n  scheduleNavigation(rawUrl, source, restoredState, extras, priorPromise) {\n    if (this.disposed) {\n      return Promise.resolve(false);\n    }\n    let resolve;\n    let reject;\n    let promise;\n    if (priorPromise) {\n      resolve = priorPromise.resolve;\n      reject = priorPromise.reject;\n      promise = priorPromise.promise;\n    } else {\n      promise = new Promise((res, rej) => {\n        resolve = res;\n        reject = rej;\n      });\n    }\n    const taskId = this.pendingTasks.add();\n    afterNextNavigation(this, () => {\n      queueMicrotask(() => this.pendingTasks.remove(taskId));\n    });\n    this.navigationTransitions.handleNavigationRequest({\n      source,\n      restoredState,\n      currentUrlTree: this.currentUrlTree,\n      currentRawUrl: this.currentUrlTree,\n      rawUrl,\n      extras,\n      resolve,\n      reject,\n      promise,\n      currentSnapshot: this.routerState.snapshot,\n      currentRouterState: this.routerState\n    });\n    return promise.catch(Promise.reject.bind(Promise));\n  }\n  static fac = function Router_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _Router)();\n  };\n  static prov = defineInjectable({\n    token: _Router,\n    factory: _Router.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(Router, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [], null);\n})();\nfunction validateCommands(commands) {\n  for (let i = 0; i < commands.length; i++) {\n    const cmd = commands[i];\n    if (cmd == null) {\n      throw new RuntimeError(4008, (typeof ngDevMode === \"undefined\" || ngDevMode) && `The requested path contains ${cmd} segment at index ${i}`);\n    }\n  }\n}\n\n// node_modules/@angular/router/fesm2022/_router_module-chunk.mjs\nvar RouterLink = class _RouterLink {\n  router;\n  route;\n  tabIndexAttribute;\n  renderer;\n  el;\n  locationStrategy;\n  reactiveHref = signal(null, ...ngDevMode ? [{\n    debugName: \"reactiveHref\"\n  }] : []);\n  get href() {\n    return untracked(this.reactiveHref);\n  }\n  set href(value) {\n    this.reactiveHref.set(value);\n  }\n  target;\n  queryParams;\n  fragment;\n  queryParamsHandling;\n  state;\n  info;\n  relativeTo;\n  isAnchorElement;\n  subscription;\n  onChanges = new Subject();\n  applicationErrorHandler = inject(INTERNAL_APPLICATION_ERROR_HANDLER);\n  options = inject(ROUTER_CONFIGURATION, {\n    optional: true\n  });\n  constructor(router, route, tabIndexAttribute, renderer, el, locationStrategy) {\n    this.router = router;\n    this.route = route;\n    this.tabIndexAttribute = tabIndexAttribute;\n    this.renderer = renderer;\n    this.el = el;\n    this.locationStrategy = locationStrategy;\n    this.reactiveHref.set(inject(new HostAttributeToken(\"href\"), {\n      optional: true\n    }));\n    const tagName = el.nativeElement.tagName?.toLowerCase();\n    this.isAnchorElement = tagName === \"a\" || tagName === \"area\" || !!(typeof customElements === \"object\" && customElements.get(tagName)?.observedAttributes?.includes?.(\"href\"));\n    if (this.isAnchorElement) {\n      this.setTabIndexIfNotOnNativeEl(\"0\");\n      this.subscribeToNavigationEventsIfNecessary();\n    }\n  }\n  subscribeToNavigationEventsIfNecessary() {\n    if (this.subscription !== void 0) {\n      return;\n    }\n    this.subscription = this.router.events.subscribe((s) => {\n      if (s instanceof NavigationEnd) {\n        this.updateHref();\n      }\n    });\n  }\n  preserveFragment = false;\n  skipLocationChange = false;\n  replaceUrl = false;\n  setTabIndexIfNotOnNativeEl(newTabIndex) {\n    if (this.tabIndexAttribute != null || this.isAnchorElement) {\n      return;\n    }\n    this.applyAttributeValue(\"tabindex\", newTabIndex);\n  }\n  ngOnChanges(changes) {\n    if (ngDevMode && isUrlTree(this.routerLinkInput) && (this.fragment !== void 0 || this.queryParams || this.queryParamsHandling || this.preserveFragment || this.relativeTo)) {\n      throw new RuntimeError(4017, \"Cannot configure queryParams or fragment when using a UrlTree as the routerLink input value.\");\n    }\n    if (this.isAnchorElement) {\n      this.updateHref();\n    }\n    this.onChanges.next(this);\n  }\n  routerLinkInput = null;\n  set routerLink(commandsOrUrlTree) {\n    if (commandsOrUrlTree == null) {\n      this.routerLinkInput = null;\n      this.setTabIndexIfNotOnNativeEl(null);\n    } else {\n      if (isUrlTree(commandsOrUrlTree)) {\n        this.routerLinkInput = commandsOrUrlTree;\n      } else {\n        this.routerLinkInput = Array.isArray(commandsOrUrlTree) ? commandsOrUrlTree : [commandsOrUrlTree];\n      }\n      this.setTabIndexIfNotOnNativeEl(\"0\");\n    }\n  }\n  onClick(button, ctrlKey, shiftKey, altKey, metaKey) {\n    const urlTree = this.urlTree;\n    if (urlTree === null) {\n      return true;\n    }\n    if (this.isAnchorElement) {\n      if (button !== 0 || ctrlKey || shiftKey || altKey || metaKey) {\n        return true;\n      }\n      if (typeof this.target === \"string\" && this.target != \"_self\") {\n        return true;\n      }\n    }\n    const extras = {\n      skipLocationChange: this.skipLocationChange,\n      replaceUrl: this.replaceUrl,\n      state: this.state,\n      info: this.info\n    };\n    this.router.navigateByUrl(urlTree, extras)?.catch((e) => {\n      this.applicationErrorHandler(e);\n    });\n    return !this.isAnchorElement;\n  }\n  ngOnDestroy() {\n    this.subscription?.unsubscribe();\n  }\n  updateHref() {\n    const urlTree = this.urlTree;\n    this.reactiveHref.set(urlTree !== null && this.locationStrategy ? this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(urlTree)) ?? \"\" : null);\n  }\n  applyAttributeValue(attrName, attrValue) {\n    const renderer = this.renderer;\n    const nativeElement = this.el.nativeElement;\n    if (attrValue !== null) {\n      renderer.setAttribute(nativeElement, attrName, attrValue);\n    } else {\n      renderer.removeAttribute(nativeElement, attrName);\n    }\n  }\n  get urlTree() {\n    if (this.routerLinkInput === null) {\n      return null;\n    } else if (isUrlTree(this.routerLinkInput)) {\n      return this.routerLinkInput;\n    }\n    return this.router.createUrlTree(this.routerLinkInput, {\n      relativeTo: this.relativeTo !== void 0 ? this.relativeTo : this.route,\n      queryParams: this.queryParams,\n      fragment: this.fragment,\n      queryParamsHandling: this.queryParamsHandling,\n      preserveFragment: this.preserveFragment\n    });\n  }\n  static fac = function RouterLink_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouterLink)(directiveInject(Router), directiveInject(ActivatedRoute), injectAttribute(\"tabindex\"), directiveInject(Renderer2), directiveInject(ElementRef), directiveInject(LocationStrategy));\n  };\n  static dir = defineDirective({\n    type: _RouterLink,\n    selectors: [[\"\", \"routerLink\", \"\"]],\n    hostVars: 2,\n    hostBindings: function RouterLink_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        listener(\"click\", function RouterLink_click_HostBindingHandler($event) {\n          return ctx.onClick($event.button, $event.ctrlKey, $event.shiftKey, $event.altKey, $event.metaKey);\n        });\n      }\n      if (rf & 2) {\n        attribute(\"href\", ctx.reactiveHref(), sanitizeUrlOrResourceUrl)(\"target\", ctx.target);\n      }\n    },\n    inputs: {\n      target: \"target\",\n      queryParams: \"queryParams\",\n      fragment: \"fragment\",\n      queryParamsHandling: \"queryParamsHandling\",\n      state: \"state\",\n      info: \"info\",\n      relativeTo: \"relativeTo\",\n      preserveFragment: [2, \"preserveFragment\", \"preserveFragment\", booleanAttribute],\n      skipLocationChange: [2, \"skipLocationChange\", \"skipLocationChange\", booleanAttribute],\n      replaceUrl: [2, \"replaceUrl\", \"replaceUrl\", booleanAttribute],\n      routerLink: \"routerLink\"\n    },\n    features: [NgOnChangesFeature]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterLink, [{\n    type: Directive,\n    args: [{\n      selector: \"[routerLink]\",\n      host: {\n        \"[attr.href]\": \"reactiveHref()\"\n      }\n    }]\n  }], () => [{\n    type: Router\n  }, {\n    type: ActivatedRoute\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Attribute,\n      args: [\"tabindex\"]\n    }]\n  }, {\n    type: Renderer2\n  }, {\n    type: ElementRef\n  }, {\n    type: LocationStrategy\n  }], {\n    target: [{\n      type: HostBinding,\n      args: [\"attr.target\"]\n    }, {\n      type: Input\n    }],\n    queryParams: [{\n      type: Input\n    }],\n    fragment: [{\n      type: Input\n    }],\n    queryParamsHandling: [{\n      type: Input\n    }],\n    state: [{\n      type: Input\n    }],\n    info: [{\n      type: Input\n    }],\n    relativeTo: [{\n      type: Input\n    }],\n    preserveFragment: [{\n      type: Input,\n      args: [{\n        transform: booleanAttribute\n      }]\n    }],\n    skipLocationChange: [{\n      type: Input,\n      args: [{\n        transform: booleanAttribute\n      }]\n    }],\n    replaceUrl: [{\n      type: Input,\n      args: [{\n        transform: booleanAttribute\n      }]\n    }],\n    routerLink: [{\n      type: Input\n    }],\n    onClick: [{\n      type: HostListener,\n      args: [\"click\", [\"$event.button\", \"$event.ctrlKey\", \"$event.shiftKey\", \"$event.altKey\", \"$event.metaKey\"]]\n    }]\n  });\n})();\nvar RouterLinkActive = class _RouterLinkActive {\n  router;\n  element;\n  renderer;\n  cdr;\n  links;\n  classes = [];\n  routerEventsSubscription;\n  linkInputChangesSubscription;\n  _isActive = false;\n  get isActive() {\n    return this._isActive;\n  }\n  routerLinkActiveOptions = {\n    exact: false\n  };\n  ariaCurrentWhenActive;\n  isActiveChange = new EventEmitter();\n  link = inject(RouterLink, {\n    optional: true\n  });\n  constructor(router, element, renderer, cdr) {\n    this.router = router;\n    this.element = element;\n    this.renderer = renderer;\n    this.cdr = cdr;\n    this.routerEventsSubscription = router.events.subscribe((s) => {\n      if (s instanceof NavigationEnd) {\n        this.update();\n      }\n    });\n  }\n  ngAfterContentInit() {\n    of(this.links.changes, of(null)).pipe(mergeAll()).subscribe((_) => {\n      this.update();\n      this.subscribeToEachLinkOnChanges();\n    });\n  }\n  subscribeToEachLinkOnChanges() {\n    this.linkInputChangesSubscription?.unsubscribe();\n    const allLinkChanges = [...this.links.toArray(), this.link].filter((link) => !!link).map((link) => link.onChanges);\n    this.linkInputChangesSubscription = from(allLinkChanges).pipe(mergeAll()).subscribe((link) => {\n      if (this._isActive !== this.isLinkActive(this.router)(link)) {\n        this.update();\n      }\n    });\n  }\n  set routerLinkActive(data) {\n    const classes = Array.isArray(data) ? data : data.split(\" \");\n    this.classes = classes.filter((c) => !!c);\n  }\n  ngOnChanges(changes) {\n    this.update();\n  }\n  ngOnDestroy() {\n    this.routerEventsSubscription.unsubscribe();\n    this.linkInputChangesSubscription?.unsubscribe();\n  }\n  update() {\n    if (!this.links || !this.router.navigated) return;\n    queueMicrotask(() => {\n      const hasActiveLinks = this.hasActiveLinks();\n      this.classes.forEach((c) => {\n        if (hasActiveLinks) {\n          this.renderer.addClass(this.element.nativeElement, c);\n        } else {\n          this.renderer.removeClass(this.element.nativeElement, c);\n        }\n      });\n      if (hasActiveLinks && this.ariaCurrentWhenActive !== void 0) {\n        this.renderer.setAttribute(this.element.nativeElement, \"aria-current\", this.ariaCurrentWhenActive.toString());\n      } else {\n        this.renderer.removeAttribute(this.element.nativeElement, \"aria-current\");\n      }\n      if (this._isActive !== hasActiveLinks) {\n        this._isActive = hasActiveLinks;\n        this.cdr.markForCheck();\n        this.isActiveChange.emit(hasActiveLinks);\n      }\n    });\n  }\n  isLinkActive(router) {\n    const options = isActiveMatchOptions(this.routerLinkActiveOptions) ? this.routerLinkActiveOptions : this.routerLinkActiveOptions.exact ?? false ? __spreadValues({}, exactMatchOptions) : __spreadValues({}, subsetMatchOptions);\n    return (link) => {\n      const urlTree = link.urlTree;\n      return urlTree ? untracked(isActive(urlTree, router, options)) : false;\n    };\n  }\n  hasActiveLinks() {\n    const isActiveCheckFn = this.isLinkActive(this.router);\n    return this.link && isActiveCheckFn(this.link) || this.links.some(isActiveCheckFn);\n  }\n  static fac = function RouterLinkActive_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouterLinkActive)(directiveInject(Router), directiveInject(ElementRef), directiveInject(Renderer2), directiveInject(ChangeDetectorRef));\n  };\n  static dir = defineDirective({\n    type: _RouterLinkActive,\n    selectors: [[\"\", \"routerLinkActive\", \"\"]],\n    contentQueries: function RouterLinkActive_ContentQueries(rf, ctx, dirIndex) {\n      if (rf & 1) {\n        contentQuery(dirIndex, RouterLink, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        queryRefresh(_t = loadQuery()) && (ctx.links = _t);\n      }\n    },\n    inputs: {\n      routerLinkActiveOptions: \"routerLinkActiveOptions\",\n      ariaCurrentWhenActive: \"ariaCurrentWhenActive\",\n      routerLinkActive: \"routerLinkActive\"\n    },\n    outputs: {\n      isActiveChange: \"isActiveChange\"\n    },\n    exportAs: [\"routerLinkActive\"],\n    features: [NgOnChangesFeature]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterLinkActive, [{\n    type: Directive,\n    args: [{\n      selector: \"[routerLinkActive]\",\n      exportAs: \"routerLinkActive\"\n    }]\n  }], () => [{\n    type: Router\n  }, {\n    type: ElementRef\n  }, {\n    type: Renderer2\n  }, {\n    type: ChangeDetectorRef\n  }], {\n    links: [{\n      type: ContentChildren,\n      args: [RouterLink, {\n        descendants: true\n      }]\n    }],\n    routerLinkActiveOptions: [{\n      type: Input\n    }],\n    ariaCurrentWhenActive: [{\n      type: Input\n    }],\n    isActiveChange: [{\n      type: Output\n    }],\n    routerLinkActive: [{\n      type: Input\n    }]\n  });\n})();\nfunction isActiveMatchOptions(options) {\n  return !!options.paths;\n}\nvar PreloadingStrategy = class {\n};\nvar PreloadAllModules = class _PreloadAllModules {\n  preload(route, fn) {\n    return fn().pipe(catchError(() => of(null)));\n  }\n  static fac = function PreloadAllModules_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PreloadAllModules)();\n  };\n  static prov = defineInjectable({\n    token: _PreloadAllModules,\n    factory: _PreloadAllModules.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PreloadAllModules, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nvar NoPreloading = class _NoPreloading {\n  preload(route, fn) {\n    return of(null);\n  }\n  static fac = function NoPreloading_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NoPreloading)();\n  };\n  static prov = defineInjectable({\n    token: _NoPreloading,\n    factory: _NoPreloading.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NoPreloading, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nvar RouterPreloader = class _RouterPreloader {\n  router;\n  injector;\n  preloadingStrategy;\n  loader;\n  subscription;\n  constructor(router, injector, preloadingStrategy, loader) {\n    this.router = router;\n    this.injector = injector;\n    this.preloadingStrategy = preloadingStrategy;\n    this.loader = loader;\n  }\n  setUpPreloading() {\n    this.subscription = this.router.events.pipe(filter((e) => e instanceof NavigationEnd), concatMap(() => this.preload())).subscribe(() => {\n    });\n  }\n  preload() {\n    return this.processRoutes(this.injector, this.router.config);\n  }\n  ngOnDestroy() {\n    this.subscription?.unsubscribe();\n  }\n  processRoutes(injector, routes) {\n    const res = [];\n    for (const route of routes) {\n      if (route.providers && !route._injector) {\n        route._injector = createEnvironmentInjector(route.providers, injector, typeof ngDevMode === \"undefined\" || ngDevMode ? `Route: ${route.path}` : \"\");\n      }\n      const injectorForCurrentRoute = route._injector ?? injector;\n      if (route._loadedNgModuleFactory && !route._loadedInjector) {\n        route._loadedInjector = route._loadedNgModuleFactory.create(injectorForCurrentRoute).injector;\n      }\n      const injectorForChildren = route._loadedInjector ?? injectorForCurrentRoute;\n      if (route.loadChildren && !route._loadedRoutes && route.canLoad === void 0 || route.loadComponent && !route._loadedComponent) {\n        res.push(this.preloadConfig(injectorForCurrentRoute, route));\n      }\n      if (route.children || route._loadedRoutes) {\n        res.push(this.processRoutes(injectorForChildren, route.children ?? route._loadedRoutes));\n      }\n    }\n    return from(res).pipe(mergeAll());\n  }\n  preloadConfig(injector, route) {\n    return this.preloadingStrategy.preload(route, () => {\n      if (injector.destroyed) {\n        return of(null);\n      }\n      let loadedChildren$;\n      if (route.loadChildren && route.canLoad === void 0) {\n        loadedChildren$ = from(this.loader.loadChildren(injector, route));\n      } else {\n        loadedChildren$ = of(null);\n      }\n      const recursiveLoadChildren$ = loadedChildren$.pipe(mergeMap((config) => {\n        if (config === null) {\n          return of(void 0);\n        }\n        route._loadedRoutes = config.routes;\n        route._loadedInjector = config.injector;\n        route._loadedNgModuleFactory = config.factory;\n        return this.processRoutes(config.injector ?? injector, config.routes);\n      }));\n      if (route.loadComponent && !route._loadedComponent) {\n        const loadComponent$ = this.loader.loadComponent(injector, route);\n        return from([recursiveLoadChildren$, loadComponent$]).pipe(mergeAll());\n      } else {\n        return recursiveLoadChildren$;\n      }\n    });\n  }\n  static fac = function RouterPreloader_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouterPreloader)(inject(Router), inject(EnvironmentInjector), inject(PreloadingStrategy), inject(RouterConfigLoader));\n  };\n  static prov = defineInjectable({\n    token: _RouterPreloader,\n    factory: _RouterPreloader.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterPreloader, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: Router\n  }, {\n    type: EnvironmentInjector\n  }, {\n    type: PreloadingStrategy\n  }, {\n    type: RouterConfigLoader\n  }], null);\n})();\nvar ROUTER_SCROLLER = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"Router Scroller\" : \"\");\nvar RouterScroller = class _RouterScroller {\n  options;\n  routerEventsSubscription;\n  scrollEventsSubscription;\n  lastId = 0;\n  lastSource = IMPERATIVE_NAVIGATION;\n  restoredId = 0;\n  store = {};\n  urlSerializer = inject(UrlSerializer);\n  zone = inject(NgZone);\n  viewportScroller = inject(ViewportScroller);\n  transitions = inject(NavigationTransitions);\n  constructor(options) {\n    this.options = options;\n    this.options.scrollPositionRestoration ||= \"disabled\";\n    this.options.anchorScrolling ||= \"disabled\";\n  }\n  init() {\n    if (this.options.scrollPositionRestoration !== \"disabled\") {\n      this.viewportScroller.setHistoryScrollRestoration(\"manual\");\n    }\n    this.routerEventsSubscription = this.createScrollEvents();\n    this.scrollEventsSubscription = this.consumeScrollEvents();\n  }\n  createScrollEvents() {\n    return this.transitions.events.subscribe((e) => {\n      if (e instanceof NavigationStart) {\n        this.store[this.lastId] = this.viewportScroller.getScrollPosition();\n        this.lastSource = e.navigationTrigger;\n        this.restoredId = e.restoredState ? e.restoredState.navigationId : 0;\n      } else if (e instanceof NavigationEnd) {\n        this.lastId = e.id;\n        this.scheduleScrollEvent(e, this.urlSerializer.parse(e.urlAfterRedirects).fragment);\n      } else if (e instanceof NavigationSkipped && e.code === NavigationSkippedCode.IgnoredSameUrlNavigation) {\n        this.lastSource = void 0;\n        this.restoredId = 0;\n        this.scheduleScrollEvent(e, this.urlSerializer.parse(e.url).fragment);\n      }\n    });\n  }\n  consumeScrollEvents() {\n    return this.transitions.events.subscribe((e) => {\n      if (!(e instanceof Scroll) || e.scrollBehavior === \"manual\") return;\n      const instantScroll = {\n        behavior: \"instant\"\n      };\n      if (e.position) {\n        if (this.options.scrollPositionRestoration === \"top\") {\n          this.viewportScroller.scrollToPosition([0, 0], instantScroll);\n        } else if (this.options.scrollPositionRestoration === \"enabled\") {\n          this.viewportScroller.scrollToPosition(e.position, instantScroll);\n        }\n      } else {\n        if (e.anchor && this.options.anchorScrolling === \"enabled\") {\n          this.viewportScroller.scrollToAnchor(e.anchor);\n        } else if (this.options.scrollPositionRestoration !== \"disabled\") {\n          this.viewportScroller.scrollToPosition([0, 0]);\n        }\n      }\n    });\n  }\n  scheduleScrollEvent(routerEvent, anchor) {\n    const scroll = untracked(this.transitions.currentNavigation)?.extras.scroll;\n    this.zone.runOutsideAngular(async () => {\n      await new Promise((resolve) => {\n        setTimeout(resolve);\n        if (typeof requestAnimationFrame !== \"undefined\") {\n          requestAnimationFrame(resolve);\n        }\n      });\n      this.zone.run(() => {\n        this.transitions.events.next(new Scroll(routerEvent, this.lastSource === \"popstate\" ? this.store[this.restoredId] : null, anchor, scroll));\n      });\n    });\n  }\n  ngOnDestroy() {\n    this.routerEventsSubscription?.unsubscribe();\n    this.scrollEventsSubscription?.unsubscribe();\n  }\n  static fac = function RouterScroller_Factory(__ngFactoryType__) {\n    invalidFactory();\n  };\n  static prov = defineInjectable({\n    token: _RouterScroller,\n    factory: _RouterScroller.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterScroller, [{\n    type: Injectable\n  }], () => [{\n    type: void 0\n  }], null);\n})();\nfunction getLoadedRoutes(route) {\n  return route._loadedRoutes;\n}\nfunction getRouterInstance(injector) {\n  return injector.get(Router, null, {\n    optional: true\n  });\n}\nfunction navigateByUrl(router, url) {\n  if (!(router instanceof Router)) {\n    throw new Error(\"The provided router is not an Angular Router.\");\n  }\n  return router.navigateByUrl(url);\n}\nvar NavigationStateManager = class _NavigationStateManager extends StateManager {\n  injector = inject(EnvironmentInjector);\n  navigation = inject(PlatformNavigation);\n  inMemoryScrollingEnabled = inject(ROUTER_SCROLLER, {\n    optional: true\n  }) !== null;\n  base = new URL(inject(PlatformLocation).href).origin;\n  appRootURL = new URL(this.location.prepareExternalUrl?.(\"/\") ?? \"/\", this.base).href;\n  precommitHandlerSupported = inject(PRECOMMIT_HANDLER_SUPPORTED);\n  activeHistoryEntry = this.navigation.currentEntry;\n  currentNavigation = {};\n  nonRouterCurrentEntryChangeSubject = new Subject();\n  nonRouterEntryChangeListener;\n  get registered() {\n    return this.nonRouterEntryChangeListener !== void 0 && !this.nonRouterEntryChangeListener.closed;\n  }\n  constructor() {\n    super();\n    const navigateListener = (event) => {\n      this.handleNavigate(event);\n    };\n    this.navigation.addEventListener(\"navigate\", navigateListener);\n    inject(DestroyRef).onDestroy(() => this.navigation.removeEventListener(\"navigate\", navigateListener));\n  }\n  registerNonRouterCurrentEntryChangeListener(listener) {\n    this.activeHistoryEntry = this.navigation.currentEntry;\n    this.nonRouterEntryChangeListener = this.nonRouterCurrentEntryChangeSubject.subscribe(({\n      path,\n      state\n    }) => {\n      listener(path, state, \"popstate\");\n    });\n    return this.nonRouterEntryChangeListener;\n  }\n  async handleRouterEvent(e, transition) {\n    this.currentNavigation = __spreadProps(__spreadValues({}, this.currentNavigation), {\n      routerTransition: transition\n    });\n    if (e instanceof NavigationStart) {\n      this.updateStateMemento();\n    } else if (e instanceof NavigationSkipped) {\n      this.finishNavigation();\n      this.commitTransition(transition);\n    } else if (e instanceof RoutesRecognized) {\n      if (this.urlUpdateStrategy === \"eager\" && !transition.extras.skipLocationChange) {\n        this.createNavigationForTransition(transition);\n      }\n    } else if (e instanceof BeforeActivateRoutes) {\n      this.commitTransition(transition);\n      if (this.urlUpdateStrategy === \"deferred\" && !transition.extras.skipLocationChange) {\n        this.createNavigationForTransition(transition);\n      }\n    } else if (e instanceof NavigationCancel || e instanceof NavigationError) {\n      void this.cancel(transition, e);\n    } else if (e instanceof NavigationEnd) {\n      const {\n        resolveHandler,\n        removeAbortListener\n      } = this.currentNavigation;\n      this.currentNavigation = {};\n      removeAbortListener?.();\n      this.activeHistoryEntry = this.navigation.currentEntry;\n      afterNextRender({\n        read: () => resolveHandler?.()\n      }, {\n        injector: this.injector\n      });\n    }\n  }\n  createNavigationForTransition(transition) {\n    const {\n      navigationEvent\n    } = this.currentNavigation;\n    if (navigationEvent && navigationEvent.navigationType === \"traverse\" && this.eventAndRouterDestinationsMatch(navigationEvent, transition)) {\n      return;\n    }\n    this.currentNavigation.removeAbortListener?.();\n    const path = this.createBrowserPath(transition);\n    this.navigate(path, transition);\n  }\n  navigate(internalPath, transition) {\n    const path = transition.extras.skipLocationChange ? this.navigation.currentEntry.url : this.location.prepareExternalUrl(internalPath);\n    const state = __spreadProps(__spreadValues({}, transition.extras.state), {\n      navigationId: transition.id\n    });\n    const info = {\n      routerInfo: {\n        intercept: true\n      }\n    };\n    if (!this.navigation.transition && this.currentNavigation.navigationEvent) {\n      transition.extras.replaceUrl = false;\n    }\n    const history = this.location.isCurrentPathEqualTo(path) || transition.extras.replaceUrl || transition.extras.skipLocationChange ? \"replace\" : \"push\";\n    handleResultRejections(this.navigation.navigate(path, {\n      state,\n      history,\n      info\n    }));\n  }\n  finishNavigation() {\n    this.currentNavigation?.resolveHandler?.();\n    this.currentNavigation = {};\n  }\n  async cancel(transition, cause) {\n    this.currentNavigation.rejectNavigateEvent?.();\n    const clearedState = {};\n    this.currentNavigation = clearedState;\n    if (isRedirectingEvent(cause)) {\n      return;\n    }\n    const isTraversalReset = this.canceledNavigationResolution === \"computed\" && this.navigation.currentEntry.key !== this.activeHistoryEntry.key;\n    this.resetInternalState(transition.finalUrl, isTraversalReset);\n    if (this.navigation.currentEntry.id === this.activeHistoryEntry.id) {\n      return;\n    }\n    if (cause instanceof NavigationCancel && cause.code === NavigationCancellationCode.Aborted) {\n      await Promise.resolve();\n      if (this.currentNavigation !== clearedState) {\n        return;\n      }\n    }\n    if (isTraversalReset) {\n      handleResultRejections(this.navigation.traverseTo(this.activeHistoryEntry.key, {\n        info: {\n          routerInfo: {\n            intercept: false\n          }\n        }\n      }));\n    } else {\n      const internalPath = this.urlSerializer.serialize(this.getCurrentUrlTree());\n      const pathOrUrl = this.location.prepareExternalUrl(internalPath);\n      handleResultRejections(this.navigation.navigate(pathOrUrl, {\n        state: this.activeHistoryEntry.getState(),\n        history: \"replace\",\n        info: {\n          routerInfo: {\n            intercept: false\n          }\n        }\n      }));\n    }\n  }\n  resetInternalState(finalUrl, traversalReset) {\n    this.routerState = this.stateMemento.routerState;\n    this.currentUrlTree = this.stateMemento.currentUrlTree;\n    this.rawUrlTree = traversalReset ? this.stateMemento.rawUrlTree : this.urlHandlingStrategy.merge(this.currentUrlTree, finalUrl ?? this.rawUrlTree);\n  }\n  handleNavigate(event) {\n    if (!event.canIntercept || event.navigationType === \"reload\") {\n      return;\n    }\n    const routerInfo = event?.info?.routerInfo;\n    if (routerInfo && !routerInfo.intercept) {\n      return;\n    }\n    const isTriggeredByRouterTransition = !!routerInfo;\n    if (!isTriggeredByRouterTransition) {\n      this.currentNavigation.routerTransition?.abort();\n      if (!this.registered) {\n        this.finishNavigation();\n        return;\n      }\n    }\n    this.currentNavigation = __spreadValues({}, this.currentNavigation);\n    this.currentNavigation.navigationEvent = event;\n    const abortHandler = () => {\n      this.currentNavigation.routerTransition?.abort();\n    };\n    event.signal.addEventListener(\"abort\", abortHandler);\n    this.currentNavigation.removeAbortListener = () => event.signal.removeEventListener(\"abort\", abortHandler);\n    let scroll = this.inMemoryScrollingEnabled ? \"manual\" : this.currentNavigation.routerTransition?.extras.scroll ?? \"after-transition\";\n    const interceptOptions = {\n      scroll\n    };\n    const {\n      promise: handlerPromise,\n      resolve: resolveHandler,\n      reject: rejectHandler\n    } = promiseWithResolvers();\n    this.currentNavigation.resolveHandler = () => {\n      this.currentNavigation.removeAbortListener?.();\n      resolveHandler();\n    };\n    this.currentNavigation.rejectNavigateEvent = () => {\n      this.currentNavigation.removeAbortListener?.();\n      rejectHandler();\n    };\n    handlerPromise.catch(() => {\n    });\n    interceptOptions.handler = () => handlerPromise;\n    event.intercept(interceptOptions);\n    if (!isTriggeredByRouterTransition) {\n      this.handleNavigateEventTriggeredOutsideRouterAPIs(event);\n    }\n  }\n  handleNavigateEventTriggeredOutsideRouterAPIs(event) {\n    const path = event.destination.url.substring(this.appRootURL.length - 1);\n    const state = event.destination.getState();\n    this.nonRouterCurrentEntryChangeSubject.next({\n      path,\n      state\n    });\n  }\n  eventAndRouterDestinationsMatch(navigateEvent, transition) {\n    const internalPath = this.createBrowserPath(transition);\n    const eventDestination = new URL(navigateEvent.destination.url);\n    const routerDestination = this.location.prepareExternalUrl(internalPath);\n    return new URL(routerDestination, eventDestination.origin).href === eventDestination.href;\n  }\n  static fac = function NavigationStateManager_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NavigationStateManager)();\n  };\n  static prov = defineInjectable({\n    token: _NavigationStateManager,\n    factory: _NavigationStateManager.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NavigationStateManager, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [], null);\n})();\nfunction handleResultRejections(result) {\n  result.finished.catch(() => {\n  });\n  result.committed.catch(() => {\n  });\n  return result;\n}\nfunction provideRouter(routes, ...features) {\n  if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n    publishExternalGlobalUtil(\"getLoadedRoutes\", getLoadedRoutes);\n    publishExternalGlobalUtil(\"getRouterInstance\", getRouterInstance);\n    publishExternalGlobalUtil(\"navigateByUrl\", navigateByUrl);\n  }\n  return makeEnvironmentProviders([{\n    provide: ROUTES,\n    multi: true,\n    useValue: routes\n  }, typeof ngDevMode === \"undefined\" || ngDevMode ? {\n    provide: ROUTER_IS_PROVIDED,\n    useValue: true\n  } : [], {\n    provide: ActivatedRoute,\n    useFactory: rootRoute\n  }, {\n    provide: APP_BOOTSTRAP_LISTENER,\n    multi: true,\n    useFactory: getBootstrapListener\n  }, features.map((feature) => feature.providers)]);\n}\nfunction rootRoute() {\n  return inject(Router).routerState.root;\n}\nfunction routerFeature(kind, providers) {\n  return {\n    kind: kind,\n    providers: providers\n  };\n}\nvar ROUTER_IS_PROVIDED = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"Router is provided\" : \"\", {\n  factory: () => false\n});\nvar routerIsProvidedDevModeCheck = {\n  provide: ENVIRONMENT_INITIALIZER,\n  multi: true,\n  useFactory() {\n    return () => {\n      if (!inject(ROUTER_IS_PROVIDED)) {\n        console.warn(\"`provideRoutes` was called without `provideRouter` or `RouterModule.forRoot`. This is likely a mistake.\");\n      }\n    };\n  }\n};\nfunction provideRoutes(routes) {\n  return [{\n    provide: ROUTES,\n    multi: true,\n    useValue: routes\n  }, typeof ngDevMode === \"undefined\" || ngDevMode ? routerIsProvidedDevModeCheck : []];\n}\nfunction withInMemoryScrolling(options = {}) {\n  const providers = [{\n    provide: ROUTER_SCROLLER,\n    useFactory: () => new RouterScroller(options)\n  }];\n  return routerFeature(4, providers);\n}\nfunction withExperimentalPlatformNavigation() {\n  const devModeLocationCheck = typeof ngDevMode === \"undefined\" || ngDevMode ? [provideEnvironmentInitializer(() => {\n    const locationInstance = inject(Location);\n    if (!(locationInstance instanceof NavigationAdapterForLocation)) {\n      const locationConstructorName = locationInstance.constructor.name;\n      let message = `'withExperimentalPlatformNavigation' provides a 'Location' implementation that ensures navigation APIs are consistently used. An instance of ${locationConstructorName} was found instead.`;\n      if (locationConstructorName === \"SpyLocation\") {\n        message += ` One of 'RouterTestingModule' or 'provideLocationMocks' was likely used. 'withExperimentalPlatformNavigation' does not work with these because they override the Location implementation.`;\n      }\n      throw new Error(message);\n    }\n  })] : [];\n  const providers = [{\n    provide: StateManager,\n    useExisting: NavigationStateManager\n  }, {\n    provide: Location,\n    useClass: NavigationAdapterForLocation\n  }, devModeLocationCheck];\n  return routerFeature(11, providers);\n}\nfunction getBootstrapListener() {\n  const injector = inject(Injector);\n  return (bootstrappedComponentRef) => {\n    const ref = injector.get(ApplicationRef);\n    if (bootstrappedComponentRef !== ref.components[0]) {\n      return;\n    }\n    const router = injector.get(Router);\n    const bootstrapDone = injector.get(BOOTSTRAP_DONE);\n    if (injector.get(INITIAL_NAVIGATION) === 1) {\n      router.initialNavigation();\n    }\n    injector.get(ROUTER_PRELOADER, null, {\n      optional: true\n    })?.setUpPreloading();\n    injector.get(ROUTER_SCROLLER, null, {\n      optional: true\n    })?.init();\n    router.resetRootComponentType(ref.componentTypes[0]);\n    if (!bootstrapDone.closed) {\n      bootstrapDone.next();\n      bootstrapDone.complete();\n      bootstrapDone.unsubscribe();\n    }\n  };\n}\nvar BOOTSTRAP_DONE = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"bootstrap done indicator\" : \"\", {\n  factory: () => {\n    return new Subject();\n  }\n});\nvar INITIAL_NAVIGATION = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"initial navigation\" : \"\", {\n  factory: () => 1\n});\nfunction withEnabledBlockingInitialNavigation() {\n  const providers = [{\n    provide: IS_ENABLED_BLOCKING_INITIAL_NAVIGATION,\n    useValue: true\n  }, {\n    provide: INITIAL_NAVIGATION,\n    useValue: 0\n  }, provideAppInitializer(() => {\n    const injector = inject(Injector);\n    const locationInitialized = injector.get(LOCATION_INITIALIZED, Promise.resolve());\n    return locationInitialized.then(() => {\n      return new Promise((resolve) => {\n        const router = injector.get(Router);\n        const bootstrapDone = injector.get(BOOTSTRAP_DONE);\n        afterNextNavigation(router, () => {\n          resolve(true);\n        });\n        injector.get(NavigationTransitions).afterPreactivation = () => {\n          resolve(true);\n          return bootstrapDone.closed ? of(void 0) : bootstrapDone;\n        };\n        router.initialNavigation();\n      });\n    });\n  })];\n  return routerFeature(2, providers);\n}\nfunction withDisabledInitialNavigation() {\n  const providers = [provideAppInitializer(() => {\n    inject(Router).setUpLocationChangeListener();\n  }), {\n    provide: INITIAL_NAVIGATION,\n    useValue: 2\n  }];\n  return routerFeature(3, providers);\n}\nfunction withDebugTracing() {\n  let providers = [];\n  if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n    providers = [{\n      provide: ENVIRONMENT_INITIALIZER,\n      multi: true,\n      useFactory: () => {\n        const router = inject(Router);\n        return () => router.events.subscribe((e) => {\n          console.group?.(`Router Event: ${e.constructor.name}`);\n          console.log(stringifyEvent(e));\n          console.log(e);\n          console.groupEnd?.();\n        });\n      }\n    }];\n  } else {\n    providers = [];\n  }\n  return routerFeature(1, providers);\n}\nvar ROUTER_PRELOADER = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"router preloader\" : \"\");\nfunction withPreloading(preloadingStrategy) {\n  const providers = [{\n    provide: ROUTER_PRELOADER,\n    useExisting: RouterPreloader\n  }, {\n    provide: PreloadingStrategy,\n    useExisting: preloadingStrategy\n  }];\n  return routerFeature(0, providers);\n}\nfunction withRouterConfig(options) {\n  const providers = [{\n    provide: ROUTER_CONFIGURATION,\n    useValue: options\n  }];\n  return routerFeature(5, providers);\n}\nfunction withHashLocation() {\n  const providers = [{\n    provide: LocationStrategy,\n    useClass: HashLocationStrategy\n  }];\n  return routerFeature(6, providers);\n}\nfunction withNavigationErrorHandler(handler) {\n  const providers = [{\n    provide: NAVIGATION_ERROR_HANDLER,\n    useValue: handler\n  }];\n  return routerFeature(7, providers);\n}\nfunction withExperimentalAutoCleanupInjectors() {\n  return routerFeature(10, [{\n    provide: ROUTE_INJECTOR_CLEANUP,\n    useValue: routeInjectorCleanup\n  }]);\n}\nfunction withComponentInputBinding() {\n  const providers = [RoutedComponentInputBinder, {\n    provide: INPUT_BINDER,\n    useExisting: RoutedComponentInputBinder\n  }];\n  return routerFeature(8, providers);\n}\nfunction withViewTransitions(options) {\n  performanceMarkFeature(\"NgRouterViewTransitions\");\n  const providers = [{\n    provide: CREATE_VIEW_TRANSITION,\n    useValue: createViewTransition\n  }, {\n    provide: VIEW_TRANSITION_OPTIONS,\n    useValue: __spreadValues({\n      skipNextTransition: !!options?.skipInitialTransition\n    }, options)\n  }];\n  return routerFeature(9, providers);\n}\nvar ROUTER_DIRECTIVES = [RouterOutlet, RouterLink, RouterLinkActive, EmptyOutletComponent];\nvar ROUTER_FORROOT_GUARD = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"router duplicate forRoot guard\" : \"\");\nvar ROUTER_PROVIDERS = [Location, {\n  provide: UrlSerializer,\n  useClass: DefaultUrlSerializer\n}, Router, ChildrenOutletContexts, {\n  provide: ActivatedRoute,\n  useFactory: rootRoute\n}, RouterConfigLoader, typeof ngDevMode === \"undefined\" || ngDevMode ? {\n  provide: ROUTER_IS_PROVIDED,\n  useValue: true\n} : []];\nvar RouterModule = class _RouterModule {\n  constructor() {\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      inject(ROUTER_FORROOT_GUARD, {\n        optional: true\n      });\n    }\n  }\n  static forRoot(routes, config) {\n    return {\n      ngModule: _RouterModule,\n      providers: [ROUTER_PROVIDERS, typeof ngDevMode === \"undefined\" || ngDevMode ? config?.enableTracing ? withDebugTracing().providers : [] : [], {\n        provide: ROUTES,\n        multi: true,\n        useValue: routes\n      }, typeof ngDevMode === \"undefined\" || ngDevMode ? {\n        provide: ROUTER_FORROOT_GUARD,\n        useFactory: provideForRootGuard\n      } : [], config?.errorHandler ? {\n        provide: NAVIGATION_ERROR_HANDLER,\n        useValue: config.errorHandler\n      } : [], {\n        provide: ROUTER_CONFIGURATION,\n        useValue: config ? config : {}\n      }, config?.useHash ? provideHashLocationStrategy() : providePathLocationStrategy(), provideRouterScroller(), config?.preloadingStrategy ? withPreloading(config.preloadingStrategy).providers : [], config?.initialNavigation ? provideInitialNavigation(config) : [], config?.bindToComponentInputs ? withComponentInputBinding().providers : [], config?.enableViewTransitions ? withViewTransitions().providers : [], provideRouterInitializer()]\n    };\n  }\n  static forChild(routes) {\n    return {\n      ngModule: _RouterModule,\n      providers: [{\n        provide: ROUTES,\n        multi: true,\n        useValue: routes\n      }]\n    };\n  }\n  static fac = function RouterModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _RouterModule)();\n  };\n  static mod = defineNgModule({\n    type: _RouterModule,\n    imports: [RouterOutlet, RouterLink, RouterLinkActive, EmptyOutletComponent],\n    exports: [RouterOutlet, RouterLink, RouterLinkActive, EmptyOutletComponent]\n  });\n  static inj = defineInjector({});\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(RouterModule, [{\n    type: NgModule,\n    args: [{\n      imports: ROUTER_DIRECTIVES,\n      exports: ROUTER_DIRECTIVES\n    }]\n  }], () => [], null);\n})();\nfunction provideRouterScroller() {\n  return {\n    provide: ROUTER_SCROLLER,\n    useFactory: () => {\n      const viewportScroller = inject(ViewportScroller);\n      const config = inject(ROUTER_CONFIGURATION);\n      if (config.scrollOffset) {\n        viewportScroller.setOffset(config.scrollOffset);\n      }\n      return new RouterScroller(config);\n    }\n  };\n}\nfunction provideHashLocationStrategy() {\n  return {\n    provide: LocationStrategy,\n    useClass: HashLocationStrategy\n  };\n}\nfunction providePathLocationStrategy() {\n  return {\n    provide: LocationStrategy,\n    useClass: PathLocationStrategy\n  };\n}\nfunction provideForRootGuard() {\n  const router = inject(Router, {\n    optional: true,\n    skipSelf: true\n  });\n  if (router) {\n    throw new RuntimeError(4007, `The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.`);\n  }\n  return \"guarded\";\n}\nfunction provideInitialNavigation(config) {\n  return [config.initialNavigation === \"disabled\" ? withDisabledInitialNavigation().providers : [], config.initialNavigation === \"enabledBlocking\" ? withEnabledBlockingInitialNavigation().providers : []];\n}\nvar ROUTER_INITIALIZER = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"Router Initializer\" : \"\");\nfunction provideRouterInitializer() {\n  return [{\n    provide: ROUTER_INITIALIZER,\n    useFactory: getBootstrapListener\n  }, {\n    provide: APP_BOOTSTRAP_LISTENER,\n    multi: true,\n    useExisting: ROUTER_INITIALIZER\n  }];\n}\n\n// node_modules/@angular/router/fesm2022/router.mjs\nfunction mapToCanMatch(providers) {\n  return providers.map((provider) => (...params) => inject(provider).canMatch(...params));\n}\nfunction mapToCanActivate(providers) {\n  return providers.map((provider) => (...params) => inject(provider).canActivate(...params));\n}\nfunction mapToCanActivateChild(providers) {\n  return providers.map((provider) => (...params) => inject(provider).canActivateChild(...params));\n}\nfunction mapToCanDeactivate(providers) {\n  return providers.map((provider) => (...params) => inject(provider).canDeactivate(...params));\n}\nfunction mapToResolve(provider) {\n  return (...params) => inject(provider).resolve(...params);\n}\nvar VERSION = new Version(\"21.1.3\");\nexport {\n  ActivatedRoute,\n  ActivatedRouteSnapshot,\n  ActivationEnd,\n  ActivationStart,\n  BaseRouteReuseStrategy,\n  ChildActivationEnd,\n  ChildActivationStart,\n  ChildrenOutletContexts,\n  DefaultTitleStrategy,\n  DefaultUrlSerializer,\n  EventType,\n  GuardsCheckEnd,\n  GuardsCheckStart,\n  NavigationCancel,\n  NavigationCancellationCode,\n  NavigationEnd,\n  NavigationError,\n  NavigationSkipped,\n  NavigationSkippedCode,\n  NavigationStart,\n  NoPreloading,\n  OutletContext,\n  PRIMARY_OUTLET,\n  PreloadAllModules,\n  PreloadingStrategy,\n  ROUTER_CONFIGURATION,\n  ROUTER_INITIALIZER,\n  ROUTER_OUTLET_DATA,\n  ROUTES,\n  RedirectCommand,\n  ResolveEnd,\n  ResolveStart,\n  RouteConfigLoadEnd,\n  RouteConfigLoadStart,\n  RouteReuseStrategy,\n  Router,\n  RouterEvent,\n  RouterLink,\n  RouterLinkActive,\n  RouterLink as RouterLinkWithHref,\n  RouterModule,\n  RouterOutlet,\n  RouterPreloader,\n  RouterState,\n  RouterStateSnapshot,\n  RoutesRecognized,\n  Scroll,\n  TitleStrategy,\n  UrlHandlingStrategy,\n  UrlSegment,\n  UrlSegmentGroup,\n  UrlSerializer,\n  UrlTree,\n  VERSION,\n  convertToParamMap,\n  createUrlTreeFromSnapshot,\n  defaultUrlMatcher,\n  destroyDetachedRouteHandle,\n  isActive,\n  mapToCanActivate,\n  mapToCanActivateChild,\n  mapToCanDeactivate,\n  mapToCanMatch,\n  mapToResolve,\n  provideRouter,\n  provideRoutes,\n  withComponentInputBinding,\n  withDebugTracing,\n  withDisabledInitialNavigation,\n  withEnabledBlockingInitialNavigation,\n  withExperimentalAutoCleanupInjectors,\n  withExperimentalPlatformNavigation,\n  withHashLocation,\n  withInMemoryScrolling,\n  withNavigationErrorHandler,\n  withPreloading,\n  withRouterConfig,\n  withViewTransitions,\n  EmptyOutletComponent,\n  ROUTER_PROVIDERS as ROUTER_PROVIDERS,\n  afterNextNavigation as afterNextNavigation,\n  loadChildren as loadChildren\n};\n//# sourceMappingURL=@angular_router.js.map\n"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.210Z",
        "time": 4.009000025689602,
        "timings": {
          "blocked": 2.4549999823495745,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.3970000227279961,
          "receive": 1.1570000206120312,
          "_blocked_queueing": 2.3979999823495746,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/main.js",
          "lineNumber": 11
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common_http.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "8791"
            },
            {
              "name": "Etag",
              "value": "W/\"870-ijoKMy/4DcJ7vIZqd2yY6NNSXhk\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 8791,
            "mimeType": "text/javascript",
            "text": "import {\n  FetchBackend,\n  HTTP_INTERCEPTORS,\n  HTTP_ROOT_INTERCEPTOR_FNS,\n  HTTP_TRANSFER_CACHE_ORIGIN_MAP,\n  HttpBackend,\n  HttpClient,\n  HttpClientJsonpModule,\n  HttpClientModule,\n  HttpClientXsrfModule,\n  HttpContext,\n  HttpContextToken,\n  HttpErrorResponse,\n  HttpEventType,\n  HttpFeatureKind,\n  HttpHandler,\n  HttpHeaderResponse,\n  HttpHeaders,\n  HttpInterceptorHandler,\n  HttpParams,\n  HttpRequest,\n  HttpResponse,\n  HttpResponseBase,\n  HttpStatusCode,\n  HttpUrlEncodingCodec,\n  HttpXhrBackend,\n  HttpXsrfTokenExtractor,\n  JsonpClientBackend,\n  JsonpInterceptor,\n  REQUESTS_CONTRIBUTE_TO_STABILITY,\n  httpResource,\n  provideHttpClient,\n  withFetch,\n  withHttpTransferCache,\n  withInterceptors,\n  withInterceptorsFromDi,\n  withJsonpSupport,\n  withNoXsrfProtection,\n  withRequestsMadeViaParent,\n  withXsrfConfiguration\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-43XS5UPA.js?v=a3ec8c6b\";\nimport \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\nexport {\n  FetchBackend,\n  HTTP_INTERCEPTORS,\n  HTTP_TRANSFER_CACHE_ORIGIN_MAP,\n  HttpBackend,\n  HttpClient,\n  HttpClientJsonpModule,\n  HttpClientModule,\n  HttpClientXsrfModule,\n  HttpContext,\n  HttpContextToken,\n  HttpErrorResponse,\n  HttpEventType,\n  HttpFeatureKind,\n  HttpHandler,\n  HttpHeaderResponse,\n  HttpHeaders,\n  HttpParams,\n  HttpRequest,\n  HttpResponse,\n  HttpResponseBase,\n  HttpStatusCode,\n  HttpUrlEncodingCodec,\n  HttpXhrBackend,\n  HttpXsrfTokenExtractor,\n  JsonpClientBackend,\n  JsonpInterceptor,\n  httpResource,\n  provideHttpClient,\n  withFetch,\n  withInterceptors,\n  withInterceptorsFromDi,\n  withJsonpSupport,\n  withNoXsrfProtection,\n  withRequestsMadeViaParent,\n  withXsrfConfiguration,\n  HTTP_ROOT_INTERCEPTOR_FNS as HTTP_ROOT_INTERCEPTOR_FNS,\n  HttpInterceptorHandler as HttpInterceptingHandler,\n  REQUESTS_CONTRIBUTE_TO_STABILITY as REQUESTS_CONTRIBUTE_TO_STABILITY,\n  withHttpTransferCache as withHttpTransferCache\n};\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkBhbmd1bGFyX2NvbW1vbl9odHRwLmpzP3Y9YTNlYzhjNmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRmV0Y2hCYWNrZW5kLFxuICBIVFRQX0lOVEVSQ0VQVE9SUyxcbiAgSFRUUF9ST09UX0lOVEVSQ0VQVE9SX0ZOUyxcbiAgSFRUUF9UUkFOU0ZFUl9DQUNIRV9PUklHSU5fTUFQLFxuICBIdHRwQmFja2VuZCxcbiAgSHR0cENsaWVudCxcbiAgSHR0cENsaWVudEpzb25wTW9kdWxlLFxuICBIdHRwQ2xpZW50TW9kdWxlLFxuICBIdHRwQ2xpZW50WHNyZk1vZHVsZSxcbiAgSHR0cENvbnRleHQsXG4gIEh0dHBDb250ZXh0VG9rZW4sXG4gIEh0dHBFcnJvclJlc3BvbnNlLFxuICBIdHRwRXZlbnRUeXBlLFxuICBIdHRwRmVhdHVyZUtpbmQsXG4gIEh0dHBIYW5kbGVyLFxuICBIdHRwSGVhZGVyUmVzcG9uc2UsXG4gIEh0dHBIZWFkZXJzLFxuICBIdHRwSW50ZXJjZXB0b3JIYW5kbGVyLFxuICBIdHRwUGFyYW1zLFxuICBIdHRwUmVxdWVzdCxcbiAgSHR0cFJlc3BvbnNlLFxuICBIdHRwUmVzcG9uc2VCYXNlLFxuICBIdHRwU3RhdHVzQ29kZSxcbiAgSHR0cFVybEVuY29kaW5nQ29kZWMsXG4gIEh0dHBYaHJCYWNrZW5kLFxuICBIdHRwWHNyZlRva2VuRXh0cmFjdG9yLFxuICBKc29ucENsaWVudEJhY2tlbmQsXG4gIEpzb25wSW50ZXJjZXB0b3IsXG4gIFJFUVVFU1RTX0NPTlRSSUJVVEVfVE9fU1RBQklMSVRZLFxuICBodHRwUmVzb3VyY2UsXG4gIHByb3ZpZGVIdHRwQ2xpZW50LFxuICB3aXRoRmV0Y2gsXG4gIHdpdGhIdHRwVHJhbnNmZXJDYWNoZSxcbiAgd2l0aEludGVyY2VwdG9ycyxcbiAgd2l0aEludGVyY2VwdG9yc0Zyb21EaSxcbiAgd2l0aEpzb25wU3VwcG9ydCxcbiAgd2l0aE5vWHNyZlByb3RlY3Rpb24sXG4gIHdpdGhSZXF1ZXN0c01hZGVWaWFQYXJlbnQsXG4gIHdpdGhYc3JmQ29uZmlndXJhdGlvblxufSBmcm9tIFwiL0Bmcy9DOi9Vc2Vycy9tb3VyYS9Eb2N1bWVudHMvU2NhZmZvbGQvZnJvbnRlbmQvLmFuZ3VsYXIvY2FjaGUvMjEuMS4zL2Zyb250ZW5kL3ZpdGUvZGVwcy9jaHVuay00M1hTNVVQQS5qcz92PWEzZWM4YzZiXCI7XG5pbXBvcnQgXCIvQGZzL0M6L1VzZXJzL21vdXJhL0RvY3VtZW50cy9TY2FmZm9sZC9mcm9udGVuZC8uYW5ndWxhci9jYWNoZS8yMS4xLjMvZnJvbnRlbmQvdml0ZS9kZXBzL2NodW5rLUFBWDdMNkZYLmpzP3Y9YTNlYzhjNmJcIjtcbmltcG9ydCBcIi9AZnMvQzovVXNlcnMvbW91cmEvRG9jdW1lbnRzL1NjYWZmb2xkL2Zyb250ZW5kLy5hbmd1bGFyL2NhY2hlLzIxLjEuMy9mcm9udGVuZC92aXRlL2RlcHMvY2h1bmstTEVIUlo3SUsuanM/dj1hM2VjOGM2YlwiO1xuZXhwb3J0IHtcbiAgRmV0Y2hCYWNrZW5kLFxuICBIVFRQX0lOVEVSQ0VQVE9SUyxcbiAgSFRUUF9UUkFOU0ZFUl9DQUNIRV9PUklHSU5fTUFQLFxuICBIdHRwQmFja2VuZCxcbiAgSHR0cENsaWVudCxcbiAgSHR0cENsaWVudEpzb25wTW9kdWxlLFxuICBIdHRwQ2xpZW50TW9kdWxlLFxuICBIdHRwQ2xpZW50WHNyZk1vZHVsZSxcbiAgSHR0cENvbnRleHQsXG4gIEh0dHBDb250ZXh0VG9rZW4sXG4gIEh0dHBFcnJvclJlc3BvbnNlLFxuICBIdHRwRXZlbnRUeXBlLFxuICBIdHRwRmVhdHVyZUtpbmQsXG4gIEh0dHBIYW5kbGVyLFxuICBIdHRwSGVhZGVyUmVzcG9uc2UsXG4gIEh0dHBIZWFkZXJzLFxuICBIdHRwUGFyYW1zLFxuICBIdHRwUmVxdWVzdCxcbiAgSHR0cFJlc3BvbnNlLFxuICBIdHRwUmVzcG9uc2VCYXNlLFxuICBIdHRwU3RhdHVzQ29kZSxcbiAgSHR0cFVybEVuY29kaW5nQ29kZWMsXG4gIEh0dHBYaHJCYWNrZW5kLFxuICBIdHRwWHNyZlRva2VuRXh0cmFjdG9yLFxuICBKc29ucENsaWVudEJhY2tlbmQsXG4gIEpzb25wSW50ZXJjZXB0b3IsXG4gIGh0dHBSZXNvdXJjZSxcbiAgcHJvdmlkZUh0dHBDbGllbnQsXG4gIHdpdGhGZXRjaCxcbiAgd2l0aEludGVyY2VwdG9ycyxcbiAgd2l0aEludGVyY2VwdG9yc0Zyb21EaSxcbiAgd2l0aEpzb25wU3VwcG9ydCxcbiAgd2l0aE5vWHNyZlByb3RlY3Rpb24sXG4gIHdpdGhSZXF1ZXN0c01hZGVWaWFQYXJlbnQsXG4gIHdpdGhYc3JmQ29uZmlndXJhdGlvbixcbiAgSFRUUF9ST09UX0lOVEVSQ0VQVE9SX0ZOUyBhcyDJtUhUVFBfUk9PVF9JTlRFUkNFUFRPUl9GTlMsXG4gIEh0dHBJbnRlcmNlcHRvckhhbmRsZXIgYXMgybVIdHRwSW50ZXJjZXB0aW5nSGFuZGxlcixcbiAgUkVRVUVTVFNfQ09OVFJJQlVURV9UT19TVEFCSUxJVFkgYXMgybVSRVFVRVNUU19DT05UUklCVVRFX1RPX1NUQUJJTElUWSxcbiAgd2l0aEh0dHBUcmFuc2ZlckNhY2hlIGFzIMm1d2l0aEh0dHBUcmFuc2ZlckNhY2hlXG59O1xuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sQ0FBQztBQUNQLENBQUMsQ0FBQyxZQUFZO0FBQ2QsQ0FBQyxDQUFDLGlCQUFpQjtBQUNuQixDQUFDLENBQUMseUJBQXlCO0FBQzNCLENBQUMsQ0FBQyw4QkFBOEI7QUFDaEMsQ0FBQyxDQUFDLFdBQVc7QUFDYixDQUFDLENBQUMsVUFBVTtBQUNaLENBQUMsQ0FBQyxxQkFBcUI7QUFDdkIsQ0FBQyxDQUFDLGdCQUFnQjtBQUNsQixDQUFDLENBQUMsb0JBQW9CO0FBQ3RCLENBQUMsQ0FBQyxXQUFXO0FBQ2IsQ0FBQyxDQUFDLGdCQUFnQjtBQUNsQixDQUFDLENBQUMsaUJBQWlCO0FBQ25CLENBQUMsQ0FBQyxhQUFhO0FBQ2YsQ0FBQyxDQUFDLGVBQWU7QUFDakIsQ0FBQyxDQUFDLFdBQVc7QUFD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"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.210Z",
        "time": 3.1850000377744436,
        "timings": {
          "blocked": 2.4890000317655505,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.37899997872859237,
          "receive": 0.31700002728030086,
          "_blocked_queueing": 2.4580000317655504,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/main.js",
          "lineNumber": 14
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_common.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "18181"
            },
            {
              "name": "Etag",
              "value": "W/\"11b2-ouhXWinrUhgU4qKKeDvH4eKQMqc\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 18181,
            "mimeType": "text/javascript",
            "text": "import {\n  APP_BASE_HREF,\n  AsyncPipe,\n  CommonModule,\n  CurrencyPipe,\n  DATE_PIPE_DEFAULT_OPTIONS,\n  DATE_PIPE_DEFAULT_TIMEZONE,\n  DatePipe,\n  DecimalPipe,\n  FormStyle,\n  FormatWidth,\n  HashLocationStrategy,\n  I18nPluralPipe,\n  I18nSelectPipe,\n  IMAGE_LOADER,\n  JsonPipe,\n  KeyValuePipe,\n  Location,\n  LocationStrategy,\n  LowerCasePipe,\n  NavigationAdapterForLocation,\n  NgClass,\n  NgComponentOutlet,\n  NgForOf,\n  NgForOfContext,\n  NgIf,\n  NgIfContext,\n  NgLocaleLocalization,\n  NgLocalization,\n  NgOptimizedImage,\n  NgPlural,\n  NgPluralCase,\n  NgStyle,\n  NgSwitch,\n  NgSwitchCase,\n  NgSwitchDefault,\n  NgTemplateOutlet,\n  NullViewportScroller,\n  NumberFormatStyle,\n  NumberSymbol,\n  PLATFORM_BROWSER_ID,\n  PLATFORM_SERVER_ID,\n  PRECOMMIT_HANDLER_SUPPORTED,\n  PRECONNECT_CHECK_BLOCKLIST,\n  PathLocationStrategy,\n  PercentPipe,\n  PlatformNavigation,\n  Plural,\n  SlicePipe,\n  TitleCasePipe,\n  TranslationWidth,\n  UpperCasePipe,\n  VERSION,\n  ViewportScroller,\n  WeekDay,\n  formatCurrency,\n  formatDate,\n  formatNumber,\n  formatPercent,\n  getCurrencySymbol,\n  getLocaleCurrencyCode,\n  getLocaleCurrencyName,\n  getLocaleCurrencySymbol,\n  getLocaleDateFormat,\n  getLocaleDateTimeFormat,\n  getLocaleDayNames,\n  getLocaleDayPeriods,\n  getLocaleDirection,\n  getLocaleEraNames,\n  getLocaleExtraDayPeriodRules,\n  getLocaleExtraDayPeriods,\n  getLocaleFirstDayOfWeek,\n  getLocaleId,\n  getLocaleMonthNames,\n  getLocaleNumberFormat,\n  getLocaleNumberSymbol,\n  getLocalePluralCase,\n  getLocaleTimeFormat,\n  getLocaleWeekEndRange,\n  getNumberOfCurrencyDigits,\n  isPlatformBrowser,\n  isPlatformServer,\n  normalizeQueryParams,\n  provideCloudflareLoader,\n  provideCloudinaryLoader,\n  provideImageKitLoader,\n  provideImgixLoader,\n  provideNetlifyLoader,\n  registerLocaleData\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-CGVE6HH2.js?v=a3ec8c6b\";\nimport {\n  BrowserPlatformLocation,\n  DomAdapter,\n  LOCATION_INITIALIZED,\n  PlatformLocation,\n  XhrFactory,\n  getDOM,\n  parseCookieValue,\n  setRootDomAdapter\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport {\n  DOCUMENT,\n  IMAGE_CONFIG\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\nexport {\n  APP_BASE_HREF,\n  AsyncPipe,\n  BrowserPlatformLocation,\n  CommonModule,\n  CurrencyPipe,\n  DATE_PIPE_DEFAULT_OPTIONS,\n  DATE_PIPE_DEFAULT_TIMEZONE,\n  DOCUMENT,\n  DatePipe,\n  DecimalPipe,\n  FormStyle,\n  FormatWidth,\n  HashLocationStrategy,\n  I18nPluralPipe,\n  I18nSelectPipe,\n  IMAGE_CONFIG,\n  IMAGE_LOADER,\n  JsonPipe,\n  KeyValuePipe,\n  LOCATION_INITIALIZED,\n  Location,\n  LocationStrategy,\n  LowerCasePipe,\n  NgClass,\n  NgComponentOutlet,\n  NgForOf as NgFor,\n  NgForOf,\n  NgForOfContext,\n  NgIf,\n  NgIfContext,\n  NgLocaleLocalization,\n  NgLocalization,\n  NgOptimizedImage,\n  NgPlural,\n  NgPluralCase,\n  NgStyle,\n  NgSwitch,\n  NgSwitchCase,\n  NgSwitchDefault,\n  NgTemplateOutlet,\n  NumberFormatStyle,\n  NumberSymbol,\n  PRECONNECT_CHECK_BLOCKLIST,\n  PathLocationStrategy,\n  PercentPipe,\n  PlatformLocation,\n  PlatformNavigation,\n  Plural,\n  SlicePipe,\n  TitleCasePipe,\n  TranslationWidth,\n  UpperCasePipe,\n  VERSION,\n  ViewportScroller,\n  WeekDay,\n  XhrFactory,\n  formatCurrency,\n  formatDate,\n  formatNumber,\n  formatPercent,\n  getCurrencySymbol,\n  getLocaleCurrencyCode,\n  getLocaleCurrencyName,\n  getLocaleCurrencySymbol,\n  getLocaleDateFormat,\n  getLocaleDateTimeFormat,\n  getLocaleDayNames,\n  getLocaleDayPeriods,\n  getLocaleDirection,\n  getLocaleEraNames,\n  getLocaleExtraDayPeriodRules,\n  getLocaleExtraDayPeriods,\n  getLocaleFirstDayOfWeek,\n  getLocaleId,\n  getLocaleMonthNames,\n  getLocaleNumberFormat,\n  getLocaleNumberSymbol,\n  getLocalePluralCase,\n  getLocaleTimeFormat,\n  getLocaleWeekEndRange,\n  getNumberOfCurrencyDigits,\n  isPlatformBrowser,\n  isPlatformServer,\n  provideCloudflareLoader,\n  provideCloudinaryLoader,\n  provideImageKitLoader,\n  provideImgixLoader,\n  provideNetlifyLoader,\n  registerLocaleData,\n  DomAdapter as DomAdapter,\n  NavigationAdapterForLocation as NavigationAdapterForLocation,\n  NullViewportScroller as NullViewportScroller,\n  PLATFORM_BROWSER_ID as PLATFORM_BROWSER_ID,\n  PLATFORM_SERVER_ID as PLATFORM_SERVER_ID,\n  PRECOMMIT_HANDLER_SUPPORTED as PRECOMMIT_HANDLER_SUPPORTED,\n  getDOM as getDOM,\n  normalizeQueryParams as normalizeQueryParams,\n  parseCookieValue as parseCookieValue,\n  setRootDomAdapter as setRootDomAdapter\n};\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkBhbmd1bGFyX2NvbW1vbi5qcz92PWEzZWM4YzZiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFQUF9CQVNFX0hSRUYsXG4gIEFzeW5jUGlwZSxcbiAgQ29tbW9uTW9kdWxlLFxuICBDdXJyZW5jeVBpcGUsXG4gIERBVEVfUElQRV9ERUZBVUxUX09QVElPTlMsXG4gIERBVEVfUElQRV9ERUZBVUxUX1RJTUVaT05FLFxuICBEYXRlUGlwZSxcbiAgRGVjaW1hbFBpcGUsXG4gIEZvcm1TdHlsZSxcbiAgRm9ybWF0V2lkdGgsXG4gIEhhc2hMb2NhdGlvblN0cmF0ZWd5LFxuICBJMThuUGx1cmFsUGlwZSxcbiAgSTE4blNlbGVjdFBpcGUsXG4gIElNQUdFX0xPQURFUixcbiAgSnNvblBpcGUsXG4gIEtleVZhbHVlUGlwZSxcbiAgTG9jYXRpb24sXG4gIExvY2F0aW9uU3RyYXRlZ3ksXG4gIExvd2VyQ2FzZVBpcGUsXG4gIE5hdmlnYXRpb25BZGFwdGVyRm9yTG9jYXRpb24sXG4gIE5nQ2xhc3MsXG4gIE5nQ29tcG9uZW50T3V0bGV0LFxuICBOZ0Zvck9mLFxuICBOZ0Zvck9mQ29udGV4dCxcbiAgTmdJZixcbiAgTmdJZkNvbnRleHQsXG4gIE5nTG9jYWxlTG9jYWxpemF0aW9uLFxuICBOZ0xvY2FsaXphdGlvbixcbiAgTmdPcHRpbWl6ZWRJbWFnZSxcbiAgTmdQbHVyYWwsXG4gIE5nUGx1cmFsQ2FzZSxcbiAgTmdTdHlsZSxcbiAgTmdTd2l0Y2gsXG4gIE5nU3dpdGNoQ2FzZSxcbiAgTmdTd2l0Y2hEZWZhdWx0LFxuICBOZ1RlbXBsYXRlT3V0bGV0LFxuICBOdWxsVmlld3BvcnRTY3JvbGxlcixcbiAgTnVtYmVyRm9ybWF0U3R5bGUsXG4gIE51bWJlclN5bWJvbCxcbiAgUExBVEZPUk1fQlJPV1NFUl9JRCxcbiAgUExBVEZPUk1fU0VSVkVSX0lELFxuICBQUkVDT01NSVRfSEFORExFUl9TVVBQT1JURUQsXG4gIFBSRUNPTk5FQ1RfQ0hFQ0tfQkxPQ0tMSVNULFxuICBQYXRoTG9jYXRpb25TdHJhdGVneSxcbiAgUGVyY2VudFBpcGUsXG4gIFBsYXRmb3JtTmF2aWdhdGlvbixcbiAgUGx1cmFsLFxuICBTbGljZVBpcGUsXG4gIFRpdGxlQ2FzZVBpcGUsXG4gIFRyYW5zbGF0aW9uV2lkdGgsXG4gIFVwcGVyQ2FzZVBpcGUsXG4gIFZFUlNJT04sXG4gIFZpZXdwb3J0U2Nyb2xsZXIsXG4gIFdlZWtEYXksXG4gIGZvcm1hdEN1cnJlbmN5LFxuICBmb3JtYXREYXRlLFxuICBmb3JtYXROdW1iZXIsXG4gIGZvcm1hdFBlcmNlbnQsXG4gIGdldEN1cnJlbmN5U3ltYm9sLFxuICBnZXRMb2NhbGVDdXJyZW5jeUNvZGUsXG4gIGdldExvY2FsZUN1cnJlbmN5TmFtZSxcbiAgZ2V0TG9jYWxlQ3VycmVuY3lTeW1ib2wsXG4gIGdldExvY2FsZURhdGVGb3JtYXQsXG4gIGdldExvY2FsZURhdGVUaW1lRm9ybWF0LFxuICBnZXRMb2NhbGVEYXlOYW1lcyxcbiAgZ2V0TG9jYWxlRGF5UGVyaW9kcyxcbiAgZ2V0TG9jYWxlRGlyZWN0aW9uLFxuICBnZXRMb2NhbGVFcmFOYW1lcyxcbiAgZ2V0TG9jYWxlRXh0cmFEYXlQZXJpb2RSdWxlcyxcbiAgZ2V0TG9jYWxlRXh0cmFEYXlQZXJpb2RzLFxuICBnZXRMb2NhbGVGaXJzdERheU9mV2VlayxcbiAgZ2V0TG9jYWxlSWQsXG4gIGdldExvY2FsZU1vbnRoTmFtZXMsXG4gIGdldExvY2FsZU51bWJlckZvcm1hdCxcbiAgZ2V0TG9jYWxlTnVtYmVyU3ltYm9sLFxuICBnZXRMb2NhbGVQbHVyYWxDYXNlLFxuICBnZXRMb2NhbGVUaW1lRm9ybWF0LFxuICBnZXRMb2NhbGVXZWVrRW5kUmFuZ2UsXG4gIGdldE51bWJlck9mQ3VycmVuY3lEaWdpdHMsXG4gIGlzUGxhdGZvcm1Ccm93c2VyLFxuICBpc1BsYXRmb3JtU2VydmVyLFxuICBub3JtYWxpemVRdWVyeVBhcmFtcyxcbiAgcHJvdmlkZUNsb3VkZmxhcmVMb2FkZXIsXG4gIHByb3ZpZGVDbG91ZGluYXJ5TG9hZGVyLFxuICBwcm92aWRlSW1hZ2VLaXRMb2FkZXIsXG4gIHByb3ZpZGVJbWdpeExvYWRlcixcbiAgcHJvdmlkZU5ldGxpZnlMb2FkZXIsXG4gIHJlZ2lzdGVyTG9jYWxlRGF0YVxufSBmcm9tIFwiL0Bmcy9DOi9Vc2Vycy9tb3VyYS9Eb2N1bWVudHMvU2NhZmZvbGQvZnJvbnRlbmQvLmFuZ3VsYXIvY2FjaGUvMjEuMS4zL2Zyb250ZW5kL3ZpdGUvZGVwcy9jaHVuay1DR1ZFNkhIMi5qcz92PWEzZWM4YzZiXCI7XG5pbXBvcnQge1xuICBCcm93c2VyUGxhdGZvcm1Mb2NhdGlvbixcbiAgRG9tQWRhcHRlcixcbiAgTE9DQVRJT05fSU5JVElBTElaRUQsXG4gIFBsYXRmb3JtTG9jYXRpb24sXG4gIFhockZhY3RvcnksXG4gIGdldERPTSxcbiAgcGFyc2VDb29raWVWYWx1ZSxcbiAgc2V0Um9vdERvbUFkYXB0ZXJcbn0gZnJvbSBcIi9AZnMvQzovVXNlcnMvbW91cmEvRG9jdW1lbnRzL1NjYWZmb2xkL2Zyb250ZW5kLy5hbmd1bGFyL2NhY2hlLzIxLjEuMy9mcm9udGVuZC92aXRlL2RlcHMvY2h1bmstQUFYN0w2RlguanM/dj1hM2VjOGM2YlwiO1xuaW1wb3J0IHtcbiAgRE9DVU1FTlQsXG4gIElNQUdFX0NPTkZJR1xufSBmcm9tIFwiL0Bmcy9DOi9Vc2Vycy9tb3VyYS9Eb2N1bWVudHMvU2NhZmZvbGQvZnJvbnRlbmQvLmFuZ3VsYXIvY2FjaGUvMjEuMS4zL2Zyb250ZW5kL3ZpdGUvZGVwcy9jaHVuay1MRUhSWjdJSy5qcz92PWEzZWM4YzZiXCI7XG5leHBvcnQge1xuICBBUFBfQkFTRV9IUkVGLFxuICBBc3luY1BpcGUsXG4gIEJyb3dzZXJQbGF0Zm9ybUxvY2F0aW9uLFxuICBDb21tb25Nb2R1bGUsXG4gIEN1cnJlbmN5UGlwZSxcbiAgREFURV9QSVBFX0RFRkFVTFRfT1BUSU9OUyxcbiAgREFURV9QSVBFX0RFRkFVTFRfVElNRVpPTkUsXG4gIERPQ1VNRU5ULFxuICBEYXRlUGlwZSxcbiAgRGVjaW1hbFBpcGUsXG4gIEZvcm1TdHlsZSxcbiAgRm9ybWF0V2lkdGgsXG4gIEhhc2hMb2NhdGlvblN0cmF0ZWd5LFxuICBJMThuUGx1cmFsUGlwZSxcbiAgSTE4blNlbGVjdFBpcGUsXG4gIElNQUdFX0NPTkZJRyxcbiAgSU1BR0VfTE9BREVSLFxuICBKc29uUGlwZSxcbiAgS2V5VmFsdWVQaXBlLFxuICBMT0NBVElPTl9JTklUSUFMSVpFRCxcbiAgTG9jYXRpb24sXG4gIExvY2F0aW9uU3RyYXRlZ3ksXG4gIExvd2VyQ2FzZVBpcGUsXG4gIE5nQ2xhc3MsXG4gIE5nQ29tcG9uZW50T3V0bGV0LFxuICBOZ0Zvck9mIGFzIE5nRm9yLFxuICBOZ0Zvck9mLFxuICBOZ0Zvck9mQ29udGV4dCxcbiAgTmdJZixcbiAgTmdJZkNvbnRleHQsXG4gIE5nTG9jYWxlTG9jYWxpemF0aW9uLFxuICBOZ0xvY2FsaXphdGlvbixcbiAgTmdPcHRpbWl6ZWRJbWFnZSxcbiAgTmdQbHVyYWwsXG4gIE5nUGx1cmFsQ2FzZSxcbiAgTmdTdHlsZSxcbiAgTmdTd2l0Y2gsXG4gIE5nU3dpdGNoQ2FzZSxcbiAgTmdTd2l0Y2hEZWZhdWx0LFxuICBOZ1RlbXBsYXRlT3V0bGV0LFxuICBOdW1iZXJGb3JtYXRTdHlsZSxcbiAgTnVtYmVyU3ltYm9sLFxuICBQUkVDT05ORUNUX0NIRUNLX0JMT0NLTElTVCxcbiAgUGF0aExvY2F0aW9uU3RyYXRlZ3ksXG4gIFBlcmNlbnRQaXBlLFxuICBQbGF0Zm9ybUxvY2F0aW9uLFxuICBQbGF0Zm9ybU5hdmlnYXRpb24sXG4gIFBsdXJhbCxcbiAgU2xpY2VQaXBlLFxuICBUaXRsZUNhc2VQaXBlLFxuICBUcmFuc2xhdGlvbldpZHRoLFxuICBVcHBlckNhc2VQaXBlLFxuICBWRVJTSU9OLFxuICBWaWV3cG9ydFNjcm9sbGVyLFxuICBXZWVrRGF5LFxuICBYaHJGYWN0b3J5LFxuICBmb3JtYXRDdXJyZW5jeSxcbiAgZm9ybWF0RGF0ZSxcbiAgZm9ybWF0TnVtYmVyLFxuICBmb3JtYXRQZXJjZW50LFxuICBnZXRDdXJyZW5jeVN5bWJvbCxcbiAgZ2V0TG9jYWxlQ3VycmVuY3lDb2RlLFxuICBnZXRMb2NhbGVDdXJyZW5jeU5hbWUsXG4gIGdldExvY2FsZUN1cnJlbmN5U3ltYm9sLFxuICBnZXRMb2NhbGVEYXRlRm9ybWF0LFxuICBnZXRMb2NhbGVEYXRlVGltZUZvcm1hdCxcbiAgZ2V0TG9jYWxlRGF5TmFtZXMsXG4gIGdldExvY2FsZURheVBlcmlvZHMsXG4gIGdldExvY2FsZURpcmVjdGlvbixcbiAgZ2V0TG9jYWxlRXJhTmFtZXMsXG4gIGdldExvY2FsZUV4dHJhRGF5UGVyaW9kUnVsZXMsXG4gIGdldExvY2FsZUV4dHJhRGF5UGVyaW9kcyxcbiAgZ2V0TG9jYWxlRmlyc3REYXlPZldlZWssXG4gIGdldExvY2FsZUlkLFxuICBnZXRMb2NhbGVNb250aE5hbWVzLFxuICBnZXRMb2NhbGVOdW1iZXJGb3JtYXQsXG4gIGdldExvY2FsZU51bWJlclN5bWJvbCxcbiAgZ2V0TG9jYWxlUGx1cmFsQ2FzZSxcbiAgZ2V0TG9jYWxlVGltZUZvcm1hdCxcbiAgZ2V0TG9jYWxlV2Vla0VuZFJhbmdlLFxuICBnZXROdW1iZXJPZkN1cnJlbmN5RGlnaXRzLFxuICBpc1BsYXRmb3JtQnJvd3NlcixcbiAgaXNQbGF0Zm9ybVNlcnZlcixcbiAgcHJvdmlkZUNsb3VkZmxhcmVMb2FkZXIsXG4gIHByb3ZpZGVDbG91ZGluYXJ5TG9hZGVyLFxuICBwcm92aWRlSW1hZ2VLaXRMb2FkZXIsXG4gIHByb3ZpZGVJbWdpeExvYWRlcixcbiAgcHJvdmlkZU5ldGxpZnlMb2FkZXIsXG4gIHJlZ2lzdGVyTG9jYWxlRGF0YSxcbiAgRG9tQWRhcHRlciBhcyDJtURvbUFkYXB0ZXIsXG4gIE5hdmlnYXRpb25BZGFwdGVyRm9yTG9jYXRpb24gYXMgybVOYXZpZ2F0aW9uQWRhcHRlckZvckxvY2F0aW9uLFxuICBOdWxsVmlld3BvcnRTY3JvbGxlciBhcyDJtU51bGxWaWV3cG9ydFNjcm9sbGVyLFxuICBQTEFURk9STV9CUk9XU0VSX0lEIGFzIMm1UExBVEZPUk1fQlJPV1NFUl9JRCxcbiAgUExBVEZPUk1fU0VSVkVSX0lEIGFzIMm1UExBVEZPUk1fU0VSVkVSX0lELFxuICBQUkVDT01NSVRfSEFORExFUl9TVVBQT1JURUQgYXMgybVQUkVDT01NSVRfSEFORExFUl9TVVBQT1JURUQsXG4gIGdldERPTSBhcyDJtWdldERPTSxcbiAgbm9ybWFsaXplUXVlcnlQYXJhbXMgYXMgybVub3JtYWxpemVRdWVyeVBhcmFtcyxcbiAgcGFyc2VDb29raWVWYWx1ZSBhcyDJtXBhcnNlQ29va2llVmFsdWUsXG4gIHNldFJvb3REb21BZGFwdGVyIGFzIMm1c2V0Um9vdERvbUFkYXB0ZXJcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxDQUFDO0FBQ1AsQ0FBQyxDQUFDLGFBQWE7QUFDZixDQUFDLENBQUMsU0FBUztBQUNYLENBQUMsQ0FBQyxZQUFZO0FBQ2QsQ0FBQyxDQUFDLFlBQVk7QUFDZCxDQUFDLENBQUMseUJBQXlCO0FBQzNCLENBQUMsQ0FBQywwQkFBMEI7QUFDNUIsQ0FBQyxDQUFDLFFBQVE7QUFDVixDQUFDLENBQUMsV0FBVztBQUNiLENBQUMsQ0FBQyxTQUFTO0FBQ1gsQ0FBQyxDQUFDLFdBQVc7QUFDYixDQUFDLENBQUMsb0JBQW9CO0FBQ3RCLENBQUMsQ0FBQyxjQUFjO0FBQ2hCLENBQUMsQ0FBQyxjQUFjO0FBQ2hCLENBQUMsQ0FBQyxZQUFZO0FBQ2QsQ0FBQyxDQUFDLFFBQVE7QUFDVixDQUFDLENBQUMsWUFBWTtBQUNkLENBQUMsQ0FBQyxRQUFRO0FBQ1YsQ0FBQyxDQUFDLGdCQUFnQjtBQUNsQixDQUFDLENBQUMsYUFBYTtBQUNmLENBQUMsQ0FBQyw0QkFBNEI7QUFDOUIsQ0FBQyxDQUFDLE9BQU87QUFDVCxDQUFDLENBQUMsaUJBQWlCO0FBQ25CLENBQUMsQ0FBQyxPQUFPO0FBQ1QsQ0FBQyxDQUFDLGNBQWM7QUFDaEIsQ0FBQyxDQUFDLElBQUk7QUFDTixDQUFDLENBQUMsV0FBVztB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"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.210Z",
        "time": 3.555000002961606,
        "timings": {
          "blocked": 2.496999988786876,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.6520000076964497,
          "receive": 0.40600000647827983,
          "_blocked_queueing": 2.459999988786876,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b",
          "lineNumber": 36
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-SXEFOV7B.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "54296"
            },
            {
              "name": "Etag",
              "value": "W/\"d418-iEYIK9zVKsfNE9skeIcLA+HGhUg\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 54296,
            "mimeType": "text/javascript",
            "text": "import {\n  CommonModule,\n  PLATFORM_BROWSER_ID\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-CGVE6HH2.js?v=a3ec8c6b\";\nimport {\n  withHttpTransferCache\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-43XS5UPA.js?v=a3ec8c6b\";\nimport {\n  DomAdapter,\n  XhrFactory,\n  getDOM,\n  parseCookieValue,\n  setRootDomAdapter\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport {\n  APP_ID,\n  ApplicationModule,\n  ApplicationRef,\n  CSP_NONCE,\n  Console,\n  DOCUMENT,\n  ENVIRONMENT_INITIALIZER,\n  ErrorHandler,\n  INJECTOR_SCOPE,\n  IS_ENABLED_BLOCKING_INITIAL_NAVIGATION,\n  Inject,\n  Injectable,\n  InjectionToken,\n  Injector,\n  NgModule,\n  NgZone,\n  Optional,\n  PLATFORM_ID,\n  PLATFORM_INITIALIZER,\n  RendererFactory2,\n  RendererStyleFlags2,\n  RuntimeError,\n  SecurityContext,\n  TESTABILITY,\n  TESTABILITY_GETTER,\n  Testability,\n  TracingService,\n  Version,\n  ViewEncapsulation,\n  XSS_SECURITY_URL,\n  __spreadValues,\n  _global,\n  _sanitizeHtml,\n  _sanitizeUrl,\n  allLeavingAnimations,\n  allowSanitizationBypassAndThrow,\n  bypassSanitizationTrustHtml,\n  bypassSanitizationTrustResourceUrl,\n  bypassSanitizationTrustScript,\n  bypassSanitizationTrustStyle,\n  bypassSanitizationTrustUrl,\n  createPlatformFactory,\n  formatRuntimeError,\n  forwardRef,\n  inject,\n  internalCreateApplication,\n  makeEnvironmentProviders,\n  platformCore,\n  provideStabilityDebugging,\n  setClassMetadata,\n  setDocument,\n  unwrapSafeValue,\n  withDomHydration,\n  withEventReplay,\n  withI18nSupport,\n  withIncrementalHydration,\n  defineInjectable,\n  defineInjector,\n  defineNgModule,\n  inject\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\n\n// node_modules/@angular/platform-browser/fesm2022/_dom_renderer-chunk.mjs\nvar EventManagerPlugin = class {\n  _doc;\n  constructor(_doc) {\n    this._doc = _doc;\n  }\n  manager;\n};\nvar DomEventsPlugin = class _DomEventsPlugin extends EventManagerPlugin {\n  constructor(doc) {\n    super(doc);\n  }\n  supports(eventName) {\n    return true;\n  }\n  addEventListener(element, eventName, handler, options) {\n    element.addEventListener(eventName, handler, options);\n    return () => this.removeEventListener(element, eventName, handler, options);\n  }\n  removeEventListener(target, eventName, callback, options) {\n    return target.removeEventListener(eventName, callback, options);\n  }\n  static fac = function DomEventsPlugin_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DomEventsPlugin)(inject(DOCUMENT));\n  };\n  static prov = defineInjectable({\n    token: _DomEventsPlugin,\n    factory: _DomEventsPlugin.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DomEventsPlugin, [{\n    type: Injectable\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }], null);\n})();\nvar EVENT_MANAGER_PLUGINS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"EventManagerPlugins\" : \"\");\nvar EventManager = class _EventManager {\n  _zone;\n  _plugins;\n  _eventNameToPlugin = /* @__PURE__ */ new Map();\n  constructor(plugins, _zone) {\n    this._zone = _zone;\n    plugins.forEach((plugin) => {\n      plugin.manager = this;\n    });\n    const otherPlugins = plugins.filter((p) => !(p instanceof DomEventsPlugin));\n    this._plugins = otherPlugins.slice().reverse();\n    const domEventPlugin = plugins.find((p) => p instanceof DomEventsPlugin);\n    if (domEventPlugin) {\n      this._plugins.push(domEventPlugin);\n    }\n  }\n  addEventListener(element, eventName, handler, options) {\n    const plugin = this._findPluginFor(eventName);\n    return plugin.addEventListener(element, eventName, handler, options);\n  }\n  getZone() {\n    return this._zone;\n  }\n  _findPluginFor(eventName) {\n    let plugin = this._eventNameToPlugin.get(eventName);\n    if (plugin) {\n      return plugin;\n    }\n    const plugins = this._plugins;\n    plugin = plugins.find((plugin2) => plugin2.supports(eventName));\n    if (!plugin) {\n      throw new RuntimeError(5101, (typeof ngDevMode === \"undefined\" || ngDevMode) && `No event manager plugin found for event ${eventName}`);\n    }\n    this._eventNameToPlugin.set(eventName, plugin);\n    return plugin;\n  }\n  static fac = function EventManager_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _EventManager)(inject(EVENT_MANAGER_PLUGINS), inject(NgZone));\n  };\n  static prov = defineInjectable({\n    token: _EventManager,\n    factory: _EventManager.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(EventManager, [{\n    type: Injectable\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [EVENT_MANAGER_PLUGINS]\n    }]\n  }, {\n    type: NgZone\n  }], null);\n})();\nvar APP_ID_ATTRIBUTE_NAME = \"ng-app-id\";\nfunction removeElements(elements) {\n  for (const element of elements) {\n    element.remove();\n  }\n}\nfunction createStyleElement(style, doc) {\n  const styleElement = doc.createElement(\"style\");\n  styleElement.textContent = style;\n  return styleElement;\n}\nfunction addServerStyles(doc, appId, inline, external) {\n  const elements = doc.head?.querySelectorAll(`style[${APP_ID_ATTRIBUTE_NAME}=\"${appId}\"],link[${APP_ID_ATTRIBUTE_NAME}=\"${appId}\"]`);\n  if (elements) {\n    for (const styleElement of elements) {\n      styleElement.removeAttribute(APP_ID_ATTRIBUTE_NAME);\n      if (styleElement instanceof HTMLLinkElement) {\n        external.set(styleElement.href.slice(styleElement.href.lastIndexOf(\"/\") + 1), {\n          usage: 0,\n          elements: [styleElement]\n        });\n      } else if (styleElement.textContent) {\n        inline.set(styleElement.textContent, {\n          usage: 0,\n          elements: [styleElement]\n        });\n      }\n    }\n  }\n}\nfunction createLinkElement(url, doc) {\n  const linkElement = doc.createElement(\"link\");\n  linkElement.setAttribute(\"rel\", \"stylesheet\");\n  linkElement.setAttribute(\"href\", url);\n  return linkElement;\n}\nvar SharedStylesHost = class _SharedStylesHost {\n  doc;\n  appId;\n  nonce;\n  inline = /* @__PURE__ */ new Map();\n  external = /* @__PURE__ */ new Map();\n  hosts = /* @__PURE__ */ new Set();\n  constructor(doc, appId, nonce, platformId = {}) {\n    this.doc = doc;\n    this.appId = appId;\n    this.nonce = nonce;\n    addServerStyles(doc, appId, this.inline, this.external);\n    this.hosts.add(doc.head);\n  }\n  addStyles(styles, urls) {\n    for (const value of styles) {\n      this.addUsage(value, this.inline, createStyleElement);\n    }\n    urls?.forEach((value) => this.addUsage(value, this.external, createLinkElement));\n  }\n  removeStyles(styles, urls) {\n    for (const value of styles) {\n      this.removeUsage(value, this.inline);\n    }\n    urls?.forEach((value) => this.removeUsage(value, this.external));\n  }\n  addUsage(value, usages, creator) {\n    const record = usages.get(value);\n    if (record) {\n      if ((typeof ngDevMode === \"undefined\" || ngDevMode) && record.usage === 0) {\n        record.elements.forEach((element) => element.setAttribute(\"ng-style-reused\", \"\"));\n      }\n      record.usage++;\n    } else {\n      usages.set(value, {\n        usage: 1,\n        elements: [...this.hosts].map((host) => this.addElement(host, creator(value, this.doc)))\n      });\n    }\n  }\n  removeUsage(value, usages) {\n    const record = usages.get(value);\n    if (record) {\n      record.usage--;\n      if (record.usage <= 0) {\n        removeElements(record.elements);\n        usages.delete(value);\n      }\n    }\n  }\n  ngOnDestroy() {\n    for (const [, {\n      elements\n    }] of [...this.inline, ...this.external]) {\n      removeElements(elements);\n    }\n    this.hosts.clear();\n  }\n  addHost(hostNode) {\n    this.hosts.add(hostNode);\n    for (const [style, {\n      elements\n    }] of this.inline) {\n      elements.push(this.addElement(hostNode, createStyleElement(style, this.doc)));\n    }\n    for (const [url, {\n      elements\n    }] of this.external) {\n      elements.push(this.addElement(hostNode, createLinkElement(url, this.doc)));\n    }\n  }\n  removeHost(hostNode) {\n    this.hosts.delete(hostNode);\n  }\n  addElement(host, element) {\n    if (this.nonce) {\n      element.setAttribute(\"nonce\", this.nonce);\n    }\n    if (false) {\n      element.setAttribute(APP_ID_ATTRIBUTE_NAME, this.appId);\n    }\n    return host.appendChild(element);\n  }\n  static fac = function SharedStylesHost_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _SharedStylesHost)(inject(DOCUMENT), inject(APP_ID), inject(CSP_NONCE, 8), inject(PLATFORM_ID));\n  };\n  static prov = defineInjectable({\n    token: _SharedStylesHost,\n    factory: _SharedStylesHost.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(SharedStylesHost, [{\n    type: Injectable\n  }], () => [{\n    type: Document,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [APP_ID]\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [CSP_NONCE]\n    }, {\n      type: Optional\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [PLATFORM_ID]\n    }]\n  }], null);\n})();\nvar NAMESPACE_URIS = {\n  \"svg\": \"http://www.w3.org/2000/svg\",\n  \"xhtml\": \"http://www.w3.org/1999/xhtml\",\n  \"xlink\": \"http://www.w3.org/1999/xlink\",\n  \"xml\": \"http://www.w3.org/XML/1998/namespace\",\n  \"xmlns\": \"http://www.w3.org/2000/xmlns/\",\n  \"math\": \"http://www.w3.org/1998/Math/MathML\"\n};\nvar COMPONENT_REGEX = /%COMP%/g;\nvar SOURCEMAP_URL_REGEXP = /\\/\\*#\\s*sourceMappingURL=(.+?)\\s*\\*\\//;\nvar PROTOCOL_REGEXP = /^https?:/;\nvar COMPONENT_VARIABLE = \"%COMP%\";\nvar HOST_ATTR = `_nghost-${COMPONENT_VARIABLE}`;\nvar CONTENT_ATTR = `_ngcontent-${COMPONENT_VARIABLE}`;\nvar REMOVE_STYLES_ON_COMPONENT_DESTROY_DEFAULT = true;\nvar REMOVE_STYLES_ON_COMPONENT_DESTROY = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"RemoveStylesOnCompDestroy\" : \"\", {\n  factory: () => REMOVE_STYLES_ON_COMPONENT_DESTROY_DEFAULT\n});\nfunction shimContentAttribute(componentShortId) {\n  return CONTENT_ATTR.replace(COMPONENT_REGEX, componentShortId);\n}\nfunction shimHostAttribute(componentShortId) {\n  return HOST_ATTR.replace(COMPONENT_REGEX, componentShortId);\n}\nfunction shimStylesContent(compId, styles) {\n  return styles.map((s) => s.replace(COMPONENT_REGEX, compId));\n}\nfunction addBaseHrefToCssSourceMap(baseHref, styles) {\n  if (!baseHref) {\n    return styles;\n  }\n  const absoluteBaseHrefUrl = new URL(baseHref, \"http://localhost\");\n  return styles.map((cssContent) => {\n    if (!cssContent.includes(\"sourceMappingURL=\")) {\n      return cssContent;\n    }\n    return cssContent.replace(SOURCEMAP_URL_REGEXP, (_, sourceMapUrl) => {\n      if (sourceMapUrl[0] === \"/\" || sourceMapUrl.startsWith(\"data:\") || PROTOCOL_REGEXP.test(sourceMapUrl)) {\n        return `/*# sourceMappingURL=${sourceMapUrl} */`;\n      }\n      const {\n        pathname: resolvedSourceMapUrl\n      } = new URL(sourceMapUrl, absoluteBaseHrefUrl);\n      return `/*# sourceMappingURL=${resolvedSourceMapUrl} */`;\n    });\n  });\n}\nvar DomRendererFactory2 = class _DomRendererFactory2 {\n  eventManager;\n  sharedStylesHost;\n  appId;\n  removeStylesOnCompDestroy;\n  doc;\n  ngZone;\n  nonce;\n  tracingService;\n  rendererByCompId = /* @__PURE__ */ new Map();\n  defaultRenderer;\n  constructor(eventManager, sharedStylesHost, appId, removeStylesOnCompDestroy, doc, ngZone, nonce = null, tracingService = null) {\n    this.eventManager = eventManager;\n    this.sharedStylesHost = sharedStylesHost;\n    this.appId = appId;\n    this.removeStylesOnCompDestroy = removeStylesOnCompDestroy;\n    this.doc = doc;\n    this.ngZone = ngZone;\n    this.nonce = nonce;\n    this.tracingService = tracingService;\n    this.defaultRenderer = new DefaultDomRenderer2(eventManager, doc, ngZone, this.tracingService);\n  }\n  createRenderer(element, type) {\n    if (!element || !type) {\n      return this.defaultRenderer;\n    }\n    if (false) {\n      type = __spreadProps(__spreadValues({}, type), {\n        encapsulation: ViewEncapsulation.Emulated\n      });\n    }\n    const renderer = this.getOrCreateRenderer(element, type);\n    if (renderer instanceof EmulatedEncapsulationDomRenderer2) {\n      renderer.applyToHost(element);\n    } else if (renderer instanceof NoneEncapsulationDomRenderer) {\n      renderer.applyStyles();\n    }\n    return renderer;\n  }\n  getOrCreateRenderer(element, type) {\n    const rendererByCompId = this.rendererByCompId;\n    let renderer = rendererByCompId.get(type.id);\n    if (!renderer) {\n      const doc = this.doc;\n      const ngZone = this.ngZone;\n      const eventManager = this.eventManager;\n      const sharedStylesHost = this.sharedStylesHost;\n      const removeStylesOnCompDestroy = this.removeStylesOnCompDestroy;\n      const tracingService = this.tracingService;\n      switch (type.encapsulation) {\n        case ViewEncapsulation.Emulated:\n          renderer = new EmulatedEncapsulationDomRenderer2(eventManager, sharedStylesHost, type, this.appId, removeStylesOnCompDestroy, doc, ngZone, tracingService);\n          break;\n        case ViewEncapsulation.ShadowDom:\n          return new ShadowDomRenderer(eventManager, element, type, doc, ngZone, this.nonce, tracingService, sharedStylesHost);\n        case ViewEncapsulation.ExperimentalIsolatedShadowDom:\n          return new ShadowDomRenderer(eventManager, element, type, doc, ngZone, this.nonce, tracingService);\n        default:\n          renderer = new NoneEncapsulationDomRenderer(eventManager, sharedStylesHost, type, removeStylesOnCompDestroy, doc, ngZone, tracingService);\n          break;\n      }\n      rendererByCompId.set(type.id, renderer);\n    }\n    return renderer;\n  }\n  ngOnDestroy() {\n    this.rendererByCompId.clear();\n  }\n  componentReplaced(componentId) {\n    this.rendererByCompId.delete(componentId);\n  }\n  static fac = function DomRendererFactory2_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DomRendererFactory2)(inject(EventManager), inject(SharedStylesHost), inject(APP_ID), inject(REMOVE_STYLES_ON_COMPONENT_DESTROY), inject(DOCUMENT), inject(NgZone), inject(CSP_NONCE), inject(TracingService, 8));\n  };\n  static prov = defineInjectable({\n    token: _DomRendererFactory2,\n    factory: _DomRendererFactory2.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DomRendererFactory2, [{\n    type: Injectable\n  }], () => [{\n    type: EventManager\n  }, {\n    type: SharedStylesHost\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [APP_ID]\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [REMOVE_STYLES_ON_COMPONENT_DESTROY]\n    }]\n  }, {\n    type: Document,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }, {\n    type: NgZone\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [CSP_NONCE]\n    }]\n  }, {\n    type: TracingService,\n    decorators: [{\n      type: Inject,\n      args: [TracingService]\n    }, {\n      type: Optional\n    }]\n  }], null);\n})();\nvar DefaultDomRenderer2 = class {\n  eventManager;\n  doc;\n  ngZone;\n  tracingService;\n  data = /* @__PURE__ */ Object.create(null);\n  throwOnSyntheticProps = true;\n  constructor(eventManager, doc, ngZone, tracingService) {\n    this.eventManager = eventManager;\n    this.doc = doc;\n    this.ngZone = ngZone;\n    this.tracingService = tracingService;\n  }\n  destroy() {\n  }\n  destroyNode = null;\n  createElement(name, namespace) {\n    if (namespace) {\n      return this.doc.createElementNS(NAMESPACE_URIS[namespace] || namespace, name);\n    }\n    return this.doc.createElement(name);\n  }\n  createComment(value) {\n    return this.doc.createComment(value);\n  }\n  createText(value) {\n    return this.doc.createTextNode(value);\n  }\n  appendChild(parent, newChild) {\n    const targetParent = isTemplateNode(parent) ? parent.content : parent;\n    targetParent.appendChild(newChild);\n  }\n  insertBefore(parent, newChild, refChild) {\n    if (parent) {\n      const targetParent = isTemplateNode(parent) ? parent.content : parent;\n      targetParent.insertBefore(newChild, refChild);\n    }\n  }\n  removeChild(_parent, oldChild) {\n    oldChild.remove();\n  }\n  selectRootElement(selectorOrNode, preserveContent) {\n    let el = typeof selectorOrNode === \"string\" ? this.doc.querySelector(selectorOrNode) : selectorOrNode;\n    if (!el) {\n      throw new RuntimeError(-5104, (typeof ngDevMode === \"undefined\" || ngDevMode) && `The selector \"${selectorOrNode}\" did not match any elements`);\n    }\n    if (!preserveContent) {\n      el.textContent = \"\";\n    }\n    return el;\n  }\n  parentNode(node) {\n    return node.parentNode;\n  }\n  nextSibling(node) {\n    return node.nextSibling;\n  }\n  setAttribute(el, name, value, namespace) {\n    if (namespace) {\n      name = namespace + \":\" + name;\n      const namespaceUri = NAMESPACE_URIS[namespace];\n      if (namespaceUri) {\n        el.setAttributeNS(namespaceUri, name, value);\n      } else {\n        el.setAttribute(name, value);\n      }\n    } else {\n      el.setAttribute(name, value);\n    }\n  }\n  removeAttribute(el, name, namespace) {\n    if (namespace) {\n      const namespaceUri = NAMESPACE_URIS[namespace];\n      if (namespaceUri) {\n        el.removeAttributeNS(namespaceUri, name);\n      } else {\n        el.removeAttribute(`${namespace}:${name}`);\n      }\n    } else {\n      el.removeAttribute(name);\n    }\n  }\n  addClass(el, name) {\n    el.classList.add(name);\n  }\n  removeClass(el, name) {\n    el.classList.remove(name);\n  }\n  setStyle(el, style, value, flags) {\n    if (flags & (RendererStyleFlags2.DashCase | RendererStyleFlags2.Important)) {\n      el.style.setProperty(style, value, flags & RendererStyleFlags2.Important ? \"important\" : \"\");\n    } else {\n      el.style[style] = value;\n    }\n  }\n  removeStyle(el, style, flags) {\n    if (flags & RendererStyleFlags2.DashCase) {\n      el.style.removeProperty(style);\n    } else {\n      el.style[style] = \"\";\n    }\n  }\n  setProperty(el, name, value) {\n    if (el == null) {\n      return;\n    }\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && this.throwOnSyntheticProps && checkNoSyntheticProp(name, \"property\");\n    el[name] = value;\n  }\n  setValue(node, value) {\n    node.nodeValue = value;\n  }\n  listen(target, event, callback, options) {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && this.throwOnSyntheticProps && checkNoSyntheticProp(event, \"listener\");\n    if (typeof target === \"string\") {\n      target = getDOM().getGlobalEventTarget(this.doc, target);\n      if (!target) {\n        throw new RuntimeError(5102, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Unsupported event target ${target} for event ${event}`);\n      }\n    }\n    let wrappedCallback = this.decoratePreventDefault(callback);\n    if (this.tracingService?.wrapEventListener) {\n      wrappedCallback = this.tracingService.wrapEventListener(target, event, wrappedCallback);\n    }\n    return this.eventManager.addEventListener(target, event, wrappedCallback, options);\n  }\n  decoratePreventDefault(eventHandler) {\n    return (event) => {\n      if (event === \"__ngUnwrap__\") {\n        return eventHandler;\n      }\n      const allowDefaultBehavior = false ? this.ngZone.runGuarded(() => eventHandler(event)) : eventHandler(event);\n      if (allowDefaultBehavior === false) {\n        event.preventDefault();\n      }\n      return void 0;\n    };\n  }\n};\nvar AT_CHARCODE = (() => \"@\".charCodeAt(0))();\nfunction checkNoSyntheticProp(name, nameKind) {\n  if (name.charCodeAt(0) === AT_CHARCODE) {\n    throw new RuntimeError(5105, `Unexpected synthetic ${nameKind} ${name} found. Please make sure that:\n  - Make sure \\`provideAnimationsAsync()\\`, \\`provideAnimations()\\` or \\`provideNoopAnimations()\\` call was added to a list of providers used to bootstrap an application.\n  - There is a corresponding animation configuration named \\`${name}\\` defined in the \\`animations\\` field of the \\`@Component\\` decorator (see https://angular.dev/api/core/Component#animations).`);\n  }\n}\nfunction isTemplateNode(node) {\n  return node.tagName === \"TEMPLATE\" && node.content !== void 0;\n}\nvar ShadowDomRenderer = class extends DefaultDomRenderer2 {\n  hostEl;\n  sharedStylesHost;\n  shadowRoot;\n  constructor(eventManager, hostEl, component, doc, ngZone, nonce, tracingService, sharedStylesHost) {\n    super(eventManager, doc, ngZone, tracingService);\n    this.hostEl = hostEl;\n    this.sharedStylesHost = sharedStylesHost;\n    this.shadowRoot = hostEl.attachShadow({\n      mode: \"open\"\n    });\n    if (this.sharedStylesHost) {\n      this.sharedStylesHost.addHost(this.shadowRoot);\n    }\n    let styles = component.styles;\n    if (ngDevMode) {\n      const baseHref = getDOM().getBaseHref(doc) ?? \"\";\n      styles = addBaseHrefToCssSourceMap(baseHref, styles);\n    }\n    styles = shimStylesContent(component.id, styles);\n    for (const style of styles) {\n      const styleEl = document.createElement(\"style\");\n      if (nonce) {\n        styleEl.setAttribute(\"nonce\", nonce);\n      }\n      styleEl.textContent = style;\n      this.shadowRoot.appendChild(styleEl);\n    }\n    const styleUrls = component.getExternalStyles?.();\n    if (styleUrls) {\n      for (const styleUrl of styleUrls) {\n        const linkEl = createLinkElement(styleUrl, doc);\n        if (nonce) {\n          linkEl.setAttribute(\"nonce\", nonce);\n        }\n        this.shadowRoot.appendChild(linkEl);\n      }\n    }\n  }\n  nodeOrShadowRoot(node) {\n    return node === this.hostEl ? this.shadowRoot : node;\n  }\n  appendChild(parent, newChild) {\n    return super.appendChild(this.nodeOrShadowRoot(parent), newChild);\n  }\n  insertBefore(parent, newChild, refChild) {\n    return super.insertBefore(this.nodeOrShadowRoot(parent), newChild, refChild);\n  }\n  removeChild(_parent, oldChild) {\n    return super.removeChild(null, oldChild);\n  }\n  parentNode(node) {\n    return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(node)));\n  }\n  destroy() {\n    if (this.sharedStylesHost) {\n      this.sharedStylesHost.removeHost(this.shadowRoot);\n    }\n  }\n};\nvar NoneEncapsulationDomRenderer = class extends DefaultDomRenderer2 {\n  sharedStylesHost;\n  removeStylesOnCompDestroy;\n  styles;\n  styleUrls;\n  constructor(eventManager, sharedStylesHost, component, removeStylesOnCompDestroy, doc, ngZone, tracingService, compId) {\n    super(eventManager, doc, ngZone, tracingService);\n    this.sharedStylesHost = sharedStylesHost;\n    this.removeStylesOnCompDestroy = removeStylesOnCompDestroy;\n    let styles = component.styles;\n    if (ngDevMode) {\n      const baseHref = getDOM().getBaseHref(doc) ?? \"\";\n      styles = addBaseHrefToCssSourceMap(baseHref, styles);\n    }\n    this.styles = compId ? shimStylesContent(compId, styles) : styles;\n    this.styleUrls = component.getExternalStyles?.(compId);\n  }\n  applyStyles() {\n    this.sharedStylesHost.addStyles(this.styles, this.styleUrls);\n  }\n  destroy() {\n    if (!this.removeStylesOnCompDestroy) {\n      return;\n    }\n    if (allLeavingAnimations.size === 0) {\n      this.sharedStylesHost.removeStyles(this.styles, this.styleUrls);\n    }\n  }\n};\nvar EmulatedEncapsulationDomRenderer2 = class extends NoneEncapsulationDomRenderer {\n  contentAttr;\n  hostAttr;\n  constructor(eventManager, sharedStylesHost, component, appId, removeStylesOnCompDestroy, doc, ngZone, tracingService) {\n    const compId = appId + \"-\" + component.id;\n    super(eventManager, sharedStylesHost, component, removeStylesOnCompDestroy, doc, ngZone, tracingService, compId);\n    this.contentAttr = shimContentAttribute(compId);\n    this.hostAttr = shimHostAttribute(compId);\n  }\n  applyToHost(element) {\n    this.applyStyles();\n    this.setAttribute(element, this.hostAttr, \"\");\n  }\n  createElement(parent, name) {\n    const el = super.createElement(parent, name);\n    super.setAttribute(el, this.contentAttr, \"\");\n    return el;\n  }\n};\n\n// node_modules/@angular/platform-browser/fesm2022/_browser-chunk.mjs\nvar BrowserDomAdapter = class _BrowserDomAdapter extends DomAdapter {\n  supportsDOMEvents = true;\n  static makeCurrent() {\n    setRootDomAdapter(new _BrowserDomAdapter());\n  }\n  onAndCancel(el, evt, listener, options) {\n    el.addEventListener(evt, listener, options);\n    return () => {\n      el.removeEventListener(evt, listener, options);\n    };\n  }\n  dispatchEvent(el, evt) {\n    el.dispatchEvent(evt);\n  }\n  remove(node) {\n    node.remove();\n  }\n  createElement(tagName, doc) {\n    doc = doc || this.getDefaultDocument();\n    return doc.createElement(tagName);\n  }\n  createHtmlDocument() {\n    return document.implementation.createHTMLDocument(\"fakeTitle\");\n  }\n  getDefaultDocument() {\n    return document;\n  }\n  isElementNode(node) {\n    return node.nodeType === Node.ELEMENT_NODE;\n  }\n  isShadowRoot(node) {\n    return node instanceof DocumentFragment;\n  }\n  getGlobalEventTarget(doc, target) {\n    if (target === \"window\") {\n      return window;\n    }\n    if (target === \"document\") {\n      return doc;\n    }\n    if (target === \"body\") {\n      return doc.body;\n    }\n    return null;\n  }\n  getBaseHref(doc) {\n    const href = getBaseElementHref();\n    return href == null ? null : relativePath(href);\n  }\n  resetBaseElement() {\n    baseElement = null;\n  }\n  getUserAgent() {\n    return window.navigator.userAgent;\n  }\n  getCookie(name) {\n    return parseCookieValue(document.cookie, name);\n  }\n};\nvar baseElement = null;\nfunction getBaseElementHref() {\n  baseElement = baseElement || document.head.querySelector(\"base\");\n  return baseElement ? baseElement.getAttribute(\"href\") : null;\n}\nfunction relativePath(url) {\n  return new URL(url, document.baseURI).pathname;\n}\nvar BrowserGetTestability = class {\n  addToWindow(registry) {\n    _global[\"getAngularTestability\"] = (elem, findInAncestors = true) => {\n      const testability = registry.findTestabilityInTree(elem, findInAncestors);\n      if (testability == null) {\n        throw new RuntimeError(5103, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"Could not find testability for element.\");\n      }\n      return testability;\n    };\n    _global[\"getAllAngularTestabilities\"] = () => registry.getAllTestabilities();\n    _global[\"getAllAngularRootElements\"] = () => registry.getAllRootElements();\n    const whenAllStable = (callback) => {\n      const testabilities = _global[\"getAllAngularTestabilities\"]();\n      let count = testabilities.length;\n      const decrement = function() {\n        count--;\n        if (count == 0) {\n          callback();\n        }\n      };\n      testabilities.forEach((testability) => {\n        testability.whenStable(decrement);\n      });\n    };\n    if (!_global[\"frameworkStabilizers\"]) {\n      _global[\"frameworkStabilizers\"] = [];\n    }\n    _global[\"frameworkStabilizers\"].push(whenAllStable);\n  }\n  findTestabilityInTree(registry, elem, findInAncestors) {\n    if (elem == null) {\n      return null;\n    }\n    const t = registry.getTestability(elem);\n    if (t != null) {\n      return t;\n    } else if (!findInAncestors) {\n      return null;\n    }\n    if (getDOM().isShadowRoot(elem)) {\n      return this.findTestabilityInTree(registry, elem.host, true);\n    }\n    return this.findTestabilityInTree(registry, elem.parentElement, true);\n  }\n};\nvar BrowserXhr = class _BrowserXhr {\n  build() {\n    return new XMLHttpRequest();\n  }\n  static fac = function BrowserXhr_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _BrowserXhr)();\n  };\n  static prov = defineInjectable({\n    token: _BrowserXhr,\n    factory: _BrowserXhr.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(BrowserXhr, [{\n    type: Injectable\n  }], null, null);\n})();\nvar MODIFIER_KEYS = [\"alt\", \"control\", \"meta\", \"shift\"];\nvar _keyMap = {\n  \"\\b\": \"Backspace\",\n  \"\t\": \"Tab\",\n  \"\": \"Delete\",\n  \"\\x1B\": \"Escape\",\n  \"Del\": \"Delete\",\n  \"Esc\": \"Escape\",\n  \"Left\": \"ArrowLeft\",\n  \"Right\": \"ArrowRight\",\n  \"Up\": \"ArrowUp\",\n  \"Down\": \"ArrowDown\",\n  \"Menu\": \"ContextMenu\",\n  \"Scroll\": \"ScrollLock\",\n  \"Win\": \"OS\"\n};\nvar MODIFIER_KEY_GETTERS = {\n  \"alt\": (event) => event.altKey,\n  \"control\": (event) => event.ctrlKey,\n  \"meta\": (event) => event.metaKey,\n  \"shift\": (event) => event.shiftKey\n};\nvar KeyEventsPlugin = class _KeyEventsPlugin extends EventManagerPlugin {\n  constructor(doc) {\n    super(doc);\n  }\n  supports(eventName) {\n    return _KeyEventsPlugin.parseEventName(eventName) != null;\n  }\n  addEventListener(element, eventName, handler, options) {\n    const parsedEvent = _KeyEventsPlugin.parseEventName(eventName);\n    const outsideHandler = _KeyEventsPlugin.eventCallback(parsedEvent[\"fullKey\"], handler, this.manager.getZone());\n    return this.manager.getZone().runOutsideAngular(() => {\n      return getDOM().onAndCancel(element, parsedEvent[\"domEventName\"], outsideHandler, options);\n    });\n  }\n  static parseEventName(eventName) {\n    const parts = eventName.toLowerCase().split(\".\");\n    const domEventName = parts.shift();\n    if (parts.length === 0 || !(domEventName === \"keydown\" || domEventName === \"keyup\")) {\n      return null;\n    }\n    const key = _KeyEventsPlugin._normalizeKey(parts.pop());\n    let fullKey = \"\";\n    let codeIX = parts.indexOf(\"code\");\n    if (codeIX > -1) {\n      parts.splice(codeIX, 1);\n      fullKey = \"code.\";\n    }\n    MODIFIER_KEYS.forEach((modifierName) => {\n      const index = parts.indexOf(modifierName);\n      if (index > -1) {\n        parts.splice(index, 1);\n        fullKey += modifierName + \".\";\n      }\n    });\n    fullKey += key;\n    if (parts.length != 0 || key.length === 0) {\n      return null;\n    }\n    const result = {};\n    result[\"domEventName\"] = domEventName;\n    result[\"fullKey\"] = fullKey;\n    return result;\n  }\n  static matchEventFullKeyCode(event, fullKeyCode) {\n    let keycode = _keyMap[event.key] || event.key;\n    let key = \"\";\n    if (fullKeyCode.indexOf(\"code.\") > -1) {\n      keycode = event.code;\n      key = \"code.\";\n    }\n    if (keycode == null || !keycode) return false;\n    keycode = keycode.toLowerCase();\n    if (keycode === \" \") {\n      keycode = \"space\";\n    } else if (keycode === \".\") {\n      keycode = \"dot\";\n    }\n    MODIFIER_KEYS.forEach((modifierName) => {\n      if (modifierName !== keycode) {\n        const modifierGetter = MODIFIER_KEY_GETTERS[modifierName];\n        if (modifierGetter(event)) {\n          key += modifierName + \".\";\n        }\n      }\n    });\n    key += keycode;\n    return key === fullKeyCode;\n  }\n  static eventCallback(fullKey, handler, zone) {\n    return (event) => {\n      if (_KeyEventsPlugin.matchEventFullKeyCode(event, fullKey)) {\n        zone.runGuarded(() => handler(event));\n      }\n    };\n  }\n  static _normalizeKey(keyName) {\n    return keyName === \"esc\" ? \"escape\" : keyName;\n  }\n  static fac = function KeyEventsPlugin_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _KeyEventsPlugin)(inject(DOCUMENT));\n  };\n  static prov = defineInjectable({\n    token: _KeyEventsPlugin,\n    factory: _KeyEventsPlugin.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(KeyEventsPlugin, [{\n    type: Injectable\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }], null);\n})();\nasync function bootstrapApplication(rootComponent, options, context) {\n  const config = __spreadValues({\n    rootComponent\n  }, createProvidersConfig(options, context));\n  if (false) {\n    await resolveJitResources();\n  }\n  return internalCreateApplication(config);\n}\nasync function createApplication(options, context) {\n  if (false) {\n    await resolveJitResources();\n  }\n  return internalCreateApplication(createProvidersConfig(options, context));\n}\nfunction createProvidersConfig(options, context) {\n  return {\n    platformRef: context?.platformRef,\n    appProviders: [...BROWSER_MODULE_PROVIDERS, ...options?.providers ?? []],\n    platformProviders: INTERNAL_BROWSER_PLATFORM_PROVIDERS\n  };\n}\nfunction provideProtractorTestingSupport() {\n  return [...TESTABILITY_PROVIDERS];\n}\nfunction initDomAdapter() {\n  BrowserDomAdapter.makeCurrent();\n}\nfunction errorHandler() {\n  return new ErrorHandler();\n}\nfunction _document() {\n  setDocument(document);\n  return document;\n}\nvar INTERNAL_BROWSER_PLATFORM_PROVIDERS = [{\n  provide: PLATFORM_ID,\n  useValue: PLATFORM_BROWSER_ID\n}, {\n  provide: PLATFORM_INITIALIZER,\n  useValue: initDomAdapter,\n  multi: true\n}, {\n  provide: DOCUMENT,\n  useFactory: _document\n}];\nvar platformBrowser = createPlatformFactory(platformCore, \"browser\", INTERNAL_BROWSER_PLATFORM_PROVIDERS);\nvar BROWSER_MODULE_PROVIDERS_MARKER = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"BrowserModule Providers Marker\" : \"\");\nvar TESTABILITY_PROVIDERS = [{\n  provide: TESTABILITY_GETTER,\n  useClass: BrowserGetTestability\n}, {\n  provide: TESTABILITY,\n  useClass: Testability\n}, {\n  provide: Testability,\n  useClass: Testability\n}];\nvar BROWSER_MODULE_PROVIDERS = [{\n  provide: INJECTOR_SCOPE,\n  useValue: \"root\"\n}, {\n  provide: ErrorHandler,\n  useFactory: errorHandler\n}, {\n  provide: EVENT_MANAGER_PLUGINS,\n  useClass: DomEventsPlugin,\n  multi: true\n}, {\n  provide: EVENT_MANAGER_PLUGINS,\n  useClass: KeyEventsPlugin,\n  multi: true\n}, DomRendererFactory2, SharedStylesHost, EventManager, {\n  provide: RendererFactory2,\n  useExisting: DomRendererFactory2\n}, {\n  provide: XhrFactory,\n  useClass: BrowserXhr\n}, typeof ngDevMode === \"undefined\" || ngDevMode ? {\n  provide: BROWSER_MODULE_PROVIDERS_MARKER,\n  useValue: true\n} : []];\nvar BrowserModule = class _BrowserModule {\n  constructor() {\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      const providersAlreadyPresent = inject(BROWSER_MODULE_PROVIDERS_MARKER, {\n        optional: true,\n        skipSelf: true\n      });\n      if (providersAlreadyPresent) {\n        throw new RuntimeError(5100, `Providers from the \\`BrowserModule\\` have already been loaded. If you need access to common directives such as NgIf and NgFor, import the \\`CommonModule\\` instead.`);\n      }\n    }\n  }\n  static fac = function BrowserModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _BrowserModule)();\n  };\n  static mod = defineNgModule({\n    type: _BrowserModule,\n    exports: [CommonModule, ApplicationModule]\n  });\n  static inj = defineInjector({\n    providers: [...BROWSER_MODULE_PROVIDERS, ...TESTABILITY_PROVIDERS],\n    imports: [CommonModule, ApplicationModule]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(BrowserModule, [{\n    type: NgModule,\n    args: [{\n      providers: [...BROWSER_MODULE_PROVIDERS, ...TESTABILITY_PROVIDERS],\n      exports: [CommonModule, ApplicationModule]\n    }]\n  }], () => [], null);\n})();\n\n// node_modules/@angular/platform-browser/fesm2022/platform-browser.mjs\nvar Meta = class _Meta {\n  _doc;\n  _dom;\n  constructor(_doc) {\n    this._doc = _doc;\n    this._dom = getDOM();\n  }\n  addTag(tag, forceCreation = false) {\n    if (!tag) return null;\n    return this._getOrCreateElement(tag, forceCreation);\n  }\n  addTags(tags, forceCreation = false) {\n    if (!tags) return [];\n    return tags.reduce((result, tag) => {\n      if (tag) {\n        result.push(this._getOrCreateElement(tag, forceCreation));\n      }\n      return result;\n    }, []);\n  }\n  getTag(attrSelector) {\n    if (!attrSelector) return null;\n    return this._doc.querySelector(`meta[${attrSelector}]`) || null;\n  }\n  getTags(attrSelector) {\n    if (!attrSelector) return [];\n    const list = this._doc.querySelectorAll(`meta[${attrSelector}]`);\n    return list ? [].slice.call(list) : [];\n  }\n  updateTag(tag, selector) {\n    if (!tag) return null;\n    selector = selector || this._parseSelector(tag);\n    const meta = this.getTag(selector);\n    if (meta) {\n      return this._setMetaElementAttributes(tag, meta);\n    }\n    return this._getOrCreateElement(tag, true);\n  }\n  removeTag(attrSelector) {\n    this.removeTagElement(this.getTag(attrSelector));\n  }\n  removeTagElement(meta) {\n    if (meta) {\n      this._dom.remove(meta);\n    }\n  }\n  _getOrCreateElement(meta, forceCreation = false) {\n    if (!forceCreation) {\n      const selector = this._parseSelector(meta);\n      const elem = this.getTags(selector).filter((elem2) => this._containsAttributes(meta, elem2))[0];\n      if (elem !== void 0) return elem;\n    }\n    const element = this._dom.createElement(\"meta\");\n    this._setMetaElementAttributes(meta, element);\n    const head = this._doc.getElementsByTagName(\"head\")[0];\n    head.appendChild(element);\n    return element;\n  }\n  _setMetaElementAttributes(tag, el) {\n    Object.keys(tag).forEach((prop) => el.setAttribute(this._getMetaKeyMap(prop), tag[prop]));\n    return el;\n  }\n  _parseSelector(tag) {\n    const attr = tag.name ? \"name\" : \"property\";\n    return `${attr}=\"${tag[attr]}\"`;\n  }\n  _containsAttributes(tag, elem) {\n    return Object.keys(tag).every((key) => elem.getAttribute(this._getMetaKeyMap(key)) === tag[key]);\n  }\n  _getMetaKeyMap(prop) {\n    return META_KEYS_MAP[prop] || prop;\n  }\n  static fac = function Meta_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _Meta)(inject(DOCUMENT));\n  };\n  static prov = defineInjectable({\n    token: _Meta,\n    factory: _Meta.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(Meta, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }], null);\n})();\nvar META_KEYS_MAP = {\n  httpEquiv: \"http-equiv\"\n};\nvar Title = class _Title {\n  _doc;\n  constructor(_doc) {\n    this._doc = _doc;\n  }\n  getTitle() {\n    return this._doc.title;\n  }\n  setTitle(newTitle) {\n    this._doc.title = newTitle || \"\";\n  }\n  static fac = function Title_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _Title)(inject(DOCUMENT));\n  };\n  static prov = defineInjectable({\n    token: _Title,\n    factory: _Title.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(Title, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }], null);\n})();\nfunction exportNgVar(name, value) {\n  if (typeof COMPILED === \"undefined\" || !COMPILED) {\n    const ng = _global[\"ng\"] = _global[\"ng\"] || {};\n    ng[name] = value;\n  }\n}\nvar ChangeDetectionPerfRecord = class {\n  msPerTick;\n  numTicks;\n  constructor(msPerTick, numTicks) {\n    this.msPerTick = msPerTick;\n    this.numTicks = numTicks;\n  }\n};\nvar AngularProfiler = class {\n  appRef;\n  constructor(ref) {\n    this.appRef = ref.injector.get(ApplicationRef);\n  }\n  timeChangeDetection(config) {\n    const record = config && config[\"record\"];\n    const profileName = \"Change Detection\";\n    if (record && \"profile\" in console && typeof console.profile === \"function\") {\n      console.profile(profileName);\n    }\n    const start = performance.now();\n    let numTicks = 0;\n    while (numTicks < 5 || performance.now() - start < 500) {\n      this.appRef.tick();\n      numTicks++;\n    }\n    const end = performance.now();\n    if (record && \"profileEnd\" in console && typeof console.profileEnd === \"function\") {\n      console.profileEnd(profileName);\n    }\n    const msPerTick = (end - start) / numTicks;\n    console.log(`ran ${numTicks} change detection cycles`);\n    console.log(`${msPerTick.toFixed(2)} ms per check`);\n    return new ChangeDetectionPerfRecord(msPerTick, numTicks);\n  }\n};\nvar PROFILER_GLOBAL_NAME = \"profiler\";\nfunction enableDebugTools(ref) {\n  exportNgVar(PROFILER_GLOBAL_NAME, new AngularProfiler(ref));\n  return ref;\n}\nfunction disableDebugTools() {\n  exportNgVar(PROFILER_GLOBAL_NAME, null);\n}\nvar By = class {\n  static all() {\n    return () => true;\n  }\n  static css(selector) {\n    return (debugElement) => {\n      return debugElement.nativeElement != null ? elementMatches(debugElement.nativeElement, selector) : false;\n    };\n  }\n  static directive(type) {\n    return (debugNode) => debugNode.providerTokens.indexOf(type) !== -1;\n  }\n};\nfunction elementMatches(n, selector) {\n  if (getDOM().isElementNode(n)) {\n    return n.matches && n.matches(selector) || n.msMatchesSelector && n.msMatchesSelector(selector) || n.webkitMatchesSelector && n.webkitMatchesSelector(selector);\n  }\n  return false;\n}\nvar EVENT_NAMES = {\n  \"pan\": true,\n  \"panstart\": true,\n  \"panmove\": true,\n  \"panend\": true,\n  \"pancancel\": true,\n  \"panleft\": true,\n  \"panright\": true,\n  \"panup\": true,\n  \"pandown\": true,\n  \"pinch\": true,\n  \"pinchstart\": true,\n  \"pinchmove\": true,\n  \"pinchend\": true,\n  \"pinchcancel\": true,\n  \"pinchin\": true,\n  \"pinchout\": true,\n  \"press\": true,\n  \"pressup\": true,\n  \"rotate\": true,\n  \"rotatestart\": true,\n  \"rotatemove\": true,\n  \"rotateend\": true,\n  \"rotatecancel\": true,\n  \"swipe\": true,\n  \"swipeleft\": true,\n  \"swiperight\": true,\n  \"swipeup\": true,\n  \"swipedown\": true,\n  \"tap\": true,\n  \"doubletap\": true\n};\nvar HAMMER_GESTURE_CONFIG = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"HammerGestureConfig\" : \"\");\nvar HAMMER_LOADER = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"HammerLoader\" : \"\");\nvar HammerGestureConfig = class _HammerGestureConfig {\n  events = [];\n  overrides = {};\n  options;\n  buildHammer(element) {\n    const mc = new Hammer(element, this.options);\n    mc.get(\"pinch\").set({\n      enable: true\n    });\n    mc.get(\"rotate\").set({\n      enable: true\n    });\n    for (const eventName in this.overrides) {\n      mc.get(eventName).set(this.overrides[eventName]);\n    }\n    return mc;\n  }\n  static fac = function HammerGestureConfig_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HammerGestureConfig)();\n  };\n  static prov = defineInjectable({\n    token: _HammerGestureConfig,\n    factory: _HammerGestureConfig.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HammerGestureConfig, [{\n    type: Injectable\n  }], null, null);\n})();\nvar HammerGesturesPlugin = class _HammerGesturesPlugin extends EventManagerPlugin {\n  _config;\n  _injector;\n  loader;\n  _loaderPromise = null;\n  constructor(doc, _config, _injector, loader) {\n    super(doc);\n    this._config = _config;\n    this._injector = _injector;\n    this.loader = loader;\n  }\n  supports(eventName) {\n    if (!EVENT_NAMES.hasOwnProperty(eventName.toLowerCase()) && !this.isCustomEvent(eventName)) {\n      return false;\n    }\n    if (!window.Hammer && !this.loader) {\n      if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n        const _console = this._injector.get(Console);\n        _console.warn(`The \"${eventName}\" event cannot be bound because Hammer.JS is not loaded and no custom loader has been specified.`);\n      }\n      return false;\n    }\n    return true;\n  }\n  addEventListener(element, eventName, handler) {\n    const zone = this.manager.getZone();\n    eventName = eventName.toLowerCase();\n    if (!window.Hammer && this.loader) {\n      this._loaderPromise = this._loaderPromise || zone.runOutsideAngular(() => this.loader());\n      let cancelRegistration = false;\n      let deregister = () => {\n        cancelRegistration = true;\n      };\n      zone.runOutsideAngular(() => this._loaderPromise.then(() => {\n        if (!window.Hammer) {\n          if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n            const _console = this._injector.get(Console);\n            _console.warn(`The custom HAMMER_LOADER completed, but Hammer.JS is not present.`);\n          }\n          deregister = () => {\n          };\n          return;\n        }\n        if (!cancelRegistration) {\n          deregister = this.addEventListener(element, eventName, handler);\n        }\n      }).catch(() => {\n        if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n          const _console = this._injector.get(Console);\n          _console.warn(`The \"${eventName}\" event cannot be bound because the custom Hammer.JS loader failed.`);\n        }\n        deregister = () => {\n        };\n      }));\n      return () => {\n        deregister();\n      };\n    }\n    return zone.runOutsideAngular(() => {\n      const mc = this._config.buildHammer(element);\n      const callback = function(eventObj) {\n        zone.runGuarded(function() {\n          handler(eventObj);\n        });\n      };\n      mc.on(eventName, callback);\n      return () => {\n        mc.off(eventName, callback);\n        if (typeof mc.destroy === \"function\") {\n          mc.destroy();\n        }\n      };\n    });\n  }\n  isCustomEvent(eventName) {\n    return this._config.events.indexOf(eventName) > -1;\n  }\n  static fac = function HammerGesturesPlugin_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HammerGesturesPlugin)(inject(DOCUMENT), inject(HAMMER_GESTURE_CONFIG), inject(Injector), inject(HAMMER_LOADER, 8));\n  };\n  static prov = defineInjectable({\n    token: _HammerGesturesPlugin,\n    factory: _HammerGesturesPlugin.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HammerGesturesPlugin, [{\n    type: Injectable\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }, {\n    type: HammerGestureConfig,\n    decorators: [{\n      type: Inject,\n      args: [HAMMER_GESTURE_CONFIG]\n    }]\n  }, {\n    type: Injector\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Optional\n    }, {\n      type: Inject,\n      args: [HAMMER_LOADER]\n    }]\n  }], null);\n})();\nvar HammerModule = class _HammerModule {\n  static fac = function HammerModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HammerModule)();\n  };\n  static mod = defineNgModule({\n    type: _HammerModule\n  });\n  static inj = defineInjector({\n    providers: [{\n      provide: EVENT_MANAGER_PLUGINS,\n      useClass: HammerGesturesPlugin,\n      multi: true,\n      deps: [DOCUMENT, HAMMER_GESTURE_CONFIG, Injector, [new Optional(), HAMMER_LOADER]]\n    }, {\n      provide: HAMMER_GESTURE_CONFIG,\n      useClass: HammerGestureConfig\n    }]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HammerModule, [{\n    type: NgModule,\n    args: [{\n      providers: [{\n        provide: EVENT_MANAGER_PLUGINS,\n        useClass: HammerGesturesPlugin,\n        multi: true,\n        deps: [DOCUMENT, HAMMER_GESTURE_CONFIG, Injector, [new Optional(), HAMMER_LOADER]]\n      }, {\n        provide: HAMMER_GESTURE_CONFIG,\n        useClass: HammerGestureConfig\n      }]\n    }]\n  }], null, null);\n})();\nvar DomSanitizer = class _DomSanitizer {\n  static fac = function DomSanitizer_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DomSanitizer)();\n  };\n  static prov = defineInjectable({\n    token: _DomSanitizer,\n    factory: function DomSanitizer_Factory(__ngFactoryType__) {\n      let __ngConditionalFactory__ = null;\n      if (__ngFactoryType__) {\n        __ngConditionalFactory__ = new (__ngFactoryType__ || _DomSanitizer)();\n      } else {\n        __ngConditionalFactory__ = inject(DomSanitizerImpl);\n      }\n      return __ngConditionalFactory__;\n    },\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DomSanitizer, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useExisting: forwardRef(() => DomSanitizerImpl)\n    }]\n  }], null, null);\n})();\nvar DomSanitizerImpl = class _DomSanitizerImpl extends DomSanitizer {\n  _doc;\n  constructor(_doc) {\n    super();\n    this._doc = _doc;\n  }\n  sanitize(ctx, value) {\n    if (value == null) return null;\n    switch (ctx) {\n      case SecurityContext.NONE:\n        return value;\n      case SecurityContext.HTML:\n        if (allowSanitizationBypassAndThrow(value, \"HTML\")) {\n          return unwrapSafeValue(value);\n        }\n        return _sanitizeHtml(this._doc, String(value)).toString();\n      case SecurityContext.STYLE:\n        if (allowSanitizationBypassAndThrow(value, \"Style\")) {\n          return unwrapSafeValue(value);\n        }\n        return value;\n      case SecurityContext.SCRIPT:\n        if (allowSanitizationBypassAndThrow(value, \"Script\")) {\n          return unwrapSafeValue(value);\n        }\n        throw new RuntimeError(5200, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"unsafe value used in a script context\");\n      case SecurityContext.URL:\n        if (allowSanitizationBypassAndThrow(value, \"URL\")) {\n          return unwrapSafeValue(value);\n        }\n        return _sanitizeUrl(String(value));\n      case SecurityContext.RESOURCE_URL:\n        if (allowSanitizationBypassAndThrow(value, \"ResourceURL\")) {\n          return unwrapSafeValue(value);\n        }\n        throw new RuntimeError(5201, (typeof ngDevMode === \"undefined\" || ngDevMode) && `unsafe value used in a resource URL context (see ${XSS_SECURITY_URL})`);\n      default:\n        throw new RuntimeError(5202, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Unexpected SecurityContext ${ctx} (see ${XSS_SECURITY_URL})`);\n    }\n  }\n  bypassSecurityTrustHtml(value) {\n    return bypassSanitizationTrustHtml(value);\n  }\n  bypassSecurityTrustStyle(value) {\n    return bypassSanitizationTrustStyle(value);\n  }\n  bypassSecurityTrustScript(value) {\n    return bypassSanitizationTrustScript(value);\n  }\n  bypassSecurityTrustUrl(value) {\n    return bypassSanitizationTrustUrl(value);\n  }\n  bypassSecurityTrustResourceUrl(value) {\n    return bypassSanitizationTrustResourceUrl(value);\n  }\n  static fac = function DomSanitizerImpl_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DomSanitizerImpl)(inject(DOCUMENT));\n  };\n  static prov = defineInjectable({\n    token: _DomSanitizerImpl,\n    factory: _DomSanitizerImpl.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DomSanitizerImpl, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }], null);\n})();\nvar HydrationFeatureKind;\n(function(HydrationFeatureKind2) {\n  HydrationFeatureKind2[HydrationFeatureKind2[\"NoHttpTransferCache\"] = 0] = \"NoHttpTransferCache\";\n  HydrationFeatureKind2[HydrationFeatureKind2[\"HttpTransferCacheOptions\"] = 1] = \"HttpTransferCacheOptions\";\n  HydrationFeatureKind2[HydrationFeatureKind2[\"I18nSupport\"] = 2] = \"I18nSupport\";\n  HydrationFeatureKind2[HydrationFeatureKind2[\"EventReplay\"] = 3] = \"EventReplay\";\n  HydrationFeatureKind2[HydrationFeatureKind2[\"IncrementalHydration\"] = 4] = \"IncrementalHydration\";\n})(HydrationFeatureKind || (HydrationFeatureKind = {}));\nfunction hydrationFeature(kind, providers = [], options = {}) {\n  return {\n    kind,\n    providers\n  };\n}\nfunction withNoHttpTransferCache() {\n  return hydrationFeature(HydrationFeatureKind.NoHttpTransferCache);\n}\nfunction withHttpTransferCacheOptions(options) {\n  return hydrationFeature(HydrationFeatureKind.HttpTransferCacheOptions, withHttpTransferCache(options));\n}\nfunction withI18nSupport2() {\n  return hydrationFeature(HydrationFeatureKind.I18nSupport, withI18nSupport());\n}\nfunction withEventReplay2() {\n  return hydrationFeature(HydrationFeatureKind.EventReplay, withEventReplay());\n}\nfunction withIncrementalHydration2() {\n  return hydrationFeature(HydrationFeatureKind.IncrementalHydration, withIncrementalHydration());\n}\nfunction provideEnabledBlockingInitialNavigationDetector() {\n  return [{\n    provide: ENVIRONMENT_INITIALIZER,\n    useValue: () => {\n      const isEnabledBlockingInitialNavigation = inject(IS_ENABLED_BLOCKING_INITIAL_NAVIGATION, {\n        optional: true\n      });\n      if (isEnabledBlockingInitialNavigation) {\n        const console2 = inject(Console);\n        const message = formatRuntimeError(5001, \"Configuration error: found both hydration and enabledBlocking initial navigation in the same application, which is a contradiction.\");\n        console2.warn(message);\n      }\n    },\n    multi: true\n  }];\n}\nfunction provideClientHydration(...features) {\n  const providers = [];\n  const featuresKind = /* @__PURE__ */ new Set();\n  for (const {\n    providers,\n    kind\n  } of features) {\n    featuresKind.add(kind);\n    if (providers.length) {\n      providers.push(providers);\n    }\n  }\n  const hasHttpTransferCacheOptions = featuresKind.has(HydrationFeatureKind.HttpTransferCacheOptions);\n  if (typeof ngDevMode !== \"undefined\" && ngDevMode && featuresKind.has(HydrationFeatureKind.NoHttpTransferCache) && hasHttpTransferCacheOptions) {\n    throw new RuntimeError(5001, \"Configuration error: found both withHttpTransferCacheOptions() and withNoHttpTransferCache() in the same call to provideClientHydration(), which is a contradiction.\");\n  }\n  return makeEnvironmentProviders([typeof ngDevMode !== \"undefined\" && ngDevMode ? provideEnabledBlockingInitialNavigationDetector() : [], typeof ngDevMode !== \"undefined\" && ngDevMode ? provideStabilityDebugging() : [], withDomHydration(), featuresKind.has(HydrationFeatureKind.NoHttpTransferCache) || hasHttpTransferCacheOptions ? [] : withHttpTransferCache({}), providers]);\n}\nvar VERSION = new Version(\"21.1.3\");\n\nexport {\n  EventManagerPlugin,\n  DomEventsPlugin,\n  EVENT_MANAGER_PLUGINS,\n  EventManager,\n  SharedStylesHost,\n  REMOVE_STYLES_ON_COMPONENT_DESTROY,\n  DomRendererFactory2,\n  BrowserDomAdapter,\n  BrowserGetTestability,\n  KeyEventsPlugin,\n  bootstrapApplication,\n  createApplication,\n  provideProtractorTestingSupport,\n  platformBrowser,\n  BrowserModule,\n  Meta,\n  Title,\n  enableDebugTools,\n  disableDebugTools,\n  By,\n  HAMMER_GESTURE_CONFIG,\n  HAMMER_LOADER,\n  HammerGestureConfig,\n  HammerGesturesPlugin,\n  HammerModule,\n  DomSanitizer,\n  DomSanitizerImpl,\n  HydrationFeatureKind,\n  withNoHttpTransferCache,\n  withHttpTransferCacheOptions,\n  withI18nSupport2 as withI18nSupport,\n  withEventReplay2 as withEventReplay,\n  withIncrementalHydration2 as withIncrementalHydration,\n  provideClientHydration,\n  VERSION\n};\n//# sourceMappingURL=chunk-SXEFOV7B.js.map\n"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.243Z",
        "time": 7.748999982140958,
        "timings": {
          "blocked": 6.519999981310218,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.24999999682232737,
          "receive": 0.9790000040084124,
          "_blocked_queueing": 6.456999981310219,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b",
          "lineNumber": 37
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-CGVE6HH2.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "160359"
            },
            {
              "name": "Etag",
              "value": "W/\"27267-MW9PUCrWLmP80wNua7oC0N8gN/o\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 160359,
            "mimeType": "text/javascript",
            "text": "import {\n  PlatformLocation\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport {\n  ApplicationRef,\n  Attribute,\n  ChangeDetectorRef,\n  DEFAULT_CURRENCY_CODE,\n  DOCUMENT,\n  DestroyRef,\n  Directive,\n  ElementRef,\n  Host,\n  IMAGE_CONFIG,\n  IMAGE_CONFIG_DEFAULTS,\n  INTERNAL_APPLICATION_ERROR_HANDLER,\n  Inject,\n  Injectable,\n  InjectionToken,\n  Injector,\n  Input,\n  IterableDiffers,\n  KeyValueDiffers,\n  LOCALE_ID,\n  LocaleDataIndex,\n  NgModule,\n  NgModuleRef$1,\n  NgZone,\n  Optional,\n  Pipe,\n  Renderer2,\n  RendererStyleFlags2,\n  RuntimeError,\n  Subject,\n  TemplateRef,\n  Version,\n  ViewContainerRef,\n  __spreadProps,\n  __spreadValues,\n  booleanAttribute,\n  createNgModule,\n  findLocaleData,\n  formatRuntimeError,\n  getLocaleCurrencyCode,\n  getLocalePluralCase,\n  inject,\n  isPromise,\n  isSubscribable,\n  numberAttribute,\n  performanceMarkFeature,\n  registerLocaleData,\n  setClassMetadata,\n  stringify,\n  untracked,\n  unwrapSafeValue,\n  NgOnChangesFeature,\n  defineDirective,\n  defineInjectable,\n  defineInjector,\n  defineNgModule,\n  definePipe,\n  directiveInject,\n  inject,\n  injectAttribute,\n  styleProp\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\n\n// node_modules/@angular/common/fesm2022/_location-chunk.mjs\nfunction joinWithSlash(start, end) {\n  if (!start) return end;\n  if (!end) return start;\n  if (start.endsWith(\"/\")) {\n    return end.startsWith(\"/\") ? start + end.slice(1) : start + end;\n  }\n  return end.startsWith(\"/\") ? start + end : `${start}/${end}`;\n}\nfunction stripTrailingSlash(url) {\n  const pathEndIdx = url.search(/#|\\?|$/);\n  return url[pathEndIdx - 1] === \"/\" ? url.slice(0, pathEndIdx - 1) + url.slice(pathEndIdx) : url;\n}\nfunction normalizeQueryParams(params) {\n  return params && params[0] !== \"?\" ? `?${params}` : params;\n}\nvar LocationStrategy = class _LocationStrategy {\n  historyGo(relativePosition) {\n    throw new Error(ngDevMode ? \"Not implemented\" : \"\");\n  }\n  static fac = function LocationStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _LocationStrategy)();\n  };\n  static prov = defineInjectable({\n    token: _LocationStrategy,\n    factory: () => (() => inject(PathLocationStrategy))(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(LocationStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => inject(PathLocationStrategy)\n    }]\n  }], null, null);\n})();\nvar APP_BASE_HREF = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"appBaseHref\" : \"\");\nvar PathLocationStrategy = class _PathLocationStrategy extends LocationStrategy {\n  _platformLocation;\n  _baseHref;\n  _removeListenerFns = [];\n  constructor(_platformLocation, href) {\n    super();\n    this._platformLocation = _platformLocation;\n    this._baseHref = href ?? this._platformLocation.getBaseHrefFromDOM() ?? inject(DOCUMENT).location?.origin ?? \"\";\n  }\n  ngOnDestroy() {\n    while (this._removeListenerFns.length) {\n      this._removeListenerFns.pop()();\n    }\n  }\n  onPopState(fn) {\n    this._removeListenerFns.push(this._platformLocation.onPopState(fn), this._platformLocation.onHashChange(fn));\n  }\n  getBaseHref() {\n    return this._baseHref;\n  }\n  prepareExternalUrl(internal) {\n    return joinWithSlash(this._baseHref, internal);\n  }\n  path(includeHash = false) {\n    const pathname = this._platformLocation.pathname + normalizeQueryParams(this._platformLocation.search);\n    const hash = this._platformLocation.hash;\n    return hash && includeHash ? `${pathname}${hash}` : pathname;\n  }\n  pushState(state, title, url, queryParams) {\n    const externalUrl = this.prepareExternalUrl(url + normalizeQueryParams(queryParams));\n    this._platformLocation.pushState(state, title, externalUrl);\n  }\n  replaceState(state, title, url, queryParams) {\n    const externalUrl = this.prepareExternalUrl(url + normalizeQueryParams(queryParams));\n    this._platformLocation.replaceState(state, title, externalUrl);\n  }\n  forward() {\n    this._platformLocation.forward();\n  }\n  back() {\n    this._platformLocation.back();\n  }\n  getState() {\n    return this._platformLocation.getState();\n  }\n  historyGo(relativePosition = 0) {\n    this._platformLocation.historyGo?.(relativePosition);\n  }\n  static fac = function PathLocationStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PathLocationStrategy)(inject(PlatformLocation), inject(APP_BASE_HREF, 8));\n  };\n  static prov = defineInjectable({\n    token: _PathLocationStrategy,\n    factory: _PathLocationStrategy.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PathLocationStrategy, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: PlatformLocation\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Optional\n    }, {\n      type: Inject,\n      args: [APP_BASE_HREF]\n    }]\n  }], null);\n})();\nvar Location = class _Location {\n  _subject = new Subject();\n  _basePath;\n  _locationStrategy;\n  _urlChangeListeners = [];\n  _urlChangeSubscription = null;\n  constructor(locationStrategy) {\n    this._locationStrategy = locationStrategy;\n    const baseHref = this._locationStrategy.getBaseHref();\n    this._basePath = _stripOrigin(stripTrailingSlash(_stripIndexHtml(baseHref)));\n    this._locationStrategy.onPopState((ev) => {\n      this._subject.next({\n        \"url\": this.path(true),\n        \"pop\": true,\n        \"state\": ev.state,\n        \"type\": ev.type\n      });\n    });\n  }\n  ngOnDestroy() {\n    this._urlChangeSubscription?.unsubscribe();\n    this._urlChangeListeners = [];\n  }\n  path(includeHash = false) {\n    return this.normalize(this._locationStrategy.path(includeHash));\n  }\n  getState() {\n    return this._locationStrategy.getState();\n  }\n  isCurrentPathEqualTo(path, query = \"\") {\n    return this.path() == this.normalize(path + normalizeQueryParams(query));\n  }\n  normalize(url) {\n    return _Location.stripTrailingSlash(_stripBasePath(this._basePath, _stripIndexHtml(url)));\n  }\n  prepareExternalUrl(url) {\n    if (url && url[0] !== \"/\") {\n      url = \"/\" + url;\n    }\n    return this._locationStrategy.prepareExternalUrl(url);\n  }\n  go(path, query = \"\", state = null) {\n    this._locationStrategy.pushState(state, \"\", path, query);\n    this._notifyUrlChangeListeners(this.prepareExternalUrl(path + normalizeQueryParams(query)), state);\n  }\n  replaceState(path, query = \"\", state = null) {\n    this._locationStrategy.replaceState(state, \"\", path, query);\n    this._notifyUrlChangeListeners(this.prepareExternalUrl(path + normalizeQueryParams(query)), state);\n  }\n  forward() {\n    this._locationStrategy.forward();\n  }\n  back() {\n    this._locationStrategy.back();\n  }\n  historyGo(relativePosition = 0) {\n    this._locationStrategy.historyGo?.(relativePosition);\n  }\n  onUrlChange(fn) {\n    this._urlChangeListeners.push(fn);\n    this._urlChangeSubscription ??= this.subscribe((v) => {\n      this._notifyUrlChangeListeners(v.url, v.state);\n    });\n    return () => {\n      const fnIndex = this._urlChangeListeners.indexOf(fn);\n      this._urlChangeListeners.splice(fnIndex, 1);\n      if (this._urlChangeListeners.length === 0) {\n        this._urlChangeSubscription?.unsubscribe();\n        this._urlChangeSubscription = null;\n      }\n    };\n  }\n  _notifyUrlChangeListeners(url = \"\", state) {\n    this._urlChangeListeners.forEach((fn) => fn(url, state));\n  }\n  subscribe(onNext, onThrow, onReturn) {\n    return this._subject.subscribe({\n      next: onNext,\n      error: onThrow ?? void 0,\n      complete: onReturn ?? void 0\n    });\n  }\n  static normalizeQueryParams = normalizeQueryParams;\n  static joinWithSlash = joinWithSlash;\n  static stripTrailingSlash = stripTrailingSlash;\n  static fac = function Location_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _Location)(inject(LocationStrategy));\n  };\n  static prov = defineInjectable({\n    token: _Location,\n    factory: () => createLocation(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(Location, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: createLocation\n    }]\n  }], () => [{\n    type: LocationStrategy\n  }], null);\n})();\nfunction createLocation() {\n  return new Location(inject(LocationStrategy));\n}\nfunction _stripBasePath(basePath, url) {\n  if (!basePath || !url.startsWith(basePath)) {\n    return url;\n  }\n  const strippedUrl = url.substring(basePath.length);\n  if (strippedUrl === \"\" || [\"/\", \";\", \"?\", \"#\"].includes(strippedUrl[0])) {\n    return strippedUrl;\n  }\n  return url;\n}\nfunction _stripIndexHtml(url) {\n  return url.replace(/\\/index.html$/, \"\");\n}\nfunction _stripOrigin(baseHref) {\n  const isAbsoluteUrl2 = new RegExp(\"^(https?:)?//\").test(baseHref);\n  if (isAbsoluteUrl2) {\n    const [, pathname] = baseHref.split(/\\/\\/[^\\/]+/);\n    return pathname;\n  }\n  return baseHref;\n}\n\n// node_modules/@angular/common/fesm2022/_common_module-chunk.mjs\nvar HashLocationStrategy = class _HashLocationStrategy extends LocationStrategy {\n  _platformLocation;\n  _baseHref = \"\";\n  _removeListenerFns = [];\n  constructor(_platformLocation, _baseHref) {\n    super();\n    this._platformLocation = _platformLocation;\n    if (_baseHref != null) {\n      this._baseHref = _baseHref;\n    }\n  }\n  ngOnDestroy() {\n    while (this._removeListenerFns.length) {\n      this._removeListenerFns.pop()();\n    }\n  }\n  onPopState(fn) {\n    this._removeListenerFns.push(this._platformLocation.onPopState(fn), this._platformLocation.onHashChange(fn));\n  }\n  getBaseHref() {\n    return this._baseHref;\n  }\n  path(includeHash = false) {\n    const path = this._platformLocation.hash ?? \"#\";\n    return path.length > 0 ? path.substring(1) : path;\n  }\n  prepareExternalUrl(internal) {\n    const url = joinWithSlash(this._baseHref, internal);\n    return url.length > 0 ? \"#\" + url : url;\n  }\n  pushState(state, title, path, queryParams) {\n    const url = this.prepareExternalUrl(path + normalizeQueryParams(queryParams)) || this._platformLocation.pathname;\n    this._platformLocation.pushState(state, title, url);\n  }\n  replaceState(state, title, path, queryParams) {\n    const url = this.prepareExternalUrl(path + normalizeQueryParams(queryParams)) || this._platformLocation.pathname;\n    this._platformLocation.replaceState(state, title, url);\n  }\n  forward() {\n    this._platformLocation.forward();\n  }\n  back() {\n    this._platformLocation.back();\n  }\n  getState() {\n    return this._platformLocation.getState();\n  }\n  historyGo(relativePosition = 0) {\n    this._platformLocation.historyGo?.(relativePosition);\n  }\n  static fac = function HashLocationStrategy_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HashLocationStrategy)(inject(PlatformLocation), inject(APP_BASE_HREF, 8));\n  };\n  static prov = defineInjectable({\n    token: _HashLocationStrategy,\n    factory: _HashLocationStrategy.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HashLocationStrategy, [{\n    type: Injectable\n  }], () => [{\n    type: PlatformLocation\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Optional\n    }, {\n      type: Inject,\n      args: [APP_BASE_HREF]\n    }]\n  }], null);\n})();\nvar CURRENCIES_EN = {\n  \"ADP\": [void 0, void 0, 0],\n  \"AFN\": [void 0, \"\", 0],\n  \"ALL\": [void 0, void 0, 0],\n  \"AMD\": [void 0, \"\", 2],\n  \"AOA\": [void 0, \"Kz\"],\n  \"ARS\": [void 0, \"$\"],\n  \"AUD\": [\"A$\", \"$\"],\n  \"AZN\": [void 0, \"\"],\n  \"BAM\": [void 0, \"KM\"],\n  \"BBD\": [void 0, \"$\"],\n  \"BDT\": [void 0, \"\"],\n  \"BHD\": [void 0, void 0, 3],\n  \"BIF\": [void 0, void 0, 0],\n  \"BMD\": [void 0, \"$\"],\n  \"BND\": [void 0, \"$\"],\n  \"BOB\": [void 0, \"Bs\"],\n  \"BRL\": [\"R$\"],\n  \"BSD\": [void 0, \"$\"],\n  \"BWP\": [void 0, \"P\"],\n  \"BYN\": [void 0, void 0, 2],\n  \"BYR\": [void 0, void 0, 0],\n  \"BZD\": [void 0, \"$\"],\n  \"CAD\": [\"CA$\", \"$\", 2],\n  \"CHF\": [void 0, void 0, 2],\n  \"CLF\": [void 0, void 0, 4],\n  \"CLP\": [void 0, \"$\", 0],\n  \"CNY\": [\"CN\", \"\"],\n  \"COP\": [void 0, \"$\", 2],\n  \"CRC\": [void 0, \"\", 2],\n  \"CUC\": [void 0, \"$\"],\n  \"CUP\": [void 0, \"$\"],\n  \"CZK\": [void 0, \"K\", 2],\n  \"DJF\": [void 0, void 0, 0],\n  \"DKK\": [void 0, \"kr\", 2],\n  \"DOP\": [void 0, \"$\"],\n  \"EGP\": [void 0, \"E\"],\n  \"ESP\": [void 0, \"\", 0],\n  \"EUR\": [\"\"],\n  \"FJD\": [void 0, \"$\"],\n  \"FKP\": [void 0, \"\"],\n  \"GBP\": [\"\"],\n  \"GEL\": [void 0, \"\"],\n  \"GHS\": [void 0, \"GH\"],\n  \"GIP\": [void 0, \"\"],\n  \"GNF\": [void 0, \"FG\", 0],\n  \"GTQ\": [void 0, \"Q\"],\n  \"GYD\": [void 0, \"$\", 2],\n  \"HKD\": [\"HK$\", \"$\"],\n  \"HNL\": [void 0, \"L\"],\n  \"HRK\": [void 0, \"kn\"],\n  \"HUF\": [void 0, \"Ft\", 2],\n  \"IDR\": [void 0, \"Rp\", 2],\n  \"ILS\": [\"\"],\n  \"INR\": [\"\"],\n  \"IQD\": [void 0, void 0, 0],\n  \"IRR\": [void 0, void 0, 0],\n  \"ISK\": [void 0, \"kr\", 0],\n  \"ITL\": [void 0, void 0, 0],\n  \"JMD\": [void 0, \"$\"],\n  \"JOD\": [void 0, void 0, 3],\n  \"JPY\": [\"\", void 0, 0],\n  \"KGS\": [void 0, \"\"],\n  \"KHR\": [void 0, \"\"],\n  \"KMF\": [void 0, \"CF\", 0],\n  \"KPW\": [void 0, \"\", 0],\n  \"KRW\": [\"\", void 0, 0],\n  \"KWD\": [void 0, void 0, 3],\n  \"KYD\": [void 0, \"$\"],\n  \"KZT\": [void 0, \"\"],\n  \"LAK\": [void 0, \"\", 0],\n  \"LBP\": [void 0, \"L\", 0],\n  \"LKR\": [void 0, \"Rs\"],\n  \"LRD\": [void 0, \"$\"],\n  \"LTL\": [void 0, \"Lt\"],\n  \"LUF\": [void 0, void 0, 0],\n  \"LVL\": [void 0, \"Ls\"],\n  \"LYD\": [void 0, void 0, 3],\n  \"MGA\": [void 0, \"Ar\", 0],\n  \"MGF\": [void 0, void 0, 0],\n  \"MMK\": [void 0, \"K\", 0],\n  \"MNT\": [void 0, \"\", 2],\n  \"MRO\": [void 0, void 0, 0],\n  \"MUR\": [void 0, \"Rs\", 2],\n  \"MXN\": [\"MX$\", \"$\"],\n  \"MYR\": [void 0, \"RM\"],\n  \"NAD\": [void 0, \"$\"],\n  \"NGN\": [void 0, \"\"],\n  \"NIO\": [void 0, \"C$\"],\n  \"NOK\": [void 0, \"kr\", 2],\n  \"NPR\": [void 0, \"Rs\"],\n  \"NZD\": [\"NZ$\", \"$\"],\n  \"OMR\": [void 0, void 0, 3],\n  \"PHP\": [\"\"],\n  \"PKR\": [void 0, \"Rs\", 2],\n  \"PLN\": [void 0, \"z\"],\n  \"PYG\": [void 0, \"\", 0],\n  \"RON\": [void 0, \"lei\"],\n  \"RSD\": [void 0, void 0, 0],\n  \"RUB\": [void 0, \"\"],\n  \"RWF\": [void 0, \"RF\", 0],\n  \"SBD\": [void 0, \"$\"],\n  \"SEK\": [void 0, \"kr\", 2],\n  \"SGD\": [void 0, \"$\"],\n  \"SHP\": [void 0, \"\"],\n  \"SLE\": [void 0, void 0, 2],\n  \"SLL\": [void 0, void 0, 0],\n  \"SOS\": [void 0, void 0, 0],\n  \"SRD\": [void 0, \"$\"],\n  \"SSP\": [void 0, \"\"],\n  \"STD\": [void 0, void 0, 0],\n  \"STN\": [void 0, \"Db\"],\n  \"SYP\": [void 0, \"\", 0],\n  \"THB\": [void 0, \"\"],\n  \"TMM\": [void 0, void 0, 0],\n  \"TND\": [void 0, void 0, 3],\n  \"TOP\": [void 0, \"T$\"],\n  \"TRL\": [void 0, void 0, 0],\n  \"TRY\": [void 0, \"\"],\n  \"TTD\": [void 0, \"$\"],\n  \"TWD\": [\"NT$\", \"$\", 2],\n  \"TZS\": [void 0, void 0, 2],\n  \"UAH\": [void 0, \"\"],\n  \"UGX\": [void 0, void 0, 0],\n  \"USD\": [\"$\"],\n  \"UYI\": [void 0, void 0, 0],\n  \"UYU\": [void 0, \"$\"],\n  \"UYW\": [void 0, void 0, 4],\n  \"UZS\": [void 0, void 0, 2],\n  \"VEF\": [void 0, \"Bs\", 2],\n  \"VND\": [\"\", void 0, 0],\n  \"VUV\": [void 0, void 0, 0],\n  \"XAF\": [\"FCFA\", void 0, 0],\n  \"XCD\": [\"EC$\", \"$\"],\n  \"XCG\": [\"Cg.\"],\n  \"XOF\": [\"FCFA\", void 0, 0],\n  \"XPF\": [\"CFPF\", void 0, 0],\n  \"XXX\": [\"\"],\n  \"YER\": [void 0, void 0, 0],\n  \"ZAR\": [void 0, \"R\"],\n  \"ZMK\": [void 0, void 0, 0],\n  \"ZMW\": [void 0, \"ZK\"],\n  \"ZWD\": [void 0, void 0, 0]\n};\nvar NumberFormatStyle;\n(function(NumberFormatStyle2) {\n  NumberFormatStyle2[NumberFormatStyle2[\"Decimal\"] = 0] = \"Decimal\";\n  NumberFormatStyle2[NumberFormatStyle2[\"Percent\"] = 1] = \"Percent\";\n  NumberFormatStyle2[NumberFormatStyle2[\"Currency\"] = 2] = \"Currency\";\n  NumberFormatStyle2[NumberFormatStyle2[\"Scientific\"] = 3] = \"Scientific\";\n})(NumberFormatStyle || (NumberFormatStyle = {}));\nvar Plural;\n(function(Plural2) {\n  Plural2[Plural2[\"Zero\"] = 0] = \"Zero\";\n  Plural2[Plural2[\"One\"] = 1] = \"One\";\n  Plural2[Plural2[\"Two\"] = 2] = \"Two\";\n  Plural2[Plural2[\"Few\"] = 3] = \"Few\";\n  Plural2[Plural2[\"Many\"] = 4] = \"Many\";\n  Plural2[Plural2[\"Other\"] = 5] = \"Other\";\n})(Plural || (Plural = {}));\nvar FormStyle;\n(function(FormStyle2) {\n  FormStyle2[FormStyle2[\"Format\"] = 0] = \"Format\";\n  FormStyle2[FormStyle2[\"Standalone\"] = 1] = \"Standalone\";\n})(FormStyle || (FormStyle = {}));\nvar TranslationWidth;\n(function(TranslationWidth2) {\n  TranslationWidth2[TranslationWidth2[\"Narrow\"] = 0] = \"Narrow\";\n  TranslationWidth2[TranslationWidth2[\"Abbreviated\"] = 1] = \"Abbreviated\";\n  TranslationWidth2[TranslationWidth2[\"Wide\"] = 2] = \"Wide\";\n  TranslationWidth2[TranslationWidth2[\"Short\"] = 3] = \"Short\";\n})(TranslationWidth || (TranslationWidth = {}));\nvar FormatWidth;\n(function(FormatWidth2) {\n  FormatWidth2[FormatWidth2[\"Short\"] = 0] = \"Short\";\n  FormatWidth2[FormatWidth2[\"Medium\"] = 1] = \"Medium\";\n  FormatWidth2[FormatWidth2[\"Long\"] = 2] = \"Long\";\n  FormatWidth2[FormatWidth2[\"Full\"] = 3] = \"Full\";\n})(FormatWidth || (FormatWidth = {}));\nvar NumberSymbol = {\n  Decimal: 0,\n  Group: 1,\n  List: 2,\n  PercentSign: 3,\n  PlusSign: 4,\n  MinusSign: 5,\n  Exponential: 6,\n  SuperscriptingExponent: 7,\n  PerMille: 8,\n  Infinity: 9,\n  NaN: 10,\n  TimeSeparator: 11,\n  CurrencyDecimal: 12,\n  CurrencyGroup: 13\n};\nvar WeekDay;\n(function(WeekDay2) {\n  WeekDay2[WeekDay2[\"Sunday\"] = 0] = \"Sunday\";\n  WeekDay2[WeekDay2[\"Monday\"] = 1] = \"Monday\";\n  WeekDay2[WeekDay2[\"Tuesday\"] = 2] = \"Tuesday\";\n  WeekDay2[WeekDay2[\"Wednesday\"] = 3] = \"Wednesday\";\n  WeekDay2[WeekDay2[\"Thursday\"] = 4] = \"Thursday\";\n  WeekDay2[WeekDay2[\"Friday\"] = 5] = \"Friday\";\n  WeekDay2[WeekDay2[\"Saturday\"] = 6] = \"Saturday\";\n})(WeekDay || (WeekDay = {}));\nfunction getLocaleId(locale) {\n  return findLocaleData(locale)[LocaleDataIndex.LocaleId];\n}\nfunction getLocaleDayPeriods(locale, formStyle, width) {\n  const data = findLocaleData(locale);\n  const amPmData = [data[LocaleDataIndex.DayPeriodsFormat], data[LocaleDataIndex.DayPeriodsStandalone]];\n  const amPm = getLastDefinedValue(amPmData, formStyle);\n  return getLastDefinedValue(amPm, width);\n}\nfunction getLocaleDayNames(locale, formStyle, width) {\n  const data = findLocaleData(locale);\n  const daysData = [data[LocaleDataIndex.DaysFormat], data[LocaleDataIndex.DaysStandalone]];\n  const days = getLastDefinedValue(daysData, formStyle);\n  return getLastDefinedValue(days, width);\n}\nfunction getLocaleMonthNames(locale, formStyle, width) {\n  const data = findLocaleData(locale);\n  const monthsData = [data[LocaleDataIndex.MonthsFormat], data[LocaleDataIndex.MonthsStandalone]];\n  const months = getLastDefinedValue(monthsData, formStyle);\n  return getLastDefinedValue(months, width);\n}\nfunction getLocaleEraNames(locale, width) {\n  const data = findLocaleData(locale);\n  const erasData = data[LocaleDataIndex.Eras];\n  return getLastDefinedValue(erasData, width);\n}\nfunction getLocaleFirstDayOfWeek(locale) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.FirstDayOfWeek];\n}\nfunction getLocaleWeekEndRange(locale) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.WeekendRange];\n}\nfunction getLocaleDateFormat(locale, width) {\n  const data = findLocaleData(locale);\n  return getLastDefinedValue(data[LocaleDataIndex.DateFormat], width);\n}\nfunction getLocaleTimeFormat(locale, width) {\n  const data = findLocaleData(locale);\n  return getLastDefinedValue(data[LocaleDataIndex.TimeFormat], width);\n}\nfunction getLocaleDateTimeFormat(locale, width) {\n  const data = findLocaleData(locale);\n  const dateTimeFormatData = data[LocaleDataIndex.DateTimeFormat];\n  return getLastDefinedValue(dateTimeFormatData, width);\n}\nfunction getLocaleNumberSymbol(locale, symbol) {\n  const data = findLocaleData(locale);\n  const res = data[LocaleDataIndex.NumberSymbols][symbol];\n  if (typeof res === \"undefined\") {\n    if (symbol === NumberSymbol.CurrencyDecimal) {\n      return data[LocaleDataIndex.NumberSymbols][NumberSymbol.Decimal];\n    } else if (symbol === NumberSymbol.CurrencyGroup) {\n      return data[LocaleDataIndex.NumberSymbols][NumberSymbol.Group];\n    }\n  }\n  return res;\n}\nfunction getLocaleNumberFormat(locale, type) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.NumberFormats][type];\n}\nfunction getLocaleCurrencySymbol(locale) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.CurrencySymbol] || null;\n}\nfunction getLocaleCurrencyName(locale) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.CurrencyName] || null;\n}\nfunction getLocaleCurrencyCode2(locale) {\n  return getLocaleCurrencyCode(locale);\n}\nfunction getLocaleCurrencies(locale) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.Currencies];\n}\nvar getLocalePluralCase2 = getLocalePluralCase;\nfunction checkFullData(data) {\n  if (!data[LocaleDataIndex.ExtraData]) {\n    throw new RuntimeError(2303, ngDevMode && `Missing extra locale data for the locale \"${data[LocaleDataIndex.LocaleId]}\". Use \"registerLocaleData\" to load new data. See the \"I18n guide\" on angular.io to know more.`);\n  }\n}\nfunction getLocaleExtraDayPeriodRules(locale) {\n  const data = findLocaleData(locale);\n  checkFullData(data);\n  const rules = data[LocaleDataIndex.ExtraData][2] || [];\n  return rules.map((rule) => {\n    if (typeof rule === \"string\") {\n      return extractTime(rule);\n    }\n    return [extractTime(rule[0]), extractTime(rule[1])];\n  });\n}\nfunction getLocaleExtraDayPeriods(locale, formStyle, width) {\n  const data = findLocaleData(locale);\n  checkFullData(data);\n  const dayPeriodsData = [data[LocaleDataIndex.ExtraData][0], data[LocaleDataIndex.ExtraData][1]];\n  const dayPeriods = getLastDefinedValue(dayPeriodsData, formStyle) || [];\n  return getLastDefinedValue(dayPeriods, width) || [];\n}\nfunction getLocaleDirection(locale) {\n  const data = findLocaleData(locale);\n  return data[LocaleDataIndex.Directionality];\n}\nfunction getLastDefinedValue(data, index) {\n  for (let i = index; i > -1; i--) {\n    if (typeof data[i] !== \"undefined\") {\n      return data[i];\n    }\n  }\n  throw new RuntimeError(2304, ngDevMode && \"Locale data API: locale data undefined\");\n}\nfunction extractTime(time) {\n  const [h, m] = time.split(\":\");\n  return {\n    hours: +h,\n    minutes: +m\n  };\n}\nfunction getCurrencySymbol(code, format, locale = \"en\") {\n  const currency = getLocaleCurrencies(locale)[code] || CURRENCIES_EN[code] || [];\n  const symbolNarrow = currency[1];\n  if (format === \"narrow\" && typeof symbolNarrow === \"string\") {\n    return symbolNarrow;\n  }\n  return currency[0] || code;\n}\nvar DEFAULT_NB_OF_CURRENCY_DIGITS = 2;\nfunction getNumberOfCurrencyDigits(code) {\n  let digits;\n  const currency = CURRENCIES_EN[code];\n  if (currency) {\n    digits = currency[2];\n  }\n  return typeof digits === \"number\" ? digits : DEFAULT_NB_OF_CURRENCY_DIGITS;\n}\nvar ISO8601_DATE_REGEX = /^(\\d{4,})-?(\\d\\d)-?(\\d\\d)(?:T(\\d\\d)(?::?(\\d\\d)(?::?(\\d\\d)(?:\\.(\\d+))?)?)?(Z|([+-])(\\d\\d):?(\\d\\d))?)?$/;\nvar NAMED_FORMATS = {};\nvar DATE_FORMATS_SPLIT = /((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\\s\\S]*)/;\nfunction formatDate(value, format, locale, timezone) {\n  let date = toDate(value);\n  const namedFormat = getNamedFormat(locale, format);\n  format = namedFormat || format;\n  let parts = [];\n  let match;\n  while (format) {\n    match = DATE_FORMATS_SPLIT.exec(format);\n    if (match) {\n      parts = parts.concat(match.slice(1));\n      const part = parts.pop();\n      if (!part) {\n        break;\n      }\n      format = part;\n    } else {\n      parts.push(format);\n      break;\n    }\n  }\n  if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n    assertValidDateFormat(parts);\n  }\n  let dateTimezoneOffset = date.getTimezoneOffset();\n  if (timezone) {\n    dateTimezoneOffset = timezoneToOffset(timezone, dateTimezoneOffset);\n    date = convertTimezoneToLocal(date, timezone);\n  }\n  let text = \"\";\n  parts.forEach((value2) => {\n    const dateFormatter = getDateFormatter(value2);\n    text += dateFormatter ? dateFormatter(date, locale, dateTimezoneOffset) : value2 === \"''\" ? \"'\" : value2.replace(/(^'|'$)/g, \"\").replace(/''/g, \"'\");\n  });\n  return text;\n}\nfunction assertValidDateFormat(parts) {\n  if (parts.some((part) => /^Y+$/.test(part)) && !parts.some((part) => /^w+$/.test(part))) {\n    const message = `Suspicious use of week-based year \"Y\" in date pattern \"${parts.join(\"\")}\". Did you mean to use calendar year \"y\" instead?`;\n    if (parts.length === 1) {\n      console.error(formatRuntimeError(2300, message));\n    } else {\n      throw new RuntimeError(2300, message);\n    }\n  }\n}\nfunction createDate(year, month, date) {\n  const newDate = /* @__PURE__ */ new Date(0);\n  newDate.setFullYear(year, month, date);\n  newDate.setHours(0, 0, 0);\n  return newDate;\n}\nfunction getNamedFormat(locale, format) {\n  const localeId = getLocaleId(locale);\n  NAMED_FORMATS[localeId] ??= {};\n  if (NAMED_FORMATS[localeId][format]) {\n    return NAMED_FORMATS[localeId][format];\n  }\n  let formatValue = \"\";\n  switch (format) {\n    case \"shortDate\":\n      formatValue = getLocaleDateFormat(locale, FormatWidth.Short);\n      break;\n    case \"mediumDate\":\n      formatValue = getLocaleDateFormat(locale, FormatWidth.Medium);\n      break;\n    case \"longDate\":\n      formatValue = getLocaleDateFormat(locale, FormatWidth.Long);\n      break;\n    case \"fullDate\":\n      formatValue = getLocaleDateFormat(locale, FormatWidth.Full);\n      break;\n    case \"shortTime\":\n      formatValue = getLocaleTimeFormat(locale, FormatWidth.Short);\n      break;\n    case \"mediumTime\":\n      formatValue = getLocaleTimeFormat(locale, FormatWidth.Medium);\n      break;\n    case \"longTime\":\n      formatValue = getLocaleTimeFormat(locale, FormatWidth.Long);\n      break;\n    case \"fullTime\":\n      formatValue = getLocaleTimeFormat(locale, FormatWidth.Full);\n      break;\n    case \"short\":\n      const shortTime = getNamedFormat(locale, \"shortTime\");\n      const shortDate = getNamedFormat(locale, \"shortDate\");\n      formatValue = formatDateTime(getLocaleDateTimeFormat(locale, FormatWidth.Short), [shortTime, shortDate]);\n      break;\n    case \"medium\":\n      const mediumTime = getNamedFormat(locale, \"mediumTime\");\n      const mediumDate = getNamedFormat(locale, \"mediumDate\");\n      formatValue = formatDateTime(getLocaleDateTimeFormat(locale, FormatWidth.Medium), [mediumTime, mediumDate]);\n      break;\n    case \"long\":\n      const longTime = getNamedFormat(locale, \"longTime\");\n      const longDate = getNamedFormat(locale, \"longDate\");\n      formatValue = formatDateTime(getLocaleDateTimeFormat(locale, FormatWidth.Long), [longTime, longDate]);\n      break;\n    case \"full\":\n      const fullTime = getNamedFormat(locale, \"fullTime\");\n      const fullDate = getNamedFormat(locale, \"fullDate\");\n      formatValue = formatDateTime(getLocaleDateTimeFormat(locale, FormatWidth.Full), [fullTime, fullDate]);\n      break;\n  }\n  if (formatValue) {\n    NAMED_FORMATS[localeId][format] = formatValue;\n  }\n  return formatValue;\n}\nfunction formatDateTime(str, opt_values) {\n  if (opt_values) {\n    str = str.replace(/\\{([^}]+)}/g, function(match, key) {\n      return opt_values != null && key in opt_values ? opt_values[key] : match;\n    });\n  }\n  return str;\n}\nfunction padNumber(num, digits, minusSign = \"-\", trim, negWrap) {\n  let neg = \"\";\n  if (num < 0 || negWrap && num <= 0) {\n    if (negWrap) {\n      num = -num + 1;\n    } else {\n      num = -num;\n      neg = minusSign;\n    }\n  }\n  let strNum = String(num);\n  while (strNum.length < digits) {\n    strNum = \"0\" + strNum;\n  }\n  if (trim) {\n    strNum = strNum.slice(strNum.length - digits);\n  }\n  return neg + strNum;\n}\nfunction formatFractionalSeconds(milliseconds, digits) {\n  const strMs = padNumber(milliseconds, 3);\n  return strMs.substring(0, digits);\n}\nfunction dateGetter(name, size, offset = 0, trim = false, negWrap = false) {\n  return function(date, locale) {\n    let part = getDatePart(name, date);\n    if (offset > 0 || part > -offset) {\n      part += offset;\n    }\n    if (name === 3) {\n      if (part === 0 && offset === -12) {\n        part = 12;\n      }\n    } else if (name === 6) {\n      return formatFractionalSeconds(part, size);\n    }\n    const localeMinus = getLocaleNumberSymbol(locale, NumberSymbol.MinusSign);\n    return padNumber(part, size, localeMinus, trim, negWrap);\n  };\n}\nfunction getDatePart(part, date) {\n  switch (part) {\n    case 0:\n      return date.getFullYear();\n    case 1:\n      return date.getMonth();\n    case 2:\n      return date.getDate();\n    case 3:\n      return date.getHours();\n    case 4:\n      return date.getMinutes();\n    case 5:\n      return date.getSeconds();\n    case 6:\n      return date.getMilliseconds();\n    case 7:\n      return date.getDay();\n    default:\n      throw new RuntimeError(2301, ngDevMode && `Unknown DateType value \"${part}\".`);\n  }\n}\nfunction dateStrGetter(name, width, form = FormStyle.Format, extended = false) {\n  return function(date, locale) {\n    return getDateTranslation(date, locale, name, width, form, extended);\n  };\n}\nfunction getDateTranslation(date, locale, name, width, form, extended) {\n  switch (name) {\n    case 2:\n      return getLocaleMonthNames(locale, form, width)[date.getMonth()];\n    case 1:\n      return getLocaleDayNames(locale, form, width)[date.getDay()];\n    case 0:\n      const currentHours = date.getHours();\n      const currentMinutes = date.getMinutes();\n      if (extended) {\n        const rules = getLocaleExtraDayPeriodRules(locale);\n        const dayPeriods = getLocaleExtraDayPeriods(locale, form, width);\n        const index = rules.findIndex((rule) => {\n          if (Array.isArray(rule)) {\n            const [from, to] = rule;\n            const afterFrom = currentHours >= from.hours && currentMinutes >= from.minutes;\n            const beforeTo = currentHours < to.hours || currentHours === to.hours && currentMinutes < to.minutes;\n            if (from.hours < to.hours) {\n              if (afterFrom && beforeTo) {\n                return true;\n              }\n            } else if (afterFrom || beforeTo) {\n              return true;\n            }\n          } else {\n            if (rule.hours === currentHours && rule.minutes === currentMinutes) {\n              return true;\n            }\n          }\n          return false;\n        });\n        if (index !== -1) {\n          return dayPeriods[index];\n        }\n      }\n      return getLocaleDayPeriods(locale, form, width)[currentHours < 12 ? 0 : 1];\n    case 3:\n      return getLocaleEraNames(locale, width)[date.getFullYear() <= 0 ? 0 : 1];\n    default:\n      const unexpected = name;\n      throw new RuntimeError(2302, ngDevMode && `unexpected translation type ${unexpected}`);\n  }\n}\nfunction timeZoneGetter(width) {\n  return function(date, locale, offset) {\n    const zone = -1 * offset;\n    const minusSign = getLocaleNumberSymbol(locale, NumberSymbol.MinusSign);\n    const hours = zone > 0 ? Math.floor(zone / 60) : Math.ceil(zone / 60);\n    switch (width) {\n      case 0:\n        return (zone >= 0 ? \"+\" : \"\") + padNumber(hours, 2, minusSign) + padNumber(Math.abs(zone % 60), 2, minusSign);\n      case 1:\n        return \"GMT\" + (zone >= 0 ? \"+\" : \"\") + padNumber(hours, 1, minusSign);\n      case 2:\n        return \"GMT\" + (zone >= 0 ? \"+\" : \"\") + padNumber(hours, 2, minusSign) + \":\" + padNumber(Math.abs(zone % 60), 2, minusSign);\n      case 3:\n        if (offset === 0) {\n          return \"Z\";\n        } else {\n          return (zone >= 0 ? \"+\" : \"\") + padNumber(hours, 2, minusSign) + \":\" + padNumber(Math.abs(zone % 60), 2, minusSign);\n        }\n      default:\n        throw new RuntimeError(2310, ngDevMode && `Unknown zone width \"${width}\"`);\n    }\n  };\n}\nvar JANUARY = 0;\nvar THURSDAY = 4;\nfunction getFirstThursdayOfYear(year) {\n  const firstDayOfYear = createDate(year, JANUARY, 1).getDay();\n  return createDate(year, 0, 1 + (firstDayOfYear <= THURSDAY ? THURSDAY : THURSDAY + 7) - firstDayOfYear);\n}\nfunction getThursdayThisIsoWeek(datetime) {\n  const currentDay = datetime.getDay();\n  const deltaToThursday = currentDay === 0 ? -3 : THURSDAY - currentDay;\n  return createDate(datetime.getFullYear(), datetime.getMonth(), datetime.getDate() + deltaToThursday);\n}\nfunction weekGetter(size, monthBased = false) {\n  return function(date, locale) {\n    let result;\n    if (monthBased) {\n      const nbDaysBefore1stDayOfMonth = new Date(date.getFullYear(), date.getMonth(), 1).getDay() - 1;\n      const today = date.getDate();\n      result = 1 + Math.floor((today + nbDaysBefore1stDayOfMonth) / 7);\n    } else {\n      const thisThurs = getThursdayThisIsoWeek(date);\n      const firstThurs = getFirstThursdayOfYear(thisThurs.getFullYear());\n      const diff = thisThurs.getTime() - firstThurs.getTime();\n      result = 1 + Math.round(diff / 6048e5);\n    }\n    return padNumber(result, size, getLocaleNumberSymbol(locale, NumberSymbol.MinusSign));\n  };\n}\nfunction weekNumberingYearGetter(size, trim = false) {\n  return function(date, locale) {\n    const thisThurs = getThursdayThisIsoWeek(date);\n    const weekNumberingYear = thisThurs.getFullYear();\n    return padNumber(weekNumberingYear, size, getLocaleNumberSymbol(locale, NumberSymbol.MinusSign), trim);\n  };\n}\nvar DATE_FORMATS = {};\nfunction getDateFormatter(format) {\n  if (DATE_FORMATS[format]) {\n    return DATE_FORMATS[format];\n  }\n  let formatter;\n  switch (format) {\n    case \"G\":\n    case \"GG\":\n    case \"GGG\":\n      formatter = dateStrGetter(3, TranslationWidth.Abbreviated);\n      break;\n    case \"GGGG\":\n      formatter = dateStrGetter(3, TranslationWidth.Wide);\n      break;\n    case \"GGGGG\":\n      formatter = dateStrGetter(3, TranslationWidth.Narrow);\n      break;\n    case \"y\":\n      formatter = dateGetter(0, 1, 0, false, true);\n      break;\n    case \"yy\":\n      formatter = dateGetter(0, 2, 0, true, true);\n      break;\n    case \"yyy\":\n      formatter = dateGetter(0, 3, 0, false, true);\n      break;\n    case \"yyyy\":\n      formatter = dateGetter(0, 4, 0, false, true);\n      break;\n    case \"Y\":\n      formatter = weekNumberingYearGetter(1);\n      break;\n    case \"YY\":\n      formatter = weekNumberingYearGetter(2, true);\n      break;\n    case \"YYY\":\n      formatter = weekNumberingYearGetter(3);\n      break;\n    case \"YYYY\":\n      formatter = weekNumberingYearGetter(4);\n      break;\n    case \"M\":\n    case \"L\":\n      formatter = dateGetter(1, 1, 1);\n      break;\n    case \"MM\":\n    case \"LL\":\n      formatter = dateGetter(1, 2, 1);\n      break;\n    case \"MMM\":\n      formatter = dateStrGetter(2, TranslationWidth.Abbreviated);\n      break;\n    case \"MMMM\":\n      formatter = dateStrGetter(2, TranslationWidth.Wide);\n      break;\n    case \"MMMMM\":\n      formatter = dateStrGetter(2, TranslationWidth.Narrow);\n      break;\n    case \"LLL\":\n      formatter = dateStrGetter(2, TranslationWidth.Abbreviated, FormStyle.Standalone);\n      break;\n    case \"LLLL\":\n      formatter = dateStrGetter(2, TranslationWidth.Wide, FormStyle.Standalone);\n      break;\n    case \"LLLLL\":\n      formatter = dateStrGetter(2, TranslationWidth.Narrow, FormStyle.Standalone);\n      break;\n    case \"w\":\n      formatter = weekGetter(1);\n      break;\n    case \"ww\":\n      formatter = weekGetter(2);\n      break;\n    case \"W\":\n      formatter = weekGetter(1, true);\n      break;\n    case \"d\":\n      formatter = dateGetter(2, 1);\n      break;\n    case \"dd\":\n      formatter = dateGetter(2, 2);\n      break;\n    case \"c\":\n    case \"cc\":\n      formatter = dateGetter(7, 1);\n      break;\n    case \"ccc\":\n      formatter = dateStrGetter(1, TranslationWidth.Abbreviated, FormStyle.Standalone);\n      break;\n    case \"cccc\":\n      formatter = dateStrGetter(1, TranslationWidth.Wide, FormStyle.Standalone);\n      break;\n    case \"ccccc\":\n      formatter = dateStrGetter(1, TranslationWidth.Narrow, FormStyle.Standalone);\n      break;\n    case \"cccccc\":\n      formatter = dateStrGetter(1, TranslationWidth.Short, FormStyle.Standalone);\n      break;\n    case \"E\":\n    case \"EE\":\n    case \"EEE\":\n      formatter = dateStrGetter(1, TranslationWidth.Abbreviated);\n      break;\n    case \"EEEE\":\n      formatter = dateStrGetter(1, TranslationWidth.Wide);\n      break;\n    case \"EEEEE\":\n      formatter = dateStrGetter(1, TranslationWidth.Narrow);\n      break;\n    case \"EEEEEE\":\n      formatter = dateStrGetter(1, TranslationWidth.Short);\n      break;\n    case \"a\":\n    case \"aa\":\n    case \"aaa\":\n      formatter = dateStrGetter(0, TranslationWidth.Abbreviated);\n      break;\n    case \"aaaa\":\n      formatter = dateStrGetter(0, TranslationWidth.Wide);\n      break;\n    case \"aaaaa\":\n      formatter = dateStrGetter(0, TranslationWidth.Narrow);\n      break;\n    case \"b\":\n    case \"bb\":\n    case \"bbb\":\n      formatter = dateStrGetter(0, TranslationWidth.Abbreviated, FormStyle.Standalone, true);\n      break;\n    case \"bbbb\":\n      formatter = dateStrGetter(0, TranslationWidth.Wide, FormStyle.Standalone, true);\n      break;\n    case \"bbbbb\":\n      formatter = dateStrGetter(0, TranslationWidth.Narrow, FormStyle.Standalone, true);\n      break;\n    case \"B\":\n    case \"BB\":\n    case \"BBB\":\n      formatter = dateStrGetter(0, TranslationWidth.Abbreviated, FormStyle.Format, true);\n      break;\n    case \"BBBB\":\n      formatter = dateStrGetter(0, TranslationWidth.Wide, FormStyle.Format, true);\n      break;\n    case \"BBBBB\":\n      formatter = dateStrGetter(0, TranslationWidth.Narrow, FormStyle.Format, true);\n      break;\n    case \"h\":\n      formatter = dateGetter(3, 1, -12);\n      break;\n    case \"hh\":\n      formatter = dateGetter(3, 2, -12);\n      break;\n    case \"H\":\n      formatter = dateGetter(3, 1);\n      break;\n    case \"HH\":\n      formatter = dateGetter(3, 2);\n      break;\n    case \"m\":\n      formatter = dateGetter(4, 1);\n      break;\n    case \"mm\":\n      formatter = dateGetter(4, 2);\n      break;\n    case \"s\":\n      formatter = dateGetter(5, 1);\n      break;\n    case \"ss\":\n      formatter = dateGetter(5, 2);\n      break;\n    case \"S\":\n      formatter = dateGetter(6, 1);\n      break;\n    case \"SS\":\n      formatter = dateGetter(6, 2);\n      break;\n    case \"SSS\":\n      formatter = dateGetter(6, 3);\n      break;\n    case \"Z\":\n    case \"ZZ\":\n    case \"ZZZ\":\n      formatter = timeZoneGetter(0);\n      break;\n    case \"ZZZZZ\":\n      formatter = timeZoneGetter(3);\n      break;\n    case \"O\":\n    case \"OO\":\n    case \"OOO\":\n    case \"z\":\n    case \"zz\":\n    case \"zzz\":\n      formatter = timeZoneGetter(1);\n      break;\n    case \"OOOO\":\n    case \"ZZZZ\":\n    case \"zzzz\":\n      formatter = timeZoneGetter(2);\n      break;\n    default:\n      return null;\n  }\n  DATE_FORMATS[format] = formatter;\n  return formatter;\n}\nfunction timezoneToOffset(timezone, fallback) {\n  timezone = timezone.replace(/:/g, \"\");\n  const requestedTimezoneOffset = Date.parse(\"Jan 01, 1970 00:00:00 \" + timezone) / 6e4;\n  return isNaN(requestedTimezoneOffset) ? fallback : requestedTimezoneOffset;\n}\nfunction addDateMinutes(date, minutes) {\n  date = new Date(date.getTime());\n  date.setMinutes(date.getMinutes() + minutes);\n  return date;\n}\nfunction convertTimezoneToLocal(date, timezone, reverse) {\n  const reverseValue = -1;\n  const dateTimezoneOffset = date.getTimezoneOffset();\n  const timezoneOffset = timezoneToOffset(timezone, dateTimezoneOffset);\n  return addDateMinutes(date, reverseValue * (timezoneOffset - dateTimezoneOffset));\n}\nfunction toDate(value) {\n  if (isDate(value)) {\n    return value;\n  }\n  if (typeof value === \"number\" && !isNaN(value)) {\n    return new Date(value);\n  }\n  if (typeof value === \"string\") {\n    value = value.trim();\n    if (/^(\\d{4}(-\\d{1,2}(-\\d{1,2})?)?)$/.test(value)) {\n      const [y, m = 1, d = 1] = value.split(\"-\").map((val) => +val);\n      return createDate(y, m - 1, d);\n    }\n    const parsedNb = parseFloat(value);\n    if (!isNaN(value - parsedNb)) {\n      return new Date(parsedNb);\n    }\n    let match;\n    if (match = value.match(ISO8601_DATE_REGEX)) {\n      return isoStringToDate(match);\n    }\n  }\n  const date = new Date(value);\n  if (!isDate(date)) {\n    throw new RuntimeError(2311, ngDevMode && `Unable to convert \"${value}\" into a date`);\n  }\n  return date;\n}\nfunction isoStringToDate(match) {\n  const date = /* @__PURE__ */ new Date(0);\n  let tzHour = 0;\n  let tzMin = 0;\n  const dateSetter = match[8] ? date.setUTCFullYear : date.setFullYear;\n  const timeSetter = match[8] ? date.setUTCHours : date.setHours;\n  if (match[9]) {\n    tzHour = Number(match[9] + match[10]);\n    tzMin = Number(match[9] + match[11]);\n  }\n  dateSetter.call(date, Number(match[1]), Number(match[2]) - 1, Number(match[3]));\n  const h = Number(match[4] || 0) - tzHour;\n  const m = Number(match[5] || 0) - tzMin;\n  const s = Number(match[6] || 0);\n  const ms = Math.floor(parseFloat(\"0.\" + (match[7] || 0)) * 1e3);\n  timeSetter.call(date, h, m, s, ms);\n  return date;\n}\nfunction isDate(value) {\n  return value instanceof Date && !isNaN(value.valueOf());\n}\nvar NUMBER_FORMAT_REGEXP = /^(\\d+)?\\.((\\d+)(-(\\d+))?)?$/;\nvar MAX_DIGITS = 22;\nvar DECIMAL_SEP = \".\";\nvar ZERO_CHAR = \"0\";\nvar PATTERN_SEP = \";\";\nvar GROUP_SEP = \",\";\nvar DIGIT_CHAR = \"#\";\nvar CURRENCY_CHAR = \"\";\nvar PERCENT_CHAR = \"%\";\nfunction formatNumberToLocaleString(value, pattern, locale, groupSymbol, decimalSymbol, digitsInfo, isPercent = false) {\n  let formattedText = \"\";\n  let isZero = false;\n  if (!isFinite(value)) {\n    formattedText = getLocaleNumberSymbol(locale, NumberSymbol.Infinity);\n  } else {\n    let parsedNumber = parseNumber(value);\n    if (isPercent) {\n      parsedNumber = toPercent(parsedNumber);\n    }\n    let minInt = pattern.minInt;\n    let minFraction = pattern.minFrac;\n    let maxFraction = pattern.maxFrac;\n    if (digitsInfo) {\n      const parts = digitsInfo.match(NUMBER_FORMAT_REGEXP);\n      if (parts === null) {\n        throw new RuntimeError(2306, ngDevMode && `${digitsInfo} is not a valid digit info`);\n      }\n      const minIntPart = parts[1];\n      const minFractionPart = parts[3];\n      const maxFractionPart = parts[5];\n      if (minIntPart != null) {\n        minInt = parseIntAutoRadix(minIntPart);\n      }\n      if (minFractionPart != null) {\n        minFraction = parseIntAutoRadix(minFractionPart);\n      }\n      if (maxFractionPart != null) {\n        maxFraction = parseIntAutoRadix(maxFractionPart);\n      } else if (minFractionPart != null && minFraction > maxFraction) {\n        maxFraction = minFraction;\n      }\n    }\n    roundNumber(parsedNumber, minFraction, maxFraction);\n    let digits = parsedNumber.digits;\n    let integerLen = parsedNumber.integerLen;\n    const exponent = parsedNumber.exponent;\n    let decimals = [];\n    isZero = digits.every((d) => !d);\n    for (; integerLen < minInt; integerLen++) {\n      digits.unshift(0);\n    }\n    for (; integerLen < 0; integerLen++) {\n      digits.unshift(0);\n    }\n    if (integerLen > 0) {\n      decimals = digits.splice(integerLen, digits.length);\n    } else {\n      decimals = digits;\n      digits = [0];\n    }\n    const groups = [];\n    if (digits.length >= pattern.lgSize) {\n      groups.unshift(digits.splice(-pattern.lgSize, digits.length).join(\"\"));\n    }\n    while (digits.length > pattern.gSize) {\n      groups.unshift(digits.splice(-pattern.gSize, digits.length).join(\"\"));\n    }\n    if (digits.length) {\n      groups.unshift(digits.join(\"\"));\n    }\n    formattedText = groups.join(getLocaleNumberSymbol(locale, groupSymbol));\n    if (decimals.length) {\n      formattedText += getLocaleNumberSymbol(locale, decimalSymbol) + decimals.join(\"\");\n    }\n    if (exponent) {\n      formattedText += getLocaleNumberSymbol(locale, NumberSymbol.Exponential) + \"+\" + exponent;\n    }\n  }\n  if (value < 0 && !isZero) {\n    formattedText = pattern.negPre + formattedText + pattern.negSuf;\n  } else {\n    formattedText = pattern.posPre + formattedText + pattern.posSuf;\n  }\n  return formattedText;\n}\nfunction formatCurrency(value, locale, currency, currencyCode, digitsInfo) {\n  const format = getLocaleNumberFormat(locale, NumberFormatStyle.Currency);\n  const pattern = parseNumberFormat(format, getLocaleNumberSymbol(locale, NumberSymbol.MinusSign));\n  pattern.minFrac = getNumberOfCurrencyDigits(currencyCode);\n  pattern.maxFrac = pattern.minFrac;\n  const res = formatNumberToLocaleString(value, pattern, locale, NumberSymbol.CurrencyGroup, NumberSymbol.CurrencyDecimal, digitsInfo);\n  return res.replace(CURRENCY_CHAR, currency).replace(CURRENCY_CHAR, \"\").trim();\n}\nfunction formatPercent(value, locale, digitsInfo) {\n  const format = getLocaleNumberFormat(locale, NumberFormatStyle.Percent);\n  const pattern = parseNumberFormat(format, getLocaleNumberSymbol(locale, NumberSymbol.MinusSign));\n  const res = formatNumberToLocaleString(value, pattern, locale, NumberSymbol.Group, NumberSymbol.Decimal, digitsInfo, true);\n  return res.replace(new RegExp(PERCENT_CHAR, \"g\"), getLocaleNumberSymbol(locale, NumberSymbol.PercentSign));\n}\nfunction formatNumber(value, locale, digitsInfo) {\n  const format = getLocaleNumberFormat(locale, NumberFormatStyle.Decimal);\n  const pattern = parseNumberFormat(format, getLocaleNumberSymbol(locale, NumberSymbol.MinusSign));\n  return formatNumberToLocaleString(value, pattern, locale, NumberSymbol.Group, NumberSymbol.Decimal, digitsInfo);\n}\nfunction parseNumberFormat(format, minusSign = \"-\") {\n  const p = {\n    minInt: 1,\n    minFrac: 0,\n    maxFrac: 0,\n    posPre: \"\",\n    posSuf: \"\",\n    negPre: \"\",\n    negSuf: \"\",\n    gSize: 0,\n    lgSize: 0\n  };\n  const patternParts = format.split(PATTERN_SEP);\n  const positive = patternParts[0];\n  const negative = patternParts[1];\n  const positiveParts = positive.indexOf(DECIMAL_SEP) !== -1 ? positive.split(DECIMAL_SEP) : [positive.substring(0, positive.lastIndexOf(ZERO_CHAR) + 1), positive.substring(positive.lastIndexOf(ZERO_CHAR) + 1)], integer = positiveParts[0], fraction = positiveParts[1] || \"\";\n  p.posPre = integer.substring(0, integer.indexOf(DIGIT_CHAR));\n  for (let i = 0; i < fraction.length; i++) {\n    const ch = fraction.charAt(i);\n    if (ch === ZERO_CHAR) {\n      p.minFrac = p.maxFrac = i + 1;\n    } else if (ch === DIGIT_CHAR) {\n      p.maxFrac = i + 1;\n    } else {\n      p.posSuf += ch;\n    }\n  }\n  const groups = integer.split(GROUP_SEP);\n  p.gSize = groups[1] ? groups[1].length : 0;\n  p.lgSize = groups[2] || groups[1] ? (groups[2] || groups[1]).length : 0;\n  if (negative) {\n    const trunkLen = positive.length - p.posPre.length - p.posSuf.length, pos = negative.indexOf(DIGIT_CHAR);\n    p.negPre = negative.substring(0, pos).replace(/'/g, \"\");\n    p.negSuf = negative.slice(pos + trunkLen).replace(/'/g, \"\");\n  } else {\n    p.negPre = minusSign + p.posPre;\n    p.negSuf = p.posSuf;\n  }\n  return p;\n}\nfunction toPercent(parsedNumber) {\n  if (parsedNumber.digits[0] === 0) {\n    return parsedNumber;\n  }\n  const fractionLen = parsedNumber.digits.length - parsedNumber.integerLen;\n  if (parsedNumber.exponent) {\n    parsedNumber.exponent += 2;\n  } else {\n    if (fractionLen === 0) {\n      parsedNumber.digits.push(0, 0);\n    } else if (fractionLen === 1) {\n      parsedNumber.digits.push(0);\n    }\n    parsedNumber.integerLen += 2;\n  }\n  return parsedNumber;\n}\nfunction parseNumber(num) {\n  let numStr = Math.abs(num) + \"\";\n  let exponent = 0, digits, integerLen;\n  let i, j, zeros;\n  if ((integerLen = numStr.indexOf(DECIMAL_SEP)) > -1) {\n    numStr = numStr.replace(DECIMAL_SEP, \"\");\n  }\n  if ((i = numStr.search(/e/i)) > 0) {\n    if (integerLen < 0) integerLen = i;\n    integerLen += +numStr.slice(i + 1);\n    numStr = numStr.substring(0, i);\n  } else if (integerLen < 0) {\n    integerLen = numStr.length;\n  }\n  for (i = 0; numStr.charAt(i) === ZERO_CHAR; i++) {\n  }\n  if (i === (zeros = numStr.length)) {\n    digits = [0];\n    integerLen = 1;\n  } else {\n    zeros--;\n    while (numStr.charAt(zeros) === ZERO_CHAR) zeros--;\n    integerLen -= i;\n    digits = [];\n    for (j = 0; i <= zeros; i++, j++) {\n      digits[j] = Number(numStr.charAt(i));\n    }\n  }\n  if (integerLen > MAX_DIGITS) {\n    digits = digits.splice(0, MAX_DIGITS - 1);\n    exponent = integerLen - 1;\n    integerLen = 1;\n  }\n  return {\n    digits,\n    exponent,\n    integerLen\n  };\n}\nfunction roundNumber(parsedNumber, minFrac, maxFrac) {\n  if (minFrac > maxFrac) {\n    throw new RuntimeError(2307, ngDevMode && `The minimum number of digits after fraction (${minFrac}) is higher than the maximum (${maxFrac}).`);\n  }\n  let digits = parsedNumber.digits;\n  let fractionLen = digits.length - parsedNumber.integerLen;\n  const fractionSize = Math.min(Math.max(minFrac, fractionLen), maxFrac);\n  let roundAt = fractionSize + parsedNumber.integerLen;\n  let digit = digits[roundAt];\n  if (roundAt > 0) {\n    digits.splice(Math.max(parsedNumber.integerLen, roundAt));\n    for (let j = roundAt; j < digits.length; j++) {\n      digits[j] = 0;\n    }\n  } else {\n    fractionLen = Math.max(0, fractionLen);\n    parsedNumber.integerLen = 1;\n    digits.length = Math.max(1, roundAt = fractionSize + 1);\n    digits[0] = 0;\n    for (let i = 1; i < roundAt; i++) digits[i] = 0;\n  }\n  if (digit >= 5) {\n    if (roundAt - 1 < 0) {\n      for (let k = 0; k > roundAt; k--) {\n        digits.unshift(0);\n        parsedNumber.integerLen++;\n      }\n      digits.unshift(1);\n      parsedNumber.integerLen++;\n    } else {\n      digits[roundAt - 1]++;\n    }\n  }\n  for (; fractionLen < Math.max(0, fractionSize); fractionLen++) digits.push(0);\n  let dropTrailingZeros = fractionSize !== 0;\n  const minLen = minFrac + parsedNumber.integerLen;\n  const carry = digits.reduceRight(function(carry2, d, i, digits2) {\n    d = d + carry2;\n    digits2[i] = d < 10 ? d : d - 10;\n    if (dropTrailingZeros) {\n      if (digits2[i] === 0 && i >= minLen) {\n        digits2.pop();\n      } else {\n        dropTrailingZeros = false;\n      }\n    }\n    return d >= 10 ? 1 : 0;\n  }, 0);\n  if (carry) {\n    digits.unshift(carry);\n    parsedNumber.integerLen++;\n  }\n}\nfunction parseIntAutoRadix(text) {\n  const result = parseInt(text);\n  if (isNaN(result)) {\n    throw new RuntimeError(2305, ngDevMode && \"Invalid integer literal when parsing \" + text);\n  }\n  return result;\n}\nvar NgLocalization = class _NgLocalization {\n  static fac = function NgLocalization_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgLocalization)();\n  };\n  static prov = defineInjectable({\n    token: _NgLocalization,\n    factory: () => (() => new NgLocaleLocalization(inject(LOCALE_ID)))(),\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgLocalization, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useFactory: () => new NgLocaleLocalization(inject(LOCALE_ID))\n    }]\n  }], null, null);\n})();\nfunction getPluralCategory(value, cases, ngLocalization, locale) {\n  let key = `=${value}`;\n  if (cases.indexOf(key) > -1) {\n    return key;\n  }\n  key = ngLocalization.getPluralCategory(value, locale);\n  if (cases.indexOf(key) > -1) {\n    return key;\n  }\n  if (cases.indexOf(\"other\") > -1) {\n    return \"other\";\n  }\n  throw new RuntimeError(2308, ngDevMode && `No plural message found for value \"${value}\"`);\n}\nvar NgLocaleLocalization = class _NgLocaleLocalization extends NgLocalization {\n  locale;\n  constructor(locale) {\n    super();\n    this.locale = locale;\n  }\n  getPluralCategory(value, locale) {\n    const plural = getLocalePluralCase2(locale || this.locale)(value);\n    switch (plural) {\n      case Plural.Zero:\n        return \"zero\";\n      case Plural.One:\n        return \"one\";\n      case Plural.Two:\n        return \"two\";\n      case Plural.Few:\n        return \"few\";\n      case Plural.Many:\n        return \"many\";\n      default:\n        return \"other\";\n    }\n  }\n  static fac = function NgLocaleLocalization_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgLocaleLocalization)(inject(LOCALE_ID));\n  };\n  static prov = defineInjectable({\n    token: _NgLocaleLocalization,\n    factory: _NgLocaleLocalization.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgLocaleLocalization, [{\n    type: Injectable\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [LOCALE_ID]\n    }]\n  }], null);\n})();\nvar WS_REGEXP = /\\s+/;\nvar EMPTY_ARRAY = [];\nvar NgClass = class _NgClass {\n  _ngEl;\n  _renderer;\n  initialClasses = EMPTY_ARRAY;\n  rawClass;\n  stateMap = /* @__PURE__ */ new Map();\n  constructor(_ngEl, _renderer) {\n    this._ngEl = _ngEl;\n    this._renderer = _renderer;\n  }\n  set klass(value) {\n    this.initialClasses = value != null ? value.trim().split(WS_REGEXP) : EMPTY_ARRAY;\n  }\n  set ngClass(value) {\n    this.rawClass = typeof value === \"string\" ? value.trim().split(WS_REGEXP) : value;\n  }\n  ngDoCheck() {\n    for (const klass of this.initialClasses) {\n      this._updateState(klass, true);\n    }\n    const rawClass = this.rawClass;\n    if (Array.isArray(rawClass) || rawClass instanceof Set) {\n      for (const klass of rawClass) {\n        this._updateState(klass, true);\n      }\n    } else if (rawClass != null) {\n      for (const klass of Object.keys(rawClass)) {\n        this._updateState(klass, Boolean(rawClass[klass]));\n      }\n    }\n    this._applyStateDiff();\n  }\n  _updateState(klass, nextEnabled) {\n    const state = this.stateMap.get(klass);\n    if (state !== void 0) {\n      if (state.enabled !== nextEnabled) {\n        state.changed = true;\n        state.enabled = nextEnabled;\n      }\n      state.touched = true;\n    } else {\n      this.stateMap.set(klass, {\n        enabled: nextEnabled,\n        changed: true,\n        touched: true\n      });\n    }\n  }\n  _applyStateDiff() {\n    for (const stateEntry of this.stateMap) {\n      const klass = stateEntry[0];\n      const state = stateEntry[1];\n      if (state.changed) {\n        this._toggleClass(klass, state.enabled);\n        state.changed = false;\n      } else if (!state.touched) {\n        if (state.enabled) {\n          this._toggleClass(klass, false);\n        }\n        this.stateMap.delete(klass);\n      }\n      state.touched = false;\n    }\n  }\n  _toggleClass(klass, enabled) {\n    if (ngDevMode) {\n      if (typeof klass !== \"string\") {\n        throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${stringify(klass)}`);\n      }\n    }\n    klass = klass.trim();\n    if (klass.length > 0) {\n      klass.split(WS_REGEXP).forEach((klass2) => {\n        if (enabled) {\n          this._renderer.addClass(this._ngEl.nativeElement, klass2);\n        } else {\n          this._renderer.removeClass(this._ngEl.nativeElement, klass2);\n        }\n      });\n    }\n  }\n  static fac = function NgClass_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgClass)(directiveInject(ElementRef), directiveInject(Renderer2));\n  };\n  static dir = defineDirective({\n    type: _NgClass,\n    selectors: [[\"\", \"ngClass\", \"\"]],\n    inputs: {\n      klass: [0, \"class\", \"klass\"],\n      ngClass: \"ngClass\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgClass, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngClass]\"\n    }]\n  }], () => [{\n    type: ElementRef\n  }, {\n    type: Renderer2\n  }], {\n    klass: [{\n      type: Input,\n      args: [\"class\"]\n    }],\n    ngClass: [{\n      type: Input,\n      args: [\"ngClass\"]\n    }]\n  });\n})();\nvar NgComponentOutlet = class _NgComponentOutlet {\n  _viewContainerRef;\n  ngComponentOutlet = null;\n  ngComponentOutletInputs;\n  ngComponentOutletInjector;\n  ngComponentOutletEnvironmentInjector;\n  ngComponentOutletContent;\n  ngComponentOutletNgModule;\n  _componentRef;\n  _moduleRef;\n  _inputsUsed = /* @__PURE__ */ new Map();\n  get componentInstance() {\n    return this._componentRef?.instance ?? null;\n  }\n  constructor(_viewContainerRef) {\n    this._viewContainerRef = _viewContainerRef;\n  }\n  _needToReCreateNgModuleInstance(changes) {\n    return changes[\"ngComponentOutletNgModule\"] !== void 0;\n  }\n  _needToReCreateComponentInstance(changes) {\n    return changes[\"ngComponentOutlet\"] !== void 0 || changes[\"ngComponentOutletContent\"] !== void 0 || changes[\"ngComponentOutletInjector\"] !== void 0 || changes[\"ngComponentOutletEnvironmentInjector\"] !== void 0 || this._needToReCreateNgModuleInstance(changes);\n  }\n  ngOnChanges(changes) {\n    if (this._needToReCreateComponentInstance(changes)) {\n      this._viewContainerRef.clear();\n      this._inputsUsed.clear();\n      this._componentRef = void 0;\n      if (this.ngComponentOutlet) {\n        const injector = this.ngComponentOutletInjector || this._viewContainerRef.parentInjector;\n        if (this._needToReCreateNgModuleInstance(changes)) {\n          this._moduleRef?.destroy();\n          if (this.ngComponentOutletNgModule) {\n            this._moduleRef = createNgModule(this.ngComponentOutletNgModule, getParentInjector(injector));\n          } else {\n            this._moduleRef = void 0;\n          }\n        }\n        this._componentRef = this._viewContainerRef.createComponent(this.ngComponentOutlet, {\n          injector,\n          ngModuleRef: this._moduleRef,\n          projectableNodes: this.ngComponentOutletContent,\n          environmentInjector: this.ngComponentOutletEnvironmentInjector\n        });\n      }\n    }\n  }\n  ngDoCheck() {\n    if (this._componentRef) {\n      if (this.ngComponentOutletInputs) {\n        for (const inputName of Object.keys(this.ngComponentOutletInputs)) {\n          this._inputsUsed.set(inputName, true);\n        }\n      }\n      this._applyInputStateDiff(this._componentRef);\n    }\n  }\n  ngOnDestroy() {\n    this._moduleRef?.destroy();\n  }\n  _applyInputStateDiff(componentRef) {\n    for (const [inputName, touched] of this._inputsUsed) {\n      if (!touched) {\n        componentRef.setInput(inputName, void 0);\n        this._inputsUsed.delete(inputName);\n      } else {\n        componentRef.setInput(inputName, this.ngComponentOutletInputs[inputName]);\n        this._inputsUsed.set(inputName, false);\n      }\n    }\n  }\n  static fac = function NgComponentOutlet_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgComponentOutlet)(directiveInject(ViewContainerRef));\n  };\n  static dir = defineDirective({\n    type: _NgComponentOutlet,\n    selectors: [[\"\", \"ngComponentOutlet\", \"\"]],\n    inputs: {\n      ngComponentOutlet: \"ngComponentOutlet\",\n      ngComponentOutletInputs: \"ngComponentOutletInputs\",\n      ngComponentOutletInjector: \"ngComponentOutletInjector\",\n      ngComponentOutletEnvironmentInjector: \"ngComponentOutletEnvironmentInjector\",\n      ngComponentOutletContent: \"ngComponentOutletContent\",\n      ngComponentOutletNgModule: \"ngComponentOutletNgModule\"\n    },\n    exportAs: [\"ngComponentOutlet\"],\n    features: [NgOnChangesFeature]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgComponentOutlet, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngComponentOutlet]\",\n      exportAs: \"ngComponentOutlet\"\n    }]\n  }], () => [{\n    type: ViewContainerRef\n  }], {\n    ngComponentOutlet: [{\n      type: Input\n    }],\n    ngComponentOutletInputs: [{\n      type: Input\n    }],\n    ngComponentOutletInjector: [{\n      type: Input\n    }],\n    ngComponentOutletEnvironmentInjector: [{\n      type: Input\n    }],\n    ngComponentOutletContent: [{\n      type: Input\n    }],\n    ngComponentOutletNgModule: [{\n      type: Input\n    }]\n  });\n})();\nfunction getParentInjector(injector) {\n  const parentNgModule = injector.get(NgModuleRef$1);\n  return parentNgModule.injector;\n}\nvar NgForOfContext = class {\n  $implicit;\n  ngForOf;\n  index;\n  count;\n  constructor($implicit, ngForOf, index, count) {\n    this.$implicit = $implicit;\n    this.ngForOf = ngForOf;\n    this.index = index;\n    this.count = count;\n  }\n  get first() {\n    return this.index === 0;\n  }\n  get last() {\n    return this.index === this.count - 1;\n  }\n  get even() {\n    return this.index % 2 === 0;\n  }\n  get odd() {\n    return !this.even;\n  }\n};\nvar NgForOf = class _NgForOf {\n  _viewContainer;\n  _template;\n  _differs;\n  set ngForOf(ngForOf) {\n    this._ngForOf = ngForOf;\n    this._ngForOfDirty = true;\n  }\n  set ngForTrackBy(fn) {\n    if ((typeof ngDevMode === \"undefined\" || ngDevMode) && fn != null && typeof fn !== \"function\") {\n      console.warn(`trackBy must be a function, but received ${JSON.stringify(fn)}. See https://angular.dev/api/common/NgForOf#change-propagation for more information.`);\n    }\n    this._trackByFn = fn;\n  }\n  get ngForTrackBy() {\n    return this._trackByFn;\n  }\n  _ngForOf = null;\n  _ngForOfDirty = true;\n  _differ = null;\n  _trackByFn;\n  constructor(_viewContainer, _template, _differs) {\n    this._viewContainer = _viewContainer;\n    this._template = _template;\n    this._differs = _differs;\n  }\n  set ngForTemplate(value) {\n    if (value) {\n      this._template = value;\n    }\n  }\n  ngDoCheck() {\n    if (this._ngForOfDirty) {\n      this._ngForOfDirty = false;\n      const value = this._ngForOf;\n      if (!this._differ && value) {\n        if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n          try {\n            this._differ = this._differs.find(value).create(this.ngForTrackBy);\n          } catch {\n            let errorMessage = `Cannot find a differ supporting object '${value}' of type '${getTypeName(value)}'. NgFor only supports binding to Iterables, such as Arrays.`;\n            if (typeof value === \"object\") {\n              errorMessage += \" Did you mean to use the keyvalue pipe?\";\n            }\n            throw new RuntimeError(-2200, errorMessage);\n          }\n        } else {\n          this._differ = this._differs.find(value).create(this.ngForTrackBy);\n        }\n      }\n    }\n    if (this._differ) {\n      const changes = this._differ.diff(this._ngForOf);\n      if (changes) this._applyChanges(changes);\n    }\n  }\n  _applyChanges(changes) {\n    const viewContainer = this._viewContainer;\n    changes.forEachOperation((item, adjustedPreviousIndex, currentIndex) => {\n      if (item.previousIndex == null) {\n        viewContainer.createEmbeddedView(this._template, new NgForOfContext(item.item, this._ngForOf, -1, -1), currentIndex === null ? void 0 : currentIndex);\n      } else if (currentIndex == null) {\n        viewContainer.remove(adjustedPreviousIndex === null ? void 0 : adjustedPreviousIndex);\n      } else if (adjustedPreviousIndex !== null) {\n        const view = viewContainer.get(adjustedPreviousIndex);\n        viewContainer.move(view, currentIndex);\n        applyViewChange(view, item);\n      }\n    });\n    for (let i = 0, ilen = viewContainer.length; i < ilen; i++) {\n      const viewRef = viewContainer.get(i);\n      const context = viewRef.context;\n      context.index = i;\n      context.count = ilen;\n      context.ngForOf = this._ngForOf;\n    }\n    changes.forEachIdentityChange((record) => {\n      const viewRef = viewContainer.get(record.currentIndex);\n      applyViewChange(viewRef, record);\n    });\n  }\n  static ngTemplateContextGuard(dir, ctx) {\n    return true;\n  }\n  static fac = function NgForOf_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgForOf)(directiveInject(ViewContainerRef), directiveInject(TemplateRef), directiveInject(IterableDiffers));\n  };\n  static dir = defineDirective({\n    type: _NgForOf,\n    selectors: [[\"\", \"ngFor\", \"\", \"ngForOf\", \"\"]],\n    inputs: {\n      ngForOf: \"ngForOf\",\n      ngForTrackBy: \"ngForTrackBy\",\n      ngForTemplate: \"ngForTemplate\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgForOf, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngFor][ngForOf]\"\n    }]\n  }], () => [{\n    type: ViewContainerRef\n  }, {\n    type: TemplateRef\n  }, {\n    type: IterableDiffers\n  }], {\n    ngForOf: [{\n      type: Input\n    }],\n    ngForTrackBy: [{\n      type: Input\n    }],\n    ngForTemplate: [{\n      type: Input\n    }]\n  });\n})();\nfunction applyViewChange(view, record) {\n  view.context.$implicit = record.item;\n}\nfunction getTypeName(type) {\n  return type[\"name\"] || typeof type;\n}\nvar NgIf = class _NgIf {\n  _viewContainer;\n  _context = new NgIfContext();\n  _thenTemplateRef = null;\n  _elseTemplateRef = null;\n  _thenViewRef = null;\n  _elseViewRef = null;\n  constructor(_viewContainer, templateRef) {\n    this._viewContainer = _viewContainer;\n    this._thenTemplateRef = templateRef;\n  }\n  set ngIf(condition) {\n    this._context.$implicit = this._context.ngIf = condition;\n    this._updateView();\n  }\n  set ngIfThen(templateRef) {\n    assertTemplate(templateRef, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"ngIfThen\");\n    this._thenTemplateRef = templateRef;\n    this._thenViewRef = null;\n    this._updateView();\n  }\n  set ngIfElse(templateRef) {\n    assertTemplate(templateRef, (typeof ngDevMode === \"undefined\" || ngDevMode) && \"ngIfElse\");\n    this._elseTemplateRef = templateRef;\n    this._elseViewRef = null;\n    this._updateView();\n  }\n  _updateView() {\n    if (this._context.$implicit) {\n      if (!this._thenViewRef) {\n        this._viewContainer.clear();\n        this._elseViewRef = null;\n        if (this._thenTemplateRef) {\n          this._thenViewRef = this._viewContainer.createEmbeddedView(this._thenTemplateRef, this._context);\n        }\n      }\n    } else {\n      if (!this._elseViewRef) {\n        this._viewContainer.clear();\n        this._thenViewRef = null;\n        if (this._elseTemplateRef) {\n          this._elseViewRef = this._viewContainer.createEmbeddedView(this._elseTemplateRef, this._context);\n        }\n      }\n    }\n  }\n  static ngIfUseIfTypeGuard;\n  static ngTemplateGuard_ngIf;\n  static ngTemplateContextGuard(dir, ctx) {\n    return true;\n  }\n  static fac = function NgIf_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgIf)(directiveInject(ViewContainerRef), directiveInject(TemplateRef));\n  };\n  static dir = defineDirective({\n    type: _NgIf,\n    selectors: [[\"\", \"ngIf\", \"\"]],\n    inputs: {\n      ngIf: \"ngIf\",\n      ngIfThen: \"ngIfThen\",\n      ngIfElse: \"ngIfElse\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgIf, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngIf]\"\n    }]\n  }], () => [{\n    type: ViewContainerRef\n  }, {\n    type: TemplateRef\n  }], {\n    ngIf: [{\n      type: Input\n    }],\n    ngIfThen: [{\n      type: Input\n    }],\n    ngIfElse: [{\n      type: Input\n    }]\n  });\n})();\nvar NgIfContext = class {\n  $implicit = null;\n  ngIf = null;\n};\nfunction assertTemplate(templateRef, property) {\n  if (templateRef && !templateRef.createEmbeddedView) {\n    throw new RuntimeError(2020, (typeof ngDevMode === \"undefined\" || ngDevMode) && `${property} must be a TemplateRef, but received '${stringify(templateRef)}'.`);\n  }\n}\nvar SwitchView = class {\n  _viewContainerRef;\n  _templateRef;\n  _created = false;\n  constructor(_viewContainerRef, _templateRef) {\n    this._viewContainerRef = _viewContainerRef;\n    this._templateRef = _templateRef;\n  }\n  create() {\n    this._created = true;\n    this._viewContainerRef.createEmbeddedView(this._templateRef);\n  }\n  destroy() {\n    this._created = false;\n    this._viewContainerRef.clear();\n  }\n  enforceState(created) {\n    if (created && !this._created) {\n      this.create();\n    } else if (!created && this._created) {\n      this.destroy();\n    }\n  }\n};\nvar NgSwitch = class _NgSwitch {\n  _defaultViews = [];\n  _defaultUsed = false;\n  _caseCount = 0;\n  _lastCaseCheckIndex = 0;\n  _lastCasesMatched = false;\n  _ngSwitch;\n  set ngSwitch(newValue) {\n    this._ngSwitch = newValue;\n    if (this._caseCount === 0) {\n      this._updateDefaultCases(true);\n    }\n  }\n  _addCase() {\n    return this._caseCount++;\n  }\n  _addDefault(view) {\n    this._defaultViews.push(view);\n  }\n  _matchCase(value) {\n    const matched = value === this._ngSwitch;\n    this._lastCasesMatched ||= matched;\n    this._lastCaseCheckIndex++;\n    if (this._lastCaseCheckIndex === this._caseCount) {\n      this._updateDefaultCases(!this._lastCasesMatched);\n      this._lastCaseCheckIndex = 0;\n      this._lastCasesMatched = false;\n    }\n    return matched;\n  }\n  _updateDefaultCases(useDefault) {\n    if (this._defaultViews.length > 0 && useDefault !== this._defaultUsed) {\n      this._defaultUsed = useDefault;\n      for (const defaultView of this._defaultViews) {\n        defaultView.enforceState(useDefault);\n      }\n    }\n  }\n  static fac = function NgSwitch_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgSwitch)();\n  };\n  static dir = defineDirective({\n    type: _NgSwitch,\n    selectors: [[\"\", \"ngSwitch\", \"\"]],\n    inputs: {\n      ngSwitch: \"ngSwitch\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgSwitch, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngSwitch]\"\n    }]\n  }], null, {\n    ngSwitch: [{\n      type: Input\n    }]\n  });\n})();\nvar NgSwitchCase = class _NgSwitchCase {\n  ngSwitch;\n  _view;\n  ngSwitchCase;\n  constructor(viewContainer, templateRef, ngSwitch) {\n    this.ngSwitch = ngSwitch;\n    if ((typeof ngDevMode === \"undefined\" || ngDevMode) && !ngSwitch) {\n      throwNgSwitchProviderNotFoundError(\"ngSwitchCase\", \"NgSwitchCase\");\n    }\n    ngSwitch._addCase();\n    this._view = new SwitchView(viewContainer, templateRef);\n  }\n  ngDoCheck() {\n    this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase));\n  }\n  static fac = function NgSwitchCase_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgSwitchCase)(directiveInject(ViewContainerRef), directiveInject(TemplateRef), directiveInject(NgSwitch, 9));\n  };\n  static dir = defineDirective({\n    type: _NgSwitchCase,\n    selectors: [[\"\", \"ngSwitchCase\", \"\"]],\n    inputs: {\n      ngSwitchCase: \"ngSwitchCase\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgSwitchCase, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngSwitchCase]\"\n    }]\n  }], () => [{\n    type: ViewContainerRef\n  }, {\n    type: TemplateRef\n  }, {\n    type: NgSwitch,\n    decorators: [{\n      type: Optional\n    }, {\n      type: Host\n    }]\n  }], {\n    ngSwitchCase: [{\n      type: Input\n    }]\n  });\n})();\nvar NgSwitchDefault = class _NgSwitchDefault {\n  constructor(viewContainer, templateRef, ngSwitch) {\n    if ((typeof ngDevMode === \"undefined\" || ngDevMode) && !ngSwitch) {\n      throwNgSwitchProviderNotFoundError(\"ngSwitchDefault\", \"NgSwitchDefault\");\n    }\n    ngSwitch._addDefault(new SwitchView(viewContainer, templateRef));\n  }\n  static fac = function NgSwitchDefault_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgSwitchDefault)(directiveInject(ViewContainerRef), directiveInject(TemplateRef), directiveInject(NgSwitch, 9));\n  };\n  static dir = defineDirective({\n    type: _NgSwitchDefault,\n    selectors: [[\"\", \"ngSwitchDefault\", \"\"]]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgSwitchDefault, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngSwitchDefault]\"\n    }]\n  }], () => [{\n    type: ViewContainerRef\n  }, {\n    type: TemplateRef\n  }, {\n    type: NgSwitch,\n    decorators: [{\n      type: Optional\n    }, {\n      type: Host\n    }]\n  }], null);\n})();\nfunction throwNgSwitchProviderNotFoundError(attrName, directiveName) {\n  throw new RuntimeError(2e3, `An element with the \"${attrName}\" attribute (matching the \"${directiveName}\" directive) must be located inside an element with the \"ngSwitch\" attribute (matching \"NgSwitch\" directive)`);\n}\nvar NgPlural = class _NgPlural {\n  _localization;\n  _activeView;\n  _caseViews = {};\n  constructor(_localization) {\n    this._localization = _localization;\n  }\n  set ngPlural(value) {\n    this._updateView(value);\n  }\n  addCase(value, switchView) {\n    this._caseViews[value] = switchView;\n  }\n  _updateView(switchValue) {\n    this._clearViews();\n    const cases = Object.keys(this._caseViews);\n    const key = getPluralCategory(switchValue, cases, this._localization);\n    this._activateView(this._caseViews[key]);\n  }\n  _clearViews() {\n    if (this._activeView) this._activeView.destroy();\n  }\n  _activateView(view) {\n    if (view) {\n      this._activeView = view;\n      this._activeView.create();\n    }\n  }\n  static fac = function NgPlural_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgPlural)(directiveInject(NgLocalization));\n  };\n  static dir = defineDirective({\n    type: _NgPlural,\n    selectors: [[\"\", \"ngPlural\", \"\"]],\n    inputs: {\n      ngPlural: \"ngPlural\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgPlural, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngPlural]\"\n    }]\n  }], () => [{\n    type: NgLocalization\n  }], {\n    ngPlural: [{\n      type: Input\n    }]\n  });\n})();\nvar NgPluralCase = class _NgPluralCase {\n  value;\n  constructor(value, template, viewContainer, ngPlural) {\n    this.value = value;\n    const isANumber = !isNaN(Number(value));\n    ngPlural.addCase(isANumber ? `=${value}` : value, new SwitchView(viewContainer, template));\n  }\n  static fac = function NgPluralCase_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgPluralCase)(injectAttribute(\"ngPluralCase\"), directiveInject(TemplateRef), directiveInject(ViewContainerRef), directiveInject(NgPlural, 1));\n  };\n  static dir = defineDirective({\n    type: _NgPluralCase,\n    selectors: [[\"\", \"ngPluralCase\", \"\"]]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgPluralCase, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngPluralCase]\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Attribute,\n      args: [\"ngPluralCase\"]\n    }]\n  }, {\n    type: TemplateRef\n  }, {\n    type: ViewContainerRef\n  }, {\n    type: NgPlural,\n    decorators: [{\n      type: Host\n    }]\n  }], null);\n})();\nvar NgStyle = class _NgStyle {\n  _ngEl;\n  _differs;\n  _renderer;\n  _ngStyle = null;\n  _differ = null;\n  constructor(_ngEl, _differs, _renderer) {\n    this._ngEl = _ngEl;\n    this._differs = _differs;\n    this._renderer = _renderer;\n  }\n  set ngStyle(values) {\n    this._ngStyle = values;\n    if (!this._differ && values) {\n      this._differ = this._differs.find(values).create();\n    }\n  }\n  ngDoCheck() {\n    if (this._differ) {\n      const changes = this._differ.diff(this._ngStyle);\n      if (changes) {\n        this._applyChanges(changes);\n      }\n    }\n  }\n  _setStyle(nameAndUnit, value) {\n    const [name, unit] = nameAndUnit.split(\".\");\n    const flags = name.indexOf(\"-\") === -1 ? void 0 : RendererStyleFlags2.DashCase;\n    if (value != null) {\n      this._renderer.setStyle(this._ngEl.nativeElement, name, unit ? `${value}${unit}` : value, flags);\n    } else {\n      this._renderer.removeStyle(this._ngEl.nativeElement, name, flags);\n    }\n  }\n  _applyChanges(changes) {\n    changes.forEachRemovedItem((record) => this._setStyle(record.key, null));\n    changes.forEachAddedItem((record) => this._setStyle(record.key, record.currentValue));\n    changes.forEachChangedItem((record) => this._setStyle(record.key, record.currentValue));\n  }\n  static fac = function NgStyle_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgStyle)(directiveInject(ElementRef), directiveInject(KeyValueDiffers), directiveInject(Renderer2));\n  };\n  static dir = defineDirective({\n    type: _NgStyle,\n    selectors: [[\"\", \"ngStyle\", \"\"]],\n    inputs: {\n      ngStyle: \"ngStyle\"\n    }\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgStyle, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngStyle]\"\n    }]\n  }], () => [{\n    type: ElementRef\n  }, {\n    type: KeyValueDiffers\n  }, {\n    type: Renderer2\n  }], {\n    ngStyle: [{\n      type: Input,\n      args: [\"ngStyle\"]\n    }]\n  });\n})();\nvar NgTemplateOutlet = class _NgTemplateOutlet {\n  _viewContainerRef;\n  _viewRef = null;\n  ngTemplateOutletContext = null;\n  ngTemplateOutlet = null;\n  ngTemplateOutletInjector = null;\n  constructor(_viewContainerRef) {\n    this._viewContainerRef = _viewContainerRef;\n  }\n  ngOnChanges(changes) {\n    if (this._shouldRecreateView(changes)) {\n      const viewContainerRef = this._viewContainerRef;\n      if (this._viewRef) {\n        viewContainerRef.remove(viewContainerRef.indexOf(this._viewRef));\n      }\n      if (!this.ngTemplateOutlet) {\n        this._viewRef = null;\n        return;\n      }\n      const viewContext = this._createContextForwardProxy();\n      this._viewRef = viewContainerRef.createEmbeddedView(this.ngTemplateOutlet, viewContext, {\n        injector: this.ngTemplateOutletInjector ?? void 0\n      });\n    }\n  }\n  _shouldRecreateView(changes) {\n    return !!changes[\"ngTemplateOutlet\"] || !!changes[\"ngTemplateOutletInjector\"];\n  }\n  _createContextForwardProxy() {\n    return new Proxy({}, {\n      set: (_target, prop, newValue) => {\n        if (!this.ngTemplateOutletContext) {\n          return false;\n        }\n        return Reflect.set(this.ngTemplateOutletContext, prop, newValue);\n      },\n      get: (_target, prop, receiver) => {\n        if (!this.ngTemplateOutletContext) {\n          return void 0;\n        }\n        return Reflect.get(this.ngTemplateOutletContext, prop, receiver);\n      }\n    });\n  }\n  static fac = function NgTemplateOutlet_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgTemplateOutlet)(directiveInject(ViewContainerRef));\n  };\n  static dir = defineDirective({\n    type: _NgTemplateOutlet,\n    selectors: [[\"\", \"ngTemplateOutlet\", \"\"]],\n    inputs: {\n      ngTemplateOutletContext: \"ngTemplateOutletContext\",\n      ngTemplateOutlet: \"ngTemplateOutlet\",\n      ngTemplateOutletInjector: \"ngTemplateOutletInjector\"\n    },\n    features: [NgOnChangesFeature]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgTemplateOutlet, [{\n    type: Directive,\n    args: [{\n      selector: \"[ngTemplateOutlet]\"\n    }]\n  }], () => [{\n    type: ViewContainerRef\n  }], {\n    ngTemplateOutletContext: [{\n      type: Input\n    }],\n    ngTemplateOutlet: [{\n      type: Input\n    }],\n    ngTemplateOutletInjector: [{\n      type: Input\n    }]\n  });\n})();\nvar COMMON_DIRECTIVES = [NgClass, NgComponentOutlet, NgForOf, NgIf, NgTemplateOutlet, NgStyle, NgSwitch, NgSwitchCase, NgSwitchDefault, NgPlural, NgPluralCase];\nfunction invalidPipeArgumentError(type, value) {\n  return new RuntimeError(2100, ngDevMode && `InvalidPipeArgument: '${value}' for pipe '${stringify(type)}'`);\n}\nvar SubscribableStrategy = class {\n  createSubscription(async, updateLatestValue, onError) {\n    return untracked(() => async.subscribe({\n      next: updateLatestValue,\n      error: onError\n    }));\n  }\n  dispose(subscription) {\n    untracked(() => subscription.unsubscribe());\n  }\n};\nvar PromiseStrategy = class {\n  createSubscription(async, updateLatestValue, onError) {\n    async.then((v) => updateLatestValue?.(v), (e) => onError?.(e));\n    return {\n      unsubscribe: () => {\n        updateLatestValue = null;\n        onError = null;\n      }\n    };\n  }\n  dispose(subscription) {\n    subscription.unsubscribe();\n  }\n};\nvar _promiseStrategy = new PromiseStrategy();\nvar _subscribableStrategy = new SubscribableStrategy();\nvar AsyncPipe = class _AsyncPipe {\n  _ref;\n  _latestValue = null;\n  markForCheckOnValueUpdate = true;\n  _subscription = null;\n  _obj = null;\n  _strategy = null;\n  applicationErrorHandler = inject(INTERNAL_APPLICATION_ERROR_HANDLER);\n  constructor(ref) {\n    this._ref = ref;\n  }\n  ngOnDestroy() {\n    if (this._subscription) {\n      this._dispose();\n    }\n    this._ref = null;\n  }\n  transform(obj) {\n    if (!this._obj) {\n      if (obj) {\n        try {\n          this.markForCheckOnValueUpdate = false;\n          this._subscribe(obj);\n        } finally {\n          this.markForCheckOnValueUpdate = true;\n        }\n      }\n      return this._latestValue;\n    }\n    if (obj !== this._obj) {\n      this._dispose();\n      return this.transform(obj);\n    }\n    return this._latestValue;\n  }\n  _subscribe(obj) {\n    this._obj = obj;\n    this._strategy = this._selectStrategy(obj);\n    this._subscription = this._strategy.createSubscription(obj, (value) => this._updateLatestValue(obj, value), (e) => this.applicationErrorHandler(e));\n  }\n  _selectStrategy(obj) {\n    if (isPromise(obj)) {\n      return _promiseStrategy;\n    }\n    if (isSubscribable(obj)) {\n      return _subscribableStrategy;\n    }\n    throw invalidPipeArgumentError(_AsyncPipe, obj);\n  }\n  _dispose() {\n    this._strategy.dispose(this._subscription);\n    this._latestValue = null;\n    this._subscription = null;\n    this._obj = null;\n  }\n  _updateLatestValue(async, value) {\n    if (async === this._obj) {\n      this._latestValue = value;\n      if (this.markForCheckOnValueUpdate) {\n        this._ref?.markForCheck();\n      }\n    }\n  }\n  static fac = function AsyncPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _AsyncPipe)(directiveInject(ChangeDetectorRef, 16));\n  };\n  static pipe = definePipe({\n    name: \"async\",\n    type: _AsyncPipe,\n    pure: false\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(AsyncPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"async\",\n      pure: false\n    }]\n  }], () => [{\n    type: ChangeDetectorRef\n  }], null);\n})();\nvar LowerCasePipe = class _LowerCasePipe {\n  transform(value) {\n    if (value == null) return null;\n    if (typeof value !== \"string\") {\n      throw invalidPipeArgumentError(_LowerCasePipe, value);\n    }\n    return value.toLowerCase();\n  }\n  static fac = function LowerCasePipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _LowerCasePipe)();\n  };\n  static pipe = definePipe({\n    name: \"lowercase\",\n    type: _LowerCasePipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(LowerCasePipe, [{\n    type: Pipe,\n    args: [{\n      name: \"lowercase\"\n    }]\n  }], null, null);\n})();\nvar unicodeWordMatch = /(?:[0-9A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u0870-\\u0887\\u0889-\\u088E\\u08A0-\\u08C9\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C5D\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D04-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u1711\\u171F-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1878\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4C\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CE9-\\u1CEC\\u1CEE-\\u1CF3\\u1CF5\\u1CF6\\u1CFA\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3400-\\u4DBF\\u4E00-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7CA\\uA7D0\\uA7D1\\uA7D3\\uA7D5-\\uA7D9\\uA7F2-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA8FE\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB69\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDF00-\\uDF1F\\uDF2D-\\uDF40\\uDF42-\\uDF49\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF]|\\uD801[\\uDC00-\\uDC9D\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDD70-\\uDD7A\\uDD7C-\\uDD8A\\uDD8C-\\uDD92\\uDD94\\uDD95\\uDD97-\\uDDA1\\uDDA3-\\uDDB1\\uDDB3-\\uDDB9\\uDDBB\\uDDBC\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67\\uDF80-\\uDF85\\uDF87-\\uDFB0\\uDFB2-\\uDFBA]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDD00-\\uDD23\\uDE80-\\uDEA9\\uDEB0\\uDEB1\\uDF00-\\uDF1C\\uDF27\\uDF30-\\uDF45\\uDF70-\\uDF81\\uDFB0-\\uDFC4\\uDFE0-\\uDFF6]|\\uD804[\\uDC03-\\uDC37\\uDC71\\uDC72\\uDC75\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDD03-\\uDD26\\uDD44\\uDD47\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC5F-\\uDC61\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE80-\\uDEAA\\uDEB8\\uDF00-\\uDF1A\\uDF40-\\uDF46]|\\uD806[\\uDC00-\\uDC2B\\uDCA0-\\uDCDF\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD2F\\uDD3F\\uDD41\\uDDA0-\\uDDA7\\uDDAA-\\uDDD0\\uDDE1\\uDDE3\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE89\\uDE9D\\uDEB0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD89\\uDD98\\uDEE0-\\uDEF2\\uDFB0]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC80-\\uDD43]|\\uD80B[\\uDF90-\\uDFF0]|[\\uD80C\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE70-\\uDEBE\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDE40-\\uDE7F\\uDF00-\\uDF4A\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1\\uDFE3]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDD00-\\uDD08]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD82C[\\uDC00-\\uDD22\\uDD50-\\uDD52\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB]|\\uD837[\\uDF00-\\uDF1E]|\\uD838[\\uDD00-\\uDD2C\\uDD37-\\uDD3D\\uDD4E\\uDE90-\\uDEAD\\uDEC0-\\uDEEB]|\\uD839[\\uDFE0-\\uDFE6\\uDFE8-\\uDFEB\\uDFED\\uDFEE\\uDFF0-\\uDFFE]|\\uD83A[\\uDC00-\\uDCC4\\uDD00-\\uDD43\\uDD4B]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF38\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])\\S*/g;\nvar TitleCasePipe = class _TitleCasePipe {\n  transform(value) {\n    if (value == null) return null;\n    if (typeof value !== \"string\") {\n      throw invalidPipeArgumentError(_TitleCasePipe, value);\n    }\n    return value.replace(unicodeWordMatch, (txt) => txt[0].toUpperCase() + txt.slice(1).toLowerCase());\n  }\n  static fac = function TitleCasePipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _TitleCasePipe)();\n  };\n  static pipe = definePipe({\n    name: \"titlecase\",\n    type: _TitleCasePipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(TitleCasePipe, [{\n    type: Pipe,\n    args: [{\n      name: \"titlecase\"\n    }]\n  }], null, null);\n})();\nvar UpperCasePipe = class _UpperCasePipe {\n  transform(value) {\n    if (value == null) return null;\n    if (typeof value !== \"string\") {\n      throw invalidPipeArgumentError(_UpperCasePipe, value);\n    }\n    return value.toUpperCase();\n  }\n  static fac = function UpperCasePipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _UpperCasePipe)();\n  };\n  static pipe = definePipe({\n    name: \"uppercase\",\n    type: _UpperCasePipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(UpperCasePipe, [{\n    type: Pipe,\n    args: [{\n      name: \"uppercase\"\n    }]\n  }], null, null);\n})();\nvar DEFAULT_DATE_FORMAT = \"mediumDate\";\nvar DATE_PIPE_DEFAULT_TIMEZONE = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"DATE_PIPE_DEFAULT_TIMEZONE\" : \"\");\nvar DATE_PIPE_DEFAULT_OPTIONS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"DATE_PIPE_DEFAULT_OPTIONS\" : \"\");\nvar DatePipe = class _DatePipe {\n  locale;\n  defaultTimezone;\n  defaultOptions;\n  constructor(locale, defaultTimezone, defaultOptions) {\n    this.locale = locale;\n    this.defaultTimezone = defaultTimezone;\n    this.defaultOptions = defaultOptions;\n  }\n  transform(value, format, timezone, locale) {\n    if (value == null || value === \"\" || value !== value) return null;\n    try {\n      const _format = format ?? this.defaultOptions?.dateFormat ?? DEFAULT_DATE_FORMAT;\n      const _timezone = timezone ?? this.defaultOptions?.timezone ?? this.defaultTimezone ?? void 0;\n      return formatDate(value, _format, locale || this.locale, _timezone);\n    } catch (error) {\n      throw invalidPipeArgumentError(_DatePipe, error.message);\n    }\n  }\n  static fac = function DatePipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DatePipe)(directiveInject(LOCALE_ID, 16), directiveInject(DATE_PIPE_DEFAULT_TIMEZONE, 24), directiveInject(DATE_PIPE_DEFAULT_OPTIONS, 24));\n  };\n  static pipe = definePipe({\n    name: \"date\",\n    type: _DatePipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DatePipe, [{\n    type: Pipe,\n    args: [{\n      name: \"date\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [LOCALE_ID]\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DATE_PIPE_DEFAULT_TIMEZONE]\n    }, {\n      type: Optional\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DATE_PIPE_DEFAULT_OPTIONS]\n    }, {\n      type: Optional\n    }]\n  }], null);\n})();\nvar _INTERPOLATION_REGEXP = /#/g;\nvar I18nPluralPipe = class _I18nPluralPipe {\n  _localization;\n  constructor(_localization) {\n    this._localization = _localization;\n  }\n  transform(value, pluralMap, locale) {\n    if (value == null) return \"\";\n    if (typeof pluralMap !== \"object\" || pluralMap === null) {\n      throw invalidPipeArgumentError(_I18nPluralPipe, pluralMap);\n    }\n    const key = getPluralCategory(value, Object.keys(pluralMap), this._localization, locale);\n    return pluralMap[key].replace(_INTERPOLATION_REGEXP, value.toString());\n  }\n  static fac = function I18nPluralPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _I18nPluralPipe)(directiveInject(NgLocalization, 16));\n  };\n  static pipe = definePipe({\n    name: \"i18nPlural\",\n    type: _I18nPluralPipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(I18nPluralPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"i18nPlural\"\n    }]\n  }], () => [{\n    type: NgLocalization\n  }], null);\n})();\nvar I18nSelectPipe = class _I18nSelectPipe {\n  transform(value, mapping) {\n    if (value == null) return \"\";\n    if (typeof mapping !== \"object\" || typeof value !== \"string\") {\n      throw invalidPipeArgumentError(_I18nSelectPipe, mapping);\n    }\n    if (mapping.hasOwnProperty(value)) {\n      return mapping[value];\n    }\n    if (mapping.hasOwnProperty(\"other\")) {\n      return mapping[\"other\"];\n    }\n    return \"\";\n  }\n  static fac = function I18nSelectPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _I18nSelectPipe)();\n  };\n  static pipe = definePipe({\n    name: \"i18nSelect\",\n    type: _I18nSelectPipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(I18nSelectPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"i18nSelect\"\n    }]\n  }], null, null);\n})();\nvar JsonPipe = class _JsonPipe {\n  transform(value) {\n    return JSON.stringify(value, null, 2);\n  }\n  static fac = function JsonPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _JsonPipe)();\n  };\n  static pipe = definePipe({\n    name: \"json\",\n    type: _JsonPipe,\n    pure: false\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(JsonPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"json\",\n      pure: false\n    }]\n  }], null, null);\n})();\nfunction makeKeyValuePair(key, value) {\n  return {\n    key,\n    value\n  };\n}\nvar KeyValuePipe = class _KeyValuePipe {\n  differs;\n  constructor(differs) {\n    this.differs = differs;\n  }\n  differ;\n  keyValues = [];\n  compareFn = defaultComparator;\n  transform(input, compareFn = defaultComparator) {\n    if (!input || !(input instanceof Map) && typeof input !== \"object\") {\n      return null;\n    }\n    this.differ ??= this.differs.find(input).create();\n    const differChanges = this.differ.diff(input);\n    const compareFnChanged = compareFn !== this.compareFn;\n    if (differChanges) {\n      this.keyValues = [];\n      differChanges.forEachItem((r) => {\n        this.keyValues.push(makeKeyValuePair(r.key, r.currentValue));\n      });\n    }\n    if (differChanges || compareFnChanged) {\n      if (compareFn) {\n        this.keyValues.sort(compareFn);\n      }\n      this.compareFn = compareFn;\n    }\n    return this.keyValues;\n  }\n  static fac = function KeyValuePipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _KeyValuePipe)(directiveInject(KeyValueDiffers, 16));\n  };\n  static pipe = definePipe({\n    name: \"keyvalue\",\n    type: _KeyValuePipe,\n    pure: false\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(KeyValuePipe, [{\n    type: Pipe,\n    args: [{\n      name: \"keyvalue\",\n      pure: false\n    }]\n  }], () => [{\n    type: KeyValueDiffers\n  }], null);\n})();\nfunction defaultComparator(keyValueA, keyValueB) {\n  const a = keyValueA.key;\n  const b = keyValueB.key;\n  if (a === b) return 0;\n  if (a == null) return 1;\n  if (b == null) return -1;\n  if (typeof a == \"string\" && typeof b == \"string\") {\n    return a < b ? -1 : 1;\n  }\n  if (typeof a == \"number\" && typeof b == \"number\") {\n    return a - b;\n  }\n  if (typeof a == \"boolean\" && typeof b == \"boolean\") {\n    return a < b ? -1 : 1;\n  }\n  const aString = String(a);\n  const bString = String(b);\n  return aString == bString ? 0 : aString < bString ? -1 : 1;\n}\nvar DecimalPipe = class _DecimalPipe {\n  _locale;\n  constructor(_locale) {\n    this._locale = _locale;\n  }\n  transform(value, digitsInfo, locale) {\n    if (!isValue(value)) return null;\n    locale ||= this._locale;\n    try {\n      const num = strToNumber(value);\n      return formatNumber(num, locale, digitsInfo);\n    } catch (error) {\n      throw invalidPipeArgumentError(_DecimalPipe, error.message);\n    }\n  }\n  static fac = function DecimalPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _DecimalPipe)(directiveInject(LOCALE_ID, 16));\n  };\n  static pipe = definePipe({\n    name: \"number\",\n    type: _DecimalPipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(DecimalPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"number\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [LOCALE_ID]\n    }]\n  }], null);\n})();\nvar PercentPipe = class _PercentPipe {\n  _locale;\n  constructor(_locale) {\n    this._locale = _locale;\n  }\n  transform(value, digitsInfo, locale) {\n    if (!isValue(value)) return null;\n    locale ||= this._locale;\n    try {\n      const num = strToNumber(value);\n      return formatPercent(num, locale, digitsInfo);\n    } catch (error) {\n      throw invalidPipeArgumentError(_PercentPipe, error.message);\n    }\n  }\n  static fac = function PercentPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PercentPipe)(directiveInject(LOCALE_ID, 16));\n  };\n  static pipe = definePipe({\n    name: \"percent\",\n    type: _PercentPipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PercentPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"percent\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [LOCALE_ID]\n    }]\n  }], null);\n})();\nvar CurrencyPipe = class _CurrencyPipe {\n  _locale;\n  _defaultCurrencyCode;\n  constructor(_locale, _defaultCurrencyCode = \"USD\") {\n    this._locale = _locale;\n    this._defaultCurrencyCode = _defaultCurrencyCode;\n  }\n  transform(value, currencyCode = this._defaultCurrencyCode, display = \"symbol\", digitsInfo, locale) {\n    if (!isValue(value)) return null;\n    locale ||= this._locale;\n    if (typeof display === \"boolean\") {\n      if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n        console.warn(`Warning: the currency pipe has been changed in Angular v5. The symbolDisplay option (third parameter) is now a string instead of a boolean. The accepted values are \"code\", \"symbol\" or \"symbol-narrow\".`);\n      }\n      display = display ? \"symbol\" : \"code\";\n    }\n    let currency = currencyCode || this._defaultCurrencyCode;\n    if (display !== \"code\") {\n      if (display === \"symbol\" || display === \"symbol-narrow\") {\n        currency = getCurrencySymbol(currency, display === \"symbol\" ? \"wide\" : \"narrow\", locale);\n      } else {\n        currency = display;\n      }\n    }\n    try {\n      const num = strToNumber(value);\n      return formatCurrency(num, locale, currency, currencyCode, digitsInfo);\n    } catch (error) {\n      throw invalidPipeArgumentError(_CurrencyPipe, error.message);\n    }\n  }\n  static fac = function CurrencyPipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _CurrencyPipe)(directiveInject(LOCALE_ID, 16), directiveInject(DEFAULT_CURRENCY_CODE, 16));\n  };\n  static pipe = definePipe({\n    name: \"currency\",\n    type: _CurrencyPipe,\n    pure: true\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(CurrencyPipe, [{\n    type: Pipe,\n    args: [{\n      name: \"currency\"\n    }]\n  }], () => [{\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [LOCALE_ID]\n    }]\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DEFAULT_CURRENCY_CODE]\n    }]\n  }], null);\n})();\nfunction isValue(value) {\n  return !(value == null || value === \"\" || value !== value);\n}\nfunction strToNumber(value) {\n  if (typeof value === \"string\" && !isNaN(Number(value) - parseFloat(value))) {\n    return Number(value);\n  }\n  if (typeof value !== \"number\") {\n    throw new RuntimeError(2309, ngDevMode && `${value} is not a number`);\n  }\n  return value;\n}\nvar SlicePipe = class _SlicePipe {\n  transform(value, start, end) {\n    if (value == null) return null;\n    const supports = typeof value === \"string\" || Array.isArray(value);\n    if (!supports) {\n      throw invalidPipeArgumentError(_SlicePipe, value);\n    }\n    return value.slice(start, end);\n  }\n  static fac = function SlicePipe_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _SlicePipe)();\n  };\n  static pipe = definePipe({\n    name: \"slice\",\n    type: _SlicePipe,\n    pure: false\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(SlicePipe, [{\n    type: Pipe,\n    args: [{\n      name: \"slice\",\n      pure: false\n    }]\n  }], null, null);\n})();\nvar COMMON_PIPES = [AsyncPipe, UpperCasePipe, LowerCasePipe, JsonPipe, SlicePipe, DecimalPipe, PercentPipe, TitleCasePipe, CurrencyPipe, DatePipe, I18nPluralPipe, I18nSelectPipe, KeyValuePipe];\nvar CommonModule = class _CommonModule {\n  static fac = function CommonModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _CommonModule)();\n  };\n  static mod = defineNgModule({\n    type: _CommonModule,\n    imports: [NgClass, NgComponentOutlet, NgForOf, NgIf, NgTemplateOutlet, NgStyle, NgSwitch, NgSwitchCase, NgSwitchDefault, NgPlural, NgPluralCase, AsyncPipe, UpperCasePipe, LowerCasePipe, JsonPipe, SlicePipe, DecimalPipe, PercentPipe, TitleCasePipe, CurrencyPipe, DatePipe, I18nPluralPipe, I18nSelectPipe, KeyValuePipe],\n    exports: [NgClass, NgComponentOutlet, NgForOf, NgIf, NgTemplateOutlet, NgStyle, NgSwitch, NgSwitchCase, NgSwitchDefault, NgPlural, NgPluralCase, AsyncPipe, UpperCasePipe, LowerCasePipe, JsonPipe, SlicePipe, DecimalPipe, PercentPipe, TitleCasePipe, CurrencyPipe, DatePipe, I18nPluralPipe, I18nSelectPipe, KeyValuePipe]\n  });\n  static inj = defineInjector({});\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(CommonModule, [{\n    type: NgModule,\n    args: [{\n      imports: [COMMON_DIRECTIVES, COMMON_PIPES],\n      exports: [COMMON_DIRECTIVES, COMMON_PIPES]\n    }]\n  }], null, null);\n})();\n\n// node_modules/@angular/common/fesm2022/_platform_navigation-chunk.mjs\nvar PRECOMMIT_HANDLER_SUPPORTED = new InjectionToken(\"\", {\n  factory: () => {\n    return typeof window !== \"undefined\" && typeof window.NavigationPrecommitController !== \"undefined\";\n  }\n});\nvar PlatformNavigation = class _PlatformNavigation {\n  static fac = function PlatformNavigation_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PlatformNavigation)();\n  };\n  static prov = defineInjectable({\n    token: _PlatformNavigation,\n    factory: () => (() => window.navigation)(),\n    providedIn: \"platform\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PlatformNavigation, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"platform\",\n      useFactory: () => window.navigation\n    }]\n  }], null, null);\n})();\n\n// node_modules/@angular/common/fesm2022/common.mjs\nvar NavigationAdapterForLocation = class _NavigationAdapterForLocation extends Location {\n  navigation = inject(PlatformNavigation);\n  destroyRef = inject(DestroyRef);\n  constructor() {\n    super(inject(LocationStrategy));\n    this.registerNavigationListeners();\n  }\n  registerNavigationListeners() {\n    const currentEntryChangeListener = () => {\n      this._notifyUrlChangeListeners(this.path(true), this.getState());\n    };\n    this.navigation.addEventListener(\"currententrychange\", currentEntryChangeListener);\n    this.destroyRef.onDestroy(() => {\n      this.navigation.removeEventListener(\"currententrychange\", currentEntryChangeListener);\n    });\n  }\n  getState() {\n    return this.navigation.currentEntry?.getState();\n  }\n  replaceState(path, query = \"\", state = null) {\n    const url = this.prepareExternalUrl(path + normalizeQueryParams(query));\n    this.navigation.navigate(url, {\n      state,\n      history: \"replace\"\n    });\n  }\n  go(path, query = \"\", state = null) {\n    const url = this.prepareExternalUrl(path + normalizeQueryParams(query));\n    this.navigation.navigate(url, {\n      state,\n      history: \"push\"\n    });\n  }\n  back() {\n    this.navigation.back();\n  }\n  forward() {\n    this.navigation.forward();\n  }\n  onUrlChange(fn) {\n    this._urlChangeListeners.push(fn);\n    return () => {\n      const fnIndex = this._urlChangeListeners.indexOf(fn);\n      this._urlChangeListeners.splice(fnIndex, 1);\n    };\n  }\n  static fac = function NavigationAdapterForLocation_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NavigationAdapterForLocation)();\n  };\n  static prov = defineInjectable({\n    token: _NavigationAdapterForLocation,\n    factory: _NavigationAdapterForLocation.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NavigationAdapterForLocation, [{\n    type: Injectable\n  }], () => [], null);\n})();\nfunction registerLocaleData2(data, localeId, extraData) {\n  return registerLocaleData(data, localeId, extraData);\n}\nvar PLATFORM_BROWSER_ID = \"browser\";\nvar PLATFORM_SERVER_ID = \"server\";\nfunction isPlatformBrowser(platformId) {\n  return platformId === PLATFORM_BROWSER_ID;\n}\nfunction isPlatformServer(platformId) {\n  return platformId === PLATFORM_SERVER_ID;\n}\nvar VERSION = new Version(\"21.1.3\");\nvar ViewportScroller = class _ViewportScroller {\n  static prov = defineInjectable({\n    token: _ViewportScroller,\n    providedIn: \"root\",\n    factory: () => false ? new NullViewportScroller() : new BrowserViewportScroller(inject(DOCUMENT), window)\n  });\n};\nvar BrowserViewportScroller = class {\n  document;\n  window;\n  offset = () => [0, 0];\n  constructor(document, window2) {\n    this.document = document;\n    this.window = window2;\n  }\n  setOffset(offset) {\n    if (Array.isArray(offset)) {\n      this.offset = () => offset;\n    } else {\n      this.offset = offset;\n    }\n  }\n  getScrollPosition() {\n    return [this.window.scrollX, this.window.scrollY];\n  }\n  scrollToPosition(position, options) {\n    this.window.scrollTo(__spreadProps(__spreadValues({}, options), {\n      left: position[0],\n      top: position[1]\n    }));\n  }\n  scrollToAnchor(target, options) {\n    const elSelected = findAnchorFromDocument(this.document, target);\n    if (elSelected) {\n      this.scrollToElement(elSelected, options);\n      elSelected.focus();\n    }\n  }\n  setHistoryScrollRestoration(scrollRestoration) {\n    try {\n      this.window.history.scrollRestoration = scrollRestoration;\n    } catch {\n      console.warn(formatRuntimeError(2400, ngDevMode && \"Failed to set `window.history.scrollRestoration`. This may occur when:\\n The script is running inside a sandboxed iframe\\n The window is partially navigated or inactive\\n The script is executed in an untrusted or special context (e.g., test runners, browser extensions, or content previews)\\nScroll position may not be preserved across navigation.\"));\n    }\n  }\n  scrollToElement(el, options) {\n    const rect = el.getBoundingClientRect();\n    const left = rect.left + this.window.pageXOffset;\n    const top = rect.top + this.window.pageYOffset;\n    const offset = this.offset();\n    this.window.scrollTo(__spreadProps(__spreadValues({}, options), {\n      left: left - offset[0],\n      top: top - offset[1]\n    }));\n  }\n};\nfunction findAnchorFromDocument(document, target) {\n  const documentResult = document.getElementById(target) || document.getElementsByName(target)[0];\n  if (documentResult) {\n    return documentResult;\n  }\n  if (typeof document.createTreeWalker === \"function\" && document.body && typeof document.body.attachShadow === \"function\") {\n    const treeWalker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT);\n    let currentNode = treeWalker.currentNode;\n    while (currentNode) {\n      const shadowRoot = currentNode.shadowRoot;\n      if (shadowRoot) {\n        const result = shadowRoot.getElementById(target) || shadowRoot.querySelector(`[name=\"${target}\"]`);\n        if (result) {\n          return result;\n        }\n      }\n      currentNode = treeWalker.nextNode();\n    }\n  }\n  return null;\n}\nvar NullViewportScroller = class {\n  setOffset(offset) {\n  }\n  getScrollPosition() {\n    return [0, 0];\n  }\n  scrollToPosition(position) {\n  }\n  scrollToAnchor(anchor) {\n  }\n  setHistoryScrollRestoration(scrollRestoration) {\n  }\n};\nvar PLACEHOLDER_QUALITY = \"20\";\nfunction getUrl(src, win) {\n  return isAbsoluteUrl(src) ? new URL(src) : new URL(src, win.location.href);\n}\nfunction isAbsoluteUrl(src) {\n  return /^https?:\\/\\//.test(src);\n}\nfunction extractHostname(url) {\n  return isAbsoluteUrl(url) ? new URL(url).hostname : url;\n}\nfunction isValidPath(path) {\n  const isString = typeof path === \"string\";\n  if (!isString || path.trim() === \"\") {\n    return false;\n  }\n  try {\n    const url = new URL(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\nfunction normalizePath(path) {\n  return path.endsWith(\"/\") ? path.slice(0, -1) : path;\n}\nfunction normalizeSrc(src) {\n  return src.startsWith(\"/\") ? src.slice(1) : src;\n}\nvar noopImageLoader = (config) => config.src;\nvar IMAGE_LOADER = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"ImageLoader\" : \"\", {\n  factory: () => noopImageLoader\n});\nfunction createImageLoader(buildUrlFn, exampleUrls) {\n  return function provideImageLoader(path) {\n    if (!isValidPath(path)) {\n      throwInvalidPathError(path, exampleUrls || []);\n    }\n    path = normalizePath(path);\n    const loaderFn = (config) => {\n      if (isAbsoluteUrl(config.src)) {\n        throwUnexpectedAbsoluteUrlError(path, config.src);\n      }\n      return buildUrlFn(path, __spreadProps(__spreadValues({}, config), {\n        src: normalizeSrc(config.src)\n      }));\n    };\n    const providers = [{\n      provide: IMAGE_LOADER,\n      useValue: loaderFn\n    }];\n    return providers;\n  };\n}\nfunction throwInvalidPathError(path, exampleUrls) {\n  throw new RuntimeError(2959, ngDevMode && `Image loader has detected an invalid path (\\`${path}\\`). To fix this, supply a path using one of the following formats: ${exampleUrls.join(\" or \")}`);\n}\nfunction throwUnexpectedAbsoluteUrlError(path, url) {\n  throw new RuntimeError(2959, ngDevMode && `Image loader has detected a \\`<img>\\` tag with an invalid \\`ngSrc\\` attribute: ${url}. This image loader expects \\`ngSrc\\` to be a relative URL - however the provided value is an absolute URL. To fix this, provide \\`ngSrc\\` as a path relative to the base URL configured for this loader (\\`${path}\\`).`);\n}\nfunction normalizeLoaderTransform(transform, separator) {\n  if (typeof transform === \"string\") {\n    return transform;\n  }\n  return Object.entries(transform).map(([key, value]) => `${key}${separator}${value}`).join(\",\");\n}\nvar provideCloudflareLoader = createImageLoader(createCloudflareUrl, ngDevMode ? [\"https://<ZONE>/cdn-cgi/image/<OPTIONS>/<SOURCE-IMAGE>\"] : void 0);\nfunction createCloudflareUrl(path, config) {\n  let params = `format=auto`;\n  if (config.width) {\n    params += `,width=${config.width}`;\n  }\n  if (config.isPlaceholder) {\n    params += `,quality=${PLACEHOLDER_QUALITY}`;\n  }\n  if (config.loaderParams?.[\"transform\"]) {\n    const transformStr = normalizeLoaderTransform(config.loaderParams[\"transform\"], \"=\");\n    params += `,${transformStr}`;\n  }\n  return `${path}/cdn-cgi/image/${params}/${config.src}`;\n}\nvar cloudinaryLoaderInfo = {\n  name: \"Cloudinary\",\n  testUrl: isCloudinaryUrl\n};\nvar CLOUDINARY_LOADER_REGEX = /https?\\:\\/\\/[^\\/]+\\.cloudinary\\.com\\/.+/;\nfunction isCloudinaryUrl(url) {\n  return CLOUDINARY_LOADER_REGEX.test(url);\n}\nvar provideCloudinaryLoader = createImageLoader(createCloudinaryUrl, ngDevMode ? [\"https://res.cloudinary.com/mysite\", \"https://mysite.cloudinary.com\", \"https://subdomain.mysite.com\"] : void 0);\nfunction createCloudinaryUrl(path, config) {\n  const quality = config.isPlaceholder ? \"q_auto:low\" : \"q_auto\";\n  let params = `f_auto,${quality}`;\n  if (config.width) {\n    params += `,w_${config.width}`;\n  }\n  if (config.loaderParams?.[\"rounded\"]) {\n    params += `,r_max`;\n  }\n  if (config.loaderParams?.[\"transform\"]) {\n    const transformStr = normalizeLoaderTransform(config.loaderParams[\"transform\"], \"_\");\n    params += `,${transformStr}`;\n  }\n  return `${path}/image/upload/${params}/${config.src}`;\n}\nvar imageKitLoaderInfo = {\n  name: \"ImageKit\",\n  testUrl: isImageKitUrl\n};\nvar IMAGE_KIT_LOADER_REGEX = /https?\\:\\/\\/[^\\/]+\\.imagekit\\.io\\/.+/;\nfunction isImageKitUrl(url) {\n  return IMAGE_KIT_LOADER_REGEX.test(url);\n}\nvar provideImageKitLoader = createImageLoader(createImagekitUrl, ngDevMode ? [\"https://ik.imagekit.io/mysite\", \"https://subdomain.mysite.com\"] : void 0);\nfunction createImagekitUrl(path, config) {\n  const {\n    src,\n    width\n  } = config;\n  const params = [];\n  if (width) {\n    params.push(`w-${width}`);\n  }\n  if (config.isPlaceholder) {\n    params.push(`q-${PLACEHOLDER_QUALITY}`);\n  }\n  if (config.loaderParams?.[\"transform\"]) {\n    const transformStr = normalizeLoaderTransform(config.loaderParams[\"transform\"], \"-\");\n    params.push(transformStr);\n  }\n  const urlSegments = params.length ? [path, `tr:${params.join(\",\")}`, src] : [path, src];\n  const url = new URL(urlSegments.join(\"/\"));\n  return url.href;\n}\nvar imgixLoaderInfo = {\n  name: \"Imgix\",\n  testUrl: isImgixUrl\n};\nvar IMGIX_LOADER_REGEX = /https?\\:\\/\\/[^\\/]+\\.imgix\\.net\\/.+/;\nfunction isImgixUrl(url) {\n  return IMGIX_LOADER_REGEX.test(url);\n}\nvar provideImgixLoader = createImageLoader(createImgixUrl, ngDevMode ? [\"https://somepath.imgix.net/\"] : void 0);\nfunction createImgixUrl(path, config) {\n  const params = [];\n  params.push(\"auto=format\");\n  if (config.width) {\n    params.push(`w=${config.width}`);\n  }\n  if (config.isPlaceholder) {\n    params.push(`q=${PLACEHOLDER_QUALITY}`);\n  }\n  if (config.loaderParams?.[\"transform\"]) {\n    const transform = normalizeLoaderTransform(config.loaderParams[\"transform\"], \"=\").split(\",\");\n    params.push(...transform);\n  }\n  const url = new URL(`${path}/${config.src}`);\n  url.search = params.join(\"&\");\n  return url.href;\n}\nvar netlifyLoaderInfo = {\n  name: \"Netlify\",\n  testUrl: isNetlifyUrl\n};\nvar NETLIFY_LOADER_REGEX = /https?\\:\\/\\/[^\\/]+\\.netlify\\.app\\/.+/;\nfunction isNetlifyUrl(url) {\n  return NETLIFY_LOADER_REGEX.test(url);\n}\nfunction provideNetlifyLoader(path) {\n  if (path && !isValidPath(path)) {\n    throw new RuntimeError(2959, ngDevMode && `Image loader has detected an invalid path (\\`${path}\\`). To fix this, supply either the full URL to the Netlify site, or leave it empty to use the current site.`);\n  }\n  if (path) {\n    const url = new URL(path);\n    path = url.origin;\n  }\n  const loaderFn = (config) => {\n    return createNetlifyUrl(config, path);\n  };\n  const providers = [{\n    provide: IMAGE_LOADER,\n    useValue: loaderFn\n  }];\n  return providers;\n}\nvar validParams = /* @__PURE__ */ new Map([[\"height\", \"h\"], [\"fit\", \"fit\"], [\"quality\", \"q\"], [\"q\", \"q\"], [\"position\", \"position\"]]);\nfunction createNetlifyUrl(config, path) {\n  const url = new URL(path ?? \"https://a/\");\n  url.pathname = \"/.netlify/images\";\n  if (!isAbsoluteUrl(config.src) && !config.src.startsWith(\"/\")) {\n    config.src = \"/\" + config.src;\n  }\n  url.searchParams.set(\"url\", config.src);\n  if (config.width) {\n    url.searchParams.set(\"w\", config.width.toString());\n  }\n  const configQuality = config.loaderParams?.[\"quality\"] ?? config.loaderParams?.[\"q\"];\n  if (config.isPlaceholder && !configQuality) {\n    url.searchParams.set(\"q\", PLACEHOLDER_QUALITY);\n  }\n  for (const [param, value] of Object.entries(config.loaderParams ?? {})) {\n    if (validParams.has(param)) {\n      url.searchParams.set(validParams.get(param), value.toString());\n    } else {\n      if (ngDevMode) {\n        console.warn(formatRuntimeError(2959, `The Netlify image loader has detected an \\`<img>\\` tag with the unsupported attribute \"\\`${param}\\`\".`));\n      }\n    }\n  }\n  return url.hostname === \"a\" ? url.href.replace(url.origin, \"\") : url.href;\n}\nfunction imgDirectiveDetails(ngSrc, includeNgSrc = true) {\n  const ngSrcInfo = includeNgSrc ? `(activated on an <img> element with the \\`ngSrc=\"${ngSrc}\"\\`) ` : \"\";\n  return `The NgOptimizedImage directive ${ngSrcInfo}has detected that`;\n}\nfunction assertDevMode(checkName) {\n  if (!ngDevMode) {\n    throw new RuntimeError(2958, `Unexpected invocation of the ${checkName} in the prod mode. Please make sure that the prod mode is enabled for production builds.`);\n  }\n}\nvar LCPImageObserver = class _LCPImageObserver {\n  images = /* @__PURE__ */ new Map();\n  window = inject(DOCUMENT).defaultView;\n  observer = null;\n  constructor() {\n    assertDevMode(\"LCP checker\");\n    if (typeof PerformanceObserver !== \"undefined\") {\n      this.observer = this.initPerformanceObserver();\n    }\n  }\n  initPerformanceObserver() {\n    const observer = new PerformanceObserver((entryList) => {\n      const entries = entryList.getEntries();\n      if (entries.length === 0) return;\n      const lcpElement = entries[entries.length - 1];\n      const imgSrc = lcpElement.element?.src ?? \"\";\n      if (imgSrc.startsWith(\"data:\") || imgSrc.startsWith(\"blob:\")) return;\n      const img = this.images.get(imgSrc);\n      if (!img) return;\n      if (!img.priority && !img.alreadyWarnedPriority) {\n        img.alreadyWarnedPriority = true;\n        logMissingPriorityError(imgSrc);\n      }\n      if (img.modified && !img.alreadyWarnedModified) {\n        img.alreadyWarnedModified = true;\n        logModifiedWarning(imgSrc);\n      }\n    });\n    observer.observe({\n      type: \"largest-contentful-paint\",\n      buffered: true\n    });\n    return observer;\n  }\n  registerImage(rewrittenSrc, originalNgSrc, isPriority) {\n    if (!this.observer) return;\n    const newObservedImageState = {\n      priority: isPriority,\n      modified: false,\n      alreadyWarnedModified: false,\n      alreadyWarnedPriority: false\n    };\n    this.images.set(getUrl(rewrittenSrc, this.window).href, newObservedImageState);\n  }\n  unregisterImage(rewrittenSrc) {\n    if (!this.observer) return;\n    this.images.delete(getUrl(rewrittenSrc, this.window).href);\n  }\n  updateImage(originalSrc, newSrc) {\n    if (!this.observer) return;\n    const originalUrl = getUrl(originalSrc, this.window).href;\n    const img = this.images.get(originalUrl);\n    if (img) {\n      img.modified = true;\n      this.images.set(getUrl(newSrc, this.window).href, img);\n      this.images.delete(originalUrl);\n    }\n  }\n  ngOnDestroy() {\n    if (!this.observer) return;\n    this.observer.disconnect();\n    this.images.clear();\n  }\n  static fac = function LCPImageObserver_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _LCPImageObserver)();\n  };\n  static prov = defineInjectable({\n    token: _LCPImageObserver,\n    factory: _LCPImageObserver.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(LCPImageObserver, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [], null);\n})();\nfunction logMissingPriorityError(ngSrc) {\n  const directiveDetails = imgDirectiveDetails(ngSrc);\n  console.error(formatRuntimeError(2955, `${directiveDetails} this image is the Largest Contentful Paint (LCP) element but was not marked \"priority\". This image should be marked \"priority\" in order to prioritize its loading. To fix this, add the \"priority\" attribute.`));\n}\nfunction logModifiedWarning(ngSrc) {\n  const directiveDetails = imgDirectiveDetails(ngSrc);\n  console.warn(formatRuntimeError(2964, `${directiveDetails} this image is the Largest Contentful Paint (LCP) element and has had its \"ngSrc\" attribute modified. This can cause slower loading performance. It is recommended not to modify the \"ngSrc\" property on any image which could be the LCP element.`));\n}\nvar INTERNAL_PRECONNECT_CHECK_BLOCKLIST = /* @__PURE__ */ new Set([\"localhost\", \"127.0.0.1\", \"0.0.0.0\", \"[::1]\"]);\nvar PRECONNECT_CHECK_BLOCKLIST = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"PRECONNECT_CHECK_BLOCKLIST\" : \"\");\nvar PreconnectLinkChecker = class _PreconnectLinkChecker {\n  document = inject(DOCUMENT);\n  preconnectLinks = null;\n  alreadySeen = /* @__PURE__ */ new Set();\n  window = this.document.defaultView;\n  blocklist = new Set(INTERNAL_PRECONNECT_CHECK_BLOCKLIST);\n  constructor() {\n    assertDevMode(\"preconnect link checker\");\n    const blocklist = inject(PRECONNECT_CHECK_BLOCKLIST, {\n      optional: true\n    });\n    if (blocklist) {\n      this.populateBlocklist(blocklist);\n    }\n  }\n  populateBlocklist(origins) {\n    if (Array.isArray(origins)) {\n      deepForEach(origins, (origin) => {\n        this.blocklist.add(extractHostname(origin));\n      });\n    } else {\n      this.blocklist.add(extractHostname(origins));\n    }\n  }\n  assertPreconnect(rewrittenSrc, originalNgSrc) {\n    if (false) return;\n    const imgUrl = getUrl(rewrittenSrc, this.window);\n    if (this.blocklist.has(imgUrl.hostname) || this.alreadySeen.has(imgUrl.origin)) return;\n    this.alreadySeen.add(imgUrl.origin);\n    this.preconnectLinks ??= this.queryPreconnectLinks();\n    if (!this.preconnectLinks.has(imgUrl.origin)) {\n      console.warn(formatRuntimeError(2956, `${imgDirectiveDetails(originalNgSrc)} there is no preconnect tag present for this image. Preconnecting to the origin(s) that serve priority images ensures that these images are delivered as soon as possible. To fix this, please add the following element into the <head> of the document:\n  <link rel=\"preconnect\" href=\"${imgUrl.origin}\">`));\n    }\n  }\n  queryPreconnectLinks() {\n    const preconnectUrls = /* @__PURE__ */ new Set();\n    const links = this.document.querySelectorAll(\"link[rel=preconnect]\");\n    for (const link of links) {\n      const url = getUrl(link.href, this.window);\n      preconnectUrls.add(url.origin);\n    }\n    return preconnectUrls;\n  }\n  ngOnDestroy() {\n    this.preconnectLinks?.clear();\n    this.alreadySeen.clear();\n  }\n  static fac = function PreconnectLinkChecker_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PreconnectLinkChecker)();\n  };\n  static prov = defineInjectable({\n    token: _PreconnectLinkChecker,\n    factory: _PreconnectLinkChecker.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PreconnectLinkChecker, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [], null);\n})();\nfunction deepForEach(input, fn) {\n  for (let value of input) {\n    Array.isArray(value) ? deepForEach(value, fn) : fn(value);\n  }\n}\nvar DEFAULT_PRELOADED_IMAGES_LIMIT = 5;\nvar PRELOADED_IMAGES = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"NG_OPTIMIZED_PRELOADED_IMAGES\" : \"\", {\n  factory: () => /* @__PURE__ */ new Set()\n});\nvar PreloadLinkCreator = class _PreloadLinkCreator {\n  preloadedImages = inject(PRELOADED_IMAGES);\n  document = inject(DOCUMENT);\n  errorShown = false;\n  createPreloadLinkTag(renderer, src, srcset, sizes) {\n    if (ngDevMode && !this.errorShown && this.preloadedImages.size >= DEFAULT_PRELOADED_IMAGES_LIMIT) {\n      this.errorShown = true;\n      console.warn(formatRuntimeError(2961, `The \\`NgOptimizedImage\\` directive has detected that more than ${DEFAULT_PRELOADED_IMAGES_LIMIT} images were marked as priority. This might negatively affect an overall performance of the page. To fix this, remove the \"priority\" attribute from images with less priority.`));\n    }\n    if (this.preloadedImages.has(src)) {\n      return;\n    }\n    this.preloadedImages.add(src);\n    const preload = renderer.createElement(\"link\");\n    renderer.setAttribute(preload, \"as\", \"image\");\n    renderer.setAttribute(preload, \"href\", src);\n    renderer.setAttribute(preload, \"rel\", \"preload\");\n    renderer.setAttribute(preload, \"fetchpriority\", \"high\");\n    if (sizes) {\n      renderer.setAttribute(preload, \"imageSizes\", sizes);\n    }\n    if (srcset) {\n      renderer.setAttribute(preload, \"imageSrcset\", srcset);\n    }\n    renderer.appendChild(this.document.head, preload);\n  }\n  static fac = function PreloadLinkCreator_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PreloadLinkCreator)();\n  };\n  static prov = defineInjectable({\n    token: _PreloadLinkCreator,\n    factory: _PreloadLinkCreator.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PreloadLinkCreator, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nvar BASE64_IMG_MAX_LENGTH_IN_ERROR = 50;\nvar VALID_WIDTH_DESCRIPTOR_SRCSET = /^((\\s*\\d+w\\s*(,|$)){1,})$/;\nvar VALID_DENSITY_DESCRIPTOR_SRCSET = /^((\\s*\\d+(\\.\\d+)?x\\s*(,|$)){1,})$/;\nvar ABSOLUTE_SRCSET_DENSITY_CAP = 3;\nvar RECOMMENDED_SRCSET_DENSITY_CAP = 2;\nvar DENSITY_SRCSET_MULTIPLIERS = [1, 2];\nvar VIEWPORT_BREAKPOINT_CUTOFF = 640;\nvar ASPECT_RATIO_TOLERANCE = 0.1;\nvar OVERSIZED_IMAGE_TOLERANCE = 1e3;\nvar FIXED_SRCSET_WIDTH_LIMIT = 1920;\nvar FIXED_SRCSET_HEIGHT_LIMIT = 1080;\nvar PLACEHOLDER_DIMENSION_LIMIT = 1e3;\nvar DATA_URL_WARN_LIMIT = 4e3;\nvar DATA_URL_ERROR_LIMIT = 1e4;\nvar BUILT_IN_LOADERS = [imgixLoaderInfo, imageKitLoaderInfo, cloudinaryLoaderInfo, netlifyLoaderInfo];\nvar PRIORITY_COUNT_THRESHOLD = 10;\nvar IMGS_WITH_PRIORITY_ATTR_COUNT = 0;\nvar NgOptimizedImage = class _NgOptimizedImage {\n  imageLoader = inject(IMAGE_LOADER);\n  config = processConfig(inject(IMAGE_CONFIG));\n  renderer = inject(Renderer2);\n  imgElement = inject(ElementRef).nativeElement;\n  injector = inject(Injector);\n  destroyRef = inject(DestroyRef);\n  lcpObserver;\n  _renderedSrc = null;\n  ngSrc;\n  ngSrcset;\n  sizes;\n  width;\n  height;\n  decoding;\n  loading;\n  priority = false;\n  loaderParams;\n  disableOptimizedSrcset = false;\n  fill = false;\n  placeholder;\n  placeholderConfig;\n  src;\n  srcset;\n  constructor() {\n    if (ngDevMode) {\n      this.lcpObserver = this.injector.get(LCPImageObserver);\n      this.destroyRef.onDestroy(() => {\n        if (!this.priority && this._renderedSrc !== null) {\n          this.lcpObserver.unregisterImage(this._renderedSrc);\n        }\n      });\n    }\n  }\n  ngOnInit() {\n    performanceMarkFeature(\"NgOptimizedImage\");\n    if (ngDevMode) {\n      const ngZone = this.injector.get(NgZone);\n      assertNonEmptyInput(this, \"ngSrc\", this.ngSrc);\n      assertValidNgSrcset(this, this.ngSrcset);\n      assertNoConflictingSrc(this);\n      if (this.ngSrcset) {\n        assertNoConflictingSrcset(this);\n      }\n      assertNotBase64Image(this);\n      assertNotBlobUrl(this);\n      if (this.fill) {\n        assertEmptyWidthAndHeight(this);\n        ngZone.runOutsideAngular(() => assertNonZeroRenderedHeight(this, this.imgElement, this.renderer, this.destroyRef));\n      } else {\n        assertNonEmptyWidthAndHeight(this);\n        if (this.height !== void 0) {\n          assertGreaterThanZero(this, this.height, \"height\");\n        }\n        if (this.width !== void 0) {\n          assertGreaterThanZero(this, this.width, \"width\");\n        }\n        ngZone.runOutsideAngular(() => assertNoImageDistortion(this, this.imgElement, this.renderer, this.destroyRef));\n      }\n      assertValidLoadingInput(this);\n      assertValidDecodingInput(this);\n      if (!this.ngSrcset) {\n        assertNoComplexSizes(this);\n      }\n      assertValidPlaceholder(this, this.imageLoader);\n      assertNotMissingBuiltInLoader(this.ngSrc, this.imageLoader);\n      assertNoNgSrcsetWithoutLoader(this, this.imageLoader);\n      assertNoLoaderParamsWithoutLoader(this, this.imageLoader);\n      ngZone.runOutsideAngular(() => {\n        this.lcpObserver.registerImage(this.getRewrittenSrc(), this.ngSrc, this.priority);\n      });\n      if (this.priority) {\n        const checker = this.injector.get(PreconnectLinkChecker);\n        checker.assertPreconnect(this.getRewrittenSrc(), this.ngSrc);\n        if (true) {\n          const applicationRef = this.injector.get(ApplicationRef);\n          assetPriorityCountBelowThreshold(applicationRef);\n        }\n      }\n    }\n    if (this.placeholder) {\n      this.removePlaceholderOnLoad(this.imgElement);\n    }\n    this.setHostAttributes();\n  }\n  setHostAttributes() {\n    if (this.fill) {\n      this.sizes ||= \"100vw\";\n    } else {\n      this.setHostAttribute(\"width\", this.width.toString());\n      this.setHostAttribute(\"height\", this.height.toString());\n    }\n    this.setHostAttribute(\"loading\", this.getLoadingBehavior());\n    this.setHostAttribute(\"fetchpriority\", this.getFetchPriority());\n    this.setHostAttribute(\"decoding\", this.getDecoding());\n    this.setHostAttribute(\"ng-img\", \"true\");\n    const rewrittenSrcset = this.updateSrcAndSrcset();\n    if (this.sizes) {\n      if (this.getLoadingBehavior() === \"lazy\") {\n        this.setHostAttribute(\"sizes\", \"auto, \" + this.sizes);\n      } else {\n        this.setHostAttribute(\"sizes\", this.sizes);\n      }\n    } else {\n      if (this.ngSrcset && VALID_WIDTH_DESCRIPTOR_SRCSET.test(this.ngSrcset) && this.getLoadingBehavior() === \"lazy\") {\n        this.setHostAttribute(\"sizes\", \"auto, 100vw\");\n      }\n    }\n    if (false) {\n      const preloadLinkCreator = this.injector.get(PreloadLinkCreator);\n      preloadLinkCreator.createPreloadLinkTag(this.renderer, this.getRewrittenSrc(), rewrittenSrcset, this.sizes);\n    }\n  }\n  ngOnChanges(changes) {\n    if (ngDevMode) {\n      assertNoPostInitInputChange(this, changes, [\"ngSrcset\", \"width\", \"height\", \"priority\", \"fill\", \"loading\", \"sizes\", \"loaderParams\", \"disableOptimizedSrcset\"]);\n    }\n    if (changes[\"ngSrc\"] && !changes[\"ngSrc\"].isFirstChange()) {\n      const oldSrc = this._renderedSrc;\n      this.updateSrcAndSrcset(true);\n      if (ngDevMode) {\n        const newSrc = this._renderedSrc;\n        if (oldSrc && newSrc && oldSrc !== newSrc) {\n          const ngZone = this.injector.get(NgZone);\n          ngZone.runOutsideAngular(() => {\n            this.lcpObserver.updateImage(oldSrc, newSrc);\n          });\n        }\n      }\n    }\n    if (ngDevMode && changes[\"placeholder\"]?.currentValue && true && true) {\n      assertPlaceholderDimensions(this, this.imgElement);\n    }\n  }\n  callImageLoader(configWithoutCustomParams) {\n    let augmentedConfig = configWithoutCustomParams;\n    if (this.loaderParams) {\n      augmentedConfig.loaderParams = this.loaderParams;\n    }\n    return this.imageLoader(augmentedConfig);\n  }\n  getLoadingBehavior() {\n    if (!this.priority && this.loading !== void 0) {\n      return this.loading;\n    }\n    return this.priority ? \"eager\" : \"lazy\";\n  }\n  getFetchPriority() {\n    return this.priority ? \"high\" : \"auto\";\n  }\n  getDecoding() {\n    if (this.priority) {\n      return \"sync\";\n    }\n    return this.decoding ?? \"auto\";\n  }\n  getRewrittenSrc() {\n    if (!this._renderedSrc) {\n      const imgConfig = {\n        src: this.ngSrc\n      };\n      this._renderedSrc = this.callImageLoader(imgConfig);\n    }\n    return this._renderedSrc;\n  }\n  getRewrittenSrcset() {\n    const widthSrcSet = VALID_WIDTH_DESCRIPTOR_SRCSET.test(this.ngSrcset);\n    const finalSrcs = this.ngSrcset.split(\",\").filter((src) => src !== \"\").map((srcStr) => {\n      srcStr = srcStr.trim();\n      const width = widthSrcSet ? parseFloat(srcStr) : parseFloat(srcStr) * this.width;\n      return `${this.callImageLoader({\n        src: this.ngSrc,\n        width\n      })} ${srcStr}`;\n    });\n    return finalSrcs.join(\", \");\n  }\n  getAutomaticSrcset() {\n    if (this.sizes) {\n      return this.getResponsiveSrcset();\n    } else {\n      return this.getFixedSrcset();\n    }\n  }\n  getResponsiveSrcset() {\n    const {\n      breakpoints\n    } = this.config;\n    let filteredBreakpoints = breakpoints;\n    if (this.sizes?.trim() === \"100vw\") {\n      filteredBreakpoints = breakpoints.filter((bp) => bp >= VIEWPORT_BREAKPOINT_CUTOFF);\n    }\n    const finalSrcs = filteredBreakpoints.map((bp) => `${this.callImageLoader({\n      src: this.ngSrc,\n      width: bp\n    })} ${bp}w`);\n    return finalSrcs.join(\", \");\n  }\n  updateSrcAndSrcset(forceSrcRecalc = false) {\n    if (forceSrcRecalc) {\n      this._renderedSrc = null;\n    }\n    const rewrittenSrc = this.getRewrittenSrc();\n    this.setHostAttribute(\"src\", rewrittenSrc);\n    let rewrittenSrcset = void 0;\n    if (this.ngSrcset) {\n      rewrittenSrcset = this.getRewrittenSrcset();\n    } else if (this.shouldGenerateAutomaticSrcset()) {\n      rewrittenSrcset = this.getAutomaticSrcset();\n    }\n    if (rewrittenSrcset) {\n      this.setHostAttribute(\"srcset\", rewrittenSrcset);\n    }\n    return rewrittenSrcset;\n  }\n  getFixedSrcset() {\n    const finalSrcs = DENSITY_SRCSET_MULTIPLIERS.map((multiplier) => `${this.callImageLoader({\n      src: this.ngSrc,\n      width: this.width * multiplier\n    })} ${multiplier}x`);\n    return finalSrcs.join(\", \");\n  }\n  shouldGenerateAutomaticSrcset() {\n    let oversizedImage = false;\n    if (!this.sizes) {\n      oversizedImage = this.width > FIXED_SRCSET_WIDTH_LIMIT || this.height > FIXED_SRCSET_HEIGHT_LIMIT;\n    }\n    return !this.disableOptimizedSrcset && !this.srcset && this.imageLoader !== noopImageLoader && !oversizedImage;\n  }\n  generatePlaceholder(placeholderInput) {\n    const {\n      placeholderResolution\n    } = this.config;\n    if (placeholderInput === true) {\n      return `url(${this.callImageLoader({\n        src: this.ngSrc,\n        width: placeholderResolution,\n        isPlaceholder: true\n      })})`;\n    } else if (typeof placeholderInput === \"string\") {\n      return `url(${placeholderInput})`;\n    }\n    return null;\n  }\n  shouldBlurPlaceholder(placeholderConfig) {\n    if (!placeholderConfig || !placeholderConfig.hasOwnProperty(\"blur\")) {\n      return true;\n    }\n    return Boolean(placeholderConfig.blur);\n  }\n  removePlaceholderOnLoad(img) {\n    const callback = () => {\n      const changeDetectorRef = this.injector.get(ChangeDetectorRef);\n      removeLoadListenerFn();\n      removeErrorListenerFn();\n      this.placeholder = false;\n      changeDetectorRef.markForCheck();\n    };\n    const removeLoadListenerFn = this.renderer.listen(img, \"load\", callback);\n    const removeErrorListenerFn = this.renderer.listen(img, \"error\", callback);\n    this.destroyRef.onDestroy(() => {\n      removeLoadListenerFn();\n      removeErrorListenerFn();\n    });\n    callOnLoadIfImageIsLoaded(img, callback);\n  }\n  setHostAttribute(name, value) {\n    this.renderer.setAttribute(this.imgElement, name, value);\n  }\n  static fac = function NgOptimizedImage_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _NgOptimizedImage)();\n  };\n  static dir = defineDirective({\n    type: _NgOptimizedImage,\n    selectors: [[\"img\", \"ngSrc\", \"\"]],\n    hostVars: 18,\n    hostBindings: function NgOptimizedImage_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        styleProp(\"position\", ctx.fill ? \"absolute\" : null)(\"width\", ctx.fill ? \"100%\" : null)(\"height\", ctx.fill ? \"100%\" : null)(\"inset\", ctx.fill ? \"0\" : null)(\"background-size\", ctx.placeholder ? \"cover\" : null)(\"background-position\", ctx.placeholder ? \"50% 50%\" : null)(\"background-repeat\", ctx.placeholder ? \"no-repeat\" : null)(\"background-image\", ctx.placeholder ? ctx.generatePlaceholder(ctx.placeholder) : null)(\"filter\", ctx.placeholder && ctx.shouldBlurPlaceholder(ctx.placeholderConfig) ? \"blur(15px)\" : null);\n      }\n    },\n    inputs: {\n      ngSrc: [2, \"ngSrc\", \"ngSrc\", unwrapSafeUrl],\n      ngSrcset: \"ngSrcset\",\n      sizes: \"sizes\",\n      width: [2, \"width\", \"width\", numberAttribute],\n      height: [2, \"height\", \"height\", numberAttribute],\n      decoding: \"decoding\",\n      loading: \"loading\",\n      priority: [2, \"priority\", \"priority\", booleanAttribute],\n      loaderParams: \"loaderParams\",\n      disableOptimizedSrcset: [2, \"disableOptimizedSrcset\", \"disableOptimizedSrcset\", booleanAttribute],\n      fill: [2, \"fill\", \"fill\", booleanAttribute],\n      placeholder: [2, \"placeholder\", \"placeholder\", booleanOrUrlAttribute],\n      placeholderConfig: \"placeholderConfig\",\n      src: \"src\",\n      srcset: \"srcset\"\n    },\n    features: [NgOnChangesFeature]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(NgOptimizedImage, [{\n    type: Directive,\n    args: [{\n      selector: \"img[ngSrc]\",\n      host: {\n        \"[style.position]\": 'fill ? \"absolute\" : null',\n        \"[style.width]\": 'fill ? \"100%\" : null',\n        \"[style.height]\": 'fill ? \"100%\" : null',\n        \"[style.inset]\": 'fill ? \"0\" : null',\n        \"[style.background-size]\": 'placeholder ? \"cover\" : null',\n        \"[style.background-position]\": 'placeholder ? \"50% 50%\" : null',\n        \"[style.background-repeat]\": 'placeholder ? \"no-repeat\" : null',\n        \"[style.background-image]\": \"placeholder ? generatePlaceholder(placeholder) : null\",\n        \"[style.filter]\": 'placeholder && shouldBlurPlaceholder(placeholderConfig) ? \"blur(15px)\" : null'\n      }\n    }]\n  }], () => [], {\n    ngSrc: [{\n      type: Input,\n      args: [{\n        required: true,\n        transform: unwrapSafeUrl\n      }]\n    }],\n    ngSrcset: [{\n      type: Input\n    }],\n    sizes: [{\n      type: Input\n    }],\n    width: [{\n      type: Input,\n      args: [{\n        transform: numberAttribute\n      }]\n    }],\n    height: [{\n      type: Input,\n      args: [{\n        transform: numberAttribute\n      }]\n    }],\n    decoding: [{\n      type: Input\n    }],\n    loading: [{\n      type: Input\n    }],\n    priority: [{\n      type: Input,\n      args: [{\n        transform: booleanAttribute\n      }]\n    }],\n    loaderParams: [{\n      type: Input\n    }],\n    disableOptimizedSrcset: [{\n      type: Input,\n      args: [{\n        transform: booleanAttribute\n      }]\n    }],\n    fill: [{\n      type: Input,\n      args: [{\n        transform: booleanAttribute\n      }]\n    }],\n    placeholder: [{\n      type: Input,\n      args: [{\n        transform: booleanOrUrlAttribute\n      }]\n    }],\n    placeholderConfig: [{\n      type: Input\n    }],\n    src: [{\n      type: Input\n    }],\n    srcset: [{\n      type: Input\n    }]\n  });\n})();\nfunction processConfig(config) {\n  let sortedBreakpoints = {};\n  if (config.breakpoints) {\n    sortedBreakpoints.breakpoints = config.breakpoints.sort((a, b) => a - b);\n  }\n  return Object.assign({}, IMAGE_CONFIG_DEFAULTS, config, sortedBreakpoints);\n}\nfunction assertNoConflictingSrc(dir) {\n  if (dir.src) {\n    throw new RuntimeError(2950, `${imgDirectiveDetails(dir.ngSrc)} both \\`src\\` and \\`ngSrc\\` have been set. Supplying both of these attributes breaks lazy loading. The NgOptimizedImage directive sets \\`src\\` itself based on the value of \\`ngSrc\\`. To fix this, please remove the \\`src\\` attribute.`);\n  }\n}\nfunction assertNoConflictingSrcset(dir) {\n  if (dir.srcset) {\n    throw new RuntimeError(2951, `${imgDirectiveDetails(dir.ngSrc)} both \\`srcset\\` and \\`ngSrcset\\` have been set. Supplying both of these attributes breaks lazy loading. The NgOptimizedImage directive sets \\`srcset\\` itself based on the value of \\`ngSrcset\\`. To fix this, please remove the \\`srcset\\` attribute.`);\n  }\n}\nfunction assertNotBase64Image(dir) {\n  let ngSrc = dir.ngSrc.trim();\n  if (ngSrc.startsWith(\"data:\")) {\n    if (ngSrc.length > BASE64_IMG_MAX_LENGTH_IN_ERROR) {\n      ngSrc = ngSrc.substring(0, BASE64_IMG_MAX_LENGTH_IN_ERROR) + \"...\";\n    }\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc, false)} \\`ngSrc\\` is a Base64-encoded string (${ngSrc}). NgOptimizedImage does not support Base64-encoded strings. To fix this, disable the NgOptimizedImage directive for this element by removing \\`ngSrc\\` and using a standard \\`src\\` attribute instead.`);\n  }\n}\nfunction assertNoComplexSizes(dir) {\n  let sizes = dir.sizes;\n  if (sizes?.match(/((\\)|,)\\s|^)\\d+px/)) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc, false)} \\`sizes\\` was set to a string including pixel values. For automatic \\`srcset\\` generation, \\`sizes\\` must only include responsive values, such as \\`sizes=\"50vw\"\\` or \\`sizes=\"(min-width: 768px) 50vw, 100vw\"\\`. To fix this, modify the \\`sizes\\` attribute, or provide your own \\`ngSrcset\\` value directly.`);\n  }\n}\nfunction assertValidPlaceholder(dir, imageLoader) {\n  assertNoPlaceholderConfigWithoutPlaceholder(dir);\n  assertNoRelativePlaceholderWithoutLoader(dir, imageLoader);\n  assertNoOversizedDataUrl(dir);\n}\nfunction assertNoPlaceholderConfigWithoutPlaceholder(dir) {\n  if (dir.placeholderConfig && !dir.placeholder) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc, false)} \\`placeholderConfig\\` options were provided for an image that does not use the \\`placeholder\\` attribute, and will have no effect.`);\n  }\n}\nfunction assertNoRelativePlaceholderWithoutLoader(dir, imageLoader) {\n  if (dir.placeholder === true && imageLoader === noopImageLoader) {\n    throw new RuntimeError(2963, `${imgDirectiveDetails(dir.ngSrc)} the \\`placeholder\\` attribute is set to true but no image loader is configured (i.e. the default one is being used), which would result in the same image being used for the primary image and its placeholder. To fix this, provide a loader or remove the \\`placeholder\\` attribute from the image.`);\n  }\n}\nfunction assertNoOversizedDataUrl(dir) {\n  if (dir.placeholder && typeof dir.placeholder === \"string\" && dir.placeholder.startsWith(\"data:\")) {\n    if (dir.placeholder.length > DATA_URL_ERROR_LIMIT) {\n      throw new RuntimeError(2965, `${imgDirectiveDetails(dir.ngSrc)} the \\`placeholder\\` attribute is set to a data URL which is longer than ${DATA_URL_ERROR_LIMIT} characters. This is strongly discouraged, as large inline placeholders directly increase the bundle size of Angular and hurt page load performance. To fix this, generate a smaller data URL placeholder.`);\n    }\n    if (dir.placeholder.length > DATA_URL_WARN_LIMIT) {\n      console.warn(formatRuntimeError(2965, `${imgDirectiveDetails(dir.ngSrc)} the \\`placeholder\\` attribute is set to a data URL which is longer than ${DATA_URL_WARN_LIMIT} characters. This is discouraged, as large inline placeholders directly increase the bundle size of Angular and hurt page load performance. For better loading performance, generate a smaller data URL placeholder.`));\n    }\n  }\n}\nfunction assertNotBlobUrl(dir) {\n  const ngSrc = dir.ngSrc.trim();\n  if (ngSrc.startsWith(\"blob:\")) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} \\`ngSrc\\` was set to a blob URL (${ngSrc}). Blob URLs are not supported by the NgOptimizedImage directive. To fix this, disable the NgOptimizedImage directive for this element by removing \\`ngSrc\\` and using a regular \\`src\\` attribute instead.`);\n  }\n}\nfunction assertNonEmptyInput(dir, name, value) {\n  const isString = typeof value === \"string\";\n  const isEmptyString = isString && value.trim() === \"\";\n  if (!isString || isEmptyString) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} \\`${name}\\` has an invalid value (\\`${value}\\`). To fix this, change the value to a non-empty string.`);\n  }\n}\nfunction assertValidNgSrcset(dir, value) {\n  if (value == null) return;\n  assertNonEmptyInput(dir, \"ngSrcset\", value);\n  const stringVal = value;\n  const isValidWidthDescriptor = VALID_WIDTH_DESCRIPTOR_SRCSET.test(stringVal);\n  const isValidDensityDescriptor = VALID_DENSITY_DESCRIPTOR_SRCSET.test(stringVal);\n  if (isValidDensityDescriptor) {\n    assertUnderDensityCap(dir, stringVal);\n  }\n  const isValidSrcset = isValidWidthDescriptor || isValidDensityDescriptor;\n  if (!isValidSrcset) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} \\`ngSrcset\\` has an invalid value (\\`${value}\\`). To fix this, supply \\`ngSrcset\\` using a comma-separated list of one or more width descriptors (e.g. \"100w, 200w\") or density descriptors (e.g. \"1x, 2x\").`);\n  }\n}\nfunction assertUnderDensityCap(dir, value) {\n  const underDensityCap = value.split(\",\").every((num) => num === \"\" || parseFloat(num) <= ABSOLUTE_SRCSET_DENSITY_CAP);\n  if (!underDensityCap) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the \\`ngSrcset\\` contains an unsupported image density:\\`${value}\\`. NgOptimizedImage generally recommends a max image density of ${RECOMMENDED_SRCSET_DENSITY_CAP}x but supports image densities up to ${ABSOLUTE_SRCSET_DENSITY_CAP}x. The human eye cannot distinguish between image densities greater than ${RECOMMENDED_SRCSET_DENSITY_CAP}x - which makes them unnecessary for most use cases. Images that will be pinch-zoomed are typically the primary use case for ${ABSOLUTE_SRCSET_DENSITY_CAP}x images. Please remove the high density descriptor and try again.`);\n  }\n}\nfunction postInitInputChangeError(dir, inputName) {\n  let reason;\n  if (inputName === \"width\" || inputName === \"height\") {\n    reason = `Changing \\`${inputName}\\` may result in different attribute value applied to the underlying image element and cause layout shifts on a page.`;\n  } else {\n    reason = `Changing the \\`${inputName}\\` would have no effect on the underlying image element, because the resource loading has already occurred.`;\n  }\n  return new RuntimeError(2953, `${imgDirectiveDetails(dir.ngSrc)} \\`${inputName}\\` was updated after initialization. The NgOptimizedImage directive will not react to this input change. ${reason} To fix this, either switch \\`${inputName}\\` to a static value or wrap the image element in an @if that is gated on the necessary value.`);\n}\nfunction assertNoPostInitInputChange(dir, changes, inputs) {\n  inputs.forEach((input) => {\n    const isUpdated = changes.hasOwnProperty(input);\n    if (isUpdated && !changes[input].isFirstChange()) {\n      if (input === \"ngSrc\") {\n        dir = {\n          ngSrc: changes[input].previousValue\n        };\n      }\n      throw postInitInputChangeError(dir, input);\n    }\n  });\n}\nfunction assertGreaterThanZero(dir, inputValue, inputName) {\n  const validNumber = typeof inputValue === \"number\" && inputValue > 0;\n  const validString = typeof inputValue === \"string\" && /^\\d+$/.test(inputValue.trim()) && parseInt(inputValue) > 0;\n  if (!validNumber && !validString) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} \\`${inputName}\\` has an invalid value. To fix this, provide \\`${inputName}\\` as a number greater than 0.`);\n  }\n}\nfunction assertNoImageDistortion(dir, img, renderer, destroyRef) {\n  const callback = () => {\n    removeLoadListenerFn();\n    removeErrorListenerFn();\n    const computedStyle = window.getComputedStyle(img);\n    let renderedWidth = parseFloat(computedStyle.getPropertyValue(\"width\"));\n    let renderedHeight = parseFloat(computedStyle.getPropertyValue(\"height\"));\n    const boxSizing = computedStyle.getPropertyValue(\"box-sizing\");\n    if (boxSizing === \"border-box\") {\n      const paddingTop = computedStyle.getPropertyValue(\"padding-top\");\n      const paddingRight = computedStyle.getPropertyValue(\"padding-right\");\n      const paddingBottom = computedStyle.getPropertyValue(\"padding-bottom\");\n      const paddingLeft = computedStyle.getPropertyValue(\"padding-left\");\n      renderedWidth -= parseFloat(paddingRight) + parseFloat(paddingLeft);\n      renderedHeight -= parseFloat(paddingTop) + parseFloat(paddingBottom);\n    }\n    const renderedAspectRatio = renderedWidth / renderedHeight;\n    const nonZeroRenderedDimensions = renderedWidth !== 0 && renderedHeight !== 0;\n    const intrinsicWidth = img.naturalWidth;\n    const intrinsicHeight = img.naturalHeight;\n    const intrinsicAspectRatio = intrinsicWidth / intrinsicHeight;\n    const suppliedWidth = dir.width;\n    const suppliedHeight = dir.height;\n    const suppliedAspectRatio = suppliedWidth / suppliedHeight;\n    const inaccurateDimensions = Math.abs(suppliedAspectRatio - intrinsicAspectRatio) > ASPECT_RATIO_TOLERANCE;\n    const stylingDistortion = nonZeroRenderedDimensions && Math.abs(intrinsicAspectRatio - renderedAspectRatio) > ASPECT_RATIO_TOLERANCE;\n    if (inaccurateDimensions) {\n      console.warn(formatRuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the aspect ratio of the image does not match the aspect ratio indicated by the width and height attributes. \nIntrinsic image size: ${intrinsicWidth}w x ${intrinsicHeight}h (aspect-ratio: ${round(intrinsicAspectRatio)}). \nSupplied width and height attributes: ${suppliedWidth}w x ${suppliedHeight}h (aspect-ratio: ${round(suppliedAspectRatio)}). \nTo fix this, update the width and height attributes.`));\n    } else if (stylingDistortion) {\n      console.warn(formatRuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the aspect ratio of the rendered image does not match the image's intrinsic aspect ratio. \nIntrinsic image size: ${intrinsicWidth}w x ${intrinsicHeight}h (aspect-ratio: ${round(intrinsicAspectRatio)}). \nRendered image size: ${renderedWidth}w x ${renderedHeight}h (aspect-ratio: ${round(renderedAspectRatio)}). \nThis issue can occur if \"width\" and \"height\" attributes are added to an image without updating the corresponding image styling. To fix this, adjust image styling. In most cases, adding \"height: auto\" or \"width: auto\" to the image styling will fix this issue.`));\n    } else if (!dir.ngSrcset && nonZeroRenderedDimensions) {\n      const recommendedWidth = RECOMMENDED_SRCSET_DENSITY_CAP * renderedWidth;\n      const recommendedHeight = RECOMMENDED_SRCSET_DENSITY_CAP * renderedHeight;\n      const oversizedWidth = intrinsicWidth - recommendedWidth >= OVERSIZED_IMAGE_TOLERANCE;\n      const oversizedHeight = intrinsicHeight - recommendedHeight >= OVERSIZED_IMAGE_TOLERANCE;\n      if (oversizedWidth || oversizedHeight) {\n        console.warn(formatRuntimeError(2960, `${imgDirectiveDetails(dir.ngSrc)} the intrinsic image is significantly larger than necessary. \nRendered image size: ${renderedWidth}w x ${renderedHeight}h. \nIntrinsic image size: ${intrinsicWidth}w x ${intrinsicHeight}h. \nRecommended intrinsic image size: ${recommendedWidth}w x ${recommendedHeight}h. \nNote: Recommended intrinsic image size is calculated assuming a maximum DPR of ${RECOMMENDED_SRCSET_DENSITY_CAP}. To improve loading time, resize the image or consider using the \"ngSrcset\" and \"sizes\" attributes.`));\n      }\n    }\n  };\n  const removeLoadListenerFn = renderer.listen(img, \"load\", callback);\n  const removeErrorListenerFn = renderer.listen(img, \"error\", () => {\n    removeLoadListenerFn();\n    removeErrorListenerFn();\n  });\n  destroyRef.onDestroy(() => {\n    removeLoadListenerFn();\n    removeErrorListenerFn();\n  });\n  callOnLoadIfImageIsLoaded(img, callback);\n}\nfunction assertNonEmptyWidthAndHeight(dir) {\n  let missingAttributes = [];\n  if (dir.width === void 0) missingAttributes.push(\"width\");\n  if (dir.height === void 0) missingAttributes.push(\"height\");\n  if (missingAttributes.length > 0) {\n    throw new RuntimeError(2954, `${imgDirectiveDetails(dir.ngSrc)} these required attributes are missing: ${missingAttributes.map((attr) => `\"${attr}\"`).join(\", \")}. Including \"width\" and \"height\" attributes will prevent image-related layout shifts. To fix this, include \"width\" and \"height\" attributes on the image tag or turn on \"fill\" mode with the \\`fill\\` attribute.`);\n  }\n}\nfunction assertEmptyWidthAndHeight(dir) {\n  if (dir.width || dir.height) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the attributes \\`height\\` and/or \\`width\\` are present along with the \\`fill\\` attribute. Because \\`fill\\` mode causes an image to fill its containing element, the size attributes have no effect and should be removed.`);\n  }\n}\nfunction assertNonZeroRenderedHeight(dir, img, renderer, destroyRef) {\n  const callback = () => {\n    removeLoadListenerFn();\n    removeErrorListenerFn();\n    const renderedHeight = img.clientHeight;\n    if (dir.fill && renderedHeight === 0) {\n      console.warn(formatRuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the height of the fill-mode image is zero. This is likely because the containing element does not have the CSS 'position' property set to one of the following: \"relative\", \"fixed\", or \"absolute\". To fix this problem, make sure the container element has the CSS 'position' property defined and the height of the element is not zero.`));\n    }\n  };\n  const removeLoadListenerFn = renderer.listen(img, \"load\", callback);\n  const removeErrorListenerFn = renderer.listen(img, \"error\", () => {\n    removeLoadListenerFn();\n    removeErrorListenerFn();\n  });\n  destroyRef.onDestroy(() => {\n    removeLoadListenerFn();\n    removeErrorListenerFn();\n  });\n  callOnLoadIfImageIsLoaded(img, callback);\n}\nfunction assertValidLoadingInput(dir) {\n  if (dir.loading && dir.priority) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the \\`loading\\` attribute was used on an image that was marked \"priority\". Setting \\`loading\\` on priority images is not allowed because these images will always be eagerly loaded. To fix this, remove the loading attribute from the priority image.`);\n  }\n  const validInputs = [\"auto\", \"eager\", \"lazy\"];\n  if (typeof dir.loading === \"string\" && !validInputs.includes(dir.loading)) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the \\`loading\\` attribute has an invalid value (\\`${dir.loading}\\`). To fix this, provide a valid value (\"lazy\", \"eager\", or \"auto\").`);\n  }\n}\nfunction assertValidDecodingInput(dir) {\n  const validInputs = [\"sync\", \"async\", \"auto\"];\n  if (typeof dir.decoding === \"string\" && !validInputs.includes(dir.decoding)) {\n    throw new RuntimeError(2952, `${imgDirectiveDetails(dir.ngSrc)} the \\`decoding\\` attribute has an invalid value (\\`${dir.decoding}\\`). To fix this, provide a valid value (\"sync\", \"async\", or \"auto\").`);\n  }\n}\nfunction assertNotMissingBuiltInLoader(ngSrc, imageLoader) {\n  if (imageLoader === noopImageLoader) {\n    let builtInLoaderName = \"\";\n    for (const loader of BUILT_IN_LOADERS) {\n      if (loader.testUrl(ngSrc)) {\n        builtInLoaderName = loader.name;\n        break;\n      }\n    }\n    if (builtInLoaderName) {\n      console.warn(formatRuntimeError(2962, `NgOptimizedImage: It looks like your images may be hosted on the ${builtInLoaderName} CDN, but your app is not using Angular's built-in loader for that CDN. We recommend switching to use the built-in by calling \\`provide${builtInLoaderName}Loader()\\` in your \\`providers\\` and passing it your instance's base URL. If you don't want to use the built-in loader, define a custom loader function using IMAGE_LOADER to silence this warning.`));\n    }\n  }\n}\nfunction assertNoNgSrcsetWithoutLoader(dir, imageLoader) {\n  if (dir.ngSrcset && imageLoader === noopImageLoader) {\n    console.warn(formatRuntimeError(2963, `${imgDirectiveDetails(dir.ngSrc)} the \\`ngSrcset\\` attribute is present but no image loader is configured (i.e. the default one is being used), which would result in the same image being used for all configured sizes. To fix this, provide a loader or remove the \\`ngSrcset\\` attribute from the image.`));\n  }\n}\nfunction assertNoLoaderParamsWithoutLoader(dir, imageLoader) {\n  if (dir.loaderParams && imageLoader === noopImageLoader) {\n    console.warn(formatRuntimeError(2963, `${imgDirectiveDetails(dir.ngSrc)} the \\`loaderParams\\` attribute is present but no image loader is configured (i.e. the default one is being used), which means that the loaderParams data will not be consumed and will not affect the URL. To fix this, provide a custom loader or remove the \\`loaderParams\\` attribute from the image.`));\n  }\n}\nasync function assetPriorityCountBelowThreshold(appRef) {\n  if (IMGS_WITH_PRIORITY_ATTR_COUNT === 0) {\n    IMGS_WITH_PRIORITY_ATTR_COUNT++;\n    await appRef.whenStable();\n    if (IMGS_WITH_PRIORITY_ATTR_COUNT > PRIORITY_COUNT_THRESHOLD) {\n      console.warn(formatRuntimeError(2966, `NgOptimizedImage: The \"priority\" attribute is set to true more than ${PRIORITY_COUNT_THRESHOLD} times (${IMGS_WITH_PRIORITY_ATTR_COUNT} times). Marking too many images as \"high\" priority can hurt your application's LCP (https://web.dev/lcp). \"Priority\" should only be set on the image expected to be the page's LCP element.`));\n    }\n  } else {\n    IMGS_WITH_PRIORITY_ATTR_COUNT++;\n  }\n}\nfunction assertPlaceholderDimensions(dir, imgElement) {\n  const computedStyle = window.getComputedStyle(imgElement);\n  let renderedWidth = parseFloat(computedStyle.getPropertyValue(\"width\"));\n  let renderedHeight = parseFloat(computedStyle.getPropertyValue(\"height\"));\n  if (renderedWidth > PLACEHOLDER_DIMENSION_LIMIT || renderedHeight > PLACEHOLDER_DIMENSION_LIMIT) {\n    console.warn(formatRuntimeError(2967, `${imgDirectiveDetails(dir.ngSrc)} it uses a placeholder image, but at least one of the dimensions attribute (height or width) exceeds the limit of ${PLACEHOLDER_DIMENSION_LIMIT}px. To fix this, use a smaller image as a placeholder.`));\n  }\n}\nfunction callOnLoadIfImageIsLoaded(img, callback) {\n  if (img.complete && img.naturalWidth) {\n    callback();\n  }\n}\nfunction round(input) {\n  return Number.isInteger(input) ? input : input.toFixed(2);\n}\nfunction unwrapSafeUrl(value) {\n  if (typeof value === \"string\") {\n    return value;\n  }\n  return unwrapSafeValue(value);\n}\nfunction booleanOrUrlAttribute(value) {\n  if (typeof value === \"string\" && value !== \"true\" && value !== \"false\" && value !== \"\") {\n    return value;\n  }\n  return booleanAttribute(value);\n}\n\nexport {\n  normalizeQueryParams,\n  LocationStrategy,\n  APP_BASE_HREF,\n  PathLocationStrategy,\n  Location,\n  HashLocationStrategy,\n  NumberFormatStyle,\n  Plural,\n  FormStyle,\n  TranslationWidth,\n  FormatWidth,\n  NumberSymbol,\n  WeekDay,\n  getLocaleId,\n  getLocaleDayPeriods,\n  getLocaleDayNames,\n  getLocaleMonthNames,\n  getLocaleEraNames,\n  getLocaleFirstDayOfWeek,\n  getLocaleWeekEndRange,\n  getLocaleDateFormat,\n  getLocaleTimeFormat,\n  getLocaleDateTimeFormat,\n  getLocaleNumberSymbol,\n  getLocaleNumberFormat,\n  getLocaleCurrencySymbol,\n  getLocaleCurrencyName,\n  getLocaleCurrencyCode2 as getLocaleCurrencyCode,\n  getLocalePluralCase2 as getLocalePluralCase,\n  getLocaleExtraDayPeriodRules,\n  getLocaleExtraDayPeriods,\n  getLocaleDirection,\n  getCurrencySymbol,\n  getNumberOfCurrencyDigits,\n  formatDate,\n  formatCurrency,\n  formatPercent,\n  formatNumber,\n  NgLocalization,\n  NgLocaleLocalization,\n  NgClass,\n  NgComponentOutlet,\n  NgForOfContext,\n  NgForOf,\n  NgIf,\n  NgIfContext,\n  NgSwitch,\n  NgSwitchCase,\n  NgSwitchDefault,\n  NgPlural,\n  NgPluralCase,\n  NgStyle,\n  NgTemplateOutlet,\n  AsyncPipe,\n  LowerCasePipe,\n  TitleCasePipe,\n  UpperCasePipe,\n  DATE_PIPE_DEFAULT_TIMEZONE,\n  DATE_PIPE_DEFAULT_OPTIONS,\n  DatePipe,\n  I18nPluralPipe,\n  I18nSelectPipe,\n  JsonPipe,\n  KeyValuePipe,\n  DecimalPipe,\n  PercentPipe,\n  CurrencyPipe,\n  SlicePipe,\n  CommonModule,\n  PRECOMMIT_HANDLER_SUPPORTED,\n  PlatformNavigation,\n  NavigationAdapterForLocation,\n  registerLocaleData2 as registerLocaleData,\n  PLATFORM_BROWSER_ID,\n  PLATFORM_SERVER_ID,\n  isPlatformBrowser,\n  isPlatformServer,\n  VERSION,\n  ViewportScroller,\n  NullViewportScroller,\n  IMAGE_LOADER,\n  provideCloudflareLoader,\n  provideCloudinaryLoader,\n  provideImageKitLoader,\n  provideImgixLoader,\n  provideNetlifyLoader,\n  PRECONNECT_CHECK_BLOCKLIST,\n  NgOptimizedImage\n};\n//# sourceMappingURL=chunk-CGVE6HH2.js.map\n"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.243Z",
        "time": 9.816000005230308,
        "timings": {
          "blocked": 8.18399999301508,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.7399999721758068,
          "receive": 0.8920000400394201,
          "_blocked_queueing": 8.12499999301508,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b",
          "lineNumber": 38
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-43XS5UPA.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "79999"
            },
            {
              "name": "Etag",
              "value": "W/\"1387f-7fHxx77Lfqij20VXwGhxWwncNm0\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 79999,
            "mimeType": "text/javascript",
            "text": "import {\n  PlatformLocation,\n  XhrFactory,\n  parseCookieValue\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b\";\nimport {\n  APP_BOOTSTRAP_LISTENER,\n  ApplicationRef,\n  DOCUMENT,\n  DestroyRef,\n  EnvironmentInjector,\n  Inject,\n  Injectable,\n  InjectionToken,\n  Injector,\n  NgModule,\n  NgZone,\n  Observable,\n  PendingTasks,\n  ResourceImpl,\n  RuntimeError,\n  TracingService,\n  TransferState,\n  __objRest,\n  __spreadProps,\n  __spreadValues,\n  assertInInjectionContext,\n  computed,\n  concatMap,\n  encapsulateResourceError,\n  filter,\n  finalize,\n  formatRuntimeError,\n  inject,\n  linkedSignal,\n  makeEnvironmentProviders,\n  makeStateKey,\n  map,\n  of,\n  performanceMarkFeature,\n  runInInjectionContext,\n  setClassMetadata,\n  signal,\n  switchMap,\n  truncateMiddle,\n  defineInjectable,\n  defineInjector,\n  defineNgModule,\n  inject\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\n\n// node_modules/@angular/common/fesm2022/_module-chunk.mjs\nvar HttpHeaders = class _HttpHeaders {\n  headers;\n  normalizedNames = /* @__PURE__ */ new Map();\n  lazyInit;\n  lazyUpdate = null;\n  constructor(headers) {\n    if (!headers) {\n      this.headers = /* @__PURE__ */ new Map();\n    } else if (typeof headers === \"string\") {\n      this.lazyInit = () => {\n        this.headers = /* @__PURE__ */ new Map();\n        headers.split(\"\\n\").forEach((line) => {\n          const index = line.indexOf(\":\");\n          if (index > 0) {\n            const name = line.slice(0, index);\n            const value = line.slice(index + 1).trim();\n            this.addHeaderEntry(name, value);\n          }\n        });\n      };\n    } else if (typeof Headers !== \"undefined\" && headers instanceof Headers) {\n      this.headers = /* @__PURE__ */ new Map();\n      headers.forEach((value, name) => {\n        this.addHeaderEntry(name, value);\n      });\n    } else {\n      this.lazyInit = () => {\n        if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n          assertValidHeaders(headers);\n        }\n        this.headers = /* @__PURE__ */ new Map();\n        Object.entries(headers).forEach(([name, values]) => {\n          this.setHeaderEntries(name, values);\n        });\n      };\n    }\n  }\n  has(name) {\n    this.init();\n    return this.headers.has(name.toLowerCase());\n  }\n  get(name) {\n    this.init();\n    const values = this.headers.get(name.toLowerCase());\n    return values && values.length > 0 ? values[0] : null;\n  }\n  keys() {\n    this.init();\n    return Array.from(this.normalizedNames.values());\n  }\n  getAll(name) {\n    this.init();\n    return this.headers.get(name.toLowerCase()) || null;\n  }\n  append(name, value) {\n    return this.clone({\n      name,\n      value,\n      op: \"a\"\n    });\n  }\n  set(name, value) {\n    return this.clone({\n      name,\n      value,\n      op: \"s\"\n    });\n  }\n  delete(name, value) {\n    return this.clone({\n      name,\n      value,\n      op: \"d\"\n    });\n  }\n  maybeSetNormalizedName(name, lcName) {\n    if (!this.normalizedNames.has(lcName)) {\n      this.normalizedNames.set(lcName, name);\n    }\n  }\n  init() {\n    if (!!this.lazyInit) {\n      if (this.lazyInit instanceof _HttpHeaders) {\n        this.copyFrom(this.lazyInit);\n      } else {\n        this.lazyInit();\n      }\n      this.lazyInit = null;\n      if (!!this.lazyUpdate) {\n        this.lazyUpdate.forEach((update) => this.applyUpdate(update));\n        this.lazyUpdate = null;\n      }\n    }\n  }\n  copyFrom(other) {\n    other.init();\n    Array.from(other.headers.keys()).forEach((key) => {\n      this.headers.set(key, other.headers.get(key));\n      this.normalizedNames.set(key, other.normalizedNames.get(key));\n    });\n  }\n  clone(update) {\n    const clone = new _HttpHeaders();\n    clone.lazyInit = !!this.lazyInit && this.lazyInit instanceof _HttpHeaders ? this.lazyInit : this;\n    clone.lazyUpdate = (this.lazyUpdate || []).concat([update]);\n    return clone;\n  }\n  applyUpdate(update) {\n    const key = update.name.toLowerCase();\n    switch (update.op) {\n      case \"a\":\n      case \"s\":\n        let value = update.value;\n        if (typeof value === \"string\") {\n          value = [value];\n        }\n        if (value.length === 0) {\n          return;\n        }\n        this.maybeSetNormalizedName(update.name, key);\n        const base = (update.op === \"a\" ? this.headers.get(key) : void 0) || [];\n        base.push(...value);\n        this.headers.set(key, base);\n        break;\n      case \"d\":\n        const toDelete = update.value;\n        if (!toDelete) {\n          this.headers.delete(key);\n          this.normalizedNames.delete(key);\n        } else {\n          let existing = this.headers.get(key);\n          if (!existing) {\n            return;\n          }\n          existing = existing.filter((value2) => toDelete.indexOf(value2) === -1);\n          if (existing.length === 0) {\n            this.headers.delete(key);\n            this.normalizedNames.delete(key);\n          } else {\n            this.headers.set(key, existing);\n          }\n        }\n        break;\n    }\n  }\n  addHeaderEntry(name, value) {\n    const key = name.toLowerCase();\n    this.maybeSetNormalizedName(name, key);\n    if (this.headers.has(key)) {\n      this.headers.get(key).push(value);\n    } else {\n      this.headers.set(key, [value]);\n    }\n  }\n  setHeaderEntries(name, values) {\n    const headerValues = (Array.isArray(values) ? values : [values]).map((value) => value.toString());\n    const key = name.toLowerCase();\n    this.headers.set(key, headerValues);\n    this.maybeSetNormalizedName(name, key);\n  }\n  forEach(fn) {\n    this.init();\n    Array.from(this.normalizedNames.keys()).forEach((key) => fn(this.normalizedNames.get(key), this.headers.get(key)));\n  }\n};\nfunction assertValidHeaders(headers) {\n  for (const [key, value] of Object.entries(headers)) {\n    if (!(typeof value === \"string\" || typeof value === \"number\") && !Array.isArray(value)) {\n      throw new Error(`Unexpected value of the \\`${key}\\` header provided. Expecting either a string, a number or an array, but got: \\`${value}\\`.`);\n    }\n  }\n}\nvar HttpContextToken = class {\n  defaultValue;\n  constructor(defaultValue) {\n    this.defaultValue = defaultValue;\n  }\n};\nvar HttpContext = class {\n  map = /* @__PURE__ */ new Map();\n  set(token, value) {\n    this.map.set(token, value);\n    return this;\n  }\n  get(token) {\n    if (!this.map.has(token)) {\n      this.map.set(token, token.defaultValue());\n    }\n    return this.map.get(token);\n  }\n  delete(token) {\n    this.map.delete(token);\n    return this;\n  }\n  has(token) {\n    return this.map.has(token);\n  }\n  keys() {\n    return this.map.keys();\n  }\n};\nvar HttpUrlEncodingCodec = class {\n  encodeKey(key) {\n    return standardEncoding(key);\n  }\n  encodeValue(value) {\n    return standardEncoding(value);\n  }\n  decodeKey(key) {\n    return decodeURIComponent(key);\n  }\n  decodeValue(value) {\n    return decodeURIComponent(value);\n  }\n};\nfunction paramParser(rawParams, codec) {\n  const map2 = /* @__PURE__ */ new Map();\n  if (rawParams.length > 0) {\n    const params = rawParams.replace(/^\\?/, \"\").split(\"&\");\n    params.forEach((param) => {\n      const eqIdx = param.indexOf(\"=\");\n      const [key, val] = eqIdx == -1 ? [codec.decodeKey(param), \"\"] : [codec.decodeKey(param.slice(0, eqIdx)), codec.decodeValue(param.slice(eqIdx + 1))];\n      const list = map2.get(key) || [];\n      list.push(val);\n      map2.set(key, list);\n    });\n  }\n  return map2;\n}\nvar STANDARD_ENCODING_REGEX = /%(\\d[a-f0-9])/gi;\nvar STANDARD_ENCODING_REPLACEMENTS = {\n  \"40\": \"@\",\n  \"3A\": \":\",\n  \"24\": \"$\",\n  \"2C\": \",\",\n  \"3B\": \";\",\n  \"3D\": \"=\",\n  \"3F\": \"?\",\n  \"2F\": \"/\"\n};\nfunction standardEncoding(v) {\n  return encodeURIComponent(v).replace(STANDARD_ENCODING_REGEX, (s, t) => STANDARD_ENCODING_REPLACEMENTS[t] ?? s);\n}\nfunction valueToString(value) {\n  return `${value}`;\n}\nvar HttpParams = class _HttpParams {\n  map;\n  encoder;\n  updates = null;\n  cloneFrom = null;\n  constructor(options = {}) {\n    this.encoder = options.encoder || new HttpUrlEncodingCodec();\n    if (options.fromString) {\n      if (options.fromObject) {\n        throw new RuntimeError(2805, ngDevMode && \"Cannot specify both fromString and fromObject.\");\n      }\n      this.map = paramParser(options.fromString, this.encoder);\n    } else if (!!options.fromObject) {\n      this.map = /* @__PURE__ */ new Map();\n      Object.keys(options.fromObject).forEach((key) => {\n        const value = options.fromObject[key];\n        const values = Array.isArray(value) ? value.map(valueToString) : [valueToString(value)];\n        this.map.set(key, values);\n      });\n    } else {\n      this.map = null;\n    }\n  }\n  has(param) {\n    this.init();\n    return this.map.has(param);\n  }\n  get(param) {\n    this.init();\n    const res = this.map.get(param);\n    return !!res ? res[0] : null;\n  }\n  getAll(param) {\n    this.init();\n    return this.map.get(param) || null;\n  }\n  keys() {\n    this.init();\n    return Array.from(this.map.keys());\n  }\n  append(param, value) {\n    return this.clone({\n      param,\n      value,\n      op: \"a\"\n    });\n  }\n  appendAll(params) {\n    const updates = [];\n    Object.keys(params).forEach((param) => {\n      const value = params[param];\n      if (Array.isArray(value)) {\n        value.forEach((_value) => {\n          updates.push({\n            param,\n            value: _value,\n            op: \"a\"\n          });\n        });\n      } else {\n        updates.push({\n          param,\n          value,\n          op: \"a\"\n        });\n      }\n    });\n    return this.clone(updates);\n  }\n  set(param, value) {\n    return this.clone({\n      param,\n      value,\n      op: \"s\"\n    });\n  }\n  delete(param, value) {\n    return this.clone({\n      param,\n      value,\n      op: \"d\"\n    });\n  }\n  toString() {\n    this.init();\n    return this.keys().map((key) => {\n      const eKey = this.encoder.encodeKey(key);\n      return this.map.get(key).map((value) => eKey + \"=\" + this.encoder.encodeValue(value)).join(\"&\");\n    }).filter((param) => param !== \"\").join(\"&\");\n  }\n  clone(update) {\n    const clone = new _HttpParams({\n      encoder: this.encoder\n    });\n    clone.cloneFrom = this.cloneFrom || this;\n    clone.updates = (this.updates || []).concat(update);\n    return clone;\n  }\n  init() {\n    if (this.map === null) {\n      this.map = /* @__PURE__ */ new Map();\n    }\n    if (this.cloneFrom !== null) {\n      this.cloneFrom.init();\n      this.cloneFrom.keys().forEach((key) => this.map.set(key, this.cloneFrom.map.get(key)));\n      this.updates.forEach((update) => {\n        switch (update.op) {\n          case \"a\":\n          case \"s\":\n            const base = (update.op === \"a\" ? this.map.get(update.param) : void 0) || [];\n            base.push(valueToString(update.value));\n            this.map.set(update.param, base);\n            break;\n          case \"d\":\n            if (update.value !== void 0) {\n              let base2 = this.map.get(update.param) || [];\n              const idx = base2.indexOf(valueToString(update.value));\n              if (idx !== -1) {\n                base2.splice(idx, 1);\n              }\n              if (base2.length > 0) {\n                this.map.set(update.param, base2);\n              } else {\n                this.map.delete(update.param);\n              }\n            } else {\n              this.map.delete(update.param);\n              break;\n            }\n        }\n      });\n      this.cloneFrom = this.updates = null;\n    }\n  }\n};\nfunction mightHaveBody(method) {\n  switch (method) {\n    case \"DELETE\":\n    case \"GET\":\n    case \"HEAD\":\n    case \"OPTIONS\":\n    case \"JSONP\":\n      return false;\n    default:\n      return true;\n  }\n}\nfunction isArrayBuffer(value) {\n  return typeof ArrayBuffer !== \"undefined\" && value instanceof ArrayBuffer;\n}\nfunction isBlob(value) {\n  return typeof Blob !== \"undefined\" && value instanceof Blob;\n}\nfunction isFormData(value) {\n  return typeof FormData !== \"undefined\" && value instanceof FormData;\n}\nfunction isUrlSearchParams(value) {\n  return typeof URLSearchParams !== \"undefined\" && value instanceof URLSearchParams;\n}\nvar CONTENT_TYPE_HEADER = \"Content-Type\";\nvar ACCEPT_HEADER = \"Accept\";\nvar TEXT_CONTENT_TYPE = \"text/plain\";\nvar JSON_CONTENT_TYPE = \"application/json\";\nvar ACCEPT_HEADER_VALUE = `${JSON_CONTENT_TYPE}, ${TEXT_CONTENT_TYPE}, */*`;\nvar HttpRequest = class _HttpRequest {\n  url;\n  body = null;\n  headers;\n  context;\n  reportProgress = false;\n  withCredentials = false;\n  credentials;\n  keepalive = false;\n  cache;\n  priority;\n  mode;\n  redirect;\n  referrer;\n  integrity;\n  referrerPolicy;\n  responseType = \"json\";\n  method;\n  params;\n  urlWithParams;\n  transferCache;\n  timeout;\n  constructor(method, url, third, fourth) {\n    this.url = url;\n    this.method = method.toUpperCase();\n    let options;\n    if (mightHaveBody(this.method) || !!fourth) {\n      this.body = third !== void 0 ? third : null;\n      options = fourth;\n    } else {\n      options = third;\n    }\n    if (options) {\n      this.reportProgress = !!options.reportProgress;\n      this.withCredentials = !!options.withCredentials;\n      this.keepalive = !!options.keepalive;\n      if (!!options.responseType) {\n        this.responseType = options.responseType;\n      }\n      if (options.headers) {\n        this.headers = options.headers;\n      }\n      if (options.context) {\n        this.context = options.context;\n      }\n      if (options.params) {\n        this.params = options.params;\n      }\n      if (options.priority) {\n        this.priority = options.priority;\n      }\n      if (options.cache) {\n        this.cache = options.cache;\n      }\n      if (options.credentials) {\n        this.credentials = options.credentials;\n      }\n      if (typeof options.timeout === \"number\") {\n        if (options.timeout < 1 || !Number.isInteger(options.timeout)) {\n          throw new RuntimeError(2822, ngDevMode ? \"`timeout` must be a positive integer value\" : \"\");\n        }\n        this.timeout = options.timeout;\n      }\n      if (options.mode) {\n        this.mode = options.mode;\n      }\n      if (options.redirect) {\n        this.redirect = options.redirect;\n      }\n      if (options.integrity) {\n        this.integrity = options.integrity;\n      }\n      if (options.referrer) {\n        this.referrer = options.referrer;\n      }\n      if (options.referrerPolicy) {\n        this.referrerPolicy = options.referrerPolicy;\n      }\n      this.transferCache = options.transferCache;\n    }\n    this.headers ??= new HttpHeaders();\n    this.context ??= new HttpContext();\n    if (!this.params) {\n      this.params = new HttpParams();\n      this.urlWithParams = url;\n    } else {\n      const params = this.params.toString();\n      if (params.length === 0) {\n        this.urlWithParams = url;\n      } else {\n        const qIdx = url.indexOf(\"?\");\n        const sep = qIdx === -1 ? \"?\" : qIdx < url.length - 1 ? \"&\" : \"\";\n        this.urlWithParams = url + sep + params;\n      }\n    }\n  }\n  serializeBody() {\n    if (this.body === null) {\n      return null;\n    }\n    if (typeof this.body === \"string\" || isArrayBuffer(this.body) || isBlob(this.body) || isFormData(this.body) || isUrlSearchParams(this.body)) {\n      return this.body;\n    }\n    if (this.body instanceof HttpParams) {\n      return this.body.toString();\n    }\n    if (typeof this.body === \"object\" || typeof this.body === \"boolean\" || Array.isArray(this.body)) {\n      return JSON.stringify(this.body);\n    }\n    return this.body.toString();\n  }\n  detectContentTypeHeader() {\n    if (this.body === null) {\n      return null;\n    }\n    if (isFormData(this.body)) {\n      return null;\n    }\n    if (isBlob(this.body)) {\n      return this.body.type || null;\n    }\n    if (isArrayBuffer(this.body)) {\n      return null;\n    }\n    if (typeof this.body === \"string\") {\n      return TEXT_CONTENT_TYPE;\n    }\n    if (this.body instanceof HttpParams) {\n      return \"application/x-www-form-urlencoded;charset=UTF-8\";\n    }\n    if (typeof this.body === \"object\" || typeof this.body === \"number\" || typeof this.body === \"boolean\") {\n      return JSON_CONTENT_TYPE;\n    }\n    return null;\n  }\n  clone(update = {}) {\n    const method = update.method || this.method;\n    const url = update.url || this.url;\n    const responseType = update.responseType || this.responseType;\n    const keepalive = update.keepalive ?? this.keepalive;\n    const priority = update.priority || this.priority;\n    const cache = update.cache || this.cache;\n    const mode = update.mode || this.mode;\n    const redirect = update.redirect || this.redirect;\n    const credentials = update.credentials || this.credentials;\n    const referrer = update.referrer || this.referrer;\n    const integrity = update.integrity || this.integrity;\n    const referrerPolicy = update.referrerPolicy || this.referrerPolicy;\n    const transferCache = update.transferCache ?? this.transferCache;\n    const timeout = update.timeout ?? this.timeout;\n    const body = update.body !== void 0 ? update.body : this.body;\n    const withCredentials = update.withCredentials ?? this.withCredentials;\n    const reportProgress = update.reportProgress ?? this.reportProgress;\n    let headers = update.headers || this.headers;\n    let params = update.params || this.params;\n    const context = update.context ?? this.context;\n    if (update.setHeaders !== void 0) {\n      headers = Object.keys(update.setHeaders).reduce((headers2, name) => headers2.set(name, update.setHeaders[name]), headers);\n    }\n    if (update.setParams) {\n      params = Object.keys(update.setParams).reduce((params2, param) => params2.set(param, update.setParams[param]), params);\n    }\n    return new _HttpRequest(method, url, body, {\n      params,\n      headers,\n      context,\n      reportProgress,\n      responseType,\n      withCredentials,\n      transferCache,\n      keepalive,\n      cache,\n      priority,\n      timeout,\n      mode,\n      redirect,\n      credentials,\n      referrer,\n      integrity,\n      referrerPolicy\n    });\n  }\n};\nvar HttpEventType;\n(function(HttpEventType2) {\n  HttpEventType2[HttpEventType2[\"Sent\"] = 0] = \"Sent\";\n  HttpEventType2[HttpEventType2[\"UploadProgress\"] = 1] = \"UploadProgress\";\n  HttpEventType2[HttpEventType2[\"ResponseHeader\"] = 2] = \"ResponseHeader\";\n  HttpEventType2[HttpEventType2[\"DownloadProgress\"] = 3] = \"DownloadProgress\";\n  HttpEventType2[HttpEventType2[\"Response\"] = 4] = \"Response\";\n  HttpEventType2[HttpEventType2[\"User\"] = 5] = \"User\";\n})(HttpEventType || (HttpEventType = {}));\nvar HttpResponseBase = class {\n  headers;\n  status;\n  statusText;\n  url;\n  ok;\n  type;\n  redirected;\n  responseType;\n  constructor(init, defaultStatus = 200, defaultStatusText = \"OK\") {\n    this.headers = init.headers || new HttpHeaders();\n    this.status = init.status !== void 0 ? init.status : defaultStatus;\n    this.statusText = init.statusText || defaultStatusText;\n    this.url = init.url || null;\n    this.redirected = init.redirected;\n    this.responseType = init.responseType;\n    this.ok = this.status >= 200 && this.status < 300;\n  }\n};\nvar HttpHeaderResponse = class _HttpHeaderResponse extends HttpResponseBase {\n  constructor(init = {}) {\n    super(init);\n  }\n  type = HttpEventType.ResponseHeader;\n  clone(update = {}) {\n    return new _HttpHeaderResponse({\n      headers: update.headers || this.headers,\n      status: update.status !== void 0 ? update.status : this.status,\n      statusText: update.statusText || this.statusText,\n      url: update.url || this.url || void 0\n    });\n  }\n};\nvar HttpResponse = class _HttpResponse extends HttpResponseBase {\n  body;\n  constructor(init = {}) {\n    super(init);\n    this.body = init.body !== void 0 ? init.body : null;\n  }\n  type = HttpEventType.Response;\n  clone(update = {}) {\n    return new _HttpResponse({\n      body: update.body !== void 0 ? update.body : this.body,\n      headers: update.headers || this.headers,\n      status: update.status !== void 0 ? update.status : this.status,\n      statusText: update.statusText || this.statusText,\n      url: update.url || this.url || void 0,\n      redirected: update.redirected ?? this.redirected,\n      responseType: update.responseType ?? this.responseType\n    });\n  }\n};\nvar HttpErrorResponse = class extends HttpResponseBase {\n  name = \"HttpErrorResponse\";\n  message;\n  error;\n  ok = false;\n  constructor(init) {\n    super(init, 0, \"Unknown Error\");\n    if (this.status >= 200 && this.status < 300) {\n      this.message = `Http failure during parsing for ${init.url || \"(unknown url)\"}`;\n    } else {\n      this.message = `Http failure response for ${init.url || \"(unknown url)\"}: ${init.status} ${init.statusText}`;\n    }\n    this.error = init.error || null;\n  }\n};\nvar HTTP_STATUS_CODE_OK = 200;\nvar HTTP_STATUS_CODE_NO_CONTENT = 204;\nvar HttpStatusCode;\n(function(HttpStatusCode2) {\n  HttpStatusCode2[HttpStatusCode2[\"Continue\"] = 100] = \"Continue\";\n  HttpStatusCode2[HttpStatusCode2[\"SwitchingProtocols\"] = 101] = \"SwitchingProtocols\";\n  HttpStatusCode2[HttpStatusCode2[\"Processing\"] = 102] = \"Processing\";\n  HttpStatusCode2[HttpStatusCode2[\"EarlyHints\"] = 103] = \"EarlyHints\";\n  HttpStatusCode2[HttpStatusCode2[\"Ok\"] = 200] = \"Ok\";\n  HttpStatusCode2[HttpStatusCode2[\"Created\"] = 201] = \"Created\";\n  HttpStatusCode2[HttpStatusCode2[\"Accepted\"] = 202] = \"Accepted\";\n  HttpStatusCode2[HttpStatusCode2[\"NonAuthoritativeInformation\"] = 203] = \"NonAuthoritativeInformation\";\n  HttpStatusCode2[HttpStatusCode2[\"NoContent\"] = 204] = \"NoContent\";\n  HttpStatusCode2[HttpStatusCode2[\"ResetContent\"] = 205] = \"ResetContent\";\n  HttpStatusCode2[HttpStatusCode2[\"PartialContent\"] = 206] = \"PartialContent\";\n  HttpStatusCode2[HttpStatusCode2[\"MultiStatus\"] = 207] = \"MultiStatus\";\n  HttpStatusCode2[HttpStatusCode2[\"AlreadyReported\"] = 208] = \"AlreadyReported\";\n  HttpStatusCode2[HttpStatusCode2[\"ImUsed\"] = 226] = \"ImUsed\";\n  HttpStatusCode2[HttpStatusCode2[\"MultipleChoices\"] = 300] = \"MultipleChoices\";\n  HttpStatusCode2[HttpStatusCode2[\"MovedPermanently\"] = 301] = \"MovedPermanently\";\n  HttpStatusCode2[HttpStatusCode2[\"Found\"] = 302] = \"Found\";\n  HttpStatusCode2[HttpStatusCode2[\"SeeOther\"] = 303] = \"SeeOther\";\n  HttpStatusCode2[HttpStatusCode2[\"NotModified\"] = 304] = \"NotModified\";\n  HttpStatusCode2[HttpStatusCode2[\"UseProxy\"] = 305] = \"UseProxy\";\n  HttpStatusCode2[HttpStatusCode2[\"Unused\"] = 306] = \"Unused\";\n  HttpStatusCode2[HttpStatusCode2[\"TemporaryRedirect\"] = 307] = \"TemporaryRedirect\";\n  HttpStatusCode2[HttpStatusCode2[\"PermanentRedirect\"] = 308] = \"PermanentRedirect\";\n  HttpStatusCode2[HttpStatusCode2[\"BadRequest\"] = 400] = \"BadRequest\";\n  HttpStatusCode2[HttpStatusCode2[\"Unauthorized\"] = 401] = \"Unauthorized\";\n  HttpStatusCode2[HttpStatusCode2[\"PaymentRequired\"] = 402] = \"PaymentRequired\";\n  HttpStatusCode2[HttpStatusCode2[\"Forbidden\"] = 403] = \"Forbidden\";\n  HttpStatusCode2[HttpStatusCode2[\"NotFound\"] = 404] = \"NotFound\";\n  HttpStatusCode2[HttpStatusCode2[\"MethodNotAllowed\"] = 405] = \"MethodNotAllowed\";\n  HttpStatusCode2[HttpStatusCode2[\"NotAcceptable\"] = 406] = \"NotAcceptable\";\n  HttpStatusCode2[HttpStatusCode2[\"ProxyAuthenticationRequired\"] = 407] = \"ProxyAuthenticationRequired\";\n  HttpStatusCode2[HttpStatusCode2[\"RequestTimeout\"] = 408] = \"RequestTimeout\";\n  HttpStatusCode2[HttpStatusCode2[\"Conflict\"] = 409] = \"Conflict\";\n  HttpStatusCode2[HttpStatusCode2[\"Gone\"] = 410] = \"Gone\";\n  HttpStatusCode2[HttpStatusCode2[\"LengthRequired\"] = 411] = \"LengthRequired\";\n  HttpStatusCode2[HttpStatusCode2[\"PreconditionFailed\"] = 412] = \"PreconditionFailed\";\n  HttpStatusCode2[HttpStatusCode2[\"PayloadTooLarge\"] = 413] = \"PayloadTooLarge\";\n  HttpStatusCode2[HttpStatusCode2[\"UriTooLong\"] = 414] = \"UriTooLong\";\n  HttpStatusCode2[HttpStatusCode2[\"UnsupportedMediaType\"] = 415] = \"UnsupportedMediaType\";\n  HttpStatusCode2[HttpStatusCode2[\"RangeNotSatisfiable\"] = 416] = \"RangeNotSatisfiable\";\n  HttpStatusCode2[HttpStatusCode2[\"ExpectationFailed\"] = 417] = \"ExpectationFailed\";\n  HttpStatusCode2[HttpStatusCode2[\"ImATeapot\"] = 418] = \"ImATeapot\";\n  HttpStatusCode2[HttpStatusCode2[\"MisdirectedRequest\"] = 421] = \"MisdirectedRequest\";\n  HttpStatusCode2[HttpStatusCode2[\"UnprocessableEntity\"] = 422] = \"UnprocessableEntity\";\n  HttpStatusCode2[HttpStatusCode2[\"Locked\"] = 423] = \"Locked\";\n  HttpStatusCode2[HttpStatusCode2[\"FailedDependency\"] = 424] = \"FailedDependency\";\n  HttpStatusCode2[HttpStatusCode2[\"TooEarly\"] = 425] = \"TooEarly\";\n  HttpStatusCode2[HttpStatusCode2[\"UpgradeRequired\"] = 426] = \"UpgradeRequired\";\n  HttpStatusCode2[HttpStatusCode2[\"PreconditionRequired\"] = 428] = \"PreconditionRequired\";\n  HttpStatusCode2[HttpStatusCode2[\"TooManyRequests\"] = 429] = \"TooManyRequests\";\n  HttpStatusCode2[HttpStatusCode2[\"RequestHeaderFieldsTooLarge\"] = 431] = \"RequestHeaderFieldsTooLarge\";\n  HttpStatusCode2[HttpStatusCode2[\"UnavailableForLegalReasons\"] = 451] = \"UnavailableForLegalReasons\";\n  HttpStatusCode2[HttpStatusCode2[\"InternalServerError\"] = 500] = \"InternalServerError\";\n  HttpStatusCode2[HttpStatusCode2[\"NotImplemented\"] = 501] = \"NotImplemented\";\n  HttpStatusCode2[HttpStatusCode2[\"BadGateway\"] = 502] = \"BadGateway\";\n  HttpStatusCode2[HttpStatusCode2[\"ServiceUnavailable\"] = 503] = \"ServiceUnavailable\";\n  HttpStatusCode2[HttpStatusCode2[\"GatewayTimeout\"] = 504] = \"GatewayTimeout\";\n  HttpStatusCode2[HttpStatusCode2[\"HttpVersionNotSupported\"] = 505] = \"HttpVersionNotSupported\";\n  HttpStatusCode2[HttpStatusCode2[\"VariantAlsoNegotiates\"] = 506] = \"VariantAlsoNegotiates\";\n  HttpStatusCode2[HttpStatusCode2[\"InsufficientStorage\"] = 507] = \"InsufficientStorage\";\n  HttpStatusCode2[HttpStatusCode2[\"LoopDetected\"] = 508] = \"LoopDetected\";\n  HttpStatusCode2[HttpStatusCode2[\"NotExtended\"] = 510] = \"NotExtended\";\n  HttpStatusCode2[HttpStatusCode2[\"NetworkAuthenticationRequired\"] = 511] = \"NetworkAuthenticationRequired\";\n})(HttpStatusCode || (HttpStatusCode = {}));\nvar XSSI_PREFIX$1 = /^\\)\\]\\}',?\\n/;\nvar FETCH_BACKEND = new InjectionToken(typeof ngDevMode === \"undefined\" || ngDevMode ? \"FETCH_BACKEND\" : \"\");\nvar FetchBackend = class _FetchBackend {\n  fetchImpl = inject(FetchFactory, {\n    optional: true\n  })?.fetch ?? ((...args) => globalThis.fetch(...args));\n  ngZone = inject(NgZone);\n  destroyRef = inject(DestroyRef);\n  handle(request) {\n    return new Observable((observer) => {\n      const aborter = new AbortController();\n      this.doRequest(request, aborter.signal, observer).then(noop, (error) => observer.error(new HttpErrorResponse({\n        error\n      })));\n      let timeoutId;\n      if (request.timeout) {\n        timeoutId = this.ngZone.runOutsideAngular(() => setTimeout(() => {\n          if (!aborter.signal.aborted) {\n            aborter.abort(new DOMException(\"signal timed out\", \"TimeoutError\"));\n          }\n        }, request.timeout));\n      }\n      return () => {\n        if (timeoutId !== void 0) {\n          clearTimeout(timeoutId);\n        }\n        aborter.abort();\n      };\n    });\n  }\n  async doRequest(request, signal2, observer) {\n    const init = this.createRequestInit(request);\n    let response;\n    try {\n      const fetchPromise = this.ngZone.runOutsideAngular(() => this.fetchImpl(request.urlWithParams, __spreadValues({\n        signal: signal2\n      }, init)));\n      silenceSuperfluousUnhandledPromiseRejection(fetchPromise);\n      observer.next({\n        type: HttpEventType.Sent\n      });\n      response = await fetchPromise;\n    } catch (error) {\n      observer.error(new HttpErrorResponse({\n        error,\n        status: error.status ?? 0,\n        statusText: error.statusText,\n        url: request.urlWithParams,\n        headers: error.headers\n      }));\n      return;\n    }\n    const headers = new HttpHeaders(response.headers);\n    const statusText = response.statusText;\n    const url = response.url || request.urlWithParams;\n    let status = response.status;\n    let body = null;\n    if (request.reportProgress) {\n      observer.next(new HttpHeaderResponse({\n        headers,\n        status,\n        statusText,\n        url\n      }));\n    }\n    if (response.body) {\n      const contentLength = response.headers.get(\"content-length\");\n      const chunks = [];\n      const reader = response.body.getReader();\n      let receivedLength = 0;\n      let decoder;\n      let partialText;\n      const reqZone = typeof Zone !== \"undefined\" && Zone.current;\n      let canceled = false;\n      await this.ngZone.runOutsideAngular(async () => {\n        while (true) {\n          if (this.destroyRef.destroyed) {\n            await reader.cancel();\n            canceled = true;\n            break;\n          }\n          const {\n            done,\n            value\n          } = await reader.read();\n          if (done) {\n            break;\n          }\n          chunks.push(value);\n          receivedLength += value.length;\n          if (request.reportProgress) {\n            partialText = request.responseType === \"text\" ? (partialText ?? \"\") + (decoder ??= new TextDecoder()).decode(value, {\n              stream: true\n            }) : void 0;\n            const reportProgress = () => observer.next({\n              type: HttpEventType.DownloadProgress,\n              total: contentLength ? +contentLength : void 0,\n              loaded: receivedLength,\n              partialText\n            });\n            reqZone ? reqZone.run(reportProgress) : reportProgress();\n          }\n        }\n      });\n      if (canceled) {\n        observer.complete();\n        return;\n      }\n      const chunksAll = this.concatChunks(chunks, receivedLength);\n      try {\n        const contentType = response.headers.get(CONTENT_TYPE_HEADER) ?? \"\";\n        body = this.parseBody(request, chunksAll, contentType, status);\n      } catch (error) {\n        observer.error(new HttpErrorResponse({\n          error,\n          headers: new HttpHeaders(response.headers),\n          status: response.status,\n          statusText: response.statusText,\n          url: response.url || request.urlWithParams\n        }));\n        return;\n      }\n    }\n    if (status === 0) {\n      status = body ? HTTP_STATUS_CODE_OK : 0;\n    }\n    const ok = status >= 200 && status < 300;\n    const redirected = response.redirected;\n    const responseType = response.type;\n    if (ok) {\n      observer.next(new HttpResponse({\n        body,\n        headers,\n        status,\n        statusText,\n        url,\n        redirected,\n        responseType\n      }));\n      observer.complete();\n    } else {\n      observer.error(new HttpErrorResponse({\n        error: body,\n        headers,\n        status,\n        statusText,\n        url,\n        redirected,\n        responseType\n      }));\n    }\n  }\n  parseBody(request, binContent, contentType, status) {\n    switch (request.responseType) {\n      case \"json\":\n        const text = new TextDecoder().decode(binContent).replace(XSSI_PREFIX$1, \"\");\n        if (text === \"\") {\n          return null;\n        }\n        try {\n          return JSON.parse(text);\n        } catch (e) {\n          if (status < 200 || status >= 300) {\n            return text;\n          }\n          throw e;\n        }\n      case \"text\":\n        return new TextDecoder().decode(binContent);\n      case \"blob\":\n        return new Blob([binContent], {\n          type: contentType\n        });\n      case \"arraybuffer\":\n        return binContent.buffer;\n    }\n  }\n  createRequestInit(req) {\n    const headers = {};\n    let credentials;\n    credentials = req.credentials;\n    if (req.withCredentials) {\n      (typeof ngDevMode === \"undefined\" || ngDevMode) && warningOptionsMessage(req);\n      credentials = \"include\";\n    }\n    req.headers.forEach((name, values) => headers[name] = values.join(\",\"));\n    if (!req.headers.has(ACCEPT_HEADER)) {\n      headers[ACCEPT_HEADER] = ACCEPT_HEADER_VALUE;\n    }\n    if (!req.headers.has(CONTENT_TYPE_HEADER)) {\n      const detectedType = req.detectContentTypeHeader();\n      if (detectedType !== null) {\n        headers[CONTENT_TYPE_HEADER] = detectedType;\n      }\n    }\n    return {\n      body: req.serializeBody(),\n      method: req.method,\n      headers,\n      credentials,\n      keepalive: req.keepalive,\n      cache: req.cache,\n      priority: req.priority,\n      mode: req.mode,\n      redirect: req.redirect,\n      referrer: req.referrer,\n      integrity: req.integrity,\n      referrerPolicy: req.referrerPolicy\n    };\n  }\n  concatChunks(chunks, totalLength) {\n    const chunksAll = new Uint8Array(totalLength);\n    let position = 0;\n    for (const chunk of chunks) {\n      chunksAll.set(chunk, position);\n      position += chunk.length;\n    }\n    return chunksAll;\n  }\n  static fac = function FetchBackend_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _FetchBackend)();\n  };\n  static prov = defineInjectable({\n    token: _FetchBackend,\n    factory: _FetchBackend.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(FetchBackend, [{\n    type: Injectable\n  }], null, null);\n})();\nvar FetchFactory = class {\n};\nfunction noop() {\n}\nfunction warningOptionsMessage(req) {\n  if (req.credentials && req.withCredentials) {\n    console.warn(formatRuntimeError(2819, `Angular detected that a \\`HttpClient\\` request has both \\`withCredentials: true\\` and \\`credentials: '${req.credentials}'\\` options. The \\`withCredentials\\` option is overriding the explicit \\`credentials\\` setting to 'include'. Consider removing \\`withCredentials\\` and using \\`credentials: '${req.credentials}'\\` directly for clarity.`));\n  }\n}\nfunction silenceSuperfluousUnhandledPromiseRejection(promise) {\n  promise.then(noop, noop);\n}\nvar XSSI_PREFIX = /^\\)\\]\\}',?\\n/;\nfunction validateXhrCompatibility(req) {\n  const unsupportedOptions = [{\n    property: \"keepalive\",\n    errorCode: 2813\n  }, {\n    property: \"cache\",\n    errorCode: 2814\n  }, {\n    property: \"priority\",\n    errorCode: 2815\n  }, {\n    property: \"mode\",\n    errorCode: 2816\n  }, {\n    property: \"redirect\",\n    errorCode: 2817\n  }, {\n    property: \"credentials\",\n    errorCode: 2818\n  }, {\n    property: \"integrity\",\n    errorCode: 2820\n  }, {\n    property: \"referrer\",\n    errorCode: 2821\n  }, {\n    property: \"referrerPolicy\",\n    errorCode: 2823\n  }];\n  for (const {\n    property,\n    errorCode\n  } of unsupportedOptions) {\n    if (req[property]) {\n      console.warn(formatRuntimeError(errorCode, `Angular detected that a \\`HttpClient\\` request with the \\`${property}\\` option was sent using XHR, which does not support it. To use the \\`${property}\\` option, enable Fetch API support by passing \\`withFetch()\\` as an argument to \\`provideHttpClient()\\`.`));\n    }\n  }\n}\nvar HttpXhrBackend = class _HttpXhrBackend {\n  xhrFactory;\n  tracingService = inject(TracingService, {\n    optional: true\n  });\n  constructor(xhrFactory) {\n    this.xhrFactory = xhrFactory;\n  }\n  maybePropagateTrace(fn) {\n    return this.tracingService?.propagate ? this.tracingService.propagate(fn) : fn;\n  }\n  handle(req) {\n    if (req.method === \"JSONP\") {\n      throw new RuntimeError(-2800, (typeof ngDevMode === \"undefined\" || ngDevMode) && `Cannot make a JSONP request without JSONP support. To fix the problem, either add the \\`withJsonpSupport()\\` call (if \\`provideHttpClient()\\` is used) or import the \\`HttpClientJsonpModule\\` in the root NgModule.`);\n    }\n    ngDevMode && validateXhrCompatibility(req);\n    const xhrFactory = this.xhrFactory;\n    const source = false ? from(xhrFactory.loadImpl()) : of(null);\n    return source.pipe(switchMap(() => {\n      return new Observable((observer) => {\n        const xhr = xhrFactory.build();\n        xhr.open(req.method, req.urlWithParams);\n        if (req.withCredentials) {\n          xhr.withCredentials = true;\n        }\n        req.headers.forEach((name, values) => xhr.setRequestHeader(name, values.join(\",\")));\n        if (!req.headers.has(ACCEPT_HEADER)) {\n          xhr.setRequestHeader(ACCEPT_HEADER, ACCEPT_HEADER_VALUE);\n        }\n        if (!req.headers.has(CONTENT_TYPE_HEADER)) {\n          const detectedType = req.detectContentTypeHeader();\n          if (detectedType !== null) {\n            xhr.setRequestHeader(CONTENT_TYPE_HEADER, detectedType);\n          }\n        }\n        if (req.timeout) {\n          xhr.timeout = req.timeout;\n        }\n        if (req.responseType) {\n          const responseType = req.responseType.toLowerCase();\n          xhr.responseType = responseType !== \"json\" ? responseType : \"text\";\n        }\n        const reqBody = req.serializeBody();\n        let headerResponse = null;\n        const partialFromXhr = () => {\n          if (headerResponse !== null) {\n            return headerResponse;\n          }\n          const statusText = xhr.statusText || \"OK\";\n          const headers = new HttpHeaders(xhr.getAllResponseHeaders());\n          const url = xhr.responseURL || req.url;\n          headerResponse = new HttpHeaderResponse({\n            headers,\n            status: xhr.status,\n            statusText,\n            url\n          });\n          return headerResponse;\n        };\n        const onLoad = this.maybePropagateTrace(() => {\n          let {\n            headers,\n            status,\n            statusText,\n            url\n          } = partialFromXhr();\n          let body = null;\n          if (status !== HTTP_STATUS_CODE_NO_CONTENT) {\n            body = typeof xhr.response === \"undefined\" ? xhr.responseText : xhr.response;\n          }\n          if (status === 0) {\n            status = !!body ? HTTP_STATUS_CODE_OK : 0;\n          }\n          let ok = status >= 200 && status < 300;\n          if (req.responseType === \"json\" && typeof body === \"string\") {\n            const originalBody = body;\n            body = body.replace(XSSI_PREFIX, \"\");\n            try {\n              body = body !== \"\" ? JSON.parse(body) : null;\n            } catch (error) {\n              body = originalBody;\n              if (ok) {\n                ok = false;\n                body = {\n                  error,\n                  text: body\n                };\n              }\n            }\n          }\n          if (ok) {\n            observer.next(new HttpResponse({\n              body,\n              headers,\n              status,\n              statusText,\n              url: url || void 0\n            }));\n            observer.complete();\n          } else {\n            observer.error(new HttpErrorResponse({\n              error: body,\n              headers,\n              status,\n              statusText,\n              url: url || void 0\n            }));\n          }\n        });\n        const onError = this.maybePropagateTrace((error) => {\n          const {\n            url\n          } = partialFromXhr();\n          const res = new HttpErrorResponse({\n            error,\n            status: xhr.status || 0,\n            statusText: xhr.statusText || \"Unknown Error\",\n            url: url || void 0\n          });\n          observer.error(res);\n        });\n        let onTimeout = onError;\n        if (req.timeout) {\n          onTimeout = this.maybePropagateTrace((_) => {\n            const {\n              url\n            } = partialFromXhr();\n            const res = new HttpErrorResponse({\n              error: new DOMException(\"Request timed out\", \"TimeoutError\"),\n              status: xhr.status || 0,\n              statusText: xhr.statusText || \"Request timeout\",\n              url: url || void 0\n            });\n            observer.error(res);\n          });\n        }\n        let sentHeaders = false;\n        const onDownProgress = this.maybePropagateTrace((event) => {\n          if (!sentHeaders) {\n            observer.next(partialFromXhr());\n            sentHeaders = true;\n          }\n          let progressEvent = {\n            type: HttpEventType.DownloadProgress,\n            loaded: event.loaded\n          };\n          if (event.lengthComputable) {\n            progressEvent.total = event.total;\n          }\n          if (req.responseType === \"text\" && !!xhr.responseText) {\n            progressEvent.partialText = xhr.responseText;\n          }\n          observer.next(progressEvent);\n        });\n        const onUpProgress = this.maybePropagateTrace((event) => {\n          let progress = {\n            type: HttpEventType.UploadProgress,\n            loaded: event.loaded\n          };\n          if (event.lengthComputable) {\n            progress.total = event.total;\n          }\n          observer.next(progress);\n        });\n        xhr.addEventListener(\"load\", onLoad);\n        xhr.addEventListener(\"error\", onError);\n        xhr.addEventListener(\"timeout\", onTimeout);\n        xhr.addEventListener(\"abort\", onError);\n        if (req.reportProgress) {\n          xhr.addEventListener(\"progress\", onDownProgress);\n          if (reqBody !== null && xhr.upload) {\n            xhr.upload.addEventListener(\"progress\", onUpProgress);\n          }\n        }\n        xhr.send(reqBody);\n        observer.next({\n          type: HttpEventType.Sent\n        });\n        return () => {\n          xhr.removeEventListener(\"error\", onError);\n          xhr.removeEventListener(\"abort\", onError);\n          xhr.removeEventListener(\"load\", onLoad);\n          xhr.removeEventListener(\"timeout\", onTimeout);\n          if (req.reportProgress) {\n            xhr.removeEventListener(\"progress\", onDownProgress);\n            if (reqBody !== null && xhr.upload) {\n              xhr.upload.removeEventListener(\"progress\", onUpProgress);\n            }\n          }\n          if (xhr.readyState !== xhr.DONE) {\n            xhr.abort();\n          }\n        };\n      });\n    }));\n  }\n  static fac = function HttpXhrBackend_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpXhrBackend)(inject(XhrFactory));\n  };\n  static prov = defineInjectable({\n    token: _HttpXhrBackend,\n    factory: _HttpXhrBackend.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpXhrBackend, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: XhrFactory\n  }], null);\n})();\nfunction interceptorChainEndFn(req, finalHandlerFn) {\n  return finalHandlerFn(req);\n}\nfunction adaptLegacyInterceptorToChain(chainTailFn, interceptor) {\n  return (initialRequest, finalHandlerFn) => interceptor.intercept(initialRequest, {\n    handle: (downstreamRequest) => chainTailFn(downstreamRequest, finalHandlerFn)\n  });\n}\nfunction chainedInterceptorFn(chainTailFn, interceptorFn, injector) {\n  return (initialRequest, finalHandlerFn) => runInInjectionContext(injector, () => interceptorFn(initialRequest, (downstreamRequest) => chainTailFn(downstreamRequest, finalHandlerFn)));\n}\nvar HTTP_INTERCEPTORS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"HTTP_INTERCEPTORS\" : \"\");\nvar HTTP_INTERCEPTOR_FNS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"HTTP_INTERCEPTOR_FNS\" : \"\", {\n  factory: () => []\n});\nvar HTTP_ROOT_INTERCEPTOR_FNS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"HTTP_ROOT_INTERCEPTOR_FNS\" : \"\");\nvar REQUESTS_CONTRIBUTE_TO_STABILITY = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"REQUESTS_CONTRIBUTE_TO_STABILITY\" : \"\", {\n  factory: () => true\n});\nfunction legacyInterceptorFnFactory() {\n  let chain = null;\n  return (req, handler) => {\n    if (chain === null) {\n      const interceptors = inject(HTTP_INTERCEPTORS, {\n        optional: true\n      }) ?? [];\n      chain = interceptors.reduceRight(adaptLegacyInterceptorToChain, interceptorChainEndFn);\n    }\n    const pendingTasks = inject(PendingTasks);\n    const contributeToStability = inject(REQUESTS_CONTRIBUTE_TO_STABILITY);\n    if (contributeToStability) {\n      const removeTask = pendingTasks.add();\n      return chain(req, handler).pipe(finalize(removeTask));\n    } else {\n      return chain(req, handler);\n    }\n  };\n}\nvar HttpBackend = class _HttpBackend {\n  static fac = function HttpBackend_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpBackend)();\n  };\n  static prov = defineInjectable({\n    token: _HttpBackend,\n    factory: function HttpBackend_Factory(__ngFactoryType__) {\n      let __ngConditionalFactory__ = null;\n      if (__ngFactoryType__) {\n        __ngConditionalFactory__ = new (__ngFactoryType__ || _HttpBackend)();\n      } else {\n        __ngConditionalFactory__ = inject(HttpXhrBackend);\n      }\n      return __ngConditionalFactory__;\n    },\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpBackend, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useExisting: HttpXhrBackend\n    }]\n  }], null, null);\n})();\nvar fetchBackendWarningDisplayed = false;\nvar HttpInterceptorHandler = class _HttpInterceptorHandler {\n  backend;\n  injector;\n  chain = null;\n  pendingTasks = inject(PendingTasks);\n  contributeToStability = inject(REQUESTS_CONTRIBUTE_TO_STABILITY);\n  constructor(backend, injector) {\n    this.backend = backend;\n    this.injector = injector;\n    if ((typeof ngDevMode === \"undefined\" || ngDevMode) && !fetchBackendWarningDisplayed) {\n      const isTestingBackend = this.backend.isTestingBackend;\n      if (false) {\n        fetchBackendWarningDisplayed = true;\n        injector.get(Console).warn(formatRuntimeError(2801, \"Angular detected that `HttpClient` is not configured to use `fetch` APIs. It's strongly recommended to enable `fetch` for applications that use Server-Side Rendering for better performance and compatibility. To enable `fetch`, add the `withFetch()` to the `provideHttpClient()` call at the root of the application.\"));\n      }\n    }\n  }\n  handle(initialRequest) {\n    if (this.chain === null) {\n      const dedupedInterceptorFns = Array.from(/* @__PURE__ */ new Set([...this.injector.get(HTTP_INTERCEPTOR_FNS), ...this.injector.get(HTTP_ROOT_INTERCEPTOR_FNS, [])]));\n      this.chain = dedupedInterceptorFns.reduceRight((nextSequencedFn, interceptorFn) => chainedInterceptorFn(nextSequencedFn, interceptorFn, this.injector), interceptorChainEndFn);\n    }\n    if (this.contributeToStability) {\n      const removeTask = this.pendingTasks.add();\n      return this.chain(initialRequest, (downstreamRequest) => this.backend.handle(downstreamRequest)).pipe(finalize(removeTask));\n    } else {\n      return this.chain(initialRequest, (downstreamRequest) => this.backend.handle(downstreamRequest));\n    }\n  }\n  static fac = function HttpInterceptorHandler_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpInterceptorHandler)(inject(HttpBackend), inject(EnvironmentInjector));\n  };\n  static prov = defineInjectable({\n    token: _HttpInterceptorHandler,\n    factory: _HttpInterceptorHandler.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpInterceptorHandler, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: HttpBackend\n  }, {\n    type: EnvironmentInjector\n  }], null);\n})();\nvar HttpHandler = class _HttpHandler {\n  static fac = function HttpHandler_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpHandler)();\n  };\n  static prov = defineInjectable({\n    token: _HttpHandler,\n    factory: function HttpHandler_Factory(__ngFactoryType__) {\n      let __ngConditionalFactory__ = null;\n      if (__ngFactoryType__) {\n        __ngConditionalFactory__ = new (__ngFactoryType__ || _HttpHandler)();\n      } else {\n        __ngConditionalFactory__ = inject(HttpInterceptorHandler);\n      }\n      return __ngConditionalFactory__;\n    },\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpHandler, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useExisting: HttpInterceptorHandler\n    }]\n  }], null, null);\n})();\nfunction addBody(options, body) {\n  return {\n    body,\n    headers: options.headers,\n    context: options.context,\n    observe: options.observe,\n    params: options.params,\n    reportProgress: options.reportProgress,\n    responseType: options.responseType,\n    withCredentials: options.withCredentials,\n    credentials: options.credentials,\n    transferCache: options.transferCache,\n    timeout: options.timeout,\n    keepalive: options.keepalive,\n    priority: options.priority,\n    cache: options.cache,\n    mode: options.mode,\n    redirect: options.redirect,\n    integrity: options.integrity,\n    referrer: options.referrer,\n    referrerPolicy: options.referrerPolicy\n  };\n}\nvar HttpClient = class _HttpClient {\n  handler;\n  constructor(handler) {\n    this.handler = handler;\n  }\n  request(first, url, options = {}) {\n    let req;\n    if (first instanceof HttpRequest) {\n      req = first;\n    } else {\n      let headers = void 0;\n      if (options.headers instanceof HttpHeaders) {\n        headers = options.headers;\n      } else {\n        headers = new HttpHeaders(options.headers);\n      }\n      let params = void 0;\n      if (!!options.params) {\n        if (options.params instanceof HttpParams) {\n          params = options.params;\n        } else {\n          params = new HttpParams({\n            fromObject: options.params\n          });\n        }\n      }\n      req = new HttpRequest(first, url, options.body !== void 0 ? options.body : null, {\n        headers,\n        context: options.context,\n        params,\n        reportProgress: options.reportProgress,\n        responseType: options.responseType || \"json\",\n        withCredentials: options.withCredentials,\n        transferCache: options.transferCache,\n        keepalive: options.keepalive,\n        priority: options.priority,\n        cache: options.cache,\n        mode: options.mode,\n        redirect: options.redirect,\n        credentials: options.credentials,\n        referrer: options.referrer,\n        referrerPolicy: options.referrerPolicy,\n        integrity: options.integrity,\n        timeout: options.timeout\n      });\n    }\n    const events$ = of(req).pipe(concatMap((req2) => this.handler.handle(req2)));\n    if (first instanceof HttpRequest || options.observe === \"events\") {\n      return events$;\n    }\n    const res$ = events$.pipe(filter((event) => event instanceof HttpResponse));\n    switch (options.observe || \"body\") {\n      case \"body\":\n        switch (req.responseType) {\n          case \"arraybuffer\":\n            return res$.pipe(map((res) => {\n              if (res.body !== null && !(res.body instanceof ArrayBuffer)) {\n                throw new RuntimeError(2806, ngDevMode && \"Response is not an ArrayBuffer.\");\n              }\n              return res.body;\n            }));\n          case \"blob\":\n            return res$.pipe(map((res) => {\n              if (res.body !== null && !(res.body instanceof Blob)) {\n                throw new RuntimeError(2807, ngDevMode && \"Response is not a Blob.\");\n              }\n              return res.body;\n            }));\n          case \"text\":\n            return res$.pipe(map((res) => {\n              if (res.body !== null && typeof res.body !== \"string\") {\n                throw new RuntimeError(2808, ngDevMode && \"Response is not a string.\");\n              }\n              return res.body;\n            }));\n          case \"json\":\n          default:\n            return res$.pipe(map((res) => res.body));\n        }\n      case \"response\":\n        return res$;\n      default:\n        throw new RuntimeError(2809, ngDevMode && `Unreachable: unhandled observe type ${options.observe}}`);\n    }\n  }\n  delete(url, options = {}) {\n    return this.request(\"DELETE\", url, options);\n  }\n  get(url, options = {}) {\n    return this.request(\"GET\", url, options);\n  }\n  head(url, options = {}) {\n    return this.request(\"HEAD\", url, options);\n  }\n  jsonp(url, callbackParam) {\n    return this.request(\"JSONP\", url, {\n      params: new HttpParams().append(callbackParam, \"JSONP_CALLBACK\"),\n      observe: \"body\",\n      responseType: \"json\"\n    });\n  }\n  options(url, options = {}) {\n    return this.request(\"OPTIONS\", url, options);\n  }\n  patch(url, body, options = {}) {\n    return this.request(\"PATCH\", url, addBody(options, body));\n  }\n  post(url, body, options = {}) {\n    return this.request(\"POST\", url, addBody(options, body));\n  }\n  put(url, body, options = {}) {\n    return this.request(\"PUT\", url, addBody(options, body));\n  }\n  static fac = function HttpClient_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpClient)(inject(HttpHandler));\n  };\n  static prov = defineInjectable({\n    token: _HttpClient,\n    factory: _HttpClient.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpClient, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], () => [{\n    type: HttpHandler\n  }], null);\n})();\nvar nextRequestId = 0;\nvar foreignDocument;\nvar JSONP_ERR_NO_CALLBACK = \"JSONP injected script did not invoke callback.\";\nvar JSONP_ERR_WRONG_METHOD = \"JSONP requests must use JSONP request method.\";\nvar JSONP_ERR_WRONG_RESPONSE_TYPE = \"JSONP requests must use Json response type.\";\nvar JSONP_ERR_HEADERS_NOT_SUPPORTED = \"JSONP requests do not support headers.\";\nvar JsonpCallbackContext = class {\n};\nfunction jsonpCallbackContext() {\n  if (typeof window === \"object\") {\n    return window;\n  }\n  return {};\n}\nvar JsonpClientBackend = class _JsonpClientBackend {\n  callbackMap;\n  document;\n  resolvedPromise = Promise.resolve();\n  constructor(callbackMap, document) {\n    this.callbackMap = callbackMap;\n    this.document = document;\n  }\n  nextCallback() {\n    return `ng_jsonp_callback_${nextRequestId++}`;\n  }\n  handle(req) {\n    if (req.method !== \"JSONP\") {\n      throw new RuntimeError(2810, ngDevMode && JSONP_ERR_WRONG_METHOD);\n    } else if (req.responseType !== \"json\") {\n      throw new RuntimeError(2811, ngDevMode && JSONP_ERR_WRONG_RESPONSE_TYPE);\n    }\n    if (req.headers.keys().length > 0) {\n      throw new RuntimeError(2812, ngDevMode && JSONP_ERR_HEADERS_NOT_SUPPORTED);\n    }\n    return new Observable((observer) => {\n      const callback = this.nextCallback();\n      const url = req.urlWithParams.replace(/=JSONP_CALLBACK(&|$)/, `=${callback}$1`);\n      const node = this.document.createElement(\"script\");\n      node.src = url;\n      let body = null;\n      let finished = false;\n      this.callbackMap[callback] = (data) => {\n        delete this.callbackMap[callback];\n        body = data;\n        finished = true;\n      };\n      const cleanup = () => {\n        node.removeEventListener(\"load\", onLoad);\n        node.removeEventListener(\"error\", onError);\n        node.remove();\n        delete this.callbackMap[callback];\n      };\n      const onLoad = () => {\n        this.resolvedPromise.then(() => {\n          cleanup();\n          if (!finished) {\n            observer.error(new HttpErrorResponse({\n              url,\n              status: 0,\n              statusText: \"JSONP Error\",\n              error: new Error(JSONP_ERR_NO_CALLBACK)\n            }));\n            return;\n          }\n          observer.next(new HttpResponse({\n            body,\n            status: HTTP_STATUS_CODE_OK,\n            statusText: \"OK\",\n            url\n          }));\n          observer.complete();\n        });\n      };\n      const onError = (error) => {\n        cleanup();\n        observer.error(new HttpErrorResponse({\n          error,\n          status: 0,\n          statusText: \"JSONP Error\",\n          url\n        }));\n      };\n      node.addEventListener(\"load\", onLoad);\n      node.addEventListener(\"error\", onError);\n      this.document.body.appendChild(node);\n      observer.next({\n        type: HttpEventType.Sent\n      });\n      return () => {\n        if (!finished) {\n          this.removeListeners(node);\n        }\n        cleanup();\n      };\n    });\n  }\n  removeListeners(script) {\n    foreignDocument ??= this.document.implementation.createHTMLDocument();\n    foreignDocument.adoptNode(script);\n  }\n  static fac = function JsonpClientBackend_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _JsonpClientBackend)(inject(JsonpCallbackContext), inject(DOCUMENT));\n  };\n  static prov = defineInjectable({\n    token: _JsonpClientBackend,\n    factory: _JsonpClientBackend.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(JsonpClientBackend, [{\n    type: Injectable\n  }], () => [{\n    type: JsonpCallbackContext\n  }, {\n    type: void 0,\n    decorators: [{\n      type: Inject,\n      args: [DOCUMENT]\n    }]\n  }], null);\n})();\nfunction jsonpInterceptorFn(req, next) {\n  if (req.method === \"JSONP\") {\n    return inject(JsonpClientBackend).handle(req);\n  }\n  return next(req);\n}\nvar JsonpInterceptor = class _JsonpInterceptor {\n  injector;\n  constructor(injector) {\n    this.injector = injector;\n  }\n  intercept(initialRequest, next) {\n    return runInInjectionContext(this.injector, () => jsonpInterceptorFn(initialRequest, (downstreamRequest) => next.handle(downstreamRequest)));\n  }\n  static fac = function JsonpInterceptor_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _JsonpInterceptor)(inject(EnvironmentInjector));\n  };\n  static prov = defineInjectable({\n    token: _JsonpInterceptor,\n    factory: _JsonpInterceptor.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(JsonpInterceptor, [{\n    type: Injectable\n  }], () => [{\n    type: EnvironmentInjector\n  }], null);\n})();\nvar XSRF_ENABLED = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"XSRF_ENABLED\" : \"\", {\n  factory: () => true\n});\nvar XSRF_DEFAULT_COOKIE_NAME = \"XSRF-TOKEN\";\nvar XSRF_COOKIE_NAME = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"XSRF_COOKIE_NAME\" : \"\", {\n  factory: () => XSRF_DEFAULT_COOKIE_NAME\n});\nvar XSRF_DEFAULT_HEADER_NAME = \"X-XSRF-TOKEN\";\nvar XSRF_HEADER_NAME = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"XSRF_HEADER_NAME\" : \"\", {\n  factory: () => XSRF_DEFAULT_HEADER_NAME\n});\nvar HttpXsrfCookieExtractor = class _HttpXsrfCookieExtractor {\n  cookieName = inject(XSRF_COOKIE_NAME);\n  doc = inject(DOCUMENT);\n  lastCookieString = \"\";\n  lastToken = null;\n  parseCount = 0;\n  getToken() {\n    if (false) {\n      return null;\n    }\n    const cookieString = this.doc.cookie || \"\";\n    if (cookieString !== this.lastCookieString) {\n      this.parseCount++;\n      this.lastToken = parseCookieValue(cookieString, this.cookieName);\n      this.lastCookieString = cookieString;\n    }\n    return this.lastToken;\n  }\n  static fac = function HttpXsrfCookieExtractor_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpXsrfCookieExtractor)();\n  };\n  static prov = defineInjectable({\n    token: _HttpXsrfCookieExtractor,\n    factory: _HttpXsrfCookieExtractor.fac,\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpXsrfCookieExtractor, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\"\n    }]\n  }], null, null);\n})();\nvar HttpXsrfTokenExtractor = class _HttpXsrfTokenExtractor {\n  static fac = function HttpXsrfTokenExtractor_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpXsrfTokenExtractor)();\n  };\n  static prov = defineInjectable({\n    token: _HttpXsrfTokenExtractor,\n    factory: function HttpXsrfTokenExtractor_Factory(__ngFactoryType__) {\n      let __ngConditionalFactory__ = null;\n      if (__ngFactoryType__) {\n        __ngConditionalFactory__ = new (__ngFactoryType__ || _HttpXsrfTokenExtractor)();\n      } else {\n        __ngConditionalFactory__ = inject(HttpXsrfCookieExtractor);\n      }\n      return __ngConditionalFactory__;\n    },\n    providedIn: \"root\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpXsrfTokenExtractor, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"root\",\n      useExisting: HttpXsrfCookieExtractor\n    }]\n  }], null, null);\n})();\nfunction xsrfInterceptorFn(req, next) {\n  if (!inject(XSRF_ENABLED) || req.method === \"GET\" || req.method === \"HEAD\") {\n    return next(req);\n  }\n  try {\n    const locationHref = inject(PlatformLocation).href;\n    const {\n      origin: locationOrigin\n    } = new URL(locationHref);\n    const {\n      origin: requestOrigin\n    } = new URL(req.url, locationOrigin);\n    if (locationOrigin !== requestOrigin) {\n      return next(req);\n    }\n  } catch {\n    return next(req);\n  }\n  const token = inject(HttpXsrfTokenExtractor).getToken();\n  const headerName = inject(XSRF_HEADER_NAME);\n  if (token != null && !req.headers.has(headerName)) {\n    req = req.clone({\n      headers: req.headers.set(headerName, token)\n    });\n  }\n  return next(req);\n}\nvar HttpXsrfInterceptor = class _HttpXsrfInterceptor {\n  injector = inject(EnvironmentInjector);\n  intercept(initialRequest, next) {\n    return runInInjectionContext(this.injector, () => xsrfInterceptorFn(initialRequest, (downstreamRequest) => next.handle(downstreamRequest)));\n  }\n  static fac = function HttpXsrfInterceptor_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpXsrfInterceptor)();\n  };\n  static prov = defineInjectable({\n    token: _HttpXsrfInterceptor,\n    factory: _HttpXsrfInterceptor.fac\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpXsrfInterceptor, [{\n    type: Injectable\n  }], null, null);\n})();\nvar HttpFeatureKind;\n(function(HttpFeatureKind2) {\n  HttpFeatureKind2[HttpFeatureKind2[\"Interceptors\"] = 0] = \"Interceptors\";\n  HttpFeatureKind2[HttpFeatureKind2[\"LegacyInterceptors\"] = 1] = \"LegacyInterceptors\";\n  HttpFeatureKind2[HttpFeatureKind2[\"CustomXsrfConfiguration\"] = 2] = \"CustomXsrfConfiguration\";\n  HttpFeatureKind2[HttpFeatureKind2[\"NoXsrfProtection\"] = 3] = \"NoXsrfProtection\";\n  HttpFeatureKind2[HttpFeatureKind2[\"JsonpSupport\"] = 4] = \"JsonpSupport\";\n  HttpFeatureKind2[HttpFeatureKind2[\"RequestsMadeViaParent\"] = 5] = \"RequestsMadeViaParent\";\n  HttpFeatureKind2[HttpFeatureKind2[\"Fetch\"] = 6] = \"Fetch\";\n})(HttpFeatureKind || (HttpFeatureKind = {}));\nfunction makeHttpFeature(kind, providers) {\n  return {\n    kind: kind,\n    providers: providers\n  };\n}\nfunction provideHttpClient(...features) {\n  if (ngDevMode) {\n    const featureKinds = new Set(features.map((f) => f.kind));\n    if (featureKinds.has(HttpFeatureKind.NoXsrfProtection) && featureKinds.has(HttpFeatureKind.CustomXsrfConfiguration)) {\n      throw new Error(ngDevMode ? `Configuration error: found both withXsrfConfiguration() and withNoXsrfProtection() in the same call to provideHttpClient(), which is a contradiction.` : \"\");\n    }\n  }\n  const providers = [HttpClient, HttpInterceptorHandler, {\n    provide: HttpHandler,\n    useExisting: HttpInterceptorHandler\n  }, {\n    provide: HttpBackend,\n    useFactory: () => {\n      return inject(FETCH_BACKEND, {\n        optional: true\n      }) ?? inject(HttpXhrBackend);\n    }\n  }, {\n    provide: HTTP_INTERCEPTOR_FNS,\n    useValue: xsrfInterceptorFn,\n    multi: true\n  }];\n  for (const feature of features) {\n    providers.push(...feature.providers);\n  }\n  return makeEnvironmentProviders(providers);\n}\nfunction withInterceptors(interceptorFns) {\n  return makeHttpFeature(HttpFeatureKind.Interceptors, interceptorFns.map((interceptorFn) => {\n    return {\n      provide: HTTP_INTERCEPTOR_FNS,\n      useValue: interceptorFn,\n      multi: true\n    };\n  }));\n}\nvar LEGACY_INTERCEPTOR_FN = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"LEGACY_INTERCEPTOR_FN\" : \"\");\nfunction withInterceptorsFromDi() {\n  return makeHttpFeature(HttpFeatureKind.LegacyInterceptors, [{\n    provide: LEGACY_INTERCEPTOR_FN,\n    useFactory: legacyInterceptorFnFactory\n  }, {\n    provide: HTTP_INTERCEPTOR_FNS,\n    useExisting: LEGACY_INTERCEPTOR_FN,\n    multi: true\n  }]);\n}\nfunction withXsrfConfiguration({\n  cookieName,\n  headerName\n}) {\n  const providers = [];\n  if (cookieName !== void 0) {\n    providers.push({\n      provide: XSRF_COOKIE_NAME,\n      useValue: cookieName\n    });\n  }\n  if (headerName !== void 0) {\n    providers.push({\n      provide: XSRF_HEADER_NAME,\n      useValue: headerName\n    });\n  }\n  return makeHttpFeature(HttpFeatureKind.CustomXsrfConfiguration, providers);\n}\nfunction withNoXsrfProtection() {\n  return makeHttpFeature(HttpFeatureKind.NoXsrfProtection, [{\n    provide: XSRF_ENABLED,\n    useValue: false\n  }]);\n}\nfunction withJsonpSupport() {\n  return makeHttpFeature(HttpFeatureKind.JsonpSupport, [JsonpClientBackend, {\n    provide: JsonpCallbackContext,\n    useFactory: jsonpCallbackContext\n  }, {\n    provide: HTTP_INTERCEPTOR_FNS,\n    useValue: jsonpInterceptorFn,\n    multi: true\n  }]);\n}\nfunction withRequestsMadeViaParent() {\n  return makeHttpFeature(HttpFeatureKind.RequestsMadeViaParent, [{\n    provide: HttpBackend,\n    useFactory: () => {\n      const handlerFromParent = inject(HttpHandler, {\n        skipSelf: true,\n        optional: true\n      });\n      if (ngDevMode && handlerFromParent === null) {\n        throw new Error(\"withRequestsMadeViaParent() can only be used when the parent injector also configures HttpClient\");\n      }\n      return handlerFromParent;\n    }\n  }]);\n}\nfunction withFetch() {\n  return makeHttpFeature(HttpFeatureKind.Fetch, [FetchBackend, {\n    provide: FETCH_BACKEND,\n    useExisting: FetchBackend\n  }, {\n    provide: HttpBackend,\n    useExisting: FetchBackend\n  }]);\n}\nvar HttpClientXsrfModule = class _HttpClientXsrfModule {\n  static disable() {\n    return {\n      ngModule: _HttpClientXsrfModule,\n      providers: [withNoXsrfProtection().providers]\n    };\n  }\n  static withOptions(options = {}) {\n    return {\n      ngModule: _HttpClientXsrfModule,\n      providers: withXsrfConfiguration(options).providers\n    };\n  }\n  static fac = function HttpClientXsrfModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpClientXsrfModule)();\n  };\n  static mod = defineNgModule({\n    type: _HttpClientXsrfModule\n  });\n  static inj = defineInjector({\n    providers: [HttpXsrfInterceptor, {\n      provide: HTTP_INTERCEPTORS,\n      useExisting: HttpXsrfInterceptor,\n      multi: true\n    }, {\n      provide: HttpXsrfTokenExtractor,\n      useClass: HttpXsrfCookieExtractor\n    }, withXsrfConfiguration({\n      cookieName: XSRF_DEFAULT_COOKIE_NAME,\n      headerName: XSRF_DEFAULT_HEADER_NAME\n    }).providers, {\n      provide: XSRF_ENABLED,\n      useValue: true\n    }]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpClientXsrfModule, [{\n    type: NgModule,\n    args: [{\n      providers: [HttpXsrfInterceptor, {\n        provide: HTTP_INTERCEPTORS,\n        useExisting: HttpXsrfInterceptor,\n        multi: true\n      }, {\n        provide: HttpXsrfTokenExtractor,\n        useClass: HttpXsrfCookieExtractor\n      }, withXsrfConfiguration({\n        cookieName: XSRF_DEFAULT_COOKIE_NAME,\n        headerName: XSRF_DEFAULT_HEADER_NAME\n      }).providers, {\n        provide: XSRF_ENABLED,\n        useValue: true\n      }]\n    }]\n  }], null, null);\n})();\nvar HttpClientModule = class _HttpClientModule {\n  static fac = function HttpClientModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpClientModule)();\n  };\n  static mod = defineNgModule({\n    type: _HttpClientModule\n  });\n  static inj = defineInjector({\n    providers: [provideHttpClient(withInterceptorsFromDi())]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpClientModule, [{\n    type: NgModule,\n    args: [{\n      providers: [provideHttpClient(withInterceptorsFromDi())]\n    }]\n  }], null, null);\n})();\nvar HttpClientJsonpModule = class _HttpClientJsonpModule {\n  static fac = function HttpClientJsonpModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _HttpClientJsonpModule)();\n  };\n  static mod = defineNgModule({\n    type: _HttpClientJsonpModule\n  });\n  static inj = defineInjector({\n    providers: [withJsonpSupport().providers]\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(HttpClientJsonpModule, [{\n    type: NgModule,\n    args: [{\n      providers: [withJsonpSupport().providers]\n    }]\n  }], null, null);\n})();\n\n// node_modules/@angular/common/fesm2022/http.mjs\nvar httpResource = (() => {\n  const jsonFn = makeHttpResourceFn(\"json\");\n  jsonFn.arrayBuffer = makeHttpResourceFn(\"arraybuffer\");\n  jsonFn.blob = makeHttpResourceFn(\"blob\");\n  jsonFn.text = makeHttpResourceFn(\"text\");\n  return jsonFn;\n})();\nfunction makeHttpResourceFn(responseType) {\n  return function httpResource2(request, options) {\n    if (ngDevMode && !options?.injector) {\n      assertInInjectionContext(httpResource2);\n    }\n    const injector = options?.injector ?? inject(Injector);\n    return new HttpResourceImpl(injector, () => normalizeRequest(request, responseType), options?.defaultValue, options?.debugName, options?.parse, options?.equal);\n  };\n}\nfunction normalizeRequest(request, responseType) {\n  let unwrappedRequest = typeof request === \"function\" ? request() : request;\n  if (unwrappedRequest === void 0) {\n    return void 0;\n  } else if (typeof unwrappedRequest === \"string\") {\n    unwrappedRequest = {\n      url: unwrappedRequest\n    };\n  }\n  const headers = unwrappedRequest.headers instanceof HttpHeaders ? unwrappedRequest.headers : new HttpHeaders(unwrappedRequest.headers);\n  const params = unwrappedRequest.params instanceof HttpParams ? unwrappedRequest.params : new HttpParams({\n    fromObject: unwrappedRequest.params\n  });\n  return new HttpRequest(unwrappedRequest.method ?? \"GET\", unwrappedRequest.url, unwrappedRequest.body ?? null, {\n    headers,\n    params,\n    reportProgress: unwrappedRequest.reportProgress,\n    withCredentials: unwrappedRequest.withCredentials,\n    keepalive: unwrappedRequest.keepalive,\n    cache: unwrappedRequest.cache,\n    priority: unwrappedRequest.priority,\n    mode: unwrappedRequest.mode,\n    redirect: unwrappedRequest.redirect,\n    responseType,\n    context: unwrappedRequest.context,\n    transferCache: unwrappedRequest.transferCache,\n    credentials: unwrappedRequest.credentials,\n    referrer: unwrappedRequest.referrer,\n    referrerPolicy: unwrappedRequest.referrerPolicy,\n    integrity: unwrappedRequest.integrity,\n    timeout: unwrappedRequest.timeout\n  });\n}\nvar HttpResourceImpl = class extends ResourceImpl {\n  client;\n  _headers = linkedSignal(__spreadProps(__spreadValues({}, ngDevMode ? {\n    debugName: \"_headers\"\n  } : {}), {\n    source: this.extRequest,\n    computation: () => void 0\n  }));\n  _progress = linkedSignal(__spreadProps(__spreadValues({}, ngDevMode ? {\n    debugName: \"_progress\"\n  } : {}), {\n    source: this.extRequest,\n    computation: () => void 0\n  }));\n  _statusCode = linkedSignal(__spreadProps(__spreadValues({}, ngDevMode ? {\n    debugName: \"_statusCode\"\n  } : {}), {\n    source: this.extRequest,\n    computation: () => void 0\n  }));\n  headers = computed(() => this.status() === \"resolved\" || this.status() === \"error\" ? this._headers() : void 0, ...ngDevMode ? [{\n    debugName: \"headers\"\n  }] : []);\n  progress = this._progress.asReadonly();\n  statusCode = this._statusCode.asReadonly();\n  constructor(injector, request, defaultValue, debugName, parse, equal) {\n    super(request, ({\n      params: request2,\n      abortSignal\n    }) => {\n      let sub;\n      const onAbort = () => sub.unsubscribe();\n      abortSignal.addEventListener(\"abort\", onAbort);\n      const stream = signal({\n        value: void 0\n      }, ...ngDevMode ? [{\n        debugName: \"stream\"\n      }] : []);\n      let resolve;\n      const promise = new Promise((r) => resolve = r);\n      const send = (value) => {\n        stream.set(value);\n        resolve?.(stream);\n        resolve = void 0;\n      };\n      sub = this.client.request(request2).subscribe({\n        next: (event) => {\n          switch (event.type) {\n            case HttpEventType.Response:\n              this._headers.set(event.headers);\n              this._statusCode.set(event.status);\n              try {\n                send({\n                  value: parse ? parse(event.body) : event.body\n                });\n              } catch (error) {\n                send({\n                  error: encapsulateResourceError(error)\n                });\n              }\n              break;\n            case HttpEventType.DownloadProgress:\n              this._progress.set(event);\n              break;\n          }\n        },\n        error: (error) => {\n          if (error instanceof HttpErrorResponse) {\n            this._headers.set(error.headers);\n            this._statusCode.set(error.status);\n          }\n          send({\n            error\n          });\n          abortSignal.removeEventListener(\"abort\", onAbort);\n        },\n        complete: () => {\n          if (resolve) {\n            send({\n              error: new RuntimeError(991, ngDevMode && \"Resource completed before producing a value\")\n            });\n          }\n          abortSignal.removeEventListener(\"abort\", onAbort);\n        }\n      });\n      return promise;\n    }, defaultValue, equal, debugName, injector);\n    this.client = injector.get(HttpClient);\n  }\n  set(value) {\n    super.set(value);\n    this._headers.set(void 0);\n    this._progress.set(void 0);\n    this._statusCode.set(void 0);\n  }\n};\nvar HTTP_TRANSFER_CACHE_ORIGIN_MAP = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"HTTP_TRANSFER_CACHE_ORIGIN_MAP\" : \"\");\nvar BODY = \"b\";\nvar HEADERS = \"h\";\nvar STATUS = \"s\";\nvar STATUS_TEXT = \"st\";\nvar REQ_URL = \"u\";\nvar RESPONSE_TYPE = \"rt\";\nvar CACHE_OPTIONS = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"HTTP_TRANSFER_STATE_CACHE_OPTIONS\" : \"\");\nvar ALLOWED_METHODS = [\"GET\", \"HEAD\"];\nfunction transferCacheInterceptorFn(req, next) {\n  const _a = inject(CACHE_OPTIONS), {\n    isCacheActive\n  } = _a, globalOptions = __objRest(_a, [\n    \"isCacheActive\"\n  ]);\n  const {\n    transferCache: requestOptions,\n    method: requestMethod\n  } = req;\n  if (!isCacheActive || requestOptions === false || requestMethod === \"POST\" && !globalOptions.includePostRequests && !requestOptions || requestMethod !== \"POST\" && !ALLOWED_METHODS.includes(requestMethod) || !globalOptions.includeRequestsWithAuthHeaders && hasAuthHeaders(req) || globalOptions.filter?.(req) === false) {\n    return next(req);\n  }\n  const transferState = inject(TransferState);\n  const originMap = inject(HTTP_TRANSFER_CACHE_ORIGIN_MAP, {\n    optional: true\n  });\n  if (originMap) {\n    throw new RuntimeError(2803, ngDevMode && \"Angular detected that the `HTTP_TRANSFER_CACHE_ORIGIN_MAP` token is configured and present in the client side code. Please ensure that this token is only provided in the server code of the application.\");\n  }\n  const requestUrl = false ? mapRequestOriginUrl(req.url, originMap) : req.url;\n  const storeKey = makeCacheKey(req, requestUrl);\n  const response = transferState.get(storeKey, null);\n  let headersToInclude = globalOptions.includeHeaders;\n  if (typeof requestOptions === \"object\" && requestOptions.includeHeaders) {\n    headersToInclude = requestOptions.includeHeaders;\n  }\n  if (response) {\n    const {\n      [BODY]: undecodedBody,\n      [RESPONSE_TYPE]: responseType,\n      [HEADERS]: httpHeaders,\n      [STATUS]: status,\n      [STATUS_TEXT]: statusText,\n      [REQ_URL]: url\n    } = response;\n    let body = undecodedBody;\n    switch (responseType) {\n      case \"arraybuffer\":\n        body = new TextEncoder().encode(undecodedBody).buffer;\n        break;\n      case \"blob\":\n        body = new Blob([undecodedBody]);\n        break;\n    }\n    let headers = new HttpHeaders(httpHeaders);\n    if (typeof ngDevMode === \"undefined\" || ngDevMode) {\n      headers = appendMissingHeadersDetection(req.url, headers, headersToInclude ?? []);\n    }\n    return of(new HttpResponse({\n      body,\n      headers,\n      status,\n      statusText,\n      url\n    }));\n  }\n  const event$ = next(req);\n  if (false) {\n    return event$.pipe(tap((event) => {\n      if (event instanceof HttpResponse) {\n        transferState.set(storeKey, {\n          [BODY]: event.body,\n          [HEADERS]: getFilteredHeaders(event.headers, headersToInclude),\n          [STATUS]: event.status,\n          [STATUS_TEXT]: event.statusText,\n          [REQ_URL]: requestUrl,\n          [RESPONSE_TYPE]: req.responseType\n        });\n      }\n    }));\n  }\n  return event$;\n}\nfunction hasAuthHeaders(req) {\n  return req.headers.has(\"authorization\") || req.headers.has(\"proxy-authorization\");\n}\nfunction sortAndConcatParams(params) {\n  return [...params.keys()].sort().map((k) => `${k}=${params.getAll(k)}`).join(\"&\");\n}\nfunction makeCacheKey(request, mappedRequestUrl) {\n  const {\n    params,\n    method,\n    responseType\n  } = request;\n  const encodedParams = sortAndConcatParams(params);\n  let serializedBody = request.serializeBody();\n  if (serializedBody instanceof URLSearchParams) {\n    serializedBody = sortAndConcatParams(serializedBody);\n  } else if (typeof serializedBody !== \"string\") {\n    serializedBody = \"\";\n  }\n  const key = [method, responseType, mappedRequestUrl, serializedBody, encodedParams].join(\"|\");\n  const hash = generateHash(key);\n  return makeStateKey(hash);\n}\nfunction generateHash(value) {\n  let hash = 0;\n  for (const char of value) {\n    hash = Math.imul(31, hash) + char.charCodeAt(0) << 0;\n  }\n  hash += 2147483647 + 1;\n  return hash.toString();\n}\nfunction withHttpTransferCache(cacheOptions) {\n  return [{\n    provide: CACHE_OPTIONS,\n    useFactory: () => {\n      performanceMarkFeature(\"NgHttpTransferCache\");\n      return __spreadValues({\n        isCacheActive: true\n      }, cacheOptions);\n    }\n  }, {\n    provide: HTTP_ROOT_INTERCEPTOR_FNS,\n    useValue: transferCacheInterceptorFn,\n    multi: true\n  }, {\n    provide: APP_BOOTSTRAP_LISTENER,\n    multi: true,\n    useFactory: () => {\n      const appRef = inject(ApplicationRef);\n      const cacheState = inject(CACHE_OPTIONS);\n      return () => {\n        appRef.whenStable().then(() => {\n          cacheState.isCacheActive = false;\n        });\n      };\n    }\n  }];\n}\nfunction appendMissingHeadersDetection(url, headers, headersToInclude) {\n  const warningProduced = /* @__PURE__ */ new Set();\n  return new Proxy(headers, {\n    get(target, prop) {\n      const value = Reflect.get(target, prop);\n      const methods = /* @__PURE__ */ new Set([\"get\", \"has\", \"getAll\"]);\n      if (typeof value !== \"function\" || !methods.has(prop)) {\n        return value;\n      }\n      return (headerName) => {\n        const key = (prop + \":\" + headerName).toLowerCase();\n        if (!headersToInclude.includes(headerName) && !warningProduced.has(key)) {\n          warningProduced.add(key);\n          const truncatedUrl = truncateMiddle(url);\n          console.warn(formatRuntimeError(-2802, `Angular detected that the \\`${headerName}\\` header is accessed, but the value of the header was not transferred from the server to the client by the HttpTransferCache. To include the value of the \\`${headerName}\\` header for the \\`${truncatedUrl}\\` request, use the \\`includeHeaders\\` list. The \\`includeHeaders\\` can be defined either on a request level by adding the \\`transferCache\\` parameter, or on an application level by adding the \\`httpCacheTransfer.includeHeaders\\` argument to the \\`provideClientHydration()\\` call. `));\n        }\n        return value.apply(target, [headerName]);\n      };\n    }\n  });\n}\n\nexport {\n  HttpHeaders,\n  HttpContextToken,\n  HttpContext,\n  HttpUrlEncodingCodec,\n  HttpParams,\n  HttpRequest,\n  HttpEventType,\n  HttpResponseBase,\n  HttpHeaderResponse,\n  HttpResponse,\n  HttpErrorResponse,\n  HttpStatusCode,\n  FetchBackend,\n  HttpXhrBackend,\n  HTTP_INTERCEPTORS,\n  HTTP_ROOT_INTERCEPTOR_FNS,\n  REQUESTS_CONTRIBUTE_TO_STABILITY,\n  HttpBackend,\n  HttpInterceptorHandler,\n  HttpHandler,\n  HttpClient,\n  JsonpClientBackend,\n  JsonpInterceptor,\n  HttpXsrfTokenExtractor,\n  HttpFeatureKind,\n  provideHttpClient,\n  withInterceptors,\n  withInterceptorsFromDi,\n  withXsrfConfiguration,\n  withNoXsrfProtection,\n  withJsonpSupport,\n  withRequestsMadeViaParent,\n  withFetch,\n  HttpClientXsrfModule,\n  HttpClientModule,\n  HttpClientJsonpModule,\n  httpResource,\n  HTTP_TRANSFER_CACHE_ORIGIN_MAP,\n  withHttpTransferCache\n};\n//# sourceMappingURL=chunk-43XS5UPA.js.map\n"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.243Z",
        "time": 9.62299999082461,
        "timings": {
          "blocked": 8.259000025514514,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.7370000222586095,
          "receive": 0.6269999430514872,
          "_blocked_queueing": 8.221000025514513,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b",
          "lineNumber": 41
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-AAX7L6FX.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "4148"
            },
            {
              "name": "Etag",
              "value": "W/\"1034-X7Cv86F4W7rykrMbUjd/1pgqJBo\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 4148,
            "mimeType": "text/javascript",
            "text": "import {\n  DOCUMENT,\n  Injectable,\n  InjectionToken,\n  inject,\n  setClassMetadata,\n  defineInjectable\n} from \"/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b\";\n\n// node_modules/@angular/common/fesm2022/_platform_location-chunk.mjs\nvar _DOM = null;\nfunction getDOM() {\n  return _DOM;\n}\nfunction setRootDomAdapter(adapter) {\n  _DOM ??= adapter;\n}\nvar DomAdapter = class {\n};\nvar PlatformLocation = class _PlatformLocation {\n  historyGo(relativePosition) {\n    throw new Error(ngDevMode ? \"Not implemented\" : \"\");\n  }\n  static fac = function PlatformLocation_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _PlatformLocation)();\n  };\n  static prov = defineInjectable({\n    token: _PlatformLocation,\n    factory: () => (() => inject(BrowserPlatformLocation))(),\n    providedIn: \"platform\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(PlatformLocation, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"platform\",\n      useFactory: () => inject(BrowserPlatformLocation)\n    }]\n  }], null, null);\n})();\nvar LOCATION_INITIALIZED = new InjectionToken(typeof ngDevMode !== \"undefined\" && ngDevMode ? \"Location Initialized\" : \"\");\nvar BrowserPlatformLocation = class _BrowserPlatformLocation extends PlatformLocation {\n  _location;\n  _history;\n  _doc = inject(DOCUMENT);\n  constructor() {\n    super();\n    this._location = window.location;\n    this._history = window.history;\n  }\n  getBaseHrefFromDOM() {\n    return getDOM().getBaseHref(this._doc);\n  }\n  onPopState(fn) {\n    const window2 = getDOM().getGlobalEventTarget(this._doc, \"window\");\n    window2.addEventListener(\"popstate\", fn, false);\n    return () => window2.removeEventListener(\"popstate\", fn);\n  }\n  onHashChange(fn) {\n    const window2 = getDOM().getGlobalEventTarget(this._doc, \"window\");\n    window2.addEventListener(\"hashchange\", fn, false);\n    return () => window2.removeEventListener(\"hashchange\", fn);\n  }\n  get href() {\n    return this._location.href;\n  }\n  get protocol() {\n    return this._location.protocol;\n  }\n  get hostname() {\n    return this._location.hostname;\n  }\n  get port() {\n    return this._location.port;\n  }\n  get pathname() {\n    return this._location.pathname;\n  }\n  get search() {\n    return this._location.search;\n  }\n  get hash() {\n    return this._location.hash;\n  }\n  set pathname(newPath) {\n    this._location.pathname = newPath;\n  }\n  pushState(state, title, url) {\n    this._history.pushState(state, title, url);\n  }\n  replaceState(state, title, url) {\n    this._history.replaceState(state, title, url);\n  }\n  forward() {\n    this._history.forward();\n  }\n  back() {\n    this._history.back();\n  }\n  historyGo(relativePosition = 0) {\n    this._history.go(relativePosition);\n  }\n  getState() {\n    return this._history.state;\n  }\n  static fac = function BrowserPlatformLocation_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _BrowserPlatformLocation)();\n  };\n  static prov = defineInjectable({\n    token: _BrowserPlatformLocation,\n    factory: () => (() => new _BrowserPlatformLocation())(),\n    providedIn: \"platform\"\n  });\n};\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && setClassMetadata(BrowserPlatformLocation, [{\n    type: Injectable,\n    args: [{\n      providedIn: \"platform\",\n      useFactory: () => new BrowserPlatformLocation()\n    }]\n  }], () => [], null);\n})();\n\n// node_modules/@angular/common/fesm2022/_xhr-chunk.mjs\nfunction parseCookieValue(cookieStr, name) {\n  name = encodeURIComponent(name);\n  for (const cookie of cookieStr.split(\";\")) {\n    const eqIndex = cookie.indexOf(\"=\");\n    const [cookieName, cookieValue] = eqIndex == -1 ? [cookie, \"\"] : [cookie.slice(0, eqIndex), cookie.slice(eqIndex + 1)];\n    if (cookieName.trim() === name) {\n      return decodeURIComponent(cookieValue);\n    }\n  }\n  return null;\n}\nvar XhrFactory = class {\n};\n\nexport {\n  getDOM,\n  setRootDomAdapter,\n  DomAdapter,\n  PlatformLocation,\n  LOCATION_INITIALIZED,\n  BrowserPlatformLocation,\n  parseCookieValue,\n  XhrFactory\n};\n//# sourceMappingURL=chunk-AAX7L6FX.js.map\n"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.243Z",
        "time": 9.426999953575432,
        "timings": {
          "blocked": 8.311999991171062,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.7069999989047646,
          "receive": 0.40799996349960566,
          "_blocked_queueing": 8.269999991171062,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_fromCache": "disk",
        "_initiator": {
          "type": "script",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b",
          "lineNumber": 42
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/chunk-LEHRZ7IK.js?v=a3ec8c6b",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/@fs/C:/Users/moura/Documents/Scaffold/frontend/.angular/cache/21.1.3/frontend/vite/deps/@angular_platform-browser.js?v=a3ec8c6b"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            }
          ],
          "queryString": [
            {
              "name": "v",
              "value": "a3ec8c6b"
            }
          ],
          "cookies": [],
          "headersSize": -1,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "http/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "max-age=31536000,immutable"
            },
            {
              "name": "Content-Length",
              "value": "1047276"
            },
            {
              "name": "Etag",
              "value": "W/\"ffaec-WV0d59LXiE7SxS/6AduRjivstc0\""
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:16:20 GMT"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 1047276,
            "mimeType": "text/javascript",
            "text": "dmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKdmFyIF9fZGVmUHJvcHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydGllczsKdmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7CnZhciBfX2dldE93blByb3BTeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczsKdmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7CnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlOwp2YXIgX19kZWZOb3JtYWxQcm9wID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ga2V5IGluIG9iaiA/IF9fZGVmUHJvcChvYmosIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZSB9KSA6IG9ialtrZXldID0gdmFsdWU7CnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7CiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8PSB7fSkKICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSkKICAgICAgX19kZWZOb3JtYWxQcm9wKGEsIHByb3AsIGJbcHJvcF0pOwogIGlmIChfX2dldE93blByb3BTeW1ib2xzKQogICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7CiAgICAgIGlmIChfX3Byb3BJc0VudW0uY2FsbChiLCBwcm9wKSkKICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7CiAgICB9CiAgcmV0dXJuIGE7Cn07CnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpOwp2YXIgX19vYmpSZXN0ID0gKHNvdXJjZSwgZXhjbHVkZSkgPT4gewogIHZhciB0YXJnZXQgPSB7fTsKICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkKICAgIGlmIChfX2hhc093blByb3AuY2FsbChzb3VyY2UsIHByb3ApICYmIGV4Y2x1ZGUuaW5kZXhPZihwcm9wKSA8IDApCiAgICAgIHRhcmdldFtwcm9wXSA9IHNvdXJjZVtwcm9wXTsKICBpZiAoc291cmNlICE9IG51bGwgJiYgX19nZXRPd25Qcm9wU3ltYm9scykKICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhzb3VyY2UpKSB7CiAgICAgIGlmIChleGNsdWRlLmluZGV4T2YocHJvcCkgPCAwICYmIF9fcHJvcElzRW51bS5jYWxsKHNvdXJjZSwgcHJvcCkpCiAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdOwogICAgfQogIHJldHVybiB0YXJnZXQ7Cn07CgovLyBub2RlX21vZHVsZXMvQGFuZ3VsYXIvY29yZS9mZXNtMjAyMi9fZWZmZWN0LWNodW5rLm1qcwp2YXIgYWN0aXZlQ29uc3VtZXIgPSBudWxsOwp2YXIgaW5Ob3RpZmljYXRpb25QaGFzZSA9IGZhbHNlOwp2YXIgZXBvY2ggPSAxOwp2YXIgcG9zdFByb2R1Y2VyQ3JlYXRlZEZuID0gbnVsbDsKdmFyIFNJR05BTCA9IC8qIEBfX1BVUkVfXyAqLyBTeW1ib2woIlNJR05BTCIpOwpmdW5jdGlvbiBzZXRBY3RpdmVDb25zdW1lcihjb25zdW1lcikgewogIGNvbnN0IHByZXYgPSBhY3RpdmVDb25zdW1lcjsKICBhY3RpdmVDb25zdW1lciA9IGNvbnN1bWVyOwogIHJldHVybiBwcmV2Owp9CmZ1bmN0aW9uIGdldEFjdGl2ZUNvbnN1bWVyKCkgewogIHJldHVybiBhY3RpdmVDb25zdW1lcjsKfQpmdW5jdGlvbiBpc0luTm90aWZpY2F0aW9uUGhhc2UoKSB7CiAgcmV0dXJuIGluTm90aWZpY2F0aW9uUGhhc2U7Cn0KdmFyIFJFQUNUSVZFX05PREUgPSB7CiAgdmVyc2lvbjogMCwKICBsYXN0Q2xlYW5FcG9jaDogMCwKICBkaXJ0eTogZmFsc2UsCiAgcHJvZHVjZXJzOiB2b2lkIDAsCiAgcHJvZHVjZXJzVGFpbDogdm9pZCAwLAogIGNvbnN1bWVyczogdm9pZCAwLAogIGNvbnN1bWVyc1RhaWw6IHZvaWQgMCwKICByZWNvbXB1dGluZzogZmFsc2UsCiAgY29uc3VtZXJBbGxvd1NpZ25hbFdyaXRlczogZmFsc2UsCiAgY29uc3VtZXJJc0Fsd2F5c0xpdmU6IGZhbHNlLAogIGtpbmQ6ICJ1bmtub3duIiwKICBwcm9kdWNlck11c3RSZWNvbXB1dGU6ICgpID0+IGZhbHNlLAogIHByb2R1Y2VyUmVjb21wdXRlVmFsdWU6ICgpID0+IHsKICB9LAogIGNvbnN1bWVyTWFya2VkRGlydHk6ICgpID0+IHsKICB9LAogIGNvbnN1bWVyT25TaWduYWxSZWFkOiAoKSA9PiB7CiAgfQp9OwpmdW5jdGlvbiBwcm9kdWNlckFjY2Vzc2VkKG5vZGUpIHsKICBpZiAoaW5Ob3RpZmljYXRpb25QaGFzZSkgewogICAgdGhyb3cgbmV3IEVycm9yKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/IGBBc3NlcnRpb24gZXJyb3I6IHNpZ25hbCByZWFkIGR1cmluZyBub3RpZmljYXRpb24gcGhhc2VgIDogIiIpOwogIH0KICBpZiAoYWN0aXZlQ29uc3VtZXIgPT09IG51bGwpIHsKICAgIHJldHVybjsKICB9CiAgYWN0aXZlQ29uc3VtZXIuY29uc3VtZXJPblNpZ25hbFJlYWQobm9kZSk7CiAgY29uc3QgcHJldlByb2R1Y2VyTGluayA9IGFjdGl2ZUNvbnN1bWVyLnByb2R1Y2Vyc1RhaWw7CiAgaWYgKHByZXZQcm9kdWNlckxpbmsgIT09IHZvaWQgMCAmJiBwcmV2UHJvZHVjZXJMaW5rLnByb2R1Y2VyID09PSBub2RlKSB7CiAgICByZXR1cm47CiAgfQogIGxldCBuZXh0UHJvZHVjZXJMaW5rID0gdm9pZCAwOwogIGNvbnN0IGlzUmVjb21wdXRpbmcgPSBhY3RpdmVDb25zdW1lci5yZWNvbXB1dGluZzsKICBpZiAoaXNSZWNvbXB1dGluZykgewogICAgbmV4dFByb2R1Y2VyTGluayA9IHByZXZQcm9kdWNlckxpbmsgIT09IHZvaWQgMCA/IHByZXZQcm9kdWNlckxpbmsubmV4dFByb2R1Y2VyIDogYWN0aXZlQ29uc3VtZXIucHJvZHVjZXJzOwogICAgaWYgKG5leHRQcm9kdWNlckxpbmsgIT09IHZvaWQgMCAmJiBuZXh0UHJvZHVjZXJMaW5rLnByb2R1Y2VyID09PSBub2RlKSB7CiAgICAgIGFjdGl2ZUNvbnN1bWVyLnByb2R1Y2Vyc1RhaWwgPSBuZXh0UHJvZHVjZXJMaW5rOwogICAgICBuZXh0UHJvZHVjZXJMaW5rLmxhc3RSZWFkVmVyc2lvbiA9IG5vZGUudmVyc2lvbjsKICAgICAgcmV0dXJuOwogICAgfQogIH0KICBjb25zdCBwcmV2Q29uc3VtZXJMaW5rID0gbm9kZS5jb25zdW1lcnNUYWlsOwogIGlmIChwcmV2Q29uc3VtZXJMaW5rICE9PSB2b2lkIDAgJiYgcHJldkNvbnN1bWVyTGluay5jb25zdW1lciA9PT0gYWN0aXZlQ29uc3VtZXIgJiYgKCFpc1JlY29tcHV0aW5nIHx8IGlzVmFsaWRMaW5rKHByZXZDb25zdW1lckxpbmssIGFjdGl2ZUNvbnN1bWVyKSkpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgaXNMaXZlID0gY29uc3VtZXJJc0xpdmUoYWN0aXZlQ29uc3VtZXIpOwogIGNvbnN0IG5ld0xpbmsgPSB7CiAgICBwcm9kdWNlcjogbm9kZSwKICAgIGNvbnN1bWVyOiBhY3RpdmVDb25zdW1lciwKICAgIG5leHRQcm9kdWNlcjogbmV4dFByb2R1Y2VyTGluaywKICAgIHByZXZDb25zdW1lcjogcHJldkNvbnN1bWVyTGluaywKICAgIGxhc3RSZWFkVmVyc2lvbjogbm9kZS52ZXJzaW9uLAogICAgbmV4dENvbnN1bWVyOiB2b2lkIDAKICB9OwogIGFjdGl2ZUNvbnN1bWVyLnByb2R1Y2Vyc1RhaWwgPSBuZXdMaW5rOwogIGlmIChwcmV2UHJvZHVjZXJMaW5rICE9PSB2b2lkIDApIHsKICAgIHByZXZQcm9kdWNlckxpbmsubmV4dFByb2R1Y2VyID0gbmV3TGluazsKICB9IGVsc2UgewogICAgYWN0aXZlQ29uc3VtZXIucHJvZHVjZXJzID0gbmV3TGluazsKICB9CiAgaWYgKGlzTGl2ZSkgewogICAgcHJvZHVjZXJBZGRMaXZlQ29uc3VtZXIobm9kZSwgbmV3TGluayk7CiAgfQp9CmZ1bmN0aW9uIHByb2R1Y2VySW5jcmVtZW50RXBvY2goKSB7CiAgZXBvY2grKzsKfQpmdW5jdGlvbiBwcm9kdWNlclVwZGF0ZVZhbHVlVmVyc2lvbihub2RlKSB7CiAgaWYgKGNvbnN1bWVySXNMaXZlKG5vZGUpICYmICFub2RlLmRpcnR5KSB7CiAgICByZXR1cm47CiAgfQogIGlmICghbm9kZS5kaXJ0eSAmJiBub2RlLmxhc3RDbGVhbkVwb2NoID09PSBlcG9jaCkgewogICAgcmV0dXJuOwogIH0KICBpZiAoIW5vZGUucHJvZHVjZXJNdXN0UmVjb21wdXRlKG5vZGUpICYmICFjb25zdW1lclBvbGxQcm9kdWNlcnNGb3JDaGFuZ2Uobm9kZSkpIHsKICAgIHByb2R1Y2VyTWFya0NsZWFuKG5vZGUpOwogICAgcmV0dXJuOwogIH0KICBub2RlLnByb2R1Y2VyUmVjb21wdXRlVmFsdWUobm9kZSk7CiAgcHJvZHVjZXJNYXJrQ2xlYW4obm9kZSk7Cn0KZnVuY3Rpb24gcHJvZHVjZXJOb3RpZnlDb25zdW1lcnMobm9kZSkgewogIGlmIChub2RlLmNvbnN1bWVycyA9PT0gdm9pZCAwKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHByZXYgPSBpbk5vdGlmaWNhdGlvblBoYXNlOwogIGluTm90aWZpY2F0aW9uUGhhc2UgPSB0cnVlOwogIHRyeSB7CiAgICBmb3IgKGxldCBsaW5rID0gbm9kZS5jb25zdW1lcnM7IGxpbmsgIT09IHZvaWQgMDsgbGluayA9IGxpbmsubmV4dENvbnN1bWVyKSB7CiAgICAgIGNvbnN0IGNvbnN1bWVyID0gbGluay5jb25zdW1lcjsKICAgICAgaWYgKCFjb25zdW1lci5kaXJ0eSkgewogICAgICAgIGNvbnN1bWVyTWFya0RpcnR5KGNvbnN1bWVyKTsKICAgICAgfQogICAgfQogIH0gZmluYWxseSB7CiAgICBpbk5vdGlmaWNhdGlvblBoYXNlID0gcHJldjsKICB9Cn0KZnVuY3Rpb24gcHJvZHVjZXJVcGRhdGVzQWxsb3dlZCgpIHsKICByZXR1cm4gYWN0aXZlQ29uc3VtZXI/LmNvbnN1bWVyQWxsb3dTaWduYWxXcml0ZXMgIT09IGZhbHNlOwp9CmZ1bmN0aW9uIGNvbnN1bWVyTWFya0RpcnR5KG5vZGUpIHsKICBub2RlLmRpcnR5ID0gdHJ1ZTsKICBwcm9kdWNlck5vdGlmeUNvbnN1bWVycyhub2RlKTsKICBub2RlLmNvbnN1bWVyTWFya2VkRGlydHk/Lihub2RlKTsKfQpmdW5jdGlvbiBwcm9kdWNlck1hcmtDbGVhbihub2RlKSB7CiAgbm9kZS5kaXJ0eSA9IGZhbHNlOwogIG5vZGUubGFzdENsZWFuRXBvY2ggPSBlcG9jaDsKfQpmdW5jdGlvbiBjb25zdW1lckJlZm9yZUNvbXB1dGF0aW9uKG5vZGUpIHsKICBpZiAobm9kZSkgcmVzZXRDb25zdW1lckJlZm9yZUNvbXB1dGF0aW9uKG5vZGUpOwogIHJldHVybiBzZXRBY3RpdmVDb25zdW1lcihub2RlKTsKfQpmdW5jdGlvbiByZXNldENvbnN1bWVyQmVmb3JlQ29tcHV0YXRpb24obm9kZSkgewogIG5vZGUucHJvZHVjZXJzVGFpbCA9IHZvaWQgMDsKICBub2RlLnJlY29tcHV0aW5nID0gdHJ1ZTsKfQpmdW5jdGlvbiBjb25zdW1lckFmdGVyQ29tcHV0YXRpb24obm9kZSwgcHJldkNvbnN1bWVyKSB7CiAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICBpZiAobm9kZSkgZmluYWxpemVDb25zdW1lckFmdGVyQ29tcHV0YXRpb24obm9kZSk7Cn0KZnVuY3Rpb24gZmluYWxpemVDb25zdW1lckFmdGVyQ29tcHV0YXRpb24obm9kZSkgewogIG5vZGUucmVjb21wdXRpbmcgPSBmYWxzZTsKICBjb25zdCBwcm9kdWNlcnNUYWlsID0gbm9kZS5wcm9kdWNlcnNUYWlsOwogIGxldCB0b1JlbW92ZSA9IHByb2R1Y2Vyc1RhaWwgIT09IHZvaWQgMCA/IHByb2R1Y2Vyc1RhaWwubmV4dFByb2R1Y2VyIDogbm9kZS5wcm9kdWNlcnM7CiAgaWYgKHRvUmVtb3ZlICE9PSB2b2lkIDApIHsKICAgIGlmIChjb25zdW1lcklzTGl2ZShub2RlKSkgewogICAgICBkbyB7CiAgICAgICAgdG9SZW1vdmUgPSBwcm9kdWNlclJlbW92ZUxpdmVDb25zdW1lckxpbmsodG9SZW1vdmUpOwogICAgICB9IHdoaWxlICh0b1JlbW92ZSAhPT0gdm9pZCAwKTsKICAgIH0KICAgIGlmIChwcm9kdWNlcnNUYWlsICE9PSB2b2lkIDApIHsKICAgICAgcHJvZHVjZXJzVGFpbC5uZXh0UHJvZHVjZXIgPSB2b2lkIDA7CiAgICB9IGVsc2UgewogICAgICBub2RlLnByb2R1Y2VycyA9IHZvaWQgMDsKICAgIH0KICB9Cn0KZnVuY3Rpb24gY29uc3VtZXJQb2xsUHJvZHVjZXJzRm9yQ2hhbmdlKG5vZGUpIHsKICBmb3IgKGxldCBsaW5rID0gbm9kZS5wcm9kdWNlcnM7IGxpbmsgIT09IHZvaWQgMDsgbGluayA9IGxpbmsubmV4dFByb2R1Y2VyKSB7CiAgICBjb25zdCBwcm9kdWNlciA9IGxpbmsucHJvZHVjZXI7CiAgICBjb25zdCBzZWVuVmVyc2lvbiA9IGxpbmsubGFzdFJlYWRWZXJzaW9uOwogICAgaWYgKHNlZW5WZXJzaW9uICE9PSBwcm9kdWNlci52ZXJzaW9uKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcHJvZHVjZXJVcGRhdGVWYWx1ZVZlcnNpb24ocHJvZHVjZXIpOwogICAgaWYgKHNlZW5WZXJzaW9uICE9PSBwcm9kdWNlci52ZXJzaW9uKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gY29uc3VtZXJEZXN0cm95KG5vZGUpIHsKICBpZiAoY29uc3VtZXJJc0xpdmUobm9kZSkpIHsKICAgIGxldCBsaW5rID0gbm9kZS5wcm9kdWNlcnM7CiAgICB3aGlsZSAobGluayAhPT0gdm9pZCAwKSB7CiAgICAgIGxpbmsgPSBwcm9kdWNlclJlbW92ZUxpdmVDb25zdW1lckxpbmsobGluayk7CiAgICB9CiAgfQogIG5vZGUucHJvZHVjZXJzID0gdm9pZCAwOwogIG5vZGUucHJvZHVjZXJzVGFpbCA9IHZvaWQgMDsKICBub2RlLmNvbnN1bWVycyA9IHZvaWQgMDsKICBub2RlLmNvbnN1bWVyc1RhaWwgPSB2b2lkIDA7Cn0KZnVuY3Rpb24gcHJvZHVjZXJBZGRMaXZlQ29uc3VtZXIobm9kZSwgbGluaykgewogIGNvbnN0IGNvbnN1bWVyc1RhaWwgPSBub2RlLmNvbnN1bWVyc1RhaWw7CiAgY29uc3Qgd2FzTGl2ZSA9IGNvbnN1bWVySXNMaXZlKG5vZGUpOwogIGlmIChjb25zdW1lcnNUYWlsICE9PSB2b2lkIDApIHsKICAgIGxpbmsubmV4dENvbnN1bWVyID0gY29uc3VtZXJzVGFpbC5uZXh0Q29uc3VtZXI7CiAgICBjb25zdW1lcnNUYWlsLm5leHRDb25zdW1lciA9IGxpbms7CiAgfSBlbHNlIHsKICAgIGxpbmsubmV4dENvbnN1bWVyID0gdm9pZCAwOwogICAgbm9kZS5jb25zdW1lcnMgPSBsaW5rOwogIH0KICBsaW5rLnByZXZDb25zdW1lciA9IGNvbnN1bWVyc1RhaWw7CiAgbm9kZS5jb25zdW1lcnNUYWlsID0gbGluazsKICBpZiAoIXdhc0xpdmUpIHsKICAgIGZvciAobGV0IGxpbmsyID0gbm9kZS5wcm9kdWNlcnM7IGxpbmsyICE9PSB2b2lkIDA7IGxpbmsyID0gbGluazIubmV4dFByb2R1Y2VyKSB7CiAgICAgIHByb2R1Y2VyQWRkTGl2ZUNvbnN1bWVyKGxpbmsyLnByb2R1Y2VyLCBsaW5rMik7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHByb2R1Y2VyUmVtb3ZlTGl2ZUNvbnN1bWVyTGluayhsaW5rKSB7CiAgY29uc3QgcHJvZHVjZXIgPSBsaW5rLnByb2R1Y2VyOwogIGNvbnN0IG5leHRQcm9kdWNlciA9IGxpbmsubmV4dFByb2R1Y2VyOwogIGNvbnN0IG5leHRDb25zdW1lciA9IGxpbmsubmV4dENvbnN1bWVyOwogIGNvbnN0IHByZXZDb25zdW1lciA9IGxpbmsucHJldkNvbnN1bWVyOwogIGxpbmsubmV4dENvbnN1bWVyID0gdm9pZCAwOwogIGxpbmsucHJldkNvbnN1bWVyID0gdm9pZCAwOwogIGlmIChuZXh0Q29uc3VtZXIgIT09IHZvaWQgMCkgewogICAgbmV4dENvbnN1bWVyLnByZXZDb25zdW1lciA9IHByZXZDb25zdW1lcjsKICB9IGVsc2UgewogICAgcHJvZHVjZXIuY29uc3VtZXJzVGFpbCA9IHByZXZDb25zdW1lcjsKICB9CiAgaWYgKHByZXZDb25zdW1lciAhPT0gdm9pZCAwKSB7CiAgICBwcmV2Q29uc3VtZXIubmV4dENvbnN1bWVyID0gbmV4dENvbnN1bWVyOwogIH0gZWxzZSB7CiAgICBwcm9kdWNlci5jb25zdW1lcnMgPSBuZXh0Q29uc3VtZXI7CiAgICBpZiAoIWNvbnN1bWVySXNMaXZlKHByb2R1Y2VyKSkgewogICAgICBsZXQgcHJvZHVjZXJMaW5rID0gcHJvZHVjZXIucHJvZHVjZXJzOwogICAgICB3aGlsZSAocHJvZHVjZXJMaW5rICE9PSB2b2lkIDApIHsKICAgICAgICBwcm9kdWNlckxpbmsgPSBwcm9kdWNlclJlbW92ZUxpdmVDb25zdW1lckxpbmsocHJvZHVjZXJMaW5rKTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gbmV4dFByb2R1Y2VyOwp9CmZ1bmN0aW9uIGNvbnN1bWVySXNMaXZlKG5vZGUpIHsKICByZXR1cm4gbm9kZS5jb25zdW1lcklzQWx3YXlzTGl2ZSB8fCBub2RlLmNvbnN1bWVycyAhPT0gdm9pZCAwOwp9CmZ1bmN0aW9uIHJ1blBvc3RQcm9kdWNlckNyZWF0ZWRGbihub2RlKSB7CiAgcG9zdFByb2R1Y2VyQ3JlYXRlZEZuPy4obm9kZSk7Cn0KZnVuY3Rpb24gaXNWYWxpZExpbmsoY2hlY2tMaW5rLCBjb25zdW1lcikgewogIGNvbnN0IHByb2R1Y2Vyc1RhaWwgPSBjb25zdW1lci5wcm9kdWNlcnNUYWlsOwogIGlmIChwcm9kdWNlcnNUYWlsICE9PSB2b2lkIDApIHsKICAgIGxldCBsaW5rID0gY29uc3VtZXIucHJvZHVjZXJzOwogICAgZG8gewogICAgICBpZiAobGluayA9PT0gY2hlY2tMaW5rKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgaWYgKGxpbmsgPT09IHByb2R1Y2Vyc1RhaWwpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBsaW5rID0gbGluay5uZXh0UHJvZHVjZXI7CiAgICB9IHdoaWxlIChsaW5rICE9PSB2b2lkIDApOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gZGVmYXVsdEVxdWFscyhhLCBiKSB7CiAgcmV0dXJuIE9iamVjdC5pcyhhLCBiKTsKfQpmdW5jdGlvbiBjcmVhdGVDb21wdXRlZChjb21wdXRhdGlvbiwgZXF1YWwpIHsKICBjb25zdCBub2RlID0gT2JqZWN0LmNyZWF0ZShDT01QVVRFRF9OT0RFKTsKICBub2RlLmNvbXB1dGF0aW9uID0gY29tcHV0YXRpb247CiAgaWYgKGVxdWFsICE9PSB2b2lkIDApIHsKICAgIG5vZGUuZXF1YWwgPSBlcXVhbDsKICB9CiAgY29uc3QgY29tcHV0ZWQyID0gKCkgPT4gewogICAgcHJvZHVjZXJVcGRhdGVWYWx1ZVZlcnNpb24obm9kZSk7CiAgICBwcm9kdWNlckFjY2Vzc2VkKG5vZGUpOwogICAgaWYgKG5vZGUudmFsdWUgPT09IEVSUk9SRUQpIHsKICAgICAgdGhyb3cgbm9kZS5lcnJvcjsKICAgIH0KICAgIHJldHVybiBub2RlLnZhbHVlOwogIH07CiAgY29tcHV0ZWQyW1NJR05BTF0gPSBub2RlOwogIGlmICh0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUpIHsKICAgIGNvbnN0IGRlYnVnTmFtZSA9IG5vZGUuZGVidWdOYW1lID8gIiAoIiArIG5vZGUuZGVidWdOYW1lICsgIikiIDogIiI7CiAgICBjb21wdXRlZDIudG9TdHJpbmcgPSAoKSA9PiBgW0NvbXB1dGVkJHtkZWJ1Z05hbWV9OiAke1N0cmluZyhub2RlLnZhbHVlKX1dYDsKICB9CiAgcnVuUG9zdFByb2R1Y2VyQ3JlYXRlZEZuKG5vZGUpOwogIHJldHVybiBjb21wdXRlZDI7Cn0KdmFyIFVOU0VUID0gLyogQF9fUFVSRV9fICovIFN5bWJvbCgiVU5TRVQiKTsKdmFyIENPTVBVVElORyA9IC8qIEBfX1BVUkVfXyAqLyBTeW1ib2woIkNPTVBVVElORyIpOwp2YXIgRVJST1JFRCA9IC8qIEBfX1BVUkVfXyAqLyBTeW1ib2woIkVSUk9SRUQiKTsKdmFyIENPTVBVVEVEX05PREUgPSAoKCkgPT4gewogIHJldHVybiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBSRUFDVElWRV9OT0RFKSwgewogICAgdmFsdWU6IFVOU0VULAogICAgZGlydHk6IHRydWUsCiAgICBlcnJvcjogbnVsbCwKICAgIGVxdWFsOiBkZWZhdWx0RXF1YWxzLAogICAga2luZDogImNvbXB1dGVkIiwKICAgIHByb2R1Y2VyTXVzdFJlY29tcHV0ZShub2RlKSB7CiAgICAgIHJldHVybiBub2RlLnZhbHVlID09PSBVTlNFVCB8fCBub2RlLnZhbHVlID09PSBDT01QVVRJTkc7CiAgICB9LAogICAgcHJvZHVjZXJSZWNvbXB1dGVWYWx1ZShub2RlKSB7CiAgICAgIGlmIChub2RlLnZhbHVlID09PSBDT01QVVRJTkcpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IodHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkRldGVjdGVkIGN5Y2xlIGluIGNvbXB1dGF0aW9ucy4iIDogIiIpOwogICAgICB9CiAgICAgIGNvbnN0IG9sZFZhbHVlID0gbm9kZS52YWx1ZTsKICAgICAgbm9kZS52YWx1ZSA9IENPTVBVVElORzsKICAgICAgY29uc3QgcHJldkNvbnN1bWVyID0gY29uc3VtZXJCZWZvcmVDb21wdXRhdGlvbihub2RlKTsKICAgICAgbGV0IG5ld1ZhbHVlOwogICAgICBsZXQgd2FzRXF1YWwgPSBmYWxzZTsKICAgICAgdHJ5IHsKICAgICAgICBuZXdWYWx1ZSA9IG5vZGUuY29tcHV0YXRpb24oKTsKICAgICAgICBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgICAgICB3YXNFcXVhbCA9IG9sZFZhbHVlICE9PSBVTlNFVCAmJiBvbGRWYWx1ZSAhPT0gRVJST1JFRCAmJiBuZXdWYWx1ZSAhPT0gRVJST1JFRCAmJiBub2RlLmVxdWFsKG9sZFZhbHVlLCBuZXdWYWx1ZSk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIG5ld1ZhbHVlID0gRVJST1JFRDsKICAgICAgICBub2RlLmVycm9yID0gZXJyOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGNvbnN1bWVyQWZ0ZXJDb21wdXRhdGlvbihub2RlLCBwcmV2Q29uc3VtZXIpOwogICAgICB9CiAgICAgIGlmICh3YXNFcXVhbCkgewogICAgICAgIG5vZGUudmFsdWUgPSBvbGRWYWx1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbm9kZS52YWx1ZSA9IG5ld1ZhbHVlOwogICAgICBub2RlLnZlcnNpb24rKzsKICAgIH0KICB9KTsKfSkoKTsKZnVuY3Rpb24gZGVmYXVsdFRocm93RXJyb3IoKSB7CiAgdGhyb3cgbmV3IEVycm9yKCk7Cn0KdmFyIHRocm93SW52YWxpZFdyaXRlVG9TaWduYWxFcnJvckZuID0gZGVmYXVsdFRocm93RXJyb3I7CmZ1bmN0aW9uIHRocm93SW52YWxpZFdyaXRlVG9TaWduYWxFcnJvcihub2RlKSB7CiAgdGhyb3dJbnZhbGlkV3JpdGVUb1NpZ25hbEVycm9yRm4obm9kZSk7Cn0KZnVuY3Rpb24gc2V0VGhyb3dJbnZhbGlkV3JpdGVUb1NpZ25hbEVycm9yKGZuKSB7CiAgdGhyb3dJbnZhbGlkV3JpdGVUb1NpZ25hbEVycm9yRm4gPSBmbjsKfQp2YXIgcG9zdFNpZ25hbFNldEZuID0gbnVsbDsKZnVuY3Rpb24gY3JlYXRlU2lnbmFsKGluaXRpYWxWYWx1ZSwgZXF1YWwpIHsKICBjb25zdCBub2RlID0gT2JqZWN0LmNyZWF0ZShTSUdOQUxfTk9ERSk7CiAgbm9kZS52YWx1ZSA9IGluaXRpYWxWYWx1ZTsKICBpZiAoZXF1YWwgIT09IHZvaWQgMCkgewogICAgbm9kZS5lcXVhbCA9IGVxdWFsOwogIH0KICBjb25zdCBnZXR0ZXIgPSAoKSA9PiBzaWduYWxHZXRGbihub2RlKTsKICBnZXR0ZXJbU0lHTkFMXSA9IG5vZGU7CiAgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSkgewogICAgY29uc3QgZGVidWdOYW1lID0gbm9kZS5kZWJ1Z05hbWUgPyAiICgiICsgbm9kZS5kZWJ1Z05hbWUgKyAiKSIgOiAiIjsKICAgIGdldHRlci50b1N0cmluZyA9ICgpID0+IGBbU2lnbmFsJHtkZWJ1Z05hbWV9OiAke1N0cmluZyhub2RlLnZhbHVlKX1dYDsKICB9CiAgcnVuUG9zdFByb2R1Y2VyQ3JlYXRlZEZuKG5vZGUpOwogIGNvbnN0IHNldDIgPSAobmV3VmFsdWUpID0+IHNpZ25hbFNldEZuKG5vZGUsIG5ld1ZhbHVlKTsKICBjb25zdCB1cGRhdGUgPSAodXBkYXRlRm4pID0+IHNpZ25hbFVwZGF0ZUZuKG5vZGUsIHVwZGF0ZUZuKTsKICByZXR1cm4gW2dldHRlciwgc2V0MiwgdXBkYXRlXTsKfQpmdW5jdGlvbiBzaWduYWxHZXRGbihub2RlKSB7CiAgcHJvZHVjZXJBY2Nlc3NlZChub2RlKTsKICByZXR1cm4gbm9kZS52YWx1ZTsKfQpmdW5jdGlvbiBzaWduYWxTZXRGbihub2RlLCBuZXdWYWx1ZSkgewogIGlmICghcHJvZHVjZXJVcGRhdGVzQWxsb3dlZCgpKSB7CiAgICB0aHJvd0ludmFsaWRXcml0ZVRvU2lnbmFsRXJyb3Iobm9kZSk7CiAgfQogIGlmICghbm9kZS5lcXVhbChub2RlLnZhbHVlLCBuZXdWYWx1ZSkpIHsKICAgIG5vZGUudmFsdWUgPSBuZXdWYWx1ZTsKICAgIHNpZ25hbFZhbHVlQ2hhbmdlZChub2RlKTsKICB9Cn0KZnVuY3Rpb24gc2lnbmFsVXBkYXRlRm4obm9kZSwgdXBkYXRlcikgewogIGlmICghcHJvZHVjZXJVcGRhdGVzQWxsb3dlZCgpKSB7CiAgICB0aHJvd0ludmFsaWRXcml0ZVRvU2lnbmFsRXJyb3Iobm9kZSk7CiAgfQogIHNpZ25hbFNldEZuKG5vZGUsIHVwZGF0ZXIobm9kZS52YWx1ZSkpOwp9CnZhciBTSUdOQUxfTk9ERSA9ICgoKSA9PiB7CiAgcmV0dXJuIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIFJFQUNUSVZFX05PREUpLCB7CiAgICBlcXVhbDogZGVmYXVsdEVxdWFscywKICAgIHZhbHVlOiB2b2lkIDAsCiAgICBraW5kOiAic2lnbmFsIgogIH0pOwp9KSgpOwpmdW5jdGlvbiBzaWduYWxWYWx1ZUNoYW5nZWQobm9kZSkgewogIG5vZGUudmVyc2lvbisrOwogIHByb2R1Y2VySW5jcmVtZW50RXBvY2goKTsKICBwcm9kdWNlck5vdGlmeUNvbnN1bWVycyhub2RlKTsKICBwb3N0U2lnbmFsU2V0Rm4/Lihub2RlKTsKfQpmdW5jdGlvbiB1bnRyYWNrZWQobm9uUmVhY3RpdmVSZWFkc0ZuKSB7CiAgY29uc3QgcHJldkNvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgdHJ5IHsKICAgIHJldHVybiBub25SZWFjdGl2ZVJlYWRzRm4oKTsKICB9IGZpbmFsbHkgewogICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICB9Cn0KdmFyIEJBU0VfRUZGRUNUX05PREUgPSAoKCkgPT4gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgUkVBQ1RJVkVfTk9ERSksIHsKICBjb25zdW1lcklzQWx3YXlzTGl2ZTogdHJ1ZSwKICBjb25zdW1lckFsbG93U2lnbmFsV3JpdGVzOiB0cnVlLAogIGRpcnR5OiB0cnVlLAogIGtpbmQ6ICJlZmZlY3QiCn0pKSgpOwpmdW5jdGlvbiBydW5FZmZlY3Qobm9kZSkgewogIG5vZGUuZGlydHkgPSBmYWxzZTsKICBpZiAobm9kZS52ZXJzaW9uID4gMCAmJiAhY29uc3VtZXJQb2xsUHJvZHVjZXJzRm9yQ2hhbmdlKG5vZGUpKSB7CiAgICByZXR1cm47CiAgfQogIG5vZGUudmVyc2lvbisrOwogIGNvbnN0IHByZXZOb2RlID0gY29uc3VtZXJCZWZvcmVDb21wdXRhdGlvbihub2RlKTsKICB0cnkgewogICAgbm9kZS5jbGVhbnVwKCk7CiAgICBub2RlLmZuKCk7CiAgfSBmaW5hbGx5IHsKICAgIGNvbnN1bWVyQWZ0ZXJDb21wdXRhdGlvbihub2RlLCBwcmV2Tm9kZSk7CiAgfQp9CgovLyBub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2Lm1qcwp2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHsKICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24oZDIsIGIyKSB7CiAgICBkMi5fX3Byb3RvX18gPSBiMjsKICB9IHx8IGZ1bmN0aW9uKGQyLCBiMikgewogICAgZm9yICh2YXIgcCBpbiBiMikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiMiwgcCkpIGQyW3BdID0gYjJbcF07CiAgfTsKICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKfTsKZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHsKICBpZiAodHlwZW9mIGIgIT09ICJmdW5jdGlvbiIgJiYgYiAhPT0gbnVsbCkKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIiArIFN0cmluZyhiKSArICIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbCIpOwogIGV4dGVuZFN0YXRpY3MoZCwgYik7CiAgZnVuY3Rpb24gX18oKSB7CiAgICB0aGlzLmNvbnN0cnVjdG9yID0gZDsKICB9CiAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9CmZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsKICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24ocmVzb2x2ZSkgewogICAgICByZXNvbHZlKHZhbHVlKTsKICAgIH0pOwogIH0KICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7CiAgICAgIHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOwogICAgfQogICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOwogIH0pOwp9CmZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHsKICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOwogICAgcmV0dXJuIHRbMV07CiAgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZyA9IE9iamVjdC5jcmVhdGUoKHR5cGVvZiBJdGVyYXRvciA9PT0gImZ1bmN0aW9uIiA/IEl0ZXJhdG9yIDogT2JqZWN0KS5wcm90b3R5cGUpOwogIHJldHVybiBnLm5leHQgPSB2ZXJiKDApLCBnWyJ0aHJvdyJdID0gdmVyYigxKSwgZ1sicmV0dXJuIl0gPSB2ZXJiKDIpLCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzOwogIH0pLCBnOwogIGZ1bmN0aW9uIHZlcmIobikgewogICAgcmV0dXJuIGZ1bmN0aW9uKHYpIHsKICAgICAgcmV0dXJuIHN0ZXAoW24sIHZdKTsKICAgIH07CiAgfQogIGZ1bmN0aW9uIHN0ZXAob3ApIHsKICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7CiAgICB3aGlsZSAoZyAmJiAoZyA9IDAsIG9wWzBdICYmIChfID0gMCkpLCBfKSB0cnkgewogICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5WyJyZXR1cm4iXSA6IG9wWzBdID8geVsidGhyb3ciXSB8fCAoKHQgPSB5WyJyZXR1cm4iXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7CiAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTsKICAgICAgc3dpdGNoIChvcFswXSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0ID0gb3A7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBfLmxhYmVsKys7CiAgICAgICAgICByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07CiAgICAgICAgY2FzZSA1OgogICAgICAgICAgXy5sYWJlbCsrOwogICAgICAgICAgeSA9IG9wWzFdOwogICAgICAgICAgb3AgPSBbMF07CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBjYXNlIDc6CiAgICAgICAgICBvcCA9IF8ub3BzLnBvcCgpOwogICAgICAgICAgXy50cnlzLnBvcCgpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7CiAgICAgICAgICAgIF8gPSAwOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgb3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpIHsKICAgICAgICAgICAgXy5sYWJlbCA9IG9wWzFdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgewogICAgICAgICAgICBfLmxhYmVsID0gdFsxXTsKICAgICAgICAgICAgdCA9IG9wOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7CiAgICAgICAgICAgIF8ubGFiZWwgPSB0WzJdOwogICAgICAgICAgICBfLm9wcy5wdXNoKG9wKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7CiAgICAgICAgICBfLnRyeXMucG9wKCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgb3AgPSBbNiwgZV07CiAgICAgIHkgPSAwOwogICAgfSBmaW5hbGx5IHsKICAgICAgZiA9IHQgPSAwOwogICAgfQogICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07CiAgICByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9OwogIH0KfQpmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7CiAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CiAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CiAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKICAgIG5leHQ6IGZ1bmN0aW9uKCkgewogICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwogICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CiAgICB9CiAgfTsKICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKfQpmdW5jdGlvbiBfX3JlYWQobywgbikgewogIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07CiAgaWYgKCFtKSByZXR1cm4gbzsKICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTsKICB0cnkgewogICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGUgPSB7IGVycm9yIH07CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpWyJyZXR1cm4iXSkpIG0uY2FsbChpKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChlKSB0aHJvdyBlLmVycm9yOwogICAgfQogIH0KICByZXR1cm4gYXI7Cn0KZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbTIsIHBhY2spIHsKICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20yLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHsKICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbTIpKSB7CiAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbTIsIDAsIGkpOwogICAgICBhcltpXSA9IGZyb20yW2ldOwogICAgfQogIH0KICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20yKSk7Cn0KZnVuY3Rpb24gX19hd2FpdCh2KSB7CiAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7Cn0KZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHsKICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdOwogIHJldHVybiBpID0gT2JqZWN0LmNyZWF0ZSgodHlwZW9mIEFzeW5jSXRlcmF0b3IgPT09ICJmdW5jdGlvbiIgPyBBc3luY0l0ZXJhdG9yIDogT2JqZWN0KS5wcm90b3R5cGUpLCB2ZXJiKCJuZXh0IiksIHZlcmIoInRocm93IiksIHZlcmIoInJldHVybiIsIGF3YWl0UmV0dXJuKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzOwogIH0sIGk7CiAgZnVuY3Rpb24gYXdhaXRSZXR1cm4oZikgewogICAgcmV0dXJuIGZ1bmN0aW9uKHYpIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGYsIHJlamVjdCk7CiAgICB9OwogIH0KICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsKICAgIGlmIChnW25dKSB7CiAgICAgIGlbbl0gPSBmdW5jdGlvbih2KSB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgIHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICAgIGlmIChmKSBpW25dID0gZihpW25dKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsKICAgIHRyeSB7CiAgICAgIHN0ZXAoZ1tuXSh2KSk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHNldHRsZShxWzBdWzNdLCBlKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc3RlcChyKSB7CiAgICByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsKICB9CiAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgewogICAgcmVzdW1lKCJuZXh0IiwgdmFsdWUpOwogIH0KICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsKICAgIHJlc3VtZSgidGhyb3ciLCB2YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7CiAgICBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOwogIH0KfQpmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHsKICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpOwogIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09ICJmdW5jdGlvbiIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoIm5leHQiKSwgdmVyYigidGhyb3ciKSwgdmVyYigicmV0dXJuIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpczsKICB9LCBpKTsKICBmdW5jdGlvbiB2ZXJiKG4pIHsKICAgIGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uKHYpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOwogICAgICB9KTsKICAgIH07CiAgfQogIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsKICAgIFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYyKSB7CiAgICAgIHJlc29sdmUoeyB2YWx1ZTogdjIsIGRvbmU6IGQgfSk7CiAgICB9LCByZWplY3QpOwogIH0KfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvaXNGdW5jdGlvbi5qcwpmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gImZ1bmN0aW9uIjsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvY3JlYXRlRXJyb3JDbGFzcy5qcwpmdW5jdGlvbiBjcmVhdGVFcnJvckNsYXNzKGNyZWF0ZUltcGwpIHsKICB2YXIgX3N1cGVyID0gZnVuY3Rpb24oaW5zdGFuY2UpIHsKICAgIEVycm9yLmNhbGwoaW5zdGFuY2UpOwogICAgaW5zdGFuY2Uuc3RhY2sgPSBuZXcgRXJyb3IoKS5zdGFjazsKICB9OwogIHZhciBjdG9yRnVuYyA9IGNyZWF0ZUltcGwoX3N1cGVyKTsKICBjdG9yRnVuYy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7CiAgY3RvckZ1bmMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY3RvckZ1bmM7CiAgcmV0dXJuIGN0b3JGdW5jOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9VbnN1YnNjcmlwdGlvbkVycm9yLmpzCnZhciBVbnN1YnNjcmlwdGlvbkVycm9yID0gY3JlYXRlRXJyb3JDbGFzcyhmdW5jdGlvbihfc3VwZXIpIHsKICByZXR1cm4gZnVuY3Rpb24gVW5zdWJzY3JpcHRpb25FcnJvckltcGwoZXJyb3JzKSB7CiAgICBfc3VwZXIodGhpcyk7CiAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvcnMgPyBlcnJvcnMubGVuZ3RoICsgIiBlcnJvcnMgb2NjdXJyZWQgZHVyaW5nIHVuc3Vic2NyaXB0aW9uOlxuIiArIGVycm9ycy5tYXAoZnVuY3Rpb24oZXJyLCBpKSB7CiAgICAgIHJldHVybiBpICsgMSArICIpICIgKyBlcnIudG9TdHJpbmcoKTsKICAgIH0pLmpvaW4oIlxuICAiKSA6ICIiOwogICAgdGhpcy5uYW1lID0gIlVuc3Vic2NyaXB0aW9uRXJyb3IiOwogICAgdGhpcy5lcnJvcnMgPSBlcnJvcnM7CiAgfTsKfSk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9hcnJSZW1vdmUuanMKZnVuY3Rpb24gYXJyUmVtb3ZlKGFyciwgaXRlbSkgewogIGlmIChhcnIpIHsKICAgIHZhciBpbmRleCA9IGFyci5pbmRleE9mKGl0ZW0pOwogICAgMCA8PSBpbmRleCAmJiBhcnIuc3BsaWNlKGluZGV4LCAxKTsKICB9Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9TdWJzY3JpcHRpb24uanMKdmFyIFN1YnNjcmlwdGlvbiA9IChmdW5jdGlvbigpIHsKICBmdW5jdGlvbiBTdWJzY3JpcHRpb24yKGluaXRpYWxUZWFyZG93bikgewogICAgdGhpcy5pbml0aWFsVGVhcmRvd24gPSBpbml0aWFsVGVhcmRvd247CiAgICB0aGlzLmNsb3NlZCA9IGZhbHNlOwogICAgdGhpcy5fcGFyZW50YWdlID0gbnVsbDsKICAgIHRoaXMuX2ZpbmFsaXplcnMgPSBudWxsOwogIH0KICBTdWJzY3JpcHRpb24yLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIGVfMSwgX2EsIGVfMiwgX2I7CiAgICB2YXIgZXJyb3JzOwogICAgaWYgKCF0aGlzLmNsb3NlZCkgewogICAgICB0aGlzLmNsb3NlZCA9IHRydWU7CiAgICAgIHZhciBfcGFyZW50YWdlID0gdGhpcy5fcGFyZW50YWdlOwogICAgICBpZiAoX3BhcmVudGFnZSkgewogICAgICAgIHRoaXMuX3BhcmVudGFnZSA9IG51bGw7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoX3BhcmVudGFnZSkpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAodmFyIF9wYXJlbnRhZ2VfMSA9IF9fdmFsdWVzKF9wYXJlbnRhZ2UpLCBfcGFyZW50YWdlXzFfMSA9IF9wYXJlbnRhZ2VfMS5uZXh0KCk7ICFfcGFyZW50YWdlXzFfMS5kb25lOyBfcGFyZW50YWdlXzFfMSA9IF9wYXJlbnRhZ2VfMS5uZXh0KCkpIHsKICAgICAgICAgICAgICB2YXIgcGFyZW50XzEgPSBfcGFyZW50YWdlXzFfMS52YWx1ZTsKICAgICAgICAgICAgICBwYXJlbnRfMS5yZW1vdmUodGhpcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVfMV8xKSB7CiAgICAgICAgICAgIGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChfcGFyZW50YWdlXzFfMSAmJiAhX3BhcmVudGFnZV8xXzEuZG9uZSAmJiAoX2EgPSBfcGFyZW50YWdlXzEucmV0dXJuKSkgX2EuY2FsbChfcGFyZW50YWdlXzEpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcGFyZW50YWdlLnJlbW92ZSh0aGlzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIGluaXRpYWxGaW5hbGl6ZXIgPSB0aGlzLmluaXRpYWxUZWFyZG93bjsKICAgICAgaWYgKGlzRnVuY3Rpb24oaW5pdGlhbEZpbmFsaXplcikpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaW5pdGlhbEZpbmFsaXplcigpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGVycm9ycyA9IGUgaW5zdGFuY2VvZiBVbnN1YnNjcmlwdGlvbkVycm9yID8gZS5lcnJvcnMgOiBbZV07CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciBfZmluYWxpemVycyA9IHRoaXMuX2ZpbmFsaXplcnM7CiAgICAgIGlmIChfZmluYWxpemVycykgewogICAgICAgIHRoaXMuX2ZpbmFsaXplcnMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKHZhciBfZmluYWxpemVyc18xID0gX192YWx1ZXMoX2ZpbmFsaXplcnMpLCBfZmluYWxpemVyc18xXzEgPSBfZmluYWxpemVyc18xLm5leHQoKTsgIV9maW5hbGl6ZXJzXzFfMS5kb25lOyBfZmluYWxpemVyc18xXzEgPSBfZmluYWxpemVyc18xLm5leHQoKSkgewogICAgICAgICAgICB2YXIgZmluYWxpemVyID0gX2ZpbmFsaXplcnNfMV8xLnZhbHVlOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGV4ZWNGaW5hbGl6ZXIoZmluYWxpemVyKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgZXJyb3JzID0gZXJyb3JzICE9PSBudWxsICYmIGVycm9ycyAhPT0gdm9pZCAwID8gZXJyb3JzIDogW107CiAgICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIFVuc3Vic2NyaXB0aW9uRXJyb3IpIHsKICAgICAgICAgICAgICAgIGVycm9ycyA9IF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGVycm9ycykpLCBfX3JlYWQoZXJyLmVycm9ycykpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChlcnIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVfMl8xKSB7CiAgICAgICAgICBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoX2ZpbmFsaXplcnNfMV8xICYmICFfZmluYWxpemVyc18xXzEuZG9uZSAmJiAoX2IgPSBfZmluYWxpemVyc18xLnJldHVybikpIF9iLmNhbGwoX2ZpbmFsaXplcnNfMSk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChlcnJvcnMpIHsKICAgICAgICB0aHJvdyBuZXcgVW5zdWJzY3JpcHRpb25FcnJvcihlcnJvcnMpOwogICAgICB9CiAgICB9CiAgfTsKICBTdWJzY3JpcHRpb24yLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbih0ZWFyZG93bikgewogICAgdmFyIF9hOwogICAgaWYgKHRlYXJkb3duICYmIHRlYXJkb3duICE9PSB0aGlzKSB7CiAgICAgIGlmICh0aGlzLmNsb3NlZCkgewogICAgICAgIGV4ZWNGaW5hbGl6ZXIodGVhcmRvd24pOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0ZWFyZG93biBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbjIpIHsKICAgICAgICAgIGlmICh0ZWFyZG93bi5jbG9zZWQgfHwgdGVhcmRvd24uX2hhc1BhcmVudCh0aGlzKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0ZWFyZG93bi5fYWRkUGFyZW50KHRoaXMpOwogICAgICAgIH0KICAgICAgICAodGhpcy5fZmluYWxpemVycyA9IChfYSA9IHRoaXMuX2ZpbmFsaXplcnMpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdKS5wdXNoKHRlYXJkb3duKTsKICAgICAgfQogICAgfQogIH07CiAgU3Vic2NyaXB0aW9uMi5wcm90b3R5cGUuX2hhc1BhcmVudCA9IGZ1bmN0aW9uKHBhcmVudCkgewogICAgdmFyIF9wYXJlbnRhZ2UgPSB0aGlzLl9wYXJlbnRhZ2U7CiAgICByZXR1cm4gX3BhcmVudGFnZSA9PT0gcGFyZW50IHx8IEFycmF5LmlzQXJyYXkoX3BhcmVudGFnZSkgJiYgX3BhcmVudGFnZS5pbmNsdWRlcyhwYXJlbnQpOwogIH07CiAgU3Vic2NyaXB0aW9uMi5wcm90b3R5cGUuX2FkZFBhcmVudCA9IGZ1bmN0aW9uKHBhcmVudCkgewogICAgdmFyIF9wYXJlbnRhZ2UgPSB0aGlzLl9wYXJlbnRhZ2U7CiAgICB0aGlzLl9wYXJlbnRhZ2UgPSBBcnJheS5pc0FycmF5KF9wYXJlbnRhZ2UpID8gKF9wYXJlbnRhZ2UucHVzaChwYXJlbnQpLCBfcGFyZW50YWdlKSA6IF9wYXJlbnRhZ2UgPyBbX3BhcmVudGFnZSwgcGFyZW50XSA6IHBhcmVudDsKICB9OwogIFN1YnNjcmlwdGlvbjIucHJvdG90eXBlLl9yZW1vdmVQYXJlbnQgPSBmdW5jdGlvbihwYXJlbnQpIHsKICAgIHZhciBfcGFyZW50YWdlID0gdGhpcy5fcGFyZW50YWdlOwogICAgaWYgKF9wYXJlbnRhZ2UgPT09IHBhcmVudCkgewogICAgICB0aGlzLl9wYXJlbnRhZ2UgPSBudWxsOwogICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KF9wYXJlbnRhZ2UpKSB7CiAgICAgIGFyclJlbW92ZShfcGFyZW50YWdlLCBwYXJlbnQpOwogICAgfQogIH07CiAgU3Vic2NyaXB0aW9uMi5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24odGVhcmRvd24pIHsKICAgIHZhciBfZmluYWxpemVycyA9IHRoaXMuX2ZpbmFsaXplcnM7CiAgICBfZmluYWxpemVycyAmJiBhcnJSZW1vdmUoX2ZpbmFsaXplcnMsIHRlYXJkb3duKTsKICAgIGlmICh0ZWFyZG93biBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbjIpIHsKICAgICAgdGVhcmRvd24uX3JlbW92ZVBhcmVudCh0aGlzKTsKICAgIH0KICB9OwogIFN1YnNjcmlwdGlvbjIuRU1QVFkgPSAoZnVuY3Rpb24oKSB7CiAgICB2YXIgZW1wdHkyID0gbmV3IFN1YnNjcmlwdGlvbjIoKTsKICAgIGVtcHR5Mi5jbG9zZWQgPSB0cnVlOwogICAgcmV0dXJuIGVtcHR5MjsKICB9KSgpOwogIHJldHVybiBTdWJzY3JpcHRpb24yOwp9KSgpOwp2YXIgRU1QVFlfU1VCU0NSSVBUSU9OID0gU3Vic2NyaXB0aW9uLkVNUFRZOwpmdW5jdGlvbiBpc1N1YnNjcmlwdGlvbih2YWx1ZSkgewogIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbiB8fCB2YWx1ZSAmJiAiY2xvc2VkIiBpbiB2YWx1ZSAmJiBpc0Z1bmN0aW9uKHZhbHVlLnJlbW92ZSkgJiYgaXNGdW5jdGlvbih2YWx1ZS5hZGQpICYmIGlzRnVuY3Rpb24odmFsdWUudW5zdWJzY3JpYmUpOwp9CmZ1bmN0aW9uIGV4ZWNGaW5hbGl6ZXIoZmluYWxpemVyKSB7CiAgaWYgKGlzRnVuY3Rpb24oZmluYWxpemVyKSkgewogICAgZmluYWxpemVyKCk7CiAgfSBlbHNlIHsKICAgIGZpbmFsaXplci51bnN1YnNjcmliZSgpOwogIH0KfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL2NvbmZpZy5qcwp2YXIgY29uZmlnID0gewogIG9uVW5oYW5kbGVkRXJyb3I6IG51bGwsCiAgb25TdG9wcGVkTm90aWZpY2F0aW9uOiBudWxsLAogIFByb21pc2U6IHZvaWQgMCwKICB1c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nOiBmYWxzZSwKICB1c2VEZXByZWNhdGVkTmV4dENvbnRleHQ6IGZhbHNlCn07CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL3RpbWVvdXRQcm92aWRlci5qcwp2YXIgdGltZW91dFByb3ZpZGVyID0gewogIHNldFRpbWVvdXQ6IGZ1bmN0aW9uKGhhbmRsZXIsIHRpbWVvdXQyKSB7CiAgICB2YXIgYXJncyA9IFtdOwogICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTsKICAgIH0KICAgIHZhciBkZWxlZ2F0ZSA9IHRpbWVvdXRQcm92aWRlci5kZWxlZ2F0ZTsKICAgIGlmIChkZWxlZ2F0ZSA9PT0gbnVsbCB8fCBkZWxlZ2F0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVsZWdhdGUuc2V0VGltZW91dCkgewogICAgICByZXR1cm4gZGVsZWdhdGUuc2V0VGltZW91dC5hcHBseShkZWxlZ2F0ZSwgX19zcHJlYWRBcnJheShbaGFuZGxlciwgdGltZW91dDJdLCBfX3JlYWQoYXJncykpKTsKICAgIH0KICAgIHJldHVybiBzZXRUaW1lb3V0LmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbaGFuZGxlciwgdGltZW91dDJdLCBfX3JlYWQoYXJncykpKTsKICB9LAogIGNsZWFyVGltZW91dDogZnVuY3Rpb24oaGFuZGxlKSB7CiAgICB2YXIgZGVsZWdhdGUgPSB0aW1lb3V0UHJvdmlkZXIuZGVsZWdhdGU7CiAgICByZXR1cm4gKChkZWxlZ2F0ZSA9PT0gbnVsbCB8fCBkZWxlZ2F0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVsZWdhdGUuY2xlYXJUaW1lb3V0KSB8fCBjbGVhclRpbWVvdXQpKGhhbmRsZSk7CiAgfSwKICBkZWxlZ2F0ZTogdm9pZCAwCn07CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9yZXBvcnRVbmhhbmRsZWRFcnJvci5qcwpmdW5jdGlvbiByZXBvcnRVbmhhbmRsZWRFcnJvcihlcnIpIHsKICB0aW1lb3V0UHJvdmlkZXIuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgIHZhciBvblVuaGFuZGxlZEVycm9yID0gY29uZmlnLm9uVW5oYW5kbGVkRXJyb3I7CiAgICBpZiAob25VbmhhbmRsZWRFcnJvcikgewogICAgICBvblVuaGFuZGxlZEVycm9yKGVycik7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBlcnI7CiAgICB9CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL25vb3AuanMKZnVuY3Rpb24gbm9vcCgpIHsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL05vdGlmaWNhdGlvbkZhY3Rvcmllcy5qcwp2YXIgQ09NUExFVEVfTk9USUZJQ0FUSU9OID0gKGZ1bmN0aW9uKCkgewogIHJldHVybiBjcmVhdGVOb3RpZmljYXRpb24oIkMiLCB2b2lkIDAsIHZvaWQgMCk7Cn0pKCk7CmZ1bmN0aW9uIGVycm9yTm90aWZpY2F0aW9uKGVycm9yKSB7CiAgcmV0dXJuIGNyZWF0ZU5vdGlmaWNhdGlvbigiRSIsIHZvaWQgMCwgZXJyb3IpOwp9CmZ1bmN0aW9uIG5leHROb3RpZmljYXRpb24odmFsdWUpIHsKICByZXR1cm4gY3JlYXRlTm90aWZpY2F0aW9uKCJOIiwgdmFsdWUsIHZvaWQgMCk7Cn0KZnVuY3Rpb24gY3JlYXRlTm90aWZpY2F0aW9uKGtpbmQsIHZhbHVlLCBlcnJvcikgewogIHJldHVybiB7CiAgICBraW5kLAogICAgdmFsdWUsCiAgICBlcnJvcgogIH07Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2Vycm9yQ29udGV4dC5qcwp2YXIgY29udGV4dCA9IG51bGw7CmZ1bmN0aW9uIGVycm9yQ29udGV4dChjYikgewogIGlmIChjb25maWcudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZykgewogICAgdmFyIGlzUm9vdCA9ICFjb250ZXh0OwogICAgaWYgKGlzUm9vdCkgewogICAgICBjb250ZXh0ID0geyBlcnJvclRocm93bjogZmFsc2UsIGVycm9yOiBudWxsIH07CiAgICB9CiAgICBjYigpOwogICAgaWYgKGlzUm9vdCkgewogICAgICB2YXIgX2EgPSBjb250ZXh0LCBlcnJvclRocm93biA9IF9hLmVycm9yVGhyb3duLCBlcnJvciA9IF9hLmVycm9yOwogICAgICBjb250ZXh0ID0gbnVsbDsKICAgICAgaWYgKGVycm9yVGhyb3duKSB7CiAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgewogICAgY2IoKTsKICB9Cn0KZnVuY3Rpb24gY2FwdHVyZUVycm9yKGVycikgewogIGlmIChjb25maWcudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyAmJiBjb250ZXh0KSB7CiAgICBjb250ZXh0LmVycm9yVGhyb3duID0gdHJ1ZTsKICAgIGNvbnRleHQuZXJyb3IgPSBlcnI7CiAgfQp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvU3Vic2NyaWJlci5qcwp2YXIgU3Vic2NyaWJlciA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoU3Vic2NyaWJlcjIsIF9zdXBlcik7CiAgZnVuY3Rpb24gU3Vic2NyaWJlcjIoZGVzdGluYXRpb24pIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICBfdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTsKICAgIGlmIChkZXN0aW5hdGlvbikgewogICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uOwogICAgICBpZiAoaXNTdWJzY3JpcHRpb24oZGVzdGluYXRpb24pKSB7CiAgICAgICAgZGVzdGluYXRpb24uYWRkKF90aGlzKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgX3RoaXMuZGVzdGluYXRpb24gPSBFTVBUWV9PQlNFUlZFUjsKICAgIH0KICAgIHJldHVybiBfdGhpczsKICB9CiAgU3Vic2NyaWJlcjIuY3JlYXRlID0gZnVuY3Rpb24obmV4dCwgZXJyb3IsIGNvbXBsZXRlKSB7CiAgICByZXR1cm4gbmV3IFNhZmVTdWJzY3JpYmVyKG5leHQsIGVycm9yLCBjb21wbGV0ZSk7CiAgfTsKICBTdWJzY3JpYmVyMi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsKICAgICAgaGFuZGxlU3RvcHBlZE5vdGlmaWNhdGlvbihuZXh0Tm90aWZpY2F0aW9uKHZhbHVlKSwgdGhpcyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9uZXh0KHZhbHVlKTsKICAgIH0KICB9OwogIFN1YnNjcmliZXIyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGVycikgewogICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7CiAgICAgIGhhbmRsZVN0b3BwZWROb3RpZmljYXRpb24oZXJyb3JOb3RpZmljYXRpb24oZXJyKSwgdGhpcyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7CiAgICAgIHRoaXMuX2Vycm9yKGVycik7CiAgICB9CiAgfTsKICBTdWJzY3JpYmVyMi5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgewogICAgICBoYW5kbGVTdG9wcGVkTm90aWZpY2F0aW9uKENPTVBMRVRFX05PVElGSUNBVElPTiwgdGhpcyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7CiAgICAgIHRoaXMuX2NvbXBsZXRlKCk7CiAgICB9CiAgfTsKICBTdWJzY3JpYmVyMi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbigpIHsKICAgIGlmICghdGhpcy5jbG9zZWQpIHsKICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOwogICAgICBfc3VwZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlLmNhbGwodGhpcyk7CiAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBudWxsOwogICAgfQogIH07CiAgU3Vic2NyaWJlcjIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dCh2YWx1ZSk7CiAgfTsKICBTdWJzY3JpYmVyMi5wcm90b3R5cGUuX2Vycm9yID0gZnVuY3Rpb24oZXJyKSB7CiAgICB0cnkgewogICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICB9CiAgfTsKICBTdWJzY3JpYmVyMi5wcm90b3R5cGUuX2NvbXBsZXRlID0gZnVuY3Rpb24oKSB7CiAgICB0cnkgewogICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7CiAgICB9IGZpbmFsbHkgewogICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICB9CiAgfTsKICByZXR1cm4gU3Vic2NyaWJlcjI7Cn0pKFN1YnNjcmlwdGlvbik7CnZhciBfYmluZCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kOwpmdW5jdGlvbiBiaW5kKGZuLCB0aGlzQXJnKSB7CiAgcmV0dXJuIF9iaW5kLmNhbGwoZm4sIHRoaXNBcmcpOwp9CnZhciBDb25zdW1lck9ic2VydmVyID0gKGZ1bmN0aW9uKCkgewogIGZ1bmN0aW9uIENvbnN1bWVyT2JzZXJ2ZXIyKHBhcnRpYWxPYnNlcnZlcikgewogICAgdGhpcy5wYXJ0aWFsT2JzZXJ2ZXIgPSBwYXJ0aWFsT2JzZXJ2ZXI7CiAgfQogIENvbnN1bWVyT2JzZXJ2ZXIyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIHZhciBwYXJ0aWFsT2JzZXJ2ZXIgPSB0aGlzLnBhcnRpYWxPYnNlcnZlcjsKICAgIGlmIChwYXJ0aWFsT2JzZXJ2ZXIubmV4dCkgewogICAgICB0cnkgewogICAgICAgIHBhcnRpYWxPYnNlcnZlci5uZXh0KHZhbHVlKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBoYW5kbGVVbmhhbmRsZWRFcnJvcihlcnJvcik7CiAgICAgIH0KICAgIH0KICB9OwogIENvbnN1bWVyT2JzZXJ2ZXIyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGVycikgewogICAgdmFyIHBhcnRpYWxPYnNlcnZlciA9IHRoaXMucGFydGlhbE9ic2VydmVyOwogICAgaWYgKHBhcnRpYWxPYnNlcnZlci5lcnJvcikgewogICAgICB0cnkgewogICAgICAgIHBhcnRpYWxPYnNlcnZlci5lcnJvcihlcnIpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGhhbmRsZVVuaGFuZGxlZEVycm9yKGVycm9yKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaGFuZGxlVW5oYW5kbGVkRXJyb3IoZXJyKTsKICAgIH0KICB9OwogIENvbnN1bWVyT2JzZXJ2ZXIyLnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIHBhcnRpYWxPYnNlcnZlciA9IHRoaXMucGFydGlhbE9ic2VydmVyOwogICAgaWYgKHBhcnRpYWxPYnNlcnZlci5jb21wbGV0ZSkgewogICAgICB0cnkgewogICAgICAgIHBhcnRpYWxPYnNlcnZlci5jb21wbGV0ZSgpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGhhbmRsZVVuaGFuZGxlZEVycm9yKGVycm9yKTsKICAgICAgfQogICAgfQogIH07CiAgcmV0dXJuIENvbnN1bWVyT2JzZXJ2ZXIyOwp9KSgpOwp2YXIgU2FmZVN1YnNjcmliZXIgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKFNhZmVTdWJzY3JpYmVyMiwgX3N1cGVyKTsKICBmdW5jdGlvbiBTYWZlU3Vic2NyaWJlcjIob2JzZXJ2ZXJPck5leHQsIGVycm9yLCBjb21wbGV0ZSkgewogICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpczsKICAgIHZhciBwYXJ0aWFsT2JzZXJ2ZXI7CiAgICBpZiAoaXNGdW5jdGlvbihvYnNlcnZlck9yTmV4dCkgfHwgIW9ic2VydmVyT3JOZXh0KSB7CiAgICAgIHBhcnRpYWxPYnNlcnZlciA9IHsKICAgICAgICBuZXh0OiBvYnNlcnZlck9yTmV4dCAhPT0gbnVsbCAmJiBvYnNlcnZlck9yTmV4dCAhPT0gdm9pZCAwID8gb2JzZXJ2ZXJPck5leHQgOiB2b2lkIDAsCiAgICAgICAgZXJyb3I6IGVycm9yICE9PSBudWxsICYmIGVycm9yICE9PSB2b2lkIDAgPyBlcnJvciA6IHZvaWQgMCwKICAgICAgICBjb21wbGV0ZTogY29tcGxldGUgIT09IG51bGwgJiYgY29tcGxldGUgIT09IHZvaWQgMCA/IGNvbXBsZXRlIDogdm9pZCAwCiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICB2YXIgY29udGV4dF8xOwogICAgICBpZiAoX3RoaXMgJiYgY29uZmlnLnVzZURlcHJlY2F0ZWROZXh0Q29udGV4dCkgewogICAgICAgIGNvbnRleHRfMSA9IE9iamVjdC5jcmVhdGUob2JzZXJ2ZXJPck5leHQpOwogICAgICAgIGNvbnRleHRfMS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgfTsKICAgICAgICBwYXJ0aWFsT2JzZXJ2ZXIgPSB7CiAgICAgICAgICBuZXh0OiBvYnNlcnZlck9yTmV4dC5uZXh0ICYmIGJpbmQob2JzZXJ2ZXJPck5leHQubmV4dCwgY29udGV4dF8xKSwKICAgICAgICAgIGVycm9yOiBvYnNlcnZlck9yTmV4dC5lcnJvciAmJiBiaW5kKG9ic2VydmVyT3JOZXh0LmVycm9yLCBjb250ZXh0XzEpLAogICAgICAgICAgY29tcGxldGU6IG9ic2VydmVyT3JOZXh0LmNvbXBsZXRlICYmIGJpbmQob2JzZXJ2ZXJPck5leHQuY29tcGxldGUsIGNvbnRleHRfMSkKICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIHBhcnRpYWxPYnNlcnZlciA9IG9ic2VydmVyT3JOZXh0OwogICAgICB9CiAgICB9CiAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IG5ldyBDb25zdW1lck9ic2VydmVyKHBhcnRpYWxPYnNlcnZlcik7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIHJldHVybiBTYWZlU3Vic2NyaWJlcjI7Cn0pKFN1YnNjcmliZXIpOwpmdW5jdGlvbiBoYW5kbGVVbmhhbmRsZWRFcnJvcihlcnJvcikgewogIGlmIChjb25maWcudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZykgewogICAgY2FwdHVyZUVycm9yKGVycm9yKTsKICB9IGVsc2UgewogICAgcmVwb3J0VW5oYW5kbGVkRXJyb3IoZXJyb3IpOwogIH0KfQpmdW5jdGlvbiBkZWZhdWx0RXJyb3JIYW5kbGVyKGVycikgewogIHRocm93IGVycjsKfQpmdW5jdGlvbiBoYW5kbGVTdG9wcGVkTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgc3Vic2NyaWJlcikgewogIHZhciBvblN0b3BwZWROb3RpZmljYXRpb24gPSBjb25maWcub25TdG9wcGVkTm90aWZpY2F0aW9uOwogIG9uU3RvcHBlZE5vdGlmaWNhdGlvbiAmJiB0aW1lb3V0UHJvdmlkZXIuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgIHJldHVybiBvblN0b3BwZWROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBzdWJzY3JpYmVyKTsKICB9KTsKfQp2YXIgRU1QVFlfT0JTRVJWRVIgPSB7CiAgY2xvc2VkOiB0cnVlLAogIG5leHQ6IG5vb3AsCiAgZXJyb3I6IGRlZmF1bHRFcnJvckhhbmRsZXIsCiAgY29tcGxldGU6IG5vb3AKfTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zeW1ib2wvb2JzZXJ2YWJsZS5qcwp2YXIgb2JzZXJ2YWJsZSA9IChmdW5jdGlvbigpIHsKICByZXR1cm4gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wub2JzZXJ2YWJsZSB8fCAiQEBvYnNlcnZhYmxlIjsKfSkoKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2lkZW50aXR5LmpzCmZ1bmN0aW9uIGlkZW50aXR5KHgpIHsKICByZXR1cm4geDsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvcGlwZS5qcwpmdW5jdGlvbiBwaXBlKCkgewogIHZhciBmbnMgPSBbXTsKICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgZm5zW19pXSA9IGFyZ3VtZW50c1tfaV07CiAgfQogIHJldHVybiBwaXBlRnJvbUFycmF5KGZucyk7Cn0KZnVuY3Rpb24gcGlwZUZyb21BcnJheShmbnMpIHsKICBpZiAoZm5zLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIGlkZW50aXR5OwogIH0KICBpZiAoZm5zLmxlbmd0aCA9PT0gMSkgewogICAgcmV0dXJuIGZuc1swXTsKICB9CiAgcmV0dXJuIGZ1bmN0aW9uIHBpcGVkKGlucHV0MikgewogICAgcmV0dXJuIGZucy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgZm4pIHsKICAgICAgcmV0dXJuIGZuKHByZXYpOwogICAgfSwgaW5wdXQyKTsKICB9Owp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvT2JzZXJ2YWJsZS5qcwp2YXIgT2JzZXJ2YWJsZSA9IChmdW5jdGlvbigpIHsKICBmdW5jdGlvbiBPYnNlcnZhYmxlMihzdWJzY3JpYmUpIHsKICAgIGlmIChzdWJzY3JpYmUpIHsKICAgICAgdGhpcy5fc3Vic2NyaWJlID0gc3Vic2NyaWJlOwogICAgfQogIH0KICBPYnNlcnZhYmxlMi5wcm90b3R5cGUubGlmdCA9IGZ1bmN0aW9uKG9wZXJhdG9yKSB7CiAgICB2YXIgb2JzZXJ2YWJsZTIgPSBuZXcgT2JzZXJ2YWJsZTIoKTsKICAgIG9ic2VydmFibGUyLnNvdXJjZSA9IHRoaXM7CiAgICBvYnNlcnZhYmxlMi5vcGVyYXRvciA9IG9wZXJhdG9yOwogICAgcmV0dXJuIG9ic2VydmFibGUyOwogIH07CiAgT2JzZXJ2YWJsZTIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uKG9ic2VydmVyT3JOZXh0LCBlcnJvciwgY29tcGxldGUpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICB2YXIgc3Vic2NyaWJlciA9IGlzU3Vic2NyaWJlcihvYnNlcnZlck9yTmV4dCkgPyBvYnNlcnZlck9yTmV4dCA6IG5ldyBTYWZlU3Vic2NyaWJlcihvYnNlcnZlck9yTmV4dCwgZXJyb3IsIGNvbXBsZXRlKTsKICAgIGVycm9yQ29udGV4dChmdW5jdGlvbigpIHsKICAgICAgdmFyIF9hID0gX3RoaXMsIG9wZXJhdG9yID0gX2Eub3BlcmF0b3IsIHNvdXJjZSA9IF9hLnNvdXJjZTsKICAgICAgc3Vic2NyaWJlci5hZGQob3BlcmF0b3IgPyBvcGVyYXRvci5jYWxsKHN1YnNjcmliZXIsIHNvdXJjZSkgOiBzb3VyY2UgPyBfdGhpcy5fc3Vic2NyaWJlKHN1YnNjcmliZXIpIDogX3RoaXMuX3RyeVN1YnNjcmliZShzdWJzY3JpYmVyKSk7CiAgICB9KTsKICAgIHJldHVybiBzdWJzY3JpYmVyOwogIH07CiAgT2JzZXJ2YWJsZTIucHJvdG90eXBlLl90cnlTdWJzY3JpYmUgPSBmdW5jdGlvbihzaW5rKSB7CiAgICB0cnkgewogICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKHNpbmspOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHNpbmsuZXJyb3IoZXJyKTsKICAgIH0KICB9OwogIE9ic2VydmFibGUyLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24obmV4dCwgcHJvbWlzZUN0b3IpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICBwcm9taXNlQ3RvciA9IGdldFByb21pc2VDdG9yKHByb21pc2VDdG9yKTsKICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBzdWJzY3JpYmVyID0gbmV3IFNhZmVTdWJzY3JpYmVyKHsKICAgICAgICBuZXh0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbmV4dCh2YWx1ZSk7CiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgIHN1YnNjcmliZXIudW5zdWJzY3JpYmUoKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGVycm9yOiByZWplY3QsCiAgICAgICAgY29tcGxldGU6IHJlc29sdmUKICAgICAgfSk7CiAgICAgIF90aGlzLnN1YnNjcmliZShzdWJzY3JpYmVyKTsKICAgIH0pOwogIH07CiAgT2JzZXJ2YWJsZTIucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICB2YXIgX2E7CiAgICByZXR1cm4gKF9hID0gdGhpcy5zb3VyY2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgfTsKICBPYnNlcnZhYmxlMi5wcm90b3R5cGVbb2JzZXJ2YWJsZV0gPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzOwogIH07CiAgT2JzZXJ2YWJsZTIucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbigpIHsKICAgIHZhciBvcGVyYXRpb25zID0gW107CiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgICBvcGVyYXRpb25zW19pXSA9IGFyZ3VtZW50c1tfaV07CiAgICB9CiAgICByZXR1cm4gcGlwZUZyb21BcnJheShvcGVyYXRpb25zKSh0aGlzKTsKICB9OwogIE9ic2VydmFibGUyLnByb3RvdHlwZS50b1Byb21pc2UgPSBmdW5jdGlvbihwcm9taXNlQ3RvcikgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHByb21pc2VDdG9yID0gZ2V0UHJvbWlzZUN0b3IocHJvbWlzZUN0b3IpOwogICAgcmV0dXJuIG5ldyBwcm9taXNlQ3RvcihmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24oeCkgewogICAgICAgIHJldHVybiB2YWx1ZSA9IHg7CiAgICAgIH0sIGZ1bmN0aW9uKGVycikgewogICAgICAgIHJldHVybiByZWplY3QoZXJyKTsKICAgICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHJlc29sdmUodmFsdWUpOwogICAgICB9KTsKICAgIH0pOwogIH07CiAgT2JzZXJ2YWJsZTIuY3JlYXRlID0gZnVuY3Rpb24oc3Vic2NyaWJlKSB7CiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUyKHN1YnNjcmliZSk7CiAgfTsKICByZXR1cm4gT2JzZXJ2YWJsZTI7Cn0pKCk7CmZ1bmN0aW9uIGdldFByb21pc2VDdG9yKHByb21pc2VDdG9yKSB7CiAgdmFyIF9hOwogIHJldHVybiAoX2EgPSBwcm9taXNlQ3RvciAhPT0gbnVsbCAmJiBwcm9taXNlQ3RvciAhPT0gdm9pZCAwID8gcHJvbWlzZUN0b3IgOiBjb25maWcuUHJvbWlzZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogUHJvbWlzZTsKfQpmdW5jdGlvbiBpc09ic2VydmVyKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlICYmIGlzRnVuY3Rpb24odmFsdWUubmV4dCkgJiYgaXNGdW5jdGlvbih2YWx1ZS5lcnJvcikgJiYgaXNGdW5jdGlvbih2YWx1ZS5jb21wbGV0ZSk7Cn0KZnVuY3Rpb24gaXNTdWJzY3JpYmVyKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlICYmIHZhbHVlIGluc3RhbmNlb2YgU3Vic2NyaWJlciB8fCBpc09ic2VydmVyKHZhbHVlKSAmJiBpc1N1YnNjcmlwdGlvbih2YWx1ZSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2xpZnQuanMKZnVuY3Rpb24gaGFzTGlmdChzb3VyY2UpIHsKICByZXR1cm4gaXNGdW5jdGlvbihzb3VyY2UgPT09IG51bGwgfHwgc291cmNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzb3VyY2UubGlmdCk7Cn0KZnVuY3Rpb24gb3BlcmF0ZShpbml0KSB7CiAgcmV0dXJuIGZ1bmN0aW9uKHNvdXJjZSkgewogICAgaWYgKGhhc0xpZnQoc291cmNlKSkgewogICAgICByZXR1cm4gc291cmNlLmxpZnQoZnVuY3Rpb24obGlmdGVkU291cmNlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBpbml0KGxpZnRlZFNvdXJjZSwgdGhpcyk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICB0aGlzLmVycm9yKGVycik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlVuYWJsZSB0byBsaWZ0IHVua25vd24gT2JzZXJ2YWJsZSB0eXBlIik7CiAgfTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9PcGVyYXRvclN1YnNjcmliZXIuanMKZnVuY3Rpb24gY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBvbk5leHQsIG9uQ29tcGxldGUsIG9uRXJyb3IsIG9uRmluYWxpemUpIHsKICByZXR1cm4gbmV3IE9wZXJhdG9yU3Vic2NyaWJlcihkZXN0aW5hdGlvbiwgb25OZXh0LCBvbkNvbXBsZXRlLCBvbkVycm9yLCBvbkZpbmFsaXplKTsKfQp2YXIgT3BlcmF0b3JTdWJzY3JpYmVyID0gKGZ1bmN0aW9uKF9zdXBlcikgewogIF9fZXh0ZW5kcyhPcGVyYXRvclN1YnNjcmliZXIyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIE9wZXJhdG9yU3Vic2NyaWJlcjIoZGVzdGluYXRpb24sIG9uTmV4dCwgb25Db21wbGV0ZSwgb25FcnJvciwgb25GaW5hbGl6ZSwgc2hvdWxkVW5zdWJzY3JpYmUpIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKSB8fCB0aGlzOwogICAgX3RoaXMub25GaW5hbGl6ZSA9IG9uRmluYWxpemU7CiAgICBfdGhpcy5zaG91bGRVbnN1YnNjcmliZSA9IHNob3VsZFVuc3Vic2NyaWJlOwogICAgX3RoaXMuX25leHQgPSBvbk5leHQgPyBmdW5jdGlvbih2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIG9uTmV4dCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGRlc3RpbmF0aW9uLmVycm9yKGVycik7CiAgICAgIH0KICAgIH0gOiBfc3VwZXIucHJvdG90eXBlLl9uZXh0OwogICAgX3RoaXMuX2Vycm9yID0gb25FcnJvciA/IGZ1bmN0aW9uKGVycikgewogICAgICB0cnkgewogICAgICAgIG9uRXJyb3IoZXJyKTsKICAgICAgfSBjYXRjaCAoZXJyMikgewogICAgICAgIGRlc3RpbmF0aW9uLmVycm9yKGVycjIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgICAgfQogICAgfSA6IF9zdXBlci5wcm90b3R5cGUuX2Vycm9yOwogICAgX3RoaXMuX2NvbXBsZXRlID0gb25Db21wbGV0ZSA/IGZ1bmN0aW9uKCkgewogICAgICB0cnkgewogICAgICAgIG9uQ29tcGxldGUoKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgZGVzdGluYXRpb24uZXJyb3IoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgIH0KICAgIH0gOiBfc3VwZXIucHJvdG90eXBlLl9jb21wbGV0ZTsKICAgIHJldHVybiBfdGhpczsKICB9CiAgT3BlcmF0b3JTdWJzY3JpYmVyMi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbigpIHsKICAgIHZhciBfYTsKICAgIGlmICghdGhpcy5zaG91bGRVbnN1YnNjcmliZSB8fCB0aGlzLnNob3VsZFVuc3Vic2NyaWJlKCkpIHsKICAgICAgdmFyIGNsb3NlZF8xID0gdGhpcy5jbG9zZWQ7CiAgICAgIF9zdXBlci5wcm90b3R5cGUudW5zdWJzY3JpYmUuY2FsbCh0aGlzKTsKICAgICAgIWNsb3NlZF8xICYmICgoX2EgPSB0aGlzLm9uRmluYWxpemUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxsKHRoaXMpKTsKICAgIH0KICB9OwogIHJldHVybiBPcGVyYXRvclN1YnNjcmliZXIyOwp9KShTdWJzY3JpYmVyKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvcmVmQ291bnQuanMKZnVuY3Rpb24gcmVmQ291bnQoKSB7CiAgcmV0dXJuIG9wZXJhdGUoZnVuY3Rpb24oc291cmNlLCBzdWJzY3JpYmVyKSB7CiAgICB2YXIgY29ubmVjdGlvbiA9IG51bGw7CiAgICBzb3VyY2UuX3JlZkNvdW50Kys7CiAgICB2YXIgcmVmQ291bnRlciA9IGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJzY3JpYmVyLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbigpIHsKICAgICAgaWYgKCFzb3VyY2UgfHwgc291cmNlLl9yZWZDb3VudCA8PSAwIHx8IDAgPCAtLXNvdXJjZS5fcmVmQ291bnQpIHsKICAgICAgICBjb25uZWN0aW9uID0gbnVsbDsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHNoYXJlZENvbm5lY3Rpb24gPSBzb3VyY2UuX2Nvbm5lY3Rpb247CiAgICAgIHZhciBjb25uID0gY29ubmVjdGlvbjsKICAgICAgY29ubmVjdGlvbiA9IG51bGw7CiAgICAgIGlmIChzaGFyZWRDb25uZWN0aW9uICYmICghY29ubiB8fCBzaGFyZWRDb25uZWN0aW9uID09PSBjb25uKSkgewogICAgICAgIHNoYXJlZENvbm5lY3Rpb24udW5zdWJzY3JpYmUoKTsKICAgICAgfQogICAgICBzdWJzY3JpYmVyLnVuc3Vic2NyaWJlKCk7CiAgICB9KTsKICAgIHNvdXJjZS5zdWJzY3JpYmUocmVmQ291bnRlcik7CiAgICBpZiAoIXJlZkNvdW50ZXIuY2xvc2VkKSB7CiAgICAgIGNvbm5lY3Rpb24gPSBzb3VyY2UuY29ubmVjdCgpOwogICAgfQogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9Db25uZWN0YWJsZU9ic2VydmFibGUuanMKdmFyIENvbm5lY3RhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoQ29ubmVjdGFibGVPYnNlcnZhYmxlMiwgX3N1cGVyKTsKICBmdW5jdGlvbiBDb25uZWN0YWJsZU9ic2VydmFibGUyKHNvdXJjZSwgc3ViamVjdEZhY3RvcnkpIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICBfdGhpcy5zb3VyY2UgPSBzb3VyY2U7CiAgICBfdGhpcy5zdWJqZWN0RmFjdG9yeSA9IHN1YmplY3RGYWN0b3J5OwogICAgX3RoaXMuX3N1YmplY3QgPSBudWxsOwogICAgX3RoaXMuX3JlZkNvdW50ID0gMDsKICAgIF90aGlzLl9jb25uZWN0aW9uID0gbnVsbDsKICAgIGlmIChoYXNMaWZ0KHNvdXJjZSkpIHsKICAgICAgX3RoaXMubGlmdCA9IHNvdXJjZS5saWZ0OwogICAgfQogICAgcmV0dXJuIF90aGlzOwogIH0KICBDb25uZWN0YWJsZU9ic2VydmFibGUyLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgcmV0dXJuIHRoaXMuZ2V0U3ViamVjdCgpLnN1YnNjcmliZShzdWJzY3JpYmVyKTsKICB9OwogIENvbm5lY3RhYmxlT2JzZXJ2YWJsZTIucHJvdG90eXBlLmdldFN1YmplY3QgPSBmdW5jdGlvbigpIHsKICAgIHZhciBzdWJqZWN0ID0gdGhpcy5fc3ViamVjdDsKICAgIGlmICghc3ViamVjdCB8fCBzdWJqZWN0LmlzU3RvcHBlZCkgewogICAgICB0aGlzLl9zdWJqZWN0ID0gdGhpcy5zdWJqZWN0RmFjdG9yeSgpOwogICAgfQogICAgcmV0dXJuIHRoaXMuX3N1YmplY3Q7CiAgfTsKICBDb25uZWN0YWJsZU9ic2VydmFibGUyLnByb3RvdHlwZS5fdGVhcmRvd24gPSBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3JlZkNvdW50ID0gMDsKICAgIHZhciBfY29ubmVjdGlvbiA9IHRoaXMuX2Nvbm5lY3Rpb247CiAgICB0aGlzLl9zdWJqZWN0ID0gdGhpcy5fY29ubmVjdGlvbiA9IG51bGw7CiAgICBfY29ubmVjdGlvbiA9PT0gbnVsbCB8fCBfY29ubmVjdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Nvbm5lY3Rpb24udW5zdWJzY3JpYmUoKTsKICB9OwogIENvbm5lY3RhYmxlT2JzZXJ2YWJsZTIucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbigpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMuX2Nvbm5lY3Rpb247CiAgICBpZiAoIWNvbm5lY3Rpb24pIHsKICAgICAgY29ubmVjdGlvbiA9IHRoaXMuX2Nvbm5lY3Rpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7CiAgICAgIHZhciBzdWJqZWN0XzEgPSB0aGlzLmdldFN1YmplY3QoKTsKICAgICAgY29ubmVjdGlvbi5hZGQodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJqZWN0XzEsIHZvaWQgMCwgZnVuY3Rpb24oKSB7CiAgICAgICAgX3RoaXMuX3RlYXJkb3duKCk7CiAgICAgICAgc3ViamVjdF8xLmNvbXBsZXRlKCk7CiAgICAgIH0sIGZ1bmN0aW9uKGVycikgewogICAgICAgIF90aGlzLl90ZWFyZG93bigpOwogICAgICAgIHN1YmplY3RfMS5lcnJvcihlcnIpOwogICAgICB9LCBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMuX3RlYXJkb3duKCk7CiAgICAgIH0pKSk7CiAgICAgIGlmIChjb25uZWN0aW9uLmNsb3NlZCkgewogICAgICAgIHRoaXMuX2Nvbm5lY3Rpb24gPSBudWxsOwogICAgICAgIGNvbm5lY3Rpb24gPSBTdWJzY3JpcHRpb24uRU1QVFk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBjb25uZWN0aW9uOwogIH07CiAgQ29ubmVjdGFibGVPYnNlcnZhYmxlMi5wcm90b3R5cGUucmVmQ291bnQgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiByZWZDb3VudCgpKHRoaXMpOwogIH07CiAgcmV0dXJuIENvbm5lY3RhYmxlT2JzZXJ2YWJsZTI7Cn0pKE9ic2VydmFibGUpOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3NjaGVkdWxlci9wZXJmb3JtYW5jZVRpbWVzdGFtcFByb3ZpZGVyLmpzCnZhciBwZXJmb3JtYW5jZVRpbWVzdGFtcFByb3ZpZGVyID0gewogIG5vdzogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gKHBlcmZvcm1hbmNlVGltZXN0YW1wUHJvdmlkZXIuZGVsZWdhdGUgfHwgcGVyZm9ybWFuY2UpLm5vdygpOwogIH0sCiAgZGVsZWdhdGU6IHZvaWQgMAp9OwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3NjaGVkdWxlci9hbmltYXRpb25GcmFtZVByb3ZpZGVyLmpzCnZhciBhbmltYXRpb25GcmFtZVByb3ZpZGVyID0gewogIHNjaGVkdWxlOiBmdW5jdGlvbihjYWxsYmFjaykgewogICAgdmFyIHJlcXVlc3QgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWU7CiAgICB2YXIgY2FuY2VsID0gY2FuY2VsQW5pbWF0aW9uRnJhbWU7CiAgICB2YXIgZGVsZWdhdGUgPSBhbmltYXRpb25GcmFtZVByb3ZpZGVyLmRlbGVnYXRlOwogICAgaWYgKGRlbGVnYXRlKSB7CiAgICAgIHJlcXVlc3QgPSBkZWxlZ2F0ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7CiAgICAgIGNhbmNlbCA9IGRlbGVnYXRlLmNhbmNlbEFuaW1hdGlvbkZyYW1lOwogICAgfQogICAgdmFyIGhhbmRsZSA9IHJlcXVlc3QoZnVuY3Rpb24odGltZXN0YW1wMikgewogICAgICBjYW5jZWwgPSB2b2lkIDA7CiAgICAgIGNhbGxiYWNrKHRpbWVzdGFtcDIpOwogICAgfSk7CiAgICByZXR1cm4gbmV3IFN1YnNjcmlwdGlvbihmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGNhbmNlbCA9PT0gbnVsbCB8fCBjYW5jZWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNhbmNlbChoYW5kbGUpOwogICAgfSk7CiAgfSwKICByZXF1ZXN0QW5pbWF0aW9uRnJhbWU6IGZ1bmN0aW9uKCkgewogICAgdmFyIGFyZ3MgPSBbXTsKICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CiAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTsKICAgIH0KICAgIHZhciBkZWxlZ2F0ZSA9IGFuaW1hdGlvbkZyYW1lUHJvdmlkZXIuZGVsZWdhdGU7CiAgICByZXR1cm4gKChkZWxlZ2F0ZSA9PT0gbnVsbCB8fCBkZWxlZ2F0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVsZWdhdGUucmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB8fCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUpLmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGFyZ3MpKSk7CiAgfSwKICBjYW5jZWxBbmltYXRpb25GcmFtZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJncyA9IFtdOwogICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldOwogICAgfQogICAgdmFyIGRlbGVnYXRlID0gYW5pbWF0aW9uRnJhbWVQcm92aWRlci5kZWxlZ2F0ZTsKICAgIHJldHVybiAoKGRlbGVnYXRlID09PSBudWxsIHx8IGRlbGVnYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZWxlZ2F0ZS5jYW5jZWxBbmltYXRpb25GcmFtZSkgfHwgY2FuY2VsQW5pbWF0aW9uRnJhbWUpLmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGFyZ3MpKSk7CiAgfSwKICBkZWxlZ2F0ZTogdm9pZCAwCn07CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9kb20vYW5pbWF0aW9uRnJhbWVzLmpzCmZ1bmN0aW9uIGFuaW1hdGlvbkZyYW1lc0ZhY3RvcnkodGltZXN0YW1wUHJvdmlkZXIpIHsKICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgdmFyIHByb3ZpZGVyID0gdGltZXN0YW1wUHJvdmlkZXIgfHwgcGVyZm9ybWFuY2VUaW1lc3RhbXBQcm92aWRlcjsKICAgIHZhciBzdGFydCA9IHByb3ZpZGVyLm5vdygpOwogICAgdmFyIGlkID0gMDsKICAgIHZhciBydW4gPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKCFzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgIGlkID0gYW5pbWF0aW9uRnJhbWVQcm92aWRlci5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24odGltZXN0YW1wMikgewogICAgICAgICAgaWQgPSAwOwogICAgICAgICAgdmFyIG5vdyA9IHByb3ZpZGVyLm5vdygpOwogICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHsKICAgICAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXBQcm92aWRlciA/IG5vdyA6IHRpbWVzdGFtcDIsCiAgICAgICAgICAgIGVsYXBzZWQ6IG5vdyAtIHN0YXJ0CiAgICAgICAgICB9KTsKICAgICAgICAgIHJ1bigpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwogICAgcnVuKCk7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIGlmIChpZCkgewogICAgICAgIGFuaW1hdGlvbkZyYW1lUHJvdmlkZXIuY2FuY2VsQW5pbWF0aW9uRnJhbWUoaWQpOwogICAgICB9CiAgICB9OwogIH0pOwp9CnZhciBERUZBVUxUX0FOSU1BVElPTl9GUkFNRVMgPSBhbmltYXRpb25GcmFtZXNGYWN0b3J5KCk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9PYmplY3RVbnN1YnNjcmliZWRFcnJvci5qcwp2YXIgT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IgPSBjcmVhdGVFcnJvckNsYXNzKGZ1bmN0aW9uKF9zdXBlcikgewogIHJldHVybiBmdW5jdGlvbiBPYmplY3RVbnN1YnNjcmliZWRFcnJvckltcGwoKSB7CiAgICBfc3VwZXIodGhpcyk7CiAgICB0aGlzLm5hbWUgPSAiT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IiOwogICAgdGhpcy5tZXNzYWdlID0gIm9iamVjdCB1bnN1YnNjcmliZWQiOwogIH07Cn0pOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL1N1YmplY3QuanMKdmFyIFN1YmplY3QgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKFN1YmplY3QyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIFN1YmplY3QyKCkgewogICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpczsKICAgIF90aGlzLmNsb3NlZCA9IGZhbHNlOwogICAgX3RoaXMuY3VycmVudE9ic2VydmVycyA9IG51bGw7CiAgICBfdGhpcy5vYnNlcnZlcnMgPSBbXTsKICAgIF90aGlzLmlzU3RvcHBlZCA9IGZhbHNlOwogICAgX3RoaXMuaGFzRXJyb3IgPSBmYWxzZTsKICAgIF90aGlzLnRocm93bkVycm9yID0gbnVsbDsKICAgIHJldHVybiBfdGhpczsKICB9CiAgU3ViamVjdDIucHJvdG90eXBlLmxpZnQgPSBmdW5jdGlvbihvcGVyYXRvcikgewogICAgdmFyIHN1YmplY3QgPSBuZXcgQW5vbnltb3VzU3ViamVjdCh0aGlzLCB0aGlzKTsKICAgIHN1YmplY3Qub3BlcmF0b3IgPSBvcGVyYXRvcjsKICAgIHJldHVybiBzdWJqZWN0OwogIH07CiAgU3ViamVjdDIucHJvdG90eXBlLl90aHJvd0lmQ2xvc2VkID0gZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5jbG9zZWQpIHsKICAgICAgdGhyb3cgbmV3IE9iamVjdFVuc3Vic2NyaWJlZEVycm9yKCk7CiAgICB9CiAgfTsKICBTdWJqZWN0Mi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgZXJyb3JDb250ZXh0KGZ1bmN0aW9uKCkgewogICAgICB2YXIgZV8xLCBfYTsKICAgICAgX3RoaXMuX3Rocm93SWZDbG9zZWQoKTsKICAgICAgaWYgKCFfdGhpcy5pc1N0b3BwZWQpIHsKICAgICAgICBpZiAoIV90aGlzLmN1cnJlbnRPYnNlcnZlcnMpIHsKICAgICAgICAgIF90aGlzLmN1cnJlbnRPYnNlcnZlcnMgPSBBcnJheS5mcm9tKF90aGlzLm9ic2VydmVycyk7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzKF90aGlzLmN1cnJlbnRPYnNlcnZlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CiAgICAgICAgICAgIHZhciBvYnNlcnZlciA9IF9jLnZhbHVlOwogICAgICAgICAgICBvYnNlcnZlci5uZXh0KHZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlXzFfMSkgewogICAgICAgICAgZV8xID0geyBlcnJvcjogZV8xXzEgfTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfTsKICBTdWJqZWN0Mi5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlcnIpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICBlcnJvckNvbnRleHQoZnVuY3Rpb24oKSB7CiAgICAgIF90aGlzLl90aHJvd0lmQ2xvc2VkKCk7CiAgICAgIGlmICghX3RoaXMuaXNTdG9wcGVkKSB7CiAgICAgICAgX3RoaXMuaGFzRXJyb3IgPSBfdGhpcy5pc1N0b3BwZWQgPSB0cnVlOwogICAgICAgIF90aGlzLnRocm93bkVycm9yID0gZXJyOwogICAgICAgIHZhciBvYnNlcnZlcnMgPSBfdGhpcy5vYnNlcnZlcnM7CiAgICAgICAgd2hpbGUgKG9ic2VydmVycy5sZW5ndGgpIHsKICAgICAgICAgIG9ic2VydmVycy5zaGlmdCgpLmVycm9yKGVycik7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9OwogIFN1YmplY3QyLnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIGVycm9yQ29udGV4dChmdW5jdGlvbigpIHsKICAgICAgX3RoaXMuX3Rocm93SWZDbG9zZWQoKTsKICAgICAgaWYgKCFfdGhpcy5pc1N0b3BwZWQpIHsKICAgICAgICBfdGhpcy5pc1N0b3BwZWQgPSB0cnVlOwogICAgICAgIHZhciBvYnNlcnZlcnMgPSBfdGhpcy5vYnNlcnZlcnM7CiAgICAgICAgd2hpbGUgKG9ic2VydmVycy5sZW5ndGgpIHsKICAgICAgICAgIG9ic2VydmVycy5zaGlmdCgpLmNvbXBsZXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9OwogIFN1YmplY3QyLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5pc1N0b3BwZWQgPSB0aGlzLmNsb3NlZCA9IHRydWU7CiAgICB0aGlzLm9ic2VydmVycyA9IHRoaXMuY3VycmVudE9ic2VydmVycyA9IG51bGw7CiAgfTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3ViamVjdDIucHJvdG90eXBlLCAib2JzZXJ2ZWQiLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgX2E7CiAgICAgIHJldHVybiAoKF9hID0gdGhpcy5vYnNlcnZlcnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sZW5ndGgpID4gMDsKICAgIH0sCiAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIFN1YmplY3QyLnByb3RvdHlwZS5fdHJ5U3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgdGhpcy5fdGhyb3dJZkNsb3NlZCgpOwogICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuX3RyeVN1YnNjcmliZS5jYWxsKHRoaXMsIHN1YnNjcmliZXIpOwogIH07CiAgU3ViamVjdDIucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICB0aGlzLl90aHJvd0lmQ2xvc2VkKCk7CiAgICB0aGlzLl9jaGVja0ZpbmFsaXplZFN0YXR1c2VzKHN1YnNjcmliZXIpOwogICAgcmV0dXJuIHRoaXMuX2lubmVyU3Vic2NyaWJlKHN1YnNjcmliZXIpOwogIH07CiAgU3ViamVjdDIucHJvdG90eXBlLl9pbm5lclN1YnNjcmliZSA9IGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICB2YXIgX2EgPSB0aGlzLCBoYXNFcnJvciA9IF9hLmhhc0Vycm9yLCBpc1N0b3BwZWQgPSBfYS5pc1N0b3BwZWQsIG9ic2VydmVycyA9IF9hLm9ic2VydmVyczsKICAgIGlmIChoYXNFcnJvciB8fCBpc1N0b3BwZWQpIHsKICAgICAgcmV0dXJuIEVNUFRZX1NVQlNDUklQVElPTjsKICAgIH0KICAgIHRoaXMuY3VycmVudE9ic2VydmVycyA9IG51bGw7CiAgICBvYnNlcnZlcnMucHVzaChzdWJzY3JpYmVyKTsKICAgIHJldHVybiBuZXcgU3Vic2NyaXB0aW9uKGZ1bmN0aW9uKCkgewogICAgICBfdGhpcy5jdXJyZW50T2JzZXJ2ZXJzID0gbnVsbDsKICAgICAgYXJyUmVtb3ZlKG9ic2VydmVycywgc3Vic2NyaWJlcik7CiAgICB9KTsKICB9OwogIFN1YmplY3QyLnByb3RvdHlwZS5fY2hlY2tGaW5hbGl6ZWRTdGF0dXNlcyA9IGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIHZhciBfYSA9IHRoaXMsIGhhc0Vycm9yID0gX2EuaGFzRXJyb3IsIHRocm93bkVycm9yID0gX2EudGhyb3duRXJyb3IsIGlzU3RvcHBlZCA9IF9hLmlzU3RvcHBlZDsKICAgIGlmIChoYXNFcnJvcikgewogICAgICBzdWJzY3JpYmVyLmVycm9yKHRocm93bkVycm9yKTsKICAgIH0gZWxzZSBpZiAoaXNTdG9wcGVkKSB7CiAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgIH0KICB9OwogIFN1YmplY3QyLnByb3RvdHlwZS5hc09ic2VydmFibGUgPSBmdW5jdGlvbigpIHsKICAgIHZhciBvYnNlcnZhYmxlMiA9IG5ldyBPYnNlcnZhYmxlKCk7CiAgICBvYnNlcnZhYmxlMi5zb3VyY2UgPSB0aGlzOwogICAgcmV0dXJuIG9ic2VydmFibGUyOwogIH07CiAgU3ViamVjdDIuY3JlYXRlID0gZnVuY3Rpb24oZGVzdGluYXRpb24sIHNvdXJjZSkgewogICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNTdWJqZWN0KGRlc3RpbmF0aW9uLCBzb3VyY2UpOwogIH07CiAgcmV0dXJuIFN1YmplY3QyOwp9KShPYnNlcnZhYmxlKTsKdmFyIEFub255bW91c1N1YmplY3QgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKEFub255bW91c1N1YmplY3QyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIEFub255bW91c1N1YmplY3QyKGRlc3RpbmF0aW9uLCBzb3VyY2UpIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uOwogICAgX3RoaXMuc291cmNlID0gc291cmNlOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBBbm9ueW1vdXNTdWJqZWN0Mi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICB2YXIgX2EsIF9iOwogICAgKF9iID0gKF9hID0gdGhpcy5kZXN0aW5hdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm5leHQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCB2YWx1ZSk7CiAgfTsKICBBbm9ueW1vdXNTdWJqZWN0Mi5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlcnIpIHsKICAgIHZhciBfYSwgX2I7CiAgICAoX2IgPSAoX2EgPSB0aGlzLmRlc3RpbmF0aW9uKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZXJyb3IpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBlcnIpOwogIH07CiAgQW5vbnltb3VzU3ViamVjdDIucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgX2EsIF9iOwogICAgKF9iID0gKF9hID0gdGhpcy5kZXN0aW5hdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNvbXBsZXRlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSk7CiAgfTsKICBBbm9ueW1vdXNTdWJqZWN0Mi5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIHZhciBfYSwgX2I7CiAgICByZXR1cm4gKF9iID0gKF9hID0gdGhpcy5zb3VyY2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdWJzY3JpYmUoc3Vic2NyaWJlcikpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IEVNUFRZX1NVQlNDUklQVElPTjsKICB9OwogIHJldHVybiBBbm9ueW1vdXNTdWJqZWN0MjsKfSkoU3ViamVjdCk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvQmVoYXZpb3JTdWJqZWN0LmpzCnZhciBCZWhhdmlvclN1YmplY3QgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKEJlaGF2aW9yU3ViamVjdDIsIF9zdXBlcik7CiAgZnVuY3Rpb24gQmVoYXZpb3JTdWJqZWN0MihfdmFsdWUpIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7CiAgICBfdGhpcy5fdmFsdWUgPSBfdmFsdWU7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCZWhhdmlvclN1YmplY3QyLnByb3RvdHlwZSwgInZhbHVlIiwgewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0VmFsdWUoKTsKICAgIH0sCiAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIEJlaGF2aW9yU3ViamVjdDIucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICB2YXIgc3Vic2NyaXB0aW9uID0gX3N1cGVyLnByb3RvdHlwZS5fc3Vic2NyaWJlLmNhbGwodGhpcywgc3Vic2NyaWJlcik7CiAgICAhc3Vic2NyaXB0aW9uLmNsb3NlZCAmJiBzdWJzY3JpYmVyLm5leHQodGhpcy5fdmFsdWUpOwogICAgcmV0dXJuIHN1YnNjcmlwdGlvbjsKICB9OwogIEJlaGF2aW9yU3ViamVjdDIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgX2EgPSB0aGlzLCBoYXNFcnJvciA9IF9hLmhhc0Vycm9yLCB0aHJvd25FcnJvciA9IF9hLnRocm93bkVycm9yLCBfdmFsdWUgPSBfYS5fdmFsdWU7CiAgICBpZiAoaGFzRXJyb3IpIHsKICAgICAgdGhyb3cgdGhyb3duRXJyb3I7CiAgICB9CiAgICB0aGlzLl90aHJvd0lmQ2xvc2VkKCk7CiAgICByZXR1cm4gX3ZhbHVlOwogIH07CiAgQmVoYXZpb3JTdWJqZWN0Mi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICBfc3VwZXIucHJvdG90eXBlLm5leHQuY2FsbCh0aGlzLCB0aGlzLl92YWx1ZSA9IHZhbHVlKTsKICB9OwogIHJldHVybiBCZWhhdmlvclN1YmplY3QyOwp9KShTdWJqZWN0KTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvZGF0ZVRpbWVzdGFtcFByb3ZpZGVyLmpzCnZhciBkYXRlVGltZXN0YW1wUHJvdmlkZXIgPSB7CiAgbm93OiBmdW5jdGlvbigpIHsKICAgIHJldHVybiAoZGF0ZVRpbWVzdGFtcFByb3ZpZGVyLmRlbGVnYXRlIHx8IERhdGUpLm5vdygpOwogIH0sCiAgZGVsZWdhdGU6IHZvaWQgMAp9OwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL1JlcGxheVN1YmplY3QuanMKdmFyIFJlcGxheVN1YmplY3QgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKFJlcGxheVN1YmplY3QyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIFJlcGxheVN1YmplY3QyKF9idWZmZXJTaXplLCBfd2luZG93VGltZSwgX3RpbWVzdGFtcFByb3ZpZGVyKSB7CiAgICBpZiAoX2J1ZmZlclNpemUgPT09IHZvaWQgMCkgewogICAgICBfYnVmZmVyU2l6ZSA9IEluZmluaXR5OwogICAgfQogICAgaWYgKF93aW5kb3dUaW1lID09PSB2b2lkIDApIHsKICAgICAgX3dpbmRvd1RpbWUgPSBJbmZpbml0eTsKICAgIH0KICAgIGlmIChfdGltZXN0YW1wUHJvdmlkZXIgPT09IHZvaWQgMCkgewogICAgICBfdGltZXN0YW1wUHJvdmlkZXIgPSBkYXRlVGltZXN0YW1wUHJvdmlkZXI7CiAgICB9CiAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogICAgX3RoaXMuX2J1ZmZlclNpemUgPSBfYnVmZmVyU2l6ZTsKICAgIF90aGlzLl93aW5kb3dUaW1lID0gX3dpbmRvd1RpbWU7CiAgICBfdGhpcy5fdGltZXN0YW1wUHJvdmlkZXIgPSBfdGltZXN0YW1wUHJvdmlkZXI7CiAgICBfdGhpcy5fYnVmZmVyID0gW107CiAgICBfdGhpcy5faW5maW5pdGVUaW1lV2luZG93ID0gdHJ1ZTsKICAgIF90aGlzLl9pbmZpbml0ZVRpbWVXaW5kb3cgPSBfd2luZG93VGltZSA9PT0gSW5maW5pdHk7CiAgICBfdGhpcy5fYnVmZmVyU2l6ZSA9IE1hdGgubWF4KDEsIF9idWZmZXJTaXplKTsKICAgIF90aGlzLl93aW5kb3dUaW1lID0gTWF0aC5tYXgoMSwgX3dpbmRvd1RpbWUpOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBSZXBsYXlTdWJqZWN0Mi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICB2YXIgX2EgPSB0aGlzLCBpc1N0b3BwZWQgPSBfYS5pc1N0b3BwZWQsIF9idWZmZXIgPSBfYS5fYnVmZmVyLCBfaW5maW5pdGVUaW1lV2luZG93ID0gX2EuX2luZmluaXRlVGltZVdpbmRvdywgX3RpbWVzdGFtcFByb3ZpZGVyID0gX2EuX3RpbWVzdGFtcFByb3ZpZGVyLCBfd2luZG93VGltZSA9IF9hLl93aW5kb3dUaW1lOwogICAgaWYgKCFpc1N0b3BwZWQpIHsKICAgICAgX2J1ZmZlci5wdXNoKHZhbHVlKTsKICAgICAgIV9pbmZpbml0ZVRpbWVXaW5kb3cgJiYgX2J1ZmZlci5wdXNoKF90aW1lc3RhbXBQcm92aWRlci5ub3coKSArIF93aW5kb3dUaW1lKTsKICAgIH0KICAgIHRoaXMuX3RyaW1CdWZmZXIoKTsKICAgIF9zdXBlci5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMsIHZhbHVlKTsKICB9OwogIFJlcGxheVN1YmplY3QyLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgdGhpcy5fdGhyb3dJZkNsb3NlZCgpOwogICAgdGhpcy5fdHJpbUJ1ZmZlcigpOwogICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRoaXMuX2lubmVyU3Vic2NyaWJlKHN1YnNjcmliZXIpOwogICAgdmFyIF9hID0gdGhpcywgX2luZmluaXRlVGltZVdpbmRvdyA9IF9hLl9pbmZpbml0ZVRpbWVXaW5kb3csIF9idWZmZXIgPSBfYS5fYnVmZmVyOwogICAgdmFyIGNvcHkgPSBfYnVmZmVyLnNsaWNlKCk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvcHkubGVuZ3RoICYmICFzdWJzY3JpYmVyLmNsb3NlZDsgaSArPSBfaW5maW5pdGVUaW1lV2luZG93ID8gMSA6IDIpIHsKICAgICAgc3Vic2NyaWJlci5uZXh0KGNvcHlbaV0pOwogICAgfQogICAgdGhpcy5fY2hlY2tGaW5hbGl6ZWRTdGF0dXNlcyhzdWJzY3JpYmVyKTsKICAgIHJldHVybiBzdWJzY3JpcHRpb247CiAgfTsKICBSZXBsYXlTdWJqZWN0Mi5wcm90b3R5cGUuX3RyaW1CdWZmZXIgPSBmdW5jdGlvbigpIHsKICAgIHZhciBfYSA9IHRoaXMsIF9idWZmZXJTaXplID0gX2EuX2J1ZmZlclNpemUsIF90aW1lc3RhbXBQcm92aWRlciA9IF9hLl90aW1lc3RhbXBQcm92aWRlciwgX2J1ZmZlciA9IF9hLl9idWZmZXIsIF9pbmZpbml0ZVRpbWVXaW5kb3cgPSBfYS5faW5maW5pdGVUaW1lV2luZG93OwogICAgdmFyIGFkanVzdGVkQnVmZmVyU2l6ZSA9IChfaW5maW5pdGVUaW1lV2luZG93ID8gMSA6IDIpICogX2J1ZmZlclNpemU7CiAgICBfYnVmZmVyU2l6ZSA8IEluZmluaXR5ICYmIGFkanVzdGVkQnVmZmVyU2l6ZSA8IF9idWZmZXIubGVuZ3RoICYmIF9idWZmZXIuc3BsaWNlKDAsIF9idWZmZXIubGVuZ3RoIC0gYWRqdXN0ZWRCdWZmZXJTaXplKTsKICAgIGlmICghX2luZmluaXRlVGltZVdpbmRvdykgewogICAgICB2YXIgbm93ID0gX3RpbWVzdGFtcFByb3ZpZGVyLm5vdygpOwogICAgICB2YXIgbGFzdDMgPSAwOwogICAgICBmb3IgKHZhciBpID0gMTsgaSA8IF9idWZmZXIubGVuZ3RoICYmIF9idWZmZXJbaV0gPD0gbm93OyBpICs9IDIpIHsKICAgICAgICBsYXN0MyA9IGk7CiAgICAgIH0KICAgICAgbGFzdDMgJiYgX2J1ZmZlci5zcGxpY2UoMCwgbGFzdDMgKyAxKTsKICAgIH0KICB9OwogIHJldHVybiBSZXBsYXlTdWJqZWN0MjsKfSkoU3ViamVjdCk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvQXN5bmNTdWJqZWN0LmpzCnZhciBBc3luY1N1YmplY3QgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKEFzeW5jU3ViamVjdDIsIF9zdXBlcik7CiAgZnVuY3Rpb24gQXN5bmNTdWJqZWN0MigpIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogICAgX3RoaXMuX3ZhbHVlID0gbnVsbDsKICAgIF90aGlzLl9oYXNWYWx1ZSA9IGZhbHNlOwogICAgX3RoaXMuX2lzQ29tcGxldGUgPSBmYWxzZTsKICAgIHJldHVybiBfdGhpczsKICB9CiAgQXN5bmNTdWJqZWN0Mi5wcm90b3R5cGUuX2NoZWNrRmluYWxpemVkU3RhdHVzZXMgPSBmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICB2YXIgX2EgPSB0aGlzLCBoYXNFcnJvciA9IF9hLmhhc0Vycm9yLCBfaGFzVmFsdWUgPSBfYS5faGFzVmFsdWUsIF92YWx1ZSA9IF9hLl92YWx1ZSwgdGhyb3duRXJyb3IgPSBfYS50aHJvd25FcnJvciwgaXNTdG9wcGVkID0gX2EuaXNTdG9wcGVkLCBfaXNDb21wbGV0ZSA9IF9hLl9pc0NvbXBsZXRlOwogICAgaWYgKGhhc0Vycm9yKSB7CiAgICAgIHN1YnNjcmliZXIuZXJyb3IodGhyb3duRXJyb3IpOwogICAgfSBlbHNlIGlmIChpc1N0b3BwZWQgfHwgX2lzQ29tcGxldGUpIHsKICAgICAgX2hhc1ZhbHVlICYmIHN1YnNjcmliZXIubmV4dChfdmFsdWUpOwogICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICB9CiAgfTsKICBBc3luY1N1YmplY3QyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHsKICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTsKICAgICAgdGhpcy5faGFzVmFsdWUgPSB0cnVlOwogICAgfQogIH07CiAgQXN5bmNTdWJqZWN0Mi5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbigpIHsKICAgIHZhciBfYSA9IHRoaXMsIF9oYXNWYWx1ZSA9IF9hLl9oYXNWYWx1ZSwgX3ZhbHVlID0gX2EuX3ZhbHVlLCBfaXNDb21wbGV0ZSA9IF9hLl9pc0NvbXBsZXRlOwogICAgaWYgKCFfaXNDb21wbGV0ZSkgewogICAgICB0aGlzLl9pc0NvbXBsZXRlID0gdHJ1ZTsKICAgICAgX2hhc1ZhbHVlICYmIF9zdXBlci5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMsIF92YWx1ZSk7CiAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcGxldGUuY2FsbCh0aGlzKTsKICAgIH0KICB9OwogIHJldHVybiBBc3luY1N1YmplY3QyOwp9KShTdWJqZWN0KTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvQWN0aW9uLmpzCnZhciBBY3Rpb24gPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKEFjdGlvbjIsIF9zdXBlcik7CiAgZnVuY3Rpb24gQWN0aW9uMihzY2hlZHVsZXIsIHdvcmspIHsKICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwogIH0KICBBY3Rpb24yLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uKHN0YXRlLCBkZWxheTIpIHsKICAgIGlmIChkZWxheTIgPT09IHZvaWQgMCkgewogICAgICBkZWxheTIgPSAwOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfTsKICByZXR1cm4gQWN0aW9uMjsKfSkoU3Vic2NyaXB0aW9uKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvaW50ZXJ2YWxQcm92aWRlci5qcwp2YXIgaW50ZXJ2YWxQcm92aWRlciA9IHsKICBzZXRJbnRlcnZhbDogZnVuY3Rpb24oaGFuZGxlciwgdGltZW91dDIpIHsKICAgIHZhciBhcmdzID0gW107CiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwogICAgfQogICAgdmFyIGRlbGVnYXRlID0gaW50ZXJ2YWxQcm92aWRlci5kZWxlZ2F0ZTsKICAgIGlmIChkZWxlZ2F0ZSA9PT0gbnVsbCB8fCBkZWxlZ2F0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVsZWdhdGUuc2V0SW50ZXJ2YWwpIHsKICAgICAgcmV0dXJuIGRlbGVnYXRlLnNldEludGVydmFsLmFwcGx5KGRlbGVnYXRlLCBfX3NwcmVhZEFycmF5KFtoYW5kbGVyLCB0aW1lb3V0Ml0sIF9fcmVhZChhcmdzKSkpOwogICAgfQogICAgcmV0dXJuIHNldEludGVydmFsLmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbaGFuZGxlciwgdGltZW91dDJdLCBfX3JlYWQoYXJncykpKTsKICB9LAogIGNsZWFySW50ZXJ2YWw6IGZ1bmN0aW9uKGhhbmRsZSkgewogICAgdmFyIGRlbGVnYXRlID0gaW50ZXJ2YWxQcm92aWRlci5kZWxlZ2F0ZTsKICAgIHJldHVybiAoKGRlbGVnYXRlID09PSBudWxsIHx8IGRlbGVnYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZWxlZ2F0ZS5jbGVhckludGVydmFsKSB8fCBjbGVhckludGVydmFsKShoYW5kbGUpOwogIH0sCiAgZGVsZWdhdGU6IHZvaWQgMAp9OwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3NjaGVkdWxlci9Bc3luY0FjdGlvbi5qcwp2YXIgQXN5bmNBY3Rpb24gPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKEFzeW5jQWN0aW9uMiwgX3N1cGVyKTsKICBmdW5jdGlvbiBBc3luY0FjdGlvbjIoc2NoZWR1bGVyLCB3b3JrKSB7CiAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBzY2hlZHVsZXIsIHdvcmspIHx8IHRoaXM7CiAgICBfdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICBfdGhpcy53b3JrID0gd29yazsKICAgIF90aGlzLnBlbmRpbmcgPSBmYWxzZTsKICAgIHJldHVybiBfdGhpczsKICB9CiAgQXN5bmNBY3Rpb24yLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uKHN0YXRlLCBkZWxheTIpIHsKICAgIHZhciBfYTsKICAgIGlmIChkZWxheTIgPT09IHZvaWQgMCkgewogICAgICBkZWxheTIgPSAwOwogICAgfQogICAgaWYgKHRoaXMuY2xvc2VkKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdmFyIGlkID0gdGhpcy5pZDsKICAgIHZhciBzY2hlZHVsZXIgPSB0aGlzLnNjaGVkdWxlcjsKICAgIGlmIChpZCAhPSBudWxsKSB7CiAgICAgIHRoaXMuaWQgPSB0aGlzLnJlY3ljbGVBc3luY0lkKHNjaGVkdWxlciwgaWQsIGRlbGF5Mik7CiAgICB9CiAgICB0aGlzLnBlbmRpbmcgPSB0cnVlOwogICAgdGhpcy5kZWxheSA9IGRlbGF5MjsKICAgIHRoaXMuaWQgPSAoX2EgPSB0aGlzLmlkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB0aGlzLnJlcXVlc3RBc3luY0lkKHNjaGVkdWxlciwgdGhpcy5pZCwgZGVsYXkyKTsKICAgIHJldHVybiB0aGlzOwogIH07CiAgQXN5bmNBY3Rpb24yLnByb3RvdHlwZS5yZXF1ZXN0QXN5bmNJZCA9IGZ1bmN0aW9uKHNjaGVkdWxlciwgX2lkLCBkZWxheTIpIHsKICAgIGlmIChkZWxheTIgPT09IHZvaWQgMCkgewogICAgICBkZWxheTIgPSAwOwogICAgfQogICAgcmV0dXJuIGludGVydmFsUHJvdmlkZXIuc2V0SW50ZXJ2YWwoc2NoZWR1bGVyLmZsdXNoLmJpbmQoc2NoZWR1bGVyLCB0aGlzKSwgZGVsYXkyKTsKICB9OwogIEFzeW5jQWN0aW9uMi5wcm90b3R5cGUucmVjeWNsZUFzeW5jSWQgPSBmdW5jdGlvbihfc2NoZWR1bGVyLCBpZCwgZGVsYXkyKSB7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIGlmIChkZWxheTIgIT0gbnVsbCAmJiB0aGlzLmRlbGF5ID09PSBkZWxheTIgJiYgdGhpcy5wZW5kaW5nID09PSBmYWxzZSkgewogICAgICByZXR1cm4gaWQ7CiAgICB9CiAgICBpZiAoaWQgIT0gbnVsbCkgewogICAgICBpbnRlcnZhbFByb3ZpZGVyLmNsZWFySW50ZXJ2YWwoaWQpOwogICAgfQogICAgcmV0dXJuIHZvaWQgMDsKICB9OwogIEFzeW5jQWN0aW9uMi5wcm90b3R5cGUuZXhlY3V0ZSA9IGZ1bmN0aW9uKHN0YXRlLCBkZWxheTIpIHsKICAgIGlmICh0aGlzLmNsb3NlZCkgewogICAgICByZXR1cm4gbmV3IEVycm9yKCJleGVjdXRpbmcgYSBjYW5jZWxsZWQgYWN0aW9uIik7CiAgICB9CiAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTsKICAgIHZhciBlcnJvciA9IHRoaXMuX2V4ZWN1dGUoc3RhdGUsIGRlbGF5Mik7CiAgICBpZiAoZXJyb3IpIHsKICAgICAgcmV0dXJuIGVycm9yOwogICAgfSBlbHNlIGlmICh0aGlzLnBlbmRpbmcgPT09IGZhbHNlICYmIHRoaXMuaWQgIT0gbnVsbCkgewogICAgICB0aGlzLmlkID0gdGhpcy5yZWN5Y2xlQXN5bmNJZCh0aGlzLnNjaGVkdWxlciwgdGhpcy5pZCwgbnVsbCk7CiAgICB9CiAgfTsKICBBc3luY0FjdGlvbjIucHJvdG90eXBlLl9leGVjdXRlID0gZnVuY3Rpb24oc3RhdGUsIF9kZWxheSkgewogICAgdmFyIGVycm9yZWQgPSBmYWxzZTsKICAgIHZhciBlcnJvclZhbHVlOwogICAgdHJ5IHsKICAgICAgdGhpcy53b3JrKHN0YXRlKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgZXJyb3JlZCA9IHRydWU7CiAgICAgIGVycm9yVmFsdWUgPSBlID8gZSA6IG5ldyBFcnJvcigiU2NoZWR1bGVkIGFjdGlvbiB0aHJldyBmYWxzeSBlcnJvciIpOwogICAgfQogICAgaWYgKGVycm9yZWQpIHsKICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgICByZXR1cm4gZXJyb3JWYWx1ZTsKICAgIH0KICB9OwogIEFzeW5jQWN0aW9uMi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbigpIHsKICAgIGlmICghdGhpcy5jbG9zZWQpIHsKICAgICAgdmFyIF9hID0gdGhpcywgaWQgPSBfYS5pZCwgc2NoZWR1bGVyID0gX2Euc2NoZWR1bGVyOwogICAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zOwogICAgICB0aGlzLndvcmsgPSB0aGlzLnN0YXRlID0gdGhpcy5zY2hlZHVsZXIgPSBudWxsOwogICAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTsKICAgICAgYXJyUmVtb3ZlKGFjdGlvbnMsIHRoaXMpOwogICAgICBpZiAoaWQgIT0gbnVsbCkgewogICAgICAgIHRoaXMuaWQgPSB0aGlzLnJlY3ljbGVBc3luY0lkKHNjaGVkdWxlciwgaWQsIG51bGwpOwogICAgICB9CiAgICAgIHRoaXMuZGVsYXkgPSBudWxsOwogICAgICBfc3VwZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlLmNhbGwodGhpcyk7CiAgICB9CiAgfTsKICByZXR1cm4gQXN5bmNBY3Rpb24yOwp9KShBY3Rpb24pOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvSW1tZWRpYXRlLmpzCnZhciBuZXh0SGFuZGxlID0gMTsKdmFyIHJlc29sdmVkOwp2YXIgYWN0aXZlSGFuZGxlcyA9IHt9OwpmdW5jdGlvbiBmaW5kQW5kQ2xlYXJIYW5kbGUoaGFuZGxlKSB7CiAgaWYgKGhhbmRsZSBpbiBhY3RpdmVIYW5kbGVzKSB7CiAgICBkZWxldGUgYWN0aXZlSGFuZGxlc1toYW5kbGVdOwogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKfQp2YXIgSW1tZWRpYXRlID0gewogIHNldEltbWVkaWF0ZTogZnVuY3Rpb24oY2IpIHsKICAgIHZhciBoYW5kbGUgPSBuZXh0SGFuZGxlKys7CiAgICBhY3RpdmVIYW5kbGVzW2hhbmRsZV0gPSB0cnVlOwogICAgaWYgKCFyZXNvbHZlZCkgewogICAgICByZXNvbHZlZCA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgfQogICAgcmVzb2x2ZWQudGhlbihmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGZpbmRBbmRDbGVhckhhbmRsZShoYW5kbGUpICYmIGNiKCk7CiAgICB9KTsKICAgIHJldHVybiBoYW5kbGU7CiAgfSwKICBjbGVhckltbWVkaWF0ZTogZnVuY3Rpb24oaGFuZGxlKSB7CiAgICBmaW5kQW5kQ2xlYXJIYW5kbGUoaGFuZGxlKTsKICB9Cn07CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL2ltbWVkaWF0ZVByb3ZpZGVyLmpzCnZhciBzZXRJbW1lZGlhdGUgPSBJbW1lZGlhdGUuc2V0SW1tZWRpYXRlOwp2YXIgY2xlYXJJbW1lZGlhdGUgPSBJbW1lZGlhdGUuY2xlYXJJbW1lZGlhdGU7CnZhciBpbW1lZGlhdGVQcm92aWRlciA9IHsKICBzZXRJbW1lZGlhdGU6IGZ1bmN0aW9uKCkgewogICAgdmFyIGFyZ3MgPSBbXTsKICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CiAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTsKICAgIH0KICAgIHZhciBkZWxlZ2F0ZSA9IGltbWVkaWF0ZVByb3ZpZGVyLmRlbGVnYXRlOwogICAgcmV0dXJuICgoZGVsZWdhdGUgPT09IG51bGwgfHwgZGVsZWdhdGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRlbGVnYXRlLnNldEltbWVkaWF0ZSkgfHwgc2V0SW1tZWRpYXRlKS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW10sIF9fcmVhZChhcmdzKSkpOwogIH0sCiAgY2xlYXJJbW1lZGlhdGU6IGZ1bmN0aW9uKGhhbmRsZSkgewogICAgdmFyIGRlbGVnYXRlID0gaW1tZWRpYXRlUHJvdmlkZXIuZGVsZWdhdGU7CiAgICByZXR1cm4gKChkZWxlZ2F0ZSA9PT0gbnVsbCB8fCBkZWxlZ2F0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVsZWdhdGUuY2xlYXJJbW1lZGlhdGUpIHx8IGNsZWFySW1tZWRpYXRlKShoYW5kbGUpOwogIH0sCiAgZGVsZWdhdGU6IHZvaWQgMAp9OwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3NjaGVkdWxlci9Bc2FwQWN0aW9uLmpzCnZhciBBc2FwQWN0aW9uID0gKGZ1bmN0aW9uKF9zdXBlcikgewogIF9fZXh0ZW5kcyhBc2FwQWN0aW9uMiwgX3N1cGVyKTsKICBmdW5jdGlvbiBBc2FwQWN0aW9uMihzY2hlZHVsZXIsIHdvcmspIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpczsKICAgIF90aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgIF90aGlzLndvcmsgPSB3b3JrOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBBc2FwQWN0aW9uMi5wcm90b3R5cGUucmVxdWVzdEFzeW5jSWQgPSBmdW5jdGlvbihzY2hlZHVsZXIsIGlkLCBkZWxheTIpIHsKICAgIGlmIChkZWxheTIgPT09IHZvaWQgMCkgewogICAgICBkZWxheTIgPSAwOwogICAgfQogICAgaWYgKGRlbGF5MiAhPT0gbnVsbCAmJiBkZWxheTIgPiAwKSB7CiAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkLmNhbGwodGhpcywgc2NoZWR1bGVyLCBpZCwgZGVsYXkyKTsKICAgIH0KICAgIHNjaGVkdWxlci5hY3Rpb25zLnB1c2godGhpcyk7CiAgICByZXR1cm4gc2NoZWR1bGVyLl9zY2hlZHVsZWQgfHwgKHNjaGVkdWxlci5fc2NoZWR1bGVkID0gaW1tZWRpYXRlUHJvdmlkZXIuc2V0SW1tZWRpYXRlKHNjaGVkdWxlci5mbHVzaC5iaW5kKHNjaGVkdWxlciwgdm9pZCAwKSkpOwogIH07CiAgQXNhcEFjdGlvbjIucHJvdG90eXBlLnJlY3ljbGVBc3luY0lkID0gZnVuY3Rpb24oc2NoZWR1bGVyLCBpZCwgZGVsYXkyKSB7CiAgICB2YXIgX2E7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIGlmIChkZWxheTIgIT0gbnVsbCA/IGRlbGF5MiA+IDAgOiB0aGlzLmRlbGF5ID4gMCkgewogICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZWN5Y2xlQXN5bmNJZC5jYWxsKHRoaXMsIHNjaGVkdWxlciwgaWQsIGRlbGF5Mik7CiAgICB9CiAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zOwogICAgaWYgKGlkICE9IG51bGwgJiYgKChfYSA9IGFjdGlvbnNbYWN0aW9ucy5sZW5ndGggLSAxXSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlkKSAhPT0gaWQpIHsKICAgICAgaW1tZWRpYXRlUHJvdmlkZXIuY2xlYXJJbW1lZGlhdGUoaWQpOwogICAgICBpZiAoc2NoZWR1bGVyLl9zY2hlZHVsZWQgPT09IGlkKSB7CiAgICAgICAgc2NoZWR1bGVyLl9zY2hlZHVsZWQgPSB2b2lkIDA7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB2b2lkIDA7CiAgfTsKICByZXR1cm4gQXNhcEFjdGlvbjI7Cn0pKEFzeW5jQWN0aW9uKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9TY2hlZHVsZXIuanMKdmFyIFNjaGVkdWxlciA9IChmdW5jdGlvbigpIHsKICBmdW5jdGlvbiBTY2hlZHVsZXIyKHNjaGVkdWxlckFjdGlvbkN0b3IsIG5vdykgewogICAgaWYgKG5vdyA9PT0gdm9pZCAwKSB7CiAgICAgIG5vdyA9IFNjaGVkdWxlcjIubm93OwogICAgfQogICAgdGhpcy5zY2hlZHVsZXJBY3Rpb25DdG9yID0gc2NoZWR1bGVyQWN0aW9uQ3RvcjsKICAgIHRoaXMubm93ID0gbm93OwogIH0KICBTY2hlZHVsZXIyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uKHdvcmssIGRlbGF5Miwgc3RhdGUpIHsKICAgIGlmIChkZWxheTIgPT09IHZvaWQgMCkgewogICAgICBkZWxheTIgPSAwOwogICAgfQogICAgcmV0dXJuIG5ldyB0aGlzLnNjaGVkdWxlckFjdGlvbkN0b3IodGhpcywgd29yaykuc2NoZWR1bGUoc3RhdGUsIGRlbGF5Mik7CiAgfTsKICBTY2hlZHVsZXIyLm5vdyA9IGRhdGVUaW1lc3RhbXBQcm92aWRlci5ub3c7CiAgcmV0dXJuIFNjaGVkdWxlcjI7Cn0pKCk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL0FzeW5jU2NoZWR1bGVyLmpzCnZhciBBc3luY1NjaGVkdWxlciA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoQXN5bmNTY2hlZHVsZXIyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIEFzeW5jU2NoZWR1bGVyMihTY2hlZHVsZXJBY3Rpb24sIG5vdykgewogICAgaWYgKG5vdyA9PT0gdm9pZCAwKSB7CiAgICAgIG5vdyA9IFNjaGVkdWxlci5ub3c7CiAgICB9CiAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBTY2hlZHVsZXJBY3Rpb24sIG5vdykgfHwgdGhpczsKICAgIF90aGlzLmFjdGlvbnMgPSBbXTsKICAgIF90aGlzLl9hY3RpdmUgPSBmYWxzZTsKICAgIHJldHVybiBfdGhpczsKICB9CiAgQXN5bmNTY2hlZHVsZXIyLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uKGFjdGlvbikgewogICAgdmFyIGFjdGlvbnMgPSB0aGlzLmFjdGlvbnM7CiAgICBpZiAodGhpcy5fYWN0aXZlKSB7CiAgICAgIGFjdGlvbnMucHVzaChhY3Rpb24pOwogICAgICByZXR1cm47CiAgICB9CiAgICB2YXIgZXJyb3I7CiAgICB0aGlzLl9hY3RpdmUgPSB0cnVlOwogICAgZG8gewogICAgICBpZiAoZXJyb3IgPSBhY3Rpb24uZXhlY3V0ZShhY3Rpb24uc3RhdGUsIGFjdGlvbi5kZWxheSkpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfSB3aGlsZSAoYWN0aW9uID0gYWN0aW9ucy5zaGlmdCgpKTsKICAgIHRoaXMuX2FjdGl2ZSA9IGZhbHNlOwogICAgaWYgKGVycm9yKSB7CiAgICAgIHdoaWxlIChhY3Rpb24gPSBhY3Rpb25zLnNoaWZ0KCkpIHsKICAgICAgICBhY3Rpb24udW5zdWJzY3JpYmUoKTsKICAgICAgfQogICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICB9OwogIHJldHVybiBBc3luY1NjaGVkdWxlcjI7Cn0pKFNjaGVkdWxlcik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL0FzYXBTY2hlZHVsZXIuanMKdmFyIEFzYXBTY2hlZHVsZXIgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgX19leHRlbmRzKEFzYXBTY2hlZHVsZXIyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIEFzYXBTY2hlZHVsZXIyKCkgewogICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogIH0KICBBc2FwU2NoZWR1bGVyMi5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbihhY3Rpb24pIHsKICAgIHRoaXMuX2FjdGl2ZSA9IHRydWU7CiAgICB2YXIgZmx1c2hJZCA9IHRoaXMuX3NjaGVkdWxlZDsKICAgIHRoaXMuX3NjaGVkdWxlZCA9IHZvaWQgMDsKICAgIHZhciBhY3Rpb25zID0gdGhpcy5hY3Rpb25zOwogICAgdmFyIGVycm9yOwogICAgYWN0aW9uID0gYWN0aW9uIHx8IGFjdGlvbnMuc2hpZnQoKTsKICAgIGRvIHsKICAgICAgaWYgKGVycm9yID0gYWN0aW9uLmV4ZWN1dGUoYWN0aW9uLnN0YXRlLCBhY3Rpb24uZGVsYXkpKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0gd2hpbGUgKChhY3Rpb24gPSBhY3Rpb25zWzBdKSAmJiBhY3Rpb24uaWQgPT09IGZsdXNoSWQgJiYgYWN0aW9ucy5zaGlmdCgpKTsKICAgIHRoaXMuX2FjdGl2ZSA9IGZhbHNlOwogICAgaWYgKGVycm9yKSB7CiAgICAgIHdoaWxlICgoYWN0aW9uID0gYWN0aW9uc1swXSkgJiYgYWN0aW9uLmlkID09PSBmbHVzaElkICYmIGFjdGlvbnMuc2hpZnQoKSkgewogICAgICAgIGFjdGlvbi51bnN1YnNjcmliZSgpOwogICAgICB9CiAgICAgIHRocm93IGVycm9yOwogICAgfQogIH07CiAgcmV0dXJuIEFzYXBTY2hlZHVsZXIyOwp9KShBc3luY1NjaGVkdWxlcik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL2FzYXAuanMKdmFyIGFzYXBTY2hlZHVsZXIgPSBuZXcgQXNhcFNjaGVkdWxlcihBc2FwQWN0aW9uKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvYXN5bmMuanMKdmFyIGFzeW5jU2NoZWR1bGVyID0gbmV3IEFzeW5jU2NoZWR1bGVyKEFzeW5jQWN0aW9uKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvUXVldWVBY3Rpb24uanMKdmFyIFF1ZXVlQWN0aW9uID0gKGZ1bmN0aW9uKF9zdXBlcikgewogIF9fZXh0ZW5kcyhRdWV1ZUFjdGlvbjIsIF9zdXBlcik7CiAgZnVuY3Rpb24gUXVldWVBY3Rpb24yKHNjaGVkdWxlciwgd29yaykgewogICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc2NoZWR1bGVyLCB3b3JrKSB8fCB0aGlzOwogICAgX3RoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgX3RoaXMud29yayA9IHdvcms7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIFF1ZXVlQWN0aW9uMi5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbihzdGF0ZSwgZGVsYXkyKSB7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIGlmIChkZWxheTIgPiAwKSB7CiAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnNjaGVkdWxlLmNhbGwodGhpcywgc3RhdGUsIGRlbGF5Mik7CiAgICB9CiAgICB0aGlzLmRlbGF5ID0gZGVsYXkyOwogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5zY2hlZHVsZXIuZmx1c2godGhpcyk7CiAgICByZXR1cm4gdGhpczsKICB9OwogIFF1ZXVlQWN0aW9uMi5wcm90b3R5cGUuZXhlY3V0ZSA9IGZ1bmN0aW9uKHN0YXRlLCBkZWxheTIpIHsKICAgIHJldHVybiBkZWxheTIgPiAwIHx8IHRoaXMuY2xvc2VkID8gX3N1cGVyLnByb3RvdHlwZS5leGVjdXRlLmNhbGwodGhpcywgc3RhdGUsIGRlbGF5MikgOiB0aGlzLl9leGVjdXRlKHN0YXRlLCBkZWxheTIpOwogIH07CiAgUXVldWVBY3Rpb24yLnByb3RvdHlwZS5yZXF1ZXN0QXN5bmNJZCA9IGZ1bmN0aW9uKHNjaGVkdWxlciwgaWQsIGRlbGF5MikgewogICAgaWYgKGRlbGF5MiA9PT0gdm9pZCAwKSB7CiAgICAgIGRlbGF5MiA9IDA7CiAgICB9CiAgICBpZiAoZGVsYXkyICE9IG51bGwgJiYgZGVsYXkyID4gMCB8fCBkZWxheTIgPT0gbnVsbCAmJiB0aGlzLmRlbGF5ID4gMCkgewogICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZXF1ZXN0QXN5bmNJZC5jYWxsKHRoaXMsIHNjaGVkdWxlciwgaWQsIGRlbGF5Mik7CiAgICB9CiAgICBzY2hlZHVsZXIuZmx1c2godGhpcyk7CiAgICByZXR1cm4gMDsKICB9OwogIHJldHVybiBRdWV1ZUFjdGlvbjI7Cn0pKEFzeW5jQWN0aW9uKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvUXVldWVTY2hlZHVsZXIuanMKdmFyIFF1ZXVlU2NoZWR1bGVyID0gKGZ1bmN0aW9uKF9zdXBlcikgewogIF9fZXh0ZW5kcyhRdWV1ZVNjaGVkdWxlcjIsIF9zdXBlcik7CiAgZnVuY3Rpb24gUXVldWVTY2hlZHVsZXIyKCkgewogICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogIH0KICByZXR1cm4gUXVldWVTY2hlZHVsZXIyOwp9KShBc3luY1NjaGVkdWxlcik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL3F1ZXVlLmpzCnZhciBxdWV1ZVNjaGVkdWxlciA9IG5ldyBRdWV1ZVNjaGVkdWxlcihRdWV1ZUFjdGlvbik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL0FuaW1hdGlvbkZyYW1lQWN0aW9uLmpzCnZhciBBbmltYXRpb25GcmFtZUFjdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoQW5pbWF0aW9uRnJhbWVBY3Rpb24yLCBfc3VwZXIpOwogIGZ1bmN0aW9uIEFuaW1hdGlvbkZyYW1lQWN0aW9uMihzY2hlZHVsZXIsIHdvcmspIHsKICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpczsKICAgIF90aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgIF90aGlzLndvcmsgPSB3b3JrOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBBbmltYXRpb25GcmFtZUFjdGlvbjIucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkID0gZnVuY3Rpb24oc2NoZWR1bGVyLCBpZCwgZGVsYXkyKSB7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIGlmIChkZWxheTIgIT09IG51bGwgJiYgZGVsYXkyID4gMCkgewogICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZXF1ZXN0QXN5bmNJZC5jYWxsKHRoaXMsIHNjaGVkdWxlciwgaWQsIGRlbGF5Mik7CiAgICB9CiAgICBzY2hlZHVsZXIuYWN0aW9ucy5wdXNoKHRoaXMpOwogICAgcmV0dXJuIHNjaGVkdWxlci5fc2NoZWR1bGVkIHx8IChzY2hlZHVsZXIuX3NjaGVkdWxlZCA9IGFuaW1hdGlvbkZyYW1lUHJvdmlkZXIucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gc2NoZWR1bGVyLmZsdXNoKHZvaWQgMCk7CiAgICB9KSk7CiAgfTsKICBBbmltYXRpb25GcmFtZUFjdGlvbjIucHJvdG90eXBlLnJlY3ljbGVBc3luY0lkID0gZnVuY3Rpb24oc2NoZWR1bGVyLCBpZCwgZGVsYXkyKSB7CiAgICB2YXIgX2E7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIGlmIChkZWxheTIgIT0gbnVsbCA/IGRlbGF5MiA+IDAgOiB0aGlzLmRlbGF5ID4gMCkgewogICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZWN5Y2xlQXN5bmNJZC5jYWxsKHRoaXMsIHNjaGVkdWxlciwgaWQsIGRlbGF5Mik7CiAgICB9CiAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zOwogICAgaWYgKGlkICE9IG51bGwgJiYgaWQgPT09IHNjaGVkdWxlci5fc2NoZWR1bGVkICYmICgoX2EgPSBhY3Rpb25zW2FjdGlvbnMubGVuZ3RoIC0gMV0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pZCkgIT09IGlkKSB7CiAgICAgIGFuaW1hdGlvbkZyYW1lUHJvdmlkZXIuY2FuY2VsQW5pbWF0aW9uRnJhbWUoaWQpOwogICAgICBzY2hlZHVsZXIuX3NjaGVkdWxlZCA9IHZvaWQgMDsKICAgIH0KICAgIHJldHVybiB2b2lkIDA7CiAgfTsKICByZXR1cm4gQW5pbWF0aW9uRnJhbWVBY3Rpb24yOwp9KShBc3luY0FjdGlvbik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL0FuaW1hdGlvbkZyYW1lU2NoZWR1bGVyLmpzCnZhciBBbmltYXRpb25GcmFtZVNjaGVkdWxlciA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoQW5pbWF0aW9uRnJhbWVTY2hlZHVsZXIyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIEFuaW1hdGlvbkZyYW1lU2NoZWR1bGVyMigpIHsKICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKICB9CiAgQW5pbWF0aW9uRnJhbWVTY2hlZHVsZXIyLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uKGFjdGlvbikgewogICAgdGhpcy5fYWN0aXZlID0gdHJ1ZTsKICAgIHZhciBmbHVzaElkOwogICAgaWYgKGFjdGlvbikgewogICAgICBmbHVzaElkID0gYWN0aW9uLmlkOwogICAgfSBlbHNlIHsKICAgICAgZmx1c2hJZCA9IHRoaXMuX3NjaGVkdWxlZDsKICAgICAgdGhpcy5fc2NoZWR1bGVkID0gdm9pZCAwOwogICAgfQogICAgdmFyIGFjdGlvbnMgPSB0aGlzLmFjdGlvbnM7CiAgICB2YXIgZXJyb3I7CiAgICBhY3Rpb24gPSBhY3Rpb24gfHwgYWN0aW9ucy5zaGlmdCgpOwogICAgZG8gewogICAgICBpZiAoZXJyb3IgPSBhY3Rpb24uZXhlY3V0ZShhY3Rpb24uc3RhdGUsIGFjdGlvbi5kZWxheSkpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfSB3aGlsZSAoKGFjdGlvbiA9IGFjdGlvbnNbMF0pICYmIGFjdGlvbi5pZCA9PT0gZmx1c2hJZCAmJiBhY3Rpb25zLnNoaWZ0KCkpOwogICAgdGhpcy5fYWN0aXZlID0gZmFsc2U7CiAgICBpZiAoZXJyb3IpIHsKICAgICAgd2hpbGUgKChhY3Rpb24gPSBhY3Rpb25zWzBdKSAmJiBhY3Rpb24uaWQgPT09IGZsdXNoSWQgJiYgYWN0aW9ucy5zaGlmdCgpKSB7CiAgICAgICAgYWN0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICAgIH0KICAgICAgdGhyb3cgZXJyb3I7CiAgICB9CiAgfTsKICByZXR1cm4gQW5pbWF0aW9uRnJhbWVTY2hlZHVsZXIyOwp9KShBc3luY1NjaGVkdWxlcik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL2FuaW1hdGlvbkZyYW1lLmpzCnZhciBhbmltYXRpb25GcmFtZVNjaGVkdWxlciA9IG5ldyBBbmltYXRpb25GcmFtZVNjaGVkdWxlcihBbmltYXRpb25GcmFtZUFjdGlvbik7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL1ZpcnR1YWxUaW1lU2NoZWR1bGVyLmpzCnZhciBWaXJ0dWFsVGltZVNjaGVkdWxlciA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoVmlydHVhbFRpbWVTY2hlZHVsZXIyLCBfc3VwZXIpOwogIGZ1bmN0aW9uIFZpcnR1YWxUaW1lU2NoZWR1bGVyMihzY2hlZHVsZXJBY3Rpb25DdG9yLCBtYXhGcmFtZXMpIHsKICAgIGlmIChzY2hlZHVsZXJBY3Rpb25DdG9yID09PSB2b2lkIDApIHsKICAgICAgc2NoZWR1bGVyQWN0aW9uQ3RvciA9IFZpcnR1YWxBY3Rpb247CiAgICB9CiAgICBpZiAobWF4RnJhbWVzID09PSB2b2lkIDApIHsKICAgICAgbWF4RnJhbWVzID0gSW5maW5pdHk7CiAgICB9CiAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBzY2hlZHVsZXJBY3Rpb25DdG9yLCBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIF90aGlzLmZyYW1lOwogICAgfSkgfHwgdGhpczsKICAgIF90aGlzLm1heEZyYW1lcyA9IG1heEZyYW1lczsKICAgIF90aGlzLmZyYW1lID0gMDsKICAgIF90aGlzLmluZGV4ID0gLTE7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIFZpcnR1YWxUaW1lU2NoZWR1bGVyMi5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbigpIHsKICAgIHZhciBfYSA9IHRoaXMsIGFjdGlvbnMgPSBfYS5hY3Rpb25zLCBtYXhGcmFtZXMgPSBfYS5tYXhGcmFtZXM7CiAgICB2YXIgZXJyb3I7CiAgICB2YXIgYWN0aW9uOwogICAgd2hpbGUgKChhY3Rpb24gPSBhY3Rpb25zWzBdKSAmJiBhY3Rpb24uZGVsYXkgPD0gbWF4RnJhbWVzKSB7CiAgICAgIGFjdGlvbnMuc2hpZnQoKTsKICAgICAgdGhpcy5mcmFtZSA9IGFjdGlvbi5kZWxheTsKICAgICAgaWYgKGVycm9yID0gYWN0aW9uLmV4ZWN1dGUoYWN0aW9uLnN0YXRlLCBhY3Rpb24uZGVsYXkpKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGlmIChlcnJvcikgewogICAgICB3aGlsZSAoYWN0aW9uID0gYWN0aW9ucy5zaGlmdCgpKSB7CiAgICAgICAgYWN0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICAgIH0KICAgICAgdGhyb3cgZXJyb3I7CiAgICB9CiAgfTsKICBWaXJ0dWFsVGltZVNjaGVkdWxlcjIuZnJhbWVUaW1lRmFjdG9yID0gMTA7CiAgcmV0dXJuIFZpcnR1YWxUaW1lU2NoZWR1bGVyMjsKfSkoQXN5bmNTY2hlZHVsZXIpOwp2YXIgVmlydHVhbEFjdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICBfX2V4dGVuZHMoVmlydHVhbEFjdGlvbjIsIF9zdXBlcik7CiAgZnVuY3Rpb24gVmlydHVhbEFjdGlvbjIoc2NoZWR1bGVyLCB3b3JrLCBpbmRleCkgewogICAgaWYgKGluZGV4ID09PSB2b2lkIDApIHsKICAgICAgaW5kZXggPSBzY2hlZHVsZXIuaW5kZXggKz0gMTsKICAgIH0KICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpczsKICAgIF90aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgIF90aGlzLndvcmsgPSB3b3JrOwogICAgX3RoaXMuaW5kZXggPSBpbmRleDsKICAgIF90aGlzLmFjdGl2ZSA9IHRydWU7CiAgICBfdGhpcy5pbmRleCA9IHNjaGVkdWxlci5pbmRleCA9IGluZGV4OwogICAgcmV0dXJuIF90aGlzOwogIH0KICBWaXJ0dWFsQWN0aW9uMi5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbihzdGF0ZSwgZGVsYXkyKSB7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoZGVsYXkyKSkgewogICAgICBpZiAoIXRoaXMuaWQpIHsKICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5zY2hlZHVsZS5jYWxsKHRoaXMsIHN0YXRlLCBkZWxheTIpOwogICAgICB9CiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgIHZhciBhY3Rpb24gPSBuZXcgVmlydHVhbEFjdGlvbjIodGhpcy5zY2hlZHVsZXIsIHRoaXMud29yayk7CiAgICAgIHRoaXMuYWRkKGFjdGlvbik7CiAgICAgIHJldHVybiBhY3Rpb24uc2NoZWR1bGUoc3RhdGUsIGRlbGF5Mik7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gU3Vic2NyaXB0aW9uLkVNUFRZOwogICAgfQogIH07CiAgVmlydHVhbEFjdGlvbjIucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkID0gZnVuY3Rpb24oc2NoZWR1bGVyLCBpZCwgZGVsYXkyKSB7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIHRoaXMuZGVsYXkgPSBzY2hlZHVsZXIuZnJhbWUgKyBkZWxheTI7CiAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zOwogICAgYWN0aW9ucy5wdXNoKHRoaXMpOwogICAgYWN0aW9ucy5zb3J0KFZpcnR1YWxBY3Rpb24yLnNvcnRBY3Rpb25zKTsKICAgIHJldHVybiAxOwogIH07CiAgVmlydHVhbEFjdGlvbjIucHJvdG90eXBlLnJlY3ljbGVBc3luY0lkID0gZnVuY3Rpb24oc2NoZWR1bGVyLCBpZCwgZGVsYXkyKSB7CiAgICBpZiAoZGVsYXkyID09PSB2b2lkIDApIHsKICAgICAgZGVsYXkyID0gMDsKICAgIH0KICAgIHJldHVybiB2b2lkIDA7CiAgfTsKICBWaXJ0dWFsQWN0aW9uMi5wcm90b3R5cGUuX2V4ZWN1dGUgPSBmdW5jdGlvbihzdGF0ZSwgZGVsYXkyKSB7CiAgICBpZiAodGhpcy5hY3RpdmUgPT09IHRydWUpIHsKICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuX2V4ZWN1dGUuY2FsbCh0aGlzLCBzdGF0ZSwgZGVsYXkyKTsKICAgIH0KICB9OwogIFZpcnR1YWxBY3Rpb24yLnNvcnRBY3Rpb25zID0gZnVuY3Rpb24oYSwgYikgewogICAgaWYgKGEuZGVsYXkgPT09IGIuZGVsYXkpIHsKICAgICAgaWYgKGEuaW5kZXggPT09IGIuaW5kZXgpIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfSBlbHNlIGlmIChhLmluZGV4ID4gYi5pbmRleCkgewogICAgICAgIHJldHVybiAxOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAtMTsKICAgICAgfQogICAgfSBlbHNlIGlmIChhLmRlbGF5ID4gYi5kZWxheSkgewogICAgICByZXR1cm4gMTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAtMTsKICAgIH0KICB9OwogIHJldHVybiBWaXJ0dWFsQWN0aW9uMjsKfSkoQXN5bmNBY3Rpb24pOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29ic2VydmFibGUvZW1wdHkuanMKdmFyIEVNUFRZID0gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24oc3Vic2NyaWJlcikgewogIHJldHVybiBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7Cn0pOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvaXNTY2hlZHVsZXIuanMKZnVuY3Rpb24gaXNTY2hlZHVsZXIodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgJiYgaXNGdW5jdGlvbih2YWx1ZS5zY2hlZHVsZSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2FyZ3MuanMKZnVuY3Rpb24gbGFzdChhcnIpIHsKICByZXR1cm4gYXJyW2Fyci5sZW5ndGggLSAxXTsKfQpmdW5jdGlvbiBwb3BSZXN1bHRTZWxlY3RvcihhcmdzKSB7CiAgcmV0dXJuIGlzRnVuY3Rpb24obGFzdChhcmdzKSkgPyBhcmdzLnBvcCgpIDogdm9pZCAwOwp9CmZ1bmN0aW9uIHBvcFNjaGVkdWxlcihhcmdzKSB7CiAgcmV0dXJuIGlzU2NoZWR1bGVyKGxhc3QoYXJncykpID8gYXJncy5wb3AoKSA6IHZvaWQgMDsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvaXNBcnJheUxpa2UuanMKdmFyIGlzQXJyYXlMaWtlID0gKGZ1bmN0aW9uKHgpIHsKICByZXR1cm4geCAmJiB0eXBlb2YgeC5sZW5ndGggPT09ICJudW1iZXIiICYmIHR5cGVvZiB4ICE9PSAiZnVuY3Rpb24iOwp9KTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2lzUHJvbWlzZS5qcwpmdW5jdGlvbiBpc1Byb21pc2UodmFsdWUpIHsKICByZXR1cm4gaXNGdW5jdGlvbih2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsdWUudGhlbik7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2lzSW50ZXJvcE9ic2VydmFibGUuanMKZnVuY3Rpb24gaXNJbnRlcm9wT2JzZXJ2YWJsZShpbnB1dDIpIHsKICByZXR1cm4gaXNGdW5jdGlvbihpbnB1dDJbb2JzZXJ2YWJsZV0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9pc0FzeW5jSXRlcmFibGUuanMKZnVuY3Rpb24gaXNBc3luY0l0ZXJhYmxlKG9iaikgewogIHJldHVybiBTeW1ib2wuYXN5bmNJdGVyYXRvciAmJiBpc0Z1bmN0aW9uKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9ialtTeW1ib2wuYXN5bmNJdGVyYXRvcl0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC90aHJvd1Vub2JzZXJ2YWJsZUVycm9yLmpzCmZ1bmN0aW9uIGNyZWF0ZUludmFsaWRPYnNlcnZhYmxlVHlwZUVycm9yKGlucHV0MikgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCJZb3UgcHJvdmlkZWQgIiArIChpbnB1dDIgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0MiA9PT0gIm9iamVjdCIgPyAiYW4gaW52YWxpZCBvYmplY3QiIDogIiciICsgaW5wdXQyICsgIiciKSArICIgd2hlcmUgYSBzdHJlYW0gd2FzIGV4cGVjdGVkLiBZb3UgY2FuIHByb3ZpZGUgYW4gT2JzZXJ2YWJsZSwgUHJvbWlzZSwgUmVhZGFibGVTdHJlYW0sIEFycmF5LCBBc3luY0l0ZXJhYmxlLCBvciBJdGVyYWJsZS4iKTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3N5bWJvbC9pdGVyYXRvci5qcwpmdW5jdGlvbiBnZXRTeW1ib2xJdGVyYXRvcigpIHsKICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gImZ1bmN0aW9uIiB8fCAhU3ltYm9sLml0ZXJhdG9yKSB7CiAgICByZXR1cm4gIkBAaXRlcmF0b3IiOwogIH0KICByZXR1cm4gU3ltYm9sLml0ZXJhdG9yOwp9CnZhciBpdGVyYXRvciA9IGdldFN5bWJvbEl0ZXJhdG9yKCk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9pc0l0ZXJhYmxlLmpzCmZ1bmN0aW9uIGlzSXRlcmFibGUoaW5wdXQyKSB7CiAgcmV0dXJuIGlzRnVuY3Rpb24oaW5wdXQyID09PSBudWxsIHx8IGlucHV0MiA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5wdXQyW2l0ZXJhdG9yXSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2lzUmVhZGFibGVTdHJlYW1MaWtlLmpzCmZ1bmN0aW9uIHJlYWRhYmxlU3RyZWFtTGlrZVRvQXN5bmNHZW5lcmF0b3IocmVhZGFibGVTdHJlYW0pIHsKICByZXR1cm4gX19hc3luY0dlbmVyYXRvcih0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIHJlYWRhYmxlU3RyZWFtTGlrZVRvQXN5bmNHZW5lcmF0b3JfMSgpIHsKICAgIHZhciByZWFkZXIsIF9hLCB2YWx1ZSwgZG9uZTsKICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbihfYikgewogICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmVhZGVyID0gcmVhZGFibGVTdHJlYW0uZ2V0UmVhZGVyKCk7CiAgICAgICAgICBfYi5sYWJlbCA9IDE7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCAsIDksIDEwXSk7CiAgICAgICAgICBfYi5sYWJlbCA9IDI7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgaWYgKGZhbHNlKSByZXR1cm4gWzMsIDhdOwogICAgICAgICAgcmV0dXJuIFs0LCBfX2F3YWl0KHJlYWRlci5yZWFkKCkpXTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBfYSA9IF9iLnNlbnQoKSwgdmFsdWUgPSBfYS52YWx1ZSwgZG9uZSA9IF9hLmRvbmU7CiAgICAgICAgICBpZiAoIWRvbmUpIHJldHVybiBbMywgNV07CiAgICAgICAgICByZXR1cm4gWzQsIF9fYXdhaXQodm9pZCAwKV07CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgcmV0dXJuIFsyLCBfYi5zZW50KCldOwogICAgICAgIGNhc2UgNToKICAgICAgICAgIHJldHVybiBbNCwgX19hd2FpdCh2YWx1ZSldOwogICAgICAgIGNhc2UgNjoKICAgICAgICAgIHJldHVybiBbNCwgX2Iuc2VudCgpXTsKICAgICAgICBjYXNlIDc6CiAgICAgICAgICBfYi5zZW50KCk7CiAgICAgICAgICByZXR1cm4gWzMsIDJdOwogICAgICAgIGNhc2UgODoKICAgICAgICAgIHJldHVybiBbMywgMTBdOwogICAgICAgIGNhc2UgOToKICAgICAgICAgIHJlYWRlci5yZWxlYXNlTG9jaygpOwogICAgICAgICAgcmV0dXJuIFs3XTsKICAgICAgICBjYXNlIDEwOgogICAgICAgICAgcmV0dXJuIFsyXTsKICAgICAgfQogICAgfSk7CiAgfSk7Cn0KZnVuY3Rpb24gaXNSZWFkYWJsZVN0cmVhbUxpa2Uob2JqKSB7CiAgcmV0dXJuIGlzRnVuY3Rpb24ob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLmdldFJlYWRlcik7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2lubmVyRnJvbS5qcwpmdW5jdGlvbiBpbm5lckZyb20oaW5wdXQyKSB7CiAgaWYgKGlucHV0MiBpbnN0YW5jZW9mIE9ic2VydmFibGUpIHsKICAgIHJldHVybiBpbnB1dDI7CiAgfQogIGlmIChpbnB1dDIgIT0gbnVsbCkgewogICAgaWYgKGlzSW50ZXJvcE9ic2VydmFibGUoaW5wdXQyKSkgewogICAgICByZXR1cm4gZnJvbUludGVyb3BPYnNlcnZhYmxlKGlucHV0Mik7CiAgICB9CiAgICBpZiAoaXNBcnJheUxpa2UoaW5wdXQyKSkgewogICAgICByZXR1cm4gZnJvbUFycmF5TGlrZShpbnB1dDIpOwogICAgfQogICAgaWYgKGlzUHJvbWlzZShpbnB1dDIpKSB7CiAgICAgIHJldHVybiBmcm9tUHJvbWlzZShpbnB1dDIpOwogICAgfQogICAgaWYgKGlzQXN5bmNJdGVyYWJsZShpbnB1dDIpKSB7CiAgICAgIHJldHVybiBmcm9tQXN5bmNJdGVyYWJsZShpbnB1dDIpOwogICAgfQogICAgaWYgKGlzSXRlcmFibGUoaW5wdXQyKSkgewogICAgICByZXR1cm4gZnJvbUl0ZXJhYmxlKGlucHV0Mik7CiAgICB9CiAgICBpZiAoaXNSZWFkYWJsZVN0cmVhbUxpa2UoaW5wdXQyKSkgewogICAgICByZXR1cm4gZnJvbVJlYWRhYmxlU3RyZWFtTGlrZShpbnB1dDIpOwogICAgfQogIH0KICB0aHJvdyBjcmVhdGVJbnZhbGlkT2JzZXJ2YWJsZVR5cGVFcnJvcihpbnB1dDIpOwp9CmZ1bmN0aW9uIGZyb21JbnRlcm9wT2JzZXJ2YWJsZShvYmopIHsKICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgdmFyIG9icyA9IG9ialtvYnNlcnZhYmxlXSgpOwogICAgaWYgKGlzRnVuY3Rpb24ob2JzLnN1YnNjcmliZSkpIHsKICAgICAgcmV0dXJuIG9icy5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgICB9CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJQcm92aWRlZCBvYmplY3QgZG9lcyBub3QgY29ycmVjdGx5IGltcGxlbWVudCBTeW1ib2wub2JzZXJ2YWJsZSIpOwogIH0pOwp9CmZ1bmN0aW9uIGZyb21BcnJheUxpa2UoYXJyYXkpIHsKICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGggJiYgIXN1YnNjcmliZXIuY2xvc2VkOyBpKyspIHsKICAgICAgc3Vic2NyaWJlci5uZXh0KGFycmF5W2ldKTsKICAgIH0KICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICB9KTsKfQpmdW5jdGlvbiBmcm9tUHJvbWlzZShwcm9taXNlKSB7CiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkgewogICAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7CiAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICAgIH0KICAgIH0sIGZ1bmN0aW9uKGVycikgewogICAgICByZXR1cm4gc3Vic2NyaWJlci5lcnJvcihlcnIpOwogICAgfSkudGhlbihudWxsLCByZXBvcnRVbmhhbmRsZWRFcnJvcik7CiAgfSk7Cn0KZnVuY3Rpb24gZnJvbUl0ZXJhYmxlKGl0ZXJhYmxlKSB7CiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIHZhciBlXzEsIF9hOwogICAgdHJ5IHsKICAgICAgZm9yICh2YXIgaXRlcmFibGVfMSA9IF9fdmFsdWVzKGl0ZXJhYmxlKSwgaXRlcmFibGVfMV8xID0gaXRlcmFibGVfMS5uZXh0KCk7ICFpdGVyYWJsZV8xXzEuZG9uZTsgaXRlcmFibGVfMV8xID0gaXRlcmFibGVfMS5uZXh0KCkpIHsKICAgICAgICB2YXIgdmFsdWUgPSBpdGVyYWJsZV8xXzEudmFsdWU7CiAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgICBpZiAoc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVfMV8xKSB7CiAgICAgIGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07CiAgICB9IGZpbmFsbHkgewogICAgICB0cnkgewogICAgICAgIGlmIChpdGVyYWJsZV8xXzEgJiYgIWl0ZXJhYmxlXzFfMS5kb25lICYmIChfYSA9IGl0ZXJhYmxlXzEucmV0dXJuKSkgX2EuY2FsbChpdGVyYWJsZV8xKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7CiAgICAgIH0KICAgIH0KICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICB9KTsKfQpmdW5jdGlvbiBmcm9tQXN5bmNJdGVyYWJsZShhc3luY0l0ZXJhYmxlKSB7CiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIHByb2Nlc3MoYXN5bmNJdGVyYWJsZSwgc3Vic2NyaWJlcikuY2F0Y2goZnVuY3Rpb24oZXJyKSB7CiAgICAgIHJldHVybiBzdWJzY3JpYmVyLmVycm9yKGVycik7CiAgICB9KTsKICB9KTsKfQpmdW5jdGlvbiBmcm9tUmVhZGFibGVTdHJlYW1MaWtlKHJlYWRhYmxlU3RyZWFtKSB7CiAgcmV0dXJuIGZyb21Bc3luY0l0ZXJhYmxlKHJlYWRhYmxlU3RyZWFtTGlrZVRvQXN5bmNHZW5lcmF0b3IocmVhZGFibGVTdHJlYW0pKTsKfQpmdW5jdGlvbiBwcm9jZXNzKGFzeW5jSXRlcmFibGUsIHN1YnNjcmliZXIpIHsKICB2YXIgYXN5bmNJdGVyYWJsZV8xLCBhc3luY0l0ZXJhYmxlXzFfMTsKICB2YXIgZV8yLCBfYTsKICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbigpIHsKICAgIHZhciB2YWx1ZSwgZV8yXzE7CiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24oX2IpIHsKICAgICAgc3dpdGNoIChfYi5sYWJlbCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIF9iLnRyeXMucHVzaChbMCwgNSwgNiwgMTFdKTsKICAgICAgICAgIGFzeW5jSXRlcmFibGVfMSA9IF9fYXN5bmNWYWx1ZXMoYXN5bmNJdGVyYWJsZSk7CiAgICAgICAgICBfYi5sYWJlbCA9IDE7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgcmV0dXJuIFs0LCBhc3luY0l0ZXJhYmxlXzEubmV4dCgpXTsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBpZiAoIShhc3luY0l0ZXJhYmxlXzFfMSA9IF9iLnNlbnQoKSwgIWFzeW5jSXRlcmFibGVfMV8xLmRvbmUpKSByZXR1cm4gWzMsIDRdOwogICAgICAgICAgdmFsdWUgPSBhc3luY0l0ZXJhYmxlXzFfMS52YWx1ZTsKICAgICAgICAgIHN1YnNjcmliZXIubmV4dCh2YWx1ZSk7CiAgICAgICAgICBpZiAoc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICAgICAgcmV0dXJuIFsyXTsKICAgICAgICAgIH0KICAgICAgICAgIF9iLmxhYmVsID0gMzsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICByZXR1cm4gWzMsIDFdOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHJldHVybiBbMywgMTFdOwogICAgICAgIGNhc2UgNToKICAgICAgICAgIGVfMl8xID0gX2Iuc2VudCgpOwogICAgICAgICAgZV8yID0geyBlcnJvcjogZV8yXzEgfTsKICAgICAgICAgIHJldHVybiBbMywgMTFdOwogICAgICAgIGNhc2UgNjoKICAgICAgICAgIF9iLnRyeXMucHVzaChbNiwgLCA5LCAxMF0pOwogICAgICAgICAgaWYgKCEoYXN5bmNJdGVyYWJsZV8xXzEgJiYgIWFzeW5jSXRlcmFibGVfMV8xLmRvbmUgJiYgKF9hID0gYXN5bmNJdGVyYWJsZV8xLnJldHVybikpKSByZXR1cm4gWzMsIDhdOwogICAgICAgICAgcmV0dXJuIFs0LCBfYS5jYWxsKGFzeW5jSXRlcmFibGVfMSldOwogICAgICAgIGNhc2UgNzoKICAgICAgICAgIF9iLnNlbnQoKTsKICAgICAgICAgIF9iLmxhYmVsID0gODsKICAgICAgICBjYXNlIDg6CiAgICAgICAgICByZXR1cm4gWzMsIDEwXTsKICAgICAgICBjYXNlIDk6CiAgICAgICAgICBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7CiAgICAgICAgICByZXR1cm4gWzddOwogICAgICAgIGNhc2UgMTA6CiAgICAgICAgICByZXR1cm4gWzddOwogICAgICAgIGNhc2UgMTE6CiAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICAgICAgICByZXR1cm4gWzJdOwogICAgICB9CiAgICB9KTsKICB9KTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvZXhlY3V0ZVNjaGVkdWxlLmpzCmZ1bmN0aW9uIGV4ZWN1dGVTY2hlZHVsZShwYXJlbnRTdWJzY3JpcHRpb24sIHNjaGVkdWxlciwgd29yaywgZGVsYXkyLCByZXBlYXQyKSB7CiAgaWYgKGRlbGF5MiA9PT0gdm9pZCAwKSB7CiAgICBkZWxheTIgPSAwOwogIH0KICBpZiAocmVwZWF0MiA9PT0gdm9pZCAwKSB7CiAgICByZXBlYXQyID0gZmFsc2U7CiAgfQogIHZhciBzY2hlZHVsZVN1YnNjcmlwdGlvbiA9IHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbigpIHsKICAgIHdvcmsoKTsKICAgIGlmIChyZXBlYXQyKSB7CiAgICAgIHBhcmVudFN1YnNjcmlwdGlvbi5hZGQodGhpcy5zY2hlZHVsZShudWxsLCBkZWxheTIpKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgIH0KICB9LCBkZWxheTIpOwogIHBhcmVudFN1YnNjcmlwdGlvbi5hZGQoc2NoZWR1bGVTdWJzY3JpcHRpb24pOwogIGlmICghcmVwZWF0MikgewogICAgcmV0dXJuIHNjaGVkdWxlU3Vic2NyaXB0aW9uOwogIH0KfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9vYnNlcnZlT24uanMKZnVuY3Rpb24gb2JzZXJ2ZU9uKHNjaGVkdWxlciwgZGVsYXkyKSB7CiAgaWYgKGRlbGF5MiA9PT0gdm9pZCAwKSB7CiAgICBkZWxheTIgPSAwOwogIH0KICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIHNvdXJjZS5zdWJzY3JpYmUoY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKHN1YnNjcmliZXIsIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHJldHVybiBleGVjdXRlU2NoZWR1bGUoc3Vic2NyaWJlciwgc2NoZWR1bGVyLCBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgfSwgZGVsYXkyKTsKICAgIH0sIGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gZXhlY3V0ZVNjaGVkdWxlKHN1YnNjcmliZXIsIHNjaGVkdWxlciwgZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgfSwgZGVsYXkyKTsKICAgIH0sIGZ1bmN0aW9uKGVycikgewogICAgICByZXR1cm4gZXhlY3V0ZVNjaGVkdWxlKHN1YnNjcmliZXIsIHNjaGVkdWxlciwgZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHN1YnNjcmliZXIuZXJyb3IoZXJyKTsKICAgICAgfSwgZGVsYXkyKTsKICAgIH0pKTsKICB9KTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9zdWJzY3JpYmVPbi5qcwpmdW5jdGlvbiBzdWJzY3JpYmVPbihzY2hlZHVsZXIsIGRlbGF5MikgewogIGlmIChkZWxheTIgPT09IHZvaWQgMCkgewogICAgZGVsYXkyID0gMDsKICB9CiAgcmV0dXJuIG9wZXJhdGUoZnVuY3Rpb24oc291cmNlLCBzdWJzY3JpYmVyKSB7CiAgICBzdWJzY3JpYmVyLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKHN1YnNjcmliZXIpOwogICAgfSwgZGVsYXkyKSk7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZWQvc2NoZWR1bGVPYnNlcnZhYmxlLmpzCmZ1bmN0aW9uIHNjaGVkdWxlT2JzZXJ2YWJsZShpbnB1dDIsIHNjaGVkdWxlcikgewogIHJldHVybiBpbm5lckZyb20oaW5wdXQyKS5waXBlKHN1YnNjcmliZU9uKHNjaGVkdWxlciksIG9ic2VydmVPbihzY2hlZHVsZXIpKTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3NjaGVkdWxlZC9zY2hlZHVsZVByb21pc2UuanMKZnVuY3Rpb24gc2NoZWR1bGVQcm9taXNlKGlucHV0Miwgc2NoZWR1bGVyKSB7CiAgcmV0dXJuIGlubmVyRnJvbShpbnB1dDIpLnBpcGUoc3Vic2NyaWJlT24oc2NoZWR1bGVyKSwgb2JzZXJ2ZU9uKHNjaGVkdWxlcikpOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVkL3NjaGVkdWxlQXJyYXkuanMKZnVuY3Rpb24gc2NoZWR1bGVBcnJheShpbnB1dDIsIHNjaGVkdWxlcikgewogIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICB2YXIgaSA9IDA7CiAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uKCkgewogICAgICBpZiAoaSA9PT0gaW5wdXQyLmxlbmd0aCkgewogICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdWJzY3JpYmVyLm5leHQoaW5wdXQyW2krK10pOwogICAgICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICAgIHRoaXMuc2NoZWR1bGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVkL3NjaGVkdWxlSXRlcmFibGUuanMKZnVuY3Rpb24gc2NoZWR1bGVJdGVyYWJsZShpbnB1dDIsIHNjaGVkdWxlcikgewogIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICB2YXIgaXRlcmF0b3IyOwogICAgZXhlY3V0ZVNjaGVkdWxlKHN1YnNjcmliZXIsIHNjaGVkdWxlciwgZnVuY3Rpb24oKSB7CiAgICAgIGl0ZXJhdG9yMiA9IGlucHV0MltpdGVyYXRvcl0oKTsKICAgICAgZXhlY3V0ZVNjaGVkdWxlKHN1YnNjcmliZXIsIHNjaGVkdWxlciwgZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHZhciB2YWx1ZTsKICAgICAgICB2YXIgZG9uZTsKICAgICAgICB0cnkgewogICAgICAgICAgX2EgPSBpdGVyYXRvcjIubmV4dCgpLCB2YWx1ZSA9IF9hLnZhbHVlLCBkb25lID0gX2EuZG9uZTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGRvbmUpIHsKICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0sIDAsIHRydWUpOwogICAgfSk7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBpc0Z1bmN0aW9uKGl0ZXJhdG9yMiA9PT0gbnVsbCB8fCBpdGVyYXRvcjIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGl0ZXJhdG9yMi5yZXR1cm4pICYmIGl0ZXJhdG9yMi5yZXR1cm4oKTsKICAgIH07CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZWQvc2NoZWR1bGVBc3luY0l0ZXJhYmxlLmpzCmZ1bmN0aW9uIHNjaGVkdWxlQXN5bmNJdGVyYWJsZShpbnB1dDIsIHNjaGVkdWxlcikgewogIGlmICghaW5wdXQyKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkl0ZXJhYmxlIGNhbm5vdCBiZSBudWxsIik7CiAgfQogIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICBleGVjdXRlU2NoZWR1bGUoc3Vic2NyaWJlciwgc2NoZWR1bGVyLCBmdW5jdGlvbigpIHsKICAgICAgdmFyIGl0ZXJhdG9yMiA9IGlucHV0MltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKTsKICAgICAgZXhlY3V0ZVNjaGVkdWxlKHN1YnNjcmliZXIsIHNjaGVkdWxlciwgZnVuY3Rpb24oKSB7CiAgICAgICAgaXRlcmF0b3IyLm5leHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkgewogICAgICAgICAgaWYgKHJlc3VsdC5kb25lKSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChyZXN1bHQudmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LCAwLCB0cnVlKTsKICAgIH0pOwogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVkL3NjaGVkdWxlUmVhZGFibGVTdHJlYW1MaWtlLmpzCmZ1bmN0aW9uIHNjaGVkdWxlUmVhZGFibGVTdHJlYW1MaWtlKGlucHV0Miwgc2NoZWR1bGVyKSB7CiAgcmV0dXJuIHNjaGVkdWxlQXN5bmNJdGVyYWJsZShyZWFkYWJsZVN0cmVhbUxpa2VUb0FzeW5jR2VuZXJhdG9yKGlucHV0MiksIHNjaGVkdWxlcik7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9zY2hlZHVsZWQvc2NoZWR1bGVkLmpzCmZ1bmN0aW9uIHNjaGVkdWxlZChpbnB1dDIsIHNjaGVkdWxlcikgewogIGlmIChpbnB1dDIgIT0gbnVsbCkgewogICAgaWYgKGlzSW50ZXJvcE9ic2VydmFibGUoaW5wdXQyKSkgewogICAgICByZXR1cm4gc2NoZWR1bGVPYnNlcnZhYmxlKGlucHV0Miwgc2NoZWR1bGVyKTsKICAgIH0KICAgIGlmIChpc0FycmF5TGlrZShpbnB1dDIpKSB7CiAgICAgIHJldHVybiBzY2hlZHVsZUFycmF5KGlucHV0Miwgc2NoZWR1bGVyKTsKICAgIH0KICAgIGlmIChpc1Byb21pc2UoaW5wdXQyKSkgewogICAgICByZXR1cm4gc2NoZWR1bGVQcm9taXNlKGlucHV0Miwgc2NoZWR1bGVyKTsKICAgIH0KICAgIGlmIChpc0FzeW5jSXRlcmFibGUoaW5wdXQyKSkgewogICAgICByZXR1cm4gc2NoZWR1bGVBc3luY0l0ZXJhYmxlKGlucHV0Miwgc2NoZWR1bGVyKTsKICAgIH0KICAgIGlmIChpc0l0ZXJhYmxlKGlucHV0MikpIHsKICAgICAgcmV0dXJuIHNjaGVkdWxlSXRlcmFibGUoaW5wdXQyLCBzY2hlZHVsZXIpOwogICAgfQogICAgaWYgKGlzUmVhZGFibGVTdHJlYW1MaWtlKGlucHV0MikpIHsKICAgICAgcmV0dXJuIHNjaGVkdWxlUmVhZGFibGVTdHJlYW1MaWtlKGlucHV0Miwgc2NoZWR1bGVyKTsKICAgIH0KICB9CiAgdGhyb3cgY3JlYXRlSW52YWxpZE9ic2VydmFibGVUeXBlRXJyb3IoaW5wdXQyKTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29ic2VydmFibGUvZnJvbS5qcwpmdW5jdGlvbiBmcm9tKGlucHV0Miwgc2NoZWR1bGVyKSB7CiAgcmV0dXJuIHNjaGVkdWxlciA/IHNjaGVkdWxlZChpbnB1dDIsIHNjaGVkdWxlcikgOiBpbm5lckZyb20oaW5wdXQyKTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29ic2VydmFibGUvb2YuanMKZnVuY3Rpb24gb2YoKSB7CiAgdmFyIGFyZ3MgPSBbXTsKICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldOwogIH0KICB2YXIgc2NoZWR1bGVyID0gcG9wU2NoZWR1bGVyKGFyZ3MpOwogIHJldHVybiBmcm9tKGFyZ3MsIHNjaGVkdWxlcik7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL3Rocm93RXJyb3IuanMKZnVuY3Rpb24gdGhyb3dFcnJvcihlcnJvck9yRXJyb3JGYWN0b3J5LCBzY2hlZHVsZXIpIHsKICB2YXIgZXJyb3JGYWN0b3J5ID0gaXNGdW5jdGlvbihlcnJvck9yRXJyb3JGYWN0b3J5KSA/IGVycm9yT3JFcnJvckZhY3RvcnkgOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBlcnJvck9yRXJyb3JGYWN0b3J5OwogIH07CiAgdmFyIGluaXQgPSBmdW5jdGlvbihzdWJzY3JpYmVyKSB7CiAgICByZXR1cm4gc3Vic2NyaWJlci5lcnJvcihlcnJvckZhY3RvcnkoKSk7CiAgfTsKICByZXR1cm4gbmV3IE9ic2VydmFibGUoc2NoZWR1bGVyID8gZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShpbml0LCAwLCBzdWJzY3JpYmVyKTsKICB9IDogaW5pdCk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9Ob3RpZmljYXRpb24uanMKdmFyIE5vdGlmaWNhdGlvbktpbmQ7CihmdW5jdGlvbihOb3RpZmljYXRpb25LaW5kMikgewogIE5vdGlmaWNhdGlvbktpbmQyWyJORVhUIl0gPSAiTiI7CiAgTm90aWZpY2F0aW9uS2luZDJbIkVSUk9SIl0gPSAiRSI7CiAgTm90aWZpY2F0aW9uS2luZDJbIkNPTVBMRVRFIl0gPSAiQyI7Cn0pKE5vdGlmaWNhdGlvbktpbmQgfHwgKE5vdGlmaWNhdGlvbktpbmQgPSB7fSkpOwp2YXIgTm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uKCkgewogIGZ1bmN0aW9uIE5vdGlmaWNhdGlvbjIoa2luZCwgdmFsdWUsIGVycm9yKSB7CiAgICB0aGlzLmtpbmQgPSBraW5kOwogICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgdGhpcy5lcnJvciA9IGVycm9yOwogICAgdGhpcy5oYXNWYWx1ZSA9IGtpbmQgPT09ICJOIjsKICB9CiAgTm90aWZpY2F0aW9uMi5wcm90b3R5cGUub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9ic2VydmVyKSB7CiAgICByZXR1cm4gb2JzZXJ2ZU5vdGlmaWNhdGlvbih0aGlzLCBvYnNlcnZlcik7CiAgfTsKICBOb3RpZmljYXRpb24yLnByb3RvdHlwZS5kbyA9IGZ1bmN0aW9uKG5leHRIYW5kbGVyLCBlcnJvckhhbmRsZXIsIGNvbXBsZXRlSGFuZGxlcikgewogICAgdmFyIF9hID0gdGhpcywga2luZCA9IF9hLmtpbmQsIHZhbHVlID0gX2EudmFsdWUsIGVycm9yID0gX2EuZXJyb3I7CiAgICByZXR1cm4ga2luZCA9PT0gIk4iID8gbmV4dEhhbmRsZXIgPT09IG51bGwgfHwgbmV4dEhhbmRsZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5leHRIYW5kbGVyKHZhbHVlKSA6IGtpbmQgPT09ICJFIiA/IGVycm9ySGFuZGxlciA9PT0gbnVsbCB8fCBlcnJvckhhbmRsZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVycm9ySGFuZGxlcihlcnJvcikgOiBjb21wbGV0ZUhhbmRsZXIgPT09IG51bGwgfHwgY29tcGxldGVIYW5kbGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb21wbGV0ZUhhbmRsZXIoKTsKICB9OwogIE5vdGlmaWNhdGlvbjIucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHsKICAgIHZhciBfYTsKICAgIHJldHVybiBpc0Z1bmN0aW9uKChfYSA9IG5leHRPck9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubmV4dCkgPyB0aGlzLm9ic2VydmUobmV4dE9yT2JzZXJ2ZXIpIDogdGhpcy5kbyhuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKTsKICB9OwogIE5vdGlmaWNhdGlvbjIucHJvdG90eXBlLnRvT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIF9hID0gdGhpcywga2luZCA9IF9hLmtpbmQsIHZhbHVlID0gX2EudmFsdWUsIGVycm9yID0gX2EuZXJyb3I7CiAgICB2YXIgcmVzdWx0ID0ga2luZCA9PT0gIk4iID8gb2YodmFsdWUpIDoga2luZCA9PT0gIkUiID8gdGhyb3dFcnJvcihmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGVycm9yOwogICAgfSkgOiBraW5kID09PSAiQyIgPyBFTVBUWSA6IDA7CiAgICBpZiAoIXJlc3VsdCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmV4cGVjdGVkIG5vdGlmaWNhdGlvbiBraW5kICIgKyBraW5kKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfTsKICBOb3RpZmljYXRpb24yLmNyZWF0ZU5leHQgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIG5ldyBOb3RpZmljYXRpb24yKCJOIiwgdmFsdWUpOwogIH07CiAgTm90aWZpY2F0aW9uMi5jcmVhdGVFcnJvciA9IGZ1bmN0aW9uKGVycikgewogICAgcmV0dXJuIG5ldyBOb3RpZmljYXRpb24yKCJFIiwgdm9pZCAwLCBlcnIpOwogIH07CiAgTm90aWZpY2F0aW9uMi5jcmVhdGVDb21wbGV0ZSA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIE5vdGlmaWNhdGlvbjIuY29tcGxldGVOb3RpZmljYXRpb247CiAgfTsKICBOb3RpZmljYXRpb24yLmNvbXBsZXRlTm90aWZpY2F0aW9uID0gbmV3IE5vdGlmaWNhdGlvbjIoIkMiKTsKICByZXR1cm4gTm90aWZpY2F0aW9uMjsKfSkoKTsKZnVuY3Rpb24gb2JzZXJ2ZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIG9ic2VydmVyKSB7CiAgdmFyIF9hLCBfYiwgX2M7CiAgdmFyIF9kID0gbm90aWZpY2F0aW9uLCBraW5kID0gX2Qua2luZCwgdmFsdWUgPSBfZC52YWx1ZSwgZXJyb3IgPSBfZC5lcnJvcjsKICBpZiAodHlwZW9mIGtpbmQgIT09ICJzdHJpbmciKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIG5vdGlmaWNhdGlvbiwgbWlzc2luZyAia2luZCInKTsKICB9CiAga2luZCA9PT0gIk4iID8gKF9hID0gb2JzZXJ2ZXIubmV4dCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGwob2JzZXJ2ZXIsIHZhbHVlKSA6IGtpbmQgPT09ICJFIiA/IChfYiA9IG9ic2VydmVyLmVycm9yKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChvYnNlcnZlciwgZXJyb3IpIDogKF9jID0gb2JzZXJ2ZXIuY29tcGxldGUpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jYWxsKG9ic2VydmVyKTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvaXNPYnNlcnZhYmxlLmpzCmZ1bmN0aW9uIGlzT2JzZXJ2YWJsZShvYmopIHsKICByZXR1cm4gISFvYmogJiYgKG9iaiBpbnN0YW5jZW9mIE9ic2VydmFibGUgfHwgaXNGdW5jdGlvbihvYmoubGlmdCkgJiYgaXNGdW5jdGlvbihvYmouc3Vic2NyaWJlKSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL0VtcHR5RXJyb3IuanMKdmFyIEVtcHR5RXJyb3IgPSBjcmVhdGVFcnJvckNsYXNzKGZ1bmN0aW9uKF9zdXBlcikgewogIHJldHVybiBmdW5jdGlvbiBFbXB0eUVycm9ySW1wbCgpIHsKICAgIF9zdXBlcih0aGlzKTsKICAgIHRoaXMubmFtZSA9ICJFbXB0eUVycm9yIjsKICAgIHRoaXMubWVzc2FnZSA9ICJubyBlbGVtZW50cyBpbiBzZXF1ZW5jZSI7CiAgfTsKfSk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9Bcmd1bWVudE91dE9mUmFuZ2VFcnJvci5qcwp2YXIgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IgPSBjcmVhdGVFcnJvckNsYXNzKGZ1bmN0aW9uKF9zdXBlcikgewogIHJldHVybiBmdW5jdGlvbiBBcmd1bWVudE91dE9mUmFuZ2VFcnJvckltcGwoKSB7CiAgICBfc3VwZXIodGhpcyk7CiAgICB0aGlzLm5hbWUgPSAiQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IiOwogICAgdGhpcy5tZXNzYWdlID0gImFyZ3VtZW50IG91dCBvZiByYW5nZSI7CiAgfTsKfSk7CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvdXRpbC9Ob3RGb3VuZEVycm9yLmpzCnZhciBOb3RGb3VuZEVycm9yID0gY3JlYXRlRXJyb3JDbGFzcyhmdW5jdGlvbihfc3VwZXIpIHsKICByZXR1cm4gZnVuY3Rpb24gTm90Rm91bmRFcnJvckltcGwobWVzc2FnZSkgewogICAgX3N1cGVyKHRoaXMpOwogICAgdGhpcy5uYW1lID0gIk5vdEZvdW5kRXJyb3IiOwogICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKICB9Owp9KTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL1NlcXVlbmNlRXJyb3IuanMKdmFyIFNlcXVlbmNlRXJyb3IgPSBjcmVhdGVFcnJvckNsYXNzKGZ1bmN0aW9uKF9zdXBlcikgewogIHJldHVybiBmdW5jdGlvbiBTZXF1ZW5jZUVycm9ySW1wbChtZXNzYWdlKSB7CiAgICBfc3VwZXIodGhpcyk7CiAgICB0aGlzLm5hbWUgPSAiU2VxdWVuY2VFcnJvciI7CiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogIH07Cn0pOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy90aW1lb3V0LmpzCnZhciBUaW1lb3V0RXJyb3IgPSBjcmVhdGVFcnJvckNsYXNzKGZ1bmN0aW9uKF9zdXBlcikgewogIHJldHVybiBmdW5jdGlvbiBUaW1lb3V0RXJyb3JJbXBsKGluZm8pIHsKICAgIGlmIChpbmZvID09PSB2b2lkIDApIHsKICAgICAgaW5mbyA9IG51bGw7CiAgICB9CiAgICBfc3VwZXIodGhpcyk7CiAgICB0aGlzLm1lc3NhZ2UgPSAiVGltZW91dCBoYXMgb2NjdXJyZWQiOwogICAgdGhpcy5uYW1lID0gIlRpbWVvdXRFcnJvciI7CiAgICB0aGlzLmluZm8gPSBpbmZvOwogIH07Cn0pOwoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9tYXAuanMKZnVuY3Rpb24gbWFwKHByb2plY3QsIHRoaXNBcmcpIHsKICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIHZhciBpbmRleCA9IDA7CiAgICBzb3VyY2Uuc3Vic2NyaWJlKGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBmdW5jdGlvbih2YWx1ZSkgewogICAgICBzdWJzY3JpYmVyLm5leHQocHJvamVjdC5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCsrKSk7CiAgICB9KSk7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL21hcE9uZU9yTWFueUFyZ3MuanMKdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5OwpmdW5jdGlvbiBjYWxsT3JBcHBseShmbiwgYXJncykgewogIHJldHVybiBpc0FycmF5KGFyZ3MpID8gZm4uYXBwbHkodm9pZCAwLCBfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQoYXJncykpKSA6IGZuKGFyZ3MpOwp9CmZ1bmN0aW9uIG1hcE9uZU9yTWFueUFyZ3MoZm4pIHsKICByZXR1cm4gbWFwKGZ1bmN0aW9uKGFyZ3MpIHsKICAgIHJldHVybiBjYWxsT3JBcHBseShmbiwgYXJncyk7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC91dGlsL2FyZ3NBcmdBcnJheU9yT2JqZWN0LmpzCnZhciBpc0FycmF5MiA9IEFycmF5LmlzQXJyYXk7CnZhciBnZXRQcm90b3R5cGVPZiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjsKdmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTsKdmFyIGdldEtleXMgPSBPYmplY3Qua2V5czsKZnVuY3Rpb24gYXJnc0FyZ0FycmF5T3JPYmplY3QoYXJncykgewogIGlmIChhcmdzLmxlbmd0aCA9PT0gMSkgewogICAgdmFyIGZpcnN0XzEgPSBhcmdzWzBdOwogICAgaWYgKGlzQXJyYXkyKGZpcnN0XzEpKSB7CiAgICAgIHJldHVybiB7IGFyZ3M6IGZpcnN0XzEsIGtleXM6IG51bGwgfTsKICAgIH0KICAgIGlmIChpc1BPSk8oZmlyc3RfMSkpIHsKICAgICAgdmFyIGtleXMgPSBnZXRLZXlzKGZpcnN0XzEpOwogICAgICByZXR1cm4gewogICAgICAgIGFyZ3M6IGtleXMubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuIGZpcnN0XzFba2V5XTsKICAgICAgICB9KSwKICAgICAgICBrZXlzCiAgICAgIH07CiAgICB9CiAgfQogIHJldHVybiB7IGFyZ3MsIGtleXM6IG51bGwgfTsKfQpmdW5jdGlvbiBpc1BPSk8ob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2Ygb2JqID09PSAib2JqZWN0IiAmJiBnZXRQcm90b3R5cGVPZihvYmopID09PSBvYmplY3RQcm90bzsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL3V0aWwvY3JlYXRlT2JqZWN0LmpzCmZ1bmN0aW9uIGNyZWF0ZU9iamVjdChrZXlzLCB2YWx1ZXMpIHsKICByZXR1cm4ga2V5cy5yZWR1Y2UoZnVuY3Rpb24ocmVzdWx0LCBrZXksIGkpIHsKICAgIHJldHVybiByZXN1bHRba2V5XSA9IHZhbHVlc1tpXSwgcmVzdWx0OwogIH0sIHt9KTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29ic2VydmFibGUvY29tYmluZUxhdGVzdC5qcwpmdW5jdGlvbiBjb21iaW5lTGF0ZXN0KCkgewogIHZhciBhcmdzID0gW107CiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTsKICB9CiAgdmFyIHNjaGVkdWxlciA9IHBvcFNjaGVkdWxlcihhcmdzKTsKICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBwb3BSZXN1bHRTZWxlY3RvcihhcmdzKTsKICB2YXIgX2EgPSBhcmdzQXJnQXJyYXlPck9iamVjdChhcmdzKSwgb2JzZXJ2YWJsZXMgPSBfYS5hcmdzLCBrZXlzID0gX2Eua2V5czsKICBpZiAob2JzZXJ2YWJsZXMubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gZnJvbShbXSwgc2NoZWR1bGVyKTsKICB9CiAgdmFyIHJlc3VsdCA9IG5ldyBPYnNlcnZhYmxlKGNvbWJpbmVMYXRlc3RJbml0KG9ic2VydmFibGVzLCBzY2hlZHVsZXIsIGtleXMgPyBmdW5jdGlvbih2YWx1ZXMpIHsKICAgIHJldHVybiBjcmVhdGVPYmplY3Qoa2V5cywgdmFsdWVzKTsKICB9IDogaWRlbnRpdHkpKTsKICByZXR1cm4gcmVzdWx0U2VsZWN0b3IgPyByZXN1bHQucGlwZShtYXBPbmVPck1hbnlBcmdzKHJlc3VsdFNlbGVjdG9yKSkgOiByZXN1bHQ7Cn0KZnVuY3Rpb24gY29tYmluZUxhdGVzdEluaXQob2JzZXJ2YWJsZXMsIHNjaGVkdWxlciwgdmFsdWVUcmFuc2Zvcm0pIHsKICBpZiAodmFsdWVUcmFuc2Zvcm0gPT09IHZvaWQgMCkgewogICAgdmFsdWVUcmFuc2Zvcm0gPSBpZGVudGl0eTsKICB9CiAgcmV0dXJuIGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIG1heWJlU2NoZWR1bGUoc2NoZWR1bGVyLCBmdW5jdGlvbigpIHsKICAgICAgdmFyIGxlbmd0aCA9IG9ic2VydmFibGVzLmxlbmd0aDsKICAgICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpOwogICAgICB2YXIgYWN0aXZlID0gbGVuZ3RoOwogICAgICB2YXIgcmVtYWluaW5nRmlyc3RWYWx1ZXMgPSBsZW5ndGg7CiAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24oaTIpIHsKICAgICAgICBtYXliZVNjaGVkdWxlKHNjaGVkdWxlciwgZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc291cmNlID0gZnJvbShvYnNlcnZhYmxlc1tpMl0sIHNjaGVkdWxlcik7CiAgICAgICAgICB2YXIgaGFzRmlyc3RWYWx1ZSA9IGZhbHNlOwogICAgICAgICAgc291cmNlLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgdmFsdWVzW2kyXSA9IHZhbHVlOwogICAgICAgICAgICBpZiAoIWhhc0ZpcnN0VmFsdWUpIHsKICAgICAgICAgICAgICBoYXNGaXJzdFZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgICByZW1haW5pbmdGaXJzdFZhbHVlcy0tOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghcmVtYWluaW5nRmlyc3RWYWx1ZXMpIHsKICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWVUcmFuc2Zvcm0odmFsdWVzLnNsaWNlKCkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmICghLS1hY3RpdmUpIHsKICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKTsKICAgICAgICB9LCBzdWJzY3JpYmVyKTsKICAgICAgfTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIF9sb29wXzEoaSk7CiAgICAgIH0KICAgIH0sIHN1YnNjcmliZXIpOwogIH07Cn0KZnVuY3Rpb24gbWF5YmVTY2hlZHVsZShzY2hlZHVsZXIsIGV4ZWN1dGUsIHN1YnNjcmlwdGlvbikgewogIGlmIChzY2hlZHVsZXIpIHsKICAgIGV4ZWN1dGVTY2hlZHVsZShzdWJzY3JpcHRpb24sIHNjaGVkdWxlciwgZXhlY3V0ZSk7CiAgfSBlbHNlIHsKICAgIGV4ZWN1dGUoKTsKICB9Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvbWVyZ2VJbnRlcm5hbHMuanMKZnVuY3Rpb24gbWVyZ2VJbnRlcm5hbHMoc291cmNlLCBzdWJzY3JpYmVyLCBwcm9qZWN0LCBjb25jdXJyZW50LCBvbkJlZm9yZU5leHQsIGV4cGFuZDIsIGlubmVyU3ViU2NoZWR1bGVyLCBhZGRpdGlvbmFsRmluYWxpemVyKSB7CiAgdmFyIGJ1ZmZlcjIgPSBbXTsKICB2YXIgYWN0aXZlID0gMDsKICB2YXIgaW5kZXggPSAwOwogIHZhciBpc0NvbXBsZXRlID0gZmFsc2U7CiAgdmFyIGNoZWNrQ29tcGxldGUgPSBmdW5jdGlvbigpIHsKICAgIGlmIChpc0NvbXBsZXRlICYmICFidWZmZXIyLmxlbmd0aCAmJiAhYWN0aXZlKSB7CiAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgIH0KICB9OwogIHZhciBvdXRlck5leHQgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGFjdGl2ZSA8IGNvbmN1cnJlbnQgPyBkb0lubmVyU3ViKHZhbHVlKSA6IGJ1ZmZlcjIucHVzaCh2YWx1ZSk7CiAgfTsKICB2YXIgZG9Jbm5lclN1YiA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICBleHBhbmQyICYmIHN1YnNjcmliZXIubmV4dCh2YWx1ZSk7CiAgICBhY3RpdmUrKzsKICAgIHZhciBpbm5lckNvbXBsZXRlID0gZmFsc2U7CiAgICBpbm5lckZyb20ocHJvamVjdCh2YWx1ZSwgaW5kZXgrKykpLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24oaW5uZXJWYWx1ZSkgewogICAgICBvbkJlZm9yZU5leHQgPT09IG51bGwgfHwgb25CZWZvcmVOZXh0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvbkJlZm9yZU5leHQoaW5uZXJWYWx1ZSk7CiAgICAgIGlmIChleHBhbmQyKSB7CiAgICAgICAgb3V0ZXJOZXh0KGlubmVyVmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHN1YnNjcmliZXIubmV4dChpbm5lclZhbHVlKTsKICAgICAgfQogICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgIGlubmVyQ29tcGxldGUgPSB0cnVlOwogICAgfSwgdm9pZCAwLCBmdW5jdGlvbigpIHsKICAgICAgaWYgKGlubmVyQ29tcGxldGUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgYWN0aXZlLS07CiAgICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgYnVmZmVyZWRWYWx1ZSA9IGJ1ZmZlcjIuc2hpZnQoKTsKICAgICAgICAgICAgaWYgKGlubmVyU3ViU2NoZWR1bGVyKSB7CiAgICAgICAgICAgICAgZXhlY3V0ZVNjaGVkdWxlKHN1YnNjcmliZXIsIGlubmVyU3ViU2NoZWR1bGVyLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkb0lubmVyU3ViKGJ1ZmZlcmVkVmFsdWUpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGRvSW5uZXJTdWIoYnVmZmVyZWRWYWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICB3aGlsZSAoYnVmZmVyMi5sZW5ndGggJiYgYWN0aXZlIDwgY29uY3VycmVudCkgewogICAgICAgICAgICBfbG9vcF8xKCk7CiAgICAgICAgICB9CiAgICAgICAgICBjaGVja0NvbXBsZXRlKCk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGVycik7CiAgICAgICAgfQogICAgICB9CiAgICB9KSk7CiAgfTsKICBzb3VyY2Uuc3Vic2NyaWJlKGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBvdXRlck5leHQsIGZ1bmN0aW9uKCkgewogICAgaXNDb21wbGV0ZSA9IHRydWU7CiAgICBjaGVja0NvbXBsZXRlKCk7CiAgfSkpOwogIHJldHVybiBmdW5jdGlvbigpIHsKICAgIGFkZGl0aW9uYWxGaW5hbGl6ZXIgPT09IG51bGwgfHwgYWRkaXRpb25hbEZpbmFsaXplciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWRkaXRpb25hbEZpbmFsaXplcigpOwogIH07Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvbWVyZ2VNYXAuanMKZnVuY3Rpb24gbWVyZ2VNYXAocHJvamVjdCwgcmVzdWx0U2VsZWN0b3IsIGNvbmN1cnJlbnQpIHsKICBpZiAoY29uY3VycmVudCA9PT0gdm9pZCAwKSB7CiAgICBjb25jdXJyZW50ID0gSW5maW5pdHk7CiAgfQogIGlmIChpc0Z1bmN0aW9uKHJlc3VsdFNlbGVjdG9yKSkgewogICAgcmV0dXJuIG1lcmdlTWFwKGZ1bmN0aW9uKGEsIGkpIHsKICAgICAgcmV0dXJuIG1hcChmdW5jdGlvbihiLCBpaSkgewogICAgICAgIHJldHVybiByZXN1bHRTZWxlY3RvcihhLCBiLCBpLCBpaSk7CiAgICAgIH0pKGlubmVyRnJvbShwcm9qZWN0KGEsIGkpKSk7CiAgICB9LCBjb25jdXJyZW50KTsKICB9IGVsc2UgaWYgKHR5cGVvZiByZXN1bHRTZWxlY3RvciA9PT0gIm51bWJlciIpIHsKICAgIGNvbmN1cnJlbnQgPSByZXN1bHRTZWxlY3RvcjsKICB9CiAgcmV0dXJuIG9wZXJhdGUoZnVuY3Rpb24oc291cmNlLCBzdWJzY3JpYmVyKSB7CiAgICByZXR1cm4gbWVyZ2VJbnRlcm5hbHMoc291cmNlLCBzdWJzY3JpYmVyLCBwcm9qZWN0LCBjb25jdXJyZW50KTsKICB9KTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9tZXJnZUFsbC5qcwpmdW5jdGlvbiBtZXJnZUFsbChjb25jdXJyZW50KSB7CiAgaWYgKGNvbmN1cnJlbnQgPT09IHZvaWQgMCkgewogICAgY29uY3VycmVudCA9IEluZmluaXR5OwogIH0KICByZXR1cm4gbWVyZ2VNYXAoaWRlbnRpdHksIGNvbmN1cnJlbnQpOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL2NvbmNhdEFsbC5qcwpmdW5jdGlvbiBjb25jYXRBbGwoKSB7CiAgcmV0dXJuIG1lcmdlQWxsKDEpOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9jb25jYXQuanMKZnVuY3Rpb24gY29uY2F0KCkgewogIHZhciBhcmdzID0gW107CiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTsKICB9CiAgcmV0dXJuIGNvbmNhdEFsbCgpKGZyb20oYXJncywgcG9wU2NoZWR1bGVyKGFyZ3MpKSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2RlZmVyLmpzCmZ1bmN0aW9uIGRlZmVyKG9ic2VydmFibGVGYWN0b3J5KSB7CiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHsKICAgIGlubmVyRnJvbShvYnNlcnZhYmxlRmFjdG9yeSgpKS5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2ZvcmtKb2luLmpzCmZ1bmN0aW9uIGZvcmtKb2luKCkgewogIHZhciBhcmdzID0gW107CiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTsKICB9CiAgdmFyIHJlc3VsdFNlbGVjdG9yID0gcG9wUmVzdWx0U2VsZWN0b3IoYXJncyk7CiAgdmFyIF9hID0gYXJnc0FyZ0FycmF5T3JPYmplY3QoYXJncyksIHNvdXJjZXMgPSBfYS5hcmdzLCBrZXlzID0gX2Eua2V5czsKICB2YXIgcmVzdWx0ID0gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24oc3Vic2NyaWJlcikgewogICAgdmFyIGxlbmd0aCA9IHNvdXJjZXMubGVuZ3RoOwogICAgaWYgKCFsZW5ndGgpIHsKICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICByZXR1cm47CiAgICB9CiAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbmd0aCk7CiAgICB2YXIgcmVtYWluaW5nQ29tcGxldGlvbnMgPSBsZW5ndGg7CiAgICB2YXIgcmVtYWluaW5nRW1pc3Npb25zID0gbGVuZ3RoOwogICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbihzb3VyY2VJbmRleDIpIHsKICAgICAgdmFyIGhhc1ZhbHVlID0gZmFsc2U7CiAgICAgIGlubmVyRnJvbShzb3VyY2VzW3NvdXJjZUluZGV4Ml0pLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBpZiAoIWhhc1ZhbHVlKSB7CiAgICAgICAgICBoYXNWYWx1ZSA9IHRydWU7CiAgICAgICAgICByZW1haW5pbmdFbWlzc2lvbnMtLTsKICAgICAgICB9CiAgICAgICAgdmFsdWVzW3NvdXJjZUluZGV4Ml0gPSB2YWx1ZTsKICAgICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHJlbWFpbmluZ0NvbXBsZXRpb25zLS07CiAgICAgIH0sIHZvaWQgMCwgZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKCFyZW1haW5pbmdDb21wbGV0aW9ucyB8fCAhaGFzVmFsdWUpIHsKICAgICAgICAgIGlmICghcmVtYWluaW5nRW1pc3Npb25zKSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChrZXlzID8gY3JlYXRlT2JqZWN0KGtleXMsIHZhbHVlcykgOiB2YWx1ZXMpOwogICAgICAgICAgfQogICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgIH0KICAgICAgfSkpOwogICAgfTsKICAgIGZvciAodmFyIHNvdXJjZUluZGV4ID0gMDsgc291cmNlSW5kZXggPCBsZW5ndGg7IHNvdXJjZUluZGV4KyspIHsKICAgICAgX2xvb3BfMShzb3VyY2VJbmRleCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlc3VsdFNlbGVjdG9yID8gcmVzdWx0LnBpcGUobWFwT25lT3JNYW55QXJncyhyZXN1bHRTZWxlY3RvcikpIDogcmVzdWx0Owp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9uZXZlci5qcwp2YXIgTkVWRVIgPSBuZXcgT2JzZXJ2YWJsZShub29wKTsKCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvZmlsdGVyLmpzCmZ1bmN0aW9uIGZpbHRlcihwcmVkaWNhdGUsIHRoaXNBcmcpIHsKICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIHZhciBpbmRleCA9IDA7CiAgICBzb3VyY2Uuc3Vic2NyaWJlKGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBmdW5jdGlvbih2YWx1ZSkgewogICAgICByZXR1cm4gcHJlZGljYXRlLmNhbGwodGhpc0FyZywgdmFsdWUsIGluZGV4KyspICYmIHN1YnNjcmliZXIubmV4dCh2YWx1ZSk7CiAgICB9KSk7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvY2F0Y2hFcnJvci5qcwpmdW5jdGlvbiBjYXRjaEVycm9yKHNlbGVjdG9yKSB7CiAgcmV0dXJuIG9wZXJhdGUoZnVuY3Rpb24oc291cmNlLCBzdWJzY3JpYmVyKSB7CiAgICB2YXIgaW5uZXJTdWIgPSBudWxsOwogICAgdmFyIHN5bmNVbnN1YiA9IGZhbHNlOwogICAgdmFyIGhhbmRsZWRSZXN1bHQ7CiAgICBpbm5lclN1YiA9IHNvdXJjZS5zdWJzY3JpYmUoY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKHN1YnNjcmliZXIsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbihlcnIpIHsKICAgICAgaGFuZGxlZFJlc3VsdCA9IGlubmVyRnJvbShzZWxlY3RvcihlcnIsIGNhdGNoRXJyb3Ioc2VsZWN0b3IpKHNvdXJjZSkpKTsKICAgICAgaWYgKGlubmVyU3ViKSB7CiAgICAgICAgaW5uZXJTdWIudW5zdWJzY3JpYmUoKTsKICAgICAgICBpbm5lclN1YiA9IG51bGw7CiAgICAgICAgaGFuZGxlZFJlc3VsdC5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3luY1Vuc3ViID0gdHJ1ZTsKICAgICAgfQogICAgfSkpOwogICAgaWYgKHN5bmNVbnN1YikgewogICAgICBpbm5lclN1Yi51bnN1YnNjcmliZSgpOwogICAgICBpbm5lclN1YiA9IG51bGw7CiAgICAgIGhhbmRsZWRSZXN1bHQuc3Vic2NyaWJlKHN1YnNjcmliZXIpOwogICAgfQogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL2NvbmNhdE1hcC5qcwpmdW5jdGlvbiBjb25jYXRNYXAocHJvamVjdCwgcmVzdWx0U2VsZWN0b3IpIHsKICByZXR1cm4gaXNGdW5jdGlvbihyZXN1bHRTZWxlY3RvcikgPyBtZXJnZU1hcChwcm9qZWN0LCByZXN1bHRTZWxlY3RvciwgMSkgOiBtZXJnZU1hcChwcm9qZWN0LCAxKTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9kZWZhdWx0SWZFbXB0eS5qcwpmdW5jdGlvbiBkZWZhdWx0SWZFbXB0eShkZWZhdWx0VmFsdWUpIHsKICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIHZhciBoYXNWYWx1ZSA9IGZhbHNlOwogICAgc291cmNlLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgaGFzVmFsdWUgPSB0cnVlOwogICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpOwogICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgIGlmICghaGFzVmFsdWUpIHsKICAgICAgICBzdWJzY3JpYmVyLm5leHQoZGVmYXVsdFZhbHVlKTsKICAgICAgfQogICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICB9KSk7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvdGFrZS5qcwpmdW5jdGlvbiB0YWtlKGNvdW50MikgewogIHJldHVybiBjb3VudDIgPD0gMCA/IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIEVNUFRZOwogIH0gOiBvcGVyYXRlKGZ1bmN0aW9uKHNvdXJjZSwgc3Vic2NyaWJlcikgewogICAgdmFyIHNlZW4gPSAwOwogICAgc291cmNlLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgaWYgKCsrc2VlbiA8PSBjb3VudDIpIHsKICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpOwogICAgICAgIGlmIChjb3VudDIgPD0gc2VlbikgewogICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSkpOwogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL3Rocm93SWZFbXB0eS5qcwpmdW5jdGlvbiB0aHJvd0lmRW1wdHkoZXJyb3JGYWN0b3J5KSB7CiAgaWYgKGVycm9yRmFjdG9yeSA9PT0gdm9pZCAwKSB7CiAgICBlcnJvckZhY3RvcnkgPSBkZWZhdWx0RXJyb3JGYWN0b3J5OwogIH0KICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIHZhciBoYXNWYWx1ZSA9IGZhbHNlOwogICAgc291cmNlLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgaGFzVmFsdWUgPSB0cnVlOwogICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpOwogICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBoYXNWYWx1ZSA/IHN1YnNjcmliZXIuY29tcGxldGUoKSA6IHN1YnNjcmliZXIuZXJyb3IoZXJyb3JGYWN0b3J5KCkpOwogICAgfSkpOwogIH0pOwp9CmZ1bmN0aW9uIGRlZmF1bHRFcnJvckZhY3RvcnkoKSB7CiAgcmV0dXJuIG5ldyBFbXB0eUVycm9yKCk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvZmluYWxpemUuanMKZnVuY3Rpb24gZmluYWxpemUoY2FsbGJhY2spIHsKICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIHRyeSB7CiAgICAgIHNvdXJjZS5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgICB9IGZpbmFsbHkgewogICAgICBzdWJzY3JpYmVyLmFkZChjYWxsYmFjayk7CiAgICB9CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvZmlyc3QuanMKZnVuY3Rpb24gZmlyc3QocHJlZGljYXRlLCBkZWZhdWx0VmFsdWUpIHsKICB2YXIgaGFzRGVmYXVsdFZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+PSAyOwogIHJldHVybiBmdW5jdGlvbihzb3VyY2UpIHsKICAgIHJldHVybiBzb3VyY2UucGlwZShwcmVkaWNhdGUgPyBmaWx0ZXIoZnVuY3Rpb24odiwgaSkgewogICAgICByZXR1cm4gcHJlZGljYXRlKHYsIGksIHNvdXJjZSk7CiAgICB9KSA6IGlkZW50aXR5LCB0YWtlKDEpLCBoYXNEZWZhdWx0VmFsdWUgPyBkZWZhdWx0SWZFbXB0eShkZWZhdWx0VmFsdWUpIDogdGhyb3dJZkVtcHR5KGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gbmV3IEVtcHR5RXJyb3IoKTsKICAgIH0pKTsKICB9Owp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL3Rha2VMYXN0LmpzCmZ1bmN0aW9uIHRha2VMYXN0KGNvdW50MikgewogIHJldHVybiBjb3VudDIgPD0gMCA/IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIEVNUFRZOwogIH0gOiBvcGVyYXRlKGZ1bmN0aW9uKHNvdXJjZSwgc3Vic2NyaWJlcikgewogICAgdmFyIGJ1ZmZlcjIgPSBbXTsKICAgIHNvdXJjZS5zdWJzY3JpYmUoY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKHN1YnNjcmliZXIsIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGJ1ZmZlcjIucHVzaCh2YWx1ZSk7CiAgICAgIGNvdW50MiA8IGJ1ZmZlcjIubGVuZ3RoICYmIGJ1ZmZlcjIuc2hpZnQoKTsKICAgIH0sIGZ1bmN0aW9uKCkgewogICAgICB2YXIgZV8xLCBfYTsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBidWZmZXJfMSA9IF9fdmFsdWVzKGJ1ZmZlcjIpLCBidWZmZXJfMV8xID0gYnVmZmVyXzEubmV4dCgpOyAhYnVmZmVyXzFfMS5kb25lOyBidWZmZXJfMV8xID0gYnVmZmVyXzEubmV4dCgpKSB7CiAgICAgICAgICB2YXIgdmFsdWUgPSBidWZmZXJfMV8xLnZhbHVlOwogICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVfMV8xKSB7CiAgICAgICAgZV8xID0geyBlcnJvcjogZV8xXzEgfTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGJ1ZmZlcl8xXzEgJiYgIWJ1ZmZlcl8xXzEuZG9uZSAmJiAoX2EgPSBidWZmZXJfMS5yZXR1cm4pKSBfYS5jYWxsKGJ1ZmZlcl8xKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOwogICAgICAgIH0KICAgICAgfQogICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICB9LCB2b2lkIDAsIGZ1bmN0aW9uKCkgewogICAgICBidWZmZXIyID0gbnVsbDsKICAgIH0pKTsKICB9KTsKfQoKLy8gbm9kZV9tb2R1bGVzL3J4anMvZGlzdC9lc201L2ludGVybmFsL29wZXJhdG9ycy9zdGFydFdpdGguanMKZnVuY3Rpb24gc3RhcnRXaXRoKCkgewogIHZhciB2YWx1ZXMgPSBbXTsKICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgdmFsdWVzW19pXSA9IGFyZ3VtZW50c1tfaV07CiAgfQogIHZhciBzY2hlZHVsZXIgPSBwb3BTY2hlZHVsZXIodmFsdWVzKTsKICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIChzY2hlZHVsZXIgPyBjb25jYXQodmFsdWVzLCBzb3VyY2UsIHNjaGVkdWxlcikgOiBjb25jYXQodmFsdWVzLCBzb3VyY2UpKS5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgfSk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvc3dpdGNoTWFwLmpzCmZ1bmN0aW9uIHN3aXRjaE1hcChwcm9qZWN0LCByZXN1bHRTZWxlY3RvcikgewogIHJldHVybiBvcGVyYXRlKGZ1bmN0aW9uKHNvdXJjZSwgc3Vic2NyaWJlcikgewogICAgdmFyIGlubmVyU3Vic2NyaWJlciA9IG51bGw7CiAgICB2YXIgaW5kZXggPSAwOwogICAgdmFyIGlzQ29tcGxldGUgPSBmYWxzZTsKICAgIHZhciBjaGVja0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBpc0NvbXBsZXRlICYmICFpbm5lclN1YnNjcmliZXIgJiYgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgfTsKICAgIHNvdXJjZS5zdWJzY3JpYmUoY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKHN1YnNjcmliZXIsIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlubmVyU3Vic2NyaWJlciA9PT0gbnVsbCB8fCBpbm5lclN1YnNjcmliZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGlubmVyU3Vic2NyaWJlci51bnN1YnNjcmliZSgpOwogICAgICB2YXIgaW5uZXJJbmRleCA9IDA7CiAgICAgIHZhciBvdXRlckluZGV4ID0gaW5kZXgrKzsKICAgICAgaW5uZXJGcm9tKHByb2plY3QodmFsdWUsIG91dGVySW5kZXgpKS5zdWJzY3JpYmUoaW5uZXJTdWJzY3JpYmVyID0gY3JlYXRlT3BlcmF0b3JTdWJzY3JpYmVyKHN1YnNjcmliZXIsIGZ1bmN0aW9uKGlubmVyVmFsdWUpIHsKICAgICAgICByZXR1cm4gc3Vic2NyaWJlci5uZXh0KHJlc3VsdFNlbGVjdG9yID8gcmVzdWx0U2VsZWN0b3IodmFsdWUsIGlubmVyVmFsdWUsIG91dGVySW5kZXgsIGlubmVySW5kZXgrKykgOiBpbm5lclZhbHVlKTsKICAgICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgaW5uZXJTdWJzY3JpYmVyID0gbnVsbDsKICAgICAgICBjaGVja0NvbXBsZXRlKCk7CiAgICAgIH0pKTsKICAgIH0sIGZ1bmN0aW9uKCkgewogICAgICBpc0NvbXBsZXRlID0gdHJ1ZTsKICAgICAgY2hlY2tDb21wbGV0ZSgpOwogICAgfSkpOwogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL3Rha2VVbnRpbC5qcwpmdW5jdGlvbiB0YWtlVW50aWwobm90aWZpZXIpIHsKICByZXR1cm4gb3BlcmF0ZShmdW5jdGlvbihzb3VyY2UsIHN1YnNjcmliZXIpIHsKICAgIGlubmVyRnJvbShub3RpZmllcikuc3Vic2NyaWJlKGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgIH0sIG5vb3ApKTsKICAgICFzdWJzY3JpYmVyLmNsb3NlZCAmJiBzb3VyY2Uuc3Vic2NyaWJlKHN1YnNjcmliZXIpOwogIH0pOwp9CgovLyBub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL3RhcC5qcwpmdW5jdGlvbiB0YXAob2JzZXJ2ZXJPck5leHQsIGVycm9yLCBjb21wbGV0ZSkgewogIHZhciB0YXBPYnNlcnZlciA9IGlzRnVuY3Rpb24ob2JzZXJ2ZXJPck5leHQpIHx8IGVycm9yIHx8IGNvbXBsZXRlID8geyBuZXh0OiBvYnNlcnZlck9yTmV4dCwgZXJyb3IsIGNvbXBsZXRlIH0gOiBvYnNlcnZlck9yTmV4dDsKICByZXR1cm4gdGFwT2JzZXJ2ZXIgPyBvcGVyYXRlKGZ1bmN0aW9uKHNvdXJjZSwgc3Vic2NyaWJlcikgewogICAgdmFyIF9hOwogICAgKF9hID0gdGFwT2JzZXJ2ZXIuc3Vic2NyaWJlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbCh0YXBPYnNlcnZlcik7CiAgICB2YXIgaXNVbnN1YiA9IHRydWU7CiAgICBzb3VyY2Uuc3Vic2NyaWJlKGNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBmdW5jdGlvbih2YWx1ZSkgewogICAgICB2YXIgX2EyOwogICAgICAoX2EyID0gdGFwT2JzZXJ2ZXIubmV4dCkgPT09IG51bGwgfHwgX2EyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYTIuY2FsbCh0YXBPYnNlcnZlciwgdmFsdWUpOwogICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpOwogICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgIHZhciBfYTI7CiAgICAgIGlzVW5zdWIgPSBmYWxzZTsKICAgICAgKF9hMiA9IHRhcE9ic2VydmVyLmNvbXBsZXRlKSA9PT0gbnVsbCB8fCBfYTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hMi5jYWxsKHRhcE9ic2VydmVyKTsKICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgfSwgZnVuY3Rpb24oZXJyKSB7CiAgICAgIHZhciBfYTI7CiAgICAgIGlzVW5zdWIgPSBmYWxzZTsKICAgICAgKF9hMiA9IHRhcE9ic2VydmVyLmVycm9yKSA9PT0gbnVsbCB8fCBfYTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hMi5jYWxsKHRhcE9ic2VydmVyLCBlcnIpOwogICAgICBzdWJzY3JpYmVyLmVycm9yKGVycik7CiAgICB9LCBmdW5jdGlvbigpIHsKICAgICAgdmFyIF9hMiwgX2I7CiAgICAgIGlmIChpc1Vuc3ViKSB7CiAgICAgICAgKF9hMiA9IHRhcE9ic2VydmVyLnVuc3Vic2NyaWJlKSA9PT0gbnVsbCB8fCBfYTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hMi5jYWxsKHRhcE9ic2VydmVyKTsKICAgICAgfQogICAgICAoX2IgPSB0YXBPYnNlcnZlci5maW5hbGl6ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwodGFwT2JzZXJ2ZXIpOwogICAgfSkpOwogIH0pIDogaWRlbnRpdHk7Cn0KCi8vIG5vZGVfbW9kdWxlcy9AYW5ndWxhci9jb3JlL2Zlc20yMDIyL19ub3RfZm91bmQtY2h1bmsubWpzCnZhciBfY3VycmVudEluamVjdG9yID0gdm9pZCAwOwpmdW5jdGlvbiBnZXRDdXJyZW50SW5qZWN0b3IoKSB7CiAgcmV0dXJuIF9jdXJyZW50SW5qZWN0b3I7Cn0KZnVuY3Rpb24gc2V0Q3VycmVudEluamVjdG9yKGluamVjdG9yKSB7CiAgY29uc3QgZm9ybWVyID0gX2N1cnJlbnRJbmplY3RvcjsKICBfY3VycmVudEluamVjdG9yID0gaW5qZWN0b3I7CiAgcmV0dXJuIGZvcm1lcjsKfQp2YXIgTk9UX0ZPVU5EID0gLyogQF9fUFVSRV9fICovIFN5bWJvbCgiTm90Rm91bmQiKTsKZnVuY3Rpb24gaXNOb3RGb3VuZChlKSB7CiAgcmV0dXJuIGUgPT09IE5PVF9GT1VORCB8fCBlPy5uYW1lID09PSAiybVOb3RGb3VuZCI7Cn0KCi8vIG5vZGVfbW9kdWxlcy9AYW5ndWxhci9jb3JlL2Zlc20yMDIyL19saW5rZWRfc2lnbmFsLWNodW5rLm1qcwpmdW5jdGlvbiBjcmVhdGVMaW5rZWRTaWduYWwoc291cmNlRm4sIGNvbXB1dGF0aW9uRm4sIGVxdWFsaXR5Rm4pIHsKICBjb25zdCBub2RlID0gT2JqZWN0LmNyZWF0ZShMSU5LRURfU0lHTkFMX05PREUpOwogIG5vZGUuc291cmNlID0gc291cmNlRm47CiAgbm9kZS5jb21wdXRhdGlvbiA9IGNvbXB1dGF0aW9uRm47CiAgaWYgKGVxdWFsaXR5Rm4gIT0gdm9pZCAwKSB7CiAgICBub2RlLmVxdWFsID0gZXF1YWxpdHlGbjsKICB9CiAgY29uc3QgbGlua2VkU2lnbmFsR2V0dGVyID0gKCkgPT4gewogICAgcHJvZHVjZXJVcGRhdGVWYWx1ZVZlcnNpb24obm9kZSk7CiAgICBwcm9kdWNlckFjY2Vzc2VkKG5vZGUpOwogICAgaWYgKG5vZGUudmFsdWUgPT09IEVSUk9SRUQpIHsKICAgICAgdGhyb3cgbm9kZS5lcnJvcjsKICAgIH0KICAgIHJldHVybiBub2RlLnZhbHVlOwogIH07CiAgY29uc3QgZ2V0dGVyID0gbGlua2VkU2lnbmFsR2V0dGVyOwogIGdldHRlcltTSUdOQUxdID0gbm9kZTsKICBpZiAodHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlKSB7CiAgICBjb25zdCBkZWJ1Z05hbWUgPSBub2RlLmRlYnVnTmFtZSA/ICIgKCIgKyBub2RlLmRlYnVnTmFtZSArICIpIiA6ICIiOwogICAgZ2V0dGVyLnRvU3RyaW5nID0gKCkgPT4gYFtMaW5rZWRTaWduYWwke2RlYnVnTmFtZX06ICR7U3RyaW5nKG5vZGUudmFsdWUpfV1gOwogIH0KICBydW5Qb3N0UHJvZHVjZXJDcmVhdGVkRm4obm9kZSk7CiAgcmV0dXJuIGdldHRlcjsKfQpmdW5jdGlvbiBsaW5rZWRTaWduYWxTZXRGbihub2RlLCBuZXdWYWx1ZSkgewogIHByb2R1Y2VyVXBkYXRlVmFsdWVWZXJzaW9uKG5vZGUpOwogIHNpZ25hbFNldEZuKG5vZGUsIG5ld1ZhbHVlKTsKICBwcm9kdWNlck1hcmtDbGVhbihub2RlKTsKfQpmdW5jdGlvbiBsaW5rZWRTaWduYWxVcGRhdGVGbihub2RlLCB1cGRhdGVyKSB7CiAgcHJvZHVjZXJVcGRhdGVWYWx1ZVZlcnNpb24obm9kZSk7CiAgaWYgKG5vZGUudmFsdWUgPT09IEVSUk9SRUQpIHsKICAgIHRocm93IG5vZGUuZXJyb3I7CiAgfQogIHNpZ25hbFVwZGF0ZUZuKG5vZGUsIHVwZGF0ZXIpOwogIHByb2R1Y2VyTWFya0NsZWFuKG5vZGUpOwp9CnZhciBMSU5LRURfU0lHTkFMX05PREUgPSAoKCkgPT4gewogIHJldHVybiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBSRUFDVElWRV9OT0RFKSwgewogICAgdmFsdWU6IFVOU0VULAogICAgZGlydHk6IHRydWUsCiAgICBlcnJvcjogbnVsbCwKICAgIGVxdWFsOiBkZWZhdWx0RXF1YWxzLAogICAga2luZDogImxpbmtlZFNpZ25hbCIsCiAgICBwcm9kdWNlck11c3RSZWNvbXB1dGUobm9kZSkgewogICAgICByZXR1cm4gbm9kZS52YWx1ZSA9PT0gVU5TRVQgfHwgbm9kZS52YWx1ZSA9PT0gQ09NUFVUSU5HOwogICAgfSwKICAgIHByb2R1Y2VyUmVjb21wdXRlVmFsdWUobm9kZSkgewogICAgICBpZiAobm9kZS52YWx1ZSA9PT0gQ09NUFVUSU5HKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJEZXRlY3RlZCBjeWNsZSBpbiBjb21wdXRhdGlvbnMuIiA6ICIiKTsKICAgICAgfQogICAgICBjb25zdCBvbGRWYWx1ZSA9IG5vZGUudmFsdWU7CiAgICAgIG5vZGUudmFsdWUgPSBDT01QVVRJTkc7CiAgICAgIGNvbnN0IHByZXZDb25zdW1lciA9IGNvbnN1bWVyQmVmb3JlQ29tcHV0YXRpb24obm9kZSk7CiAgICAgIGxldCBuZXdWYWx1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBuZXdTb3VyY2VWYWx1ZSA9IG5vZGUuc291cmNlKCk7CiAgICAgICAgY29uc3QgcHJldiA9IG9sZFZhbHVlID09PSBVTlNFVCB8fCBvbGRWYWx1ZSA9PT0gRVJST1JFRCA/IHZvaWQgMCA6IHsKICAgICAgICAgIHNvdXJjZTogbm9kZS5zb3VyY2VWYWx1ZSwKICAgICAgICAgIHZhbHVlOiBvbGRWYWx1ZQogICAgICAgIH07CiAgICAgICAgbmV3VmFsdWUgPSBub2RlLmNvbXB1dGF0aW9uKG5ld1NvdXJjZVZhbHVlLCBwcmV2KTsKICAgICAgICBub2RlLnNvdXJjZVZhbHVlID0gbmV3U291cmNlVmFsdWU7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIG5ld1ZhbHVlID0gRVJST1JFRDsKICAgICAgICBub2RlLmVycm9yID0gZXJyOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGNvbnN1bWVyQWZ0ZXJDb21wdXRhdGlvbihub2RlLCBwcmV2Q29uc3VtZXIpOwogICAgICB9CiAgICAgIGlmIChvbGRWYWx1ZSAhPT0gVU5TRVQgJiYgbmV3VmFsdWUgIT09IEVSUk9SRUQgJiYgbm9kZS5lcXVhbChvbGRWYWx1ZSwgbmV3VmFsdWUpKSB7CiAgICAgICAgbm9kZS52YWx1ZSA9IG9sZFZhbHVlOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBub2RlLnZhbHVlID0gbmV3VmFsdWU7CiAgICAgIG5vZGUudmVyc2lvbisrOwogICAgfQogIH0pOwp9KSgpOwoKLy8gbm9kZV9tb2R1bGVzL0Bhbmd1bGFyL2NvcmUvZmVzbTIwMjIvX3dlYWtfcmVmLWNodW5rLm1qcwpmdW5jdGlvbiBzZXRBbHRlcm5hdGVXZWFrUmVmSW1wbChpbXBsKSB7Cn0KCi8vIG5vZGVfbW9kdWxlcy9AYW5ndWxhci9jb3JlL2Zlc20yMDIyL3ByaW1pdGl2ZXMtc2lnbmFscy5tanMKdmFyIGZvcm1hdHRlciA9IHsKICBoZWFkZXI6IChzaWcsIGNvbmZpZzIpID0+IHsKICAgIGlmICghaXNTaWduYWwoc2lnKSB8fCBjb25maWcyPy5uZ1NraXBGb3JtYXR0aW5nKSByZXR1cm4gbnVsbDsKICAgIGxldCB2YWx1ZTsKICAgIHRyeSB7CiAgICAgIHZhbHVlID0gc2lnKCk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHJldHVybiBbInNwYW4iLCBgU2lnbmFsKOKaoO+4jyBFcnJvcikke2UubWVzc2FnZSA/IGA6ICR7ZS5tZXNzYWdlfWAgOiAiIn1gXTsKICAgIH0KICAgIGNvbnN0IGtpbmQgPSAiY29tcHV0YXRpb24iIGluIHNpZ1tTSUdOQUxdID8gIkNvbXB1dGVkIiA6ICJTaWduYWwiOwogICAgY29uc3QgaXNQcmltaXRpdmUgPSB2YWx1ZSA9PT0gbnVsbCB8fCAhQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdHlwZW9mIHZhbHVlICE9PSAib2JqZWN0IjsKICAgIHJldHVybiBbInNwYW4iLCB7fSwgWyJzcGFuIiwge30sIGAke2tpbmR9KGBdLCAoKCkgPT4gewogICAgICBpZiAoaXNTaWduYWwodmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdHRlci5oZWFkZXIodmFsdWUsIGNvbmZpZzIpOwogICAgICB9IGVsc2UgaWYgKGlzUHJpbWl0aXZlICYmIHZhbHVlICE9PSB2b2lkIDAgJiYgdHlwZW9mIHZhbHVlICE9PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgcmV0dXJuIFsib2JqZWN0IiwgewogICAgICAgICAgb2JqZWN0OiB2YWx1ZQogICAgICAgIH1dOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBwcmV0dGlmeVByZXZpZXcodmFsdWUpOwogICAgICB9CiAgICB9KSgpLCBbInNwYW4iLCB7fSwgYClgXV07CiAgfSwKICBoYXNCb2R5OiAoc2lnLCBjb25maWcyKSA9PiB7CiAgICBpZiAoIWlzU2lnbmFsKHNpZykpIHJldHVybiBmYWxzZTsKICAgIHRyeSB7CiAgICAgIHNpZygpOwogICAgfSBjYXRjaCB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiAhY29uZmlnMj8ubmdTa2lwRm9ybWF0dGluZzsKICB9LAogIGJvZHk6IChzaWcsIGNvbmZpZzIpID0+IHsKICAgIGNvbnN0IGNvbG9yID0gInZhcigtLXN5cy1jb2xvci1wcmltYXJ5KSI7CiAgICByZXR1cm4gWyJkaXYiLCB7CiAgICAgIHN0eWxlOiBgYmFja2dyb3VuZDogI0ZGRkZGRjEwOyBwYWRkaW5nLWxlZnQ6IDRweDsgcGFkZGluZy10b3A6IDJweDsgcGFkZGluZy1ib3R0b206IDJweDtgCiAgICB9LCBbImRpdiIsIHsKICAgICAgc3R5bGU6IGBjb2xvcjogJHtjb2xvcn1gCiAgICB9LCAiU2lnbmFsIHZhbHVlOiAiXSwgWyJkaXYiLCB7CiAgICAgIHN0eWxlOiBgcGFkZGluZy1sZWZ0OiAuNXJlbTtgCiAgICB9LCBbIm9iamVjdCIsIHsKICAgICAgb2JqZWN0OiBzaWcoKSwKICAgICAgY29uZmlnOiBjb25maWcyCiAgICB9XV0sIFsiZGl2IiwgewogICAgICBzdHlsZTogYGNvbG9yOiAke2NvbG9yfWAKICAgIH0sICJTaWduYWwgZnVuY3Rpb246ICJdLCBbImRpdiIsIHsKICAgICAgc3R5bGU6IGBwYWRkaW5nLWxlZnQ6IC41cmVtO2AKICAgIH0sIFsib2JqZWN0IiwgewogICAgICBvYmplY3Q6IHNpZywKICAgICAgY29uZmlnOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBjb25maWcyKSwgewogICAgICAgIG5nU2tpcEZvcm1hdHRpbmc6IHRydWUKICAgICAgfSkKICAgIH1dXV07CiAgfQp9OwpmdW5jdGlvbiBwcmV0dGlmeVByZXZpZXcodmFsdWUpIHsKICBpZiAodmFsdWUgPT09IG51bGwpIHJldHVybiAibnVsbCI7CiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSByZXR1cm4gYEFycmF5KCR7dmFsdWUubGVuZ3RofSlgOwogIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEVsZW1lbnQpIHJldHVybiBgPCR7dmFsdWUudGFnTmFtZS50b0xvd2VyQ2FzZSgpfT5gOwogIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFVSTCkgcmV0dXJuIGBVUkxgOwogIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7CiAgICBjYXNlICJ1bmRlZmluZWQiOiB7CiAgICAgIHJldHVybiAidW5kZWZpbmVkIjsKICAgIH0KICAgIGNhc2UgImZ1bmN0aW9uIjogewogICAgICBpZiAoInByb3RvdHlwZSIgaW4gdmFsdWUpIHsKICAgICAgICByZXR1cm4gImNsYXNzIjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIigpID0+IHvigKZ9IjsKICAgICAgfQogICAgfQogICAgY2FzZSAib2JqZWN0IjogewogICAgICBpZiAodmFsdWUuY29uc3RydWN0b3IubmFtZSA9PT0gIk9iamVjdCIpIHsKICAgICAgICByZXR1cm4gInvigKZ9IjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYCR7dmFsdWUuY29uc3RydWN0b3IubmFtZX0ge31gOwogICAgICB9CiAgICB9CiAgICBkZWZhdWx0OiB7CiAgICAgIHJldHVybiBbIm9iamVjdCIsIHsKICAgICAgICBvYmplY3Q6IHZhbHVlLAogICAgICAgIGNvbmZpZzogewogICAgICAgICAgbmdTa2lwRm9ybWF0dGluZzogdHJ1ZQogICAgICAgIH0KICAgICAgfV07CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGlzU2lnbmFsKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlW1NJR05BTF0gIT09IHZvaWQgMDsKfQpmdW5jdGlvbiBpbnN0YWxsRGV2VG9vbHNTaWduYWxGb3JtYXR0ZXIoKSB7CiAgZ2xvYmFsVGhpcy5kZXZ0b29sc0Zvcm1hdHRlcnMgPz89IFtdOwogIGlmICghZ2xvYmFsVGhpcy5kZXZ0b29sc0Zvcm1hdHRlcnMuc29tZSgoZikgPT4gZiA9PT0gZm9ybWF0dGVyKSkgewogICAgZ2xvYmFsVGhpcy5kZXZ0b29sc0Zvcm1hdHRlcnMucHVzaChmb3JtYXR0ZXIpOwogIH0KfQp2YXIgTk9PUF9DTEVBTlVQX0ZOID0gKCkgPT4gewp9Owp2YXIgV0FUQ0hfTk9ERSA9ICgoKSA9PiB7CiAgcmV0dXJuIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIFJFQUNUSVZFX05PREUpLCB7CiAgICBjb25zdW1lcklzQWx3YXlzTGl2ZTogdHJ1ZSwKICAgIGNvbnN1bWVyQWxsb3dTaWduYWxXcml0ZXM6IGZhbHNlLAogICAgY29uc3VtZXJNYXJrZWREaXJ0eTogKG5vZGUpID0+IHsKICAgICAgaWYgKG5vZGUuc2NoZWR1bGUgIT09IG51bGwpIHsKICAgICAgICBub2RlLnNjaGVkdWxlKG5vZGUucmVmKTsKICAgICAgfQogICAgfSwKICAgIGNsZWFudXBGbjogTk9PUF9DTEVBTlVQX0ZOCiAgfSk7Cn0pKCk7CmlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICBpbnN0YWxsRGV2VG9vbHNTaWduYWxGb3JtYXR0ZXIoKTsKfQoKLy8gbm9kZV9tb2R1bGVzL0Bhbmd1bGFyL2NvcmUvZmVzbTIwMjIvX3VudHJhY2tlZC1jaHVuay5tanMKdmFyIFZlcnNpb24gPSBjbGFzcyB7CiAgZnVsbDsKICBtYWpvcjsKICBtaW5vcjsKICBwYXRjaDsKICBjb25zdHJ1Y3RvcihmdWxsKSB7CiAgICB0aGlzLmZ1bGwgPSBmdWxsOwogICAgY29uc3QgcGFydHMgPSBmdWxsLnNwbGl0KCIuIik7CiAgICB0aGlzLm1ham9yID0gcGFydHNbMF07CiAgICB0aGlzLm1pbm9yID0gcGFydHNbMV07CiAgICB0aGlzLnBhdGNoID0gcGFydHMuc2xpY2UoMikuam9pbigiLiIpOwogIH0KfTsKdmFyIFZFUlNJT04gPSBuZXcgVmVyc2lvbigiMjEuMS4zIik7CnZhciBET0NfUEFHRV9CQVNFX1VSTCA9ICgoKSA9PiB7CiAgY29uc3QgZnVsbCA9IFZFUlNJT04uZnVsbDsKICBjb25zdCBpc1ByZVJlbGVhc2UgPSBmdWxsLmluY2x1ZGVzKCItbmV4dCIpIHx8IGZ1bGwuaW5jbHVkZXMoIi1yYyIpIHx8IGZ1bGwgPT09ICIwLjAuMC1QTEFDRUhPTERFUiI7CiAgY29uc3QgcHJlZml4ID0gaXNQcmVSZWxlYXNlID8gIm5leHQiIDogYHYke1ZFUlNJT04ubWFqb3J9YDsKICByZXR1cm4gYGh0dHBzOi8vJHtwcmVmaXh9LmFuZ3VsYXIuZGV2YDsKfSkoKTsKdmFyIEVSUk9SX0RFVEFJTFNfUEFHRV9CQVNFX1VSTCA9ICgoKSA9PiB7CiAgcmV0dXJuIGAke0RPQ19QQUdFX0JBU0VfVVJMfS9lcnJvcnNgOwp9KSgpOwp2YXIgWFNTX1NFQ1VSSVRZX1VSTCA9ICJodHRwczovL2FuZ3VsYXIuZGV2L2Jlc3QtcHJhY3RpY2VzL3NlY3VyaXR5I3ByZXZlbnRpbmctY3Jvc3Mtc2l0ZS1zY3JpcHRpbmcteHNzIjsKdmFyIFJ1bnRpbWVFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3IgewogIGNvZGU7CiAgY29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSkgewogICAgc3VwZXIoZm9ybWF0UnVudGltZUVycm9yKGNvZGUsIG1lc3NhZ2UpKTsKICAgIHRoaXMuY29kZSA9IGNvZGU7CiAgfQp9OwpmdW5jdGlvbiBmb3JtYXRSdW50aW1lRXJyb3JDb2RlKGNvZGUpIHsKICByZXR1cm4gYE5HMCR7TWF0aC5hYnMoY29kZSl9YDsKfQpmdW5jdGlvbiBmb3JtYXRSdW50aW1lRXJyb3IoY29kZSwgbWVzc2FnZSkgewogIGNvbnN0IGZ1bGxDb2RlID0gZm9ybWF0UnVudGltZUVycm9yQ29kZShjb2RlKTsKICBsZXQgZXJyb3JNZXNzYWdlID0gYCR7ZnVsbENvZGV9JHttZXNzYWdlID8gIjogIiArIG1lc3NhZ2UgOiAiIn1gOwogIGlmIChuZ0Rldk1vZGUgJiYgY29kZSA8IDApIHsKICAgIGNvbnN0IGFkZFBlcmlvZFNlcGFyYXRvciA9ICFlcnJvck1lc3NhZ2UubWF0Y2goL1suLDshP1xuXSQvKTsKICAgIGNvbnN0IHNlcGFyYXRvciA9IGFkZFBlcmlvZFNlcGFyYXRvciA/ICIuIiA6ICIiOwogICAgZXJyb3JNZXNzYWdlID0gYCR7ZXJyb3JNZXNzYWdlfSR7c2VwYXJhdG9yfSBGaW5kIG1vcmUgYXQgJHtFUlJPUl9ERVRBSUxTX1BBR0VfQkFTRV9VUkx9LyR7ZnVsbENvZGV9YDsKICB9CiAgcmV0dXJuIGVycm9yTWVzc2FnZTsKfQp2YXIgX2dsb2JhbCA9IGdsb2JhbFRoaXM7CmZ1bmN0aW9uIG5nRGV2TW9kZVJlc2V0UGVyZkNvdW50ZXJzKCkgewogIGNvbnN0IGxvY2F0aW9uU3RyaW5nID0gdHlwZW9mIGxvY2F0aW9uICE9PSAidW5kZWZpbmVkIiA/IGxvY2F0aW9uLnRvU3RyaW5nKCkgOiAiIjsKICBjb25zdCBuZXdDb3VudGVycyA9IHsKICAgIGh5ZHJhdGVkTm9kZXM6IDAsCiAgICBoeWRyYXRlZENvbXBvbmVudHM6IDAsCiAgICBkZWh5ZHJhdGVkVmlld3NSZW1vdmVkOiAwLAogICAgZGVoeWRyYXRlZFZpZXdzQ2xlYW51cFJ1bnM6IDAsCiAgICBjb21wb25lbnRzU2tpcHBlZEh5ZHJhdGlvbjogMCwKICAgIGRlZmVyQmxvY2tzV2l0aEluY3JlbWVudGFsSHlkcmF0aW9uOiAwCiAgfTsKICBjb25zdCBhbGxvd05nRGV2TW9kZVRydWUgPSBsb2NhdGlvblN0cmluZy5pbmRleE9mKCJuZ0Rldk1vZGU9ZmFsc2UiKSA9PT0gLTE7CiAgaWYgKCFhbGxvd05nRGV2TW9kZVRydWUpIHsKICAgIF9nbG9iYWxbIm5nRGV2TW9kZSJdID0gZmFsc2U7CiAgfSBlbHNlIHsKICAgIGlmICh0eXBlb2YgX2dsb2JhbFsibmdEZXZNb2RlIl0gIT09ICJvYmplY3QiKSB7CiAgICAgIF9nbG9iYWxbIm5nRGV2TW9kZSJdID0ge307CiAgICB9CiAgICBPYmplY3QuYXNzaWduKF9nbG9iYWxbIm5nRGV2TW9kZSJdLCBuZXdDb3VudGVycyk7CiAgfQogIHJldHVybiBuZXdDb3VudGVyczsKfQpmdW5jdGlvbiBpbml0TmdEZXZNb2RlKCkgewogIGlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICAgIGlmICh0eXBlb2YgbmdEZXZNb2RlICE9PSAib2JqZWN0IiB8fCBPYmplY3Qua2V5cyhuZ0Rldk1vZGUpLmxlbmd0aCA9PT0gMCkgewogICAgICBuZ0Rldk1vZGVSZXNldFBlcmZDb3VudGVycygpOwogICAgfQogICAgcmV0dXJuIHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmICEhbmdEZXZNb2RlOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eShvYmpXaXRoUHJvcGVydHlUb0V4dHJhY3QpIHsKICBmb3IgKGxldCBrZXkgaW4gb2JqV2l0aFByb3BlcnR5VG9FeHRyYWN0KSB7CiAgICBpZiAob2JqV2l0aFByb3BlcnR5VG9FeHRyYWN0W2tleV0gPT09IGdldENsb3N1cmVTYWZlUHJvcGVydHkpIHsKICAgICAgcmV0dXJuIGtleTsKICAgIH0KICB9CiAgdGhyb3cgRXJyb3IodHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkNvdWxkIG5vdCBmaW5kIHJlbmFtZWQgcHJvcGVydHkgb24gdGFyZ2V0IG9iamVjdC4iIDogIiIpOwp9CmZ1bmN0aW9uIGZpbGxQcm9wZXJ0aWVzKHRhcmdldCwgc291cmNlKSB7CiAgZm9yIChjb25zdCBrZXkgaW4gc291cmNlKSB7CiAgICBpZiAoc291cmNlLmhhc093blByb3BlcnR5KGtleSkgJiYgIXRhcmdldC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHN0cmluZ2lmeSh0b2tlbikgewogIGlmICh0eXBlb2YgdG9rZW4gPT09ICJzdHJpbmciKSB7CiAgICByZXR1cm4gdG9rZW47CiAgfQogIGlmIChBcnJheS5pc0FycmF5KHRva2VuKSkgewogICAgcmV0dXJuIGBbJHt0b2tlbi5tYXAoc3RyaW5naWZ5KS5qb2luKCIsICIpfV1gOwogIH0KICBpZiAodG9rZW4gPT0gbnVsbCkgewogICAgcmV0dXJuICIiICsgdG9rZW47CiAgfQogIGNvbnN0IG5hbWUgPSB0b2tlbi5vdmVycmlkZGVuTmFtZSB8fCB0b2tlbi5uYW1lOwogIGlmIChuYW1lKSB7CiAgICByZXR1cm4gYCR7bmFtZX1gOwogIH0KICBjb25zdCByZXN1bHQgPSB0b2tlbi50b1N0cmluZygpOwogIGlmIChyZXN1bHQgPT0gbnVsbCkgewogICAgcmV0dXJuICIiICsgcmVzdWx0OwogIH0KICBjb25zdCBuZXdMaW5lSW5kZXggPSByZXN1bHQuaW5kZXhPZigiXG4iKTsKICByZXR1cm4gbmV3TGluZUluZGV4ID49IDAgPyByZXN1bHQuc2xpY2UoMCwgbmV3TGluZUluZGV4KSA6IHJlc3VsdDsKfQpmdW5jdGlvbiBjb25jYXRTdHJpbmdzV2l0aFNwYWNlKGJlZm9yZSwgYWZ0ZXIpIHsKICBpZiAoIWJlZm9yZSkgcmV0dXJuIGFmdGVyIHx8ICIiOwogIGlmICghYWZ0ZXIpIHJldHVybiBiZWZvcmU7CiAgcmV0dXJuIGAke2JlZm9yZX0gJHthZnRlcn1gOwp9CmZ1bmN0aW9uIHRydW5jYXRlTWlkZGxlKHN0ciwgbWF4TGVuZ3RoID0gMTAwKSB7CiAgaWYgKCFzdHIgfHwgbWF4TGVuZ3RoIDwgMSB8fCBzdHIubGVuZ3RoIDw9IG1heExlbmd0aCkgcmV0dXJuIHN0cjsKICBpZiAobWF4TGVuZ3RoID09IDEpIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIDEpICsgIi4uLiI7CiAgY29uc3QgaGFsZkxpbWl0ID0gTWF0aC5yb3VuZChtYXhMZW5ndGggLyAyKTsKICByZXR1cm4gc3RyLnN1YnN0cmluZygwLCBoYWxmTGltaXQpICsgIi4uLiIgKyBzdHIuc3Vic3RyaW5nKHN0ci5sZW5ndGggLSBoYWxmTGltaXQpOwp9CnZhciBfX2ZvcndhcmRfcmVmX18gPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICBfX2ZvcndhcmRfcmVmX186IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CmZ1bmN0aW9uIGZvcndhcmRSZWYoZm9yd2FyZFJlZkZuKSB7CiAgZm9yd2FyZFJlZkZuLl9fZm9yd2FyZF9yZWZfXyA9IGZvcndhcmRSZWY7CiAgZm9yd2FyZFJlZkZuLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gc3RyaW5naWZ5KHRoaXMoKSk7CiAgfTsKICByZXR1cm4gZm9yd2FyZFJlZkZuOwp9CmZ1bmN0aW9uIHJlc29sdmVGb3J3YXJkUmVmKHR5cGUpIHsKICByZXR1cm4gaXNGb3J3YXJkUmVmKHR5cGUpID8gdHlwZSgpIDogdHlwZTsKfQpmdW5jdGlvbiBpc0ZvcndhcmRSZWYoZm4pIHsKICByZXR1cm4gdHlwZW9mIGZuID09PSAiZnVuY3Rpb24iICYmIGZuLmhhc093blByb3BlcnR5KF9fZm9yd2FyZF9yZWZfXykgJiYgZm4uX19mb3J3YXJkX3JlZl9fID09PSBmb3J3YXJkUmVmOwp9CmZ1bmN0aW9uIGFzc2VydE51bWJlcihhY3R1YWwsIG1zZykgewogIGlmICghKHR5cGVvZiBhY3R1YWwgPT09ICJudW1iZXIiKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCB0eXBlb2YgYWN0dWFsLCAibnVtYmVyIiwgIj09PSIpOwogIH0KfQpmdW5jdGlvbiBhc3NlcnROdW1iZXJJblJhbmdlKGFjdHVhbCwgbWluSW5jbHVzaXZlLCBtYXhJbmNsdXNpdmUpIHsKICBhc3NlcnROdW1iZXIoYWN0dWFsLCAiRXhwZWN0ZWQgYSBudW1iZXIiKTsKICBhc3NlcnRMZXNzVGhhbk9yRXF1YWwoYWN0dWFsLCBtYXhJbmNsdXNpdmUsICJFeHBlY3RlZCBudW1iZXIgdG8gYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIik7CiAgYXNzZXJ0R3JlYXRlclRoYW5PckVxdWFsKGFjdHVhbCwgbWluSW5jbHVzaXZlLCAiRXhwZWN0ZWQgbnVtYmVyIHRvIGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byIpOwp9CmZ1bmN0aW9uIGFzc2VydFN0cmluZyhhY3R1YWwsIG1zZykgewogIGlmICghKHR5cGVvZiBhY3R1YWwgPT09ICJzdHJpbmciKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwgPT09IG51bGwgPyAibnVsbCIgOiB0eXBlb2YgYWN0dWFsLCAic3RyaW5nIiwgIj09PSIpOwogIH0KfQpmdW5jdGlvbiBhc3NlcnRGdW5jdGlvbihhY3R1YWwsIG1zZykgewogIGlmICghKHR5cGVvZiBhY3R1YWwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICB0aHJvd0Vycm9yMihtc2csIGFjdHVhbCA9PT0gbnVsbCA/ICJudWxsIiA6IHR5cGVvZiBhY3R1YWwsICJmdW5jdGlvbiIsICI9PT0iKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbXNnKSB7CiAgaWYgKCEoYWN0dWFsID09IGV4cGVjdGVkKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwsIGV4cGVjdGVkLCAiPT0iKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0Tm90RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbXNnKSB7CiAgaWYgKCEoYWN0dWFsICE9IGV4cGVjdGVkKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwsIGV4cGVjdGVkLCAiIT0iKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0U2FtZShhY3R1YWwsIGV4cGVjdGVkLCBtc2cpIHsKICBpZiAoIShhY3R1YWwgPT09IGV4cGVjdGVkKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwsIGV4cGVjdGVkLCAiPT09Iik7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydE5vdFNhbWUoYWN0dWFsLCBleHBlY3RlZCwgbXNnKSB7CiAgaWYgKCEoYWN0dWFsICE9PSBleHBlY3RlZCkpIHsKICAgIHRocm93RXJyb3IyKG1zZywgYWN0dWFsLCBleHBlY3RlZCwgIiE9PSIpOwogIH0KfQpmdW5jdGlvbiBhc3NlcnRMZXNzVGhhbihhY3R1YWwsIGV4cGVjdGVkLCBtc2cpIHsKICBpZiAoIShhY3R1YWwgPCBleHBlY3RlZCkpIHsKICAgIHRocm93RXJyb3IyKG1zZywgYWN0dWFsLCBleHBlY3RlZCwgIjwiKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0TGVzc1RoYW5PckVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1zZykgewogIGlmICghKGFjdHVhbCA8PSBleHBlY3RlZCkpIHsKICAgIHRocm93RXJyb3IyKG1zZywgYWN0dWFsLCBleHBlY3RlZCwgIjw9Iik7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydEdyZWF0ZXJUaGFuKGFjdHVhbCwgZXhwZWN0ZWQsIG1zZykgewogIGlmICghKGFjdHVhbCA+IGV4cGVjdGVkKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwsIGV4cGVjdGVkLCAiPiIpOwogIH0KfQpmdW5jdGlvbiBhc3NlcnRHcmVhdGVyVGhhbk9yRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbXNnKSB7CiAgaWYgKCEoYWN0dWFsID49IGV4cGVjdGVkKSkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwsIGV4cGVjdGVkLCAiPj0iKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0Tm90RGVmaW5lZChhY3R1YWwsIG1zZykgewogIGlmIChhY3R1YWwgIT0gbnVsbCkgewogICAgdGhyb3dFcnJvcjIobXNnLCBhY3R1YWwsIG51bGwsICI9PSIpOwogIH0KfQpmdW5jdGlvbiBhc3NlcnREZWZpbmVkKGFjdHVhbCwgbXNnKSB7CiAgaWYgKGFjdHVhbCA9PSBudWxsKSB7CiAgICB0aHJvd0Vycm9yMihtc2csIGFjdHVhbCwgbnVsbCwgIiE9Iik7CiAgfQp9CmZ1bmN0aW9uIHRocm93RXJyb3IyKG1zZywgYWN0dWFsLCBleHBlY3RlZCwgY29tcGFyaXNvbikgewogIHRocm93IG5ldyBFcnJvcihgQVNTRVJUSU9OIEVSUk9SOiAke21zZ31gICsgKGNvbXBhcmlzb24gPT0gbnVsbCA/ICIiIDogYCBbRXhwZWN0ZWQ9PiAke2V4cGVjdGVkfSAke2NvbXBhcmlzb259ICR7YWN0dWFsfSA8PUFjdHVhbF1gKSk7Cn0KZnVuY3Rpb24gYXNzZXJ0RG9tTm9kZShub2RlKSB7CiAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIE5vZGUpKSB7CiAgICB0aHJvd0Vycm9yMihgVGhlIHByb3ZpZGVkIHZhbHVlIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgYSBET00gTm9kZSBidXQgZ290ICR7c3RyaW5naWZ5KG5vZGUpfWApOwogIH0KfQpmdW5jdGlvbiBhc3NlcnRFbGVtZW50KG5vZGUpIHsKICBpZiAoIShub2RlIGluc3RhbmNlb2YgRWxlbWVudCkpIHsKICAgIHRocm93RXJyb3IyKGBUaGUgcHJvdmlkZWQgdmFsdWUgbXVzdCBiZSBhbiBlbGVtZW50IGJ1dCBnb3QgJHtzdHJpbmdpZnkobm9kZSl9YCk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydEluZGV4SW5SYW5nZShhcnIsIGluZGV4KSB7CiAgYXNzZXJ0RGVmaW5lZChhcnIsICJBcnJheSBtdXN0IGJlIGRlZmluZWQuIik7CiAgY29uc3QgbWF4TGVuID0gYXJyLmxlbmd0aDsKICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IG1heExlbikgewogICAgdGhyb3dFcnJvcjIoYEluZGV4IGV4cGVjdGVkIHRvIGJlIGxlc3MgdGhhbiAke21heExlbn0gYnV0IGdvdCAke2luZGV4fWApOwogIH0KfQpmdW5jdGlvbiBhc3NlcnRPbmVPZih2YWx1ZSwgLi4udmFsaWRWYWx1ZXMpIHsKICBpZiAodmFsaWRWYWx1ZXMuaW5kZXhPZih2YWx1ZSkgIT09IC0xKSByZXR1cm4gdHJ1ZTsKICB0aHJvd0Vycm9yMihgRXhwZWN0ZWQgdmFsdWUgdG8gYmUgb25lIG9mICR7SlNPTi5zdHJpbmdpZnkodmFsaWRWYWx1ZXMpfSBidXQgd2FzICR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfS5gKTsKfQpmdW5jdGlvbiBhc3NlcnROb3RSZWFjdGl2ZShmbikgewogIGlmIChnZXRBY3RpdmVDb25zdW1lcigpICE9PSBudWxsKSB7CiAgICB0aHJvd0Vycm9yMihgJHtmbn0oKSBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIGluIGEgcmVhY3RpdmUgY29udGV4dC5gKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmluZUluamVjdGFibGUob3B0cykgewogIHJldHVybiB7CiAgICB0b2tlbjogb3B0cy50b2tlbiwKICAgIHByb3ZpZGVkSW46IG9wdHMucHJvdmlkZWRJbiB8fCBudWxsLAogICAgZmFjdG9yeTogb3B0cy5mYWN0b3J5LAogICAgdmFsdWU6IHZvaWQgMAogIH07Cn0KZnVuY3Rpb24gybXJtWRlZmluZUluamVjdG9yKG9wdGlvbnMpIHsKICByZXR1cm4gewogICAgcHJvdmlkZXJzOiBvcHRpb25zLnByb3ZpZGVycyB8fCBbXSwKICAgIGltcG9ydHM6IG9wdGlvbnMuaW1wb3J0cyB8fCBbXQogIH07Cn0KZnVuY3Rpb24gZ2V0SW5qZWN0YWJsZURlZih0eXBlKSB7CiAgcmV0dXJuIGdldE93bkRlZmluaXRpb24odHlwZSwgTkdfUFJPVl9ERUYpOwp9CmZ1bmN0aW9uIGlzSW5qZWN0YWJsZSh0eXBlKSB7CiAgcmV0dXJuIGdldEluamVjdGFibGVEZWYodHlwZSkgIT09IG51bGw7Cn0KZnVuY3Rpb24gZ2V0T3duRGVmaW5pdGlvbih0eXBlLCBmaWVsZCkgewogIHJldHVybiB0eXBlLmhhc093blByb3BlcnR5KGZpZWxkKSAmJiB0eXBlW2ZpZWxkXSB8fCBudWxsOwp9CmZ1bmN0aW9uIGdldEluaGVyaXRlZEluamVjdGFibGVEZWYodHlwZSkgewogIGNvbnN0IGRlZiA9IHR5cGU/LltOR19QUk9WX0RFRl0gPz8gbnVsbDsKICBpZiAoZGVmKSB7CiAgICBuZ0Rldk1vZGUgJiYgY29uc29sZS53YXJuKGBERVBSRUNBVEVEOiBESSBpcyBpbnN0YW50aWF0aW5nIGEgdG9rZW4gIiR7dHlwZS5uYW1lfSIgdGhhdCBpbmhlcml0cyBpdHMgQEluamVjdGFibGUgZGVjb3JhdG9yIGJ1dCBkb2VzIG5vdCBwcm92aWRlIG9uZSBpdHNlbGYuClRoaXMgd2lsbCBiZWNvbWUgYW4gZXJyb3IgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBBbmd1bGFyLiBQbGVhc2UgYWRkIEBJbmplY3RhYmxlKCkgdG8gdGhlICIke3R5cGUubmFtZX0iIGNsYXNzLmApOwogICAgcmV0dXJuIGRlZjsKICB9IGVsc2UgewogICAgcmV0dXJuIG51bGw7CiAgfQp9CmZ1bmN0aW9uIGdldEluamVjdG9yRGVmKHR5cGUpIHsKICByZXR1cm4gdHlwZSAmJiB0eXBlLmhhc093blByb3BlcnR5KE5HX0lOSl9ERUYpID8gdHlwZVtOR19JTkpfREVGXSA6IG51bGw7Cn0KdmFyIE5HX1BST1ZfREVGID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgybVwcm92OiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgTkdfSU5KX0RFRiA9IGdldENsb3N1cmVTYWZlUHJvcGVydHkoewogIMm1aW5qOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgSW5qZWN0aW9uVG9rZW4gPSBjbGFzcyB7CiAgX2Rlc2M7CiAgbmdNZXRhZGF0YU5hbWUgPSAiSW5qZWN0aW9uVG9rZW4iOwogIMm1cHJvdjsKICBjb25zdHJ1Y3RvcihfZGVzYywgb3B0aW9ucykgewogICAgdGhpcy5fZGVzYyA9IF9kZXNjOwogICAgdGhpcy7JtXByb3YgPSB2b2lkIDA7CiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT0gIm51bWJlciIpIHsKICAgICAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgYXNzZXJ0TGVzc1RoYW4ob3B0aW9ucywgMCwgIk9ubHkgbmVnYXRpdmUgbnVtYmVycyBhcmUgc3VwcG9ydGVkIGhlcmUiKTsKICAgICAgdGhpcy5fX05HX0VMRU1FTlRfSURfXyA9IG9wdGlvbnM7CiAgICB9IGVsc2UgaWYgKG9wdGlvbnMgIT09IHZvaWQgMCkgewogICAgICB0aGlzLsm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgICAgICB0b2tlbjogdGhpcywKICAgICAgICBwcm92aWRlZEluOiBvcHRpb25zLnByb3ZpZGVkSW4gfHwgInJvb3QiLAogICAgICAgIGZhY3Rvcnk6IG9wdGlvbnMuZmFjdG9yeQogICAgICB9KTsKICAgIH0KICB9CiAgZ2V0IG11bHRpKCkgewogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvU3RyaW5nKCkgewogICAgcmV0dXJuIGBJbmplY3Rpb25Ub2tlbiAke3RoaXMuX2Rlc2N9YDsKICB9Cn07CnZhciBfaW5qZWN0b3JQcm9maWxlckNvbnRleHQ7CmZ1bmN0aW9uIGdldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KCkgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoImdldEluamVjdG9yUHJvZmlsZXJDb250ZXh0IHNob3VsZCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgcmV0dXJuIF9pbmplY3RvclByb2ZpbGVyQ29udGV4dDsKfQpmdW5jdGlvbiBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dChjb250ZXh0MikgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoInNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0IHNob3VsZCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgY29uc3QgcHJldmlvdXMgPSBfaW5qZWN0b3JQcm9maWxlckNvbnRleHQ7CiAgX2luamVjdG9yUHJvZmlsZXJDb250ZXh0ID0gY29udGV4dDI7CiAgcmV0dXJuIHByZXZpb3VzOwp9CnZhciBpbmplY3RvclByb2ZpbGVyQ2FsbGJhY2tzID0gW107CnZhciBOT09QX1BST0ZJTEVSX1JFTU9WQUwgPSAoKSA9PiB7Cn07CmZ1bmN0aW9uIHJlbW92ZVByb2ZpbGVyKHByb2ZpbGVyMikgewogIGNvbnN0IHByb2ZpbGVySWR4ID0gaW5qZWN0b3JQcm9maWxlckNhbGxiYWNrcy5pbmRleE9mKHByb2ZpbGVyMik7CiAgaWYgKHByb2ZpbGVySWR4ICE9PSAtMSkgewogICAgaW5qZWN0b3JQcm9maWxlckNhbGxiYWNrcy5zcGxpY2UocHJvZmlsZXJJZHgsIDEpOwogIH0KfQpmdW5jdGlvbiBzZXRJbmplY3RvclByb2ZpbGVyKGluamVjdG9yUHJvZmlsZXIyKSB7CiAgIW5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMigic2V0SW5qZWN0b3JQcm9maWxlciBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIGluIHByb2R1Y3Rpb24gbW9kZSIpOwogIGlmIChpbmplY3RvclByb2ZpbGVyMiAhPT0gbnVsbCkgewogICAgaWYgKCFpbmplY3RvclByb2ZpbGVyQ2FsbGJhY2tzLmluY2x1ZGVzKGluamVjdG9yUHJvZmlsZXIyKSkgewogICAgICBpbmplY3RvclByb2ZpbGVyQ2FsbGJhY2tzLnB1c2goaW5qZWN0b3JQcm9maWxlcjIpOwogICAgfQogICAgcmV0dXJuICgpID0+IHJlbW92ZVByb2ZpbGVyKGluamVjdG9yUHJvZmlsZXIyKTsKICB9IGVsc2UgewogICAgaW5qZWN0b3JQcm9maWxlckNhbGxiYWNrcy5sZW5ndGggPSAwOwogICAgcmV0dXJuIE5PT1BfUFJPRklMRVJfUkVNT1ZBTDsKICB9Cn0KZnVuY3Rpb24gaW5qZWN0b3JQcm9maWxlcihldmVudCkgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoIkluamVjdG9yIHByb2ZpbGVyIHNob3VsZCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmplY3RvclByb2ZpbGVyQ2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBpbmplY3RvclByb2ZpbGVyQ2FsbGJhY2sgPSBpbmplY3RvclByb2ZpbGVyQ2FsbGJhY2tzW2ldOwogICAgaW5qZWN0b3JQcm9maWxlckNhbGxiYWNrKGV2ZW50KTsKICB9Cn0KZnVuY3Rpb24gZW1pdFByb3ZpZGVyQ29uZmlndXJlZEV2ZW50KGV2ZW50UHJvdmlkZXIsIGlzVmlld1Byb3ZpZGVyID0gZmFsc2UpIHsKICAhbmdEZXZNb2RlICYmIHRocm93RXJyb3IyKCJJbmplY3RvciBwcm9maWxlciBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIGluIHByb2R1Y3Rpb24gbW9kZSIpOwogIGxldCB0b2tlbjsKICBpZiAodHlwZW9mIGV2ZW50UHJvdmlkZXIgPT09ICJmdW5jdGlvbiIpIHsKICAgIHRva2VuID0gZXZlbnRQcm92aWRlcjsKICB9IGVsc2UgaWYgKGV2ZW50UHJvdmlkZXIgaW5zdGFuY2VvZiBJbmplY3Rpb25Ub2tlbikgewogICAgdG9rZW4gPSBldmVudFByb3ZpZGVyOwogIH0gZWxzZSB7CiAgICB0b2tlbiA9IHJlc29sdmVGb3J3YXJkUmVmKGV2ZW50UHJvdmlkZXIucHJvdmlkZSk7CiAgfQogIGxldCBwcm92aWRlciA9IGV2ZW50UHJvdmlkZXI7CiAgaWYgKGV2ZW50UHJvdmlkZXIgaW5zdGFuY2VvZiBJbmplY3Rpb25Ub2tlbikgewogICAgcHJvdmlkZXIgPSBldmVudFByb3ZpZGVyLsm1cHJvdiB8fCBldmVudFByb3ZpZGVyOwogIH0KICBpbmplY3RvclByb2ZpbGVyKHsKICAgIHR5cGU6IDIsCiAgICBjb250ZXh0OiBnZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCgpLAogICAgcHJvdmlkZXJSZWNvcmQ6IHsKICAgICAgdG9rZW4sCiAgICAgIHByb3ZpZGVyLAogICAgICBpc1ZpZXdQcm92aWRlcgogICAgfQogIH0pOwp9CmZ1bmN0aW9uIGVtaXRJbmplY3RvclRvQ3JlYXRlSW5zdGFuY2VFdmVudCh0b2tlbikgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoIkluamVjdG9yIHByb2ZpbGVyIHNob3VsZCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgaW5qZWN0b3JQcm9maWxlcih7CiAgICB0eXBlOiA1LAogICAgY29udGV4dDogZ2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQoKSwKICAgIHRva2VuCiAgfSk7Cn0KZnVuY3Rpb24gZW1pdEluc3RhbmNlQ3JlYXRlZEJ5SW5qZWN0b3JFdmVudChpbnN0YW5jZSkgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoIkluamVjdG9yIHByb2ZpbGVyIHNob3VsZCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgaW5qZWN0b3JQcm9maWxlcih7CiAgICB0eXBlOiAxLAogICAgY29udGV4dDogZ2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQoKSwKICAgIGluc3RhbmNlOiB7CiAgICAgIHZhbHVlOiBpbnN0YW5jZQogICAgfQogIH0pOwp9CmZ1bmN0aW9uIGVtaXRJbmplY3RFdmVudCh0b2tlbiwgdmFsdWUsIGZsYWdzKSB7CiAgIW5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMigiSW5qZWN0b3IgcHJvZmlsZXIgc2hvdWxkIG5ldmVyIGJlIGNhbGxlZCBpbiBwcm9kdWN0aW9uIG1vZGUiKTsKICBpbmplY3RvclByb2ZpbGVyKHsKICAgIHR5cGU6IDAsCiAgICBjb250ZXh0OiBnZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCgpLAogICAgc2VydmljZTogewogICAgICB0b2tlbiwKICAgICAgdmFsdWUsCiAgICAgIGZsYWdzCiAgICB9CiAgfSk7Cn0KZnVuY3Rpb24gZW1pdEVmZmVjdENyZWF0ZWRFdmVudChlZmZlY3QyKSB7CiAgIW5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMigiSW5qZWN0b3IgcHJvZmlsZXIgc2hvdWxkIG5ldmVyIGJlIGNhbGxlZCBpbiBwcm9kdWN0aW9uIG1vZGUiKTsKICBpbmplY3RvclByb2ZpbGVyKHsKICAgIHR5cGU6IDMsCiAgICBjb250ZXh0OiBnZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCgpLAogICAgZWZmZWN0OiBlZmZlY3QyCiAgfSk7Cn0KZnVuY3Rpb24gZW1pdEFmdGVyUmVuZGVyRWZmZWN0UGhhc2VDcmVhdGVkRXZlbnQoZWZmZWN0UGhhc2UpIHsKICAhbmdEZXZNb2RlICYmIHRocm93RXJyb3IyKCJJbmplY3RvciBwcm9maWxlciBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIGluIHByb2R1Y3Rpb24gbW9kZSIpOwogIGluamVjdG9yUHJvZmlsZXIoewogICAgdHlwZTogNCwKICAgIGNvbnRleHQ6IGdldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KCksCiAgICBlZmZlY3RQaGFzZQogIH0pOwp9CmZ1bmN0aW9uIHJ1bkluSW5qZWN0b3JQcm9maWxlckNvbnRleHQoaW5qZWN0b3IsIHRva2VuLCBjYWxsYmFjaykgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoInJ1bkluSW5qZWN0b3JQcm9maWxlckNvbnRleHQgc2hvdWxkIG5ldmVyIGJlIGNhbGxlZCBpbiBwcm9kdWN0aW9uIG1vZGUiKTsKICBjb25zdCBwcmV2SW5qZWN0Q29udGV4dCA9IHNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KHsKICAgIGluamVjdG9yLAogICAgdG9rZW4KICB9KTsKICB0cnkgewogICAgY2FsbGJhY2soKTsKICB9IGZpbmFsbHkgewogICAgc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQocHJldkluamVjdENvbnRleHQpOwogIH0KfQpmdW5jdGlvbiBpc0Vudmlyb25tZW50UHJvdmlkZXJzKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlICYmICEhdmFsdWUuybVwcm92aWRlcnM7Cn0KdmFyIE5HX0NPTVBfREVGID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgybVjbXA6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBOR19ESVJfREVGID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgybVkaXI6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBOR19QSVBFX0RFRiA9IGdldENsb3N1cmVTYWZlUHJvcGVydHkoewogIMm1cGlwZTogZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eQp9KTsKdmFyIE5HX01PRF9ERUYgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICDJtW1vZDogZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eQp9KTsKdmFyIE5HX0ZBQ1RPUllfREVGID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgybVmYWM6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBOR19FTEVNRU5UX0lEID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgX19OR19FTEVNRU5UX0lEX186IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBOR19FTlZfSUQgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICBfX05HX0VOVl9JRF9fOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwpmdW5jdGlvbiBnZXROZ01vZHVsZURlZih0eXBlKSB7CiAgYXNzZXJ0VHlwZURlZmluZWQodHlwZSwgIkBOZ01vZHVsZSIpOwogIHJldHVybiB0eXBlW05HX01PRF9ERUZdIHx8IG51bGw7Cn0KZnVuY3Rpb24gZ2V0TmdNb2R1bGVEZWZPclRocm93KHR5cGUpIHsKICBjb25zdCBuZ01vZHVsZURlZiA9IGdldE5nTW9kdWxlRGVmKHR5cGUpOwogIGlmICghbmdNb2R1bGVEZWYpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTE1LCAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBgVHlwZSAke3N0cmluZ2lmeSh0eXBlKX0gZG9lcyBub3QgaGF2ZSAnybVtb2QnIHByb3BlcnR5LmApOwogIH0KICByZXR1cm4gbmdNb2R1bGVEZWY7Cn0KZnVuY3Rpb24gZ2V0Q29tcG9uZW50RGVmKHR5cGUpIHsKICBhc3NlcnRUeXBlRGVmaW5lZCh0eXBlLCAiQENvbXBvbmVudCIpOwogIHJldHVybiB0eXBlW05HX0NPTVBfREVGXSB8fCBudWxsOwp9CmZ1bmN0aW9uIGdldERpcmVjdGl2ZURlZk9yVGhyb3codHlwZSkgewogIGNvbnN0IGRlZiA9IGdldERpcmVjdGl2ZURlZih0eXBlKTsKICBpZiAoIWRlZikgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MTYsICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIGBUeXBlICR7c3RyaW5naWZ5KHR5cGUpfSBkb2VzIG5vdCBoYXZlICfJtWRpcicgcHJvcGVydHkuYCk7CiAgfQogIHJldHVybiBkZWY7Cn0KZnVuY3Rpb24gZ2V0RGlyZWN0aXZlRGVmKHR5cGUpIHsKICBhc3NlcnRUeXBlRGVmaW5lZCh0eXBlLCAiQERpcmVjdGl2ZSIpOwogIHJldHVybiB0eXBlW05HX0RJUl9ERUZdIHx8IG51bGw7Cn0KZnVuY3Rpb24gZ2V0UGlwZURlZih0eXBlKSB7CiAgYXNzZXJ0VHlwZURlZmluZWQodHlwZSwgIkBQaXBlIik7CiAgcmV0dXJuIHR5cGVbTkdfUElQRV9ERUZdIHx8IG51bGw7Cn0KZnVuY3Rpb24gYXNzZXJ0VHlwZURlZmluZWQodHlwZSwgc3ltYm9sVHlwZSkgewogIGlmICh0eXBlID09IG51bGwpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTkxOSwgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgYENhbm5vdCByZWFkICR7c3ltYm9sVHlwZX0gbWV0YWRhdGEuIFRoaXMgY2FuIGluZGljYXRlIGEgcnVudGltZSBjaXJjdWxhciBkZXBlbmRlbmN5IGluIHlvdXIgYXBwIHRoYXQgbmVlZHMgdG8gYmUgcmVzb2x2ZWQuYCk7CiAgfQp9CmZ1bmN0aW9uIGlzU3RhbmRhbG9uZSh0eXBlKSB7CiAgY29uc3QgZGVmID0gZ2V0Q29tcG9uZW50RGVmKHR5cGUpIHx8IGdldERpcmVjdGl2ZURlZih0eXBlKSB8fCBnZXRQaXBlRGVmKHR5cGUpOwogIHJldHVybiBkZWYgIT09IG51bGwgJiYgZGVmLnN0YW5kYWxvbmU7Cn0KZnVuY3Rpb24gcmVuZGVyU3RyaW5naWZ5KHZhbHVlKSB7CiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHJldHVybiB2YWx1ZTsKICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuICIiOwogIHJldHVybiBTdHJpbmcodmFsdWUpOwp9CmZ1bmN0aW9uIHN0cmluZ2lmeUZvckVycm9yKHZhbHVlKSB7CiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHZhbHVlLm5hbWUgfHwgdmFsdWUudG9TdHJpbmcoKTsKICBpZiAodHlwZW9mIHZhbHVlID09PSAib2JqZWN0IiAmJiB2YWx1ZSAhPSBudWxsICYmIHR5cGVvZiB2YWx1ZS50eXBlID09PSAiZnVuY3Rpb24iKSB7CiAgICByZXR1cm4gdmFsdWUudHlwZS5uYW1lIHx8IHZhbHVlLnR5cGUudG9TdHJpbmcoKTsKICB9CiAgcmV0dXJuIHJlbmRlclN0cmluZ2lmeSh2YWx1ZSk7Cn0KZnVuY3Rpb24gZGVidWdTdHJpbmdpZnlUeXBlRm9yRXJyb3IodHlwZSkgewogIGNvbnN0IGNvbXBvbmVudERlZiA9IGdldENvbXBvbmVudERlZih0eXBlKTsKICBpZiAoY29tcG9uZW50RGVmICE9PSBudWxsICYmIGNvbXBvbmVudERlZi5kZWJ1Z0luZm8pIHsKICAgIHJldHVybiBzdHJpbmdpZnlUeXBlRnJvbURlYnVnSW5mbyhjb21wb25lbnREZWYuZGVidWdJbmZvKTsKICB9CiAgcmV0dXJuIHN0cmluZ2lmeUZvckVycm9yKHR5cGUpOwp9CmZ1bmN0aW9uIHN0cmluZ2lmeVR5cGVGcm9tRGVidWdJbmZvKGRlYnVnSW5mbykgewogIGlmICghZGVidWdJbmZvLmZpbGVQYXRoIHx8ICFkZWJ1Z0luZm8ubGluZU51bWJlcikgewogICAgcmV0dXJuIGRlYnVnSW5mby5jbGFzc05hbWU7CiAgfSBlbHNlIHsKICAgIHJldHVybiBgJHtkZWJ1Z0luZm8uY2xhc3NOYW1lfSAoYXQgJHtkZWJ1Z0luZm8uZmlsZVBhdGh9OiR7ZGVidWdJbmZvLmxpbmVOdW1iZXJ9KWA7CiAgfQp9CnZhciBOR19SVU5USU1FX0VSUk9SX0NPREUgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICAibmdFcnJvckNvZGUiOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgTkdfUlVOVElNRV9FUlJPUl9NRVNTQUdFID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgIm5nRXJyb3JNZXNzYWdlIjogZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eQp9KTsKdmFyIE5HX1RPS0VOX1BBVEggPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICAibmdUb2tlblBhdGgiOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwpmdW5jdGlvbiBjeWNsaWNEZXBlbmRlbmN5RXJyb3IodG9rZW4sIHBhdGgpIHsKICBjb25zdCBtZXNzYWdlID0gbmdEZXZNb2RlID8gYENpcmN1bGFyIGRlcGVuZGVuY3kgZGV0ZWN0ZWQgZm9yIFxgJHt0b2tlbn1cYC5gIDogIiI7CiAgcmV0dXJuIGNyZWF0ZVJ1bnRpbWVFcnJvcihtZXNzYWdlLCAtMjAwLCBwYXRoKTsKfQpmdW5jdGlvbiBjeWNsaWNEZXBlbmRlbmN5RXJyb3JXaXRoRGV0YWlscyh0b2tlbiwgcGF0aCkgewogIHJldHVybiBhdWdtZW50UnVudGltZUVycm9yKGN5Y2xpY0RlcGVuZGVuY3lFcnJvcih0b2tlbiwgcGF0aCksIG51bGwpOwp9CmZ1bmN0aW9uIHRocm93TWl4ZWRNdWx0aVByb3ZpZGVyRXJyb3IoKSB7CiAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgbWl4IG11bHRpIHByb3ZpZGVycyBhbmQgcmVndWxhciBwcm92aWRlcnNgKTsKfQpmdW5jdGlvbiB0aHJvd0ludmFsaWRQcm92aWRlckVycm9yKG5nTW9kdWxlVHlwZSwgcHJvdmlkZXJzLCBwcm92aWRlcikgewogIGlmIChuZ01vZHVsZVR5cGUgJiYgcHJvdmlkZXJzKSB7CiAgICBjb25zdCBwcm92aWRlckRldGFpbCA9IHByb3ZpZGVycy5tYXAoKHYpID0+IHYgPT0gcHJvdmlkZXIgPyAiPyIgKyBwcm92aWRlciArICI/IiA6ICIuLi4iKTsKICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBwcm92aWRlciBmb3IgdGhlIE5nTW9kdWxlICcke3N0cmluZ2lmeShuZ01vZHVsZVR5cGUpfScgLSBvbmx5IGluc3RhbmNlcyBvZiBQcm92aWRlciBhbmQgVHlwZSBhcmUgYWxsb3dlZCwgZ290OiBbJHtwcm92aWRlckRldGFpbC5qb2luKCIsICIpfV1gKTsKICB9IGVsc2UgaWYgKGlzRW52aXJvbm1lbnRQcm92aWRlcnMocHJvdmlkZXIpKSB7CiAgICBpZiAocHJvdmlkZXIuybVmcm9tTmdNb2R1bGUpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigyMDcsIGBJbnZhbGlkIHByb3ZpZGVycyBmcm9tICdpbXBvcnRQcm92aWRlcnNGcm9tJyBwcmVzZW50IGluIGEgbm9uLWVudmlyb25tZW50IGluamVjdG9yLiAnaW1wb3J0UHJvdmlkZXJzRnJvbScgY2FuJ3QgYmUgdXNlZCBmb3IgY29tcG9uZW50IHByb3ZpZGVycy5gKTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMjA3LCBgSW52YWxpZCBwcm92aWRlcnMgcHJlc2VudCBpbiBhIG5vbi1lbnZpcm9ubWVudCBpbmplY3Rvci4gJ0Vudmlyb25tZW50UHJvdmlkZXJzJyBjYW4ndCBiZSB1c2VkIGZvciBjb21wb25lbnQgcHJvdmlkZXJzLmApOwogICAgfQogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgcHJvdmlkZXIiKTsKICB9Cn0KZnVuY3Rpb24gdGhyb3dQcm92aWRlck5vdEZvdW5kRXJyb3IodG9rZW4sIGluamVjdG9yTmFtZSkgewogIGNvbnN0IGVycm9yTWVzc2FnZSA9IG5nRGV2TW9kZSAmJiBgTm8gcHJvdmlkZXIgZm9yICR7c3RyaW5naWZ5Rm9yRXJyb3IodG9rZW4pfSBmb3VuZCR7aW5qZWN0b3JOYW1lID8gYCBpbiAke2luamVjdG9yTmFtZX1gIDogIiJ9YDsKICB0aHJvdyBuZXcgUnVudGltZUVycm9yKC0yMDEsIGVycm9yTWVzc2FnZSk7Cn0KZnVuY3Rpb24gcHJlcGVuZFRva2VuVG9EZXBlbmRlbmN5UGF0aChlcnJvciwgdG9rZW4pIHsKICBlcnJvcltOR19UT0tFTl9QQVRIXSA/Pz0gW107CiAgY29uc3QgY3VycmVudFBhdGggPSBlcnJvcltOR19UT0tFTl9QQVRIXTsKICBsZXQgcGF0aFN0cjsKICBpZiAodHlwZW9mIHRva2VuID09PSAib2JqZWN0IiAmJiAibXVsdGkiIGluIHRva2VuICYmIHRva2VuPy5tdWx0aSA9PT0gdHJ1ZSkgewogICAgYXNzZXJ0RGVmaW5lZCh0b2tlbi5wcm92aWRlLCAiVG9rZW4gd2l0aCBtdWx0aTogdHJ1ZSBzaG91bGQgaGF2ZSBhIHByb3ZpZGUgcHJvcGVydHkiKTsKICAgIHBhdGhTdHIgPSBzdHJpbmdpZnlGb3JFcnJvcih0b2tlbi5wcm92aWRlKTsKICB9IGVsc2UgewogICAgcGF0aFN0ciA9IHN0cmluZ2lmeUZvckVycm9yKHRva2VuKTsKICB9CiAgaWYgKGN1cnJlbnRQYXRoWzBdICE9PSBwYXRoU3RyKSB7CiAgICBlcnJvcltOR19UT0tFTl9QQVRIXS51bnNoaWZ0KHBhdGhTdHIpOwogIH0KfQpmdW5jdGlvbiBhdWdtZW50UnVudGltZUVycm9yKGVycm9yLCBzb3VyY2UpIHsKICBjb25zdCB0b2tlblBhdGggPSBlcnJvcltOR19UT0tFTl9QQVRIXTsKICBjb25zdCBlcnJvckNvZGUgPSBlcnJvcltOR19SVU5USU1FX0VSUk9SX0NPREVdOwogIGNvbnN0IG1lc3NhZ2UgPSBlcnJvcltOR19SVU5USU1FX0VSUk9SX01FU1NBR0VdIHx8IGVycm9yLm1lc3NhZ2U7CiAgZXJyb3IubWVzc2FnZSA9IGZvcm1hdEVycm9yTWVzc2FnZShtZXNzYWdlLCBlcnJvckNvZGUsIHRva2VuUGF0aCwgc291cmNlKTsKICByZXR1cm4gZXJyb3I7Cn0KZnVuY3Rpb24gY3JlYXRlUnVudGltZUVycm9yKG1lc3NhZ2UsIGNvZGUsIHBhdGgpIHsKICBjb25zdCBlcnJvciA9IG5ldyBSdW50aW1lRXJyb3IoY29kZSwgbWVzc2FnZSk7CiAgZXJyb3JbTkdfUlVOVElNRV9FUlJPUl9DT0RFXSA9IGNvZGU7CiAgZXJyb3JbTkdfUlVOVElNRV9FUlJPUl9NRVNTQUdFXSA9IG1lc3NhZ2U7CiAgaWYgKHBhdGgpIHsKICAgIGVycm9yW05HX1RPS0VOX1BBVEhdID0gcGF0aDsKICB9CiAgcmV0dXJuIGVycm9yOwp9CmZ1bmN0aW9uIGdldFJ1bnRpbWVFcnJvckNvZGUoZXJyb3IpIHsKICByZXR1cm4gZXJyb3JbTkdfUlVOVElNRV9FUlJPUl9DT0RFXTsKfQpmdW5jdGlvbiBmb3JtYXRFcnJvck1lc3NhZ2UodGV4dCwgY29kZSwgcGF0aCA9IFtdLCBzb3VyY2UgPSBudWxsKSB7CiAgbGV0IHBhdGhEZXRhaWxzID0gIiI7CiAgaWYgKHBhdGggJiYgcGF0aC5sZW5ndGggPiAxKSB7CiAgICBwYXRoRGV0YWlscyA9IGAgUGF0aDogJHtwYXRoLmpvaW4oIiAtPiAiKX0uYDsKICB9CiAgY29uc3Qgc291cmNlRGV0YWlscyA9IHNvdXJjZSA/IGAgU291cmNlOiAke3NvdXJjZX0uYCA6ICIiOwogIHJldHVybiBmb3JtYXRSdW50aW1lRXJyb3IoY29kZSwgYCR7dGV4dH0ke3NvdXJjZURldGFpbHN9JHtwYXRoRGV0YWlsc31gKTsKfQp2YXIgX2luamVjdEltcGxlbWVudGF0aW9uOwpmdW5jdGlvbiBnZXRJbmplY3RJbXBsZW1lbnRhdGlvbigpIHsKICByZXR1cm4gX2luamVjdEltcGxlbWVudGF0aW9uOwp9CmZ1bmN0aW9uIHNldEluamVjdEltcGxlbWVudGF0aW9uKGltcGwpIHsKICBjb25zdCBwcmV2aW91cyA9IF9pbmplY3RJbXBsZW1lbnRhdGlvbjsKICBfaW5qZWN0SW1wbGVtZW50YXRpb24gPSBpbXBsOwogIHJldHVybiBwcmV2aW91czsKfQpmdW5jdGlvbiBpbmplY3RSb290TGltcE1vZGUodG9rZW4sIG5vdEZvdW5kVmFsdWUsIGZsYWdzKSB7CiAgY29uc3QgaW5qZWN0YWJsZURlZiA9IGdldEluamVjdGFibGVEZWYodG9rZW4pOwogIGlmIChpbmplY3RhYmxlRGVmICYmIGluamVjdGFibGVEZWYucHJvdmlkZWRJbiA9PSAicm9vdCIpIHsKICAgIHJldHVybiBpbmplY3RhYmxlRGVmLnZhbHVlID09PSB2b2lkIDAgPyBpbmplY3RhYmxlRGVmLnZhbHVlID0gaW5qZWN0YWJsZURlZi5mYWN0b3J5KCkgOiBpbmplY3RhYmxlRGVmLnZhbHVlOwogIH0KICBpZiAoZmxhZ3MgJiA4KSByZXR1cm4gbnVsbDsKICBpZiAobm90Rm91bmRWYWx1ZSAhPT0gdm9pZCAwKSByZXR1cm4gbm90Rm91bmRWYWx1ZTsKICB0aHJvd1Byb3ZpZGVyTm90Rm91bmRFcnJvcih0b2tlbiwgdHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkluamVjdG9yIiA6ICIiKTsKfQpmdW5jdGlvbiBhc3NlcnRJbmplY3RJbXBsZW1lbnRhdGlvbk5vdEVxdWFsKGZuKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdEVxdWFsKF9pbmplY3RJbXBsZW1lbnRhdGlvbiwgZm4sICJDYWxsaW5nIMm1ybVpbmplY3Qgd291bGQgY2F1c2UgaW5maW5pdGUgcmVjdXJzaW9uIik7Cn0KdmFyIF9USFJPV19JRl9OT1RfRk9VTkQgPSB7fTsKdmFyIFRIUk9XX0lGX05PVF9GT1VORCA9IF9USFJPV19JRl9OT1RfRk9VTkQ7CnZhciBESV9ERUNPUkFUT1JfRkxBRyA9ICJfX05HX0RJX0ZMQUdfXyI7CnZhciBSZXRyaWV2aW5nSW5qZWN0b3IgPSBjbGFzcyB7CiAgaW5qZWN0b3I7CiAgY29uc3RydWN0b3IoaW5qZWN0b3IpIHsKICAgIHRoaXMuaW5qZWN0b3IgPSBpbmplY3RvcjsKICB9CiAgcmV0cmlldmUodG9rZW4sIG9wdGlvbnMpIHsKICAgIGNvbnN0IGZsYWdzID0gY29udmVydFRvQml0RmxhZ3Mob3B0aW9ucykgfHwgMDsKICAgIHRyeSB7CiAgICAgIHJldHVybiB0aGlzLmluamVjdG9yLmdldCh0b2tlbiwgZmxhZ3MgJiA4ID8gbnVsbCA6IFRIUk9XX0lGX05PVF9GT1VORCwgZmxhZ3MpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBpZiAoaXNOb3RGb3VuZChlKSkgewogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICAgIHRocm93IGU7CiAgICB9CiAgfQp9OwpmdW5jdGlvbiBpbmplY3RJbmplY3Rvck9ubHkodG9rZW4sIGZsYWdzID0gMCkgewogIGNvbnN0IGN1cnJlbnRJbmplY3RvciA9IGdldEN1cnJlbnRJbmplY3RvcigpOwogIGlmIChjdXJyZW50SW5qZWN0b3IgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtMjAzLCBuZ0Rldk1vZGUgJiYgYFRoZSBcYCR7c3RyaW5naWZ5KHRva2VuKX1cYCB0b2tlbiBpbmplY3Rpb24gZmFpbGVkLiBcYGluamVjdCgpXGAgZnVuY3Rpb24gbXVzdCBiZSBjYWxsZWQgZnJvbSBhbiBpbmplY3Rpb24gY29udGV4dCBzdWNoIGFzIGEgY29uc3RydWN0b3IsIGEgZmFjdG9yeSBmdW5jdGlvbiwgYSBmaWVsZCBpbml0aWFsaXplciwgb3IgYSBmdW5jdGlvbiB1c2VkIHdpdGggXGBydW5JbkluamVjdGlvbkNvbnRleHRcYC5gKTsKICB9IGVsc2UgaWYgKGN1cnJlbnRJbmplY3RvciA9PT0gbnVsbCkgewogICAgcmV0dXJuIGluamVjdFJvb3RMaW1wTW9kZSh0b2tlbiwgdm9pZCAwLCBmbGFncyk7CiAgfSBlbHNlIHsKICAgIGNvbnN0IG9wdGlvbnMgPSBjb252ZXJ0VG9JbmplY3RPcHRpb25zKGZsYWdzKTsKICAgIGNvbnN0IHZhbHVlID0gY3VycmVudEluamVjdG9yLnJldHJpZXZlKHRva2VuLCBvcHRpb25zKTsKICAgIG5nRGV2TW9kZSAmJiBlbWl0SW5qZWN0RXZlbnQodG9rZW4sIHZhbHVlLCBmbGFncyk7CiAgICBpZiAoaXNOb3RGb3VuZCh2YWx1ZSkpIHsKICAgICAgaWYgKG9wdGlvbnMub3B0aW9uYWwpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICB0aHJvdyB2YWx1ZTsKICAgIH0KICAgIHJldHVybiB2YWx1ZTsKICB9Cn0KZnVuY3Rpb24gybXJtWluamVjdCh0b2tlbiwgZmxhZ3MgPSAwKSB7CiAgcmV0dXJuIChnZXRJbmplY3RJbXBsZW1lbnRhdGlvbigpIHx8IGluamVjdEluamVjdG9yT25seSkocmVzb2x2ZUZvcndhcmRSZWYodG9rZW4pLCBmbGFncyk7Cn0KZnVuY3Rpb24gybXJtWludmFsaWRGYWN0b3J5RGVwKGluZGV4KSB7CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigyMDIsIG5nRGV2TW9kZSAmJiBgVGhpcyBjb25zdHJ1Y3RvciBpcyBub3QgY29tcGF0aWJsZSB3aXRoIEFuZ3VsYXIgRGVwZW5kZW5jeSBJbmplY3Rpb24gYmVjYXVzZSBpdHMgZGVwZW5kZW5jeSBhdCBpbmRleCAke2luZGV4fSBvZiB0aGUgcGFyYW1ldGVyIGxpc3QgaXMgaW52YWxpZC4KVGhpcyBjYW4gaGFwcGVuIGlmIHRoZSBkZXBlbmRlbmN5IHR5cGUgaXMgYSBwcmltaXRpdmUgbGlrZSBhIHN0cmluZyBvciBpZiBhbiBhbmNlc3RvciBvZiB0aGlzIGNsYXNzIGlzIG1pc3NpbmcgYW4gQW5ndWxhciBkZWNvcmF0b3IuCgpQbGVhc2UgY2hlY2sgdGhhdCAxKSB0aGUgdHlwZSBmb3IgdGhlIHBhcmFtZXRlciBhdCBpbmRleCAke2luZGV4fSBpcyBjb3JyZWN0IGFuZCAyKSB0aGUgY29ycmVjdCBBbmd1bGFyIGRlY29yYXRvcnMgYXJlIGRlZmluZWQgZm9yIHRoaXMgY2xhc3MgYW5kIGl0cyBhbmNlc3RvcnMuYCk7Cn0KZnVuY3Rpb24gaW5qZWN0Mih0b2tlbiwgb3B0aW9ucykgewogIHJldHVybiDJtcm1aW5qZWN0KHRva2VuLCBjb252ZXJ0VG9CaXRGbGFncyhvcHRpb25zKSk7Cn0KZnVuY3Rpb24gY29udmVydFRvQml0RmxhZ3MoZmxhZ3MpIHsKICBpZiAodHlwZW9mIGZsYWdzID09PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgZmxhZ3MgPT09ICJudW1iZXIiKSB7CiAgICByZXR1cm4gZmxhZ3M7CiAgfQogIHJldHVybiAwIHwgKGZsYWdzLm9wdGlvbmFsICYmIDgpIHwgKGZsYWdzLmhvc3QgJiYgMSkgfCAoZmxhZ3Muc2VsZiAmJiAyKSB8IChmbGFncy5za2lwU2VsZiAmJiA0KTsKfQpmdW5jdGlvbiBjb252ZXJ0VG9JbmplY3RPcHRpb25zKGZsYWdzKSB7CiAgcmV0dXJuIHsKICAgIG9wdGlvbmFsOiAhIShmbGFncyAmIDgpLAogICAgaG9zdDogISEoZmxhZ3MgJiAxKSwKICAgIHNlbGY6ICEhKGZsYWdzICYgMiksCiAgICBza2lwU2VsZjogISEoZmxhZ3MgJiA0KQogIH07Cn0KZnVuY3Rpb24gaW5qZWN0QXJncyh0eXBlcykgewogIGNvbnN0IGFyZ3MgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBhcmcgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlc1tpXSk7CiAgICBpZiAoQXJyYXkuaXNBcnJheShhcmcpKSB7CiAgICAgIGlmIChhcmcubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDAsIG5nRGV2TW9kZSAmJiAiQXJndW1lbnRzIGFycmF5IG11c3QgaGF2ZSBhcmd1bWVudHMuIik7CiAgICAgIH0KICAgICAgbGV0IHR5cGUgPSB2b2lkIDA7CiAgICAgIGxldCBmbGFncyA9IDA7CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXJnLmxlbmd0aDsgaisrKSB7CiAgICAgICAgY29uc3QgbWV0YSA9IGFyZ1tqXTsKICAgICAgICBjb25zdCBmbGFnID0gZ2V0SW5qZWN0RmxhZyhtZXRhKTsKICAgICAgICBpZiAodHlwZW9mIGZsYWcgPT09ICJudW1iZXIiKSB7CiAgICAgICAgICBpZiAoZmxhZyA9PT0gLTEpIHsKICAgICAgICAgICAgdHlwZSA9IG1ldGEudG9rZW47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmbGFncyB8PSBmbGFnOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0eXBlID0gbWV0YTsKICAgICAgICB9CiAgICAgIH0KICAgICAgYXJncy5wdXNoKMm1ybVpbmplY3QodHlwZSwgZmxhZ3MpKTsKICAgIH0gZWxzZSB7CiAgICAgIGFyZ3MucHVzaCjJtcm1aW5qZWN0KGFyZykpOwogICAgfQogIH0KICByZXR1cm4gYXJnczsKfQpmdW5jdGlvbiBhdHRhY2hJbmplY3RGbGFnKGRlY29yYXRvciwgZmxhZykgewogIGRlY29yYXRvcltESV9ERUNPUkFUT1JfRkxBR10gPSBmbGFnOwogIGRlY29yYXRvci5wcm90b3R5cGVbRElfREVDT1JBVE9SX0ZMQUddID0gZmxhZzsKICByZXR1cm4gZGVjb3JhdG9yOwp9CmZ1bmN0aW9uIGdldEluamVjdEZsYWcodG9rZW4pIHsKICByZXR1cm4gdG9rZW5bRElfREVDT1JBVE9SX0ZMQUddOwp9CmZ1bmN0aW9uIGdldEZhY3RvcnlEZWYodHlwZSwgdGhyb3dOb3RGb3VuZCkgewogIGNvbnN0IGhhc0ZhY3RvcnlEZWYgPSB0eXBlLmhhc093blByb3BlcnR5KE5HX0ZBQ1RPUllfREVGKTsKICBpZiAoIWhhc0ZhY3RvcnlEZWYgJiYgdGhyb3dOb3RGb3VuZCA9PT0gdHJ1ZSAmJiBuZ0Rldk1vZGUpIHsKICAgIHRocm93IG5ldyBFcnJvcihgVHlwZSAke3N0cmluZ2lmeSh0eXBlKX0gZG9lcyBub3QgaGF2ZSAnybVmYWMnIHByb3BlcnR5LmApOwogIH0KICByZXR1cm4gaGFzRmFjdG9yeURlZiA/IHR5cGVbTkdfRkFDVE9SWV9ERUZdIDogbnVsbDsKfQpmdW5jdGlvbiBhcnJheUVxdWFscyhhLCBiLCBpZGVudGl0eUFjY2Vzc29yKSB7CiAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlOwogIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgbGV0IHZhbHVlQSA9IGFbaV07CiAgICBsZXQgdmFsdWVCID0gYltpXTsKICAgIGlmIChpZGVudGl0eUFjY2Vzc29yKSB7CiAgICAgIHZhbHVlQSA9IGlkZW50aXR5QWNjZXNzb3IodmFsdWVBKTsKICAgICAgdmFsdWVCID0gaWRlbnRpdHlBY2Nlc3Nvcih2YWx1ZUIpOwogICAgfQogICAgaWYgKHZhbHVlQiAhPT0gdmFsdWVBKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgcmV0dXJuIHRydWU7Cn0KZnVuY3Rpb24gZmxhdHRlbihsaXN0KSB7CiAgcmV0dXJuIGxpc3QuZmxhdChOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpOwp9CmZ1bmN0aW9uIGRlZXBGb3JFYWNoKGlucHV0MiwgZm4pIHsKICBpbnB1dDIuZm9yRWFjaCgodmFsdWUpID0+IEFycmF5LmlzQXJyYXkodmFsdWUpID8gZGVlcEZvckVhY2godmFsdWUsIGZuKSA6IGZuKHZhbHVlKSk7Cn0KZnVuY3Rpb24gYWRkVG9BcnJheShhcnIsIGluZGV4LCB2YWx1ZSkgewogIGlmIChpbmRleCA+PSBhcnIubGVuZ3RoKSB7CiAgICBhcnIucHVzaCh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIGFyci5zcGxpY2UoaW5kZXgsIDAsIHZhbHVlKTsKICB9Cn0KZnVuY3Rpb24gcmVtb3ZlRnJvbUFycmF5KGFyciwgaW5kZXgpIHsKICBpZiAoaW5kZXggPj0gYXJyLmxlbmd0aCAtIDEpIHsKICAgIHJldHVybiBhcnIucG9wKCk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBhcnIuc3BsaWNlKGluZGV4LCAxKVswXTsKICB9Cn0KZnVuY3Rpb24gbmV3QXJyYXkoc2l6ZSwgdmFsdWUpIHsKICBjb25zdCBsaXN0ID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKICAgIGxpc3QucHVzaCh2YWx1ZSk7CiAgfQogIHJldHVybiBsaXN0Owp9CmZ1bmN0aW9uIGFycmF5U3BsaWNlKGFycmF5LCBpbmRleCwgY291bnQyKSB7CiAgY29uc3QgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIC0gY291bnQyOwogIHdoaWxlIChpbmRleCA8IGxlbmd0aCkgewogICAgYXJyYXlbaW5kZXhdID0gYXJyYXlbaW5kZXggKyBjb3VudDJdOwogICAgaW5kZXgrKzsKICB9CiAgd2hpbGUgKGNvdW50Mi0tKSB7CiAgICBhcnJheS5wb3AoKTsKICB9Cn0KZnVuY3Rpb24gYXJyYXlJbnNlcnQyKGFycmF5LCBpbmRleCwgdmFsdWUxLCB2YWx1ZTIpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TGVzc1RoYW5PckVxdWFsKGluZGV4LCBhcnJheS5sZW5ndGgsICJDYW4ndCBpbnNlcnQgcGFzdCBhcnJheSBlbmQuIik7CiAgbGV0IGVuZCA9IGFycmF5Lmxlbmd0aDsKICBpZiAoZW5kID09IGluZGV4KSB7CiAgICBhcnJheS5wdXNoKHZhbHVlMSwgdmFsdWUyKTsKICB9IGVsc2UgaWYgKGVuZCA9PT0gMSkgewogICAgYXJyYXkucHVzaCh2YWx1ZTIsIGFycmF5WzBdKTsKICAgIGFycmF5WzBdID0gdmFsdWUxOwogIH0gZWxzZSB7CiAgICBlbmQtLTsKICAgIGFycmF5LnB1c2goYXJyYXlbZW5kIC0gMV0sIGFycmF5W2VuZF0pOwogICAgd2hpbGUgKGVuZCA+IGluZGV4KSB7CiAgICAgIGNvbnN0IHByZXZpb3VzRW5kID0gZW5kIC0gMjsKICAgICAgYXJyYXlbZW5kXSA9IGFycmF5W3ByZXZpb3VzRW5kXTsKICAgICAgZW5kLS07CiAgICB9CiAgICBhcnJheVtpbmRleF0gPSB2YWx1ZTE7CiAgICBhcnJheVtpbmRleCArIDFdID0gdmFsdWUyOwogIH0KfQpmdW5jdGlvbiBrZXlWYWx1ZUFycmF5U2V0KGtleVZhbHVlQXJyYXksIGtleSwgdmFsdWUpIHsKICBsZXQgaW5kZXggPSBrZXlWYWx1ZUFycmF5SW5kZXhPZihrZXlWYWx1ZUFycmF5LCBrZXkpOwogIGlmIChpbmRleCA+PSAwKSB7CiAgICBrZXlWYWx1ZUFycmF5W2luZGV4IHwgMV0gPSB2YWx1ZTsKICB9IGVsc2UgewogICAgaW5kZXggPSB+aW5kZXg7CiAgICBhcnJheUluc2VydDIoa2V5VmFsdWVBcnJheSwgaW5kZXgsIGtleSwgdmFsdWUpOwogIH0KICByZXR1cm4gaW5kZXg7Cn0KZnVuY3Rpb24ga2V5VmFsdWVBcnJheUdldChrZXlWYWx1ZUFycmF5LCBrZXkpIHsKICBjb25zdCBpbmRleCA9IGtleVZhbHVlQXJyYXlJbmRleE9mKGtleVZhbHVlQXJyYXksIGtleSk7CiAgaWYgKGluZGV4ID49IDApIHsKICAgIHJldHVybiBrZXlWYWx1ZUFycmF5W2luZGV4IHwgMV07CiAgfQogIHJldHVybiB2b2lkIDA7Cn0KZnVuY3Rpb24ga2V5VmFsdWVBcnJheUluZGV4T2Yoa2V5VmFsdWVBcnJheSwga2V5KSB7CiAgcmV0dXJuIF9hcnJheUluZGV4T2ZTb3J0ZWQoa2V5VmFsdWVBcnJheSwga2V5LCAxKTsKfQpmdW5jdGlvbiBfYXJyYXlJbmRleE9mU29ydGVkKGFycmF5LCB2YWx1ZSwgc2hpZnQpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwoQXJyYXkuaXNBcnJheShhcnJheSksIHRydWUsICJFeHBlY3RpbmcgYW4gYXJyYXkiKTsKICBsZXQgc3RhcnQgPSAwOwogIGxldCBlbmQgPSBhcnJheS5sZW5ndGggPj4gc2hpZnQ7CiAgd2hpbGUgKGVuZCAhPT0gc3RhcnQpIHsKICAgIGNvbnN0IG1pZGRsZSA9IHN0YXJ0ICsgKGVuZCAtIHN0YXJ0ID4+IDEpOwogICAgY29uc3QgY3VycmVudCA9IGFycmF5W21pZGRsZSA8PCBzaGlmdF07CiAgICBpZiAodmFsdWUgPT09IGN1cnJlbnQpIHsKICAgICAgcmV0dXJuIG1pZGRsZSA8PCBzaGlmdDsKICAgIH0gZWxzZSBpZiAoY3VycmVudCA+IHZhbHVlKSB7CiAgICAgIGVuZCA9IG1pZGRsZTsKICAgIH0gZWxzZSB7CiAgICAgIHN0YXJ0ID0gbWlkZGxlICsgMTsKICAgIH0KICB9CiAgcmV0dXJuIH4oZW5kIDw8IHNoaWZ0KTsKfQp2YXIgRU1QVFlfT0JKID0ge307CnZhciBFTVBUWV9BUlJBWSA9IFtdOwppZiAoKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgaW5pdE5nRGV2TW9kZSgpKSB7CiAgT2JqZWN0LmZyZWV6ZShFTVBUWV9PQkopOwogIE9iamVjdC5mcmVlemUoRU1QVFlfQVJSQVkpOwp9CnZhciBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUiA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiRU5WSVJPTk1FTlRfSU5JVElBTElaRVIiIDogIiIpOwp2YXIgSU5KRUNUT1IkMSA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiSU5KRUNUT1IiIDogIiIsIC0xKTsKdmFyIElOSkVDVE9SX0RFRl9UWVBFUyA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiSU5KRUNUT1JfREVGX1RZUEVTIiA6ICIiKTsKdmFyIE51bGxJbmplY3RvciA9IGNsYXNzIHsKICBnZXQodG9rZW4sIG5vdEZvdW5kVmFsdWUgPSBUSFJPV19JRl9OT1RfRk9VTkQpIHsKICAgIGlmIChub3RGb3VuZFZhbHVlID09PSBUSFJPV19JRl9OT1RfRk9VTkQpIHsKICAgICAgY29uc3QgbWVzc2FnZSA9IG5nRGV2TW9kZSA/IGBObyBwcm92aWRlciBmb3VuZCBmb3IgXGAke3N0cmluZ2lmeSh0b2tlbil9XGAuYCA6ICIiOwogICAgICBjb25zdCBlcnJvciA9IGNyZWF0ZVJ1bnRpbWVFcnJvcihtZXNzYWdlLCAtMjAxKTsKICAgICAgZXJyb3IubmFtZSA9ICLJtU5vdEZvdW5kIjsKICAgICAgdGhyb3cgZXJyb3I7CiAgICB9CiAgICByZXR1cm4gbm90Rm91bmRWYWx1ZTsKICB9Cn07CmZ1bmN0aW9uIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhwcm92aWRlcnMpIHsKICByZXR1cm4gewogICAgybVwcm92aWRlcnM6IHByb3ZpZGVycwogIH07Cn0KZnVuY3Rpb24gcHJvdmlkZUVudmlyb25tZW50SW5pdGlhbGl6ZXIoaW5pdGlhbGl6ZXJGbikgewogIHJldHVybiBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMoW3sKICAgIHByb3ZpZGU6IEVOVklST05NRU5UX0lOSVRJQUxJWkVSLAogICAgbXVsdGk6IHRydWUsCiAgICB1c2VWYWx1ZTogaW5pdGlhbGl6ZXJGbgogIH1dKTsKfQpmdW5jdGlvbiBpbXBvcnRQcm92aWRlcnNGcm9tKC4uLnNvdXJjZXMpIHsKICByZXR1cm4gewogICAgybVwcm92aWRlcnM6IGludGVybmFsSW1wb3J0UHJvdmlkZXJzRnJvbSh0cnVlLCBzb3VyY2VzKSwKICAgIMm1ZnJvbU5nTW9kdWxlOiB0cnVlCiAgfTsKfQpmdW5jdGlvbiBpbnRlcm5hbEltcG9ydFByb3ZpZGVyc0Zyb20oY2hlY2tGb3JTdGFuZGFsb25lQ21wLCAuLi5zb3VyY2VzKSB7CiAgY29uc3QgcHJvdmlkZXJzT3V0ID0gW107CiAgY29uc3QgZGVkdXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwogIGxldCBpbmplY3RvclR5cGVzV2l0aFByb3ZpZGVyczsKICBjb25zdCBjb2xsZWN0UHJvdmlkZXJzID0gKHByb3ZpZGVyKSA9PiB7CiAgICBwcm92aWRlcnNPdXQucHVzaChwcm92aWRlcik7CiAgfTsKICBkZWVwRm9yRWFjaChzb3VyY2VzLCAoc291cmNlKSA9PiB7CiAgICBpZiAoKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgY2hlY2tGb3JTdGFuZGFsb25lQ21wKSB7CiAgICAgIGNvbnN0IGNtcERlZiA9IGdldENvbXBvbmVudERlZihzb3VyY2UpOwogICAgICBpZiAoY21wRGVmPy5zdGFuZGFsb25lKSB7CiAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig4MDAsIGBJbXBvcnRpbmcgcHJvdmlkZXJzIHN1cHBvcnRzIE5nTW9kdWxlIG9yIE1vZHVsZVdpdGhQcm92aWRlcnMgYnV0IGdvdCBhIHN0YW5kYWxvbmUgY29tcG9uZW50ICIke3N0cmluZ2lmeUZvckVycm9yKHNvdXJjZSl9ImApOwogICAgICB9CiAgICB9CiAgICBjb25zdCBpbnRlcm5hbFNvdXJjZSA9IHNvdXJjZTsKICAgIGlmICh3YWxrUHJvdmlkZXJUcmVlKGludGVybmFsU291cmNlLCBjb2xsZWN0UHJvdmlkZXJzLCBbXSwgZGVkdXApKSB7CiAgICAgIGluamVjdG9yVHlwZXNXaXRoUHJvdmlkZXJzIHx8PSBbXTsKICAgICAgaW5qZWN0b3JUeXBlc1dpdGhQcm92aWRlcnMucHVzaChpbnRlcm5hbFNvdXJjZSk7CiAgICB9CiAgfSk7CiAgaWYgKGluamVjdG9yVHlwZXNXaXRoUHJvdmlkZXJzICE9PSB2b2lkIDApIHsKICAgIHByb2Nlc3NJbmplY3RvclR5cGVzV2l0aFByb3ZpZGVycyhpbmplY3RvclR5cGVzV2l0aFByb3ZpZGVycywgY29sbGVjdFByb3ZpZGVycyk7CiAgfQogIHJldHVybiBwcm92aWRlcnNPdXQ7Cn0KZnVuY3Rpb24gcHJvY2Vzc0luamVjdG9yVHlwZXNXaXRoUHJvdmlkZXJzKHR5cGVzV2l0aFByb3ZpZGVycywgdmlzaXRvcikgewogIGZvciAobGV0IGkgPSAwOyBpIDwgdHlwZXNXaXRoUHJvdmlkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCB7CiAgICAgIG5nTW9kdWxlLAogICAgICBwcm92aWRlcnMKICAgIH0gPSB0eXBlc1dpdGhQcm92aWRlcnNbaV07CiAgICBkZWVwRm9yRWFjaFByb3ZpZGVyKHByb3ZpZGVycywgKHByb3ZpZGVyKSA9PiB7CiAgICAgIG5nRGV2TW9kZSAmJiB2YWxpZGF0ZVByb3ZpZGVyKHByb3ZpZGVyLCBwcm92aWRlcnMgfHwgRU1QVFlfQVJSQVksIG5nTW9kdWxlKTsKICAgICAgdmlzaXRvcihwcm92aWRlciwgbmdNb2R1bGUpOwogICAgfSk7CiAgfQp9CmZ1bmN0aW9uIHdhbGtQcm92aWRlclRyZWUoY29udGFpbmVyLCB2aXNpdG9yLCBwYXJlbnRzLCBkZWR1cCkgewogIGNvbnRhaW5lciA9IHJlc29sdmVGb3J3YXJkUmVmKGNvbnRhaW5lcik7CiAgaWYgKCFjb250YWluZXIpIHJldHVybiBmYWxzZTsKICBsZXQgZGVmVHlwZSA9IG51bGw7CiAgbGV0IGluakRlZiA9IGdldEluamVjdG9yRGVmKGNvbnRhaW5lcik7CiAgY29uc3QgY21wRGVmID0gIWluakRlZiAmJiBnZXRDb21wb25lbnREZWYoY29udGFpbmVyKTsKICBpZiAoIWluakRlZiAmJiAhY21wRGVmKSB7CiAgICBjb25zdCBuZ01vZHVsZSA9IGNvbnRhaW5lci5uZ01vZHVsZTsKICAgIGluakRlZiA9IGdldEluamVjdG9yRGVmKG5nTW9kdWxlKTsKICAgIGlmIChpbmpEZWYpIHsKICAgICAgZGVmVHlwZSA9IG5nTW9kdWxlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSBpZiAoY21wRGVmICYmICFjbXBEZWYuc3RhbmRhbG9uZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0gZWxzZSB7CiAgICBkZWZUeXBlID0gY29udGFpbmVyOwogIH0KICBpZiAobmdEZXZNb2RlICYmIHBhcmVudHMuaW5kZXhPZihkZWZUeXBlKSAhPT0gLTEpIHsKICAgIGNvbnN0IGRlZk5hbWUgPSBzdHJpbmdpZnkoZGVmVHlwZSk7CiAgICBjb25zdCBwYXRoID0gcGFyZW50cy5tYXAoc3RyaW5naWZ5KS5jb25jYXQoZGVmTmFtZSk7CiAgICB0aHJvdyBjeWNsaWNEZXBlbmRlbmN5RXJyb3JXaXRoRGV0YWlscyhkZWZOYW1lLCBwYXRoKTsKICB9CiAgY29uc3QgaXNEdXBsaWNhdGUgPSBkZWR1cC5oYXMoZGVmVHlwZSk7CiAgaWYgKGNtcERlZikgewogICAgaWYgKGlzRHVwbGljYXRlKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGRlZHVwLmFkZChkZWZUeXBlKTsKICAgIGlmIChjbXBEZWYuZGVwZW5kZW5jaWVzKSB7CiAgICAgIGNvbnN0IGRlcHMgPSB0eXBlb2YgY21wRGVmLmRlcGVuZGVuY2llcyA9PT0gImZ1bmN0aW9uIiA/IGNtcERlZi5kZXBlbmRlbmNpZXMoKSA6IGNtcERlZi5kZXBlbmRlbmNpZXM7CiAgICAgIGZvciAoY29uc3QgZGVwIG9mIGRlcHMpIHsKICAgICAgICB3YWxrUHJvdmlkZXJUcmVlKGRlcCwgdmlzaXRvciwgcGFyZW50cywgZGVkdXApOwogICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChpbmpEZWYpIHsKICAgIGlmIChpbmpEZWYuaW1wb3J0cyAhPSBudWxsICYmICFpc0R1cGxpY2F0ZSkgewogICAgICBuZ0Rldk1vZGUgJiYgcGFyZW50cy5wdXNoKGRlZlR5cGUpOwogICAgICBkZWR1cC5hZGQoZGVmVHlwZSk7CiAgICAgIGxldCBpbXBvcnRUeXBlc1dpdGhQcm92aWRlcnM7CiAgICAgIHRyeSB7CiAgICAgICAgZGVlcEZvckVhY2goaW5qRGVmLmltcG9ydHMsIChpbXBvcnRlZCkgPT4gewogICAgICAgICAgaWYgKHdhbGtQcm92aWRlclRyZWUoaW1wb3J0ZWQsIHZpc2l0b3IsIHBhcmVudHMsIGRlZHVwKSkgewogICAgICAgICAgICBpbXBvcnRUeXBlc1dpdGhQcm92aWRlcnMgfHw9IFtdOwogICAgICAgICAgICBpbXBvcnRUeXBlc1dpdGhQcm92aWRlcnMucHVzaChpbXBvcnRlZCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgbmdEZXZNb2RlICYmIHBhcmVudHMucG9wKCk7CiAgICAgIH0KICAgICAgaWYgKGltcG9ydFR5cGVzV2l0aFByb3ZpZGVycyAhPT0gdm9pZCAwKSB7CiAgICAgICAgcHJvY2Vzc0luamVjdG9yVHlwZXNXaXRoUHJvdmlkZXJzKGltcG9ydFR5cGVzV2l0aFByb3ZpZGVycywgdmlzaXRvcik7CiAgICAgIH0KICAgIH0KICAgIGlmICghaXNEdXBsaWNhdGUpIHsKICAgICAgY29uc3QgZmFjdG9yeSA9IGdldEZhY3RvcnlEZWYoZGVmVHlwZSkgfHwgKCgpID0+IG5ldyBkZWZUeXBlKCkpOwogICAgICB2aXNpdG9yKHsKICAgICAgICBwcm92aWRlOiBkZWZUeXBlLAogICAgICAgIHVzZUZhY3Rvcnk6IGZhY3RvcnksCiAgICAgICAgZGVwczogRU1QVFlfQVJSQVkKICAgICAgfSwgZGVmVHlwZSk7CiAgICAgIHZpc2l0b3IoewogICAgICAgIHByb3ZpZGU6IElOSkVDVE9SX0RFRl9UWVBFUywKICAgICAgICB1c2VWYWx1ZTogZGVmVHlwZSwKICAgICAgICBtdWx0aTogdHJ1ZQogICAgICB9LCBkZWZUeXBlKTsKICAgICAgdmlzaXRvcih7CiAgICAgICAgcHJvdmlkZTogRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsCiAgICAgICAgdXNlVmFsdWU6ICgpID0+IMm1ybVpbmplY3QoZGVmVHlwZSksCiAgICAgICAgbXVsdGk6IHRydWUKICAgICAgfSwgZGVmVHlwZSk7CiAgICB9CiAgICBjb25zdCBkZWZQcm92aWRlcnMgPSBpbmpEZWYucHJvdmlkZXJzOwogICAgaWYgKGRlZlByb3ZpZGVycyAhPSBudWxsICYmICFpc0R1cGxpY2F0ZSkgewogICAgICBjb25zdCBpbmplY3RvclR5cGUgPSBjb250YWluZXI7CiAgICAgIGRlZXBGb3JFYWNoUHJvdmlkZXIoZGVmUHJvdmlkZXJzLCAocHJvdmlkZXIpID0+IHsKICAgICAgICBuZ0Rldk1vZGUgJiYgdmFsaWRhdGVQcm92aWRlcihwcm92aWRlciwgZGVmUHJvdmlkZXJzLCBpbmplY3RvclR5cGUpOwogICAgICAgIHZpc2l0b3IocHJvdmlkZXIsIGluamVjdG9yVHlwZSk7CiAgICAgIH0pOwogICAgfQogIH0gZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiBkZWZUeXBlICE9PSBjb250YWluZXIgJiYgY29udGFpbmVyLnByb3ZpZGVycyAhPT0gdm9pZCAwOwp9CmZ1bmN0aW9uIHZhbGlkYXRlUHJvdmlkZXIocHJvdmlkZXIsIHByb3ZpZGVycywgY29udGFpbmVyVHlwZSkgewogIGlmIChpc1R5cGVQcm92aWRlcihwcm92aWRlcikgfHwgaXNWYWx1ZVByb3ZpZGVyKHByb3ZpZGVyKSB8fCBpc0ZhY3RvcnlQcm92aWRlcihwcm92aWRlcikgfHwgaXNFeGlzdGluZ1Byb3ZpZGVyKHByb3ZpZGVyKSkgewogICAgcmV0dXJuOwogIH0KICBjb25zdCBjbGFzc1JlZiA9IHJlc29sdmVGb3J3YXJkUmVmKHByb3ZpZGVyICYmIChwcm92aWRlci51c2VDbGFzcyB8fCBwcm92aWRlci5wcm92aWRlKSk7CiAgaWYgKCFjbGFzc1JlZikgewogICAgdGhyb3dJbnZhbGlkUHJvdmlkZXJFcnJvcihjb250YWluZXJUeXBlLCBwcm92aWRlcnMsIHByb3ZpZGVyKTsKICB9Cn0KZnVuY3Rpb24gZGVlcEZvckVhY2hQcm92aWRlcihwcm92aWRlcnMsIGZuKSB7CiAgZm9yIChsZXQgcHJvdmlkZXIgb2YgcHJvdmlkZXJzKSB7CiAgICBpZiAoaXNFbnZpcm9ubWVudFByb3ZpZGVycyhwcm92aWRlcikpIHsKICAgICAgcHJvdmlkZXIgPSBwcm92aWRlci7JtXByb3ZpZGVyczsKICAgIH0KICAgIGlmIChBcnJheS5pc0FycmF5KHByb3ZpZGVyKSkgewogICAgICBkZWVwRm9yRWFjaFByb3ZpZGVyKHByb3ZpZGVyLCBmbik7CiAgICB9IGVsc2UgewogICAgICBmbihwcm92aWRlcik7CiAgICB9CiAgfQp9CnZhciBVU0VfVkFMVUUgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICBwcm92aWRlOiBTdHJpbmcsCiAgdXNlVmFsdWU6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CmZ1bmN0aW9uIGlzVmFsdWVQcm92aWRlcih2YWx1ZSkgewogIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT0gIm9iamVjdCIgJiYgVVNFX1ZBTFVFIGluIHZhbHVlOwp9CmZ1bmN0aW9uIGlzRXhpc3RpbmdQcm92aWRlcih2YWx1ZSkgewogIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZS51c2VFeGlzdGluZyk7Cn0KZnVuY3Rpb24gaXNGYWN0b3J5UHJvdmlkZXIodmFsdWUpIHsKICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUudXNlRmFjdG9yeSk7Cn0KZnVuY3Rpb24gaXNUeXBlUHJvdmlkZXIodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAiZnVuY3Rpb24iOwp9CmZ1bmN0aW9uIGlzQ2xhc3NQcm92aWRlcih2YWx1ZSkgewogIHJldHVybiAhIXZhbHVlLnVzZUNsYXNzOwp9CnZhciBJTkpFQ1RPUl9TQ09QRSA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiU2V0IEluamVjdG9yIHNjb3BlLiIgOiAiIik7CnZhciBOT1RfWUVUID0ge307CnZhciBDSVJDVUxBUiA9IHt9Owp2YXIgTlVMTF9JTkpFQ1RPUiA9IHZvaWQgMDsKZnVuY3Rpb24gZ2V0TnVsbEluamVjdG9yKCkgewogIGlmIChOVUxMX0lOSkVDVE9SID09PSB2b2lkIDApIHsKICAgIE5VTExfSU5KRUNUT1IgPSBuZXcgTnVsbEluamVjdG9yKCk7CiAgfQogIHJldHVybiBOVUxMX0lOSkVDVE9SOwp9CnZhciBFbnZpcm9ubWVudEluamVjdG9yID0gY2xhc3Mgewp9Owp2YXIgUjNJbmplY3RvciA9IGNsYXNzIGV4dGVuZHMgRW52aXJvbm1lbnRJbmplY3RvciB7CiAgcGFyZW50OwogIHNvdXJjZTsKICBzY29wZXM7CiAgcmVjb3JkcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgX25nT25EZXN0cm95SG9va3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwogIF9vbkRlc3Ryb3lIb29rcyA9IFtdOwogIGdldCBkZXN0cm95ZWQoKSB7CiAgICByZXR1cm4gdGhpcy5fZGVzdHJveWVkOwogIH0KICBfZGVzdHJveWVkID0gZmFsc2U7CiAgaW5qZWN0b3JEZWZUeXBlczsKICBjb25zdHJ1Y3Rvcihwcm92aWRlcnMsIHBhcmVudCwgc291cmNlLCBzY29wZXMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDsKICAgIHRoaXMuc291cmNlID0gc291cmNlOwogICAgdGhpcy5zY29wZXMgPSBzY29wZXM7CiAgICBmb3JFYWNoU2luZ2xlUHJvdmlkZXIocHJvdmlkZXJzLCAocHJvdmlkZXIpID0+IHRoaXMucHJvY2Vzc1Byb3ZpZGVyKHByb3ZpZGVyKSk7CiAgICB0aGlzLnJlY29yZHMuc2V0KElOSkVDVE9SJDEsIG1ha2VSZWNvcmQodm9pZCAwLCB0aGlzKSk7CiAgICBpZiAoc2NvcGVzLmhhcygiZW52aXJvbm1lbnQiKSkgewogICAgICB0aGlzLnJlY29yZHMuc2V0KEVudmlyb25tZW50SW5qZWN0b3IsIG1ha2VSZWNvcmQodm9pZCAwLCB0aGlzKSk7CiAgICB9CiAgICBjb25zdCByZWNvcmQgPSB0aGlzLnJlY29yZHMuZ2V0KElOSkVDVE9SX1NDT1BFKTsKICAgIGlmIChyZWNvcmQgIT0gbnVsbCAmJiB0eXBlb2YgcmVjb3JkLnZhbHVlID09PSAic3RyaW5nIikgewogICAgICB0aGlzLnNjb3Blcy5hZGQocmVjb3JkLnZhbHVlKTsKICAgIH0KICAgIHRoaXMuaW5qZWN0b3JEZWZUeXBlcyA9IG5ldyBTZXQodGhpcy5nZXQoSU5KRUNUT1JfREVGX1RZUEVTLCBFTVBUWV9BUlJBWSwgewogICAgICBzZWxmOiB0cnVlCiAgICB9KSk7CiAgfQogIHJldHJpZXZlKHRva2VuLCBvcHRpb25zKSB7CiAgICBjb25zdCBmbGFncyA9IGNvbnZlcnRUb0JpdEZsYWdzKG9wdGlvbnMpIHx8IDA7CiAgICB0cnkgewogICAgICByZXR1cm4gdGhpcy5nZXQodG9rZW4sIFRIUk9XX0lGX05PVF9GT1VORCwgZmxhZ3MpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBpZiAoaXNOb3RGb3VuZChlKSkgewogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICAgIHRocm93IGU7CiAgICB9CiAgfQogIGRlc3Ryb3koKSB7CiAgICBhc3NlcnROb3REZXN0cm95ZWQodGhpcyk7CiAgICB0aGlzLl9kZXN0cm95ZWQgPSB0cnVlOwogICAgY29uc3QgcHJldkNvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgICB0cnkgewogICAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2YgdGhpcy5fbmdPbkRlc3Ryb3lIb29rcykgewogICAgICAgIHNlcnZpY2UubmdPbkRlc3Ryb3koKTsKICAgICAgfQogICAgICBjb25zdCBvbkRlc3Ryb3lIb29rcyA9IHRoaXMuX29uRGVzdHJveUhvb2tzOwogICAgICB0aGlzLl9vbkRlc3Ryb3lIb29rcyA9IFtdOwogICAgICBmb3IgKGNvbnN0IGhvb2sgb2Ygb25EZXN0cm95SG9va3MpIHsKICAgICAgICBob29rKCk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHRoaXMucmVjb3Jkcy5jbGVhcigpOwogICAgICB0aGlzLl9uZ09uRGVzdHJveUhvb2tzLmNsZWFyKCk7CiAgICAgIHRoaXMuaW5qZWN0b3JEZWZUeXBlcy5jbGVhcigpOwogICAgICBzZXRBY3RpdmVDb25zdW1lcihwcmV2Q29uc3VtZXIpOwogICAgfQogIH0KICBvbkRlc3Ryb3koY2FsbGJhY2spIHsKICAgIGFzc2VydE5vdERlc3Ryb3llZCh0aGlzKTsKICAgIHRoaXMuX29uRGVzdHJveUhvb2tzLnB1c2goY2FsbGJhY2spOwogICAgcmV0dXJuICgpID0+IHRoaXMucmVtb3ZlT25EZXN0cm95KGNhbGxiYWNrKTsKICB9CiAgcnVuSW5Db250ZXh0KGZuKSB7CiAgICBhc3NlcnROb3REZXN0cm95ZWQodGhpcyk7CiAgICBjb25zdCBwcmV2aW91c0luamVjdG9yID0gc2V0Q3VycmVudEluamVjdG9yKHRoaXMpOwogICAgY29uc3QgcHJldmlvdXNJbmplY3RJbXBsZW1lbnRhdGlvbiA9IHNldEluamVjdEltcGxlbWVudGF0aW9uKHZvaWQgMCk7CiAgICBsZXQgcHJldkluamVjdENvbnRleHQ7CiAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgIHByZXZJbmplY3RDb250ZXh0ID0gc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQoewogICAgICAgIGluamVjdG9yOiB0aGlzLAogICAgICAgIHRva2VuOiBudWxsCiAgICAgIH0pOwogICAgfQogICAgdHJ5IHsKICAgICAgcmV0dXJuIGZuKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBzZXRDdXJyZW50SW5qZWN0b3IocHJldmlvdXNJbmplY3Rvcik7CiAgICAgIHNldEluamVjdEltcGxlbWVudGF0aW9uKHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24pOwogICAgICBuZ0Rldk1vZGUgJiYgc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQocHJldkluamVjdENvbnRleHQpOwogICAgfQogIH0KICBnZXQodG9rZW4sIG5vdEZvdW5kVmFsdWUgPSBUSFJPV19JRl9OT1RfRk9VTkQsIG9wdGlvbnMpIHsKICAgIGFzc2VydE5vdERlc3Ryb3llZCh0aGlzKTsKICAgIGlmICh0b2tlbi5oYXNPd25Qcm9wZXJ0eShOR19FTlZfSUQpKSB7CiAgICAgIHJldHVybiB0b2tlbltOR19FTlZfSURdKHRoaXMpOwogICAgfQogICAgY29uc3QgZmxhZ3MgPSBjb252ZXJ0VG9CaXRGbGFncyhvcHRpb25zKTsKICAgIGxldCBwcmV2SW5qZWN0Q29udGV4dDsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgcHJldkluamVjdENvbnRleHQgPSBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCh7CiAgICAgICAgaW5qZWN0b3I6IHRoaXMsCiAgICAgICAgdG9rZW4KICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBwcmV2aW91c0luamVjdG9yID0gc2V0Q3VycmVudEluamVjdG9yKHRoaXMpOwogICAgY29uc3QgcHJldmlvdXNJbmplY3RJbXBsZW1lbnRhdGlvbiA9IHNldEluamVjdEltcGxlbWVudGF0aW9uKHZvaWQgMCk7CiAgICB0cnkgewogICAgICBpZiAoIShmbGFncyAmIDQpKSB7CiAgICAgICAgbGV0IHJlY29yZCA9IHRoaXMucmVjb3Jkcy5nZXQodG9rZW4pOwogICAgICAgIGlmIChyZWNvcmQgPT09IHZvaWQgMCkgewogICAgICAgICAgY29uc3QgZGVmID0gY291bGRCZUluamVjdGFibGVUeXBlKHRva2VuKSAmJiBnZXRJbmplY3RhYmxlRGVmKHRva2VuKTsKICAgICAgICAgIGlmIChkZWYgJiYgdGhpcy5pbmplY3RhYmxlRGVmSW5TY29wZShkZWYpKSB7CiAgICAgICAgICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgICAgICAgICBydW5JbkluamVjdG9yUHJvZmlsZXJDb250ZXh0KHRoaXMsIHRva2VuLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBlbWl0UHJvdmlkZXJDb25maWd1cmVkRXZlbnQodG9rZW4pOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlY29yZCA9IG1ha2VSZWNvcmQoaW5qZWN0YWJsZURlZk9ySW5qZWN0b3JEZWZGYWN0b3J5KHRva2VuKSwgTk9UX1lFVCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWNvcmQgPSBudWxsOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5yZWNvcmRzLnNldCh0b2tlbiwgcmVjb3JkKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlY29yZCAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5oeWRyYXRlKHRva2VuLCByZWNvcmQsIGZsYWdzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgbmV4dEluamVjdG9yID0gIShmbGFncyAmIDIpID8gdGhpcy5wYXJlbnQgOiBnZXROdWxsSW5qZWN0b3IoKTsKICAgICAgbm90Rm91bmRWYWx1ZSA9IGZsYWdzICYgOCAmJiBub3RGb3VuZFZhbHVlID09PSBUSFJPV19JRl9OT1RfRk9VTkQgPyBudWxsIDogbm90Rm91bmRWYWx1ZTsKICAgICAgcmV0dXJuIG5leHRJbmplY3Rvci5nZXQodG9rZW4sIG5vdEZvdW5kVmFsdWUpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc3QgZXJyb3JDb2RlID0gZ2V0UnVudGltZUVycm9yQ29kZShlcnJvcik7CiAgICAgIGlmIChlcnJvckNvZGUgPT09IC0yMDAgfHwgZXJyb3JDb2RlID09PSAtMjAxKSB7CiAgICAgICAgaWYgKG5nRGV2TW9kZSkgewogICAgICAgICAgcHJlcGVuZFRva2VuVG9EZXBlbmRlbmN5UGF0aChlcnJvciwgdG9rZW4pOwogICAgICAgICAgaWYgKHByZXZpb3VzSW5qZWN0b3IpIHsKICAgICAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyBhdWdtZW50UnVudGltZUVycm9yKGVycm9yLCB0aGlzLnNvdXJjZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoZXJyb3JDb2RlLCBudWxsKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEluamVjdEltcGxlbWVudGF0aW9uKHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24pOwogICAgICBzZXRDdXJyZW50SW5qZWN0b3IocHJldmlvdXNJbmplY3Rvcik7CiAgICAgIG5nRGV2TW9kZSAmJiBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dChwcmV2SW5qZWN0Q29udGV4dCk7CiAgICB9CiAgfQogIHJlc29sdmVJbmplY3RvckluaXRpYWxpemVycygpIHsKICAgIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogICAgY29uc3QgcHJldmlvdXNJbmplY3RvciA9IHNldEN1cnJlbnRJbmplY3Rvcih0aGlzKTsKICAgIGNvbnN0IHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24gPSBzZXRJbmplY3RJbXBsZW1lbnRhdGlvbih2b2lkIDApOwogICAgbGV0IHByZXZJbmplY3RDb250ZXh0OwogICAgaWYgKG5nRGV2TW9kZSkgewogICAgICBwcmV2SW5qZWN0Q29udGV4dCA9IHNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KHsKICAgICAgICBpbmplY3RvcjogdGhpcywKICAgICAgICB0b2tlbjogbnVsbAogICAgICB9KTsKICAgIH0KICAgIHRyeSB7CiAgICAgIGNvbnN0IGluaXRpYWxpemVycyA9IHRoaXMuZ2V0KEVOVklST05NRU5UX0lOSVRJQUxJWkVSLCBFTVBUWV9BUlJBWSwgewogICAgICAgIHNlbGY6IHRydWUKICAgICAgfSk7CiAgICAgIGlmIChuZ0Rldk1vZGUgJiYgIUFycmF5LmlzQXJyYXkoaW5pdGlhbGl6ZXJzKSkgewogICAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTIwOSwgYFVuZXhwZWN0ZWQgdHlwZSBvZiB0aGUgXGBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUlxgIHRva2VuIHZhbHVlIChleHBlY3RlZCBhbiBhcnJheSwgYnV0IGdvdCAke3R5cGVvZiBpbml0aWFsaXplcnN9KS4gUGxlYXNlIGNoZWNrIHRoYXQgdGhlIFxgRU5WSVJPTk1FTlRfSU5JVElBTElaRVJcYCB0b2tlbiBpcyBjb25maWd1cmVkIGFzIGEgXGBtdWx0aTogdHJ1ZVxgIHByb3ZpZGVyLmApOwogICAgICB9CiAgICAgIGZvciAoY29uc3QgaW5pdGlhbGl6ZXIgb2YgaW5pdGlhbGl6ZXJzKSB7CiAgICAgICAgaW5pdGlhbGl6ZXIoKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0Q3VycmVudEluamVjdG9yKHByZXZpb3VzSW5qZWN0b3IpOwogICAgICBzZXRJbmplY3RJbXBsZW1lbnRhdGlvbihwcmV2aW91c0luamVjdEltcGxlbWVudGF0aW9uKTsKICAgICAgbmdEZXZNb2RlICYmIHNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KHByZXZJbmplY3RDb250ZXh0KTsKICAgICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICAgIH0KICB9CiAgdG9TdHJpbmcoKSB7CiAgICBjb25zdCB0b2tlbnMgPSBbXTsKICAgIGNvbnN0IHJlY29yZHMgPSB0aGlzLnJlY29yZHM7CiAgICBmb3IgKGNvbnN0IHRva2VuIG9mIHJlY29yZHMua2V5cygpKSB7CiAgICAgIHRva2Vucy5wdXNoKHN0cmluZ2lmeSh0b2tlbikpOwogICAgfQogICAgcmV0dXJuIGBSM0luamVjdG9yWyR7dG9rZW5zLmpvaW4oIiwgIil9XWA7CiAgfQogIHByb2Nlc3NQcm92aWRlcihwcm92aWRlcikgewogICAgcHJvdmlkZXIgPSByZXNvbHZlRm9yd2FyZFJlZihwcm92aWRlcik7CiAgICBsZXQgdG9rZW4gPSBpc1R5cGVQcm92aWRlcihwcm92aWRlcikgPyBwcm92aWRlciA6IHJlc29sdmVGb3J3YXJkUmVmKHByb3ZpZGVyICYmIHByb3ZpZGVyLnByb3ZpZGUpOwogICAgY29uc3QgcmVjb3JkID0gcHJvdmlkZXJUb1JlY29yZChwcm92aWRlcik7CiAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgIHJ1bkluSW5qZWN0b3JQcm9maWxlckNvbnRleHQodGhpcywgdG9rZW4sICgpID0+IHsKICAgICAgICBpZiAoaXNWYWx1ZVByb3ZpZGVyKHByb3ZpZGVyKSkgewogICAgICAgICAgZW1pdEluamVjdG9yVG9DcmVhdGVJbnN0YW5jZUV2ZW50KHRva2VuKTsKICAgICAgICAgIGVtaXRJbnN0YW5jZUNyZWF0ZWRCeUluamVjdG9yRXZlbnQocHJvdmlkZXIudXNlVmFsdWUpOwogICAgICAgIH0KICAgICAgICBlbWl0UHJvdmlkZXJDb25maWd1cmVkRXZlbnQocHJvdmlkZXIpOwogICAgICB9KTsKICAgIH0KICAgIGlmICghaXNUeXBlUHJvdmlkZXIocHJvdmlkZXIpICYmIHByb3ZpZGVyLm11bHRpID09PSB0cnVlKSB7CiAgICAgIGxldCBtdWx0aVJlY29yZCA9IHRoaXMucmVjb3Jkcy5nZXQodG9rZW4pOwogICAgICBpZiAobXVsdGlSZWNvcmQpIHsKICAgICAgICBpZiAobmdEZXZNb2RlICYmIG11bHRpUmVjb3JkLm11bHRpID09PSB2b2lkIDApIHsKICAgICAgICAgIHRocm93TWl4ZWRNdWx0aVByb3ZpZGVyRXJyb3IoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbXVsdGlSZWNvcmQgPSBtYWtlUmVjb3JkKHZvaWQgMCwgTk9UX1lFVCwgdHJ1ZSk7CiAgICAgICAgbXVsdGlSZWNvcmQuZmFjdG9yeSA9ICgpID0+IGluamVjdEFyZ3MobXVsdGlSZWNvcmQubXVsdGkpOwogICAgICAgIHRoaXMucmVjb3Jkcy5zZXQodG9rZW4sIG11bHRpUmVjb3JkKTsKICAgICAgfQogICAgICB0b2tlbiA9IHByb3ZpZGVyOwogICAgICBtdWx0aVJlY29yZC5tdWx0aS5wdXNoKHByb3ZpZGVyKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgICBjb25zdCBleGlzdGluZyA9IHRoaXMucmVjb3Jkcy5nZXQodG9rZW4pOwogICAgICAgIGlmIChleGlzdGluZyAmJiBleGlzdGluZy5tdWx0aSAhPT0gdm9pZCAwKSB7CiAgICAgICAgICB0aHJvd01peGVkTXVsdGlQcm92aWRlckVycm9yKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICB0aGlzLnJlY29yZHMuc2V0KHRva2VuLCByZWNvcmQpOwogIH0KICBoeWRyYXRlKHRva2VuLCByZWNvcmQsIGZsYWdzKSB7CiAgICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgIHRyeSB7CiAgICAgIGlmIChyZWNvcmQudmFsdWUgPT09IENJUkNVTEFSKSB7CiAgICAgICAgdGhyb3cgY3ljbGljRGVwZW5kZW5jeUVycm9yKHN0cmluZ2lmeSh0b2tlbikpOwogICAgICB9IGVsc2UgaWYgKHJlY29yZC52YWx1ZSA9PT0gTk9UX1lFVCkgewogICAgICAgIHJlY29yZC52YWx1ZSA9IENJUkNVTEFSOwogICAgICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgICAgIHJ1bkluSW5qZWN0b3JQcm9maWxlckNvbnRleHQodGhpcywgdG9rZW4sICgpID0+IHsKICAgICAgICAgICAgZW1pdEluamVjdG9yVG9DcmVhdGVJbnN0YW5jZUV2ZW50KHRva2VuKTsKICAgICAgICAgICAgcmVjb3JkLnZhbHVlID0gcmVjb3JkLmZhY3Rvcnkodm9pZCAwLCBmbGFncyk7CiAgICAgICAgICAgIGVtaXRJbnN0YW5jZUNyZWF0ZWRCeUluamVjdG9yRXZlbnQocmVjb3JkLnZhbHVlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZWNvcmQudmFsdWUgPSByZWNvcmQuZmFjdG9yeSh2b2lkIDAsIGZsYWdzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiByZWNvcmQudmFsdWUgPT09ICJvYmplY3QiICYmIHJlY29yZC52YWx1ZSAmJiBoYXNPbkRlc3Ryb3kocmVjb3JkLnZhbHVlKSkgewogICAgICAgIHRoaXMuX25nT25EZXN0cm95SG9va3MuYWRkKHJlY29yZC52YWx1ZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlY29yZC52YWx1ZTsKICAgIH0gZmluYWxseSB7CiAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICB9CiAgfQogIGluamVjdGFibGVEZWZJblNjb3BlKGRlZikgewogICAgaWYgKCFkZWYucHJvdmlkZWRJbikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBjb25zdCBwcm92aWRlZEluID0gcmVzb2x2ZUZvcndhcmRSZWYoZGVmLnByb3ZpZGVkSW4pOwogICAgaWYgKHR5cGVvZiBwcm92aWRlZEluID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gcHJvdmlkZWRJbiA9PT0gImFueSIgfHwgdGhpcy5zY29wZXMuaGFzKHByb3ZpZGVkSW4pOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMuaW5qZWN0b3JEZWZUeXBlcy5oYXMocHJvdmlkZWRJbik7CiAgICB9CiAgfQogIHJlbW92ZU9uRGVzdHJveShjYWxsYmFjaykgewogICAgY29uc3QgZGVzdHJveUNCSWR4ID0gdGhpcy5fb25EZXN0cm95SG9va3MuaW5kZXhPZihjYWxsYmFjayk7CiAgICBpZiAoZGVzdHJveUNCSWR4ICE9PSAtMSkgewogICAgICB0aGlzLl9vbkRlc3Ryb3lIb29rcy5zcGxpY2UoZGVzdHJveUNCSWR4LCAxKTsKICAgIH0KICB9Cn07CmZ1bmN0aW9uIGluamVjdGFibGVEZWZPckluamVjdG9yRGVmRmFjdG9yeSh0b2tlbikgewogIGNvbnN0IGluamVjdGFibGVEZWYgPSBnZXRJbmplY3RhYmxlRGVmKHRva2VuKTsKICBjb25zdCBmYWN0b3J5ID0gaW5qZWN0YWJsZURlZiAhPT0gbnVsbCA/IGluamVjdGFibGVEZWYuZmFjdG9yeSA6IGdldEZhY3RvcnlEZWYodG9rZW4pOwogIGlmIChmYWN0b3J5ICE9PSBudWxsKSB7CiAgICByZXR1cm4gZmFjdG9yeTsKICB9CiAgaWYgKHRva2VuIGluc3RhbmNlb2YgSW5qZWN0aW9uVG9rZW4pIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMjA0LCBuZ0Rldk1vZGUgJiYgYFRva2VuICR7c3RyaW5naWZ5KHRva2VuKX0gaXMgbWlzc2luZyBhIMm1cHJvdiBkZWZpbml0aW9uLmApOwogIH0KICBpZiAodG9rZW4gaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgcmV0dXJuIGdldFVuZGVjb3JhdGVkSW5qZWN0YWJsZUZhY3RvcnkodG9rZW4pOwogIH0KICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDIwNCwgbmdEZXZNb2RlICYmICJ1bnJlYWNoYWJsZSIpOwp9CmZ1bmN0aW9uIGdldFVuZGVjb3JhdGVkSW5qZWN0YWJsZUZhY3RvcnkodG9rZW4pIHsKICBjb25zdCBwYXJhbUxlbmd0aCA9IHRva2VuLmxlbmd0aDsKICBpZiAocGFyYW1MZW5ndGggPiAwKSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDIwNCwgbmdEZXZNb2RlICYmIGBDYW4ndCByZXNvbHZlIGFsbCBwYXJhbWV0ZXJzIGZvciAke3N0cmluZ2lmeSh0b2tlbil9OiAoJHtuZXdBcnJheShwYXJhbUxlbmd0aCwgIj8iKS5qb2luKCIsICIpfSkuYCk7CiAgfQogIGNvbnN0IGluaGVyaXRlZEluamVjdGFibGVEZWYgPSBnZXRJbmhlcml0ZWRJbmplY3RhYmxlRGVmKHRva2VuKTsKICBpZiAoaW5oZXJpdGVkSW5qZWN0YWJsZURlZiAhPT0gbnVsbCkgewogICAgcmV0dXJuICgpID0+IGluaGVyaXRlZEluamVjdGFibGVEZWYuZmFjdG9yeSh0b2tlbik7CiAgfSBlbHNlIHsKICAgIHJldHVybiAoKSA9PiBuZXcgdG9rZW4oKTsKICB9Cn0KZnVuY3Rpb24gcHJvdmlkZXJUb1JlY29yZChwcm92aWRlcikgewogIGlmIChpc1ZhbHVlUHJvdmlkZXIocHJvdmlkZXIpKSB7CiAgICByZXR1cm4gbWFrZVJlY29yZCh2b2lkIDAsIHByb3ZpZGVyLnVzZVZhbHVlKTsKICB9IGVsc2UgewogICAgY29uc3QgZmFjdG9yeSA9IHByb3ZpZGVyVG9GYWN0b3J5KHByb3ZpZGVyKTsKICAgIHJldHVybiBtYWtlUmVjb3JkKGZhY3RvcnksIE5PVF9ZRVQpOwogIH0KfQpmdW5jdGlvbiBwcm92aWRlclRvRmFjdG9yeShwcm92aWRlciwgbmdNb2R1bGVUeXBlLCBwcm92aWRlcnMpIHsKICBsZXQgZmFjdG9yeSA9IHZvaWQgMDsKICBpZiAobmdEZXZNb2RlICYmIGlzRW52aXJvbm1lbnRQcm92aWRlcnMocHJvdmlkZXIpKSB7CiAgICB0aHJvd0ludmFsaWRQcm92aWRlckVycm9yKHZvaWQgMCwgcHJvdmlkZXJzLCBwcm92aWRlcik7CiAgfQogIGlmIChpc1R5cGVQcm92aWRlcihwcm92aWRlcikpIHsKICAgIGNvbnN0IHVud3JhcHBlZFByb3ZpZGVyID0gcmVzb2x2ZUZvcndhcmRSZWYocHJvdmlkZXIpOwogICAgcmV0dXJuIGdldEZhY3RvcnlEZWYodW53cmFwcGVkUHJvdmlkZXIpIHx8IGluamVjdGFibGVEZWZPckluamVjdG9yRGVmRmFjdG9yeSh1bndyYXBwZWRQcm92aWRlcik7CiAgfSBlbHNlIHsKICAgIGlmIChpc1ZhbHVlUHJvdmlkZXIocHJvdmlkZXIpKSB7CiAgICAgIGZhY3RvcnkgPSAoKSA9PiByZXNvbHZlRm9yd2FyZFJlZihwcm92aWRlci51c2VWYWx1ZSk7CiAgICB9IGVsc2UgaWYgKGlzRmFjdG9yeVByb3ZpZGVyKHByb3ZpZGVyKSkgewogICAgICBmYWN0b3J5ID0gKCkgPT4gcHJvdmlkZXIudXNlRmFjdG9yeSguLi5pbmplY3RBcmdzKHByb3ZpZGVyLmRlcHMgfHwgW10pKTsKICAgIH0gZWxzZSBpZiAoaXNFeGlzdGluZ1Byb3ZpZGVyKHByb3ZpZGVyKSkgewogICAgICBmYWN0b3J5ID0gKF8sIGZsYWdzKSA9PiDJtcm1aW5qZWN0KHJlc29sdmVGb3J3YXJkUmVmKHByb3ZpZGVyLnVzZUV4aXN0aW5nKSwgZmxhZ3MgIT09IHZvaWQgMCAmJiBmbGFncyAmIDggPyA4IDogdm9pZCAwKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGNsYXNzUmVmID0gcmVzb2x2ZUZvcndhcmRSZWYocHJvdmlkZXIgJiYgKHByb3ZpZGVyLnVzZUNsYXNzIHx8IHByb3ZpZGVyLnByb3ZpZGUpKTsKICAgICAgaWYgKG5nRGV2TW9kZSAmJiAhY2xhc3NSZWYpIHsKICAgICAgICB0aHJvd0ludmFsaWRQcm92aWRlckVycm9yKG5nTW9kdWxlVHlwZSwgcHJvdmlkZXJzLCBwcm92aWRlcik7CiAgICAgIH0KICAgICAgaWYgKGhhc0RlcHMocHJvdmlkZXIpKSB7CiAgICAgICAgZmFjdG9yeSA9ICgpID0+IG5ldyBjbGFzc1JlZiguLi5pbmplY3RBcmdzKHByb3ZpZGVyLmRlcHMpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZ2V0RmFjdG9yeURlZihjbGFzc1JlZikgfHwgaW5qZWN0YWJsZURlZk9ySW5qZWN0b3JEZWZGYWN0b3J5KGNsYXNzUmVmKTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gZmFjdG9yeTsKfQpmdW5jdGlvbiBhc3NlcnROb3REZXN0cm95ZWQoaW5qZWN0b3IpIHsKICBpZiAoaW5qZWN0b3IuZGVzdHJveWVkKSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDIwNSwgbmdEZXZNb2RlICYmICJJbmplY3RvciBoYXMgYWxyZWFkeSBiZWVuIGRlc3Ryb3llZC4iKTsKICB9Cn0KZnVuY3Rpb24gbWFrZVJlY29yZChmYWN0b3J5LCB2YWx1ZSwgbXVsdGkgPSBmYWxzZSkgewogIHJldHVybiB7CiAgICBmYWN0b3J5LAogICAgdmFsdWUsCiAgICBtdWx0aTogbXVsdGkgPyBbXSA6IHZvaWQgMAogIH07Cn0KZnVuY3Rpb24gaGFzRGVwcyh2YWx1ZSkgewogIHJldHVybiAhIXZhbHVlLmRlcHM7Cn0KZnVuY3Rpb24gaGFzT25EZXN0cm95KHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gIm9iamVjdCIgJiYgdHlwZW9mIHZhbHVlLm5nT25EZXN0cm95ID09PSAiZnVuY3Rpb24iOwp9CmZ1bmN0aW9uIGNvdWxkQmVJbmplY3RhYmxlVHlwZSh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIgfHwgdHlwZW9mIHZhbHVlID09PSAib2JqZWN0IiAmJiB2YWx1ZS5uZ01ldGFkYXRhTmFtZSA9PT0gIkluamVjdGlvblRva2VuIjsKfQpmdW5jdGlvbiBmb3JFYWNoU2luZ2xlUHJvdmlkZXIocHJvdmlkZXJzLCBmbikgewogIGZvciAoY29uc3QgcHJvdmlkZXIgb2YgcHJvdmlkZXJzKSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm92aWRlcikpIHsKICAgICAgZm9yRWFjaFNpbmdsZVByb3ZpZGVyKHByb3ZpZGVyLCBmbik7CiAgICB9IGVsc2UgaWYgKHByb3ZpZGVyICYmIGlzRW52aXJvbm1lbnRQcm92aWRlcnMocHJvdmlkZXIpKSB7CiAgICAgIGZvckVhY2hTaW5nbGVQcm92aWRlcihwcm92aWRlci7JtXByb3ZpZGVycywgZm4pOwogICAgfSBlbHNlIHsKICAgICAgZm4ocHJvdmlkZXIpOwogICAgfQogIH0KfQpmdW5jdGlvbiBydW5JbkluamVjdGlvbkNvbnRleHQoaW5qZWN0b3IsIGZuKSB7CiAgbGV0IGludGVybmFsSW5qZWN0b3I7CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgUjNJbmplY3RvcikgewogICAgYXNzZXJ0Tm90RGVzdHJveWVkKGluamVjdG9yKTsKICAgIGludGVybmFsSW5qZWN0b3IgPSBpbmplY3RvcjsKICB9IGVsc2UgewogICAgaW50ZXJuYWxJbmplY3RvciA9IG5ldyBSZXRyaWV2aW5nSW5qZWN0b3IoaW5qZWN0b3IpOwogIH0KICBsZXQgcHJldkluamVjdG9yUHJvZmlsZXJDb250ZXh0OwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHByZXZJbmplY3RvclByb2ZpbGVyQ29udGV4dCA9IHNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KHsKICAgICAgaW5qZWN0b3IsCiAgICAgIHRva2VuOiBudWxsCiAgICB9KTsKICB9CiAgY29uc3QgcHJldkluamVjdG9yID0gc2V0Q3VycmVudEluamVjdG9yKGludGVybmFsSW5qZWN0b3IpOwogIGNvbnN0IHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24gPSBzZXRJbmplY3RJbXBsZW1lbnRhdGlvbih2b2lkIDApOwogIHRyeSB7CiAgICByZXR1cm4gZm4oKTsKICB9IGZpbmFsbHkgewogICAgc2V0Q3VycmVudEluamVjdG9yKHByZXZJbmplY3Rvcik7CiAgICBuZ0Rldk1vZGUgJiYgc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQocHJldkluamVjdG9yUHJvZmlsZXJDb250ZXh0KTsKICAgIHNldEluamVjdEltcGxlbWVudGF0aW9uKHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24pOwogIH0KfQpmdW5jdGlvbiBpc0luSW5qZWN0aW9uQ29udGV4dCgpIHsKICByZXR1cm4gZ2V0SW5qZWN0SW1wbGVtZW50YXRpb24oKSAhPT0gdm9pZCAwIHx8IGdldEN1cnJlbnRJbmplY3RvcigpICE9IG51bGw7Cn0KZnVuY3Rpb24gYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0KGRlYnVnRm4pIHsKICBpZiAoIWlzSW5JbmplY3Rpb25Db250ZXh0KCkpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTIwMywgbmdEZXZNb2RlICYmIGRlYnVnRm4ubmFtZSArICIoKSBjYW4gb25seSBiZSB1c2VkIHdpdGhpbiBhbiBpbmplY3Rpb24gY29udGV4dCBzdWNoIGFzIGEgY29uc3RydWN0b3IsIGEgZmFjdG9yeSBmdW5jdGlvbiwgYSBmaWVsZCBpbml0aWFsaXplciwgb3IgYSBmdW5jdGlvbiB1c2VkIHdpdGggYHJ1bkluSW5qZWN0aW9uQ29udGV4dGAiKTsKICB9Cn0KdmFyIEhPU1QgPSAwOwp2YXIgVFZJRVcgPSAxOwp2YXIgRkxBR1MgPSAyOwp2YXIgUEFSRU5UID0gMzsKdmFyIE5FWFQgPSA0Owp2YXIgVF9IT1NUID0gNTsKdmFyIEhZRFJBVElPTiA9IDY7CnZhciBDTEVBTlVQID0gNzsKdmFyIENPTlRFWFQgPSA4Owp2YXIgSU5KRUNUT1IgPSA5Owp2YXIgRU5WSVJPTk1FTlQgPSAxMDsKdmFyIFJFTkRFUkVSID0gMTE7CnZhciBDSElMRF9IRUFEID0gMTI7CnZhciBDSElMRF9UQUlMID0gMTM7CnZhciBERUNMQVJBVElPTl9WSUVXID0gMTQ7CnZhciBERUNMQVJBVElPTl9DT01QT05FTlRfVklFVyA9IDE1Owp2YXIgREVDTEFSQVRJT05fTENPTlRBSU5FUiA9IDE2Owp2YXIgUFJFT1JERVJfSE9PS19GTEFHUyA9IDE3Owp2YXIgUVVFUklFUyA9IDE4Owp2YXIgSUQgPSAxOTsKdmFyIEVNQkVEREVEX1ZJRVdfSU5KRUNUT1IgPSAyMDsKdmFyIE9OX0RFU1RST1lfSE9PS1MgPSAyMTsKdmFyIEVGRkVDVFNfVE9fU0NIRURVTEUgPSAyMjsKdmFyIEVGRkVDVFMgPSAyMzsKdmFyIFJFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSID0gMjQ7CnZhciBBRlRFUl9SRU5ERVJfU0VRVUVOQ0VTX1RPX0FERCA9IDI1Owp2YXIgQU5JTUFUSU9OUyA9IDI2Owp2YXIgSEVBREVSX09GRlNFVCA9IDI3Owp2YXIgVFlQRSA9IDE7CnZhciBERUhZRFJBVEVEX1ZJRVdTID0gNjsKdmFyIE5BVElWRSA9IDc7CnZhciBWSUVXX1JFRlMgPSA4Owp2YXIgTU9WRURfVklFV1MgPSA5Owp2YXIgQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQgPSAxMDsKZnVuY3Rpb24gaXNMVmlldyh2YWx1ZSkgewogIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB0eXBlb2YgdmFsdWVbVFlQRV0gPT09ICJvYmplY3QiOwp9CmZ1bmN0aW9uIGlzTENvbnRhaW5lcih2YWx1ZSkgewogIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZVtUWVBFXSA9PT0gdHJ1ZTsKfQpmdW5jdGlvbiBpc0NvbnRlbnRRdWVyeUhvc3QodE5vZGUpIHsKICByZXR1cm4gKHROb2RlLmZsYWdzICYgNCkgIT09IDA7Cn0KZnVuY3Rpb24gaXNDb21wb25lbnRIb3N0KHROb2RlKSB7CiAgcmV0dXJuIHROb2RlLmNvbXBvbmVudE9mZnNldCA+IC0xOwp9CmZ1bmN0aW9uIGlzRGlyZWN0aXZlSG9zdCh0Tm9kZSkgewogIHJldHVybiAodE5vZGUuZmxhZ3MgJiAxKSA9PT0gMTsKfQpmdW5jdGlvbiBpc0NvbXBvbmVudERlZihkZWYpIHsKICByZXR1cm4gISFkZWYudGVtcGxhdGU7Cn0KZnVuY3Rpb24gaXNSb290Vmlldyh0YXJnZXQpIHsKICByZXR1cm4gKHRhcmdldFtGTEFHU10gJiA1MTIpICE9PSAwOwp9CmZ1bmN0aW9uIGlzUHJvamVjdGlvblROb2RlKHROb2RlKSB7CiAgcmV0dXJuICh0Tm9kZS50eXBlICYgMTYpID09PSAxNjsKfQpmdW5jdGlvbiBoYXNJMThuKGxWaWV3KSB7CiAgcmV0dXJuIChsVmlld1tGTEFHU10gJiAzMikgPT09IDMyOwp9CmZ1bmN0aW9uIGlzRGVzdHJveWVkKGxWaWV3KSB7CiAgcmV0dXJuIChsVmlld1tGTEFHU10gJiAyNTYpID09PSAyNTY7Cn0KZnVuY3Rpb24gYXNzZXJ0VE5vZGVGb3JMVmlldyh0Tm9kZSwgbFZpZXcpIHsKICBhc3NlcnRUTm9kZUZvclRWaWV3KHROb2RlLCBsVmlld1tUVklFV10pOwp9CmZ1bmN0aW9uIGFzc2VydFROb2RlQ3JlYXRpb25JbmRleChsVmlldywgaW5kZXgpIHsKICBjb25zdCBhZGp1c3RlZEluZGV4ID0gaW5kZXggKyBIRUFERVJfT0ZGU0VUOwogIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgYWRqdXN0ZWRJbmRleCk7CiAgYXNzZXJ0TGVzc1RoYW4oYWRqdXN0ZWRJbmRleCwgbFZpZXdbVFZJRVddLmJpbmRpbmdTdGFydEluZGV4LCAiVE5vZGVzIHNob3VsZCBiZSBjcmVhdGVkIGJlZm9yZSBhbnkgYmluZGluZ3MiKTsKfQpmdW5jdGlvbiBhc3NlcnRUTm9kZUZvclRWaWV3KHROb2RlLCB0VmlldykgewogIGFzc2VydFROb2RlKHROb2RlKTsKICBjb25zdCB0RGF0YSA9IHRWaWV3LmRhdGE7CiAgZm9yIChsZXQgaSA9IEhFQURFUl9PRkZTRVQ7IGkgPCB0RGF0YS5sZW5ndGg7IGkrKykgewogICAgaWYgKHREYXRhW2ldID09PSB0Tm9kZSkgewogICAgICByZXR1cm47CiAgICB9CiAgfQogIHRocm93RXJyb3IyKCJUaGlzIFROb2RlIGRvZXMgbm90IGJlbG9uZyB0byB0aGlzIFRWaWV3LiIpOwp9CmZ1bmN0aW9uIGFzc2VydFROb2RlKHROb2RlKSB7CiAgYXNzZXJ0RGVmaW5lZCh0Tm9kZSwgIlROb2RlIG11c3QgYmUgZGVmaW5lZCIpOwogIGlmICghKHROb2RlICYmIHR5cGVvZiB0Tm9kZSA9PT0gIm9iamVjdCIgJiYgdE5vZGUuaGFzT3duUHJvcGVydHkoImRpcmVjdGl2ZVN0eWxpbmdMYXN0IikpKSB7CiAgICB0aHJvd0Vycm9yMigiTm90IG9mIHR5cGUgVE5vZGUsIGdvdDogIiArIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0VEljdSh0SWN1KSB7CiAgYXNzZXJ0RGVmaW5lZCh0SWN1LCAiRXhwZWN0ZWQgVEljdSB0byBiZSBkZWZpbmVkIik7CiAgaWYgKCEodHlwZW9mIHRJY3UuY3VycmVudENhc2VMVmlld0luZGV4ID09PSAibnVtYmVyIikpIHsKICAgIHRocm93RXJyb3IyKCJPYmplY3QgaXMgbm90IG9mIFRJY3UgdHlwZS4iKTsKICB9Cn0KZnVuY3Rpb24gYXNzZXJ0Q29tcG9uZW50VHlwZShhY3R1YWwsIG1zZyA9ICJUeXBlIHBhc3NlZCBpbiBpcyBub3QgQ29tcG9uZW50VHlwZSwgaXQgZG9lcyBub3QgaGF2ZSAnybVjbXAnIHByb3BlcnR5LiIpIHsKICBpZiAoIWdldENvbXBvbmVudERlZihhY3R1YWwpKSB7CiAgICB0aHJvd0Vycm9yMihtc2cpOwogIH0KfQpmdW5jdGlvbiBhc3NlcnROZ01vZHVsZVR5cGUoYWN0dWFsLCBtc2cgPSAiVHlwZSBwYXNzZWQgaW4gaXMgbm90IE5nTW9kdWxlVHlwZSwgaXQgZG9lcyBub3QgaGF2ZSAnybVtb2QnIHByb3BlcnR5LiIpIHsKICBpZiAoIWdldE5nTW9kdWxlRGVmKGFjdHVhbCkpIHsKICAgIHRocm93RXJyb3IyKG1zZyk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydEhhc1BhcmVudCh0Tm9kZSkgewogIGFzc2VydERlZmluZWQodE5vZGUsICJjdXJyZW50VE5vZGUgc2hvdWxkIGV4aXN0ISIpOwogIGFzc2VydERlZmluZWQodE5vZGUucGFyZW50LCAiY3VycmVudFROb2RlIHNob3VsZCBoYXZlIGEgcGFyZW50Iik7Cn0KZnVuY3Rpb24gYXNzZXJ0TENvbnRhaW5lcih2YWx1ZSkgewogIGFzc2VydERlZmluZWQodmFsdWUsICJMQ29udGFpbmVyIG11c3QgYmUgZGVmaW5lZCIpOwogIGFzc2VydEVxdWFsKGlzTENvbnRhaW5lcih2YWx1ZSksIHRydWUsICJFeHBlY3RpbmcgTENvbnRhaW5lciIpOwp9CmZ1bmN0aW9uIGFzc2VydExWaWV3T3JVbmRlZmluZWQodmFsdWUpIHsKICB2YWx1ZSAmJiBhc3NlcnRFcXVhbChpc0xWaWV3KHZhbHVlKSwgdHJ1ZSwgIkV4cGVjdGluZyBMVmlldyBvciB1bmRlZmluZWQgb3IgbnVsbCIpOwp9CmZ1bmN0aW9uIGFzc2VydExWaWV3KHZhbHVlKSB7CiAgYXNzZXJ0RGVmaW5lZCh2YWx1ZSwgIkxWaWV3IG11c3QgYmUgZGVmaW5lZCIpOwogIGFzc2VydEVxdWFsKGlzTFZpZXcodmFsdWUpLCB0cnVlLCAiRXhwZWN0aW5nIExWaWV3Iik7Cn0KZnVuY3Rpb24gYXNzZXJ0Rmlyc3RDcmVhdGVQYXNzKHRWaWV3LCBlcnJNZXNzYWdlKSB7CiAgYXNzZXJ0RXF1YWwodFZpZXcuZmlyc3RDcmVhdGVQYXNzLCB0cnVlLCBlcnJNZXNzYWdlIHx8ICJTaG91bGQgb25seSBiZSBjYWxsZWQgaW4gZmlyc3QgY3JlYXRlIHBhc3MuIik7Cn0KZnVuY3Rpb24gYXNzZXJ0Rmlyc3RVcGRhdGVQYXNzKHRWaWV3LCBlcnJNZXNzYWdlKSB7CiAgYXNzZXJ0RXF1YWwodFZpZXcuZmlyc3RVcGRhdGVQYXNzLCB0cnVlLCAiU2hvdWxkIG9ubHkgYmUgY2FsbGVkIGluIGZpcnN0IHVwZGF0ZSBwYXNzLiIpOwp9CmZ1bmN0aW9uIGFzc2VydERpcmVjdGl2ZURlZihvYmopIHsKICBpZiAob2JqLnR5cGUgPT09IHZvaWQgMCB8fCBvYmouc2VsZWN0b3JzID09IHZvaWQgMCB8fCBvYmouaW5wdXRzID09PSB2b2lkIDApIHsKICAgIHRocm93RXJyb3IyKGBFeHBlY3RlZCBhIERpcmVjdGl2ZURlZi9Db21wb25lbnREZWYgYW5kIHRoaXMgb2JqZWN0IGRvZXMgbm90IHNlZW0gdG8gaGF2ZSB0aGUgZXhwZWN0ZWQgc2hhcGUuYCk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydEluZGV4SW5EZWNsUmFuZ2UodFZpZXcsIGluZGV4KSB7CiAgYXNzZXJ0QmV0d2VlbihIRUFERVJfT0ZGU0VULCB0Vmlldy5iaW5kaW5nU3RhcnRJbmRleCwgaW5kZXgpOwp9CmZ1bmN0aW9uIGFzc2VydEluZGV4SW5FeHBhbmRvUmFuZ2UobFZpZXcsIGluZGV4KSB7CiAgY29uc3QgdFZpZXcgPSBsVmlld1sxXTsKICBhc3NlcnRCZXR3ZWVuKHRWaWV3LmV4cGFuZG9TdGFydEluZGV4LCBsVmlldy5sZW5ndGgsIGluZGV4KTsKfQpmdW5jdGlvbiBhc3NlcnRCZXR3ZWVuKGxvd2VyLCB1cHBlciwgaW5kZXgpIHsKICBpZiAoIShsb3dlciA8PSBpbmRleCAmJiBpbmRleCA8IHVwcGVyKSkgewogICAgdGhyb3dFcnJvcjIoYEluZGV4IG91dCBvZiByYW5nZSAoZXhwZWN0aW5nICR7bG93ZXJ9IDw9ICR7aW5kZXh9IDwgJHt1cHBlcn0pYCk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydFByb2plY3Rpb25TbG90cyhsVmlldywgZXJyTWVzc2FnZSkgewogIGFzc2VydERlZmluZWQobFZpZXdbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddLCAiQ29tcG9uZW50IHZpZXdzIHNob3VsZCBleGlzdC4iKTsKICBhc3NlcnREZWZpbmVkKGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXVtUX0hPU1RdLnByb2plY3Rpb24sICJDb21wb25lbnRzIHdpdGggcHJvamVjdGlvbiBub2RlcyAoPG5nLWNvbnRlbnQ+KSBtdXN0IGhhdmUgcHJvamVjdGlvbiBzbG90cyBkZWZpbmVkLiIpOwp9CmZ1bmN0aW9uIGFzc2VydFBhcmVudFZpZXcobFZpZXcsIGVyck1lc3NhZ2UpIHsKICBhc3NlcnREZWZpbmVkKGxWaWV3LCAiQ29tcG9uZW50IHZpZXdzIHNob3VsZCBhbHdheXMgaGF2ZSBhIHBhcmVudCB2aWV3IChjb21wb25lbnQncyBob3N0IHZpZXcpIik7Cn0KZnVuY3Rpb24gYXNzZXJ0Tm9kZUluamVjdG9yKGxWaWV3LCBpbmplY3RvckluZGV4KSB7CiAgYXNzZXJ0SW5kZXhJbkV4cGFuZG9SYW5nZShsVmlldywgaW5qZWN0b3JJbmRleCk7CiAgYXNzZXJ0SW5kZXhJbkV4cGFuZG9SYW5nZShsVmlldywgaW5qZWN0b3JJbmRleCArIDgpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgMF0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgMV0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgMl0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgM10sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgNF0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgNV0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgNl0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgN10sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBhIGJsb29tIGZpbHRlciIpOwogIGFzc2VydE51bWJlcihsVmlld1tpbmplY3RvckluZGV4ICsgOF0sICJpbmplY3RvckluZGV4IHNob3VsZCBwb2ludCB0byBwYXJlbnQgaW5qZWN0b3IiKTsKfQp2YXIgU1ZHX05BTUVTUEFDRSA9ICJzdmciOwp2YXIgTUFUSF9NTF9OQU1FU1BBQ0UgPSAibWF0aCI7CmZ1bmN0aW9uIHVud3JhcFJOb2RlKHZhbHVlKSB7CiAgd2hpbGUgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICB2YWx1ZSA9IHZhbHVlW0hPU1RdOwogIH0KICByZXR1cm4gdmFsdWU7Cn0KZnVuY3Rpb24gdW53cmFwTFZpZXcodmFsdWUpIHsKICB3aGlsZSAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgIGlmICh0eXBlb2YgdmFsdWVbVFlQRV0gPT09ICJvYmplY3QiKSByZXR1cm4gdmFsdWU7CiAgICB2YWx1ZSA9IHZhbHVlW0hPU1RdOwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBnZXROYXRpdmVCeUluZGV4KGluZGV4LCBsVmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXcsIGluZGV4KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0R3JlYXRlclRoYW5PckVxdWFsKGluZGV4LCBIRUFERVJfT0ZGU0VULCAiRXhwZWN0ZWQgdG8gYmUgcGFzdCBIRUFERVJfT0ZGU0VUIik7CiAgcmV0dXJuIHVud3JhcFJOb2RlKGxWaWV3W2luZGV4XSk7Cn0KZnVuY3Rpb24gZ2V0TmF0aXZlQnlUTm9kZSh0Tm9kZSwgbFZpZXcpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVGb3JMVmlldyh0Tm9kZSwgbFZpZXcpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXcsIHROb2RlLmluZGV4KTsKICBjb25zdCBub2RlID0gdW53cmFwUk5vZGUobFZpZXdbdE5vZGUuaW5kZXhdKTsKICByZXR1cm4gbm9kZTsKfQpmdW5jdGlvbiBnZXROYXRpdmVCeVROb2RlT3JOdWxsKHROb2RlLCBsVmlldykgewogIGNvbnN0IGluZGV4ID0gdE5vZGUgPT09IG51bGwgPyAtMSA6IHROb2RlLmluZGV4OwogIGlmIChpbmRleCAhPT0gLTEpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZUZvckxWaWV3KHROb2RlLCBsVmlldyk7CiAgICBjb25zdCBub2RlID0gdW53cmFwUk5vZGUobFZpZXdbaW5kZXhdKTsKICAgIHJldHVybiBub2RlOwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBnZXRUTm9kZSh0VmlldywgaW5kZXgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0R3JlYXRlclRoYW4oaW5kZXgsIC0xLCAid3JvbmcgaW5kZXggZm9yIFROb2RlIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydExlc3NUaGFuKGluZGV4LCB0Vmlldy5kYXRhLmxlbmd0aCwgIndyb25nIGluZGV4IGZvciBUTm9kZSIpOwogIGNvbnN0IHROb2RlID0gdFZpZXcuZGF0YVtpbmRleF07CiAgbmdEZXZNb2RlICYmIHROb2RlICE9PSBudWxsICYmIGFzc2VydFROb2RlKHROb2RlKTsKICByZXR1cm4gdE5vZGU7Cn0KZnVuY3Rpb24gbG9hZCh2aWV3LCBpbmRleCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UodmlldywgaW5kZXgpOwogIHJldHVybiB2aWV3W2luZGV4XTsKfQpmdW5jdGlvbiBzdG9yZSh0VmlldywgbFZpZXcsIGluZGV4LCB2YWx1ZSkgewogIGlmIChpbmRleCA+PSB0Vmlldy5kYXRhLmxlbmd0aCkgewogICAgdFZpZXcuZGF0YVtpbmRleF0gPSBudWxsOwogICAgdFZpZXcuYmx1ZXByaW50W2luZGV4XSA9IG51bGw7CiAgfQogIGxWaWV3W2luZGV4XSA9IHZhbHVlOwp9CmZ1bmN0aW9uIGdldENvbXBvbmVudExWaWV3QnlJbmRleChub2RlSW5kZXgsIGhvc3RWaWV3KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShob3N0Vmlldywgbm9kZUluZGV4KTsKICBjb25zdCBzbG90VmFsdWUgPSBob3N0Vmlld1tub2RlSW5kZXhdOwogIGNvbnN0IGxWaWV3ID0gaXNMVmlldyhzbG90VmFsdWUpID8gc2xvdFZhbHVlIDogc2xvdFZhbHVlW0hPU1RdOwogIHJldHVybiBsVmlldzsKfQpmdW5jdGlvbiBpc0NyZWF0aW9uTW9kZSh2aWV3KSB7CiAgcmV0dXJuICh2aWV3W0ZMQUdTXSAmIDQpID09PSA0Owp9CmZ1bmN0aW9uIHZpZXdBdHRhY2hlZFRvQ2hhbmdlRGV0ZWN0b3IodmlldykgewogIHJldHVybiAodmlld1tGTEFHU10gJiAxMjgpID09PSAxMjg7Cn0KZnVuY3Rpb24gdmlld0F0dGFjaGVkVG9Db250YWluZXIodmlldykgewogIHJldHVybiBpc0xDb250YWluZXIodmlld1tQQVJFTlRdKTsKfQpmdW5jdGlvbiBnZXRDb25zdGFudChjb25zdHMsIGluZGV4KSB7CiAgaWYgKGluZGV4ID09PSBudWxsIHx8IGluZGV4ID09PSB2b2lkIDApIHJldHVybiBudWxsOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UoY29uc3RzLCBpbmRleCk7CiAgcmV0dXJuIGNvbnN0c1tpbmRleF07Cn0KZnVuY3Rpb24gcmVzZXRQcmVPcmRlckhvb2tGbGFncyhsVmlldykgewogIGxWaWV3W1BSRU9SREVSX0hPT0tfRkxBR1NdID0gMDsKfQpmdW5jdGlvbiBtYXJrVmlld0ZvclJlZnJlc2gobFZpZXcpIHsKICBpZiAobFZpZXdbRkxBR1NdICYgMTAyNCkgewogICAgcmV0dXJuOwogIH0KICBsVmlld1tGTEFHU10gfD0gMTAyNDsKICBpZiAodmlld0F0dGFjaGVkVG9DaGFuZ2VEZXRlY3RvcihsVmlldykpIHsKICAgIG1hcmtBbmNlc3RvcnNGb3JUcmF2ZXJzYWwobFZpZXcpOwogIH0KfQpmdW5jdGlvbiB3YWxrVXBWaWV3cyhuZXN0aW5nTGV2ZWwsIGN1cnJlbnRWaWV3KSB7CiAgd2hpbGUgKG5lc3RpbmdMZXZlbCA+IDApIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGN1cnJlbnRWaWV3W0RFQ0xBUkFUSU9OX1ZJRVddLCAiRGVjbGFyYXRpb24gdmlldyBzaG91bGQgYmUgZGVmaW5lZCBpZiBuZXN0aW5nIGxldmVsIGlzIGdyZWF0ZXIgdGhhbiAwLiIpOwogICAgY3VycmVudFZpZXcgPSBjdXJyZW50Vmlld1tERUNMQVJBVElPTl9WSUVXXTsKICAgIG5lc3RpbmdMZXZlbC0tOwogIH0KICByZXR1cm4gY3VycmVudFZpZXc7Cn0KZnVuY3Rpb24gcmVxdWlyZXNSZWZyZXNoT3JUcmF2ZXJzYWwobFZpZXcpIHsKICByZXR1cm4gISEobFZpZXdbRkxBR1NdICYgKDEwMjQgfCA4MTkyKSB8fCBsVmlld1tSRUFDVElWRV9URU1QTEFURV9DT05TVU1FUl0/LmRpcnR5KTsKfQpmdW5jdGlvbiB1cGRhdGVBbmNlc3RvclRyYXZlcnNhbEZsYWdzT25BdHRhY2gobFZpZXcpIHsKICBsVmlld1tFTlZJUk9OTUVOVF0uY2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyPy5ub3RpZnkoOCk7CiAgaWYgKGxWaWV3W0ZMQUdTXSAmIDY0KSB7CiAgICBsVmlld1tGTEFHU10gfD0gMTAyNDsKICB9CiAgaWYgKHJlcXVpcmVzUmVmcmVzaE9yVHJhdmVyc2FsKGxWaWV3KSkgewogICAgbWFya0FuY2VzdG9yc0ZvclRyYXZlcnNhbChsVmlldyk7CiAgfQp9CmZ1bmN0aW9uIG1hcmtBbmNlc3RvcnNGb3JUcmF2ZXJzYWwobFZpZXcpIHsKICBsVmlld1tFTlZJUk9OTUVOVF0uY2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyPy5ub3RpZnkoMCk7CiAgbGV0IHBhcmVudCA9IGdldExWaWV3UGFyZW50KGxWaWV3KTsKICB3aGlsZSAocGFyZW50ICE9PSBudWxsKSB7CiAgICBpZiAocGFyZW50W0ZMQUdTXSAmIDgxOTIpIHsKICAgICAgYnJlYWs7CiAgICB9CiAgICBwYXJlbnRbRkxBR1NdIHw9IDgxOTI7CiAgICBpZiAoIXZpZXdBdHRhY2hlZFRvQ2hhbmdlRGV0ZWN0b3IocGFyZW50KSkgewogICAgICBicmVhazsKICAgIH0KICAgIHBhcmVudCA9IGdldExWaWV3UGFyZW50KHBhcmVudCk7CiAgfQp9CmZ1bmN0aW9uIHN0b3JlTFZpZXdPbkRlc3Ryb3kobFZpZXcsIG9uRGVzdHJveUNhbGxiYWNrKSB7CiAgaWYgKGlzRGVzdHJveWVkKGxWaWV3KSkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MTEsIG5nRGV2TW9kZSAmJiAiVmlldyBoYXMgYWxyZWFkeSBiZWVuIGRlc3Ryb3llZC4iKTsKICB9CiAgaWYgKGxWaWV3W09OX0RFU1RST1lfSE9PS1NdID09PSBudWxsKSB7CiAgICBsVmlld1tPTl9ERVNUUk9ZX0hPT0tTXSA9IFtdOwogIH0KICBsVmlld1tPTl9ERVNUUk9ZX0hPT0tTXS5wdXNoKG9uRGVzdHJveUNhbGxiYWNrKTsKfQpmdW5jdGlvbiByZW1vdmVMVmlld09uRGVzdHJveShsVmlldywgb25EZXN0cm95Q2FsbGJhY2spIHsKICBpZiAobFZpZXdbT05fREVTVFJPWV9IT09LU10gPT09IG51bGwpIHJldHVybjsKICBjb25zdCBkZXN0cm95Q0JJZHggPSBsVmlld1tPTl9ERVNUUk9ZX0hPT0tTXS5pbmRleE9mKG9uRGVzdHJveUNhbGxiYWNrKTsKICBpZiAoZGVzdHJveUNCSWR4ICE9PSAtMSkgewogICAgbFZpZXdbT05fREVTVFJPWV9IT09LU10uc3BsaWNlKGRlc3Ryb3lDQklkeCwgMSk7CiAgfQp9CmZ1bmN0aW9uIGdldExWaWV3UGFyZW50KGxWaWV3KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydExWaWV3KGxWaWV3KTsKICBjb25zdCBwYXJlbnQgPSBsVmlld1tQQVJFTlRdOwogIHJldHVybiBpc0xDb250YWluZXIocGFyZW50KSA/IHBhcmVudFtQQVJFTlRdIDogcGFyZW50Owp9CmZ1bmN0aW9uIGdldE9yQ3JlYXRlTFZpZXdDbGVhbnVwKHZpZXcpIHsKICByZXR1cm4gdmlld1tDTEVBTlVQXSA/Pz0gW107Cn0KZnVuY3Rpb24gZ2V0T3JDcmVhdGVUVmlld0NsZWFudXAodFZpZXcpIHsKICByZXR1cm4gdFZpZXcuY2xlYW51cCA/Pz0gW107Cn0KZnVuY3Rpb24gc3RvcmVDbGVhbnVwV2l0aENvbnRleHQodFZpZXcsIGxWaWV3LCBjb250ZXh0MiwgY2xlYW51cEZuKSB7CiAgY29uc3QgbENsZWFudXAgPSBnZXRPckNyZWF0ZUxWaWV3Q2xlYW51cChsVmlldyk7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoY29udGV4dDIsICJDbGVhbnVwIGNvbnRleHQgaXMgbWFuZGF0b3J5IHdoZW4gcmVnaXN0ZXJpbmcgZnJhbWV3b3JrLWxldmVsIGRlc3Ryb3kgaG9va3MiKTsKICBsQ2xlYW51cC5wdXNoKGNvbnRleHQyKTsKICBpZiAodFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICBnZXRPckNyZWF0ZVRWaWV3Q2xlYW51cCh0VmlldykucHVzaChjbGVhbnVwRm4sIGxDbGVhbnVwLmxlbmd0aCAtIDEpOwogIH0gZWxzZSB7CiAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgIE9iamVjdC5mcmVlemUoZ2V0T3JDcmVhdGVUVmlld0NsZWFudXAodFZpZXcpKTsKICAgIH0KICB9Cn0KdmFyIGluc3RydWN0aW9uU3RhdGUgPSB7CiAgbEZyYW1lOiBjcmVhdGVMRnJhbWUobnVsbCksCiAgYmluZGluZ3NFbmFibGVkOiB0cnVlLAogIHNraXBIeWRyYXRpb25Sb290VE5vZGU6IG51bGwKfTsKdmFyIENoZWNrTm9DaGFuZ2VzTW9kZTsKKGZ1bmN0aW9uKENoZWNrTm9DaGFuZ2VzTW9kZTIpIHsKICBDaGVja05vQ2hhbmdlc01vZGUyW0NoZWNrTm9DaGFuZ2VzTW9kZTJbIk9mZiJdID0gMF0gPSAiT2ZmIjsKICBDaGVja05vQ2hhbmdlc01vZGUyW0NoZWNrTm9DaGFuZ2VzTW9kZTJbIkV4aGF1c3RpdmUiXSA9IDFdID0gIkV4aGF1c3RpdmUiOwogIENoZWNrTm9DaGFuZ2VzTW9kZTJbQ2hlY2tOb0NoYW5nZXNNb2RlMlsiT25seURpcnR5Vmlld3MiXSA9IDJdID0gIk9ubHlEaXJ0eVZpZXdzIjsKfSkoQ2hlY2tOb0NoYW5nZXNNb2RlIHx8IChDaGVja05vQ2hhbmdlc01vZGUgPSB7fSkpOwp2YXIgX2NoZWNrTm9DaGFuZ2VzTW9kZSA9IDA7CnZhciBfaXNSZWZyZXNoaW5nVmlld3MgPSBmYWxzZTsKZnVuY3Rpb24gZ2V0RWxlbWVudERlcHRoQ291bnQoKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmVsZW1lbnREZXB0aENvdW50Owp9CmZ1bmN0aW9uIGluY3JlYXNlRWxlbWVudERlcHRoQ291bnQoKSB7CiAgaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuZWxlbWVudERlcHRoQ291bnQrKzsKfQpmdW5jdGlvbiBkZWNyZWFzZUVsZW1lbnREZXB0aENvdW50KCkgewogIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmVsZW1lbnREZXB0aENvdW50LS07Cn0KZnVuY3Rpb24gZ2V0QmluZGluZ3NFbmFibGVkKCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLmJpbmRpbmdzRW5hYmxlZDsKfQpmdW5jdGlvbiBpc0luU2tpcEh5ZHJhdGlvbkJsb2NrKCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLnNraXBIeWRyYXRpb25Sb290VE5vZGUgIT09IG51bGw7Cn0KZnVuY3Rpb24gaXNTa2lwSHlkcmF0aW9uUm9vdFROb2RlKHROb2RlKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUuc2tpcEh5ZHJhdGlvblJvb3RUTm9kZSA9PT0gdE5vZGU7Cn0KZnVuY3Rpb24gybXJtWVuYWJsZUJpbmRpbmdzKCkgewogIGluc3RydWN0aW9uU3RhdGUuYmluZGluZ3NFbmFibGVkID0gdHJ1ZTsKfQpmdW5jdGlvbiBlbnRlclNraXBIeWRyYXRpb25CbG9jayh0Tm9kZSkgewogIGluc3RydWN0aW9uU3RhdGUuc2tpcEh5ZHJhdGlvblJvb3RUTm9kZSA9IHROb2RlOwp9CmZ1bmN0aW9uIMm1ybVkaXNhYmxlQmluZGluZ3MoKSB7CiAgaW5zdHJ1Y3Rpb25TdGF0ZS5iaW5kaW5nc0VuYWJsZWQgPSBmYWxzZTsKfQpmdW5jdGlvbiBsZWF2ZVNraXBIeWRyYXRpb25CbG9jaygpIHsKICBpbnN0cnVjdGlvblN0YXRlLnNraXBIeWRyYXRpb25Sb290VE5vZGUgPSBudWxsOwp9CmZ1bmN0aW9uIGdldExWaWV3KCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5sVmlldzsKfQpmdW5jdGlvbiBnZXRUVmlldygpIHsKICByZXR1cm4gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUudFZpZXc7Cn0KZnVuY3Rpb24gybXJtXJlc3RvcmVWaWV3KHZpZXdUb1Jlc3RvcmUpIHsKICBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jb250ZXh0TFZpZXcgPSB2aWV3VG9SZXN0b3JlOwogIHJldHVybiB2aWV3VG9SZXN0b3JlW0NPTlRFWFRdOwp9CmZ1bmN0aW9uIMm1ybVyZXNldFZpZXcodmFsdWUpIHsKICBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jb250ZXh0TFZpZXcgPSBudWxsOwogIHJldHVybiB2YWx1ZTsKfQpmdW5jdGlvbiBnZXRDdXJyZW50VE5vZGUoKSB7CiAgbGV0IGN1cnJlbnRUTm9kZSA9IGdldEN1cnJlbnRUTm9kZVBsYWNlaG9sZGVyT2soKTsKICB3aGlsZSAoY3VycmVudFROb2RlICE9PSBudWxsICYmIGN1cnJlbnRUTm9kZS50eXBlID09PSA2NCkgewogICAgY3VycmVudFROb2RlID0gY3VycmVudFROb2RlLnBhcmVudDsKICB9CiAgcmV0dXJuIGN1cnJlbnRUTm9kZTsKfQpmdW5jdGlvbiBnZXRDdXJyZW50VE5vZGVQbGFjZWhvbGRlck9rKCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jdXJyZW50VE5vZGU7Cn0KZnVuY3Rpb24gZ2V0Q3VycmVudFBhcmVudFROb2RlKCkgewogIGNvbnN0IGxGcmFtZSA9IGluc3RydWN0aW9uU3RhdGUubEZyYW1lOwogIGNvbnN0IGN1cnJlbnRUTm9kZSA9IGxGcmFtZS5jdXJyZW50VE5vZGU7CiAgcmV0dXJuIGxGcmFtZS5pc1BhcmVudCA/IGN1cnJlbnRUTm9kZSA6IGN1cnJlbnRUTm9kZS5wYXJlbnQ7Cn0KZnVuY3Rpb24gc2V0Q3VycmVudFROb2RlKHROb2RlLCBpc1BhcmVudCkgewogIG5nRGV2TW9kZSAmJiB0Tm9kZSAmJiBhc3NlcnRUTm9kZUZvclRWaWV3KHROb2RlLCBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS50Vmlldyk7CiAgY29uc3QgbEZyYW1lID0gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWU7CiAgbEZyYW1lLmN1cnJlbnRUTm9kZSA9IHROb2RlOwogIGxGcmFtZS5pc1BhcmVudCA9IGlzUGFyZW50Owp9CmZ1bmN0aW9uIGlzQ3VycmVudFROb2RlUGFyZW50KCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5pc1BhcmVudDsKfQpmdW5jdGlvbiBzZXRDdXJyZW50VE5vZGVBc05vdFBhcmVudCgpIHsKICBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5pc1BhcmVudCA9IGZhbHNlOwp9CmZ1bmN0aW9uIGdldENvbnRleHRMVmlldygpIHsKICBjb25zdCBjb250ZXh0TFZpZXcgPSBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jb250ZXh0TFZpZXc7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoY29udGV4dExWaWV3LCAiY29udGV4dExWaWV3IG11c3QgYmUgZGVmaW5lZC4iKTsKICByZXR1cm4gY29udGV4dExWaWV3Owp9CmZ1bmN0aW9uIGlzSW5DaGVja05vQ2hhbmdlc01vZGUoKSB7CiAgIW5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMigiTXVzdCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgcmV0dXJuIF9jaGVja05vQ2hhbmdlc01vZGUgIT09IENoZWNrTm9DaGFuZ2VzTW9kZS5PZmY7Cn0KZnVuY3Rpb24gaXNFeGhhdXN0aXZlQ2hlY2tOb0NoYW5nZXMoKSB7CiAgIW5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMigiTXVzdCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgcmV0dXJuIF9jaGVja05vQ2hhbmdlc01vZGUgPT09IENoZWNrTm9DaGFuZ2VzTW9kZS5FeGhhdXN0aXZlOwp9CmZ1bmN0aW9uIHNldElzSW5DaGVja05vQ2hhbmdlc01vZGUobW9kZSkgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoIk11c3QgbmV2ZXIgYmUgY2FsbGVkIGluIHByb2R1Y3Rpb24gbW9kZSIpOwogIF9jaGVja05vQ2hhbmdlc01vZGUgPSBtb2RlOwp9CmZ1bmN0aW9uIGlzUmVmcmVzaGluZ1ZpZXdzKCkgewogIHJldHVybiBfaXNSZWZyZXNoaW5nVmlld3M7Cn0KZnVuY3Rpb24gc2V0SXNSZWZyZXNoaW5nVmlld3MobW9kZSkgewogIGNvbnN0IHByZXYgPSBfaXNSZWZyZXNoaW5nVmlld3M7CiAgX2lzUmVmcmVzaGluZ1ZpZXdzID0gbW9kZTsKICByZXR1cm4gcHJldjsKfQpmdW5jdGlvbiBnZXRCaW5kaW5nUm9vdCgpIHsKICBjb25zdCBsRnJhbWUgPSBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZTsKICBsZXQgaW5kZXggPSBsRnJhbWUuYmluZGluZ1Jvb3RJbmRleDsKICBpZiAoaW5kZXggPT09IC0xKSB7CiAgICBpbmRleCA9IGxGcmFtZS5iaW5kaW5nUm9vdEluZGV4ID0gbEZyYW1lLnRWaWV3LmJpbmRpbmdTdGFydEluZGV4OwogIH0KICByZXR1cm4gaW5kZXg7Cn0KZnVuY3Rpb24gZ2V0QmluZGluZ0luZGV4KCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5iaW5kaW5nSW5kZXg7Cn0KZnVuY3Rpb24gc2V0QmluZGluZ0luZGV4KHZhbHVlKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmJpbmRpbmdJbmRleCA9IHZhbHVlOwp9CmZ1bmN0aW9uIG5leHRCaW5kaW5nSW5kZXgoKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmJpbmRpbmdJbmRleCsrOwp9CmZ1bmN0aW9uIGluY3JlbWVudEJpbmRpbmdJbmRleChjb3VudDIpIHsKICBjb25zdCBsRnJhbWUgPSBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZTsKICBjb25zdCBpbmRleCA9IGxGcmFtZS5iaW5kaW5nSW5kZXg7CiAgbEZyYW1lLmJpbmRpbmdJbmRleCA9IGxGcmFtZS5iaW5kaW5nSW5kZXggKyBjb3VudDI7CiAgcmV0dXJuIGluZGV4Owp9CmZ1bmN0aW9uIGlzSW5JMThuQmxvY2soKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmluSTE4bjsKfQpmdW5jdGlvbiBzZXRJbkkxOG5CbG9jayhpc0luSTE4bkJsb2NrMikgewogIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmluSTE4biA9IGlzSW5JMThuQmxvY2syOwp9CmZ1bmN0aW9uIHNldEJpbmRpbmdSb290Rm9ySG9zdEJpbmRpbmdzKGJpbmRpbmdSb290SW5kZXgsIGN1cnJlbnREaXJlY3RpdmVJbmRleCkgewogIGNvbnN0IGxGcmFtZSA9IGluc3RydWN0aW9uU3RhdGUubEZyYW1lOwogIGxGcmFtZS5iaW5kaW5nSW5kZXggPSBsRnJhbWUuYmluZGluZ1Jvb3RJbmRleCA9IGJpbmRpbmdSb290SW5kZXg7CiAgc2V0Q3VycmVudERpcmVjdGl2ZUluZGV4KGN1cnJlbnREaXJlY3RpdmVJbmRleCk7Cn0KZnVuY3Rpb24gZ2V0Q3VycmVudERpcmVjdGl2ZUluZGV4KCkgewogIHJldHVybiBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jdXJyZW50RGlyZWN0aXZlSW5kZXg7Cn0KZnVuY3Rpb24gc2V0Q3VycmVudERpcmVjdGl2ZUluZGV4KGN1cnJlbnREaXJlY3RpdmVJbmRleCkgewogIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmN1cnJlbnREaXJlY3RpdmVJbmRleCA9IGN1cnJlbnREaXJlY3RpdmVJbmRleDsKfQpmdW5jdGlvbiBnZXRDdXJyZW50RGlyZWN0aXZlRGVmKHREYXRhKSB7CiAgY29uc3QgY3VycmVudERpcmVjdGl2ZUluZGV4ID0gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuY3VycmVudERpcmVjdGl2ZUluZGV4OwogIHJldHVybiBjdXJyZW50RGlyZWN0aXZlSW5kZXggPT09IC0xID8gbnVsbCA6IHREYXRhW2N1cnJlbnREaXJlY3RpdmVJbmRleF07Cn0KZnVuY3Rpb24gZ2V0Q3VycmVudFF1ZXJ5SW5kZXgoKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmN1cnJlbnRRdWVyeUluZGV4Owp9CmZ1bmN0aW9uIHNldEN1cnJlbnRRdWVyeUluZGV4KHZhbHVlKSB7CiAgaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuY3VycmVudFF1ZXJ5SW5kZXggPSB2YWx1ZTsKfQpmdW5jdGlvbiBnZXREZWNsYXJhdGlvblROb2RlKGxWaWV3KSB7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgaWYgKHRWaWV3LnR5cGUgPT09IDIpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHRWaWV3LmRlY2xUTm9kZSwgIkVtYmVkZGVkIFROb2RlcyBzaG91bGQgaGF2ZSBkZWNsYXJhdGlvbiBwYXJlbnRzLiIpOwogICAgcmV0dXJuIHRWaWV3LmRlY2xUTm9kZTsKICB9CiAgaWYgKHRWaWV3LnR5cGUgPT09IDEpIHsKICAgIHJldHVybiBsVmlld1tUX0hPU1RdOwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBlbnRlckRJKGxWaWV3LCB0Tm9kZSwgZmxhZ3MpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TFZpZXdPclVuZGVmaW5lZChsVmlldyk7CiAgaWYgKGZsYWdzICYgNCkgewogICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlRm9yVFZpZXcodE5vZGUsIGxWaWV3W1RWSUVXXSk7CiAgICBsZXQgcGFyZW50VE5vZGUgPSB0Tm9kZTsKICAgIGxldCBwYXJlbnRMVmlldyA9IGxWaWV3OwogICAgd2hpbGUgKHRydWUpIHsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQocGFyZW50VE5vZGUsICJQYXJlbnQgVE5vZGUgc2hvdWxkIGJlIGRlZmluZWQiKTsKICAgICAgcGFyZW50VE5vZGUgPSBwYXJlbnRUTm9kZS5wYXJlbnQ7CiAgICAgIGlmIChwYXJlbnRUTm9kZSA9PT0gbnVsbCAmJiAhKGZsYWdzICYgMSkpIHsKICAgICAgICBwYXJlbnRUTm9kZSA9IGdldERlY2xhcmF0aW9uVE5vZGUocGFyZW50TFZpZXcpOwogICAgICAgIGlmIChwYXJlbnRUTm9kZSA9PT0gbnVsbCkgYnJlYWs7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQocGFyZW50TFZpZXcsICJQYXJlbnQgTFZpZXcgc2hvdWxkIGJlIGRlZmluZWQiKTsKICAgICAgICBwYXJlbnRMVmlldyA9IHBhcmVudExWaWV3W0RFQ0xBUkFUSU9OX1ZJRVddOwogICAgICAgIGlmIChwYXJlbnRUTm9kZS50eXBlICYgKDIgfCA4KSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBpZiAocGFyZW50VE5vZGUgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgdE5vZGUgPSBwYXJlbnRUTm9kZTsKICAgICAgbFZpZXcgPSBwYXJlbnRMVmlldzsKICAgIH0KICB9CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlRm9yTFZpZXcodE5vZGUsIGxWaWV3KTsKICBjb25zdCBsRnJhbWUgPSBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZSA9IGFsbG9jTEZyYW1lKCk7CiAgbEZyYW1lLmN1cnJlbnRUTm9kZSA9IHROb2RlOwogIGxGcmFtZS5sVmlldyA9IGxWaWV3OwogIHJldHVybiB0cnVlOwp9CmZ1bmN0aW9uIGVudGVyVmlldyhuZXdWaWV3KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdEVxdWFsKG5ld1ZpZXdbMF0sIG5ld1ZpZXdbMV0sICI/Pz8/Iik7CiAgbmdEZXZNb2RlICYmIGFzc2VydExWaWV3T3JVbmRlZmluZWQobmV3Vmlldyk7CiAgY29uc3QgbmV3TEZyYW1lID0gYWxsb2NMRnJhbWUoKTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBhc3NlcnRFcXVhbChuZXdMRnJhbWUuaXNQYXJlbnQsIHRydWUsICJFeHBlY3RlZCBjbGVhbiBMRnJhbWUiKTsKICAgIGFzc2VydEVxdWFsKG5ld0xGcmFtZS5sVmlldywgbnVsbCwgIkV4cGVjdGVkIGNsZWFuIExGcmFtZSIpOwogICAgYXNzZXJ0RXF1YWwobmV3TEZyYW1lLnRWaWV3LCBudWxsLCAiRXhwZWN0ZWQgY2xlYW4gTEZyYW1lIik7CiAgICBhc3NlcnRFcXVhbChuZXdMRnJhbWUuc2VsZWN0ZWRJbmRleCwgLTEsICJFeHBlY3RlZCBjbGVhbiBMRnJhbWUiKTsKICAgIGFzc2VydEVxdWFsKG5ld0xGcmFtZS5lbGVtZW50RGVwdGhDb3VudCwgMCwgIkV4cGVjdGVkIGNsZWFuIExGcmFtZSIpOwogICAgYXNzZXJ0RXF1YWwobmV3TEZyYW1lLmN1cnJlbnREaXJlY3RpdmVJbmRleCwgLTEsICJFeHBlY3RlZCBjbGVhbiBMRnJhbWUiKTsKICAgIGFzc2VydEVxdWFsKG5ld0xGcmFtZS5jdXJyZW50TmFtZXNwYWNlLCBudWxsLCAiRXhwZWN0ZWQgY2xlYW4gTEZyYW1lIik7CiAgICBhc3NlcnRFcXVhbChuZXdMRnJhbWUuYmluZGluZ1Jvb3RJbmRleCwgLTEsICJFeHBlY3RlZCBjbGVhbiBMRnJhbWUiKTsKICAgIGFzc2VydEVxdWFsKG5ld0xGcmFtZS5jdXJyZW50UXVlcnlJbmRleCwgMCwgIkV4cGVjdGVkIGNsZWFuIExGcmFtZSIpOwogIH0KICBjb25zdCB0VmlldyA9IG5ld1ZpZXdbVFZJRVddOwogIGluc3RydWN0aW9uU3RhdGUubEZyYW1lID0gbmV3TEZyYW1lOwogIG5nRGV2TW9kZSAmJiB0Vmlldy5maXJzdENoaWxkICYmIGFzc2VydFROb2RlRm9yVFZpZXcodFZpZXcuZmlyc3RDaGlsZCwgdFZpZXcpOwogIG5ld0xGcmFtZS5jdXJyZW50VE5vZGUgPSB0Vmlldy5maXJzdENoaWxkOwogIG5ld0xGcmFtZS5sVmlldyA9IG5ld1ZpZXc7CiAgbmV3TEZyYW1lLnRWaWV3ID0gdFZpZXc7CiAgbmV3TEZyYW1lLmNvbnRleHRMVmlldyA9IG5ld1ZpZXc7CiAgbmV3TEZyYW1lLmJpbmRpbmdJbmRleCA9IHRWaWV3LmJpbmRpbmdTdGFydEluZGV4OwogIG5ld0xGcmFtZS5pbkkxOG4gPSBmYWxzZTsKfQpmdW5jdGlvbiBhbGxvY0xGcmFtZSgpIHsKICBjb25zdCBjdXJyZW50TEZyYW1lID0gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWU7CiAgY29uc3QgY2hpbGRMRnJhbWUgPSBjdXJyZW50TEZyYW1lID09PSBudWxsID8gbnVsbCA6IGN1cnJlbnRMRnJhbWUuY2hpbGQ7CiAgY29uc3QgbmV3TEZyYW1lID0gY2hpbGRMRnJhbWUgPT09IG51bGwgPyBjcmVhdGVMRnJhbWUoY3VycmVudExGcmFtZSkgOiBjaGlsZExGcmFtZTsKICByZXR1cm4gbmV3TEZyYW1lOwp9CmZ1bmN0aW9uIGNyZWF0ZUxGcmFtZShwYXJlbnQpIHsKICBjb25zdCBsRnJhbWUgPSB7CiAgICBjdXJyZW50VE5vZGU6IG51bGwsCiAgICBpc1BhcmVudDogdHJ1ZSwKICAgIGxWaWV3OiBudWxsLAogICAgdFZpZXc6IG51bGwsCiAgICBzZWxlY3RlZEluZGV4OiAtMSwKICAgIGNvbnRleHRMVmlldzogbnVsbCwKICAgIGVsZW1lbnREZXB0aENvdW50OiAwLAogICAgY3VycmVudE5hbWVzcGFjZTogbnVsbCwKICAgIGN1cnJlbnREaXJlY3RpdmVJbmRleDogLTEsCiAgICBiaW5kaW5nUm9vdEluZGV4OiAtMSwKICAgIGJpbmRpbmdJbmRleDogLTEsCiAgICBjdXJyZW50UXVlcnlJbmRleDogMCwKICAgIHBhcmVudCwKICAgIGNoaWxkOiBudWxsLAogICAgaW5JMThuOiBmYWxzZQogIH07CiAgcGFyZW50ICE9PSBudWxsICYmIChwYXJlbnQuY2hpbGQgPSBsRnJhbWUpOwogIHJldHVybiBsRnJhbWU7Cn0KZnVuY3Rpb24gbGVhdmVWaWV3TGlnaHQoKSB7CiAgY29uc3Qgb2xkTEZyYW1lID0gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWU7CiAgaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUgPSBvbGRMRnJhbWUucGFyZW50OwogIG9sZExGcmFtZS5jdXJyZW50VE5vZGUgPSBudWxsOwogIG9sZExGcmFtZS5sVmlldyA9IG51bGw7CiAgcmV0dXJuIG9sZExGcmFtZTsKfQp2YXIgbGVhdmVESSA9IGxlYXZlVmlld0xpZ2h0OwpmdW5jdGlvbiBsZWF2ZVZpZXcoKSB7CiAgY29uc3Qgb2xkTEZyYW1lID0gbGVhdmVWaWV3TGlnaHQoKTsKICBvbGRMRnJhbWUuaXNQYXJlbnQgPSB0cnVlOwogIG9sZExGcmFtZS50VmlldyA9IG51bGw7CiAgb2xkTEZyYW1lLnNlbGVjdGVkSW5kZXggPSAtMTsKICBvbGRMRnJhbWUuY29udGV4dExWaWV3ID0gbnVsbDsKICBvbGRMRnJhbWUuZWxlbWVudERlcHRoQ291bnQgPSAwOwogIG9sZExGcmFtZS5jdXJyZW50RGlyZWN0aXZlSW5kZXggPSAtMTsKICBvbGRMRnJhbWUuY3VycmVudE5hbWVzcGFjZSA9IG51bGw7CiAgb2xkTEZyYW1lLmJpbmRpbmdSb290SW5kZXggPSAtMTsKICBvbGRMRnJhbWUuYmluZGluZ0luZGV4ID0gLTE7CiAgb2xkTEZyYW1lLmN1cnJlbnRRdWVyeUluZGV4ID0gMDsKfQpmdW5jdGlvbiBuZXh0Q29udGV4dEltcGwobGV2ZWwpIHsKICBjb25zdCBjb250ZXh0TFZpZXcgPSBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jb250ZXh0TFZpZXcgPSB3YWxrVXBWaWV3cyhsZXZlbCwgaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuY29udGV4dExWaWV3KTsKICByZXR1cm4gY29udGV4dExWaWV3W0NPTlRFWFRdOwp9CmZ1bmN0aW9uIGdldFNlbGVjdGVkSW5kZXgoKSB7CiAgcmV0dXJuIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLnNlbGVjdGVkSW5kZXg7Cn0KZnVuY3Rpb24gc2V0U2VsZWN0ZWRJbmRleChpbmRleCkgewogIG5nRGV2TW9kZSAmJiBpbmRleCAhPT0gLTEgJiYgYXNzZXJ0R3JlYXRlclRoYW5PckVxdWFsKGluZGV4LCBIRUFERVJfT0ZGU0VULCAiSW5kZXggbXVzdCBiZSBwYXN0IEhFQURFUl9PRkZTRVQgKG9yIC0xKS4iKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TGVzc1RoYW4oaW5kZXgsIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmxWaWV3Lmxlbmd0aCwgIkNhbid0IHNldCBpbmRleCBwYXNzZWQgZW5kIG9mIExWaWV3Iik7CiAgaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuc2VsZWN0ZWRJbmRleCA9IGluZGV4Owp9CmZ1bmN0aW9uIGdldFNlbGVjdGVkVE5vZGUoKSB7CiAgY29uc3QgbEZyYW1lID0gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWU7CiAgcmV0dXJuIGdldFROb2RlKGxGcmFtZS50VmlldywgbEZyYW1lLnNlbGVjdGVkSW5kZXgpOwp9CmZ1bmN0aW9uIMm1ybVuYW1lc3BhY2VTVkcoKSB7CiAgaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuY3VycmVudE5hbWVzcGFjZSA9IFNWR19OQU1FU1BBQ0U7Cn0KZnVuY3Rpb24gybXJtW5hbWVzcGFjZU1hdGhNTCgpIHsKICBpbnN0cnVjdGlvblN0YXRlLmxGcmFtZS5jdXJyZW50TmFtZXNwYWNlID0gTUFUSF9NTF9OQU1FU1BBQ0U7Cn0KZnVuY3Rpb24gybXJtW5hbWVzcGFjZUhUTUwoKSB7CiAgbmFtZXNwYWNlSFRNTEludGVybmFsKCk7Cn0KZnVuY3Rpb24gbmFtZXNwYWNlSFRNTEludGVybmFsKCkgewogIGluc3RydWN0aW9uU3RhdGUubEZyYW1lLmN1cnJlbnROYW1lc3BhY2UgPSBudWxsOwp9CmZ1bmN0aW9uIGdldE5hbWVzcGFjZSgpIHsKICByZXR1cm4gaW5zdHJ1Y3Rpb25TdGF0ZS5sRnJhbWUuY3VycmVudE5hbWVzcGFjZTsKfQp2YXIgX3dhc0xhc3ROb2RlQ3JlYXRlZCA9IHRydWU7CmZ1bmN0aW9uIHdhc0xhc3ROb2RlQ3JlYXRlZCgpIHsKICByZXR1cm4gX3dhc0xhc3ROb2RlQ3JlYXRlZDsKfQpmdW5jdGlvbiBsYXN0Tm9kZVdhc0NyZWF0ZWQoZmxhZykgewogIF93YXNMYXN0Tm9kZUNyZWF0ZWQgPSBmbGFnOwp9CmZ1bmN0aW9uIGNyZWF0ZUluamVjdG9yKGRlZlR5cGUsIHBhcmVudCA9IG51bGwsIGFkZGl0aW9uYWxQcm92aWRlcnMgPSBudWxsLCBuYW1lKSB7CiAgY29uc3QgaW5qZWN0b3IgPSBjcmVhdGVJbmplY3RvcldpdGhvdXRJbmplY3Rvckluc3RhbmNlcyhkZWZUeXBlLCBwYXJlbnQsIGFkZGl0aW9uYWxQcm92aWRlcnMsIG5hbWUpOwogIGluamVjdG9yLnJlc29sdmVJbmplY3RvckluaXRpYWxpemVycygpOwogIHJldHVybiBpbmplY3RvcjsKfQpmdW5jdGlvbiBjcmVhdGVJbmplY3RvcldpdGhvdXRJbmplY3Rvckluc3RhbmNlcyhkZWZUeXBlLCBwYXJlbnQgPSBudWxsLCBhZGRpdGlvbmFsUHJvdmlkZXJzID0gbnVsbCwgbmFtZSwgc2NvcGVzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSkgewogIGNvbnN0IHByb3ZpZGVycyA9IFthZGRpdGlvbmFsUHJvdmlkZXJzIHx8IEVNUFRZX0FSUkFZLCBpbXBvcnRQcm92aWRlcnNGcm9tKGRlZlR5cGUpXTsKICBuYW1lID0gbmFtZSB8fCAodHlwZW9mIGRlZlR5cGUgPT09ICJvYmplY3QiID8gdm9pZCAwIDogc3RyaW5naWZ5KGRlZlR5cGUpKTsKICByZXR1cm4gbmV3IFIzSW5qZWN0b3IocHJvdmlkZXJzLCBwYXJlbnQgfHwgZ2V0TnVsbEluamVjdG9yKCksIG5hbWUgfHwgbnVsbCwgc2NvcGVzKTsKfQp2YXIgSW5qZWN0b3IgPSBjbGFzcyBfSW5qZWN0b3IgewogIHN0YXRpYyBUSFJPV19JRl9OT1RfRk9VTkQgPSBUSFJPV19JRl9OT1RfRk9VTkQ7CiAgc3RhdGljIE5VTEwgPSBuZXcgTnVsbEluamVjdG9yKCk7CiAgc3RhdGljIGNyZWF0ZShvcHRpb25zLCBwYXJlbnQpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMpKSB7CiAgICAgIHJldHVybiBjcmVhdGVJbmplY3Rvcih7CiAgICAgICAgbmFtZTogIiIKICAgICAgfSwgcGFyZW50LCBvcHRpb25zLCAiIik7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBuYW1lID0gb3B0aW9ucy5uYW1lID8/ICIiOwogICAgICByZXR1cm4gY3JlYXRlSW5qZWN0b3IoewogICAgICAgIG5hbWUKICAgICAgfSwgb3B0aW9ucy5wYXJlbnQsIG9wdGlvbnMucHJvdmlkZXJzLCBuYW1lKTsKICAgIH0KICB9CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfSW5qZWN0b3IsCiAgICBwcm92aWRlZEluOiAiYW55IiwKICAgIGZhY3Rvcnk6ICgpID0+IMm1ybVpbmplY3QoSU5KRUNUT1IkMSkKICB9KTsKICBzdGF0aWMgX19OR19FTEVNRU5UX0lEX18gPSAtMTsKfTsKdmFyIERPQ1VNRU5UID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJEb2N1bWVudFRva2VuIiA6ICIiKTsKdmFyIERlc3Ryb3lSZWYgPSBjbGFzcyB7CiAgc3RhdGljIF9fTkdfRUxFTUVOVF9JRF9fID0gaW5qZWN0RGVzdHJveVJlZjsKICBzdGF0aWMgX19OR19FTlZfSURfXyA9IChpbmplY3RvcikgPT4gaW5qZWN0b3I7Cn07CnZhciBOb2RlSW5qZWN0b3JEZXN0cm95UmVmID0gY2xhc3MgZXh0ZW5kcyBEZXN0cm95UmVmIHsKICBfbFZpZXc7CiAgY29uc3RydWN0b3IoX2xWaWV3KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5fbFZpZXcgPSBfbFZpZXc7CiAgfQogIGdldCBkZXN0cm95ZWQoKSB7CiAgICByZXR1cm4gaXNEZXN0cm95ZWQodGhpcy5fbFZpZXcpOwogIH0KICBvbkRlc3Ryb3koY2FsbGJhY2spIHsKICAgIGNvbnN0IGxWaWV3ID0gdGhpcy5fbFZpZXc7CiAgICBzdG9yZUxWaWV3T25EZXN0cm95KGxWaWV3LCBjYWxsYmFjayk7CiAgICByZXR1cm4gKCkgPT4gcmVtb3ZlTFZpZXdPbkRlc3Ryb3kobFZpZXcsIGNhbGxiYWNrKTsKICB9Cn07CmZ1bmN0aW9uIGluamVjdERlc3Ryb3lSZWYoKSB7CiAgcmV0dXJuIG5ldyBOb2RlSW5qZWN0b3JEZXN0cm95UmVmKGdldExWaWV3KCkpOwp9CnZhciBTQ0hFRFVMRV9JTl9ST09UX1pPTkVfREVGQVVMVCA9IGZhbHNlOwp2YXIgREVCVUdfVEFTS19UUkFDS0VSID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJERUJVR19UQVNLX1RSQUNLRVIiIDogIiIpOwp2YXIgUGVuZGluZ1Rhc2tzSW50ZXJuYWwgPSBjbGFzcyBfUGVuZGluZ1Rhc2tzSW50ZXJuYWwgewogIHRhc2tJZCA9IDA7CiAgcGVuZGluZ1Rhc2tzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICBkZXN0cm95ZWQgPSBmYWxzZTsKICBwZW5kaW5nVGFzayA9IG5ldyBCZWhhdmlvclN1YmplY3QoZmFsc2UpOwogIGRlYnVnVGFza1RyYWNrZXIgPSBpbmplY3QyKERFQlVHX1RBU0tfVFJBQ0tFUiwgewogICAgb3B0aW9uYWw6IHRydWUKICB9KTsKICBnZXQgaGFzUGVuZGluZ1Rhc2tzKCkgewogICAgcmV0dXJuIHRoaXMuZGVzdHJveWVkID8gZmFsc2UgOiB0aGlzLnBlbmRpbmdUYXNrLnZhbHVlOwogIH0KICBnZXQgaGFzUGVuZGluZ1Rhc2tzT2JzZXJ2YWJsZSgpIHsKICAgIGlmICh0aGlzLmRlc3Ryb3llZCkgewogICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoKHN1YnNjcmliZXIpID0+IHsKICAgICAgICBzdWJzY3JpYmVyLm5leHQoZmFsc2UpOwogICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5wZW5kaW5nVGFzazsKICB9CiAgYWRkKCkgewogICAgaWYgKCF0aGlzLmhhc1BlbmRpbmdUYXNrcyAmJiAhdGhpcy5kZXN0cm95ZWQpIHsKICAgICAgdGhpcy5wZW5kaW5nVGFzay5uZXh0KHRydWUpOwogICAgfQogICAgY29uc3QgdGFza0lkID0gdGhpcy50YXNrSWQrKzsKICAgIHRoaXMucGVuZGluZ1Rhc2tzLmFkZCh0YXNrSWQpOwogICAgdGhpcy5kZWJ1Z1Rhc2tUcmFja2VyPy5hZGQodGFza0lkKTsKICAgIHJldHVybiB0YXNrSWQ7CiAgfQogIGhhcyh0YXNrSWQpIHsKICAgIHJldHVybiB0aGlzLnBlbmRpbmdUYXNrcy5oYXModGFza0lkKTsKICB9CiAgcmVtb3ZlKHRhc2tJZCkgewogICAgdGhpcy5wZW5kaW5nVGFza3MuZGVsZXRlKHRhc2tJZCk7CiAgICB0aGlzLmRlYnVnVGFza1RyYWNrZXI/LnJlbW92ZSh0YXNrSWQpOwogICAgaWYgKHRoaXMucGVuZGluZ1Rhc2tzLnNpemUgPT09IDAgJiYgdGhpcy5oYXNQZW5kaW5nVGFza3MpIHsKICAgICAgdGhpcy5wZW5kaW5nVGFzay5uZXh0KGZhbHNlKTsKICAgIH0KICB9CiAgbmdPbkRlc3Ryb3koKSB7CiAgICB0aGlzLnBlbmRpbmdUYXNrcy5jbGVhcigpOwogICAgaWYgKHRoaXMuaGFzUGVuZGluZ1Rhc2tzKSB7CiAgICAgIHRoaXMucGVuZGluZ1Rhc2submV4dChmYWxzZSk7CiAgICB9CiAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7CiAgICB0aGlzLnBlbmRpbmdUYXNrLnVuc3Vic2NyaWJlKCk7CiAgfQogIHN0YXRpYyDJtXByb3YgPSDJtcm1ZGVmaW5lSW5qZWN0YWJsZSh7CiAgICB0b2tlbjogX1BlbmRpbmdUYXNrc0ludGVybmFsLAogICAgcHJvdmlkZWRJbjogInJvb3QiLAogICAgZmFjdG9yeTogKCkgPT4gbmV3IF9QZW5kaW5nVGFza3NJbnRlcm5hbCgpCiAgfSk7Cn07CnZhciBFdmVudEVtaXR0ZXJfID0gY2xhc3MgZXh0ZW5kcyBTdWJqZWN0IHsKICBfX2lzQXN5bmM7CiAgZGVzdHJveVJlZiA9IHZvaWQgMDsKICBwZW5kaW5nVGFza3MgPSB2b2lkIDA7CiAgY29uc3RydWN0b3IoaXNBc3luYyA9IGZhbHNlKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5fX2lzQXN5bmMgPSBpc0FzeW5jOwogICAgaWYgKGlzSW5JbmplY3Rpb25Db250ZXh0KCkpIHsKICAgICAgdGhpcy5kZXN0cm95UmVmID0gaW5qZWN0MihEZXN0cm95UmVmLCB7CiAgICAgICAgb3B0aW9uYWw6IHRydWUKICAgICAgfSkgPz8gdm9pZCAwOwogICAgICB0aGlzLnBlbmRpbmdUYXNrcyA9IGluamVjdDIoUGVuZGluZ1Rhc2tzSW50ZXJuYWwsIHsKICAgICAgICBvcHRpb25hbDogdHJ1ZQogICAgICB9KSA/PyB2b2lkIDA7CiAgICB9CiAgfQogIGVtaXQodmFsdWUpIHsKICAgIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogICAgdHJ5IHsKICAgICAgc3VwZXIubmV4dCh2YWx1ZSk7CiAgICB9IGZpbmFsbHkgewogICAgICBzZXRBY3RpdmVDb25zdW1lcihwcmV2Q29uc3VtZXIpOwogICAgfQogIH0KICBzdWJzY3JpYmUob2JzZXJ2ZXJPck5leHQsIGVycm9yLCBjb21wbGV0ZSkgewogICAgbGV0IG5leHRGbiA9IG9ic2VydmVyT3JOZXh0OwogICAgbGV0IGVycm9yRm4gPSBlcnJvciB8fCAoKCkgPT4gbnVsbCk7CiAgICBsZXQgY29tcGxldGVGbiA9IGNvbXBsZXRlOwogICAgaWYgKG9ic2VydmVyT3JOZXh0ICYmIHR5cGVvZiBvYnNlcnZlck9yTmV4dCA9PT0gIm9iamVjdCIpIHsKICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBvYnNlcnZlck9yTmV4dDsKICAgICAgbmV4dEZuID0gb2JzZXJ2ZXIubmV4dD8uYmluZChvYnNlcnZlcik7CiAgICAgIGVycm9yRm4gPSBvYnNlcnZlci5lcnJvcj8uYmluZChvYnNlcnZlcik7CiAgICAgIGNvbXBsZXRlRm4gPSBvYnNlcnZlci5jb21wbGV0ZT8uYmluZChvYnNlcnZlcik7CiAgICB9CiAgICBpZiAodGhpcy5fX2lzQXN5bmMpIHsKICAgICAgZXJyb3JGbiA9IHRoaXMud3JhcEluVGltZW91dChlcnJvckZuKTsKICAgICAgaWYgKG5leHRGbikgewogICAgICAgIG5leHRGbiA9IHRoaXMud3JhcEluVGltZW91dChuZXh0Rm4pOwogICAgICB9CiAgICAgIGlmIChjb21wbGV0ZUZuKSB7CiAgICAgICAgY29tcGxldGVGbiA9IHRoaXMud3JhcEluVGltZW91dChjb21wbGV0ZUZuKTsKICAgICAgfQogICAgfQogICAgY29uc3Qgc2luayA9IHN1cGVyLnN1YnNjcmliZSh7CiAgICAgIG5leHQ6IG5leHRGbiwKICAgICAgZXJyb3I6IGVycm9yRm4sCiAgICAgIGNvbXBsZXRlOiBjb21wbGV0ZUZuCiAgICB9KTsKICAgIGlmIChvYnNlcnZlck9yTmV4dCBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbikgewogICAgICBvYnNlcnZlck9yTmV4dC5hZGQoc2luayk7CiAgICB9CiAgICByZXR1cm4gc2luazsKICB9CiAgd3JhcEluVGltZW91dChmbikgewogICAgcmV0dXJuICh2YWx1ZSkgPT4gewogICAgICBjb25zdCB0YXNrSWQgPSB0aGlzLnBlbmRpbmdUYXNrcz8uYWRkKCk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBmbih2YWx1ZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmICh0YXNrSWQgIT09IHZvaWQgMCkgewogICAgICAgICAgICB0aGlzLnBlbmRpbmdUYXNrcz8ucmVtb3ZlKHRhc2tJZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfQp9Owp2YXIgRXZlbnRFbWl0dGVyID0gRXZlbnRFbWl0dGVyXzsKZnVuY3Rpb24gbm9vcDIoLi4uYXJncykgewp9CmZ1bmN0aW9uIHNjaGVkdWxlQ2FsbGJhY2tXaXRoUmFmUmFjZShjYWxsYmFjaykgewogIGxldCB0aW1lb3V0SWQ7CiAgbGV0IGFuaW1hdGlvbkZyYW1lSWQ7CiAgZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgIGNhbGxiYWNrID0gbm9vcDI7CiAgICB0cnkgewogICAgICBpZiAoYW5pbWF0aW9uRnJhbWVJZCAhPT0gdm9pZCAwICYmIHR5cGVvZiBjYW5jZWxBbmltYXRpb25GcmFtZSA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lSWQpOwogICAgICB9CiAgICAgIGlmICh0aW1lb3V0SWQgIT09IHZvaWQgMCkgewogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpOwogICAgICB9CiAgICB9IGNhdGNoIHsKICAgIH0KICB9CiAgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICBjYWxsYmFjaygpOwogICAgY2xlYW51cCgpOwogIH0pOwogIGlmICh0eXBlb2YgcmVxdWVzdEFuaW1hdGlvbkZyYW1lID09PSAiZnVuY3Rpb24iKSB7CiAgICBhbmltYXRpb25GcmFtZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsKICAgICAgY2FsbGJhY2soKTsKICAgICAgY2xlYW51cCgpOwogICAgfSk7CiAgfQogIHJldHVybiAoKSA9PiBjbGVhbnVwKCk7Cn0KZnVuY3Rpb24gc2NoZWR1bGVDYWxsYmFja1dpdGhNaWNyb3Rhc2soY2FsbGJhY2spIHsKICBxdWV1ZU1pY3JvdGFzaygoKSA9PiBjYWxsYmFjaygpKTsKICByZXR1cm4gKCkgPT4gewogICAgY2FsbGJhY2sgPSBub29wMjsKICB9Owp9CnZhciBBc3luY1N0YWNrVGFnZ2luZ1pvbmVTcGVjID0gY2xhc3MgewogIGNyZWF0ZVRhc2s7CiAgY29uc3RydWN0b3IobmFtZVByZWZpeCwgY29uc29sZUFzeW5jU3RhY2tUYWdnaW5nSW1wbCA9IGNvbnNvbGUpIHsKICAgIHRoaXMubmFtZSA9ICJhc3luY1N0YWNrVGFnZ2luZyBmb3IgIiArIG5hbWVQcmVmaXg7CiAgICB0aGlzLmNyZWF0ZVRhc2sgPSBjb25zb2xlQXN5bmNTdGFja1RhZ2dpbmdJbXBsPy5jcmVhdGVUYXNrID8/ICgoKSA9PiBudWxsKTsKICB9CiAgbmFtZTsKICBvblNjaGVkdWxlVGFzayhkZWxlZ2F0ZSwgX2N1cnJlbnQsIHRhcmdldCwgdGFzaykgewogICAgdGFzay5jb25zb2xlVGFzayA9IHRoaXMuY3JlYXRlVGFzayhgWm9uZSAtICR7dGFzay5zb3VyY2UgfHwgdGFzay50eXBlfWApOwogICAgcmV0dXJuIGRlbGVnYXRlLnNjaGVkdWxlVGFzayh0YXJnZXQsIHRhc2spOwogIH0KICBvbkludm9rZVRhc2soZGVsZWdhdGUsIF9jdXJyZW50Wm9uZSwgdGFyZ2V0Wm9uZSwgdGFzaywgYXBwbHlUaGlzLCBhcHBseUFyZ3MpIHsKICAgIGxldCByZXQ7CiAgICBpZiAodGFzay5jb25zb2xlVGFzaykgewogICAgICByZXQgPSB0YXNrLmNvbnNvbGVUYXNrLnJ1bigoKSA9PiBkZWxlZ2F0ZS5pbnZva2VUYXNrKHRhcmdldFpvbmUsIHRhc2ssIGFwcGx5VGhpcywgYXBwbHlBcmdzKSk7CiAgICB9IGVsc2UgewogICAgICByZXQgPSBkZWxlZ2F0ZS5pbnZva2VUYXNrKHRhcmdldFpvbmUsIHRhc2ssIGFwcGx5VGhpcywgYXBwbHlBcmdzKTsKICAgIH0KICAgIHJldHVybiByZXQ7CiAgfQp9Owp2YXIgaXNBbmd1bGFyWm9uZVByb3BlcnR5ID0gImlzQW5ndWxhclpvbmUiOwp2YXIgYW5ndWxhclpvbmVJbnN0YW5jZUlkUHJvcGVydHkgPSBpc0FuZ3VsYXJab25lUHJvcGVydHkgKyAiX0lEIjsKdmFyIG5nWm9uZUluc3RhbmNlSWQgPSAwOwp2YXIgTmdab25lID0gY2xhc3MgX05nWm9uZSB7CiAgaGFzUGVuZGluZ01hY3JvdGFza3MgPSBmYWxzZTsKICBoYXNQZW5kaW5nTWljcm90YXNrcyA9IGZhbHNlOwogIGlzU3RhYmxlID0gdHJ1ZTsKICBvblVuc3RhYmxlID0gbmV3IEV2ZW50RW1pdHRlcihmYWxzZSk7CiAgb25NaWNyb3Rhc2tFbXB0eSA9IG5ldyBFdmVudEVtaXR0ZXIoZmFsc2UpOwogIG9uU3RhYmxlID0gbmV3IEV2ZW50RW1pdHRlcihmYWxzZSk7CiAgb25FcnJvciA9IG5ldyBFdmVudEVtaXR0ZXIoZmFsc2UpOwogIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgIGNvbnN0IHsKICAgICAgZW5hYmxlTG9uZ1N0YWNrVHJhY2UgPSBmYWxzZSwKICAgICAgc2hvdWxkQ29hbGVzY2VFdmVudENoYW5nZURldGVjdGlvbiA9IGZhbHNlLAogICAgICBzaG91bGRDb2FsZXNjZVJ1bkNoYW5nZURldGVjdGlvbiA9IGZhbHNlLAogICAgICBzY2hlZHVsZUluUm9vdFpvbmUgPSBTQ0hFRFVMRV9JTl9ST09UX1pPTkVfREVGQVVMVAogICAgfSA9IG9wdGlvbnM7CiAgICBpZiAodHlwZW9mIFpvbmUgPT0gInVuZGVmaW5lZCIpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDgsIG5nRGV2TW9kZSAmJiBgSW4gdGhpcyBjb25maWd1cmF0aW9uIEFuZ3VsYXIgcmVxdWlyZXMgWm9uZS5qc2ApOwogICAgfQogICAgWm9uZS5hc3NlcnRab25lUGF0Y2hlZCgpOwogICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICBzZWxmLl9uZXN0aW5nID0gMDsKICAgIHNlbGYuX291dGVyID0gc2VsZi5faW5uZXIgPSBab25lLmN1cnJlbnQ7CiAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgIHNlbGYuX2lubmVyID0gc2VsZi5faW5uZXIuZm9yayhuZXcgQXN5bmNTdGFja1RhZ2dpbmdab25lU3BlYygiQW5ndWxhciIpKTsKICAgIH0KICAgIGlmIChab25lWyJUYXNrVHJhY2tpbmdab25lU3BlYyJdKSB7CiAgICAgIHNlbGYuX2lubmVyID0gc2VsZi5faW5uZXIuZm9yayhuZXcgWm9uZVsiVGFza1RyYWNraW5nWm9uZVNwZWMiXSgpKTsKICAgIH0KICAgIGlmIChlbmFibGVMb25nU3RhY2tUcmFjZSAmJiBab25lWyJsb25nU3RhY2tUcmFjZVpvbmVTcGVjIl0pIHsKICAgICAgc2VsZi5faW5uZXIgPSBzZWxmLl9pbm5lci5mb3JrKFpvbmVbImxvbmdTdGFja1RyYWNlWm9uZVNwZWMiXSk7CiAgICB9CiAgICBzZWxmLnNob3VsZENvYWxlc2NlRXZlbnRDaGFuZ2VEZXRlY3Rpb24gPSAhc2hvdWxkQ29hbGVzY2VSdW5DaGFuZ2VEZXRlY3Rpb24gJiYgc2hvdWxkQ29hbGVzY2VFdmVudENoYW5nZURldGVjdGlvbjsKICAgIHNlbGYuc2hvdWxkQ29hbGVzY2VSdW5DaGFuZ2VEZXRlY3Rpb24gPSBzaG91bGRDb2FsZXNjZVJ1bkNoYW5nZURldGVjdGlvbjsKICAgIHNlbGYuY2FsbGJhY2tTY2hlZHVsZWQgPSBmYWxzZTsKICAgIHNlbGYuc2NoZWR1bGVJblJvb3Rab25lID0gc2NoZWR1bGVJblJvb3Rab25lOwogICAgZm9ya0lubmVyWm9uZVdpdGhBbmd1bGFyQmVoYXZpb3Ioc2VsZik7CiAgfQogIHN0YXRpYyBpc0luQW5ndWxhclpvbmUoKSB7CiAgICByZXR1cm4gdHlwZW9mIFpvbmUgIT09ICJ1bmRlZmluZWQiICYmIFpvbmUuY3VycmVudC5nZXQoaXNBbmd1bGFyWm9uZVByb3BlcnR5KSA9PT0gdHJ1ZTsKICB9CiAgc3RhdGljIGFzc2VydEluQW5ndWxhclpvbmUoKSB7CiAgICBpZiAoIV9OZ1pvbmUuaXNJbkFuZ3VsYXJab25lKCkpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDksIG5nRGV2TW9kZSAmJiAiRXhwZWN0ZWQgdG8gYmUgaW4gQW5ndWxhciBab25lLCBidXQgaXQgaXMgbm90ISIpOwogICAgfQogIH0KICBzdGF0aWMgYXNzZXJ0Tm90SW5Bbmd1bGFyWm9uZSgpIHsKICAgIGlmIChfTmdab25lLmlzSW5Bbmd1bGFyWm9uZSgpKSB7CiAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTA5LCBuZ0Rldk1vZGUgJiYgIkV4cGVjdGVkIHRvIG5vdCBiZSBpbiBBbmd1bGFyIFpvbmUsIGJ1dCBpdCBpcyEiKTsKICAgIH0KICB9CiAgcnVuKGZuLCBhcHBseVRoaXMsIGFwcGx5QXJncykgewogICAgcmV0dXJuIHRoaXMuX2lubmVyLnJ1bihmbiwgYXBwbHlUaGlzLCBhcHBseUFyZ3MpOwogIH0KICBydW5UYXNrKGZuLCBhcHBseVRoaXMsIGFwcGx5QXJncywgbmFtZSkgewogICAgY29uc3Qgem9uZSA9IHRoaXMuX2lubmVyOwogICAgY29uc3QgdGFzayA9IHpvbmUuc2NoZWR1bGVFdmVudFRhc2soIk5nWm9uZUV2ZW50OiAiICsgbmFtZSwgZm4sIEVNUFRZX1BBWUxPQUQsIG5vb3AyLCBub29wMik7CiAgICB0cnkgewogICAgICByZXR1cm4gem9uZS5ydW5UYXNrKHRhc2ssIGFwcGx5VGhpcywgYXBwbHlBcmdzKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHpvbmUuY2FuY2VsVGFzayh0YXNrKTsKICAgIH0KICB9CiAgcnVuR3VhcmRlZChmbiwgYXBwbHlUaGlzLCBhcHBseUFyZ3MpIHsKICAgIHJldHVybiB0aGlzLl9pbm5lci5ydW5HdWFyZGVkKGZuLCBhcHBseVRoaXMsIGFwcGx5QXJncyk7CiAgfQogIHJ1bk91dHNpZGVBbmd1bGFyKGZuKSB7CiAgICByZXR1cm4gdGhpcy5fb3V0ZXIucnVuKGZuKTsKICB9Cn07CnZhciBFTVBUWV9QQVlMT0FEID0ge307CmZ1bmN0aW9uIGNoZWNrU3RhYmxlKHpvbmUpIHsKICBpZiAoem9uZS5fbmVzdGluZyA9PSAwICYmICF6b25lLmhhc1BlbmRpbmdNaWNyb3Rhc2tzICYmICF6b25lLmlzU3RhYmxlKSB7CiAgICB0cnkgewogICAgICB6b25lLl9uZXN0aW5nKys7CiAgICAgIHpvbmUub25NaWNyb3Rhc2tFbXB0eS5lbWl0KG51bGwpOwogICAgfSBmaW5hbGx5IHsKICAgICAgem9uZS5fbmVzdGluZy0tOwogICAgICBpZiAoIXpvbmUuaGFzUGVuZGluZ01pY3JvdGFza3MpIHsKICAgICAgICB0cnkgewogICAgICAgICAgem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB6b25lLm9uU3RhYmxlLmVtaXQobnVsbCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICB6b25lLmlzU3RhYmxlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gZGVsYXlDaGFuZ2VEZXRlY3Rpb25Gb3JFdmVudHMoem9uZSkgewogIGlmICh6b25lLmlzQ2hlY2tTdGFibGVSdW5uaW5nIHx8IHpvbmUuY2FsbGJhY2tTY2hlZHVsZWQpIHsKICAgIHJldHVybjsKICB9CiAgem9uZS5jYWxsYmFja1NjaGVkdWxlZCA9IHRydWU7CiAgZnVuY3Rpb24gc2NoZWR1bGVDaGVja1N0YWJsZSgpIHsKICAgIHNjaGVkdWxlQ2FsbGJhY2tXaXRoUmFmUmFjZSgoKSA9PiB7CiAgICAgIHpvbmUuY2FsbGJhY2tTY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgdXBkYXRlTWljcm9UYXNrU3RhdHVzKHpvbmUpOwogICAgICB6b25lLmlzQ2hlY2tTdGFibGVSdW5uaW5nID0gdHJ1ZTsKICAgICAgY2hlY2tTdGFibGUoem9uZSk7CiAgICAgIHpvbmUuaXNDaGVja1N0YWJsZVJ1bm5pbmcgPSBmYWxzZTsKICAgIH0pOwogIH0KICBpZiAoem9uZS5zY2hlZHVsZUluUm9vdFpvbmUpIHsKICAgIFpvbmUucm9vdC5ydW4oKCkgPT4gewogICAgICBzY2hlZHVsZUNoZWNrU3RhYmxlKCk7CiAgICB9KTsKICB9IGVsc2UgewogICAgem9uZS5fb3V0ZXIucnVuKCgpID0+IHsKICAgICAgc2NoZWR1bGVDaGVja1N0YWJsZSgpOwogICAgfSk7CiAgfQogIHVwZGF0ZU1pY3JvVGFza1N0YXR1cyh6b25lKTsKfQpmdW5jdGlvbiBmb3JrSW5uZXJab25lV2l0aEFuZ3VsYXJCZWhhdmlvcih6b25lKSB7CiAgY29uc3QgZGVsYXlDaGFuZ2VEZXRlY3Rpb25Gb3JFdmVudHNEZWxlZ2F0ZSA9ICgpID0+IHsKICAgIGRlbGF5Q2hhbmdlRGV0ZWN0aW9uRm9yRXZlbnRzKHpvbmUpOwogIH07CiAgY29uc3QgaW5zdGFuY2VJZCA9IG5nWm9uZUluc3RhbmNlSWQrKzsKICB6b25lLl9pbm5lciA9IHpvbmUuX2lubmVyLmZvcmsoewogICAgbmFtZTogImFuZ3VsYXIiLAogICAgcHJvcGVydGllczogewogICAgICBbaXNBbmd1bGFyWm9uZVByb3BlcnR5XTogdHJ1ZSwKICAgICAgW2FuZ3VsYXJab25lSW5zdGFuY2VJZFByb3BlcnR5XTogaW5zdGFuY2VJZCwKICAgICAgW2FuZ3VsYXJab25lSW5zdGFuY2VJZFByb3BlcnR5ICsgaW5zdGFuY2VJZF06IHRydWUKICAgIH0sCiAgICBvbkludm9rZVRhc2s6IChkZWxlZ2F0ZSwgY3VycmVudCwgdGFyZ2V0LCB0YXNrLCBhcHBseVRoaXMsIGFwcGx5QXJncykgPT4gewogICAgICBpZiAoc2hvdWxkQmVJZ25vcmVkQnlab25lKGFwcGx5QXJncykpIHsKICAgICAgICByZXR1cm4gZGVsZWdhdGUuaW52b2tlVGFzayh0YXJnZXQsIHRhc2ssIGFwcGx5VGhpcywgYXBwbHlBcmdzKTsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIG9uRW50ZXIoem9uZSk7CiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmludm9rZVRhc2sodGFyZ2V0LCB0YXNrLCBhcHBseVRoaXMsIGFwcGx5QXJncyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaWYgKHpvbmUuc2hvdWxkQ29hbGVzY2VFdmVudENoYW5nZURldGVjdGlvbiAmJiB0YXNrLnR5cGUgPT09ICJldmVudFRhc2siIHx8IHpvbmUuc2hvdWxkQ29hbGVzY2VSdW5DaGFuZ2VEZXRlY3Rpb24pIHsKICAgICAgICAgIGRlbGF5Q2hhbmdlRGV0ZWN0aW9uRm9yRXZlbnRzRGVsZWdhdGUoKTsKICAgICAgICB9CiAgICAgICAgb25MZWF2ZSh6b25lKTsKICAgICAgfQogICAgfSwKICAgIG9uSW52b2tlOiAoZGVsZWdhdGUsIGN1cnJlbnQsIHRhcmdldCwgY2FsbGJhY2ssIGFwcGx5VGhpcywgYXBwbHlBcmdzLCBzb3VyY2UpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBvbkVudGVyKHpvbmUpOwogICAgICAgIHJldHVybiBkZWxlZ2F0ZS5pbnZva2UodGFyZ2V0LCBjYWxsYmFjaywgYXBwbHlUaGlzLCBhcHBseUFyZ3MsIHNvdXJjZSk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaWYgKHpvbmUuc2hvdWxkQ29hbGVzY2VSdW5DaGFuZ2VEZXRlY3Rpb24gJiYgIXpvbmUuY2FsbGJhY2tTY2hlZHVsZWQgJiYgIWlzU2NoZWR1bGVyVGljayhhcHBseUFyZ3MpKSB7CiAgICAgICAgICBkZWxheUNoYW5nZURldGVjdGlvbkZvckV2ZW50c0RlbGVnYXRlKCk7CiAgICAgICAgfQogICAgICAgIG9uTGVhdmUoem9uZSk7CiAgICAgIH0KICAgIH0sCiAgICBvbkhhc1Rhc2s6IChkZWxlZ2F0ZSwgY3VycmVudCwgdGFyZ2V0LCBoYXNUYXNrU3RhdGUpID0+IHsKICAgICAgZGVsZWdhdGUuaGFzVGFzayh0YXJnZXQsIGhhc1Rhc2tTdGF0ZSk7CiAgICAgIGlmIChjdXJyZW50ID09PSB0YXJnZXQpIHsKICAgICAgICBpZiAoaGFzVGFza1N0YXRlLmNoYW5nZSA9PSAibWljcm9UYXNrIikgewogICAgICAgICAgem9uZS5faGFzUGVuZGluZ01pY3JvdGFza3MgPSBoYXNUYXNrU3RhdGUubWljcm9UYXNrOwogICAgICAgICAgdXBkYXRlTWljcm9UYXNrU3RhdHVzKHpvbmUpOwogICAgICAgICAgY2hlY2tTdGFibGUoem9uZSk7CiAgICAgICAgfSBlbHNlIGlmIChoYXNUYXNrU3RhdGUuY2hhbmdlID09ICJtYWNyb1Rhc2siKSB7CiAgICAgICAgICB6b25lLmhhc1BlbmRpbmdNYWNyb3Rhc2tzID0gaGFzVGFza1N0YXRlLm1hY3JvVGFzazsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBvbkhhbmRsZUVycm9yOiAoZGVsZWdhdGUsIGN1cnJlbnQsIHRhcmdldCwgZXJyb3IpID0+IHsKICAgICAgZGVsZWdhdGUuaGFuZGxlRXJyb3IodGFyZ2V0LCBlcnJvcik7CiAgICAgIHpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gem9uZS5vbkVycm9yLmVtaXQoZXJyb3IpKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pOwp9CmZ1bmN0aW9uIHVwZGF0ZU1pY3JvVGFza1N0YXR1cyh6b25lKSB7CiAgaWYgKHpvbmUuX2hhc1BlbmRpbmdNaWNyb3Rhc2tzIHx8ICh6b25lLnNob3VsZENvYWxlc2NlRXZlbnRDaGFuZ2VEZXRlY3Rpb24gfHwgem9uZS5zaG91bGRDb2FsZXNjZVJ1bkNoYW5nZURldGVjdGlvbikgJiYgem9uZS5jYWxsYmFja1NjaGVkdWxlZCA9PT0gdHJ1ZSkgewogICAgem9uZS5oYXNQZW5kaW5nTWljcm90YXNrcyA9IHRydWU7CiAgfSBlbHNlIHsKICAgIHpvbmUuaGFzUGVuZGluZ01pY3JvdGFza3MgPSBmYWxzZTsKICB9Cn0KZnVuY3Rpb24gb25FbnRlcih6b25lKSB7CiAgem9uZS5fbmVzdGluZysrOwogIGlmICh6b25lLmlzU3RhYmxlKSB7CiAgICB6b25lLmlzU3RhYmxlID0gZmFsc2U7CiAgICB6b25lLm9uVW5zdGFibGUuZW1pdChudWxsKTsKICB9Cn0KZnVuY3Rpb24gb25MZWF2ZSh6b25lKSB7CiAgem9uZS5fbmVzdGluZy0tOwogIGNoZWNrU3RhYmxlKHpvbmUpOwp9CnZhciBOb29wTmdab25lID0gY2xhc3MgewogIGhhc1BlbmRpbmdNaWNyb3Rhc2tzID0gZmFsc2U7CiAgaGFzUGVuZGluZ01hY3JvdGFza3MgPSBmYWxzZTsKICBpc1N0YWJsZSA9IHRydWU7CiAgb25VbnN0YWJsZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTsKICBvbk1pY3JvdGFza0VtcHR5ID0gbmV3IEV2ZW50RW1pdHRlcigpOwogIG9uU3RhYmxlID0gbmV3IEV2ZW50RW1pdHRlcigpOwogIG9uRXJyb3IgPSBuZXcgRXZlbnRFbWl0dGVyKCk7CiAgcnVuKGZuLCBhcHBseVRoaXMsIGFwcGx5QXJncykgewogICAgcmV0dXJuIGZuLmFwcGx5KGFwcGx5VGhpcywgYXBwbHlBcmdzKTsKICB9CiAgcnVuR3VhcmRlZChmbiwgYXBwbHlUaGlzLCBhcHBseUFyZ3MpIHsKICAgIHJldHVybiBmbi5hcHBseShhcHBseVRoaXMsIGFwcGx5QXJncyk7CiAgfQogIHJ1bk91dHNpZGVBbmd1bGFyKGZuKSB7CiAgICByZXR1cm4gZm4oKTsKICB9CiAgcnVuVGFzayhmbiwgYXBwbHlUaGlzLCBhcHBseUFyZ3MsIG5hbWUpIHsKICAgIHJldHVybiBmbi5hcHBseShhcHBseVRoaXMsIGFwcGx5QXJncyk7CiAgfQp9OwpmdW5jdGlvbiBzaG91bGRCZUlnbm9yZWRCeVpvbmUoYXBwbHlBcmdzKSB7CiAgcmV0dXJuIGhhc0FwcGx5QXJnc0RhdGEoYXBwbHlBcmdzLCAiX19pZ25vcmVfbmdfem9uZV9fIik7Cn0KZnVuY3Rpb24gaXNTY2hlZHVsZXJUaWNrKGFwcGx5QXJncykgewogIHJldHVybiBoYXNBcHBseUFyZ3NEYXRhKGFwcGx5QXJncywgIl9fc2NoZWR1bGVyX3RpY2tfXyIpOwp9CmZ1bmN0aW9uIGhhc0FwcGx5QXJnc0RhdGEoYXBwbHlBcmdzLCBrZXkpIHsKICBpZiAoIUFycmF5LmlzQXJyYXkoYXBwbHlBcmdzKSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoYXBwbHlBcmdzLmxlbmd0aCAhPT0gMSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gYXBwbHlBcmdzWzBdPy5kYXRhPy5ba2V5XSA9PT0gdHJ1ZTsKfQp2YXIgRXJyb3JIYW5kbGVyID0gY2xhc3MgewogIF9jb25zb2xlID0gY29uc29sZTsKICBoYW5kbGVFcnJvcihlcnJvcikgewogICAgdGhpcy5fY29uc29sZS5lcnJvcigiRVJST1IiLCBlcnJvcik7CiAgfQp9Owp2YXIgSU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUiA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUgPyAiaW50ZXJuYWwgZXJyb3IgaGFuZGxlciIgOiAiIiwgewogIGZhY3Rvcnk6ICgpID0+IHsKICAgIGNvbnN0IHpvbmUgPSBpbmplY3QyKE5nWm9uZSk7CiAgICBjb25zdCBpbmplY3RvciA9IGluamVjdDIoRW52aXJvbm1lbnRJbmplY3Rvcik7CiAgICBsZXQgdXNlckVycm9ySGFuZGxlcjsKICAgIHJldHVybiAoZSkgPT4gewogICAgICB6b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHsKICAgICAgICBpZiAoaW5qZWN0b3IuZGVzdHJveWVkICYmICF1c2VyRXJyb3JIYW5kbGVyKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB1c2VyRXJyb3JIYW5kbGVyID8/PSBpbmplY3Rvci5nZXQoRXJyb3JIYW5kbGVyKTsKICAgICAgICAgIHVzZXJFcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IoZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfQp9KTsKdmFyIGVycm9ySGFuZGxlckVudmlyb25tZW50SW5pdGlhbGl6ZXIgPSB7CiAgcHJvdmlkZTogRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsCiAgdXNlVmFsdWU6ICgpID0+IHsKICAgIGNvbnN0IGhhbmRsZXIgPSBpbmplY3QyKEVycm9ySGFuZGxlciwgewogICAgICBvcHRpb25hbDogdHJ1ZQogICAgfSk7CiAgICBpZiAoKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgaGFuZGxlciA9PT0gbnVsbCkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDQwMiwgYEEgcmVxdWlyZWQgSW5qZWN0YWJsZSB3YXMgbm90IGZvdW5kIGluIHRoZSBkZXBlbmRlbmN5IGluamVjdGlvbiB0cmVlLiBJZiB5b3UgYXJlIGJvb3RzdHJhcHBpbmcgYW4gTmdNb2R1bGUsIG1ha2Ugc3VyZSB0aGF0IHRoZSBcYEJyb3dzZXJNb2R1bGVcYCBpcyBpbXBvcnRlZC5gKTsKICAgIH0KICB9LAogIG11bHRpOiB0cnVlCn07CnZhciBnbG9iYWxFcnJvckxpc3RlbmVycyA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiR2xvYmFsRXJyb3JMaXN0ZW5lcnMiIDogIiIsIHsKICBmYWN0b3J5OiAoKSA9PiB7CiAgICBpZiAoZmFsc2UpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3Qgd2luZG93MyA9IGluamVjdDIoRE9DVU1FTlQpLmRlZmF1bHRWaWV3OwogICAgaWYgKCF3aW5kb3czKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IGVycm9ySGFuZGxlciA9IGluamVjdDIoSU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUik7CiAgICBjb25zdCByZWplY3Rpb25MaXN0ZW5lciA9IChlKSA9PiB7CiAgICAgIGVycm9ySGFuZGxlcihlLnJlYXNvbik7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH07CiAgICBjb25zdCBlcnJvckxpc3RlbmVyID0gKGUpID0+IHsKICAgICAgaWYgKGUuZXJyb3IpIHsKICAgICAgICBlcnJvckhhbmRsZXIoZS5lcnJvcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihuZ0Rldk1vZGUgPyBgQW4gRXJyb3JFdmVudCB3aXRoIG5vIGVycm9yIG9jY3VycmVkLiBTZWUgRXJyb3IuY2F1c2UgZm9yIGRldGFpbHM6ICR7ZS5tZXNzYWdlfWAgOiBlLm1lc3NhZ2UsIHsKICAgICAgICAgIGNhdXNlOiBlCiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH07CiAgICBjb25zdCBzZXR1cEV2ZW50TGlzdGVuZXJzID0gKCkgPT4gewogICAgICB3aW5kb3czLmFkZEV2ZW50TGlzdGVuZXIoInVuaGFuZGxlZHJlamVjdGlvbiIsIHJlamVjdGlvbkxpc3RlbmVyKTsKICAgICAgd2luZG93My5hZGRFdmVudExpc3RlbmVyKCJlcnJvciIsIGVycm9yTGlzdGVuZXIpOwogICAgfTsKICAgIGlmICh0eXBlb2YgWm9uZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgWm9uZS5yb290LnJ1bihzZXR1cEV2ZW50TGlzdGVuZXJzKTsKICAgIH0gZWxzZSB7CiAgICAgIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTsKICAgIH0KICAgIGluamVjdDIoRGVzdHJveVJlZikub25EZXN0cm95KCgpID0+IHsKICAgICAgd2luZG93My5yZW1vdmVFdmVudExpc3RlbmVyKCJlcnJvciIsIGVycm9yTGlzdGVuZXIpOwogICAgICB3aW5kb3czLnJlbW92ZUV2ZW50TGlzdGVuZXIoInVuaGFuZGxlZHJlamVjdGlvbiIsIHJlamVjdGlvbkxpc3RlbmVyKTsKICAgIH0pOwogIH0KfSk7CmZ1bmN0aW9uIHByb3ZpZGVCcm93c2VyR2xvYmFsRXJyb3JMaXN0ZW5lcnMoKSB7CiAgcmV0dXJuIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhbcHJvdmlkZUVudmlyb25tZW50SW5pdGlhbGl6ZXIoKCkgPT4gdm9pZCBpbmplY3QyKGdsb2JhbEVycm9yTGlzdGVuZXJzKSldKTsKfQpmdW5jdGlvbiDJtXVud3JhcFdyaXRhYmxlU2lnbmFsKHZhbHVlKSB7CiAgcmV0dXJuIG51bGw7Cn0KZnVuY3Rpb24gc2lnbmFsKGluaXRpYWxWYWx1ZSwgb3B0aW9ucykgewogIGNvbnN0IFtnZXQyLCBzZXQyLCB1cGRhdGVdID0gY3JlYXRlU2lnbmFsKGluaXRpYWxWYWx1ZSwgb3B0aW9ucz8uZXF1YWwpOwogIGNvbnN0IHNpZ25hbEZuID0gZ2V0MjsKICBjb25zdCBub2RlID0gc2lnbmFsRm5bU0lHTkFMXTsKICBzaWduYWxGbi5zZXQgPSBzZXQyOwogIHNpZ25hbEZuLnVwZGF0ZSA9IHVwZGF0ZTsKICBzaWduYWxGbi5hc1JlYWRvbmx5ID0gc2lnbmFsQXNSZWFkb25seUZuLmJpbmQoc2lnbmFsRm4pOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHNpZ25hbEZuLnRvU3RyaW5nID0gKCkgPT4gYFtTaWduYWw6ICR7c2lnbmFsRm4oKX1dYDsKICAgIG5vZGUuZGVidWdOYW1lID0gb3B0aW9ucz8uZGVidWdOYW1lOwogIH0KICByZXR1cm4gc2lnbmFsRm47Cn0KZnVuY3Rpb24gc2lnbmFsQXNSZWFkb25seUZuKCkgewogIGNvbnN0IG5vZGUgPSB0aGlzW1NJR05BTF07CiAgaWYgKG5vZGUucmVhZG9ubHlGbiA9PT0gdm9pZCAwKSB7CiAgICBjb25zdCByZWFkb25seUZuID0gKCkgPT4gdGhpcygpOwogICAgcmVhZG9ubHlGbltTSUdOQUxdID0gbm9kZTsKICAgIG5vZGUucmVhZG9ubHlGbiA9IHJlYWRvbmx5Rm47CiAgfQogIHJldHVybiBub2RlLnJlYWRvbmx5Rm47Cn0KZnVuY3Rpb24gYXNzZXJ0Tm90SW5SZWFjdGl2ZUNvbnRleHQoZGVidWdGbiwgZXh0cmFDb250ZXh0KSB7CiAgaWYgKGdldEFjdGl2ZUNvbnN1bWVyKCkgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTYwMiwgbmdEZXZNb2RlICYmIGAke2RlYnVnRm4ubmFtZX0oKSBjYW5ub3QgYmUgY2FsbGVkIGZyb20gd2l0aGluIGEgcmVhY3RpdmUgY29udGV4dC4ke2V4dHJhQ29udGV4dCA/IGAgJHtleHRyYUNvbnRleHR9YCA6ICIifWApOwogIH0KfQp2YXIgVmlld0NvbnRleHQgPSBjbGFzcyB7CiAgdmlldzsKICBub2RlOwogIGNvbnN0cnVjdG9yKHZpZXcsIG5vZGUpIHsKICAgIHRoaXMudmlldyA9IHZpZXc7CiAgICB0aGlzLm5vZGUgPSBub2RlOwogIH0KICBzdGF0aWMgX19OR19FTEVNRU5UX0lEX18gPSBpbmplY3RWaWV3Q29udGV4dDsKfTsKZnVuY3Rpb24gaW5qZWN0Vmlld0NvbnRleHQoKSB7CiAgcmV0dXJuIG5ldyBWaWV3Q29udGV4dChnZXRMVmlldygpLCBnZXRDdXJyZW50VE5vZGUoKSk7Cn0KdmFyIENoYW5nZURldGVjdGlvblNjaGVkdWxlciA9IGNsYXNzIHsKfTsKdmFyIFpPTkVMRVNTX0VOQUJMRUQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIlpvbmVsZXNzIGVuYWJsZWQiIDogIiIsIHsKICBmYWN0b3J5OiAoKSA9PiB0cnVlCn0pOwp2YXIgUFJPVklERURfWk9ORUxFU1MgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIlpvbmVsZXNzIHByb3ZpZGVkIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gZmFsc2UKfSk7CnZhciBTQ0hFRFVMRV9JTl9ST09UX1pPTkUgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gInJ1biBjaGFuZ2VzIG91dHNpZGUgem9uZSBpbiByb290IiA6ICIiKTsKdmFyIFBlbmRpbmdUYXNrcyA9IGNsYXNzIF9QZW5kaW5nVGFza3MgewogIGludGVybmFsUGVuZGluZ1Rhc2tzID0gaW5qZWN0MihQZW5kaW5nVGFza3NJbnRlcm5hbCk7CiAgc2NoZWR1bGVyID0gaW5qZWN0MihDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIpOwogIGVycm9ySGFuZGxlciA9IGluamVjdDIoSU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUik7CiAgYWRkKCkgewogICAgY29uc3QgdGFza0lkID0gdGhpcy5pbnRlcm5hbFBlbmRpbmdUYXNrcy5hZGQoKTsKICAgIHJldHVybiAoKSA9PiB7CiAgICAgIGlmICghdGhpcy5pbnRlcm5hbFBlbmRpbmdUYXNrcy5oYXModGFza0lkKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLnNjaGVkdWxlci5ub3RpZnkoMTEpOwogICAgICB0aGlzLmludGVybmFsUGVuZGluZ1Rhc2tzLnJlbW92ZSh0YXNrSWQpOwogICAgfTsKICB9CiAgcnVuKGZuKSB7CiAgICBjb25zdCByZW1vdmVUYXNrID0gdGhpcy5hZGQoKTsKICAgIGZuKCkuY2F0Y2godGhpcy5lcnJvckhhbmRsZXIpLmZpbmFsbHkocmVtb3ZlVGFzayk7CiAgfQogIHN0YXRpYyDJtXByb3YgPSDJtcm1ZGVmaW5lSW5qZWN0YWJsZSh7CiAgICB0b2tlbjogX1BlbmRpbmdUYXNrcywKICAgIHByb3ZpZGVkSW46ICJyb290IiwKICAgIGZhY3Rvcnk6ICgpID0+IG5ldyBfUGVuZGluZ1Rhc2tzKCkKICB9KTsKfTsKdmFyIEVmZmVjdFNjaGVkdWxlciA9IGNsYXNzIF9FZmZlY3RTY2hlZHVsZXIgewogIHN0YXRpYyDJtXByb3YgPSDJtcm1ZGVmaW5lSW5qZWN0YWJsZSh7CiAgICB0b2tlbjogX0VmZmVjdFNjaGVkdWxlciwKICAgIHByb3ZpZGVkSW46ICJyb290IiwKICAgIGZhY3Rvcnk6ICgpID0+IG5ldyBab25lQXdhcmVFZmZlY3RTY2hlZHVsZXIoKQogIH0pOwp9Owp2YXIgWm9uZUF3YXJlRWZmZWN0U2NoZWR1bGVyID0gY2xhc3MgewogIGRpcnR5RWZmZWN0Q291bnQgPSAwOwogIHF1ZXVlcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgYWRkKGhhbmRsZSkgewogICAgdGhpcy5lbnF1ZXVlKGhhbmRsZSk7CiAgICB0aGlzLnNjaGVkdWxlKGhhbmRsZSk7CiAgfQogIHNjaGVkdWxlKGhhbmRsZSkgewogICAgaWYgKCFoYW5kbGUuZGlydHkpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5kaXJ0eUVmZmVjdENvdW50Kys7CiAgfQogIHJlbW92ZShoYW5kbGUpIHsKICAgIGNvbnN0IHpvbmUgPSBoYW5kbGUuem9uZTsKICAgIGNvbnN0IHF1ZXVlMiA9IHRoaXMucXVldWVzLmdldCh6b25lKTsKICAgIGlmICghcXVldWUyLmhhcyhoYW5kbGUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHF1ZXVlMi5kZWxldGUoaGFuZGxlKTsKICAgIGlmIChoYW5kbGUuZGlydHkpIHsKICAgICAgdGhpcy5kaXJ0eUVmZmVjdENvdW50LS07CiAgICB9CiAgfQogIGVucXVldWUoaGFuZGxlKSB7CiAgICBjb25zdCB6b25lID0gaGFuZGxlLnpvbmU7CiAgICBpZiAoIXRoaXMucXVldWVzLmhhcyh6b25lKSkgewogICAgICB0aGlzLnF1ZXVlcy5zZXQoem9uZSwgLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSk7CiAgICB9CiAgICBjb25zdCBxdWV1ZTIgPSB0aGlzLnF1ZXVlcy5nZXQoem9uZSk7CiAgICBpZiAocXVldWUyLmhhcyhoYW5kbGUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHF1ZXVlMi5hZGQoaGFuZGxlKTsKICB9CiAgZmx1c2goKSB7CiAgICB3aGlsZSAodGhpcy5kaXJ0eUVmZmVjdENvdW50ID4gMCkgewogICAgICBsZXQgcmFuT25lRWZmZWN0ID0gZmFsc2U7CiAgICAgIGZvciAoY29uc3QgW3pvbmUsIHF1ZXVlMl0gb2YgdGhpcy5xdWV1ZXMpIHsKICAgICAgICBpZiAoem9uZSA9PT0gbnVsbCkgewogICAgICAgICAgcmFuT25lRWZmZWN0IHx8PSB0aGlzLmZsdXNoUXVldWUocXVldWUyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmFuT25lRWZmZWN0IHx8PSB6b25lLnJ1bigoKSA9PiB0aGlzLmZsdXNoUXVldWUocXVldWUyKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghcmFuT25lRWZmZWN0KSB7CiAgICAgICAgdGhpcy5kaXJ0eUVmZmVjdENvdW50ID0gMDsKICAgICAgfQogICAgfQogIH0KICBmbHVzaFF1ZXVlKHF1ZXVlMikgewogICAgbGV0IHJhbk9uZUVmZmVjdCA9IGZhbHNlOwogICAgZm9yIChjb25zdCBoYW5kbGUgb2YgcXVldWUyKSB7CiAgICAgIGlmICghaGFuZGxlLmRpcnR5KSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgdGhpcy5kaXJ0eUVmZmVjdENvdW50LS07CiAgICAgIHJhbk9uZUVmZmVjdCA9IHRydWU7CiAgICAgIGhhbmRsZS5ydW4oKTsKICAgIH0KICAgIHJldHVybiByYW5PbmVFZmZlY3Q7CiAgfQp9Owp2YXIgRWZmZWN0UmVmSW1wbCA9IGNsYXNzIHsKICBbU0lHTkFMXTsKICBjb25zdHJ1Y3Rvcihub2RlKSB7CiAgICB0aGlzW1NJR05BTF0gPSBub2RlOwogIH0KICBkZXN0cm95KCkgewogICAgdGhpc1tTSUdOQUxdLmRlc3Ryb3koKTsKICB9Cn07CmZ1bmN0aW9uIGVmZmVjdChlZmZlY3RGbiwgb3B0aW9ucykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3RJblJlYWN0aXZlQ29udGV4dChlZmZlY3QsICJDYWxsIGBlZmZlY3RgIG91dHNpZGUgb2YgYSByZWFjdGl2ZSBjb250ZXh0LiBGb3IgZXhhbXBsZSwgc2NoZWR1bGUgdGhlIGVmZmVjdCBpbnNpZGUgdGhlIGNvbXBvbmVudCBjb25zdHJ1Y3Rvci4iKTsKICBpZiAobmdEZXZNb2RlICYmICFvcHRpb25zPy5pbmplY3RvcikgewogICAgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0KGVmZmVjdCk7CiAgfQogIGlmIChuZ0Rldk1vZGUgJiYgb3B0aW9ucz8uYWxsb3dTaWduYWxXcml0ZXMgIT09IHZvaWQgMCkgewogICAgY29uc29sZS53YXJuKGBUaGUgJ2FsbG93U2lnbmFsV3JpdGVzJyBmbGFnIGlzIGRlcHJlY2F0ZWQgYW5kIG5vIGxvbmdlciBpbXBhY3RzIGVmZmVjdCgpICh3cml0ZXMgYXJlIGFsd2F5cyBhbGxvd2VkKWApOwogIH0KICBjb25zdCBpbmplY3RvciA9IG9wdGlvbnM/LmluamVjdG9yID8/IGluamVjdDIoSW5qZWN0b3IpOwogIGxldCBkZXN0cm95UmVmID0gb3B0aW9ucz8ubWFudWFsQ2xlYW51cCAhPT0gdHJ1ZSA/IGluamVjdG9yLmdldChEZXN0cm95UmVmKSA6IG51bGw7CiAgbGV0IG5vZGU7CiAgY29uc3Qgdmlld0NvbnRleHQgPSBpbmplY3Rvci5nZXQoVmlld0NvbnRleHQsIG51bGwsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSk7CiAgY29uc3Qgbm90aWZpZXIgPSBpbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyKTsKICBpZiAodmlld0NvbnRleHQgIT09IG51bGwpIHsKICAgIG5vZGUgPSBjcmVhdGVWaWV3RWZmZWN0KHZpZXdDb250ZXh0LnZpZXcsIG5vdGlmaWVyLCBlZmZlY3RGbik7CiAgICBpZiAoZGVzdHJveVJlZiBpbnN0YW5jZW9mIE5vZGVJbmplY3RvckRlc3Ryb3lSZWYgJiYgZGVzdHJveVJlZi5fbFZpZXcgPT09IHZpZXdDb250ZXh0LnZpZXcpIHsKICAgICAgZGVzdHJveVJlZiA9IG51bGw7CiAgICB9CiAgfSBlbHNlIHsKICAgIG5vZGUgPSBjcmVhdGVSb290RWZmZWN0KGVmZmVjdEZuLCBpbmplY3Rvci5nZXQoRWZmZWN0U2NoZWR1bGVyKSwgbm90aWZpZXIpOwogIH0KICBub2RlLmluamVjdG9yID0gaW5qZWN0b3I7CiAgaWYgKGRlc3Ryb3lSZWYgIT09IG51bGwpIHsKICAgIG5vZGUub25EZXN0cm95Rm5zID0gW2Rlc3Ryb3lSZWYub25EZXN0cm95KCgpID0+IG5vZGUuZGVzdHJveSgpKV07CiAgfQogIGNvbnN0IGVmZmVjdFJlZiA9IG5ldyBFZmZlY3RSZWZJbXBsKG5vZGUpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIG5vZGUuZGVidWdOYW1lID0gb3B0aW9ucz8uZGVidWdOYW1lID8/ICIiOwogICAgY29uc3QgcHJldkluamVjdG9yUHJvZmlsZXJDb250ZXh0ID0gc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQoewogICAgICBpbmplY3RvciwKICAgICAgdG9rZW46IG51bGwKICAgIH0pOwogICAgdHJ5IHsKICAgICAgZW1pdEVmZmVjdENyZWF0ZWRFdmVudChlZmZlY3RSZWYpOwogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQocHJldkluamVjdG9yUHJvZmlsZXJDb250ZXh0KTsKICAgIH0KICB9CiAgcmV0dXJuIGVmZmVjdFJlZjsKfQp2YXIgRUZGRUNUX05PREUgPSAoKCkgPT4gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgQkFTRV9FRkZFQ1RfTk9ERSksIHsKICBjbGVhbnVwRm5zOiB2b2lkIDAsCiAgem9uZTogbnVsbCwKICBvbkRlc3Ryb3lGbnM6IG51bGwsCiAgcnVuKCkgewogICAgaWYgKG5nRGV2TW9kZSAmJiBpc0luTm90aWZpY2F0aW9uUGhhc2UoKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYFNjaGVkdWxlcnMgY2Fubm90IHN5bmNocm9ub3VzbHkgZXhlY3V0ZSB3YXRjaGVzIHdoaWxlIHNjaGVkdWxpbmcuYCk7CiAgICB9CiAgICBjb25zdCBwcmV2UmVmcmVzaGluZ1ZpZXdzID0gc2V0SXNSZWZyZXNoaW5nVmlld3MoZmFsc2UpOwogICAgdHJ5IHsKICAgICAgcnVuRWZmZWN0KHRoaXMpOwogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0SXNSZWZyZXNoaW5nVmlld3MocHJldlJlZnJlc2hpbmdWaWV3cyk7CiAgICB9CiAgfSwKICBjbGVhbnVwKCkgewogICAgaWYgKCF0aGlzLmNsZWFudXBGbnM/Lmxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgIHRyeSB7CiAgICAgIHdoaWxlICh0aGlzLmNsZWFudXBGbnMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5jbGVhbnVwRm5zLnBvcCgpKCk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHRoaXMuY2xlYW51cEZucyA9IFtdOwogICAgICBzZXRBY3RpdmVDb25zdW1lcihwcmV2Q29uc3VtZXIpOwogICAgfQogIH0KfSkpKCk7CnZhciBST09UX0VGRkVDVF9OT0RFID0gKCgpID0+IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIEVGRkVDVF9OT0RFKSwgewogIGNvbnN1bWVyTWFya2VkRGlydHkoKSB7CiAgICB0aGlzLnNjaGVkdWxlci5zY2hlZHVsZSh0aGlzKTsKICAgIHRoaXMubm90aWZpZXIubm90aWZ5KDEyKTsKICB9LAogIGRlc3Ryb3koKSB7CiAgICBjb25zdW1lckRlc3Ryb3kodGhpcyk7CiAgICBpZiAodGhpcy5vbkRlc3Ryb3lGbnMgIT09IG51bGwpIHsKICAgICAgZm9yIChjb25zdCBmbiBvZiB0aGlzLm9uRGVzdHJveUZucykgewogICAgICAgIGZuKCk7CiAgICAgIH0KICAgIH0KICAgIHRoaXMuY2xlYW51cCgpOwogICAgdGhpcy5zY2hlZHVsZXIucmVtb3ZlKHRoaXMpOwogIH0KfSkpKCk7CnZhciBWSUVXX0VGRkVDVF9OT0RFID0gKCgpID0+IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIEVGRkVDVF9OT0RFKSwgewogIGNvbnN1bWVyTWFya2VkRGlydHkoKSB7CiAgICB0aGlzLnZpZXdbRkxBR1NdIHw9IDgxOTI7CiAgICBtYXJrQW5jZXN0b3JzRm9yVHJhdmVyc2FsKHRoaXMudmlldyk7CiAgICB0aGlzLm5vdGlmaWVyLm5vdGlmeSgxMyk7CiAgfSwKICBkZXN0cm95KCkgewogICAgY29uc3VtZXJEZXN0cm95KHRoaXMpOwogICAgaWYgKHRoaXMub25EZXN0cm95Rm5zICE9PSBudWxsKSB7CiAgICAgIGZvciAoY29uc3QgZm4gb2YgdGhpcy5vbkRlc3Ryb3lGbnMpIHsKICAgICAgICBmbigpOwogICAgICB9CiAgICB9CiAgICB0aGlzLmNsZWFudXAoKTsKICAgIHRoaXMudmlld1tFRkZFQ1RTXT8uZGVsZXRlKHRoaXMpOwogIH0KfSkpKCk7CmZ1bmN0aW9uIGNyZWF0ZVZpZXdFZmZlY3Qodmlldywgbm90aWZpZXIsIGZuKSB7CiAgY29uc3Qgbm9kZSA9IE9iamVjdC5jcmVhdGUoVklFV19FRkZFQ1RfTk9ERSk7CiAgbm9kZS52aWV3ID0gdmlldzsKICBub2RlLnpvbmUgPSB0eXBlb2YgWm9uZSAhPT0gInVuZGVmaW5lZCIgPyBab25lLmN1cnJlbnQgOiBudWxsOwogIG5vZGUubm90aWZpZXIgPSBub3RpZmllcjsKICBub2RlLmZuID0gY3JlYXRlRWZmZWN0Rm4obm9kZSwgZm4pOwogIHZpZXdbRUZGRUNUU10gPz89IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgdmlld1tFRkZFQ1RTXS5hZGQobm9kZSk7CiAgbm9kZS5jb25zdW1lck1hcmtlZERpcnR5KG5vZGUpOwogIHJldHVybiBub2RlOwp9CmZ1bmN0aW9uIGNyZWF0ZVJvb3RFZmZlY3QoZm4sIHNjaGVkdWxlciwgbm90aWZpZXIpIHsKICBjb25zdCBub2RlID0gT2JqZWN0LmNyZWF0ZShST09UX0VGRkVDVF9OT0RFKTsKICBub2RlLmZuID0gY3JlYXRlRWZmZWN0Rm4obm9kZSwgZm4pOwogIG5vZGUuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogIG5vZGUubm90aWZpZXIgPSBub3RpZmllcjsKICBub2RlLnpvbmUgPSB0eXBlb2YgWm9uZSAhPT0gInVuZGVmaW5lZCIgPyBab25lLmN1cnJlbnQgOiBudWxsOwogIG5vZGUuc2NoZWR1bGVyLmFkZChub2RlKTsKICBub2RlLm5vdGlmaWVyLm5vdGlmeSgxMik7CiAgcmV0dXJuIG5vZGU7Cn0KZnVuY3Rpb24gY3JlYXRlRWZmZWN0Rm4obm9kZSwgZm4pIHsKICByZXR1cm4gKCkgPT4gewogICAgZm4oKGNsZWFudXBGbikgPT4gKG5vZGUuY2xlYW51cEZucyA/Pz0gW10pLnB1c2goY2xlYW51cEZuKSk7CiAgfTsKfQpmdW5jdGlvbiB1bnRyYWNrZWQyKG5vblJlYWN0aXZlUmVhZHNGbikgewogIHJldHVybiB1bnRyYWNrZWQobm9uUmVhY3RpdmVSZWFkc0ZuKTsKfQoKLy8gbm9kZV9tb2R1bGVzL0Bhbmd1bGFyL2NvcmUvZmVzbTIwMjIvX2F0dHJpYnV0ZS1jaHVuay5tanMKdmFyIEF0dHJpYnV0ZSA9IHsKICBKU0FDVElPTjogImpzYWN0aW9uIgp9OwoKLy8gbm9kZV9tb2R1bGVzL0Bhbmd1bGFyL2NvcmUvZmVzbTIwMjIvX2RlYnVnX25vZGUtY2h1bmsubWpzCmZ1bmN0aW9uIG5vU2lkZUVmZmVjdHMoZm4pIHsKICByZXR1cm4gewogICAgdG9TdHJpbmc6IGZuCiAgfS50b1N0cmluZygpOwp9CnZhciBBTk5PVEFUSU9OUyA9ICJfX2Fubm90YXRpb25zX18iOwp2YXIgUEFSQU1FVEVSUyA9ICJfX3BhcmFtZXRlcnNfXyI7CnZhciBQUk9QX01FVEFEQVRBID0gIl9fcHJvcF9fbWV0YWRhdGFfXyI7CmZ1bmN0aW9uIG1ha2VEZWNvcmF0b3IobmFtZSwgcHJvcHMsIHBhcmVudENsYXNzLCBhZGRpdGlvbmFsUHJvY2Vzc2luZywgdHlwZUZuKSB7CiAgcmV0dXJuIG5vU2lkZUVmZmVjdHMoKCkgPT4gewogICAgY29uc3QgbWV0YUN0b3IgPSBtYWtlTWV0YWRhdGFDdG9yKHByb3BzKTsKICAgIGZ1bmN0aW9uIERlY29yYXRvckZhY3RvcnkoLi4uYXJncykgewogICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIERlY29yYXRvckZhY3RvcnkpIHsKICAgICAgICBtZXRhQ3Rvci5jYWxsKHRoaXMsIC4uLmFyZ3MpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIGNvbnN0IGFubm90YXRpb25JbnN0YW5jZSA9IG5ldyBEZWNvcmF0b3JGYWN0b3J5KC4uLmFyZ3MpOwogICAgICByZXR1cm4gZnVuY3Rpb24gVHlwZURlY29yYXRvcihjbHMpIHsKICAgICAgICBpZiAodHlwZUZuKSB0eXBlRm4oY2xzLCAuLi5hcmdzKTsKICAgICAgICBjb25zdCBhbm5vdGF0aW9ucyA9IGNscy5oYXNPd25Qcm9wZXJ0eShBTk5PVEFUSU9OUykgPyBjbHNbQU5OT1RBVElPTlNdIDogT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscywgQU5OT1RBVElPTlMsIHsKICAgICAgICAgIHZhbHVlOiBbXQogICAgICAgIH0pW0FOTk9UQVRJT05TXTsKICAgICAgICBhbm5vdGF0aW9ucy5wdXNoKGFubm90YXRpb25JbnN0YW5jZSk7CiAgICAgICAgcmV0dXJuIGNsczsKICAgICAgfTsKICAgIH0KICAgIGlmIChwYXJlbnRDbGFzcykgewogICAgICBEZWNvcmF0b3JGYWN0b3J5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocGFyZW50Q2xhc3MucHJvdG90eXBlKTsKICAgIH0KICAgIERlY29yYXRvckZhY3RvcnkucHJvdG90eXBlLm5nTWV0YWRhdGFOYW1lID0gbmFtZTsKICAgIERlY29yYXRvckZhY3RvcnkuYW5ub3RhdGlvbkNscyA9IERlY29yYXRvckZhY3Rvcnk7CiAgICByZXR1cm4gRGVjb3JhdG9yRmFjdG9yeTsKICB9KTsKfQpmdW5jdGlvbiBtYWtlTWV0YWRhdGFDdG9yKHByb3BzKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIGN0b3IoLi4uYXJncykgewogICAgaWYgKHByb3BzKSB7CiAgICAgIGNvbnN0IHZhbHVlcyA9IHByb3BzKC4uLmFyZ3MpOwogICAgICBmb3IgKGNvbnN0IHByb3BOYW1lIGluIHZhbHVlcykgewogICAgICAgIHRoaXNbcHJvcE5hbWVdID0gdmFsdWVzW3Byb3BOYW1lXTsKICAgICAgfQogICAgfQogIH07Cn0KZnVuY3Rpb24gbWFrZVBhcmFtRGVjb3JhdG9yKG5hbWUsIHByb3BzLCBwYXJlbnRDbGFzcykgewogIHJldHVybiBub1NpZGVFZmZlY3RzKCgpID0+IHsKICAgIGNvbnN0IG1ldGFDdG9yID0gbWFrZU1ldGFkYXRhQ3Rvcihwcm9wcyk7CiAgICBmdW5jdGlvbiBQYXJhbURlY29yYXRvckZhY3RvcnkoLi4uYXJncykgewogICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIFBhcmFtRGVjb3JhdG9yRmFjdG9yeSkgewogICAgICAgIG1ldGFDdG9yLmFwcGx5KHRoaXMsIGFyZ3MpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIGNvbnN0IGFubm90YXRpb25JbnN0YW5jZSA9IG5ldyBQYXJhbURlY29yYXRvckZhY3RvcnkoLi4uYXJncyk7CiAgICAgIFBhcmFtRGVjb3JhdG9yLmFubm90YXRpb24gPSBhbm5vdGF0aW9uSW5zdGFuY2U7CiAgICAgIHJldHVybiBQYXJhbURlY29yYXRvcjsKICAgICAgZnVuY3Rpb24gUGFyYW1EZWNvcmF0b3IoY2xzLCB1bnVzZWRLZXksIGluZGV4KSB7CiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IGNscy5oYXNPd25Qcm9wZXJ0eShQQVJBTUVURVJTKSA/IGNsc1tQQVJBTUVURVJTXSA6IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMsIFBBUkFNRVRFUlMsIHsKICAgICAgICAgIHZhbHVlOiBbXQogICAgICAgIH0pW1BBUkFNRVRFUlNdOwogICAgICAgIHdoaWxlIChwYXJhbWV0ZXJzLmxlbmd0aCA8PSBpbmRleCkgewogICAgICAgICAgcGFyYW1ldGVycy5wdXNoKG51bGwpOwogICAgICAgIH0KICAgICAgICAocGFyYW1ldGVyc1tpbmRleF0gPSBwYXJhbWV0ZXJzW2luZGV4XSB8fCBbXSkucHVzaChhbm5vdGF0aW9uSW5zdGFuY2UpOwogICAgICAgIHJldHVybiBjbHM7CiAgICAgIH0KICAgIH0KICAgIFBhcmFtRGVjb3JhdG9yRmFjdG9yeS5wcm90b3R5cGUubmdNZXRhZGF0YU5hbWUgPSBuYW1lOwogICAgUGFyYW1EZWNvcmF0b3JGYWN0b3J5LmFubm90YXRpb25DbHMgPSBQYXJhbURlY29yYXRvckZhY3Rvcnk7CiAgICByZXR1cm4gUGFyYW1EZWNvcmF0b3JGYWN0b3J5OwogIH0pOwp9CmZ1bmN0aW9uIG1ha2VQcm9wRGVjb3JhdG9yKG5hbWUsIHByb3BzLCBwYXJlbnRDbGFzcywgYWRkaXRpb25hbFByb2Nlc3NpbmcpIHsKICByZXR1cm4gbm9TaWRlRWZmZWN0cygoKSA9PiB7CiAgICBjb25zdCBtZXRhQ3RvciA9IG1ha2VNZXRhZGF0YUN0b3IocHJvcHMpOwogICAgZnVuY3Rpb24gUHJvcERlY29yYXRvckZhY3RvcnkoLi4uYXJncykgewogICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIFByb3BEZWNvcmF0b3JGYWN0b3J5KSB7CiAgICAgICAgbWV0YUN0b3IuYXBwbHkodGhpcywgYXJncyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgY29uc3QgZGVjb3JhdG9ySW5zdGFuY2UgPSBuZXcgUHJvcERlY29yYXRvckZhY3RvcnkoLi4uYXJncyk7CiAgICAgIGZ1bmN0aW9uIFByb3BEZWNvcmF0b3IodGFyZ2V0LCBuYW1lMikgewogICAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJTdGFuZGFyZCBBbmd1bGFyIGZpZWxkIGRlY29yYXRvcnMgYXJlIG5vdCBzdXBwb3J0ZWQgaW4gSklUIG1vZGUuIik7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGNvbnN0cnVjdG9yID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwogICAgICAgIGNvbnN0IG1ldGEgPSBjb25zdHJ1Y3Rvci5oYXNPd25Qcm9wZXJ0eShQUk9QX01FVEFEQVRBKSA/IGNvbnN0cnVjdG9yW1BST1BfTUVUQURBVEFdIDogT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvbnN0cnVjdG9yLCBQUk9QX01FVEFEQVRBLCB7CiAgICAgICAgICB2YWx1ZToge30KICAgICAgICB9KVtQUk9QX01FVEFEQVRBXTsKICAgICAgICBtZXRhW25hbWUyXSA9IG1ldGEuaGFzT3duUHJvcGVydHkobmFtZTIpICYmIG1ldGFbbmFtZTJdIHx8IFtdOwogICAgICAgIG1ldGFbbmFtZTJdLnVuc2hpZnQoZGVjb3JhdG9ySW5zdGFuY2UpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9wRGVjb3JhdG9yOwogICAgfQogICAgaWYgKHBhcmVudENsYXNzKSB7CiAgICAgIFByb3BEZWNvcmF0b3JGYWN0b3J5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocGFyZW50Q2xhc3MucHJvdG90eXBlKTsKICAgIH0KICAgIFByb3BEZWNvcmF0b3JGYWN0b3J5LnByb3RvdHlwZS5uZ01ldGFkYXRhTmFtZSA9IG5hbWU7CiAgICBQcm9wRGVjb3JhdG9yRmFjdG9yeS5hbm5vdGF0aW9uQ2xzID0gUHJvcERlY29yYXRvckZhY3Rvcnk7CiAgICByZXR1cm4gUHJvcERlY29yYXRvckZhY3Rvcnk7CiAgfSk7Cn0KdmFyIEluamVjdCA9IGF0dGFjaEluamVjdEZsYWcobWFrZVBhcmFtRGVjb3JhdG9yKCJJbmplY3QiLCAodG9rZW4pID0+ICh7CiAgdG9rZW4KfSkpLCAtMSk7CnZhciBPcHRpb25hbCA9IGF0dGFjaEluamVjdEZsYWcobWFrZVBhcmFtRGVjb3JhdG9yKCJPcHRpb25hbCIpLCA4KTsKdmFyIFNlbGYgPSBhdHRhY2hJbmplY3RGbGFnKG1ha2VQYXJhbURlY29yYXRvcigiU2VsZiIpLCAyKTsKdmFyIFNraXBTZWxmID0gYXR0YWNoSW5qZWN0RmxhZyhtYWtlUGFyYW1EZWNvcmF0b3IoIlNraXBTZWxmIiksIDQpOwp2YXIgSG9zdCA9IGF0dGFjaEluamVjdEZsYWcobWFrZVBhcmFtRGVjb3JhdG9yKCJIb3N0IiksIDEpOwpmdW5jdGlvbiBnZXRDb21waWxlckZhY2FkZShyZXF1ZXN0KSB7CiAgY29uc3QgZ2xvYmFsTmcgPSBfZ2xvYmFsWyJuZyJdOwogIGlmIChnbG9iYWxOZyAmJiBnbG9iYWxOZy7JtWNvbXBpbGVyRmFjYWRlKSB7CiAgICByZXR1cm4gZ2xvYmFsTmcuybVjb21waWxlckZhY2FkZTsKICB9CiAgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgewogICAgY29uc29sZS5lcnJvcihgSklUIGNvbXBpbGF0aW9uIGZhaWxlZCBmb3IgJHtyZXF1ZXN0LmtpbmR9YCwgcmVxdWVzdC50eXBlKTsKICAgIGxldCBtZXNzYWdlID0gYFRoZSAke3JlcXVlc3Qua2luZH0gJyR7cmVxdWVzdC50eXBlLm5hbWV9JyBuZWVkcyB0byBiZSBjb21waWxlZCB1c2luZyB0aGUgSklUIGNvbXBpbGVyLCBidXQgJ0Bhbmd1bGFyL2NvbXBpbGVyJyBpcyBub3QgYXZhaWxhYmxlLgoKYDsKICAgIGlmIChyZXF1ZXN0LnVzYWdlID09PSAxKSB7CiAgICAgIG1lc3NhZ2UgKz0gYFRoZSAke3JlcXVlc3Qua2luZH0gaXMgcGFydCBvZiBhIGxpYnJhcnkgdGhhdCBoYXMgYmVlbiBwYXJ0aWFsbHkgY29tcGlsZWQuCmA7CiAgICAgIG1lc3NhZ2UgKz0gYEhvd2V2ZXIsIHRoZSBBbmd1bGFyIExpbmtlciBoYXMgbm90IHByb2Nlc3NlZCB0aGUgbGlicmFyeSBzdWNoIHRoYXQgSklUIGNvbXBpbGF0aW9uIGlzIHVzZWQgYXMgZmFsbGJhY2suCmA7CiAgICAgIG1lc3NhZ2UgKz0gIlxuIjsKICAgICAgbWVzc2FnZSArPSBgSWRlYWxseSwgdGhlIGxpYnJhcnkgaXMgcHJvY2Vzc2VkIHVzaW5nIHRoZSBBbmd1bGFyIExpbmtlciB0byBiZWNvbWUgZnVsbHkgQU9UIGNvbXBpbGVkLgpgOwogICAgfSBlbHNlIHsKICAgICAgbWVzc2FnZSArPSBgSklUIGNvbXBpbGF0aW9uIGlzIGRpc2NvdXJhZ2VkIGZvciBwcm9kdWN0aW9uIHVzZS1jYXNlcyEgQ29uc2lkZXIgdXNpbmcgQU9UIG1vZGUgaW5zdGVhZC4KYDsKICAgIH0KICAgIG1lc3NhZ2UgKz0gYEFsdGVybmF0aXZlbHksIHRoZSBKSVQgY29tcGlsZXIgc2hvdWxkIGJlIGxvYWRlZCBieSBib290c3RyYXBwaW5nIHVzaW5nICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyLWR5bmFtaWMnIG9yICdAYW5ndWxhci9wbGF0Zm9ybS1zZXJ2ZXInLApgOwogICAgbWVzc2FnZSArPSBgb3IgbWFudWFsbHkgcHJvdmlkZSB0aGUgY29tcGlsZXIgd2l0aCAnaW1wb3J0ICJAYW5ndWxhci9jb21waWxlciI7JyBiZWZvcmUgYm9vdHN0cmFwcGluZy5gOwogICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpOwogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkpJVCBjb21waWxlciB1bmF2YWlsYWJsZSIpOwogIH0KfQp2YXIgYW5ndWxhckNvcmVEaUVudiA9IHsKICAiybXJtWRlZmluZUluamVjdGFibGUiOiDJtcm1ZGVmaW5lSW5qZWN0YWJsZSwKICAiybXJtWRlZmluZUluamVjdG9yIjogybXJtWRlZmluZUluamVjdG9yLAogICLJtcm1aW5qZWN0IjogybXJtWluamVjdCwKICAiybXJtWludmFsaWRGYWN0b3J5RGVwIjogybXJtWludmFsaWRGYWN0b3J5RGVwLAogICJyZXNvbHZlRm9yd2FyZFJlZiI6IHJlc29sdmVGb3J3YXJkUmVmCn07CnZhciBUeXBlID0gRnVuY3Rpb247CmZ1bmN0aW9uIGlzVHlwZSh2KSB7CiAgcmV0dXJuIHR5cGVvZiB2ID09PSAiZnVuY3Rpb24iOwp9CnZhciBFUzVfREVMRUdBVEVfQ1RPUiA9IC9eZnVuY3Rpb25ccytcUytcKFwpXHMqe1tcc1xTXStcLmFwcGx5XCh0aGlzLFxzKihhcmd1bWVudHN8KD86W14oKV0rXChcW1xdLCk/W14oKV0rXChhcmd1bWVudHNcKS4qKVwpLzsKdmFyIEVTMjAxNV9JTkhFUklURURfQ0xBU1MgPSAvXmNsYXNzXHMrW0EtWmEtelxkJF9dKlxzKmV4dGVuZHNccytbXntdK3svOwp2YXIgRVMyMDE1X0lOSEVSSVRFRF9DTEFTU19XSVRIX0NUT1IgPSAvXmNsYXNzXHMrW0EtWmEtelxkJF9dKlxzKmV4dGVuZHNccytbXntdK3tbXHNcU10qY29uc3RydWN0b3JccypcKC87CnZhciBFUzIwMTVfSU5IRVJJVEVEX0NMQVNTX1dJVEhfREVMRUdBVEVfQ1RPUiA9IC9eY2xhc3NccytbQS1aYS16XGQkX10qXHMqZXh0ZW5kc1xzK1tee10re1tcc1xTXSpjb25zdHJ1Y3RvclxzKlwoXClccyp7W159XSpzdXBlclwoXC5cLlwuYXJndW1lbnRzXCkvOwpmdW5jdGlvbiBpc0RlbGVnYXRlQ3Rvcih0eXBlU3RyKSB7CiAgcmV0dXJuIEVTNV9ERUxFR0FURV9DVE9SLnRlc3QodHlwZVN0cikgfHwgRVMyMDE1X0lOSEVSSVRFRF9DTEFTU19XSVRIX0RFTEVHQVRFX0NUT1IudGVzdCh0eXBlU3RyKSB8fCBFUzIwMTVfSU5IRVJJVEVEX0NMQVNTLnRlc3QodHlwZVN0cikgJiYgIUVTMjAxNV9JTkhFUklURURfQ0xBU1NfV0lUSF9DVE9SLnRlc3QodHlwZVN0cik7Cn0KdmFyIFJlZmxlY3Rpb25DYXBhYmlsaXRpZXMgPSBjbGFzcyB7CiAgX3JlZmxlY3Q7CiAgY29uc3RydWN0b3IocmVmbGVjdCkgewogICAgdGhpcy5fcmVmbGVjdCA9IHJlZmxlY3QgfHwgX2dsb2JhbFsiUmVmbGVjdCJdOwogIH0KICBmYWN0b3J5KHQpIHsKICAgIHJldHVybiAoLi4uYXJncykgPT4gbmV3IHQoLi4uYXJncyk7CiAgfQogIF96aXBUeXBlc0FuZEFubm90YXRpb25zKHBhcmFtVHlwZXMsIHBhcmFtQW5ub3RhdGlvbnMpIHsKICAgIGxldCByZXN1bHQ7CiAgICBpZiAodHlwZW9mIHBhcmFtVHlwZXMgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHJlc3VsdCA9IG5ld0FycmF5KHBhcmFtQW5ub3RhdGlvbnMubGVuZ3RoKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdCA9IG5ld0FycmF5KHBhcmFtVHlwZXMubGVuZ3RoKTsKICAgIH0KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICh0eXBlb2YgcGFyYW1UeXBlcyA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXN1bHRbaV0gPSBbXTsKICAgICAgfSBlbHNlIGlmIChwYXJhbVR5cGVzW2ldICYmIHBhcmFtVHlwZXNbaV0gIT0gT2JqZWN0KSB7CiAgICAgICAgcmVzdWx0W2ldID0gW3BhcmFtVHlwZXNbaV1dOwogICAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdFtpXSA9IFtdOwogICAgICB9CiAgICAgIGlmIChwYXJhbUFubm90YXRpb25zICYmIHBhcmFtQW5ub3RhdGlvbnNbaV0gIT0gbnVsbCkgewogICAgICAgIHJlc3VsdFtpXSA9IHJlc3VsdFtpXS5jb25jYXQocGFyYW1Bbm5vdGF0aW9uc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIF9vd25QYXJhbWV0ZXJzKHR5cGUsIHBhcmVudEN0b3IpIHsKICAgIGNvbnN0IHR5cGVTdHIgPSB0eXBlLnRvU3RyaW5nKCk7CiAgICBpZiAoaXNEZWxlZ2F0ZUN0b3IodHlwZVN0cikpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBpZiAodHlwZS5wYXJhbWV0ZXJzICYmIHR5cGUucGFyYW1ldGVycyAhPT0gcGFyZW50Q3Rvci5wYXJhbWV0ZXJzKSB7CiAgICAgIHJldHVybiB0eXBlLnBhcmFtZXRlcnM7CiAgICB9CiAgICBjb25zdCB0c2lja2xlQ3RvclBhcmFtcyA9IHR5cGUuY3RvclBhcmFtZXRlcnM7CiAgICBpZiAodHNpY2tsZUN0b3JQYXJhbXMgJiYgdHNpY2tsZUN0b3JQYXJhbXMgIT09IHBhcmVudEN0b3IuY3RvclBhcmFtZXRlcnMpIHsKICAgICAgY29uc3QgY3RvclBhcmFtZXRlcnMgPSB0eXBlb2YgdHNpY2tsZUN0b3JQYXJhbXMgPT09ICJmdW5jdGlvbiIgPyB0c2lja2xlQ3RvclBhcmFtcygpIDogdHNpY2tsZUN0b3JQYXJhbXM7CiAgICAgIGNvbnN0IHBhcmFtVHlwZXMyID0gY3RvclBhcmFtZXRlcnMubWFwKChjdG9yUGFyYW0pID0+IGN0b3JQYXJhbSAmJiBjdG9yUGFyYW0udHlwZSk7CiAgICAgIGNvbnN0IHBhcmFtQW5ub3RhdGlvbnMyID0gY3RvclBhcmFtZXRlcnMubWFwKChjdG9yUGFyYW0pID0+IGN0b3JQYXJhbSAmJiBjb252ZXJ0VHNpY2tsZURlY29yYXRvckludG9NZXRhZGF0YShjdG9yUGFyYW0uZGVjb3JhdG9ycykpOwogICAgICByZXR1cm4gdGhpcy5femlwVHlwZXNBbmRBbm5vdGF0aW9ucyhwYXJhbVR5cGVzMiwgcGFyYW1Bbm5vdGF0aW9uczIpOwogICAgfQogICAgY29uc3QgcGFyYW1Bbm5vdGF0aW9ucyA9IHR5cGUuaGFzT3duUHJvcGVydHkoUEFSQU1FVEVSUykgJiYgdHlwZVtQQVJBTUVURVJTXTsKICAgIGNvbnN0IHBhcmFtVHlwZXMgPSB0aGlzLl9yZWZsZWN0ICYmIHRoaXMuX3JlZmxlY3QuZ2V0T3duTWV0YWRhdGEgJiYgdGhpcy5fcmVmbGVjdC5nZXRPd25NZXRhZGF0YSgiZGVzaWduOnBhcmFtdHlwZXMiLCB0eXBlKTsKICAgIGlmIChwYXJhbVR5cGVzIHx8IHBhcmFtQW5ub3RhdGlvbnMpIHsKICAgICAgcmV0dXJuIHRoaXMuX3ppcFR5cGVzQW5kQW5ub3RhdGlvbnMocGFyYW1UeXBlcywgcGFyYW1Bbm5vdGF0aW9ucyk7CiAgICB9CiAgICByZXR1cm4gbmV3QXJyYXkodHlwZS5sZW5ndGgpOwogIH0KICBwYXJhbWV0ZXJzKHR5cGUpIHsKICAgIGlmICghaXNUeXBlKHR5cGUpKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIGNvbnN0IHBhcmVudEN0b3IgPSBnZXRQYXJlbnRDdG9yKHR5cGUpOwogICAgbGV0IHBhcmFtZXRlcnMgPSB0aGlzLl9vd25QYXJhbWV0ZXJzKHR5cGUsIHBhcmVudEN0b3IpOwogICAgaWYgKCFwYXJhbWV0ZXJzICYmIHBhcmVudEN0b3IgIT09IE9iamVjdCkgewogICAgICBwYXJhbWV0ZXJzID0gdGhpcy5wYXJhbWV0ZXJzKHBhcmVudEN0b3IpOwogICAgfQogICAgcmV0dXJuIHBhcmFtZXRlcnMgfHwgW107CiAgfQogIF9vd25Bbm5vdGF0aW9ucyh0eXBlT3JGdW5jLCBwYXJlbnRDdG9yKSB7CiAgICBpZiAodHlwZU9yRnVuYy5hbm5vdGF0aW9ucyAmJiB0eXBlT3JGdW5jLmFubm90YXRpb25zICE9PSBwYXJlbnRDdG9yLmFubm90YXRpb25zKSB7CiAgICAgIGxldCBhbm5vdGF0aW9ucyA9IHR5cGVPckZ1bmMuYW5ub3RhdGlvbnM7CiAgICAgIGlmICh0eXBlb2YgYW5ub3RhdGlvbnMgPT09ICJmdW5jdGlvbiIgJiYgYW5ub3RhdGlvbnMuYW5ub3RhdGlvbnMpIHsKICAgICAgICBhbm5vdGF0aW9ucyA9IGFubm90YXRpb25zLmFubm90YXRpb25zOwogICAgICB9CiAgICAgIHJldHVybiBhbm5vdGF0aW9uczsKICAgIH0KICAgIGlmICh0eXBlT3JGdW5jLmRlY29yYXRvcnMgJiYgdHlwZU9yRnVuYy5kZWNvcmF0b3JzICE9PSBwYXJlbnRDdG9yLmRlY29yYXRvcnMpIHsKICAgICAgcmV0dXJuIGNvbnZlcnRUc2lja2xlRGVjb3JhdG9ySW50b01ldGFkYXRhKHR5cGVPckZ1bmMuZGVjb3JhdG9ycyk7CiAgICB9CiAgICBpZiAodHlwZU9yRnVuYy5oYXNPd25Qcm9wZXJ0eShBTk5PVEFUSU9OUykpIHsKICAgICAgcmV0dXJuIHR5cGVPckZ1bmNbQU5OT1RBVElPTlNdOwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfQogIGFubm90YXRpb25zKHR5cGVPckZ1bmMpIHsKICAgIGlmICghaXNUeXBlKHR5cGVPckZ1bmMpKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIGNvbnN0IHBhcmVudEN0b3IgPSBnZXRQYXJlbnRDdG9yKHR5cGVPckZ1bmMpOwogICAgY29uc3Qgb3duQW5ub3RhdGlvbnMgPSB0aGlzLl9vd25Bbm5vdGF0aW9ucyh0eXBlT3JGdW5jLCBwYXJlbnRDdG9yKSB8fCBbXTsKICAgIGNvbnN0IHBhcmVudEFubm90YXRpb25zID0gcGFyZW50Q3RvciAhPT0gT2JqZWN0ID8gdGhpcy5hbm5vdGF0aW9ucyhwYXJlbnRDdG9yKSA6IFtdOwogICAgcmV0dXJuIHBhcmVudEFubm90YXRpb25zLmNvbmNhdChvd25Bbm5vdGF0aW9ucyk7CiAgfQogIF9vd25Qcm9wTWV0YWRhdGEodHlwZU9yRnVuYywgcGFyZW50Q3RvcikgewogICAgaWYgKHR5cGVPckZ1bmMucHJvcE1ldGFkYXRhICYmIHR5cGVPckZ1bmMucHJvcE1ldGFkYXRhICE9PSBwYXJlbnRDdG9yLnByb3BNZXRhZGF0YSkgewogICAgICBsZXQgcHJvcE1ldGFkYXRhID0gdHlwZU9yRnVuYy5wcm9wTWV0YWRhdGE7CiAgICAgIGlmICh0eXBlb2YgcHJvcE1ldGFkYXRhID09PSAiZnVuY3Rpb24iICYmIHByb3BNZXRhZGF0YS5wcm9wTWV0YWRhdGEpIHsKICAgICAgICBwcm9wTWV0YWRhdGEgPSBwcm9wTWV0YWRhdGEucHJvcE1ldGFkYXRhOwogICAgICB9CiAgICAgIHJldHVybiBwcm9wTWV0YWRhdGE7CiAgICB9CiAgICBpZiAodHlwZU9yRnVuYy5wcm9wRGVjb3JhdG9ycyAmJiB0eXBlT3JGdW5jLnByb3BEZWNvcmF0b3JzICE9PSBwYXJlbnRDdG9yLnByb3BEZWNvcmF0b3JzKSB7CiAgICAgIGNvbnN0IHByb3BEZWNvcmF0b3JzID0gdHlwZU9yRnVuYy5wcm9wRGVjb3JhdG9yczsKICAgICAgY29uc3QgcHJvcE1ldGFkYXRhID0ge307CiAgICAgIE9iamVjdC5rZXlzKHByb3BEZWNvcmF0b3JzKS5mb3JFYWNoKChwcm9wKSA9PiB7CiAgICAgICAgcHJvcE1ldGFkYXRhW3Byb3BdID0gY29udmVydFRzaWNrbGVEZWNvcmF0b3JJbnRvTWV0YWRhdGEocHJvcERlY29yYXRvcnNbcHJvcF0pOwogICAgICB9KTsKICAgICAgcmV0dXJuIHByb3BNZXRhZGF0YTsKICAgIH0KICAgIGlmICh0eXBlT3JGdW5jLmhhc093blByb3BlcnR5KFBST1BfTUVUQURBVEEpKSB7CiAgICAgIHJldHVybiB0eXBlT3JGdW5jW1BST1BfTUVUQURBVEFdOwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfQogIHByb3BNZXRhZGF0YSh0eXBlT3JGdW5jKSB7CiAgICBpZiAoIWlzVHlwZSh0eXBlT3JGdW5jKSkgewogICAgICByZXR1cm4ge307CiAgICB9CiAgICBjb25zdCBwYXJlbnRDdG9yID0gZ2V0UGFyZW50Q3Rvcih0eXBlT3JGdW5jKTsKICAgIGNvbnN0IHByb3BNZXRhZGF0YSA9IHt9OwogICAgaWYgKHBhcmVudEN0b3IgIT09IE9iamVjdCkgewogICAgICBjb25zdCBwYXJlbnRQcm9wTWV0YWRhdGEgPSB0aGlzLnByb3BNZXRhZGF0YShwYXJlbnRDdG9yKTsKICAgICAgT2JqZWN0LmtleXMocGFyZW50UHJvcE1ldGFkYXRhKS5mb3JFYWNoKChwcm9wTmFtZSkgPT4gewogICAgICAgIHByb3BNZXRhZGF0YVtwcm9wTmFtZV0gPSBwYXJlbnRQcm9wTWV0YWRhdGFbcHJvcE5hbWVdOwogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IG93blByb3BNZXRhZGF0YSA9IHRoaXMuX293blByb3BNZXRhZGF0YSh0eXBlT3JGdW5jLCBwYXJlbnRDdG9yKTsKICAgIGlmIChvd25Qcm9wTWV0YWRhdGEpIHsKICAgICAgT2JqZWN0LmtleXMob3duUHJvcE1ldGFkYXRhKS5mb3JFYWNoKChwcm9wTmFtZSkgPT4gewogICAgICAgIGNvbnN0IGRlY29yYXRvcnMgPSBbXTsKICAgICAgICBpZiAocHJvcE1ldGFkYXRhLmhhc093blByb3BlcnR5KHByb3BOYW1lKSkgewogICAgICAgICAgZGVjb3JhdG9ycy5wdXNoKC4uLnByb3BNZXRhZGF0YVtwcm9wTmFtZV0pOwogICAgICAgIH0KICAgICAgICBkZWNvcmF0b3JzLnB1c2goLi4ub3duUHJvcE1ldGFkYXRhW3Byb3BOYW1lXSk7CiAgICAgICAgcHJvcE1ldGFkYXRhW3Byb3BOYW1lXSA9IGRlY29yYXRvcnM7CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIHByb3BNZXRhZGF0YTsKICB9CiAgb3duUHJvcE1ldGFkYXRhKHR5cGVPckZ1bmMpIHsKICAgIGlmICghaXNUeXBlKHR5cGVPckZ1bmMpKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0KICAgIHJldHVybiB0aGlzLl9vd25Qcm9wTWV0YWRhdGEodHlwZU9yRnVuYywgZ2V0UGFyZW50Q3Rvcih0eXBlT3JGdW5jKSkgfHwge307CiAgfQogIGhhc0xpZmVjeWNsZUhvb2sodHlwZSwgbGNQcm9wZXJ0eSkgewogICAgcmV0dXJuIHR5cGUgaW5zdGFuY2VvZiBUeXBlICYmIGxjUHJvcGVydHkgaW4gdHlwZS5wcm90b3R5cGU7CiAgfQp9OwpmdW5jdGlvbiBjb252ZXJ0VHNpY2tsZURlY29yYXRvckludG9NZXRhZGF0YShkZWNvcmF0b3JJbnZvY2F0aW9ucykgewogIGlmICghZGVjb3JhdG9ySW52b2NhdGlvbnMpIHsKICAgIHJldHVybiBbXTsKICB9CiAgcmV0dXJuIGRlY29yYXRvckludm9jYXRpb25zLm1hcCgoZGVjb3JhdG9ySW52b2NhdGlvbikgPT4gewogICAgY29uc3QgZGVjb3JhdG9yVHlwZSA9IGRlY29yYXRvckludm9jYXRpb24udHlwZTsKICAgIGNvbnN0IGFubm90YXRpb25DbHMgPSBkZWNvcmF0b3JUeXBlLmFubm90YXRpb25DbHM7CiAgICBjb25zdCBhbm5vdGF0aW9uQXJncyA9IGRlY29yYXRvckludm9jYXRpb24uYXJncyA/IGRlY29yYXRvckludm9jYXRpb24uYXJncyA6IFtdOwogICAgcmV0dXJuIG5ldyBhbm5vdGF0aW9uQ2xzKC4uLmFubm90YXRpb25BcmdzKTsKICB9KTsKfQpmdW5jdGlvbiBnZXRQYXJlbnRDdG9yKGN0b3IpIHsKICBjb25zdCBwYXJlbnRQcm90byA9IGN0b3IucHJvdG90eXBlID8gT2JqZWN0LmdldFByb3RvdHlwZU9mKGN0b3IucHJvdG90eXBlKSA6IG51bGw7CiAgY29uc3QgcGFyZW50Q3RvciA9IHBhcmVudFByb3RvID8gcGFyZW50UHJvdG8uY29uc3RydWN0b3IgOiBudWxsOwogIHJldHVybiBwYXJlbnRDdG9yIHx8IE9iamVjdDsKfQpmdW5jdGlvbiBhcHBseVZhbHVlVG9JbnB1dEZpZWxkKGluc3RhbmNlLCBpbnB1dFNpZ25hbE5vZGUsIHByaXZhdGVOYW1lLCB2YWx1ZSkgewogIGlmIChpbnB1dFNpZ25hbE5vZGUgIT09IG51bGwpIHsKICAgIGlucHV0U2lnbmFsTm9kZS5hcHBseVZhbHVlVG9JbnB1dFNpZ25hbChpbnB1dFNpZ25hbE5vZGUsIHZhbHVlKTsKICB9IGVsc2UgewogICAgaW5zdGFuY2VbcHJpdmF0ZU5hbWVdID0gdmFsdWU7CiAgfQp9CnZhciBTaW1wbGVDaGFuZ2UgPSBjbGFzcyB7CiAgcHJldmlvdXNWYWx1ZTsKICBjdXJyZW50VmFsdWU7CiAgZmlyc3RDaGFuZ2U7CiAgY29uc3RydWN0b3IocHJldmlvdXNWYWx1ZSwgY3VycmVudFZhbHVlLCBmaXJzdENoYW5nZSkgewogICAgdGhpcy5wcmV2aW91c1ZhbHVlID0gcHJldmlvdXNWYWx1ZTsKICAgIHRoaXMuY3VycmVudFZhbHVlID0gY3VycmVudFZhbHVlOwogICAgdGhpcy5maXJzdENoYW5nZSA9IGZpcnN0Q2hhbmdlOwogIH0KICBpc0ZpcnN0Q2hhbmdlKCkgewogICAgcmV0dXJuIHRoaXMuZmlyc3RDaGFuZ2U7CiAgfQp9Owp2YXIgybXJtU5nT25DaGFuZ2VzRmVhdHVyZSA9ICgoKSA9PiB7CiAgY29uc3QgybXJtU5nT25DaGFuZ2VzRmVhdHVyZUltcGwgPSAoKSA9PiBOZ09uQ2hhbmdlc0ZlYXR1cmVJbXBsOwogIMm1ybVOZ09uQ2hhbmdlc0ZlYXR1cmVJbXBsLm5nSW5oZXJpdCA9IHRydWU7CiAgcmV0dXJuIMm1ybVOZ09uQ2hhbmdlc0ZlYXR1cmVJbXBsOwp9KSgpOwpmdW5jdGlvbiBOZ09uQ2hhbmdlc0ZlYXR1cmVJbXBsKGRlZmluaXRpb24pIHsKICBpZiAoZGVmaW5pdGlvbi50eXBlLnByb3RvdHlwZS5uZ09uQ2hhbmdlcykgewogICAgZGVmaW5pdGlvbi5zZXRJbnB1dCA9IG5nT25DaGFuZ2VzU2V0SW5wdXQ7CiAgfQogIHJldHVybiByZW1lbWJlckNoYW5nZUhpc3RvcnlBbmRJbnZva2VPbkNoYW5nZXNIb29rOwp9CmZ1bmN0aW9uIHJlbWVtYmVyQ2hhbmdlSGlzdG9yeUFuZEludm9rZU9uQ2hhbmdlc0hvb2soKSB7CiAgY29uc3Qgc2ltcGxlQ2hhbmdlc1N0b3JlID0gZ2V0U2ltcGxlQ2hhbmdlc1N0b3JlKHRoaXMpOwogIGNvbnN0IGN1cnJlbnQgPSBzaW1wbGVDaGFuZ2VzU3RvcmU/LmN1cnJlbnQ7CiAgaWYgKGN1cnJlbnQpIHsKICAgIGNvbnN0IHByZXZpb3VzID0gc2ltcGxlQ2hhbmdlc1N0b3JlLnByZXZpb3VzOwogICAgaWYgKHByZXZpb3VzID09PSBFTVBUWV9PQkopIHsKICAgICAgc2ltcGxlQ2hhbmdlc1N0b3JlLnByZXZpb3VzID0gY3VycmVudDsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAobGV0IGtleSBpbiBjdXJyZW50KSB7CiAgICAgICAgcHJldmlvdXNba2V5XSA9IGN1cnJlbnRba2V5XTsKICAgICAgfQogICAgfQogICAgc2ltcGxlQ2hhbmdlc1N0b3JlLmN1cnJlbnQgPSBudWxsOwogICAgdGhpcy5uZ09uQ2hhbmdlcyhjdXJyZW50KTsKICB9Cn0KZnVuY3Rpb24gbmdPbkNoYW5nZXNTZXRJbnB1dChpbnN0YW5jZSwgaW5wdXRTaWduYWxOb2RlLCB2YWx1ZSwgcHVibGljTmFtZSwgcHJpdmF0ZU5hbWUpIHsKICBjb25zdCBkZWNsYXJlZE5hbWUgPSB0aGlzLmRlY2xhcmVkSW5wdXRzW3B1YmxpY05hbWVdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRTdHJpbmcoZGVjbGFyZWROYW1lLCAiTmFtZSBvZiBpbnB1dCBpbiBuZ09uQ2hhbmdlcyBoYXMgdG8gYmUgYSBzdHJpbmciKTsKICBjb25zdCBzaW1wbGVDaGFuZ2VzU3RvcmUgPSBnZXRTaW1wbGVDaGFuZ2VzU3RvcmUoaW5zdGFuY2UpIHx8IHNldFNpbXBsZUNoYW5nZXNTdG9yZShpbnN0YW5jZSwgewogICAgcHJldmlvdXM6IEVNUFRZX09CSiwKICAgIGN1cnJlbnQ6IG51bGwKICB9KTsKICBjb25zdCBjdXJyZW50ID0gc2ltcGxlQ2hhbmdlc1N0b3JlLmN1cnJlbnQgfHwgKHNpbXBsZUNoYW5nZXNTdG9yZS5jdXJyZW50ID0ge30pOwogIGNvbnN0IHByZXZpb3VzID0gc2ltcGxlQ2hhbmdlc1N0b3JlLnByZXZpb3VzOwogIGNvbnN0IHByZXZpb3VzQ2hhbmdlID0gcHJldmlvdXNbZGVjbGFyZWROYW1lXTsKICBjdXJyZW50W2RlY2xhcmVkTmFtZV0gPSBuZXcgU2ltcGxlQ2hhbmdlKHByZXZpb3VzQ2hhbmdlICYmIHByZXZpb3VzQ2hhbmdlLmN1cnJlbnRWYWx1ZSwgdmFsdWUsIHByZXZpb3VzID09PSBFTVBUWV9PQkopOwogIGFwcGx5VmFsdWVUb0lucHV0RmllbGQoaW5zdGFuY2UsIGlucHV0U2lnbmFsTm9kZSwgcHJpdmF0ZU5hbWUsIHZhbHVlKTsKfQp2YXIgU0lNUExFX0NIQU5HRVNfU1RPUkUgPSAiX19uZ1NpbXBsZUNoYW5nZXNfXyI7CmZ1bmN0aW9uIGdldFNpbXBsZUNoYW5nZXNTdG9yZShpbnN0YW5jZSkgewogIHJldHVybiBpbnN0YW5jZVtTSU1QTEVfQ0hBTkdFU19TVE9SRV0gfHwgbnVsbDsKfQpmdW5jdGlvbiBzZXRTaW1wbGVDaGFuZ2VzU3RvcmUoaW5zdGFuY2UsIHN0b3JlMikgewogIHJldHVybiBpbnN0YW5jZVtTSU1QTEVfQ0hBTkdFU19TVE9SRV0gPSBzdG9yZTI7Cn0KdmFyIHByb2ZpbGVyQ2FsbGJhY2tzID0gW107CnZhciBOT09QX1BST0ZJTEVSX1JFTU9WQUwyID0gKCkgPT4gewp9OwpmdW5jdGlvbiByZW1vdmVQcm9maWxlcjIocHJvZmlsZXIyKSB7CiAgY29uc3QgcHJvZmlsZXJJZHggPSBwcm9maWxlckNhbGxiYWNrcy5pbmRleE9mKHByb2ZpbGVyMik7CiAgaWYgKHByb2ZpbGVySWR4ICE9PSAtMSkgewogICAgcHJvZmlsZXJDYWxsYmFja3Muc3BsaWNlKHByb2ZpbGVySWR4LCAxKTsKICB9Cn0KZnVuY3Rpb24gc2V0UHJvZmlsZXIocHJvZmlsZXIyKSB7CiAgaWYgKHByb2ZpbGVyMiAhPT0gbnVsbCkgewogICAgaWYgKCFwcm9maWxlckNhbGxiYWNrcy5pbmNsdWRlcyhwcm9maWxlcjIpKSB7CiAgICAgIHByb2ZpbGVyQ2FsbGJhY2tzLnB1c2gocHJvZmlsZXIyKTsKICAgIH0KICAgIHJldHVybiAoKSA9PiByZW1vdmVQcm9maWxlcjIocHJvZmlsZXIyKTsKICB9IGVsc2UgewogICAgcHJvZmlsZXJDYWxsYmFja3MubGVuZ3RoID0gMDsKICAgIHJldHVybiBOT09QX1BST0ZJTEVSX1JFTU9WQUwyOwogIH0KfQp2YXIgcHJvZmlsZXIgPSBmdW5jdGlvbihldmVudCwgaW5zdGFuY2UgPSBudWxsLCBldmVudEZuKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9maWxlckNhbGxiYWNrcy5sZW5ndGg7IGkrKykgewogICAgY29uc3QgcHJvZmlsZXJDYWxsYmFjayA9IHByb2ZpbGVyQ2FsbGJhY2tzW2ldOwogICAgcHJvZmlsZXJDYWxsYmFjayhldmVudCwgaW5zdGFuY2UsIGV2ZW50Rm4pOwogIH0KfTsKdmFyIFByb2ZpbGVyRXZlbnQ7CihmdW5jdGlvbihQcm9maWxlckV2ZW50MikgewogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJUZW1wbGF0ZUNyZWF0ZVN0YXJ0Il0gPSAwXSA9ICJUZW1wbGF0ZUNyZWF0ZVN0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiVGVtcGxhdGVDcmVhdGVFbmQiXSA9IDFdID0gIlRlbXBsYXRlQ3JlYXRlRW5kIjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiVGVtcGxhdGVVcGRhdGVTdGFydCJdID0gMl0gPSAiVGVtcGxhdGVVcGRhdGVTdGFydCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIlRlbXBsYXRlVXBkYXRlRW5kIl0gPSAzXSA9ICJUZW1wbGF0ZVVwZGF0ZUVuZCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIkxpZmVjeWNsZUhvb2tTdGFydCJdID0gNF0gPSAiTGlmZWN5Y2xlSG9va1N0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiTGlmZWN5Y2xlSG9va0VuZCJdID0gNV0gPSAiTGlmZWN5Y2xlSG9va0VuZCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIk91dHB1dFN0YXJ0Il0gPSA2XSA9ICJPdXRwdXRTdGFydCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIk91dHB1dEVuZCJdID0gN10gPSAiT3V0cHV0RW5kIjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiQm9vdHN0cmFwQXBwbGljYXRpb25TdGFydCJdID0gOF0gPSAiQm9vdHN0cmFwQXBwbGljYXRpb25TdGFydCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIkJvb3RzdHJhcEFwcGxpY2F0aW9uRW5kIl0gPSA5XSA9ICJCb290c3RyYXBBcHBsaWNhdGlvbkVuZCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIkJvb3RzdHJhcENvbXBvbmVudFN0YXJ0Il0gPSAxMF0gPSAiQm9vdHN0cmFwQ29tcG9uZW50U3RhcnQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJCb290c3RyYXBDb21wb25lbnRFbmQiXSA9IDExXSA9ICJCb290c3RyYXBDb21wb25lbnRFbmQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJDaGFuZ2VEZXRlY3Rpb25TdGFydCJdID0gMTJdID0gIkNoYW5nZURldGVjdGlvblN0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiQ2hhbmdlRGV0ZWN0aW9uRW5kIl0gPSAxM10gPSAiQ2hhbmdlRGV0ZWN0aW9uRW5kIjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiQ2hhbmdlRGV0ZWN0aW9uU3luY1N0YXJ0Il0gPSAxNF0gPSAiQ2hhbmdlRGV0ZWN0aW9uU3luY1N0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiQ2hhbmdlRGV0ZWN0aW9uU3luY0VuZCJdID0gMTVdID0gIkNoYW5nZURldGVjdGlvblN5bmNFbmQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJBZnRlclJlbmRlckhvb2tzU3RhcnQiXSA9IDE2XSA9ICJBZnRlclJlbmRlckhvb2tzU3RhcnQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJBZnRlclJlbmRlckhvb2tzRW5kIl0gPSAxN10gPSAiQWZ0ZXJSZW5kZXJIb29rc0VuZCI7CiAgUHJvZmlsZXJFdmVudDJbUHJvZmlsZXJFdmVudDJbIkNvbXBvbmVudFN0YXJ0Il0gPSAxOF0gPSAiQ29tcG9uZW50U3RhcnQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJDb21wb25lbnRFbmQiXSA9IDE5XSA9ICJDb21wb25lbnRFbmQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJEZWZlckJsb2NrU3RhdGVTdGFydCJdID0gMjBdID0gIkRlZmVyQmxvY2tTdGF0ZVN0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiRGVmZXJCbG9ja1N0YXRlRW5kIl0gPSAyMV0gPSAiRGVmZXJCbG9ja1N0YXRlRW5kIjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiRHluYW1pY0NvbXBvbmVudFN0YXJ0Il0gPSAyMl0gPSAiRHluYW1pY0NvbXBvbmVudFN0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiRHluYW1pY0NvbXBvbmVudEVuZCJdID0gMjNdID0gIkR5bmFtaWNDb21wb25lbnRFbmQiOwogIFByb2ZpbGVyRXZlbnQyW1Byb2ZpbGVyRXZlbnQyWyJIb3N0QmluZGluZ3NVcGRhdGVTdGFydCJdID0gMjRdID0gIkhvc3RCaW5kaW5nc1VwZGF0ZVN0YXJ0IjsKICBQcm9maWxlckV2ZW50MltQcm9maWxlckV2ZW50MlsiSG9zdEJpbmRpbmdzVXBkYXRlRW5kIl0gPSAyNV0gPSAiSG9zdEJpbmRpbmdzVXBkYXRlRW5kIjsKfSkoUHJvZmlsZXJFdmVudCB8fCAoUHJvZmlsZXJFdmVudCA9IHt9KSk7CmZ1bmN0aW9uIHJlZ2lzdGVyUHJlT3JkZXJIb29rcyhkaXJlY3RpdmVJbmRleCwgZGlyZWN0aXZlRGVmLCB0VmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIGNvbnN0IHsKICAgIG5nT25DaGFuZ2VzLAogICAgbmdPbkluaXQsCiAgICBuZ0RvQ2hlY2sKICB9ID0gZGlyZWN0aXZlRGVmLnR5cGUucHJvdG90eXBlOwogIGlmIChuZ09uQ2hhbmdlcykgewogICAgY29uc3Qgd3JhcHBlZE9uQ2hhbmdlcyA9IE5nT25DaGFuZ2VzRmVhdHVyZUltcGwoZGlyZWN0aXZlRGVmKTsKICAgICh0Vmlldy5wcmVPcmRlckhvb2tzID8/PSBbXSkucHVzaChkaXJlY3RpdmVJbmRleCwgd3JhcHBlZE9uQ2hhbmdlcyk7CiAgICAodFZpZXcucHJlT3JkZXJDaGVja0hvb2tzID8/PSBbXSkucHVzaChkaXJlY3RpdmVJbmRleCwgd3JhcHBlZE9uQ2hhbmdlcyk7CiAgfQogIGlmIChuZ09uSW5pdCkgewogICAgKHRWaWV3LnByZU9yZGVySG9va3MgPz89IFtdKS5wdXNoKDAgLSBkaXJlY3RpdmVJbmRleCwgbmdPbkluaXQpOwogIH0KICBpZiAobmdEb0NoZWNrKSB7CiAgICAodFZpZXcucHJlT3JkZXJIb29rcyA/Pz0gW10pLnB1c2goZGlyZWN0aXZlSW5kZXgsIG5nRG9DaGVjayk7CiAgICAodFZpZXcucHJlT3JkZXJDaGVja0hvb2tzID8/PSBbXSkucHVzaChkaXJlY3RpdmVJbmRleCwgbmdEb0NoZWNrKTsKICB9Cn0KZnVuY3Rpb24gcmVnaXN0ZXJQb3N0T3JkZXJIb29rcyh0VmlldywgdE5vZGUpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Rmlyc3RDcmVhdGVQYXNzKHRWaWV3KTsKICBmb3IgKGxldCBpID0gdE5vZGUuZGlyZWN0aXZlU3RhcnQsIGVuZCA9IHROb2RlLmRpcmVjdGl2ZUVuZDsgaSA8IGVuZDsgaSsrKSB7CiAgICBjb25zdCBkaXJlY3RpdmVEZWYgPSB0Vmlldy5kYXRhW2ldOwogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoZGlyZWN0aXZlRGVmLCAiRXhwZWN0aW5nIERpcmVjdGl2ZURlZiIpOwogICAgY29uc3QgbGlmZWN5Y2xlSG9va3MgPSBkaXJlY3RpdmVEZWYudHlwZS5wcm90b3R5cGU7CiAgICBjb25zdCB7CiAgICAgIG5nQWZ0ZXJDb250ZW50SW5pdCwKICAgICAgbmdBZnRlckNvbnRlbnRDaGVja2VkLAogICAgICBuZ0FmdGVyVmlld0luaXQsCiAgICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCwKICAgICAgbmdPbkRlc3Ryb3kKICAgIH0gPSBsaWZlY3ljbGVIb29rczsKICAgIGlmIChuZ0FmdGVyQ29udGVudEluaXQpIHsKICAgICAgKHRWaWV3LmNvbnRlbnRIb29rcyA/Pz0gW10pLnB1c2goLWksIG5nQWZ0ZXJDb250ZW50SW5pdCk7CiAgICB9CiAgICBpZiAobmdBZnRlckNvbnRlbnRDaGVja2VkKSB7CiAgICAgICh0Vmlldy5jb250ZW50SG9va3MgPz89IFtdKS5wdXNoKGksIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCk7CiAgICAgICh0Vmlldy5jb250ZW50Q2hlY2tIb29rcyA/Pz0gW10pLnB1c2goaSwgbmdBZnRlckNvbnRlbnRDaGVja2VkKTsKICAgIH0KICAgIGlmIChuZ0FmdGVyVmlld0luaXQpIHsKICAgICAgKHRWaWV3LnZpZXdIb29rcyA/Pz0gW10pLnB1c2goLWksIG5nQWZ0ZXJWaWV3SW5pdCk7CiAgICB9CiAgICBpZiAobmdBZnRlclZpZXdDaGVja2VkKSB7CiAgICAgICh0Vmlldy52aWV3SG9va3MgPz89IFtdKS5wdXNoKGksIG5nQWZ0ZXJWaWV3Q2hlY2tlZCk7CiAgICAgICh0Vmlldy52aWV3Q2hlY2tIb29rcyA/Pz0gW10pLnB1c2goaSwgbmdBZnRlclZpZXdDaGVja2VkKTsKICAgIH0KICAgIGlmIChuZ09uRGVzdHJveSAhPSBudWxsKSB7CiAgICAgICh0Vmlldy5kZXN0cm95SG9va3MgPz89IFtdKS5wdXNoKGksIG5nT25EZXN0cm95KTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gZXhlY3V0ZUNoZWNrSG9va3MobFZpZXcsIGhvb2tzLCBub2RlSW5kZXgpIHsKICBjYWxsSG9va3MobFZpZXcsIGhvb2tzLCAzLCBub2RlSW5kZXgpOwp9CmZ1bmN0aW9uIGV4ZWN1dGVJbml0QW5kQ2hlY2tIb29rcyhsVmlldywgaG9va3MsIGluaXRQaGFzZSwgbm9kZUluZGV4KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdEVxdWFsKGluaXRQaGFzZSwgMywgIkluaXQgcHJlLW9yZGVyIGhvb2tzIHNob3VsZCBub3QgYmUgY2FsbGVkIG1vcmUgdGhhbiBvbmNlIik7CiAgaWYgKChsVmlld1tGTEFHU10gJiAzKSA9PT0gaW5pdFBoYXNlKSB7CiAgICBjYWxsSG9va3MobFZpZXcsIGhvb2tzLCBpbml0UGhhc2UsIG5vZGVJbmRleCk7CiAgfQp9CmZ1bmN0aW9uIGluY3JlbWVudEluaXRQaGFzZUZsYWdzKGxWaWV3LCBpbml0UGhhc2UpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90RXF1YWwoaW5pdFBoYXNlLCAzLCAiSW5pdCBob29rcyBwaGFzZSBzaG91bGQgbm90IGJlIGluY3JlbWVudGVkIGFmdGVyIGFsbCBpbml0IGhvb2tzIGhhdmUgYmVlbiBydW4uIik7CiAgbGV0IGZsYWdzID0gbFZpZXdbRkxBR1NdOwogIGlmICgoZmxhZ3MgJiAzKSA9PT0gaW5pdFBoYXNlKSB7CiAgICBmbGFncyAmPSAxNjM4MzsKICAgIGZsYWdzICs9IDE7CiAgICBsVmlld1tGTEFHU10gPSBmbGFnczsKICB9Cn0KZnVuY3Rpb24gY2FsbEhvb2tzKGN1cnJlbnRWaWV3LCBhcnIsIGluaXRQaGFzZSwgY3VycmVudE5vZGVJbmRleCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChpc0luQ2hlY2tOb0NoYW5nZXNNb2RlKCksIGZhbHNlLCAiSG9va3Mgc2hvdWxkIG5ldmVyIGJlIHJ1biB3aGVuIGluIGNoZWNrIG5vIGNoYW5nZXMgbW9kZS4iKTsKICBjb25zdCBzdGFydEluZGV4ID0gY3VycmVudE5vZGVJbmRleCAhPT0gdm9pZCAwID8gY3VycmVudFZpZXdbUFJFT1JERVJfSE9PS19GTEFHU10gJiA2NTUzNSA6IDA7CiAgY29uc3Qgbm9kZUluZGV4TGltaXQgPSBjdXJyZW50Tm9kZUluZGV4ICE9IG51bGwgPyBjdXJyZW50Tm9kZUluZGV4IDogLTE7CiAgY29uc3QgbWF4MiA9IGFyci5sZW5ndGggLSAxOwogIGxldCBsYXN0Tm9kZUluZGV4Rm91bmQgPSAwOwogIGZvciAobGV0IGkgPSBzdGFydEluZGV4OyBpIDwgbWF4MjsgaSsrKSB7CiAgICBjb25zdCBob29rID0gYXJyW2kgKyAxXTsKICAgIGlmICh0eXBlb2YgaG9vayA9PT0gIm51bWJlciIpIHsKICAgICAgbGFzdE5vZGVJbmRleEZvdW5kID0gYXJyW2ldOwogICAgICBpZiAoY3VycmVudE5vZGVJbmRleCAhPSBudWxsICYmIGxhc3ROb2RlSW5kZXhGb3VuZCA+PSBjdXJyZW50Tm9kZUluZGV4KSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGlzSW5pdEhvb2sgPSBhcnJbaV0gPCAwOwogICAgICBpZiAoaXNJbml0SG9vaykgewogICAgICAgIGN1cnJlbnRWaWV3W1BSRU9SREVSX0hPT0tfRkxBR1NdICs9IDY1NTM2OwogICAgICB9CiAgICAgIGlmIChsYXN0Tm9kZUluZGV4Rm91bmQgPCBub2RlSW5kZXhMaW1pdCB8fCBub2RlSW5kZXhMaW1pdCA9PSAtMSkgewogICAgICAgIGNhbGxIb29rKGN1cnJlbnRWaWV3LCBpbml0UGhhc2UsIGFyciwgaSk7CiAgICAgICAgY3VycmVudFZpZXdbUFJFT1JERVJfSE9PS19GTEFHU10gPSAoY3VycmVudFZpZXdbUFJFT1JERVJfSE9PS19GTEFHU10gJiA0Mjk0OTAxNzYwKSArIGkgKyAyOwogICAgICB9CiAgICAgIGkrKzsKICAgIH0KICB9Cn0KZnVuY3Rpb24gY2FsbEhvb2tJbnRlcm5hbChkaXJlY3RpdmUsIGhvb2spIHsKICBwcm9maWxlcihQcm9maWxlckV2ZW50LkxpZmVjeWNsZUhvb2tTdGFydCwgZGlyZWN0aXZlLCBob29rKTsKICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICB0cnkgewogICAgaG9vay5jYWxsKGRpcmVjdGl2ZSk7CiAgfSBmaW5hbGx5IHsKICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICBwcm9maWxlcihQcm9maWxlckV2ZW50LkxpZmVjeWNsZUhvb2tFbmQsIGRpcmVjdGl2ZSwgaG9vayk7CiAgfQp9CmZ1bmN0aW9uIGNhbGxIb29rKGN1cnJlbnRWaWV3LCBpbml0UGhhc2UsIGFyciwgaSkgewogIGNvbnN0IGlzSW5pdEhvb2sgPSBhcnJbaV0gPCAwOwogIGNvbnN0IGhvb2sgPSBhcnJbaSArIDFdOwogIGNvbnN0IGRpcmVjdGl2ZUluZGV4ID0gaXNJbml0SG9vayA/IC1hcnJbaV0gOiBhcnJbaV07CiAgY29uc3QgZGlyZWN0aXZlID0gY3VycmVudFZpZXdbZGlyZWN0aXZlSW5kZXhdOwogIGlmIChpc0luaXRIb29rKSB7CiAgICBjb25zdCBpbmRleFdpdGhpbnRJbml0UGhhc2UgPSBjdXJyZW50Vmlld1tGTEFHU10gPj4gMTQ7CiAgICBpZiAoaW5kZXhXaXRoaW50SW5pdFBoYXNlIDwgY3VycmVudFZpZXdbUFJFT1JERVJfSE9PS19GTEFHU10gPj4gMTYgJiYgKGN1cnJlbnRWaWV3W0ZMQUdTXSAmIDMpID09PSBpbml0UGhhc2UpIHsKICAgICAgY3VycmVudFZpZXdbRkxBR1NdICs9IDE2Mzg0OwogICAgICBjYWxsSG9va0ludGVybmFsKGRpcmVjdGl2ZSwgaG9vayk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGNhbGxIb29rSW50ZXJuYWwoZGlyZWN0aXZlLCBob29rKTsKICB9Cn0KdmFyIE5PX1BBUkVOVF9JTkpFQ1RPUiA9IC0xOwp2YXIgTm9kZUluamVjdG9yRmFjdG9yeSA9IGNsYXNzIHsKICBmYWN0b3J5OwogIG5hbWU7CiAgaW5qZWN0SW1wbDsKICByZXNvbHZpbmcgPSBmYWxzZTsKICBjYW5TZWVWaWV3UHJvdmlkZXJzOwogIG11bHRpOwogIGNvbXBvbmVudFByb3ZpZGVyczsKICBpbmRleDsKICBwcm92aWRlckZhY3Rvcnk7CiAgY29uc3RydWN0b3IoZmFjdG9yeSwgaXNWaWV3UHJvdmlkZXIsIGluamVjdEltcGxlbWVudGF0aW9uLCBuYW1lKSB7CiAgICB0aGlzLmZhY3RvcnkgPSBmYWN0b3J5OwogICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGZhY3RvcnksICJGYWN0b3J5IG5vdCBzcGVjaWZpZWQiKTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbCh0eXBlb2YgZmFjdG9yeSwgImZ1bmN0aW9uIiwgIkV4cGVjdGVkIGZhY3RvcnkgZnVuY3Rpb24uIik7CiAgICB0aGlzLmNhblNlZVZpZXdQcm92aWRlcnMgPSBpc1ZpZXdQcm92aWRlcjsKICAgIHRoaXMuaW5qZWN0SW1wbCA9IGluamVjdEltcGxlbWVudGF0aW9uOwogIH0KfTsKZnVuY3Rpb24gdG9UTm9kZVR5cGVBc1N0cmluZyh0Tm9kZVR5cGUpIHsKICBsZXQgdGV4dCA9ICIiOwogIHROb2RlVHlwZSAmIDEgJiYgKHRleHQgKz0gInxUZXh0Iik7CiAgdE5vZGVUeXBlICYgMiAmJiAodGV4dCArPSAifEVsZW1lbnQiKTsKICB0Tm9kZVR5cGUgJiA0ICYmICh0ZXh0ICs9ICJ8Q29udGFpbmVyIik7CiAgdE5vZGVUeXBlICYgOCAmJiAodGV4dCArPSAifEVsZW1lbnRDb250YWluZXIiKTsKICB0Tm9kZVR5cGUgJiAxNiAmJiAodGV4dCArPSAifFByb2plY3Rpb24iKTsKICB0Tm9kZVR5cGUgJiAzMiAmJiAodGV4dCArPSAifEljdUNvbnRhaW5lciIpOwogIHROb2RlVHlwZSAmIDY0ICYmICh0ZXh0ICs9ICJ8UGxhY2Vob2xkZXIiKTsKICB0Tm9kZVR5cGUgJiAxMjggJiYgKHRleHQgKz0gInxMZXREZWNsYXJhdGlvbiIpOwogIHJldHVybiB0ZXh0Lmxlbmd0aCA+IDAgPyB0ZXh0LnN1YnN0cmluZygxKSA6IHRleHQ7Cn0KZnVuY3Rpb24gaXNUTm9kZVNoYXBlKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSAib2JqZWN0IiAmJiAodmFsdWUuaW5zZXJ0QmVmb3JlSW5kZXggPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlLmluc2VydEJlZm9yZUluZGV4ID09PSAibnVtYmVyIiB8fCBBcnJheS5pc0FycmF5KHZhbHVlLmluc2VydEJlZm9yZUluZGV4KSk7Cn0KZnVuY3Rpb24gaXNMZXREZWNsYXJhdGlvbih0Tm9kZSkgewogIHJldHVybiAhISh0Tm9kZS50eXBlICYgMTI4KTsKfQpmdW5jdGlvbiBoYXNDbGFzc0lucHV0KHROb2RlKSB7CiAgcmV0dXJuICh0Tm9kZS5mbGFncyAmIDgpICE9PSAwOwp9CmZ1bmN0aW9uIGhhc1N0eWxlSW5wdXQodE5vZGUpIHsKICByZXR1cm4gKHROb2RlLmZsYWdzICYgMTYpICE9PSAwOwp9CmZ1bmN0aW9uIGFzc2VydFROb2RlVHlwZSh0Tm9kZSwgZXhwZWN0ZWRUeXBlcywgbWVzc2FnZSkgewogIGFzc2VydERlZmluZWQodE5vZGUsICJzaG91bGQgYmUgY2FsbGVkIHdpdGggYSBUTm9kZSIpOwogIGlmICgodE5vZGUudHlwZSAmIGV4cGVjdGVkVHlwZXMpID09PSAwKSB7CiAgICB0aHJvd0Vycm9yMihtZXNzYWdlIHx8IGBFeHBlY3RlZCBbJHt0b1ROb2RlVHlwZUFzU3RyaW5nKGV4cGVjdGVkVHlwZXMpfV0gYnV0IGdvdCAke3RvVE5vZGVUeXBlQXNTdHJpbmcodE5vZGUudHlwZSl9LmApOwogIH0KfQpmdW5jdGlvbiBhc3NlcnRQdXJlVE5vZGVUeXBlKHR5cGUpIHsKICBpZiAoISh0eXBlID09PSAyIHx8IHR5cGUgPT09IDEgfHwgdHlwZSA9PT0gNCB8fCB0eXBlID09PSA4IHx8IHR5cGUgPT09IDMyIHx8IHR5cGUgPT09IDE2IHx8IHR5cGUgPT09IDY0IHx8IHR5cGUgPT09IDEyOCkpIHsKICAgIHRocm93RXJyb3IyKGBFeHBlY3RlZCBUTm9kZVR5cGUgdG8gaGF2ZSBvbmx5IGEgc2luZ2xlIHR5cGUgc2VsZWN0ZWQsIGJ1dCBnb3QgJHt0b1ROb2RlVHlwZUFzU3RyaW5nKHR5cGUpfS5gKTsKICB9Cn0KZnVuY3Rpb24gc2V0VXBBdHRyaWJ1dGVzKHJlbmRlcmVyLCBuYXRpdmUsIGF0dHJzKSB7CiAgbGV0IGkgPSAwOwogIHdoaWxlIChpIDwgYXR0cnMubGVuZ3RoKSB7CiAgICBjb25zdCB2YWx1ZSA9IGF0dHJzW2ldOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIpIHsKICAgICAgaWYgKHZhbHVlICE9PSAwKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaSsrOwogICAgICBjb25zdCBuYW1lc3BhY2VVUkkgPSBhdHRyc1tpKytdOwogICAgICBjb25zdCBhdHRyTmFtZSA9IGF0dHJzW2krK107CiAgICAgIGNvbnN0IGF0dHJWYWwgPSBhdHRyc1tpKytdOwogICAgICByZW5kZXJlci5zZXRBdHRyaWJ1dGUobmF0aXZlLCBhdHRyTmFtZSwgYXR0clZhbCwgbmFtZXNwYWNlVVJJKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGF0dHJOYW1lID0gdmFsdWU7CiAgICAgIGNvbnN0IGF0dHJWYWwgPSBhdHRyc1srK2ldOwogICAgICBpZiAoaXNBbmltYXRpb25Qcm9wKGF0dHJOYW1lKSkgewogICAgICAgIHJlbmRlcmVyLnNldFByb3BlcnR5KG5hdGl2ZSwgYXR0ck5hbWUsIGF0dHJWYWwpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlbmRlcmVyLnNldEF0dHJpYnV0ZShuYXRpdmUsIGF0dHJOYW1lLCBhdHRyVmFsKTsKICAgICAgfQogICAgICBpKys7CiAgICB9CiAgfQogIHJldHVybiBpOwp9CmZ1bmN0aW9uIGlzTmFtZU9ubHlBdHRyaWJ1dGVNYXJrZXIobWFya2VyKSB7CiAgcmV0dXJuIG1hcmtlciA9PT0gMyB8fCBtYXJrZXIgPT09IDQgfHwgbWFya2VyID09PSA2Owp9CmZ1bmN0aW9uIGlzQW5pbWF0aW9uUHJvcChuYW1lKSB7CiAgcmV0dXJuIG5hbWUuY2hhckNvZGVBdCgwKSA9PT0gNjQ7Cn0KZnVuY3Rpb24gbWVyZ2VIb3N0QXR0cnMoZHN0LCBzcmMpIHsKICBpZiAoc3JjID09PSBudWxsIHx8IHNyYy5sZW5ndGggPT09IDApIDsKICBlbHNlIGlmIChkc3QgPT09IG51bGwgfHwgZHN0Lmxlbmd0aCA9PT0gMCkgewogICAgZHN0ID0gc3JjLnNsaWNlKCk7CiAgfSBlbHNlIHsKICAgIGxldCBzcmNNYXJrZXIgPSAtMTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3JjLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGl0ZW0gPSBzcmNbaV07CiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gIm51bWJlciIpIHsKICAgICAgICBzcmNNYXJrZXIgPSBpdGVtOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChzcmNNYXJrZXIgPT09IDApIDsKICAgICAgICBlbHNlIGlmIChzcmNNYXJrZXIgPT09IC0xIHx8IHNyY01hcmtlciA9PT0gMikgewogICAgICAgICAgbWVyZ2VIb3N0QXR0cmlidXRlKGRzdCwgc3JjTWFya2VyLCBpdGVtLCBudWxsLCBzcmNbKytpXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1lcmdlSG9zdEF0dHJpYnV0ZShkc3QsIHNyY01hcmtlciwgaXRlbSwgbnVsbCwgbnVsbCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBkc3Q7Cn0KZnVuY3Rpb24gbWVyZ2VIb3N0QXR0cmlidXRlKGRzdCwgbWFya2VyLCBrZXkxLCBrZXkyLCB2YWx1ZSkgewogIGxldCBpID0gMDsKICBsZXQgbWFya2VySW5zZXJ0UG9zaXRpb24gPSBkc3QubGVuZ3RoOwogIGlmIChtYXJrZXIgPT09IC0xKSB7CiAgICBtYXJrZXJJbnNlcnRQb3NpdGlvbiA9IC0xOwogIH0gZWxzZSB7CiAgICB3aGlsZSAoaSA8IGRzdC5sZW5ndGgpIHsKICAgICAgY29uc3QgZHN0VmFsdWUgPSBkc3RbaSsrXTsKICAgICAgaWYgKHR5cGVvZiBkc3RWYWx1ZSA9PT0gIm51bWJlciIpIHsKICAgICAgICBpZiAoZHN0VmFsdWUgPT09IG1hcmtlcikgewogICAgICAgICAgbWFya2VySW5zZXJ0UG9zaXRpb24gPSAtMTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSBpZiAoZHN0VmFsdWUgPiBtYXJrZXIpIHsKICAgICAgICAgIG1hcmtlckluc2VydFBvc2l0aW9uID0gaSAtIDE7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgd2hpbGUgKGkgPCBkc3QubGVuZ3RoKSB7CiAgICBjb25zdCBpdGVtID0gZHN0W2ldOwogICAgaWYgKHR5cGVvZiBpdGVtID09PSAibnVtYmVyIikgewogICAgICBicmVhazsKICAgIH0gZWxzZSBpZiAoaXRlbSA9PT0ga2V5MSkgewogICAgICB7CiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7CiAgICAgICAgICBkc3RbaSArIDFdID0gdmFsdWU7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogICAgaSsrOwogICAgaWYgKHZhbHVlICE9PSBudWxsKSBpKys7CiAgfQogIGlmIChtYXJrZXJJbnNlcnRQb3NpdGlvbiAhPT0gLTEpIHsKICAgIGRzdC5zcGxpY2UobWFya2VySW5zZXJ0UG9zaXRpb24sIDAsIG1hcmtlcik7CiAgICBpID0gbWFya2VySW5zZXJ0UG9zaXRpb24gKyAxOwogIH0KICBkc3Quc3BsaWNlKGkrKywgMCwga2V5MSk7CiAgaWYgKHZhbHVlICE9PSBudWxsKSB7CiAgICBkc3Quc3BsaWNlKGkrKywgMCwgdmFsdWUpOwogIH0KfQpmdW5jdGlvbiBoYXNQYXJlbnRJbmplY3RvcihwYXJlbnRMb2NhdGlvbikgewogIHJldHVybiBwYXJlbnRMb2NhdGlvbiAhPT0gTk9fUEFSRU5UX0lOSkVDVE9SOwp9CmZ1bmN0aW9uIGdldFBhcmVudEluamVjdG9ySW5kZXgocGFyZW50TG9jYXRpb24pIHsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBhc3NlcnROdW1iZXIocGFyZW50TG9jYXRpb24sICJOdW1iZXIgZXhwZWN0ZWQiKTsKICAgIGFzc2VydE5vdEVxdWFsKHBhcmVudExvY2F0aW9uLCAtMSwgIk5vdCBhIHZhbGlkIHN0YXRlLiIpOwogICAgY29uc3QgcGFyZW50SW5qZWN0b3JJbmRleCA9IHBhcmVudExvY2F0aW9uICYgMzI3Njc7CiAgICBhc3NlcnRHcmVhdGVyVGhhbihwYXJlbnRJbmplY3RvckluZGV4LCBIRUFERVJfT0ZGU0VULCAiUGFyZW50IGluamVjdG9yIG11c3QgYmUgcG9pbnRpbmcgcGFzdCBIRUFERVJfT0ZGU0VULiIpOwogIH0KICByZXR1cm4gcGFyZW50TG9jYXRpb24gJiAzMjc2NzsKfQpmdW5jdGlvbiBnZXRQYXJlbnRJbmplY3RvclZpZXdPZmZzZXQocGFyZW50TG9jYXRpb24pIHsKICByZXR1cm4gcGFyZW50TG9jYXRpb24gPj4gMTY7Cn0KZnVuY3Rpb24gZ2V0UGFyZW50SW5qZWN0b3JWaWV3KGxvY2F0aW9uMiwgc3RhcnRWaWV3KSB7CiAgbGV0IHZpZXdPZmZzZXQgPSBnZXRQYXJlbnRJbmplY3RvclZpZXdPZmZzZXQobG9jYXRpb24yKTsKICBsZXQgcGFyZW50VmlldyA9IHN0YXJ0VmlldzsKICB3aGlsZSAodmlld09mZnNldCA+IDApIHsKICAgIHBhcmVudFZpZXcgPSBwYXJlbnRWaWV3W0RFQ0xBUkFUSU9OX1ZJRVddOwogICAgdmlld09mZnNldC0tOwogIH0KICByZXR1cm4gcGFyZW50VmlldzsKfQp2YXIgaW5jbHVkZVZpZXdQcm92aWRlcnMgPSB0cnVlOwpmdW5jdGlvbiBzZXRJbmNsdWRlVmlld1Byb3ZpZGVycyh2KSB7CiAgY29uc3Qgb2xkVmFsdWUgPSBpbmNsdWRlVmlld1Byb3ZpZGVyczsKICBpbmNsdWRlVmlld1Byb3ZpZGVycyA9IHY7CiAgcmV0dXJuIG9sZFZhbHVlOwp9CnZhciBCTE9PTV9TSVpFID0gMjU2Owp2YXIgQkxPT01fTUFTSyA9IEJMT09NX1NJWkUgLSAxOwp2YXIgQkxPT01fQlVDS0VUX0JJVFMgPSA1Owp2YXIgbmV4dE5nRWxlbWVudElkID0gMDsKdmFyIE5PVF9GT1VORDIgPSB7fTsKZnVuY3Rpb24gYmxvb21BZGQoaW5qZWN0b3JJbmRleCwgdFZpZXcsIHR5cGUpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwodFZpZXcuZmlyc3RDcmVhdGVQYXNzLCB0cnVlLCAiZXhwZWN0ZWQgZmlyc3RDcmVhdGVQYXNzIHRvIGJlIHRydWUiKTsKICBsZXQgaWQ7CiAgaWYgKHR5cGVvZiB0eXBlID09PSAic3RyaW5nIikgewogICAgaWQgPSB0eXBlLmNoYXJDb2RlQXQoMCkgfHwgMDsKICB9IGVsc2UgaWYgKHR5cGUuaGFzT3duUHJvcGVydHkoTkdfRUxFTUVOVF9JRCkpIHsKICAgIGlkID0gdHlwZVtOR19FTEVNRU5UX0lEXTsKICB9CiAgaWYgKGlkID09IG51bGwpIHsKICAgIGlkID0gdHlwZVtOR19FTEVNRU5UX0lEXSA9IG5leHROZ0VsZW1lbnRJZCsrOwogIH0KICBjb25zdCBibG9vbUhhc2ggPSBpZCAmIEJMT09NX01BU0s7CiAgY29uc3QgbWFzayA9IDEgPDwgYmxvb21IYXNoOwogIHRWaWV3LmRhdGFbaW5qZWN0b3JJbmRleCArIChibG9vbUhhc2ggPj4gQkxPT01fQlVDS0VUX0JJVFMpXSB8PSBtYXNrOwp9CmZ1bmN0aW9uIGdldE9yQ3JlYXRlTm9kZUluamVjdG9yRm9yTm9kZSh0Tm9kZSwgbFZpZXcpIHsKICBjb25zdCBleGlzdGluZ0luamVjdG9ySW5kZXggPSBnZXRJbmplY3RvckluZGV4KHROb2RlLCBsVmlldyk7CiAgaWYgKGV4aXN0aW5nSW5qZWN0b3JJbmRleCAhPT0gLTEpIHsKICAgIHJldHVybiBleGlzdGluZ0luamVjdG9ySW5kZXg7CiAgfQogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGlmICh0Vmlldy5maXJzdENyZWF0ZVBhc3MpIHsKICAgIHROb2RlLmluamVjdG9ySW5kZXggPSBsVmlldy5sZW5ndGg7CiAgICBpbnNlcnRCbG9vbSh0Vmlldy5kYXRhLCB0Tm9kZSk7CiAgICBpbnNlcnRCbG9vbShsVmlldywgbnVsbCk7CiAgICBpbnNlcnRCbG9vbSh0Vmlldy5ibHVlcHJpbnQsIG51bGwpOwogIH0KICBjb25zdCBwYXJlbnRMb2MgPSBnZXRQYXJlbnRJbmplY3RvckxvY2F0aW9uKHROb2RlLCBsVmlldyk7CiAgY29uc3QgaW5qZWN0b3JJbmRleCA9IHROb2RlLmluamVjdG9ySW5kZXg7CiAgaWYgKGhhc1BhcmVudEluamVjdG9yKHBhcmVudExvYykpIHsKICAgIGNvbnN0IHBhcmVudEluZGV4ID0gZ2V0UGFyZW50SW5qZWN0b3JJbmRleChwYXJlbnRMb2MpOwogICAgY29uc3QgcGFyZW50TFZpZXcgPSBnZXRQYXJlbnRJbmplY3RvclZpZXcocGFyZW50TG9jLCBsVmlldyk7CiAgICBjb25zdCBwYXJlbnREYXRhID0gcGFyZW50TFZpZXdbVFZJRVddLmRhdGE7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykgewogICAgICBsVmlld1tpbmplY3RvckluZGV4ICsgaV0gPSBwYXJlbnRMVmlld1twYXJlbnRJbmRleCArIGldIHwgcGFyZW50RGF0YVtwYXJlbnRJbmRleCArIGldOwogICAgfQogIH0KICBsVmlld1tpbmplY3RvckluZGV4ICsgOF0gPSBwYXJlbnRMb2M7CiAgcmV0dXJuIGluamVjdG9ySW5kZXg7Cn0KZnVuY3Rpb24gaW5zZXJ0Qmxvb20oYXJyLCBmb290ZXIpIHsKICBhcnIucHVzaCgwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCBmb290ZXIpOwp9CmZ1bmN0aW9uIGdldEluamVjdG9ySW5kZXgodE5vZGUsIGxWaWV3KSB7CiAgaWYgKHROb2RlLmluamVjdG9ySW5kZXggPT09IC0xIHx8IHROb2RlLnBhcmVudCAmJiB0Tm9kZS5wYXJlbnQuaW5qZWN0b3JJbmRleCA9PT0gdE5vZGUuaW5qZWN0b3JJbmRleCB8fCBsVmlld1t0Tm9kZS5pbmplY3RvckluZGV4ICsgOF0gPT09IG51bGwpIHsKICAgIHJldHVybiAtMTsKICB9IGVsc2UgewogICAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgdE5vZGUuaW5qZWN0b3JJbmRleCk7CiAgICByZXR1cm4gdE5vZGUuaW5qZWN0b3JJbmRleDsKICB9Cn0KZnVuY3Rpb24gZ2V0UGFyZW50SW5qZWN0b3JMb2NhdGlvbih0Tm9kZSwgbFZpZXcpIHsKICBpZiAodE5vZGUucGFyZW50ICYmIHROb2RlLnBhcmVudC5pbmplY3RvckluZGV4ICE9PSAtMSkgewogICAgcmV0dXJuIHROb2RlLnBhcmVudC5pbmplY3RvckluZGV4OwogIH0KICBsZXQgZGVjbGFyYXRpb25WaWV3T2Zmc2V0ID0gMDsKICBsZXQgcGFyZW50VE5vZGUgPSBudWxsOwogIGxldCBsVmlld0N1cnNvciA9IGxWaWV3OwogIHdoaWxlIChsVmlld0N1cnNvciAhPT0gbnVsbCkgewogICAgcGFyZW50VE5vZGUgPSBnZXRUTm9kZUZyb21MVmlldyhsVmlld0N1cnNvcik7CiAgICBpZiAocGFyZW50VE5vZGUgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIE5PX1BBUkVOVF9JTkpFQ1RPUjsKICAgIH0KICAgIG5nRGV2TW9kZSAmJiBwYXJlbnRUTm9kZSAmJiBhc3NlcnRUTm9kZUZvckxWaWV3KHBhcmVudFROb2RlLCBsVmlld0N1cnNvcltERUNMQVJBVElPTl9WSUVXXSk7CiAgICBkZWNsYXJhdGlvblZpZXdPZmZzZXQrKzsKICAgIGxWaWV3Q3Vyc29yID0gbFZpZXdDdXJzb3JbREVDTEFSQVRJT05fVklFV107CiAgICBpZiAocGFyZW50VE5vZGUuaW5qZWN0b3JJbmRleCAhPT0gLTEpIHsKICAgICAgcmV0dXJuIHBhcmVudFROb2RlLmluamVjdG9ySW5kZXggfCBkZWNsYXJhdGlvblZpZXdPZmZzZXQgPDwgMTY7CiAgICB9CiAgfQogIHJldHVybiBOT19QQVJFTlRfSU5KRUNUT1I7Cn0KZnVuY3Rpb24gZGlQdWJsaWNJbkluamVjdG9yKGluamVjdG9ySW5kZXgsIHRWaWV3LCB0b2tlbikgewogIGJsb29tQWRkKGluamVjdG9ySW5kZXgsIHRWaWV3LCB0b2tlbik7Cn0KZnVuY3Rpb24gaW5qZWN0QXR0cmlidXRlSW1wbCh0Tm9kZSwgYXR0ck5hbWVUb0luamVjdCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUodE5vZGUsIDEyIHwgMyk7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQodE5vZGUsICJleHBlY3RpbmcgdE5vZGUiKTsKICBpZiAoYXR0ck5hbWVUb0luamVjdCA9PT0gImNsYXNzIikgewogICAgcmV0dXJuIHROb2RlLmNsYXNzZXM7CiAgfQogIGlmIChhdHRyTmFtZVRvSW5qZWN0ID09PSAic3R5bGUiKSB7CiAgICByZXR1cm4gdE5vZGUuc3R5bGVzOwogIH0KICBjb25zdCBhdHRycyA9IHROb2RlLmF0dHJzOwogIGlmIChhdHRycykgewogICAgY29uc3QgYXR0cnNMZW5ndGggPSBhdHRycy5sZW5ndGg7CiAgICBsZXQgaSA9IDA7CiAgICB3aGlsZSAoaSA8IGF0dHJzTGVuZ3RoKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gYXR0cnNbaV07CiAgICAgIGlmIChpc05hbWVPbmx5QXR0cmlidXRlTWFya2VyKHZhbHVlKSkgYnJlYWs7CiAgICAgIGlmICh2YWx1ZSA9PT0gMCkgewogICAgICAgIGkgPSBpICsgMjsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiKSB7CiAgICAgICAgaSsrOwogICAgICAgIHdoaWxlIChpIDwgYXR0cnNMZW5ndGggJiYgdHlwZW9mIGF0dHJzW2ldID09PSAic3RyaW5nIikgewogICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gYXR0ck5hbWVUb0luamVjdCkgewogICAgICAgIHJldHVybiBhdHRyc1tpICsgMV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaSA9IGkgKyAyOwogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBudWxsOwp9CmZ1bmN0aW9uIG5vdEZvdW5kVmFsdWVPclRocm93KG5vdEZvdW5kVmFsdWUsIHRva2VuLCBmbGFncykgewogIGlmIChmbGFncyAmIDggfHwgbm90Rm91bmRWYWx1ZSAhPT0gdm9pZCAwKSB7CiAgICByZXR1cm4gbm90Rm91bmRWYWx1ZTsKICB9IGVsc2UgewogICAgdGhyb3dQcm92aWRlck5vdEZvdW5kRXJyb3IodG9rZW4sICJOb2RlSW5qZWN0b3IiKTsKICB9Cn0KZnVuY3Rpb24gbG9va3VwVG9rZW5Vc2luZ01vZHVsZUluamVjdG9yKGxWaWV3LCB0b2tlbiwgZmxhZ3MsIG5vdEZvdW5kVmFsdWUpIHsKICBpZiAoZmxhZ3MgJiA4ICYmIG5vdEZvdW5kVmFsdWUgPT09IHZvaWQgMCkgewogICAgbm90Rm91bmRWYWx1ZSA9IG51bGw7CiAgfQogIGlmICgoZmxhZ3MgJiAoMiB8IDEpKSA9PT0gMCkgewogICAgY29uc3QgbW9kdWxlSW5qZWN0b3IgPSBsVmlld1tJTkpFQ1RPUl07CiAgICBjb25zdCBwcmV2aW91c0luamVjdEltcGxlbWVudGF0aW9uID0gc2V0SW5qZWN0SW1wbGVtZW50YXRpb24odm9pZCAwKTsKICAgIHRyeSB7CiAgICAgIGlmIChtb2R1bGVJbmplY3RvcikgewogICAgICAgIHJldHVybiBtb2R1bGVJbmplY3Rvci5nZXQodG9rZW4sIG5vdEZvdW5kVmFsdWUsIGZsYWdzICYgOCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGluamVjdFJvb3RMaW1wTW9kZSh0b2tlbiwgbm90Rm91bmRWYWx1ZSwgZmxhZ3MgJiA4KTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0SW5qZWN0SW1wbGVtZW50YXRpb24ocHJldmlvdXNJbmplY3RJbXBsZW1lbnRhdGlvbik7CiAgICB9CiAgfQogIHJldHVybiBub3RGb3VuZFZhbHVlT3JUaHJvdyhub3RGb3VuZFZhbHVlLCB0b2tlbiwgZmxhZ3MpOwp9CmZ1bmN0aW9uIGdldE9yQ3JlYXRlSW5qZWN0YWJsZSh0Tm9kZSwgbFZpZXcsIHRva2VuLCBmbGFncyA9IDAsIG5vdEZvdW5kVmFsdWUpIHsKICBpZiAodE5vZGUgIT09IG51bGwpIHsKICAgIGlmIChsVmlld1tGTEFHU10gJiAyMDQ4ICYmICEoZmxhZ3MgJiAyKSkgewogICAgICBjb25zdCBlbWJlZGRlZEluamVjdG9yVmFsdWUgPSBsb29rdXBUb2tlblVzaW5nRW1iZWRkZWRJbmplY3Rvcih0Tm9kZSwgbFZpZXcsIHRva2VuLCBmbGFncywgTk9UX0ZPVU5EMik7CiAgICAgIGlmIChlbWJlZGRlZEluamVjdG9yVmFsdWUgIT09IE5PVF9GT1VORDIpIHsKICAgICAgICByZXR1cm4gZW1iZWRkZWRJbmplY3RvclZhbHVlOwogICAgICB9CiAgICB9CiAgICBjb25zdCB2YWx1ZSA9IGxvb2t1cFRva2VuVXNpbmdOb2RlSW5qZWN0b3IodE5vZGUsIGxWaWV3LCB0b2tlbiwgZmxhZ3MsIE5PVF9GT1VORDIpOwogICAgaWYgKHZhbHVlICE9PSBOT1RfRk9VTkQyKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9CiAgcmV0dXJuIGxvb2t1cFRva2VuVXNpbmdNb2R1bGVJbmplY3RvcihsVmlldywgdG9rZW4sIGZsYWdzLCBub3RGb3VuZFZhbHVlKTsKfQpmdW5jdGlvbiBsb29rdXBUb2tlblVzaW5nTm9kZUluamVjdG9yKHROb2RlLCBsVmlldywgdG9rZW4sIGZsYWdzLCBub3RGb3VuZFZhbHVlKSB7CiAgY29uc3QgYmxvb21IYXNoID0gYmxvb21IYXNoQml0T3JGYWN0b3J5KHRva2VuKTsKICBpZiAodHlwZW9mIGJsb29tSGFzaCA9PT0gImZ1bmN0aW9uIikgewogICAgaWYgKCFlbnRlckRJKGxWaWV3LCB0Tm9kZSwgZmxhZ3MpKSB7CiAgICAgIHJldHVybiBmbGFncyAmIDEgPyBub3RGb3VuZFZhbHVlT3JUaHJvdyhub3RGb3VuZFZhbHVlLCB0b2tlbiwgZmxhZ3MpIDogbG9va3VwVG9rZW5Vc2luZ01vZHVsZUluamVjdG9yKGxWaWV3LCB0b2tlbiwgZmxhZ3MsIG5vdEZvdW5kVmFsdWUpOwogICAgfQogICAgdHJ5IHsKICAgICAgbGV0IHZhbHVlOwogICAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgICAgcnVuSW5JbmplY3RvclByb2ZpbGVyQ29udGV4dChuZXcgTm9kZUluamVjdG9yKGdldEN1cnJlbnRUTm9kZSgpLCBnZXRMVmlldygpKSwgdG9rZW4sICgpID0+IHsKICAgICAgICAgIGVtaXRJbmplY3RvclRvQ3JlYXRlSW5zdGFuY2VFdmVudCh0b2tlbik7CiAgICAgICAgICB2YWx1ZSA9IGJsb29tSGFzaChmbGFncyk7CiAgICAgICAgICBlbWl0SW5zdGFuY2VDcmVhdGVkQnlJbmplY3RvckV2ZW50KHZhbHVlKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWx1ZSA9IGJsb29tSGFzaChmbGFncyk7CiAgICAgIH0KICAgICAgaWYgKHZhbHVlID09IG51bGwgJiYgIShmbGFncyAmIDgpKSB7CiAgICAgICAgdGhyb3dQcm92aWRlck5vdEZvdW5kRXJyb3IodG9rZW4pOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgbGVhdmVESSgpOwogICAgfQogIH0gZWxzZSBpZiAodHlwZW9mIGJsb29tSGFzaCA9PT0gIm51bWJlciIpIHsKICAgIGxldCBwcmV2aW91c1RWaWV3ID0gbnVsbDsKICAgIGxldCBpbmplY3RvckluZGV4ID0gZ2V0SW5qZWN0b3JJbmRleCh0Tm9kZSwgbFZpZXcpOwogICAgbGV0IHBhcmVudExvY2F0aW9uID0gTk9fUEFSRU5UX0lOSkVDVE9SOwogICAgbGV0IGhvc3RURWxlbWVudE5vZGUgPSBmbGFncyAmIDEgPyBsVmlld1tERUNMQVJBVElPTl9DT01QT05FTlRfVklFV11bVF9IT1NUXSA6IG51bGw7CiAgICBpZiAoaW5qZWN0b3JJbmRleCA9PT0gLTEgfHwgZmxhZ3MgJiA0KSB7CiAgICAgIHBhcmVudExvY2F0aW9uID0gaW5qZWN0b3JJbmRleCA9PT0gLTEgPyBnZXRQYXJlbnRJbmplY3RvckxvY2F0aW9uKHROb2RlLCBsVmlldykgOiBsVmlld1tpbmplY3RvckluZGV4ICsgOF07CiAgICAgIGlmIChwYXJlbnRMb2NhdGlvbiA9PT0gTk9fUEFSRU5UX0lOSkVDVE9SIHx8ICFzaG91bGRTZWFyY2hQYXJlbnQoZmxhZ3MsIGZhbHNlKSkgewogICAgICAgIGluamVjdG9ySW5kZXggPSAtMTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwcmV2aW91c1RWaWV3ID0gbFZpZXdbVFZJRVddOwogICAgICAgIGluamVjdG9ySW5kZXggPSBnZXRQYXJlbnRJbmplY3RvckluZGV4KHBhcmVudExvY2F0aW9uKTsKICAgICAgICBsVmlldyA9IGdldFBhcmVudEluamVjdG9yVmlldyhwYXJlbnRMb2NhdGlvbiwgbFZpZXcpOwogICAgICB9CiAgICB9CiAgICB3aGlsZSAoaW5qZWN0b3JJbmRleCAhPT0gLTEpIHsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydE5vZGVJbmplY3RvcihsVmlldywgaW5qZWN0b3JJbmRleCk7CiAgICAgIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVGb3JMVmlldyh0Vmlldy5kYXRhW2luamVjdG9ySW5kZXggKyA4XSwgbFZpZXcpOwogICAgICBpZiAoYmxvb21IYXNUb2tlbihibG9vbUhhc2gsIGluamVjdG9ySW5kZXgsIHRWaWV3LmRhdGEpKSB7CiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBzZWFyY2hUb2tlbnNPbkluamVjdG9yKGluamVjdG9ySW5kZXgsIGxWaWV3LCB0b2tlbiwgcHJldmlvdXNUVmlldywgZmxhZ3MsIGhvc3RURWxlbWVudE5vZGUpOwogICAgICAgIGlmIChpbnN0YW5jZSAhPT0gTk9UX0ZPVU5EMikgewogICAgICAgICAgcmV0dXJuIGluc3RhbmNlOwogICAgICAgIH0KICAgICAgfQogICAgICBwYXJlbnRMb2NhdGlvbiA9IGxWaWV3W2luamVjdG9ySW5kZXggKyA4XTsKICAgICAgaWYgKHBhcmVudExvY2F0aW9uICE9PSBOT19QQVJFTlRfSU5KRUNUT1IgJiYgc2hvdWxkU2VhcmNoUGFyZW50KGZsYWdzLCBsVmlld1tUVklFV10uZGF0YVtpbmplY3RvckluZGV4ICsgOF0gPT09IGhvc3RURWxlbWVudE5vZGUpICYmIGJsb29tSGFzVG9rZW4oYmxvb21IYXNoLCBpbmplY3RvckluZGV4LCBsVmlldykpIHsKICAgICAgICBwcmV2aW91c1RWaWV3ID0gdFZpZXc7CiAgICAgICAgaW5qZWN0b3JJbmRleCA9IGdldFBhcmVudEluamVjdG9ySW5kZXgocGFyZW50TG9jYXRpb24pOwogICAgICAgIGxWaWV3ID0gZ2V0UGFyZW50SW5qZWN0b3JWaWV3KHBhcmVudExvY2F0aW9uLCBsVmlldyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW5qZWN0b3JJbmRleCA9IC0xOwogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBub3RGb3VuZFZhbHVlOwp9CmZ1bmN0aW9uIHNlYXJjaFRva2Vuc09uSW5qZWN0b3IoaW5qZWN0b3JJbmRleCwgbFZpZXcsIHRva2VuLCBwcmV2aW91c1RWaWV3LCBmbGFncywgaG9zdFRFbGVtZW50Tm9kZSkgewogIGNvbnN0IGN1cnJlbnRUVmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCB0Tm9kZSA9IGN1cnJlbnRUVmlldy5kYXRhW2luamVjdG9ySW5kZXggKyA4XTsKICBjb25zdCBjYW5BY2Nlc3NWaWV3UHJvdmlkZXJzID0gcHJldmlvdXNUVmlldyA9PSBudWxsID8gaXNDb21wb25lbnRIb3N0KHROb2RlKSAmJiBpbmNsdWRlVmlld1Byb3ZpZGVycyA6IHByZXZpb3VzVFZpZXcgIT0gY3VycmVudFRWaWV3ICYmICh0Tm9kZS50eXBlICYgMykgIT09IDA7CiAgY29uc3QgaXNIb3N0U3BlY2lhbENhc2UgPSBmbGFncyAmIDEgJiYgaG9zdFRFbGVtZW50Tm9kZSA9PT0gdE5vZGU7CiAgY29uc3QgaW5qZWN0YWJsZUlkeCA9IGxvY2F0ZURpcmVjdGl2ZU9yUHJvdmlkZXIodE5vZGUsIGN1cnJlbnRUVmlldywgdG9rZW4sIGNhbkFjY2Vzc1ZpZXdQcm92aWRlcnMsIGlzSG9zdFNwZWNpYWxDYXNlKTsKICBpZiAoaW5qZWN0YWJsZUlkeCAhPT0gbnVsbCkgewogICAgcmV0dXJuIGdldE5vZGVJbmplY3RhYmxlKGxWaWV3LCBjdXJyZW50VFZpZXcsIGluamVjdGFibGVJZHgsIHROb2RlLCBmbGFncyk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBOT1RfRk9VTkQyOwogIH0KfQpmdW5jdGlvbiBsb2NhdGVEaXJlY3RpdmVPclByb3ZpZGVyKHROb2RlLCB0VmlldywgdG9rZW4sIGNhbkFjY2Vzc1ZpZXdQcm92aWRlcnMsIGlzSG9zdFNwZWNpYWxDYXNlKSB7CiAgY29uc3Qgbm9kZVByb3ZpZGVySW5kZXhlcyA9IHROb2RlLnByb3ZpZGVySW5kZXhlczsKICBjb25zdCB0SW5qZWN0YWJsZXMgPSB0Vmlldy5kYXRhOwogIGNvbnN0IGluamVjdGFibGVzU3RhcnQgPSBub2RlUHJvdmlkZXJJbmRleGVzICYgMTA0ODU3NTsKICBjb25zdCBkaXJlY3RpdmVzU3RhcnQgPSB0Tm9kZS5kaXJlY3RpdmVTdGFydDsKICBjb25zdCBkaXJlY3RpdmVFbmQgPSB0Tm9kZS5kaXJlY3RpdmVFbmQ7CiAgY29uc3QgY3B0Vmlld1Byb3ZpZGVyc0NvdW50ID0gbm9kZVByb3ZpZGVySW5kZXhlcyA+PiAyMDsKICBjb25zdCBzdGFydGluZ0luZGV4ID0gY2FuQWNjZXNzVmlld1Byb3ZpZGVycyA/IGluamVjdGFibGVzU3RhcnQgOiBpbmplY3RhYmxlc1N0YXJ0ICsgY3B0Vmlld1Byb3ZpZGVyc0NvdW50OwogIGNvbnN0IGVuZEluZGV4ID0gaXNIb3N0U3BlY2lhbENhc2UgPyBpbmplY3RhYmxlc1N0YXJ0ICsgY3B0Vmlld1Byb3ZpZGVyc0NvdW50IDogZGlyZWN0aXZlRW5kOwogIGZvciAobGV0IGkgPSBzdGFydGluZ0luZGV4OyBpIDwgZW5kSW5kZXg7IGkrKykgewogICAgY29uc3QgcHJvdmlkZXJUb2tlbk9yRGVmID0gdEluamVjdGFibGVzW2ldOwogICAgaWYgKGkgPCBkaXJlY3RpdmVzU3RhcnQgJiYgdG9rZW4gPT09IHByb3ZpZGVyVG9rZW5PckRlZiB8fCBpID49IGRpcmVjdGl2ZXNTdGFydCAmJiBwcm92aWRlclRva2VuT3JEZWYudHlwZSA9PT0gdG9rZW4pIHsKICAgICAgcmV0dXJuIGk7CiAgICB9CiAgfQogIGlmIChpc0hvc3RTcGVjaWFsQ2FzZSkgewogICAgY29uc3QgZGlyRGVmID0gdEluamVjdGFibGVzW2RpcmVjdGl2ZXNTdGFydF07CiAgICBpZiAoZGlyRGVmICYmIGlzQ29tcG9uZW50RGVmKGRpckRlZikgJiYgZGlyRGVmLnR5cGUgPT09IHRva2VuKSB7CiAgICAgIHJldHVybiBkaXJlY3RpdmVzU3RhcnQ7CiAgICB9CiAgfQogIHJldHVybiBudWxsOwp9CnZhciBpbmplY3Rpb25QYXRoID0gW107CmZ1bmN0aW9uIGdldE5vZGVJbmplY3RhYmxlKGxWaWV3LCB0VmlldywgaW5kZXgsIHROb2RlLCBmbGFncykgewogIGxldCB2YWx1ZSA9IGxWaWV3W2luZGV4XTsKICBjb25zdCB0RGF0YSA9IHRWaWV3LmRhdGE7CiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTm9kZUluamVjdG9yRmFjdG9yeSkgewogICAgY29uc3QgZmFjdG9yeSA9IHZhbHVlOwogICAgbmdEZXZNb2RlICYmIGluamVjdGlvblBhdGgucHVzaChmYWN0b3J5Lm5hbWUgPz8gInVua25vd24iKTsKICAgIGlmIChmYWN0b3J5LnJlc29sdmluZykgewogICAgICBsZXQgdG9rZW4yID0gIiI7CiAgICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgICB0b2tlbjIgPSBzdHJpbmdpZnlGb3JFcnJvcih0RGF0YVtpbmRleF0pOwogICAgICAgIHRocm93IGN5Y2xpY0RlcGVuZGVuY3lFcnJvcldpdGhEZXRhaWxzKHRva2VuMiwgaW5qZWN0aW9uUGF0aCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgY3ljbGljRGVwZW5kZW5jeUVycm9yKHRva2VuMik7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IHByZXZpb3VzSW5jbHVkZVZpZXdQcm92aWRlcnMgPSBzZXRJbmNsdWRlVmlld1Byb3ZpZGVycyhmYWN0b3J5LmNhblNlZVZpZXdQcm92aWRlcnMpOwogICAgZmFjdG9yeS5yZXNvbHZpbmcgPSB0cnVlOwogICAgY29uc3QgdG9rZW4gPSB0RGF0YVtpbmRleF0udHlwZSB8fCB0RGF0YVtpbmRleF07CiAgICBsZXQgcHJldkluamVjdENvbnRleHQ7CiAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgIGNvbnN0IGluamVjdG9yID0gbmV3IE5vZGVJbmplY3Rvcih0Tm9kZSwgbFZpZXcpOwogICAgICBwcmV2SW5qZWN0Q29udGV4dCA9IHNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KHsKICAgICAgICBpbmplY3RvciwKICAgICAgICB0b2tlbgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24gPSBmYWN0b3J5LmluamVjdEltcGwgPyBzZXRJbmplY3RJbXBsZW1lbnRhdGlvbihmYWN0b3J5LmluamVjdEltcGwpIDogbnVsbDsKICAgIGNvbnN0IHN1Y2Nlc3MgPSBlbnRlckRJKGxWaWV3LCB0Tm9kZSwgMCk7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwoc3VjY2VzcywgdHJ1ZSwgIkJlY2F1c2UgZmxhZ3MgZG8gbm90IGNvbnRhaW4gYFNraXBTZWxmJyB3ZSBleHBlY3QgdGhpcyB0byBhbHdheXMgc3VjY2VlZC4iKTsKICAgIHRyeSB7CiAgICAgIG5nRGV2TW9kZSAmJiBlbWl0SW5qZWN0b3JUb0NyZWF0ZUluc3RhbmNlRXZlbnQodG9rZW4pOwogICAgICB2YWx1ZSA9IGxWaWV3W2luZGV4XSA9IGZhY3RvcnkuZmFjdG9yeSh2b2lkIDAsIGZsYWdzLCB0RGF0YSwgbFZpZXcsIHROb2RlKTsKICAgICAgbmdEZXZNb2RlICYmIGVtaXRJbnN0YW5jZUNyZWF0ZWRCeUluamVjdG9yRXZlbnQodmFsdWUpOwogICAgICBpZiAodFZpZXcuZmlyc3RDcmVhdGVQYXNzICYmIGluZGV4ID49IHROb2RlLmRpcmVjdGl2ZVN0YXJ0KSB7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERpcmVjdGl2ZURlZih0RGF0YVtpbmRleF0pOwogICAgICAgIHJlZ2lzdGVyUHJlT3JkZXJIb29rcyhpbmRleCwgdERhdGFbaW5kZXhdLCB0Vmlldyk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIG5nRGV2TW9kZSAmJiBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dChwcmV2SW5qZWN0Q29udGV4dCk7CiAgICAgIHByZXZpb3VzSW5qZWN0SW1wbGVtZW50YXRpb24gIT09IG51bGwgJiYgc2V0SW5qZWN0SW1wbGVtZW50YXRpb24ocHJldmlvdXNJbmplY3RJbXBsZW1lbnRhdGlvbik7CiAgICAgIHNldEluY2x1ZGVWaWV3UHJvdmlkZXJzKHByZXZpb3VzSW5jbHVkZVZpZXdQcm92aWRlcnMpOwogICAgICBmYWN0b3J5LnJlc29sdmluZyA9IGZhbHNlOwogICAgICBsZWF2ZURJKCk7CiAgICAgIG5nRGV2TW9kZSAmJiAoaW5qZWN0aW9uUGF0aCA9IFtdKTsKICAgIH0KICB9CiAgcmV0dXJuIHZhbHVlOwp9CmZ1bmN0aW9uIGJsb29tSGFzaEJpdE9yRmFjdG9yeSh0b2tlbikgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHRva2VuLCAidG9rZW4gbXVzdCBiZSBkZWZpbmVkIik7CiAgaWYgKHR5cGVvZiB0b2tlbiA9PT0gInN0cmluZyIpIHsKICAgIHJldHVybiB0b2tlbi5jaGFyQ29kZUF0KDApIHx8IDA7CiAgfQogIGNvbnN0IHRva2VuSWQgPSB0b2tlbi5oYXNPd25Qcm9wZXJ0eShOR19FTEVNRU5UX0lEKSA/IHRva2VuW05HX0VMRU1FTlRfSURdIDogdm9pZCAwOwogIGlmICh0eXBlb2YgdG9rZW5JZCA9PT0gIm51bWJlciIpIHsKICAgIGlmICh0b2tlbklkID49IDApIHsKICAgICAgcmV0dXJuIHRva2VuSWQgJiBCTE9PTV9NQVNLOwogICAgfSBlbHNlIHsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydEVxdWFsKHRva2VuSWQsIC0xLCAiRXhwZWN0aW5nIHRvIGdldCBTcGVjaWFsIEluamVjdG9yIElkIik7CiAgICAgIHJldHVybiBjcmVhdGVOb2RlSW5qZWN0b3I7CiAgICB9CiAgfSBlbHNlIHsKICAgIHJldHVybiB0b2tlbklkOwogIH0KfQpmdW5jdGlvbiBibG9vbUhhc1Rva2VuKGJsb29tSGFzaCwgaW5qZWN0b3JJbmRleCwgaW5qZWN0b3JWaWV3KSB7CiAgY29uc3QgbWFzayA9IDEgPDwgYmxvb21IYXNoOwogIGNvbnN0IHZhbHVlID0gaW5qZWN0b3JWaWV3W2luamVjdG9ySW5kZXggKyAoYmxvb21IYXNoID4+IEJMT09NX0JVQ0tFVF9CSVRTKV07CiAgcmV0dXJuICEhKHZhbHVlICYgbWFzayk7Cn0KZnVuY3Rpb24gc2hvdWxkU2VhcmNoUGFyZW50KGZsYWdzLCBpc0ZpcnN0SG9zdFROb2RlKSB7CiAgcmV0dXJuICEoZmxhZ3MgJiAyKSAmJiAhKGZsYWdzICYgMSAmJiBpc0ZpcnN0SG9zdFROb2RlKTsKfQpmdW5jdGlvbiBnZXROb2RlSW5qZWN0b3JMVmlldyhub2RlSW5qZWN0b3IpIHsKICByZXR1cm4gbm9kZUluamVjdG9yLl9sVmlldzsKfQpmdW5jdGlvbiBnZXROb2RlSW5qZWN0b3JUTm9kZShub2RlSW5qZWN0b3IpIHsKICByZXR1cm4gbm9kZUluamVjdG9yLl90Tm9kZTsKfQp2YXIgTm9kZUluamVjdG9yID0gY2xhc3MgewogIF90Tm9kZTsKICBfbFZpZXc7CiAgY29uc3RydWN0b3IoX3ROb2RlLCBfbFZpZXcpIHsKICAgIHRoaXMuX3ROb2RlID0gX3ROb2RlOwogICAgdGhpcy5fbFZpZXcgPSBfbFZpZXc7CiAgfQogIGdldCh0b2tlbiwgbm90Rm91bmRWYWx1ZSwgZmxhZ3MpIHsKICAgIHJldHVybiBnZXRPckNyZWF0ZUluamVjdGFibGUodGhpcy5fdE5vZGUsIHRoaXMuX2xWaWV3LCB0b2tlbiwgY29udmVydFRvQml0RmxhZ3MoZmxhZ3MpLCBub3RGb3VuZFZhbHVlKTsKICB9Cn07CmZ1bmN0aW9uIGNyZWF0ZU5vZGVJbmplY3RvcigpIHsKICByZXR1cm4gbmV3IE5vZGVJbmplY3RvcihnZXRDdXJyZW50VE5vZGUoKSwgZ2V0TFZpZXcoKSk7Cn0KZnVuY3Rpb24gybXJtWdldEluaGVyaXRlZEZhY3RvcnkodHlwZSkgewogIHJldHVybiBub1NpZGVFZmZlY3RzKCgpID0+IHsKICAgIGNvbnN0IG93bkNvbnN0cnVjdG9yID0gdHlwZS5wcm90b3R5cGUuY29uc3RydWN0b3I7CiAgICBjb25zdCBvd25GYWN0b3J5ID0gb3duQ29uc3RydWN0b3JbTkdfRkFDVE9SWV9ERUZdIHx8IGdldEZhY3RvcnlPZihvd25Db25zdHJ1Y3Rvcik7CiAgICBjb25zdCBvYmplY3RQcm90b3R5cGUgPSBPYmplY3QucHJvdG90eXBlOwogICAgbGV0IHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0eXBlLnByb3RvdHlwZSkuY29uc3RydWN0b3I7CiAgICB3aGlsZSAocGFyZW50ICYmIHBhcmVudCAhPT0gb2JqZWN0UHJvdG90eXBlKSB7CiAgICAgIGNvbnN0IGZhY3RvcnkgPSBwYXJlbnRbTkdfRkFDVE9SWV9ERUZdIHx8IGdldEZhY3RvcnlPZihwYXJlbnQpOwogICAgICBpZiAoZmFjdG9yeSAmJiBmYWN0b3J5ICE9PSBvd25GYWN0b3J5KSB7CiAgICAgICAgcmV0dXJuIGZhY3Rvcnk7CiAgICAgIH0KICAgICAgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHBhcmVudCk7CiAgICB9CiAgICByZXR1cm4gKHQpID0+IG5ldyB0KCk7CiAgfSk7Cn0KZnVuY3Rpb24gZ2V0RmFjdG9yeU9mKHR5cGUpIHsKICBpZiAoaXNGb3J3YXJkUmVmKHR5cGUpKSB7CiAgICByZXR1cm4gKCkgPT4gewogICAgICBjb25zdCBmYWN0b3J5ID0gZ2V0RmFjdG9yeU9mKHJlc29sdmVGb3J3YXJkUmVmKHR5cGUpKTsKICAgICAgcmV0dXJuIGZhY3RvcnkgJiYgZmFjdG9yeSgpOwogICAgfTsKICB9CiAgcmV0dXJuIGdldEZhY3RvcnlEZWYodHlwZSk7Cn0KZnVuY3Rpb24gbG9va3VwVG9rZW5Vc2luZ0VtYmVkZGVkSW5qZWN0b3IodE5vZGUsIGxWaWV3LCB0b2tlbiwgZmxhZ3MsIG5vdEZvdW5kVmFsdWUpIHsKICBsZXQgY3VycmVudFROb2RlID0gdE5vZGU7CiAgbGV0IGN1cnJlbnRMVmlldyA9IGxWaWV3OwogIHdoaWxlIChjdXJyZW50VE5vZGUgIT09IG51bGwgJiYgY3VycmVudExWaWV3ICE9PSBudWxsICYmIGN1cnJlbnRMVmlld1tGTEFHU10gJiAyMDQ4ICYmICFpc1Jvb3RWaWV3KGN1cnJlbnRMVmlldykpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZUZvckxWaWV3KGN1cnJlbnRUTm9kZSwgY3VycmVudExWaWV3KTsKICAgIGNvbnN0IG5vZGVJbmplY3RvclZhbHVlID0gbG9va3VwVG9rZW5Vc2luZ05vZGVJbmplY3RvcihjdXJyZW50VE5vZGUsIGN1cnJlbnRMVmlldywgdG9rZW4sIGZsYWdzIHwgMiwgTk9UX0ZPVU5EMik7CiAgICBpZiAobm9kZUluamVjdG9yVmFsdWUgIT09IE5PVF9GT1VORDIpIHsKICAgICAgcmV0dXJuIG5vZGVJbmplY3RvclZhbHVlOwogICAgfQogICAgbGV0IHBhcmVudFROb2RlID0gY3VycmVudFROb2RlLnBhcmVudDsKICAgIGlmICghcGFyZW50VE5vZGUpIHsKICAgICAgY29uc3QgZW1iZWRkZWRWaWV3SW5qZWN0b3IgPSBjdXJyZW50TFZpZXdbRU1CRURERURfVklFV19JTkpFQ1RPUl07CiAgICAgIGlmIChlbWJlZGRlZFZpZXdJbmplY3RvcikgewogICAgICAgIGNvbnN0IGVtYmVkZGVkVmlld0luamVjdG9yVmFsdWUgPSBlbWJlZGRlZFZpZXdJbmplY3Rvci5nZXQodG9rZW4sIE5PVF9GT1VORDIsIGZsYWdzKTsKICAgICAgICBpZiAoZW1iZWRkZWRWaWV3SW5qZWN0b3JWYWx1ZSAhPT0gTk9UX0ZPVU5EMikgewogICAgICAgICAgcmV0dXJuIGVtYmVkZGVkVmlld0luamVjdG9yVmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIHBhcmVudFROb2RlID0gZ2V0VE5vZGVGcm9tTFZpZXcoY3VycmVudExWaWV3KTsKICAgICAgY3VycmVudExWaWV3ID0gY3VycmVudExWaWV3W0RFQ0xBUkFUSU9OX1ZJRVddOwogICAgfQogICAgY3VycmVudFROb2RlID0gcGFyZW50VE5vZGU7CiAgfQogIHJldHVybiBub3RGb3VuZFZhbHVlOwp9CmZ1bmN0aW9uIGdldFROb2RlRnJvbUxWaWV3KGxWaWV3KSB7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgdFZpZXdUeXBlID0gdFZpZXcudHlwZTsKICBpZiAodFZpZXdUeXBlID09PSAyKSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZCh0Vmlldy5kZWNsVE5vZGUsICJFbWJlZGRlZCBUTm9kZXMgc2hvdWxkIGhhdmUgZGVjbGFyYXRpb24gcGFyZW50cy4iKTsKICAgIHJldHVybiB0Vmlldy5kZWNsVE5vZGU7CiAgfSBlbHNlIGlmICh0Vmlld1R5cGUgPT09IDEpIHsKICAgIHJldHVybiBsVmlld1tUX0hPU1RdOwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiDJtcm1aW5qZWN0QXR0cmlidXRlKGF0dHJOYW1lVG9JbmplY3QpIHsKICByZXR1cm4gaW5qZWN0QXR0cmlidXRlSW1wbChnZXRDdXJyZW50VE5vZGUoKSwgYXR0ck5hbWVUb0luamVjdCk7Cn0KdmFyIEF0dHJpYnV0ZTIgPSBtYWtlUGFyYW1EZWNvcmF0b3IoIkF0dHJpYnV0ZSIsIChhdHRyaWJ1dGVOYW1lMikgPT4gKHsKICBhdHRyaWJ1dGVOYW1lOiBhdHRyaWJ1dGVOYW1lMiwKICBfX05HX0VMRU1FTlRfSURfXzogKCkgPT4gybXJtWluamVjdEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lMikKfSkpOwp2YXIgX3JlZmxlY3QgPSBudWxsOwpmdW5jdGlvbiBnZXRSZWZsZWN0KCkgewogIHJldHVybiBfcmVmbGVjdCA9IF9yZWZsZWN0IHx8IG5ldyBSZWZsZWN0aW9uQ2FwYWJpbGl0aWVzKCk7Cn0KZnVuY3Rpb24gcmVmbGVjdERlcGVuZGVuY2llcyh0eXBlKSB7CiAgcmV0dXJuIGNvbnZlcnREZXBlbmRlbmNpZXMoZ2V0UmVmbGVjdCgpLnBhcmFtZXRlcnModHlwZSkpOwp9CmZ1bmN0aW9uIGNvbnZlcnREZXBlbmRlbmNpZXMoZGVwcykgewogIHJldHVybiBkZXBzLm1hcCgoZGVwKSA9PiByZWZsZWN0RGVwZW5kZW5jeShkZXApKTsKfQpmdW5jdGlvbiByZWZsZWN0RGVwZW5kZW5jeShkZXApIHsKICBjb25zdCBtZXRhID0gewogICAgdG9rZW46IG51bGwsCiAgICBhdHRyaWJ1dGU6IG51bGwsCiAgICBob3N0OiBmYWxzZSwKICAgIG9wdGlvbmFsOiBmYWxzZSwKICAgIHNlbGY6IGZhbHNlLAogICAgc2tpcFNlbGY6IGZhbHNlCiAgfTsKICBpZiAoQXJyYXkuaXNBcnJheShkZXApICYmIGRlcC5sZW5ndGggPiAwKSB7CiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGRlcC5sZW5ndGg7IGorKykgewogICAgICBjb25zdCBwYXJhbSA9IGRlcFtqXTsKICAgICAgaWYgKHBhcmFtID09PSB2b2lkIDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihwYXJhbSk7CiAgICAgIGlmIChwYXJhbSBpbnN0YW5jZW9mIE9wdGlvbmFsIHx8IHByb3RvLm5nTWV0YWRhdGFOYW1lID09PSAiT3B0aW9uYWwiKSB7CiAgICAgICAgbWV0YS5vcHRpb25hbCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAocGFyYW0gaW5zdGFuY2VvZiBTa2lwU2VsZiB8fCBwcm90by5uZ01ldGFkYXRhTmFtZSA9PT0gIlNraXBTZWxmIikgewogICAgICAgIG1ldGEuc2tpcFNlbGYgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKHBhcmFtIGluc3RhbmNlb2YgU2VsZiB8fCBwcm90by5uZ01ldGFkYXRhTmFtZSA9PT0gIlNlbGYiKSB7CiAgICAgICAgbWV0YS5zZWxmID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChwYXJhbSBpbnN0YW5jZW9mIEhvc3QgfHwgcHJvdG8ubmdNZXRhZGF0YU5hbWUgPT09ICJIb3N0IikgewogICAgICAgIG1ldGEuaG9zdCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAocGFyYW0gaW5zdGFuY2VvZiBJbmplY3QpIHsKICAgICAgICBtZXRhLnRva2VuID0gcGFyYW0udG9rZW47CiAgICAgIH0gZWxzZSBpZiAocGFyYW0gaW5zdGFuY2VvZiBBdHRyaWJ1dGUyKSB7CiAgICAgICAgaWYgKHBhcmFtLmF0dHJpYnV0ZU5hbWUgPT09IHZvaWQgMCkgewogICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigyMDQsIG5nRGV2TW9kZSAmJiBgQXR0cmlidXRlIG5hbWUgbXVzdCBiZSBkZWZpbmVkLmApOwogICAgICAgIH0KICAgICAgICBtZXRhLmF0dHJpYnV0ZSA9IHBhcmFtLmF0dHJpYnV0ZU5hbWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWV0YS50b2tlbiA9IHBhcmFtOwogICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChkZXAgPT09IHZvaWQgMCB8fCBBcnJheS5pc0FycmF5KGRlcCkgJiYgZGVwLmxlbmd0aCA9PT0gMCkgewogICAgbWV0YS50b2tlbiA9IG51bGw7CiAgfSBlbHNlIHsKICAgIG1ldGEudG9rZW4gPSBkZXA7CiAgfQogIHJldHVybiBtZXRhOwp9CmZ1bmN0aW9uIGNvbXBpbGVJbmplY3RhYmxlKHR5cGUsIG1ldGEpIHsKICBsZXQgbmdJbmplY3RhYmxlRGVmID0gbnVsbDsKICBsZXQgbmdGYWN0b3J5RGVmID0gbnVsbDsKICBpZiAoIXR5cGUuaGFzT3duUHJvcGVydHkoTkdfUFJPVl9ERUYpKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodHlwZSwgTkdfUFJPVl9ERUYsIHsKICAgICAgZ2V0OiAoKSA9PiB7CiAgICAgICAgaWYgKG5nSW5qZWN0YWJsZURlZiA9PT0gbnVsbCkgewogICAgICAgICAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICAgICAgICAgIHVzYWdlOiAwLAogICAgICAgICAgICBraW5kOiAiaW5qZWN0YWJsZSIsCiAgICAgICAgICAgIHR5cGUKICAgICAgICAgIH0pOwogICAgICAgICAgbmdJbmplY3RhYmxlRGVmID0gY29tcGlsZXIuY29tcGlsZUluamVjdGFibGUoYW5ndWxhckNvcmVEaUVudiwgYG5nOi8vLyR7dHlwZS5uYW1lfS/JtXByb3YuanNgLCBnZXRJbmplY3RhYmxlTWV0YWRhdGEodHlwZSwgbWV0YSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmdJbmplY3RhYmxlRGVmOwogICAgICB9CiAgICB9KTsKICB9CiAgaWYgKCF0eXBlLmhhc093blByb3BlcnR5KE5HX0ZBQ1RPUllfREVGKSkgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHR5cGUsIE5HX0ZBQ1RPUllfREVGLCB7CiAgICAgIGdldDogKCkgPT4gewogICAgICAgIGlmIChuZ0ZhY3RvcnlEZWYgPT09IG51bGwpIHsKICAgICAgICAgIGNvbnN0IGNvbXBpbGVyID0gZ2V0Q29tcGlsZXJGYWNhZGUoewogICAgICAgICAgICB1c2FnZTogMCwKICAgICAgICAgICAga2luZDogImluamVjdGFibGUiLAogICAgICAgICAgICB0eXBlCiAgICAgICAgICB9KTsKICAgICAgICAgIG5nRmFjdG9yeURlZiA9IGNvbXBpbGVyLmNvbXBpbGVGYWN0b3J5KGFuZ3VsYXJDb3JlRGlFbnYsIGBuZzovLy8ke3R5cGUubmFtZX0vybVmYWMuanNgLCB7CiAgICAgICAgICAgIG5hbWU6IHR5cGUubmFtZSwKICAgICAgICAgICAgdHlwZSwKICAgICAgICAgICAgdHlwZUFyZ3VtZW50Q291bnQ6IDAsCiAgICAgICAgICAgIGRlcHM6IHJlZmxlY3REZXBlbmRlbmNpZXModHlwZSksCiAgICAgICAgICAgIHRhcmdldDogY29tcGlsZXIuRmFjdG9yeVRhcmdldC5JbmplY3RhYmxlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5nRmFjdG9yeURlZjsKICAgICAgfSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9KTsKICB9Cn0KdmFyIFVTRV9WQUxVRTIgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICBwcm92aWRlOiBTdHJpbmcsCiAgdXNlVmFsdWU6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CmZ1bmN0aW9uIGlzVXNlQ2xhc3NQcm92aWRlcihtZXRhKSB7CiAgcmV0dXJuIG1ldGEudXNlQ2xhc3MgIT09IHZvaWQgMDsKfQpmdW5jdGlvbiBpc1VzZVZhbHVlUHJvdmlkZXIobWV0YSkgewogIHJldHVybiBVU0VfVkFMVUUyIGluIG1ldGE7Cn0KZnVuY3Rpb24gaXNVc2VGYWN0b3J5UHJvdmlkZXIobWV0YSkgewogIHJldHVybiBtZXRhLnVzZUZhY3RvcnkgIT09IHZvaWQgMDsKfQpmdW5jdGlvbiBpc1VzZUV4aXN0aW5nUHJvdmlkZXIobWV0YSkgewogIHJldHVybiBtZXRhLnVzZUV4aXN0aW5nICE9PSB2b2lkIDA7Cn0KZnVuY3Rpb24gZ2V0SW5qZWN0YWJsZU1ldGFkYXRhKHR5cGUsIHNyY01ldGEpIHsKICBjb25zdCBtZXRhID0gc3JjTWV0YSB8fCB7CiAgICBwcm92aWRlZEluOiBudWxsCiAgfTsKICBjb25zdCBjb21waWxlck1ldGEgPSB7CiAgICBuYW1lOiB0eXBlLm5hbWUsCiAgICB0eXBlLAogICAgdHlwZUFyZ3VtZW50Q291bnQ6IDAsCiAgICBwcm92aWRlZEluOiBtZXRhLnByb3ZpZGVkSW4KICB9OwogIGlmICgoaXNVc2VDbGFzc1Byb3ZpZGVyKG1ldGEpIHx8IGlzVXNlRmFjdG9yeVByb3ZpZGVyKG1ldGEpKSAmJiBtZXRhLmRlcHMgIT09IHZvaWQgMCkgewogICAgY29tcGlsZXJNZXRhLmRlcHMgPSBjb252ZXJ0RGVwZW5kZW5jaWVzKG1ldGEuZGVwcyk7CiAgfQogIGlmIChpc1VzZUNsYXNzUHJvdmlkZXIobWV0YSkpIHsKICAgIGNvbXBpbGVyTWV0YS51c2VDbGFzcyA9IG1ldGEudXNlQ2xhc3M7CiAgfSBlbHNlIGlmIChpc1VzZVZhbHVlUHJvdmlkZXIobWV0YSkpIHsKICAgIGNvbXBpbGVyTWV0YS51c2VWYWx1ZSA9IG1ldGEudXNlVmFsdWU7CiAgfSBlbHNlIGlmIChpc1VzZUZhY3RvcnlQcm92aWRlcihtZXRhKSkgewogICAgY29tcGlsZXJNZXRhLnVzZUZhY3RvcnkgPSBtZXRhLnVzZUZhY3Rvcnk7CiAgfSBlbHNlIGlmIChpc1VzZUV4aXN0aW5nUHJvdmlkZXIobWV0YSkpIHsKICAgIGNvbXBpbGVyTWV0YS51c2VFeGlzdGluZyA9IG1ldGEudXNlRXhpc3Rpbmc7CiAgfQogIHJldHVybiBjb21waWxlck1ldGE7Cn0KdmFyIEluamVjdGFibGUgPSBtYWtlRGVjb3JhdG9yKCJJbmplY3RhYmxlIiwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgKHR5cGUsIG1ldGEpID0+IGNvbXBpbGVJbmplY3RhYmxlKHR5cGUsIG1ldGEpKTsKZnVuY3Rpb24gaW5qZWN0RWxlbWVudFJlZigpIHsKICByZXR1cm4gY3JlYXRlRWxlbWVudFJlZihnZXRDdXJyZW50VE5vZGUoKSwgZ2V0TFZpZXcoKSk7Cn0KZnVuY3Rpb24gY3JlYXRlRWxlbWVudFJlZih0Tm9kZSwgbFZpZXcpIHsKICByZXR1cm4gbmV3IEVsZW1lbnRSZWYoZ2V0TmF0aXZlQnlUTm9kZSh0Tm9kZSwgbFZpZXcpKTsKfQp2YXIgRWxlbWVudFJlZiA9IGNsYXNzIHsKICBuYXRpdmVFbGVtZW50OwogIGNvbnN0cnVjdG9yKG5hdGl2ZUVsZW1lbnQpIHsKICAgIHRoaXMubmF0aXZlRWxlbWVudCA9IG5hdGl2ZUVsZW1lbnQ7CiAgfQogIHN0YXRpYyBfX05HX0VMRU1FTlRfSURfXyA9IGluamVjdEVsZW1lbnRSZWY7Cn07CmZ1bmN0aW9uIHVud3JhcEVsZW1lbnRSZWYodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBFbGVtZW50UmVmID8gdmFsdWUubmF0aXZlRWxlbWVudCA6IHZhbHVlOwp9CmZ1bmN0aW9uIHN5bWJvbEl0ZXJhdG9yKCkgewogIHJldHVybiB0aGlzLl9yZXN1bHRzW1N5bWJvbC5pdGVyYXRvcl0oKTsKfQp2YXIgUXVlcnlMaXN0ID0gY2xhc3MgewogIF9lbWl0RGlzdGluY3RDaGFuZ2VzT25seTsKICBkaXJ0eSA9IHRydWU7CiAgX29uRGlydHkgPSB2b2lkIDA7CiAgX3Jlc3VsdHMgPSBbXTsKICBfY2hhbmdlc0RldGVjdGVkID0gZmFsc2U7CiAgX2NoYW5nZXMgPSB2b2lkIDA7CiAgbGVuZ3RoID0gMDsKICBmaXJzdCA9IHZvaWQgMDsKICBsYXN0ID0gdm9pZCAwOwogIGdldCBjaGFuZ2VzKCkgewogICAgcmV0dXJuIHRoaXMuX2NoYW5nZXMgPz89IG5ldyBTdWJqZWN0KCk7CiAgfQogIGNvbnN0cnVjdG9yKF9lbWl0RGlzdGluY3RDaGFuZ2VzT25seSA9IGZhbHNlKSB7CiAgICB0aGlzLl9lbWl0RGlzdGluY3RDaGFuZ2VzT25seSA9IF9lbWl0RGlzdGluY3RDaGFuZ2VzT25seTsKICB9CiAgZ2V0KGluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5fcmVzdWx0c1tpbmRleF07CiAgfQogIG1hcChmbikgewogICAgcmV0dXJuIHRoaXMuX3Jlc3VsdHMubWFwKGZuKTsKICB9CiAgZmlsdGVyKGZuKSB7CiAgICByZXR1cm4gdGhpcy5fcmVzdWx0cy5maWx0ZXIoZm4pOwogIH0KICBmaW5kKGZuKSB7CiAgICByZXR1cm4gdGhpcy5fcmVzdWx0cy5maW5kKGZuKTsKICB9CiAgcmVkdWNlKGZuLCBpbml0KSB7CiAgICByZXR1cm4gdGhpcy5fcmVzdWx0cy5yZWR1Y2UoZm4sIGluaXQpOwogIH0KICBmb3JFYWNoKGZuKSB7CiAgICB0aGlzLl9yZXN1bHRzLmZvckVhY2goZm4pOwogIH0KICBzb21lKGZuKSB7CiAgICByZXR1cm4gdGhpcy5fcmVzdWx0cy5zb21lKGZuKTsKICB9CiAgdG9BcnJheSgpIHsKICAgIHJldHVybiB0aGlzLl9yZXN1bHRzLnNsaWNlKCk7CiAgfQogIHRvU3RyaW5nKCkgewogICAgcmV0dXJuIHRoaXMuX3Jlc3VsdHMudG9TdHJpbmcoKTsKICB9CiAgcmVzZXQocmVzdWx0c1RyZWUsIGlkZW50aXR5QWNjZXNzb3IpIHsKICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgIGNvbnN0IG5ld1Jlc3VsdEZsYXQgPSBmbGF0dGVuKHJlc3VsdHNUcmVlKTsKICAgIGlmICh0aGlzLl9jaGFuZ2VzRGV0ZWN0ZWQgPSAhYXJyYXlFcXVhbHModGhpcy5fcmVzdWx0cywgbmV3UmVzdWx0RmxhdCwgaWRlbnRpdHlBY2Nlc3NvcikpIHsKICAgICAgdGhpcy5fcmVzdWx0cyA9IG5ld1Jlc3VsdEZsYXQ7CiAgICAgIHRoaXMubGVuZ3RoID0gbmV3UmVzdWx0RmxhdC5sZW5ndGg7CiAgICAgIHRoaXMubGFzdCA9IG5ld1Jlc3VsdEZsYXRbdGhpcy5sZW5ndGggLSAxXTsKICAgICAgdGhpcy5maXJzdCA9IG5ld1Jlc3VsdEZsYXRbMF07CiAgICB9CiAgfQogIG5vdGlmeU9uQ2hhbmdlcygpIHsKICAgIGlmICh0aGlzLl9jaGFuZ2VzICE9PSB2b2lkIDAgJiYgKHRoaXMuX2NoYW5nZXNEZXRlY3RlZCB8fCAhdGhpcy5fZW1pdERpc3RpbmN0Q2hhbmdlc09ubHkpKSB0aGlzLl9jaGFuZ2VzLm5leHQodGhpcyk7CiAgfQogIG9uRGlydHkoY2IpIHsKICAgIHRoaXMuX29uRGlydHkgPSBjYjsKICB9CiAgc2V0RGlydHkoKSB7CiAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIHRoaXMuX29uRGlydHk/LigpOwogIH0KICBkZXN0cm95KCkgewogICAgaWYgKHRoaXMuX2NoYW5nZXMgIT09IHZvaWQgMCkgewogICAgICB0aGlzLl9jaGFuZ2VzLmNvbXBsZXRlKCk7CiAgICAgIHRoaXMuX2NoYW5nZXMudW5zdWJzY3JpYmUoKTsKICAgIH0KICB9CiAgW1N5bWJvbC5pdGVyYXRvcl0gPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IHN5bWJvbEl0ZXJhdG9yKSgpOwp9Owp2YXIgU0tJUF9IWURSQVRJT05fQVRUUl9OQU1FID0gIm5nU2tpcEh5ZHJhdGlvbiI7CnZhciBTS0lQX0hZRFJBVElPTl9BVFRSX05BTUVfTE9XRVJfQ0FTRSA9ICJuZ3NraXBoeWRyYXRpb24iOwpmdW5jdGlvbiBoYXNTa2lwSHlkcmF0aW9uQXR0ck9uVE5vZGUodE5vZGUpIHsKICBjb25zdCBhdHRycyA9IHROb2RlLm1lcmdlZEF0dHJzOwogIGlmIChhdHRycyA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlOwogIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cnMubGVuZ3RoOyBpICs9IDIpIHsKICAgIGNvbnN0IHZhbHVlID0gYXR0cnNbaV07CiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAibnVtYmVyIikgcmV0dXJuIGZhbHNlOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gU0tJUF9IWURSQVRJT05fQVRUUl9OQU1FX0xPV0VSX0NBU0UpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBoYXNTa2lwSHlkcmF0aW9uQXR0ck9uUkVsZW1lbnQock5vZGUpIHsKICByZXR1cm4gck5vZGUuaGFzQXR0cmlidXRlKFNLSVBfSFlEUkFUSU9OX0FUVFJfTkFNRSk7Cn0KZnVuY3Rpb24gaGFzSW5Ta2lwSHlkcmF0aW9uQmxvY2tGbGFnKHROb2RlKSB7CiAgcmV0dXJuICh0Tm9kZS5mbGFncyAmIDEyOCkgPT09IDEyODsKfQpmdW5jdGlvbiBpc0luU2tpcEh5ZHJhdGlvbkJsb2NrMih0Tm9kZSkgewogIGlmIChoYXNJblNraXBIeWRyYXRpb25CbG9ja0ZsYWcodE5vZGUpKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgbGV0IGN1cnJlbnRUTm9kZSA9IHROb2RlLnBhcmVudDsKICB3aGlsZSAoY3VycmVudFROb2RlKSB7CiAgICBpZiAoaGFzSW5Ta2lwSHlkcmF0aW9uQmxvY2tGbGFnKHROb2RlKSB8fCBoYXNTa2lwSHlkcmF0aW9uQXR0ck9uVE5vZGUoY3VycmVudFROb2RlKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGN1cnJlbnRUTm9kZSA9IGN1cnJlbnRUTm9kZS5wYXJlbnQ7CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBpc0kxOG5JblNraXBIeWRyYXRpb25CbG9jayhwYXJlbnRUTm9kZSkgewogIHJldHVybiBoYXNJblNraXBIeWRyYXRpb25CbG9ja0ZsYWcocGFyZW50VE5vZGUpIHx8IGhhc1NraXBIeWRyYXRpb25BdHRyT25UTm9kZShwYXJlbnRUTm9kZSkgfHwgaXNJblNraXBIeWRyYXRpb25CbG9jazIocGFyZW50VE5vZGUpOwp9CnZhciBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneTsKKGZ1bmN0aW9uKENoYW5nZURldGVjdGlvblN0cmF0ZWd5MikgewogIENoYW5nZURldGVjdGlvblN0cmF0ZWd5MltDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneTJbIk9uUHVzaCJdID0gMF0gPSAiT25QdXNoIjsKICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneTJbQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kyWyJEZWZhdWx0Il0gPSAxXSA9ICJEZWZhdWx0IjsKfSkoQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kgfHwgKENoYW5nZURldGVjdGlvblN0cmF0ZWd5ID0ge30pKTsKdmFyIFRSQUNLRURfTFZJRVdTID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKdmFyIHVuaXF1ZUlkQ291bnRlciA9IDA7CmZ1bmN0aW9uIGdldFVuaXF1ZUxWaWV3SWQoKSB7CiAgcmV0dXJuIHVuaXF1ZUlkQ291bnRlcisrOwp9CmZ1bmN0aW9uIHJlZ2lzdGVyTFZpZXcobFZpZXcpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVyKGxWaWV3W0lEXSwgIkxWaWV3IG11c3QgaGF2ZSBhbiBJRCBpbiBvcmRlciB0byBiZSByZWdpc3RlcmVkIik7CiAgVFJBQ0tFRF9MVklFV1Muc2V0KGxWaWV3W0lEXSwgbFZpZXcpOwp9CmZ1bmN0aW9uIGdldExWaWV3QnlJZChpZCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIoaWQsICJJRCB1c2VkIGZvciBMVmlldyBsb29rdXAgbXVzdCBiZSBhIG51bWJlciIpOwogIHJldHVybiBUUkFDS0VEX0xWSUVXUy5nZXQoaWQpIHx8IG51bGw7Cn0KZnVuY3Rpb24gdW5yZWdpc3RlckxWaWV3KGxWaWV3KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE51bWJlcihsVmlld1tJRF0sICJDYW5ub3Qgc3RvcCB0cmFja2luZyBhbiBMVmlldyB0aGF0IGRvZXMgbm90IGhhdmUgYW4gSUQiKTsKICBUUkFDS0VEX0xWSUVXUy5kZWxldGUobFZpZXdbSURdKTsKfQpmdW5jdGlvbiBnZXRUcmFja2VkTFZpZXdzKCkgewogIHJldHVybiBUUkFDS0VEX0xWSUVXUzsKfQp2YXIgTENvbnRleHQgPSBjbGFzcyB7CiAgbFZpZXdJZDsKICBub2RlSW5kZXg7CiAgbmF0aXZlOwogIGNvbXBvbmVudDsKICBkaXJlY3RpdmVzOwogIGxvY2FsUmVmczsKICBnZXQgbFZpZXcoKSB7CiAgICByZXR1cm4gZ2V0TFZpZXdCeUlkKHRoaXMubFZpZXdJZCk7CiAgfQogIGNvbnN0cnVjdG9yKGxWaWV3SWQsIG5vZGVJbmRleCwgbmF0aXZlKSB7CiAgICB0aGlzLmxWaWV3SWQgPSBsVmlld0lkOwogICAgdGhpcy5ub2RlSW5kZXggPSBub2RlSW5kZXg7CiAgICB0aGlzLm5hdGl2ZSA9IG5hdGl2ZTsKICB9Cn07CmZ1bmN0aW9uIGdldExDb250ZXh0KHRhcmdldCkgewogIGxldCBtcFZhbHVlID0gcmVhZFBhdGNoZWREYXRhKHRhcmdldCk7CiAgaWYgKG1wVmFsdWUpIHsKICAgIGlmIChpc0xWaWV3KG1wVmFsdWUpKSB7CiAgICAgIGNvbnN0IGxWaWV3ID0gbXBWYWx1ZTsKICAgICAgbGV0IG5vZGVJbmRleDsKICAgICAgbGV0IGNvbXBvbmVudCA9IHZvaWQgMDsKICAgICAgbGV0IGRpcmVjdGl2ZXMgPSB2b2lkIDA7CiAgICAgIGlmIChpc0NvbXBvbmVudEluc3RhbmNlKHRhcmdldCkpIHsKICAgICAgICBub2RlSW5kZXggPSBmaW5kVmlhQ29tcG9uZW50KGxWaWV3LCB0YXJnZXQpOwogICAgICAgIGlmIChub2RlSW5kZXggPT0gLTEpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVGhlIHByb3ZpZGVkIGNvbXBvbmVudCB3YXMgbm90IGZvdW5kIGluIHRoZSBhcHBsaWNhdGlvbiIpOwogICAgICAgIH0KICAgICAgICBjb21wb25lbnQgPSB0YXJnZXQ7CiAgICAgIH0gZWxzZSBpZiAoaXNEaXJlY3RpdmVJbnN0YW5jZSh0YXJnZXQpKSB7CiAgICAgICAgbm9kZUluZGV4ID0gZmluZFZpYURpcmVjdGl2ZShsVmlldywgdGFyZ2V0KTsKICAgICAgICBpZiAobm9kZUluZGV4ID09IC0xKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlRoZSBwcm92aWRlZCBkaXJlY3RpdmUgd2FzIG5vdCBmb3VuZCBpbiB0aGUgYXBwbGljYXRpb24iKTsKICAgICAgICB9CiAgICAgICAgZGlyZWN0aXZlcyA9IGdldERpcmVjdGl2ZXNBdE5vZGVJbmRleChub2RlSW5kZXgsIGxWaWV3KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBub2RlSW5kZXggPSBmaW5kVmlhTmF0aXZlRWxlbWVudChsVmlldywgdGFyZ2V0KTsKICAgICAgICBpZiAobm9kZUluZGV4ID09IC0xKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgbmF0aXZlID0gdW53cmFwUk5vZGUobFZpZXdbbm9kZUluZGV4XSk7CiAgICAgIGNvbnN0IGV4aXN0aW5nQ3R4ID0gcmVhZFBhdGNoZWREYXRhKG5hdGl2ZSk7CiAgICAgIGNvbnN0IGNvbnRleHQyID0gZXhpc3RpbmdDdHggJiYgIUFycmF5LmlzQXJyYXkoZXhpc3RpbmdDdHgpID8gZXhpc3RpbmdDdHggOiBjcmVhdGVMQ29udGV4dChsVmlldywgbm9kZUluZGV4LCBuYXRpdmUpOwogICAgICBpZiAoY29tcG9uZW50ICYmIGNvbnRleHQyLmNvbXBvbmVudCA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29udGV4dDIuY29tcG9uZW50ID0gY29tcG9uZW50OwogICAgICAgIGF0dGFjaFBhdGNoRGF0YShjb250ZXh0Mi5jb21wb25lbnQsIGNvbnRleHQyKTsKICAgICAgfQogICAgICBpZiAoZGlyZWN0aXZlcyAmJiBjb250ZXh0Mi5kaXJlY3RpdmVzID09PSB2b2lkIDApIHsKICAgICAgICBjb250ZXh0Mi5kaXJlY3RpdmVzID0gZGlyZWN0aXZlczsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGl2ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGF0dGFjaFBhdGNoRGF0YShkaXJlY3RpdmVzW2ldLCBjb250ZXh0Mik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGF0dGFjaFBhdGNoRGF0YShjb250ZXh0Mi5uYXRpdmUsIGNvbnRleHQyKTsKICAgICAgbXBWYWx1ZSA9IGNvbnRleHQyOwogICAgfQogIH0gZWxzZSB7CiAgICBjb25zdCByRWxlbWVudCA9IHRhcmdldDsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREb21Ob2RlKHJFbGVtZW50KTsKICAgIGxldCBwYXJlbnQgPSByRWxlbWVudDsKICAgIHdoaWxlIChwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZSkgewogICAgICBjb25zdCBwYXJlbnRDb250ZXh0ID0gcmVhZFBhdGNoZWREYXRhKHBhcmVudCk7CiAgICAgIGlmIChwYXJlbnRDb250ZXh0KSB7CiAgICAgICAgY29uc3QgbFZpZXcgPSBBcnJheS5pc0FycmF5KHBhcmVudENvbnRleHQpID8gcGFyZW50Q29udGV4dCA6IHBhcmVudENvbnRleHQubFZpZXc7CiAgICAgICAgaWYgKCFsVmlldykgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGluZGV4ID0gZmluZFZpYU5hdGl2ZUVsZW1lbnQobFZpZXcsIHJFbGVtZW50KTsKICAgICAgICBpZiAoaW5kZXggPj0gMCkgewogICAgICAgICAgY29uc3QgbmF0aXZlID0gdW53cmFwUk5vZGUobFZpZXdbaW5kZXhdKTsKICAgICAgICAgIGNvbnN0IGNvbnRleHQyID0gY3JlYXRlTENvbnRleHQobFZpZXcsIGluZGV4LCBuYXRpdmUpOwogICAgICAgICAgYXR0YWNoUGF0Y2hEYXRhKG5hdGl2ZSwgY29udGV4dDIpOwogICAgICAgICAgbXBWYWx1ZSA9IGNvbnRleHQyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBtcFZhbHVlIHx8IG51bGw7Cn0KZnVuY3Rpb24gY3JlYXRlTENvbnRleHQobFZpZXcsIG5vZGVJbmRleCwgbmF0aXZlKSB7CiAgcmV0dXJuIG5ldyBMQ29udGV4dChsVmlld1tJRF0sIG5vZGVJbmRleCwgbmF0aXZlKTsKfQpmdW5jdGlvbiBnZXRDb21wb25lbnRWaWV3QnlJbnN0YW5jZShjb21wb25lbnRJbnN0YW5jZSkgewogIGxldCBwYXRjaGVkRGF0YSA9IHJlYWRQYXRjaGVkRGF0YShjb21wb25lbnRJbnN0YW5jZSk7CiAgbGV0IGxWaWV3OwogIGlmIChpc0xWaWV3KHBhdGNoZWREYXRhKSkgewogICAgY29uc3QgY29udGV4dExWaWV3ID0gcGF0Y2hlZERhdGE7CiAgICBjb25zdCBub2RlSW5kZXggPSBmaW5kVmlhQ29tcG9uZW50KGNvbnRleHRMVmlldywgY29tcG9uZW50SW5zdGFuY2UpOwogICAgbFZpZXcgPSBnZXRDb21wb25lbnRMVmlld0J5SW5kZXgobm9kZUluZGV4LCBjb250ZXh0TFZpZXcpOwogICAgY29uc3QgY29udGV4dDIgPSBjcmVhdGVMQ29udGV4dChjb250ZXh0TFZpZXcsIG5vZGVJbmRleCwgbFZpZXdbSE9TVF0pOwogICAgY29udGV4dDIuY29tcG9uZW50ID0gY29tcG9uZW50SW5zdGFuY2U7CiAgICBhdHRhY2hQYXRjaERhdGEoY29tcG9uZW50SW5zdGFuY2UsIGNvbnRleHQyKTsKICAgIGF0dGFjaFBhdGNoRGF0YShjb250ZXh0Mi5uYXRpdmUsIGNvbnRleHQyKTsKICB9IGVsc2UgewogICAgY29uc3QgY29udGV4dDIgPSBwYXRjaGVkRGF0YTsKICAgIGNvbnN0IGNvbnRleHRMVmlldyA9IGNvbnRleHQyLmxWaWV3OwogICAgbmdEZXZNb2RlICYmIGFzc2VydExWaWV3KGNvbnRleHRMVmlldyk7CiAgICBsVmlldyA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleChjb250ZXh0Mi5ub2RlSW5kZXgsIGNvbnRleHRMVmlldyk7CiAgfQogIHJldHVybiBsVmlldzsKfQp2YXIgTU9OS0VZX1BBVENIX0tFWV9OQU1FID0gIl9fbmdDb250ZXh0X18iOwpmdW5jdGlvbiBhdHRhY2hQYXRjaERhdGEodGFyZ2V0LCBkYXRhKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQodGFyZ2V0LCAiVGFyZ2V0IGV4cGVjdGVkIik7CiAgaWYgKGlzTFZpZXcoZGF0YSkpIHsKICAgIHRhcmdldFtNT05LRVlfUEFUQ0hfS0VZX05BTUVdID0gZGF0YVtJRF07CiAgICByZWdpc3RlckxWaWV3KGRhdGEpOwogIH0gZWxzZSB7CiAgICB0YXJnZXRbTU9OS0VZX1BBVENIX0tFWV9OQU1FXSA9IGRhdGE7CiAgfQp9CmZ1bmN0aW9uIHJlYWRQYXRjaGVkRGF0YSh0YXJnZXQpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZCh0YXJnZXQsICJUYXJnZXQgZXhwZWN0ZWQiKTsKICBjb25zdCBkYXRhID0gdGFyZ2V0W01PTktFWV9QQVRDSF9LRVlfTkFNRV07CiAgcmV0dXJuIHR5cGVvZiBkYXRhID09PSAibnVtYmVyIiA/IGdldExWaWV3QnlJZChkYXRhKSA6IGRhdGEgfHwgbnVsbDsKfQpmdW5jdGlvbiByZWFkUGF0Y2hlZExWaWV3KHRhcmdldCkgewogIGNvbnN0IHZhbHVlID0gcmVhZFBhdGNoZWREYXRhKHRhcmdldCk7CiAgaWYgKHZhbHVlKSB7CiAgICByZXR1cm4gaXNMVmlldyh2YWx1ZSkgPyB2YWx1ZSA6IHZhbHVlLmxWaWV3OwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBpc0NvbXBvbmVudEluc3RhbmNlKGluc3RhbmNlKSB7CiAgcmV0dXJuIGluc3RhbmNlICYmIGluc3RhbmNlLmNvbnN0cnVjdG9yICYmIGluc3RhbmNlLmNvbnN0cnVjdG9yLsm1Y21wOwp9CmZ1bmN0aW9uIGlzRGlyZWN0aXZlSW5zdGFuY2UoaW5zdGFuY2UpIHsKICByZXR1cm4gaW5zdGFuY2UgJiYgaW5zdGFuY2UuY29uc3RydWN0b3IgJiYgaW5zdGFuY2UuY29uc3RydWN0b3IuybVkaXI7Cn0KZnVuY3Rpb24gZmluZFZpYU5hdGl2ZUVsZW1lbnQobFZpZXcsIHRhcmdldCkgewogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGZvciAobGV0IGkgPSBIRUFERVJfT0ZGU0VUOyBpIDwgdFZpZXcuYmluZGluZ1N0YXJ0SW5kZXg7IGkrKykgewogICAgaWYgKHVud3JhcFJOb2RlKGxWaWV3W2ldKSA9PT0gdGFyZ2V0KSB7CiAgICAgIHJldHVybiBpOwogICAgfQogIH0KICByZXR1cm4gLTE7Cn0KZnVuY3Rpb24gdHJhdmVyc2VOZXh0RWxlbWVudCh0Tm9kZSkgewogIGlmICh0Tm9kZS5jaGlsZCkgewogICAgcmV0dXJuIHROb2RlLmNoaWxkOwogIH0gZWxzZSBpZiAodE5vZGUubmV4dCkgewogICAgcmV0dXJuIHROb2RlLm5leHQ7CiAgfSBlbHNlIHsKICAgIHdoaWxlICh0Tm9kZS5wYXJlbnQgJiYgIXROb2RlLnBhcmVudC5uZXh0KSB7CiAgICAgIHROb2RlID0gdE5vZGUucGFyZW50OwogICAgfQogICAgcmV0dXJuIHROb2RlLnBhcmVudCAmJiB0Tm9kZS5wYXJlbnQubmV4dDsKICB9Cn0KZnVuY3Rpb24gZmluZFZpYUNvbXBvbmVudChsVmlldywgY29tcG9uZW50SW5zdGFuY2UpIHsKICBjb25zdCBjb21wb25lbnRJbmRpY2VzID0gbFZpZXdbVFZJRVddLmNvbXBvbmVudHM7CiAgaWYgKGNvbXBvbmVudEluZGljZXMpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tcG9uZW50SW5kaWNlcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBlbGVtZW50Q29tcG9uZW50SW5kZXggPSBjb21wb25lbnRJbmRpY2VzW2ldOwogICAgICBjb25zdCBjb21wb25lbnRWaWV3ID0gZ2V0Q29tcG9uZW50TFZpZXdCeUluZGV4KGVsZW1lbnRDb21wb25lbnRJbmRleCwgbFZpZXcpOwogICAgICBpZiAoY29tcG9uZW50Vmlld1tDT05URVhUXSA9PT0gY29tcG9uZW50SW5zdGFuY2UpIHsKICAgICAgICByZXR1cm4gZWxlbWVudENvbXBvbmVudEluZGV4OwogICAgICB9CiAgICB9CiAgfSBlbHNlIHsKICAgIGNvbnN0IHJvb3RDb21wb25lbnRWaWV3ID0gZ2V0Q29tcG9uZW50TFZpZXdCeUluZGV4KEhFQURFUl9PRkZTRVQsIGxWaWV3KTsKICAgIGNvbnN0IHJvb3RDb21wb25lbnQgPSByb290Q29tcG9uZW50Vmlld1tDT05URVhUXTsKICAgIGlmIChyb290Q29tcG9uZW50ID09PSBjb21wb25lbnRJbnN0YW5jZSkgewogICAgICByZXR1cm4gSEVBREVSX09GRlNFVDsKICAgIH0KICB9CiAgcmV0dXJuIC0xOwp9CmZ1bmN0aW9uIGZpbmRWaWFEaXJlY3RpdmUobFZpZXcsIGRpcmVjdGl2ZUluc3RhbmNlKSB7CiAgbGV0IHROb2RlID0gbFZpZXdbVFZJRVddLmZpcnN0Q2hpbGQ7CiAgd2hpbGUgKHROb2RlKSB7CiAgICBjb25zdCBkaXJlY3RpdmVJbmRleFN0YXJ0ID0gdE5vZGUuZGlyZWN0aXZlU3RhcnQ7CiAgICBjb25zdCBkaXJlY3RpdmVJbmRleEVuZCA9IHROb2RlLmRpcmVjdGl2ZUVuZDsKICAgIGZvciAobGV0IGkgPSBkaXJlY3RpdmVJbmRleFN0YXJ0OyBpIDwgZGlyZWN0aXZlSW5kZXhFbmQ7IGkrKykgewogICAgICBpZiAobFZpZXdbaV0gPT09IGRpcmVjdGl2ZUluc3RhbmNlKSB7CiAgICAgICAgcmV0dXJuIHROb2RlLmluZGV4OwogICAgICB9CiAgICB9CiAgICB0Tm9kZSA9IHRyYXZlcnNlTmV4dEVsZW1lbnQodE5vZGUpOwogIH0KICByZXR1cm4gLTE7Cn0KZnVuY3Rpb24gZ2V0RGlyZWN0aXZlc0F0Tm9kZUluZGV4KG5vZGVJbmRleCwgbFZpZXcpIHsKICBjb25zdCB0Tm9kZSA9IGxWaWV3W1RWSUVXXS5kYXRhW25vZGVJbmRleF07CiAgaWYgKHROb2RlLmRpcmVjdGl2ZVN0YXJ0ID09PSAwKSByZXR1cm4gRU1QVFlfQVJSQVk7CiAgY29uc3QgcmVzdWx0cyA9IFtdOwogIGZvciAobGV0IGkgPSB0Tm9kZS5kaXJlY3RpdmVTdGFydDsgaSA8IHROb2RlLmRpcmVjdGl2ZUVuZDsgaSsrKSB7CiAgICBjb25zdCBkaXJlY3RpdmVJbnN0YW5jZSA9IGxWaWV3W2ldOwogICAgaWYgKCFpc0NvbXBvbmVudEluc3RhbmNlKGRpcmVjdGl2ZUluc3RhbmNlKSkgewogICAgICByZXN1bHRzLnB1c2goZGlyZWN0aXZlSW5zdGFuY2UpOwogICAgfQogIH0KICByZXR1cm4gcmVzdWx0czsKfQpmdW5jdGlvbiBnZXRDb21wb25lbnRBdE5vZGVJbmRleChub2RlSW5kZXgsIGxWaWV3KSB7CiAgY29uc3QgdE5vZGUgPSBsVmlld1tUVklFV10uZGF0YVtub2RlSW5kZXhdOwogIHJldHVybiBpc0NvbXBvbmVudEhvc3QodE5vZGUpID8gbFZpZXdbdE5vZGUuZGlyZWN0aXZlU3RhcnQgKyB0Tm9kZS5jb21wb25lbnRPZmZzZXRdIDogbnVsbDsKfQpmdW5jdGlvbiBkaXNjb3ZlckxvY2FsUmVmcyhsVmlldywgbm9kZUluZGV4KSB7CiAgY29uc3QgdE5vZGUgPSBsVmlld1tUVklFV10uZGF0YVtub2RlSW5kZXhdOwogIGlmICh0Tm9kZSAmJiB0Tm9kZS5sb2NhbE5hbWVzKSB7CiAgICBjb25zdCByZXN1bHQgPSB7fTsKICAgIGxldCBsb2NhbEluZGV4ID0gdE5vZGUuaW5kZXggKyAxOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0Tm9kZS5sb2NhbE5hbWVzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIHJlc3VsdFt0Tm9kZS5sb2NhbE5hbWVzW2ldXSA9IGxWaWV3W2xvY2FsSW5kZXhdOwogICAgICBsb2NhbEluZGV4Kys7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBnZXRSb290Vmlldyhjb21wb25lbnRPckxWaWV3KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoY29tcG9uZW50T3JMVmlldywgImNvbXBvbmVudCIpOwogIGxldCBsVmlldyA9IGlzTFZpZXcoY29tcG9uZW50T3JMVmlldykgPyBjb21wb25lbnRPckxWaWV3IDogcmVhZFBhdGNoZWRMVmlldyhjb21wb25lbnRPckxWaWV3KTsKICB3aGlsZSAobFZpZXcgJiYgIWlzUm9vdFZpZXcobFZpZXcpKSB7CiAgICBsVmlldyA9IGdldExWaWV3UGFyZW50KGxWaWV3KTsKICB9CiAgbmdEZXZNb2RlICYmIGFzc2VydExWaWV3KGxWaWV3KTsKICByZXR1cm4gbFZpZXc7Cn0KZnVuY3Rpb24gZ2V0Um9vdENvbnRleHQodmlld09yQ29tcG9uZW50KSB7CiAgY29uc3Qgcm9vdFZpZXcgPSBnZXRSb290Vmlldyh2aWV3T3JDb21wb25lbnQpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHJvb3RWaWV3W0NPTlRFWFRdLCAiUm9vdCB2aWV3IGhhcyBubyBjb250ZXh0LiBQZXJoYXBzIGl0IGlzIGRpc2Nvbm5lY3RlZD8iKTsKICByZXR1cm4gcm9vdFZpZXdbQ09OVEVYVF07Cn0KZnVuY3Rpb24gZ2V0Rmlyc3RMQ29udGFpbmVyKGxWaWV3KSB7CiAgcmV0dXJuIGdldE5lYXJlc3RMQ29udGFpbmVyKGxWaWV3W0NISUxEX0hFQURdKTsKfQpmdW5jdGlvbiBnZXROZXh0TENvbnRhaW5lcihjb250YWluZXIpIHsKICByZXR1cm4gZ2V0TmVhcmVzdExDb250YWluZXIoY29udGFpbmVyW05FWFRdKTsKfQpmdW5jdGlvbiBnZXROZWFyZXN0TENvbnRhaW5lcih2aWV3T3JDb250YWluZXIpIHsKICB3aGlsZSAodmlld09yQ29udGFpbmVyICE9PSBudWxsICYmICFpc0xDb250YWluZXIodmlld09yQ29udGFpbmVyKSkgewogICAgdmlld09yQ29udGFpbmVyID0gdmlld09yQ29udGFpbmVyW05FWFRdOwogIH0KICByZXR1cm4gdmlld09yQ29udGFpbmVyOwp9CmZ1bmN0aW9uIGdldENvbXBvbmVudChlbGVtZW50KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydERvbUVsZW1lbnQoZWxlbWVudCk7CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dChlbGVtZW50KTsKICBpZiAoY29udGV4dDIgPT09IG51bGwpIHJldHVybiBudWxsOwogIGlmIChjb250ZXh0Mi5jb21wb25lbnQgPT09IHZvaWQgMCkgewogICAgY29uc3QgbFZpZXcgPSBjb250ZXh0Mi5sVmlldzsKICAgIGlmIChsVmlldyA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGNvbnRleHQyLmNvbXBvbmVudCA9IGdldENvbXBvbmVudEF0Tm9kZUluZGV4KGNvbnRleHQyLm5vZGVJbmRleCwgbFZpZXcpOwogIH0KICByZXR1cm4gY29udGV4dDIuY29tcG9uZW50Owp9CmZ1bmN0aW9uIGdldENvbnRleHQoZWxlbWVudCkgewogIGFzc2VydERvbUVsZW1lbnQoZWxlbWVudCk7CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dChlbGVtZW50KTsKICBjb25zdCBsVmlldyA9IGNvbnRleHQyID8gY29udGV4dDIubFZpZXcgOiBudWxsOwogIHJldHVybiBsVmlldyA9PT0gbnVsbCA/IG51bGwgOiBsVmlld1tDT05URVhUXTsKfQpmdW5jdGlvbiBnZXRPd25pbmdDb21wb25lbnQoZWxlbWVudE9yRGlyKSB7CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dChlbGVtZW50T3JEaXIpOwogIGxldCBsVmlldyA9IGNvbnRleHQyID8gY29udGV4dDIubFZpZXcgOiBudWxsOwogIGlmIChsVmlldyA9PT0gbnVsbCkgcmV0dXJuIG51bGw7CiAgbGV0IHBhcmVudDsKICB3aGlsZSAobFZpZXdbVFZJRVddLnR5cGUgPT09IDIgJiYgKHBhcmVudCA9IGdldExWaWV3UGFyZW50KGxWaWV3KSkpIHsKICAgIGxWaWV3ID0gcGFyZW50OwogIH0KICByZXR1cm4gaXNSb290VmlldyhsVmlldykgPyBudWxsIDogbFZpZXdbQ09OVEVYVF07Cn0KZnVuY3Rpb24gZ2V0Um9vdENvbXBvbmVudHMoZWxlbWVudE9yRGlyKSB7CiAgY29uc3QgbFZpZXcgPSByZWFkUGF0Y2hlZExWaWV3KGVsZW1lbnRPckRpcik7CiAgcmV0dXJuIGxWaWV3ICE9PSBudWxsID8gW2dldFJvb3RDb250ZXh0KGxWaWV3KV0gOiBbXTsKfQpmdW5jdGlvbiBnZXRJbmplY3RvcihlbGVtZW50T3JEaXIpIHsKICBjb25zdCBjb250ZXh0MiA9IGdldExDb250ZXh0KGVsZW1lbnRPckRpcik7CiAgY29uc3QgbFZpZXcgPSBjb250ZXh0MiA/IGNvbnRleHQyLmxWaWV3IDogbnVsbDsKICBpZiAobFZpZXcgPT09IG51bGwpIHJldHVybiBJbmplY3Rvci5OVUxMOwogIGNvbnN0IHROb2RlID0gbFZpZXdbVFZJRVddLmRhdGFbY29udGV4dDIubm9kZUluZGV4XTsKICByZXR1cm4gbmV3IE5vZGVJbmplY3Rvcih0Tm9kZSwgbFZpZXcpOwp9CmZ1bmN0aW9uIGdldEluamVjdGlvblRva2VucyhlbGVtZW50KSB7CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dChlbGVtZW50KTsKICBjb25zdCBsVmlldyA9IGNvbnRleHQyID8gY29udGV4dDIubFZpZXcgOiBudWxsOwogIGlmIChsVmlldyA9PT0gbnVsbCkgcmV0dXJuIFtdOwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IHROb2RlID0gdFZpZXcuZGF0YVtjb250ZXh0Mi5ub2RlSW5kZXhdOwogIGNvbnN0IHByb3ZpZGVyVG9rZW5zID0gW107CiAgY29uc3Qgc3RhcnRJbmRleCA9IHROb2RlLnByb3ZpZGVySW5kZXhlcyAmIDEwNDg1NzU7CiAgY29uc3QgZW5kSW5kZXggPSB0Tm9kZS5kaXJlY3RpdmVFbmQ7CiAgZm9yIChsZXQgaSA9IHN0YXJ0SW5kZXg7IGkgPCBlbmRJbmRleDsgaSsrKSB7CiAgICBsZXQgdmFsdWUgPSB0Vmlldy5kYXRhW2ldOwogICAgaWYgKGlzRGlyZWN0aXZlRGVmSGFjayh2YWx1ZSkpIHsKICAgICAgdmFsdWUgPSB2YWx1ZS50eXBlOwogICAgfQogICAgcHJvdmlkZXJUb2tlbnMucHVzaCh2YWx1ZSk7CiAgfQogIHJldHVybiBwcm92aWRlclRva2VuczsKfQpmdW5jdGlvbiBnZXREaXJlY3RpdmVzKG5vZGUpIHsKICBpZiAobm9kZSBpbnN0YW5jZW9mIFRleHQpIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dChub2RlKTsKICBjb25zdCBsVmlldyA9IGNvbnRleHQyID8gY29udGV4dDIubFZpZXcgOiBudWxsOwogIGlmIChsVmlldyA9PT0gbnVsbCkgewogICAgcmV0dXJuIFtdOwogIH0KICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCBub2RlSW5kZXggPSBjb250ZXh0Mi5ub2RlSW5kZXg7CiAgaWYgKCF0Vmlldz8uZGF0YVtub2RlSW5kZXhdKSB7CiAgICByZXR1cm4gW107CiAgfQogIGlmIChjb250ZXh0Mi5kaXJlY3RpdmVzID09PSB2b2lkIDApIHsKICAgIGNvbnRleHQyLmRpcmVjdGl2ZXMgPSBnZXREaXJlY3RpdmVzQXROb2RlSW5kZXgobm9kZUluZGV4LCBsVmlldyk7CiAgfQogIHJldHVybiBjb250ZXh0Mi5kaXJlY3RpdmVzID09PSBudWxsID8gW10gOiBbLi4uY29udGV4dDIuZGlyZWN0aXZlc107Cn0KdmFyIEFjeENoYW5nZURldGVjdGlvblN0cmF0ZWd5OwooZnVuY3Rpb24oQWN4Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kyKSB7CiAgQWN4Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kyW0FjeENoYW5nZURldGVjdGlvblN0cmF0ZWd5MlsiRGVmYXVsdCJdID0gMF0gPSAiRGVmYXVsdCI7CiAgQWN4Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kyW0FjeENoYW5nZURldGVjdGlvblN0cmF0ZWd5MlsiT25QdXNoIl0gPSAxXSA9ICJPblB1c2giOwp9KShBY3hDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSB8fCAoQWN4Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kgPSB7fSkpOwp2YXIgQWN4Vmlld0VuY2Fwc3VsYXRpb247CihmdW5jdGlvbihBY3hWaWV3RW5jYXBzdWxhdGlvbjIpIHsKICBBY3hWaWV3RW5jYXBzdWxhdGlvbjJbQWN4Vmlld0VuY2Fwc3VsYXRpb24yWyJFbXVsYXRlZCJdID0gMF0gPSAiRW11bGF0ZWQiOwogIEFjeFZpZXdFbmNhcHN1bGF0aW9uMltBY3hWaWV3RW5jYXBzdWxhdGlvbjJbIk5vbmUiXSA9IDFdID0gIk5vbmUiOwp9KShBY3hWaWV3RW5jYXBzdWxhdGlvbiB8fCAoQWN4Vmlld0VuY2Fwc3VsYXRpb24gPSB7fSkpOwpmdW5jdGlvbiBnZXREaXJlY3RpdmVNZXRhZGF0YSQxKGRpcmVjdGl2ZU9yQ29tcG9uZW50SW5zdGFuY2UpIHsKICBjb25zdCB7CiAgICBjb25zdHJ1Y3RvcgogIH0gPSBkaXJlY3RpdmVPckNvbXBvbmVudEluc3RhbmNlOwogIGlmICghY29uc3RydWN0b3IpIHsKICAgIHRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGZpbmQgdGhlIGluc3RhbmNlIGNvbnN0cnVjdG9yIik7CiAgfQogIGNvbnN0IGNvbXBvbmVudERlZiA9IGdldENvbXBvbmVudERlZihjb25zdHJ1Y3Rvcik7CiAgaWYgKGNvbXBvbmVudERlZikgewogICAgY29uc3QgaW5wdXRzID0gZXh0cmFjdElucHV0RGVidWdNZXRhZGF0YShjb21wb25lbnREZWYuaW5wdXRzKTsKICAgIHJldHVybiB7CiAgICAgIGlucHV0cywKICAgICAgb3V0cHV0czogY29tcG9uZW50RGVmLm91dHB1dHMsCiAgICAgIGVuY2Fwc3VsYXRpb246IGNvbXBvbmVudERlZi5lbmNhcHN1bGF0aW9uLAogICAgICBjaGFuZ2VEZXRlY3Rpb246IGNvbXBvbmVudERlZi5vblB1c2ggPyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2ggOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5EZWZhdWx0CiAgICB9OwogIH0KICBjb25zdCBkaXJlY3RpdmVEZWYgPSBnZXREaXJlY3RpdmVEZWYoY29uc3RydWN0b3IpOwogIGlmIChkaXJlY3RpdmVEZWYpIHsKICAgIGNvbnN0IGlucHV0cyA9IGV4dHJhY3RJbnB1dERlYnVnTWV0YWRhdGEoZGlyZWN0aXZlRGVmLmlucHV0cyk7CiAgICByZXR1cm4gewogICAgICBpbnB1dHMsCiAgICAgIG91dHB1dHM6IGRpcmVjdGl2ZURlZi5vdXRwdXRzCiAgICB9OwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBnZXRMb2NhbFJlZnModGFyZ2V0KSB7CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dCh0YXJnZXQpOwogIGlmIChjb250ZXh0MiA9PT0gbnVsbCkgcmV0dXJuIHt9OwogIGlmIChjb250ZXh0Mi5sb2NhbFJlZnMgPT09IHZvaWQgMCkgewogICAgY29uc3QgbFZpZXcgPSBjb250ZXh0Mi5sVmlldzsKICAgIGlmIChsVmlldyA9PT0gbnVsbCkgewogICAgICByZXR1cm4ge307CiAgICB9CiAgICBjb250ZXh0Mi5sb2NhbFJlZnMgPSBkaXNjb3ZlckxvY2FsUmVmcyhsVmlldywgY29udGV4dDIubm9kZUluZGV4KTsKICB9CiAgcmV0dXJuIGNvbnRleHQyLmxvY2FsUmVmcyB8fCB7fTsKfQpmdW5jdGlvbiBnZXRIb3N0RWxlbWVudChjb21wb25lbnRPckRpcmVjdGl2ZSkgewogIHJldHVybiBnZXRMQ29udGV4dChjb21wb25lbnRPckRpcmVjdGl2ZSkubmF0aXZlOwp9CmZ1bmN0aW9uIGdldExpc3RlbmVycyhlbGVtZW50KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydERvbUVsZW1lbnQoZWxlbWVudCk7CiAgY29uc3QgbENvbnRleHQgPSBnZXRMQ29udGV4dChlbGVtZW50KTsKICBjb25zdCBsVmlldyA9IGxDb250ZXh0ID09PSBudWxsID8gbnVsbCA6IGxDb250ZXh0LmxWaWV3OwogIGlmIChsVmlldyA9PT0gbnVsbCkgcmV0dXJuIFtdOwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IGxDbGVhbnVwID0gbFZpZXdbQ0xFQU5VUF07CiAgY29uc3QgdENsZWFudXAgPSB0Vmlldy5jbGVhbnVwOwogIGNvbnN0IGxpc3RlbmVycyA9IFtdOwogIGlmICh0Q2xlYW51cCAmJiBsQ2xlYW51cCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0Q2xlYW51cC5sZW5ndGg7ICkgewogICAgICBjb25zdCBmaXJzdFBhcmFtID0gdENsZWFudXBbaSsrXTsKICAgICAgY29uc3Qgc2Vjb25kUGFyYW0gPSB0Q2xlYW51cFtpKytdOwogICAgICBpZiAodHlwZW9mIGZpcnN0UGFyYW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgY29uc3QgbmFtZSA9IGZpcnN0UGFyYW07CiAgICAgICAgY29uc3QgbGlzdGVuZXJFbGVtZW50ID0gdW53cmFwUk5vZGUobFZpZXdbc2Vjb25kUGFyYW1dKTsKICAgICAgICBjb25zdCBjYWxsYmFjayA9IGxDbGVhbnVwW3RDbGVhbnVwW2krK11dOwogICAgICAgIGNvbnN0IHVzZUNhcHR1cmVPckluZHggPSB0Q2xlYW51cFtpKytdOwogICAgICAgIGNvbnN0IHR5cGUgPSB0eXBlb2YgdXNlQ2FwdHVyZU9ySW5keCA9PT0gImJvb2xlYW4iIHx8IHVzZUNhcHR1cmVPckluZHggPj0gMCA/ICJkb20iIDogIm91dHB1dCI7CiAgICAgICAgY29uc3QgdXNlQ2FwdHVyZSA9IHR5cGVvZiB1c2VDYXB0dXJlT3JJbmR4ID09PSAiYm9vbGVhbiIgPyB1c2VDYXB0dXJlT3JJbmR4IDogZmFsc2U7CiAgICAgICAgaWYgKGVsZW1lbnQgPT0gbGlzdGVuZXJFbGVtZW50KSB7CiAgICAgICAgICBsaXN0ZW5lcnMucHVzaCh7CiAgICAgICAgICAgIGVsZW1lbnQsCiAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgIGNhbGxiYWNrLAogICAgICAgICAgICB1c2VDYXB0dXJlLAogICAgICAgICAgICB0eXBlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgbGlzdGVuZXJzLnNvcnQoc29ydExpc3RlbmVycyk7CiAgcmV0dXJuIGxpc3RlbmVyczsKfQpmdW5jdGlvbiBzb3J0TGlzdGVuZXJzKGEsIGIpIHsKICBpZiAoYS5uYW1lID09IGIubmFtZSkgcmV0dXJuIDA7CiAgcmV0dXJuIGEubmFtZSA8IGIubmFtZSA/IC0xIDogMTsKfQpmdW5jdGlvbiBpc0RpcmVjdGl2ZURlZkhhY2sob2JqKSB7CiAgcmV0dXJuIG9iai50eXBlICE9PSB2b2lkIDAgJiYgb2JqLmRlY2xhcmVkSW5wdXRzICE9PSB2b2lkIDAgJiYgb2JqLnJlc29sdmVIb3N0RGlyZWN0aXZlcyAhPT0gdm9pZCAwOwp9CmZ1bmN0aW9uIGFzc2VydERvbUVsZW1lbnQodmFsdWUpIHsKICBpZiAodHlwZW9mIEVsZW1lbnQgIT09ICJ1bmRlZmluZWQiICYmICEodmFsdWUgaW5zdGFuY2VvZiBFbGVtZW50KSkgewogICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RpbmcgaW5zdGFuY2Ugb2YgRE9NIEVsZW1lbnQiKTsKICB9Cn0KZnVuY3Rpb24gZXh0cmFjdElucHV0RGVidWdNZXRhZGF0YShpbnB1dHMpIHsKICBjb25zdCByZXMgPSB7fTsKICBmb3IgKGNvbnN0IGtleSBpbiBpbnB1dHMpIHsKICAgIGlmIChpbnB1dHMuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICBjb25zdCB2YWx1ZSA9IGlucHV0c1trZXldOwogICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCkgewogICAgICAgIHJlc1trZXldID0gdmFsdWVbMF07CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHJlczsKfQp2YXIgRE9DVU1FTlQyID0gdm9pZCAwOwpmdW5jdGlvbiBzZXREb2N1bWVudChkb2N1bWVudDIpIHsKICBET0NVTUVOVDIgPSBkb2N1bWVudDI7Cn0KZnVuY3Rpb24gZ2V0RG9jdW1lbnQoKSB7CiAgaWYgKERPQ1VNRU5UMiAhPT0gdm9pZCAwKSB7CiAgICByZXR1cm4gRE9DVU1FTlQyOwogIH0gZWxzZSBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAidW5kZWZpbmVkIikgewogICAgcmV0dXJuIGRvY3VtZW50OwogIH0KICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDIxMCwgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgYFRoZSBkb2N1bWVudCBvYmplY3QgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGNvbnRleHQuIE1ha2Ugc3VyZSB0aGUgRE9DVU1FTlQgaW5qZWN0aW9uIHRva2VuIGlzIHByb3ZpZGVkLmApOwp9CnZhciBBUFBfSUQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkFwcElkIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gREVGQVVMVF9BUFBfSUQKfSk7CnZhciBERUZBVUxUX0FQUF9JRCA9ICJuZyI7CnZhciB2YWxpZEFwcElkSW5pdGlhbGl6ZXIgPSB7CiAgcHJvdmlkZTogRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsCiAgbXVsdGk6IHRydWUsCiAgdXNlVmFsdWU6ICgpID0+IHsKICAgIGNvbnN0IGFwcElkID0gaW5qZWN0MihBUFBfSUQpOwogICAgY29uc3QgaXNBbHBoYW51bWVyaWMgPSAvXlthLXpBLVowLTlcLV9dKyQvLnRlc3QoYXBwSWQpOwogICAgaWYgKCFpc0FscGhhbnVtZXJpYykgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDIxMSwgYEFQUF9JRCB2YWx1ZSAiJHthcHBJZH0iIGlzIG5vdCBhbHBoYW51bWVyaWMuIFRoZSBBUFBfSUQgbXVzdCBiZSBhIHN0cmluZyBvZiBhbHBoYW51bWVyaWMgY2hhcmFjdGVycy4gKGEtekEtWjAtOSksIGh5cGhlbnMgKC0pIGFuZCB1bmRlcnNjb3JlcyAoXykgYXJlIGFsbG93ZWQuYCk7CiAgICB9CiAgfQp9Owp2YXIgUExBVEZPUk1fSU5JVElBTElaRVIgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIlBsYXRmb3JtIEluaXRpYWxpemVyIiA6ICIiKTsKdmFyIFBMQVRGT1JNX0lEID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJQbGF0Zm9ybSBJRCIgOiAiIiwgewogIHByb3ZpZGVkSW46ICJwbGF0Zm9ybSIsCiAgZmFjdG9yeTogKCkgPT4gInVua25vd24iCn0pOwp2YXIgQU5JTUFUSU9OX01PRFVMRV9UWVBFID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJBbmltYXRpb25Nb2R1bGVUeXBlIiA6ICIiKTsKdmFyIENTUF9OT05DRSA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiQ1NQIG5vbmNlIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gewogICAgcmV0dXJuIGluamVjdDIoRE9DVU1FTlQpLmJvZHk/LnF1ZXJ5U2VsZWN0b3IoIltuZ0NzcE5vbmNlXSIpPy5nZXRBdHRyaWJ1dGUoIm5nQ3NwTm9uY2UiKSB8fCBudWxsOwogIH0KfSk7CnZhciBJTUFHRV9DT05GSUdfREVGQVVMVFMgPSB7CiAgYnJlYWtwb2ludHM6IFsxNiwgMzIsIDQ4LCA2NCwgOTYsIDEyOCwgMjU2LCAzODQsIDY0MCwgNzUwLCA4MjgsIDEwODAsIDEyMDAsIDE5MjAsIDIwNDgsIDM4NDBdLAogIHBsYWNlaG9sZGVyUmVzb2x1dGlvbjogMzAsCiAgZGlzYWJsZUltYWdlU2l6ZVdhcm5pbmc6IGZhbHNlLAogIGRpc2FibGVJbWFnZUxhenlMb2FkV2FybmluZzogZmFsc2UKfTsKdmFyIElNQUdFX0NPTkZJRyA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiSW1hZ2VDb25maWciIDogIiIsIHsKICBmYWN0b3J5OiAoKSA9PiBJTUFHRV9DT05GSUdfREVGQVVMVFMKfSk7CmZ1bmN0aW9uIG1ha2VTdGF0ZUtleShrZXkpIHsKICByZXR1cm4ga2V5Owp9CnZhciBUcmFuc2ZlclN0YXRlID0gY2xhc3MgX1RyYW5zZmVyU3RhdGUgewogIHN0YXRpYyDJtXByb3YgPSDJtcm1ZGVmaW5lSW5qZWN0YWJsZSh7CiAgICB0b2tlbjogX1RyYW5zZmVyU3RhdGUsCiAgICBwcm92aWRlZEluOiAicm9vdCIsCiAgICBmYWN0b3J5OiAoKSA9PiB7CiAgICAgIGNvbnN0IHRyYW5zZmVyU3RhdGUgPSBuZXcgX1RyYW5zZmVyU3RhdGUoKTsKICAgICAgaWYgKHRydWUpIHsKICAgICAgICB0cmFuc2ZlclN0YXRlLnN0b3JlID0gcmV0cmlldmVUcmFuc2ZlcnJlZFN0YXRlKGluamVjdDIoRE9DVU1FTlQpLCBpbmplY3QyKEFQUF9JRCkpOwogICAgICB9CiAgICAgIHJldHVybiB0cmFuc2ZlclN0YXRlOwogICAgfQogIH0pOwogIHN0b3JlID0ge307CiAgb25TZXJpYWxpemVDYWxsYmFja3MgPSB7fTsKICBnZXQoa2V5LCBkZWZhdWx0VmFsdWUpIHsKICAgIHJldHVybiB0aGlzLnN0b3JlW2tleV0gIT09IHZvaWQgMCA/IHRoaXMuc3RvcmVba2V5XSA6IGRlZmF1bHRWYWx1ZTsKICB9CiAgc2V0KGtleSwgdmFsdWUpIHsKICAgIHRoaXMuc3RvcmVba2V5XSA9IHZhbHVlOwogIH0KICByZW1vdmUoa2V5KSB7CiAgICBkZWxldGUgdGhpcy5zdG9yZVtrZXldOwogIH0KICBoYXNLZXkoa2V5KSB7CiAgICByZXR1cm4gdGhpcy5zdG9yZS5oYXNPd25Qcm9wZXJ0eShrZXkpOwogIH0KICBnZXQgaXNFbXB0eSgpIHsKICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnN0b3JlKS5sZW5ndGggPT09IDA7CiAgfQogIG9uU2VyaWFsaXplKGtleSwgY2FsbGJhY2spIHsKICAgIHRoaXMub25TZXJpYWxpemVDYWxsYmFja3Nba2V5XSA9IGNhbGxiYWNrOwogIH0KICB0b0pzb24oKSB7CiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLm9uU2VyaWFsaXplQ2FsbGJhY2tzKSB7CiAgICAgIGlmICh0aGlzLm9uU2VyaWFsaXplQ2FsbGJhY2tzLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5zdG9yZVtrZXldID0gdGhpcy5vblNlcmlhbGl6ZUNhbGxiYWNrc1trZXldKCk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgY29uc29sZS53YXJuKCJFeGNlcHRpb24gaW4gb25TZXJpYWxpemUgY2FsbGJhY2s6ICIsIGUpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMuc3RvcmUpLnJlcGxhY2UoLzwvZywgIlxcdTAwM0MiKTsKICB9Cn07CmZ1bmN0aW9uIHJldHJpZXZlVHJhbnNmZXJyZWRTdGF0ZShkb2MsIGFwcElkKSB7CiAgY29uc3Qgc2NyaXB0ID0gZG9jLmdldEVsZW1lbnRCeUlkKGFwcElkICsgIi1zdGF0ZSIpOwogIGlmIChzY3JpcHQ/LnRleHRDb250ZW50KSB7CiAgICB0cnkgewogICAgICByZXR1cm4gSlNPTi5wYXJzZShzY3JpcHQudGV4dENvbnRlbnQpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zb2xlLndhcm4oIkV4Y2VwdGlvbiB3aGlsZSByZXN0b3JpbmcgVHJhbnNmZXJTdGF0ZSBmb3IgYXBwICIgKyBhcHBJZCwgZSk7CiAgICB9CiAgfQogIHJldHVybiB7fTsKfQp2YXIgUkVGRVJFTkNFX05PREVfSE9TVCA9ICJoIjsKdmFyIFJFRkVSRU5DRV9OT0RFX0JPRFkgPSAiYiI7CnZhciBOT0RFX05BVklHQVRJT05fU1RFUF9GSVJTVF9DSElMRCA9ICJmIjsKdmFyIE5PREVfTkFWSUdBVElPTl9TVEVQX05FWFRfU0lCTElORyA9ICJuIjsKdmFyIEVMRU1FTlRfQ09OVEFJTkVSUyA9ICJlIjsKdmFyIFRFTVBMQVRFUyA9ICJ0IjsKdmFyIENPTlRBSU5FUlMgPSAiYyI7CnZhciBNVUxUSVBMSUVSID0gIngiOwp2YXIgTlVNX1JPT1RfTk9ERVMgPSAiciI7CnZhciBURU1QTEFURV9JRCA9ICJpIjsKdmFyIE5PREVTID0gIm4iOwp2YXIgRElTQ09OTkVDVEVEX05PREVTID0gImQiOwp2YXIgSTE4Tl9EQVRBID0gImwiOwp2YXIgREVGRVJfQkxPQ0tfSUQgPSAiZGkiOwp2YXIgREVGRVJfQkxPQ0tfU1RBVEUkMSA9ICJzIjsKdmFyIERFRkVSX1BBUkVOVF9CTE9DS19JRCA9ICJwIjsKdmFyIERFRkVSX0hZRFJBVEVfVFJJR0dFUlMgPSAidCI7CnZhciBJU19IWURSQVRJT05fRE9NX1JFVVNFX0VOQUJMRUQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIklTX0hZRFJBVElPTl9ET01fUkVVU0VfRU5BQkxFRCIgOiAiIik7CnZhciBQUkVTRVJWRV9IT1NUX0NPTlRFTlRfREVGQVVMVCA9IGZhbHNlOwp2YXIgUFJFU0VSVkVfSE9TVF9DT05URU5UID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSA/ICJQUkVTRVJWRV9IT1NUX0NPTlRFTlQiIDogIiIsIHsKICBmYWN0b3J5OiAoKSA9PiBQUkVTRVJWRV9IT1NUX0NPTlRFTlRfREVGQVVMVAp9KTsKdmFyIElTX0kxOE5fSFlEUkFUSU9OX0VOQUJMRUQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIklTX0kxOE5fSFlEUkFUSU9OX0VOQUJMRUQiIDogIiIpOwp2YXIgSVNfRVZFTlRfUkVQTEFZX0VOQUJMRUQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIklTX0VWRU5UX1JFUExBWV9FTkFCTEVEIiA6ICIiKTsKdmFyIEVWRU5UX1JFUExBWV9FTkFCTEVEX0RFRkFVTFQgPSBmYWxzZTsKdmFyIEVWRU5UX1JFUExBWV9RVUVVRSA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiRVZFTlRfUkVQTEFZX1FVRVVFIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gW10KfSk7CnZhciBJU19JTkNSRU1FTlRBTF9IWURSQVRJT05fRU5BQkxFRCA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUgPyAiSVNfSU5DUkVNRU5UQUxfSFlEUkFUSU9OX0VOQUJMRUQiIDogIiIpOwp2YXIgSlNBQ1RJT05fQkxPQ0tfRUxFTUVOVF9NQVAgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkpTQUNUSU9OX0JMT0NLX0VMRU1FTlRfTUFQIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKQp9KTsKdmFyIElTX0VOQUJMRURfQkxPQ0tJTkdfSU5JVElBTF9OQVZJR0FUSU9OID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSA/ICJJU19FTkFCTEVEX0JMT0NLSU5HX0lOSVRJQUxfTkFWSUdBVElPTiIgOiAiIik7CnZhciBldmVudExpc3RlbmVyT3B0aW9ucyA9IHsKICBwYXNzaXZlOiB0cnVlLAogIGNhcHR1cmU6IHRydWUKfTsKdmFyIGhvdmVyVHJpZ2dlcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKdmFyIGludGVyYWN0aW9uVHJpZ2dlcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKdmFyIHZpZXdwb3J0VHJpZ2dlcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKdmFyIGludGVyYWN0aW9uRXZlbnROYW1lcyA9IFsiY2xpY2siLCAia2V5ZG93biJdOwp2YXIgaG92ZXJFdmVudE5hbWVzID0gWyJtb3VzZWVudGVyIiwgIm1vdXNlb3ZlciIsICJmb2N1c2luIl07CnZhciBpbnRlcnNlY3Rpb25PYnNlcnZlcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwp2YXIgRGVmZXJFdmVudEVudHJ5ID0gY2xhc3MgewogIGNhbGxiYWNrcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgbGlzdGVuZXIgPSAoKSA9PiB7CiAgICBmb3IgKGNvbnN0IGNhbGxiYWNrIG9mIHRoaXMuY2FsbGJhY2tzKSB7CiAgICAgIGNhbGxiYWNrKCk7CiAgICB9CiAgfTsKfTsKZnVuY3Rpb24gb25JbnRlcmFjdGlvbih0cmlnZ2VyLCBjYWxsYmFjaykgewogIGxldCBlbnRyeSA9IGludGVyYWN0aW9uVHJpZ2dlcnMuZ2V0KHRyaWdnZXIpOwogIGlmICghZW50cnkpIHsKICAgIGVudHJ5ID0gbmV3IERlZmVyRXZlbnRFbnRyeSgpOwogICAgaW50ZXJhY3Rpb25UcmlnZ2Vycy5zZXQodHJpZ2dlciwgZW50cnkpOwogICAgZm9yIChjb25zdCBuYW1lIG9mIGludGVyYWN0aW9uRXZlbnROYW1lcykgewogICAgICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZW50cnkubGlzdGVuZXIsIGV2ZW50TGlzdGVuZXJPcHRpb25zKTsKICAgIH0KICB9CiAgZW50cnkuY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7CiAgcmV0dXJuICgpID0+IHsKICAgIGNvbnN0IHsKICAgICAgY2FsbGJhY2tzLAogICAgICBsaXN0ZW5lcgogICAgfSA9IGVudHJ5OwogICAgY2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7CiAgICBpZiAoY2FsbGJhY2tzLnNpemUgPT09IDApIHsKICAgICAgaW50ZXJhY3Rpb25UcmlnZ2Vycy5kZWxldGUodHJpZ2dlcik7CiAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBpbnRlcmFjdGlvbkV2ZW50TmFtZXMpIHsKICAgICAgICB0cmlnZ2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgbGlzdGVuZXIsIGV2ZW50TGlzdGVuZXJPcHRpb25zKTsKICAgICAgfQogICAgfQogIH07Cn0KZnVuY3Rpb24gb25Ib3Zlcih0cmlnZ2VyLCBjYWxsYmFjaykgewogIGxldCBlbnRyeSA9IGhvdmVyVHJpZ2dlcnMuZ2V0KHRyaWdnZXIpOwogIGlmICghZW50cnkpIHsKICAgIGVudHJ5ID0gbmV3IERlZmVyRXZlbnRFbnRyeSgpOwogICAgaG92ZXJUcmlnZ2Vycy5zZXQodHJpZ2dlciwgZW50cnkpOwogICAgZm9yIChjb25zdCBuYW1lIG9mIGhvdmVyRXZlbnROYW1lcykgewogICAgICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZW50cnkubGlzdGVuZXIsIGV2ZW50TGlzdGVuZXJPcHRpb25zKTsKICAgIH0KICB9CiAgZW50cnkuY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7CiAgcmV0dXJuICgpID0+IHsKICAgIGNvbnN0IHsKICAgICAgY2FsbGJhY2tzLAogICAgICBsaXN0ZW5lcgogICAgfSA9IGVudHJ5OwogICAgY2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7CiAgICBpZiAoY2FsbGJhY2tzLnNpemUgPT09IDApIHsKICAgICAgZm9yIChjb25zdCBuYW1lIG9mIGhvdmVyRXZlbnROYW1lcykgewogICAgICAgIHRyaWdnZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBsaXN0ZW5lciwgZXZlbnRMaXN0ZW5lck9wdGlvbnMpOwogICAgICB9CiAgICAgIGhvdmVyVHJpZ2dlcnMuZGVsZXRlKHRyaWdnZXIpOwogICAgfQogIH07Cn0KZnVuY3Rpb24gY3JlYXRlSW50ZXJzZWN0aW9uT2JzZXJ2ZXIob3B0aW9ucykgewogIGNvbnN0IGtleSA9IGdldEludGVyc2VjdGlvbk9ic2VydmVyS2V5KG9wdGlvbnMpOwogIHJldHVybiBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHsKICAgIGZvciAoY29uc3QgY3VycmVudCBvZiBlbnRyaWVzKSB7CiAgICAgIGlmIChjdXJyZW50LmlzSW50ZXJzZWN0aW5nICYmIHZpZXdwb3J0VHJpZ2dlcnMuaGFzKGN1cnJlbnQudGFyZ2V0KSkgewogICAgICAgIHZpZXdwb3J0VHJpZ2dlcnMuZ2V0KGN1cnJlbnQudGFyZ2V0KT8uZ2V0KGtleSk/Lmxpc3RlbmVyKCk7CiAgICAgIH0KICAgIH0KICB9LCBvcHRpb25zKTsKfQpmdW5jdGlvbiBvblZpZXdwb3J0KHRyaWdnZXIsIGNhbGxiYWNrLCBvYnNlcnZlckZhY3RvcnlGbiwgb3B0aW9ucykgewogIGNvbnN0IGtleSA9IGdldEludGVyc2VjdGlvbk9ic2VydmVyS2V5KG9wdGlvbnMpOwogIGxldCBlbnRyeSA9IHZpZXdwb3J0VHJpZ2dlcnMuZ2V0KHRyaWdnZXIpPy5nZXQoa2V5KTsKICBpZiAoIWludGVyc2VjdGlvbk9ic2VydmVycy5oYXMoa2V5KSkgewogICAgaW50ZXJzZWN0aW9uT2JzZXJ2ZXJzLnNldChrZXksIHsKICAgICAgb2JzZXJ2ZXI6IG9ic2VydmVyRmFjdG9yeUZuKG9wdGlvbnMpLAogICAgICBjb3VudDogMAogICAgfSk7CiAgfQogIGNvbnN0IGNvbmZpZzIgPSBpbnRlcnNlY3Rpb25PYnNlcnZlcnMuZ2V0KGtleSk7CiAgaWYgKCFlbnRyeSkgewogICAgZW50cnkgPSBuZXcgRGVmZXJFdmVudEVudHJ5KCk7CiAgICBjb25maWcyLm9ic2VydmVyLm9ic2VydmUodHJpZ2dlcik7CiAgICBsZXQgdHJpZ2dlckNvbmZpZyA9IHZpZXdwb3J0VHJpZ2dlcnMuZ2V0KHRyaWdnZXIpOwogICAgaWYgKHRyaWdnZXJDb25maWcpIHsKICAgICAgdHJpZ2dlckNvbmZpZy5zZXQoa2V5LCBlbnRyeSk7CiAgICB9IGVsc2UgewogICAgICB0cmlnZ2VyQ29uZmlnID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgdmlld3BvcnRUcmlnZ2Vycy5zZXQodHJpZ2dlciwgdHJpZ2dlckNvbmZpZyk7CiAgICB9CiAgICB0cmlnZ2VyQ29uZmlnLnNldChrZXksIGVudHJ5KTsKICAgIGNvbmZpZzIuY291bnQrKzsKICB9CiAgZW50cnkuY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7CiAgcmV0dXJuICgpID0+IHsKICAgIGlmICghdmlld3BvcnRUcmlnZ2Vycy5nZXQodHJpZ2dlcik/LmhhcyhrZXkpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGVudHJ5LmNhbGxiYWNrcy5kZWxldGUoY2FsbGJhY2spOwogICAgaWYgKGVudHJ5LmNhbGxiYWNrcy5zaXplID09PSAwKSB7CiAgICAgIGNvbmZpZzIub2JzZXJ2ZXIudW5vYnNlcnZlKHRyaWdnZXIpOwogICAgICBjb25maWcyLmNvdW50LS07CiAgICAgIGNvbnN0IHRyaWdnZXJDb25maWcgPSB2aWV3cG9ydFRyaWdnZXJzLmdldCh0cmlnZ2VyKTsKICAgICAgaWYgKHRyaWdnZXJDb25maWcpIHsKICAgICAgICB0cmlnZ2VyQ29uZmlnLmRlbGV0ZShrZXkpOwogICAgICAgIGlmICh0cmlnZ2VyQ29uZmlnLnNpemUgPT09IDApIHsKICAgICAgICAgIHZpZXdwb3J0VHJpZ2dlcnMuZGVsZXRlKHRyaWdnZXIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKGNvbmZpZzIuY291bnQgPT09IDApIHsKICAgICAgY29uZmlnMi5vYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICAgIGludGVyc2VjdGlvbk9ic2VydmVycy5kZWxldGUoa2V5KTsKICAgIH0KICB9Owp9CmZ1bmN0aW9uIGdldEludGVyc2VjdGlvbk9ic2VydmVyS2V5KG9wdGlvbnMpIHsKICBpZiAoIW9wdGlvbnMpIHsKICAgIHJldHVybiAiIjsKICB9CiAgcmV0dXJuIGAke29wdGlvbnMucm9vdE1hcmdpbn0vJHt0eXBlb2Ygb3B0aW9ucy50aHJlc2hvbGQgPT09ICJudW1iZXIiID8gb3B0aW9ucy50aHJlc2hvbGQgOiBvcHRpb25zLnRocmVzaG9sZD8uam9pbigiXG4iKX1gOwp9CnZhciBERUZFUl9CTE9DS19TU1JfSURfQVRUUklCVVRFID0gIm5nYiI7CmZ1bmN0aW9uIHNldEpTQWN0aW9uQXR0cmlidXRlcyhuYXRpdmVFbGVtZW50LCBldmVudFR5cGVzLCBwYXJlbnREZWZlckJsb2NrSWQgPSBudWxsKSB7CiAgaWYgKGV2ZW50VHlwZXMubGVuZ3RoID09PSAwIHx8IG5hdGl2ZUVsZW1lbnQubm9kZVR5cGUgIT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IGV4aXN0aW5nQXR0ciA9IG5hdGl2ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKEF0dHJpYnV0ZS5KU0FDVElPTik7CiAgY29uc3QgcGFydHMgPSBldmVudFR5cGVzLnJlZHVjZSgocHJldiwgY3VycikgPT4gewogICAgcmV0dXJuIChleGlzdGluZ0F0dHI/LmluZGV4T2YoY3VycikgPz8gLTEpID09PSAtMSA/IHByZXYgKyBjdXJyICsgIjo7IiA6IHByZXY7CiAgfSwgIiIpOwogIG5hdGl2ZUVsZW1lbnQuc2V0QXR0cmlidXRlKEF0dHJpYnV0ZS5KU0FDVElPTiwgYCR7ZXhpc3RpbmdBdHRyID8/ICIifSR7cGFydHN9YCk7CiAgY29uc3QgYmxvY2tOYW1lID0gcGFyZW50RGVmZXJCbG9ja0lkID8/ICIiOwogIGlmIChibG9ja05hbWUgIT09ICIiICYmIHBhcnRzLmxlbmd0aCA+IDApIHsKICAgIG5hdGl2ZUVsZW1lbnQuc2V0QXR0cmlidXRlKERFRkVSX0JMT0NLX1NTUl9JRF9BVFRSSUJVVEUsIGJsb2NrTmFtZSk7CiAgfQp9CnZhciBzaGFyZWRTdGFzaEZ1bmN0aW9uID0gKHJFbCwgZXZlbnRUeXBlLCBsaXN0ZW5lckZuKSA9PiB7CiAgY29uc3QgZWwgPSByRWw7CiAgY29uc3QgZXZlbnRMaXN0ZW5lck1hcCA9IGVsLl9fanNhY3Rpb25fZm5zID8/IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgZXZlbnRMaXN0ZW5lcnMgPSBldmVudExpc3RlbmVyTWFwLmdldChldmVudFR5cGUpID8/IFtdOwogIGV2ZW50TGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbik7CiAgZXZlbnRMaXN0ZW5lck1hcC5zZXQoZXZlbnRUeXBlLCBldmVudExpc3RlbmVycyk7CiAgZWwuX19qc2FjdGlvbl9mbnMgPSBldmVudExpc3RlbmVyTWFwOwp9Owp2YXIgc2hhcmVkTWFwRnVuY3Rpb24gPSAockVsLCBqc0FjdGlvbk1hcCkgPT4gewogIGNvbnN0IGVsID0gckVsOwogIGxldCBibG9ja05hbWUgPSBlbC5nZXRBdHRyaWJ1dGUoREVGRVJfQkxPQ0tfU1NSX0lEX0FUVFJJQlVURSkgPz8gIiI7CiAgY29uc3QgYmxvY2tTZXQgPSBqc0FjdGlvbk1hcC5nZXQoYmxvY2tOYW1lKSA/PyAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwogIGlmICghYmxvY2tTZXQuaGFzKGVsKSkgewogICAgYmxvY2tTZXQuYWRkKGVsKTsKICB9CiAganNBY3Rpb25NYXAuc2V0KGJsb2NrTmFtZSwgYmxvY2tTZXQpOwp9OwpmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcnNGcm9tQmxvY2tzKGJsb2NrTmFtZXMsIGpzQWN0aW9uTWFwKSB7CiAgaWYgKGJsb2NrTmFtZXMubGVuZ3RoID4gMCkgewogICAgbGV0IGJsb2NrTGlzdCA9IFtdOwogICAgZm9yIChsZXQgYmxvY2tOYW1lIG9mIGJsb2NrTmFtZXMpIHsKICAgICAgaWYgKGpzQWN0aW9uTWFwLmhhcyhibG9ja05hbWUpKSB7CiAgICAgICAgYmxvY2tMaXN0ID0gWy4uLmJsb2NrTGlzdCwgLi4uanNBY3Rpb25NYXAuZ2V0KGJsb2NrTmFtZSldOwogICAgICB9CiAgICB9CiAgICBjb25zdCByZXBsYXlMaXN0ID0gbmV3IFNldChibG9ja0xpc3QpOwogICAgcmVwbGF5TGlzdC5mb3JFYWNoKHJlbW92ZUxpc3RlbmVycyk7CiAgfQp9CnZhciByZW1vdmVMaXN0ZW5lcnMgPSAoZWwpID0+IHsKICBlbC5yZW1vdmVBdHRyaWJ1dGUoQXR0cmlidXRlLkpTQUNUSU9OKTsKICBlbC5yZW1vdmVBdHRyaWJ1dGUoREVGRVJfQkxPQ0tfU1NSX0lEX0FUVFJJQlVURSk7CiAgZWwuX19qc2FjdGlvbl9mbnMgPSB2b2lkIDA7Cn07CnZhciBKU0FDVElPTl9FVkVOVF9DT05UUkFDVCA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiRVZFTlRfQ09OVFJBQ1RfREVUQUlMUyIgOiAiIiwgewogIGZhY3Rvcnk6ICgpID0+ICh7fSkKfSk7CmZ1bmN0aW9uIGludm9rZUxpc3RlbmVycyhldmVudCwgY3VycmVudFRhcmdldCkgewogIGNvbnN0IGhhbmRsZXJGbnMgPSBjdXJyZW50VGFyZ2V0Py5fX2pzYWN0aW9uX2Zucz8uZ2V0KGV2ZW50LnR5cGUpOwogIGlmICghaGFuZGxlckZucyB8fCAhY3VycmVudFRhcmdldD8uaXNDb25uZWN0ZWQpIHsKICAgIHJldHVybjsKICB9CiAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJGbnMpIHsKICAgIGhhbmRsZXIoZXZlbnQpOwogIH0KfQp2YXIgc3Rhc2hFdmVudExpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CmZ1bmN0aW9uIHNldFN0YXNoRm4oYXBwSWQsIGZuKSB7CiAgc3Rhc2hFdmVudExpc3RlbmVycy5zZXQoYXBwSWQsIGZuKTsKICByZXR1cm4gKCkgPT4gc3Rhc2hFdmVudExpc3RlbmVycy5kZWxldGUoYXBwSWQpOwp9CnZhciBpc1N0YXNoRXZlbnRMaXN0ZW5lckltcGxFbmFibGVkID0gZmFsc2U7CnZhciBfc3Rhc2hFdmVudExpc3RlbmVySW1wbCA9IChsVmlldywgdGFyZ2V0LCBldmVudE5hbWUsIHdyYXBwZWRMaXN0ZW5lcikgPT4gewp9OwpmdW5jdGlvbiBzdGFzaEV2ZW50TGlzdGVuZXJJbXBsKGxWaWV3LCB0YXJnZXQsIGV2ZW50TmFtZSwgd3JhcHBlZExpc3RlbmVyKSB7CiAgX3N0YXNoRXZlbnRMaXN0ZW5lckltcGwobFZpZXcsIHRhcmdldCwgZXZlbnROYW1lLCB3cmFwcGVkTGlzdGVuZXIpOwp9CmZ1bmN0aW9uIGVuYWJsZVN0YXNoRXZlbnRMaXN0ZW5lckltcGwoKSB7CiAgaWYgKCFpc1N0YXNoRXZlbnRMaXN0ZW5lckltcGxFbmFibGVkKSB7CiAgICBfc3Rhc2hFdmVudExpc3RlbmVySW1wbCA9IChsVmlldywgdGFyZ2V0LCBldmVudE5hbWUsIHdyYXBwZWRMaXN0ZW5lcikgPT4gewogICAgICBjb25zdCBhcHBJZCA9IGxWaWV3W0lOSkVDVE9SXS5nZXQoQVBQX0lEKTsKICAgICAgY29uc3Qgc3Rhc2hFdmVudExpc3RlbmVyID0gc3Rhc2hFdmVudExpc3RlbmVycy5nZXQoYXBwSWQpOwogICAgICBzdGFzaEV2ZW50TGlzdGVuZXI/Lih0YXJnZXQsIGV2ZW50TmFtZSwgd3JhcHBlZExpc3RlbmVyKTsKICAgIH07CiAgICBpc1N0YXNoRXZlbnRMaXN0ZW5lckltcGxFbmFibGVkID0gdHJ1ZTsKICB9Cn0KdmFyIERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlkgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkRFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlkiIDogIiIpOwp2YXIgRGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkgPSBjbGFzcyBfRGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkgewogIHJlZ2lzdHJ5ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBjbGVhbnVwRm5zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBqc0FjdGlvbk1hcCA9IGluamVjdDIoSlNBQ1RJT05fQkxPQ0tfRUxFTUVOVF9NQVApOwogIGNvbnRyYWN0ID0gaW5qZWN0MihKU0FDVElPTl9FVkVOVF9DT05UUkFDVCk7CiAgYWRkKGJsb2NrSWQsIGluZm8pIHsKICAgIHRoaXMucmVnaXN0cnkuc2V0KGJsb2NrSWQsIGluZm8pOwogICAgaWYgKHRoaXMuYXdhaXRpbmdDYWxsYmFja3MuaGFzKGJsb2NrSWQpKSB7CiAgICAgIGNvbnN0IGF3YWl0aW5nQ2FsbGJhY2tzID0gdGhpcy5hd2FpdGluZ0NhbGxiYWNrcy5nZXQoYmxvY2tJZCk7CiAgICAgIGZvciAoY29uc3QgY2Igb2YgYXdhaXRpbmdDYWxsYmFja3MpIHsKICAgICAgICBjYigpOwogICAgICB9CiAgICB9CiAgfQogIGdldChibG9ja0lkKSB7CiAgICByZXR1cm4gdGhpcy5yZWdpc3RyeS5nZXQoYmxvY2tJZCkgPz8gbnVsbDsKICB9CiAgaGFzKGJsb2NrSWQpIHsKICAgIHJldHVybiB0aGlzLnJlZ2lzdHJ5LmhhcyhibG9ja0lkKTsKICB9CiAgY2xlYW51cChoeWRyYXRlZEJsb2NrcykgewogICAgcmVtb3ZlTGlzdGVuZXJzRnJvbUJsb2NrcyhoeWRyYXRlZEJsb2NrcywgdGhpcy5qc0FjdGlvbk1hcCk7CiAgICBmb3IgKGxldCBibG9ja0lkIG9mIGh5ZHJhdGVkQmxvY2tzKSB7CiAgICAgIHRoaXMucmVnaXN0cnkuZGVsZXRlKGJsb2NrSWQpOwogICAgICB0aGlzLmpzQWN0aW9uTWFwLmRlbGV0ZShibG9ja0lkKTsKICAgICAgdGhpcy5pbnZva2VUcmlnZ2VyQ2xlYW51cEZucyhibG9ja0lkKTsKICAgICAgdGhpcy5oeWRyYXRpbmcuZGVsZXRlKGJsb2NrSWQpOwogICAgICB0aGlzLmF3YWl0aW5nQ2FsbGJhY2tzLmRlbGV0ZShibG9ja0lkKTsKICAgIH0KICAgIGlmICh0aGlzLnNpemUgPT09IDApIHsKICAgICAgdGhpcy5jb250cmFjdC5pbnN0YW5jZT8uY2xlYW5VcCgpOwogICAgfQogIH0KICBnZXQgc2l6ZSgpIHsKICAgIHJldHVybiB0aGlzLnJlZ2lzdHJ5LnNpemU7CiAgfQogIGFkZENsZWFudXBGbihibG9ja0lkLCBmbikgewogICAgbGV0IGNsZWFudXBGdW5jdGlvbnMgPSBbXTsKICAgIGlmICh0aGlzLmNsZWFudXBGbnMuaGFzKGJsb2NrSWQpKSB7CiAgICAgIGNsZWFudXBGdW5jdGlvbnMgPSB0aGlzLmNsZWFudXBGbnMuZ2V0KGJsb2NrSWQpOwogICAgfQogICAgY2xlYW51cEZ1bmN0aW9ucy5wdXNoKGZuKTsKICAgIHRoaXMuY2xlYW51cEZucy5zZXQoYmxvY2tJZCwgY2xlYW51cEZ1bmN0aW9ucyk7CiAgfQogIGludm9rZVRyaWdnZXJDbGVhbnVwRm5zKGJsb2NrSWQpIHsKICAgIGNvbnN0IGZucyA9IHRoaXMuY2xlYW51cEZucy5nZXQoYmxvY2tJZCkgPz8gW107CiAgICBmb3IgKGxldCBmbiBvZiBmbnMpIHsKICAgICAgZm4oKTsKICAgIH0KICAgIHRoaXMuY2xlYW51cEZucy5kZWxldGUoYmxvY2tJZCk7CiAgfQogIGh5ZHJhdGluZyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgYXdhaXRpbmdDYWxsYmFja3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIGF3YWl0UGFyZW50QmxvY2sodG9wbW9zdFBhcmVudEJsb2NrLCBjYWxsYmFjaykgewogICAgY29uc3QgcGFyZW50QmxvY2tBd2FpdENhbGxiYWNrcyA9IHRoaXMuYXdhaXRpbmdDYWxsYmFja3MuZ2V0KHRvcG1vc3RQYXJlbnRCbG9jaykgPz8gW107CiAgICBwYXJlbnRCbG9ja0F3YWl0Q2FsbGJhY2tzLnB1c2goY2FsbGJhY2spOwogICAgdGhpcy5hd2FpdGluZ0NhbGxiYWNrcy5zZXQodG9wbW9zdFBhcmVudEJsb2NrLCBwYXJlbnRCbG9ja0F3YWl0Q2FsbGJhY2tzKTsKICB9CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfRGVoeWRyYXRlZEJsb2NrUmVnaXN0cnksCiAgICBwcm92aWRlZEluOiBudWxsLAogICAgZmFjdG9yeTogKCkgPT4gbmV3IF9EZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSgpCiAgfSk7Cn07CmZ1bmN0aW9uIGlzRGV0YWNoZWRCeUkxOG4odE5vZGUpIHsKICByZXR1cm4gKHROb2RlLmZsYWdzICYgMzIpID09PSAzMjsKfQp2YXIgVFJBTlNGRVJfU1RBVEVfVE9LRU5fSUQgPSAiX19uZ2hEYXRhX18iOwp2YXIgTkdIX0RBVEFfS0VZID0gbWFrZVN0YXRlS2V5KFRSQU5TRkVSX1NUQVRFX1RPS0VOX0lEKTsKdmFyIFRSQU5TRkVSX1NUQVRFX0RFRkVSX0JMT0NLU19JTkZPID0gIl9fbmdoRGVmZXJEYXRhX18iOwp2YXIgTkdIX0RFRkVSX0JMT0NLU19LRVkgPSBtYWtlU3RhdGVLZXkoVFJBTlNGRVJfU1RBVEVfREVGRVJfQkxPQ0tTX0lORk8pOwpmdW5jdGlvbiBpc0ludGVybmFsSHlkcmF0aW9uVHJhbnNmZXJTdGF0ZUtleShrZXkpIHsKICByZXR1cm4ga2V5ID09PSBUUkFOU0ZFUl9TVEFURV9UT0tFTl9JRCB8fCBrZXkgPT09IFRSQU5TRkVSX1NUQVRFX0RFRkVSX0JMT0NLU19JTkZPOwp9CnZhciBOR0hfQVRUUl9OQU1FID0gIm5naCI7CnZhciBTU1JfQ09OVEVOVF9JTlRFR1JJVFlfTUFSS0VSID0gIm5naG0iOwp2YXIgX3JldHJpZXZlSHlkcmF0aW9uSW5mb0ltcGwgPSAoKSA9PiBudWxsOwpmdW5jdGlvbiByZXRyaWV2ZUh5ZHJhdGlvbkluZm9JbXBsKHJOb2RlLCBpbmplY3RvciwgaXNSb290VmlldzIgPSBmYWxzZSkgewogIGxldCBuZ2hBdHRyVmFsdWUgPSByTm9kZS5nZXRBdHRyaWJ1dGUoTkdIX0FUVFJfTkFNRSk7CiAgaWYgKG5naEF0dHJWYWx1ZSA9PSBudWxsKSByZXR1cm4gbnVsbDsKICBjb25zdCBbY29tcG9uZW50Vmlld05naCwgcm9vdFZpZXdOZ2hdID0gbmdoQXR0clZhbHVlLnNwbGl0KCJ8Iik7CiAgbmdoQXR0clZhbHVlID0gaXNSb290VmlldzIgPyByb290Vmlld05naCA6IGNvbXBvbmVudFZpZXdOZ2g7CiAgaWYgKCFuZ2hBdHRyVmFsdWUpIHJldHVybiBudWxsOwogIGNvbnN0IHJvb3ROZ2ggPSByb290Vmlld05naCA/IGB8JHtyb290Vmlld05naH1gIDogIiI7CiAgY29uc3QgcmVtYWluaW5nTmdoID0gaXNSb290VmlldzIgPyBjb21wb25lbnRWaWV3TmdoIDogcm9vdE5naDsKICBsZXQgZGF0YSA9IHt9OwogIGlmIChuZ2hBdHRyVmFsdWUgIT09ICIiKSB7CiAgICBjb25zdCB0cmFuc2ZlclN0YXRlID0gaW5qZWN0b3IuZ2V0KFRyYW5zZmVyU3RhdGUsIG51bGwsIHsKICAgICAgb3B0aW9uYWw6IHRydWUKICAgIH0pOwogICAgaWYgKHRyYW5zZmVyU3RhdGUgIT09IG51bGwpIHsKICAgICAgY29uc3QgbmdoRGF0YSA9IHRyYW5zZmVyU3RhdGUuZ2V0KE5HSF9EQVRBX0tFWSwgW10pOwogICAgICBkYXRhID0gbmdoRGF0YVtOdW1iZXIobmdoQXR0clZhbHVlKV07CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGRhdGEsICJVbmFibGUgdG8gcmV0cmlldmUgaHlkcmF0aW9uIGluZm8gZnJvbSB0aGUgVHJhbnNmZXJTdGF0ZS4iKTsKICAgIH0KICB9CiAgY29uc3QgZGVoeWRyYXRlZFZpZXcgPSB7CiAgICBkYXRhLAogICAgZmlyc3RDaGlsZDogck5vZGUuZmlyc3RDaGlsZCA/PyBudWxsCiAgfTsKICBpZiAoaXNSb290VmlldzIpIHsKICAgIGRlaHlkcmF0ZWRWaWV3LmZpcnN0Q2hpbGQgPSByTm9kZTsKICAgIHNldFNlZ21lbnRIZWFkKGRlaHlkcmF0ZWRWaWV3LCAwLCByTm9kZS5uZXh0U2libGluZyk7CiAgfQogIGlmIChyZW1haW5pbmdOZ2gpIHsKICAgIHJOb2RlLnNldEF0dHJpYnV0ZShOR0hfQVRUUl9OQU1FLCByZW1haW5pbmdOZ2gpOwogIH0gZWxzZSB7CiAgICByTm9kZS5yZW1vdmVBdHRyaWJ1dGUoTkdIX0FUVFJfTkFNRSk7CiAgfQogIG5nRGV2TW9kZSAmJiBtYXJrUk5vZGVBc0NsYWltZWRCeUh5ZHJhdGlvbihyTm9kZSwgZmFsc2UpOwogIG5nRGV2TW9kZSAmJiBuZ0Rldk1vZGUuaHlkcmF0ZWRDb21wb25lbnRzKys7CiAgcmV0dXJuIGRlaHlkcmF0ZWRWaWV3Owp9CmZ1bmN0aW9uIGVuYWJsZVJldHJpZXZlSHlkcmF0aW9uSW5mb0ltcGwoKSB7CiAgX3JldHJpZXZlSHlkcmF0aW9uSW5mb0ltcGwgPSByZXRyaWV2ZUh5ZHJhdGlvbkluZm9JbXBsOwp9CmZ1bmN0aW9uIHJldHJpZXZlSHlkcmF0aW9uSW5mbyhyTm9kZSwgaW5qZWN0b3IsIGlzUm9vdFZpZXcyID0gZmFsc2UpIHsKICByZXR1cm4gX3JldHJpZXZlSHlkcmF0aW9uSW5mb0ltcGwock5vZGUsIGluamVjdG9yLCBpc1Jvb3RWaWV3Mik7Cn0KZnVuY3Rpb24gZ2V0TE5vZGVGb3JIeWRyYXRpb24odmlld1JlZikgewogIGxldCBsVmlldyA9IHZpZXdSZWYuX2xWaWV3OwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGlmICh0Vmlldy50eXBlID09PSAyKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgaWYgKGlzUm9vdFZpZXcobFZpZXcpKSB7CiAgICBsVmlldyA9IGxWaWV3W0hFQURFUl9PRkZTRVRdOwogIH0KICByZXR1cm4gbFZpZXc7Cn0KZnVuY3Rpb24gZ2V0VGV4dE5vZGVDb250ZW50KG5vZGUpIHsKICByZXR1cm4gbm9kZS50ZXh0Q29udGVudD8ucmVwbGFjZSgvXHMvZ20sICIiKTsKfQpmdW5jdGlvbiBwcm9jZXNzVGV4dE5vZGVNYXJrZXJzQmVmb3JlSHlkcmF0aW9uKG5vZGUpIHsKICBjb25zdCBkb2MgPSBnZXREb2N1bWVudCgpOwogIGNvbnN0IGNvbW1lbnROb2Rlc0l0ZXJhdG9yID0gZG9jLmNyZWF0ZU5vZGVJdGVyYXRvcihub2RlLCBOb2RlRmlsdGVyLlNIT1dfQ09NTUVOVCwgewogICAgYWNjZXB0Tm9kZShub2RlMikgewogICAgICBjb25zdCBjb250ZW50ID0gZ2V0VGV4dE5vZGVDb250ZW50KG5vZGUyKTsKICAgICAgY29uc3QgaXNUZXh0Tm9kZU1hcmtlciA9IGNvbnRlbnQgPT09ICJuZ2V0biIgfHwgY29udGVudCA9PT0gIm5ndG5zIjsKICAgICAgcmV0dXJuIGlzVGV4dE5vZGVNYXJrZXIgPyBOb2RlRmlsdGVyLkZJTFRFUl9BQ0NFUFQgOiBOb2RlRmlsdGVyLkZJTFRFUl9SRUpFQ1Q7CiAgICB9CiAgfSk7CiAgbGV0IGN1cnJlbnROb2RlOwogIGNvbnN0IG5vZGVzID0gW107CiAgd2hpbGUgKGN1cnJlbnROb2RlID0gY29tbWVudE5vZGVzSXRlcmF0b3IubmV4dE5vZGUoKSkgewogICAgbm9kZXMucHVzaChjdXJyZW50Tm9kZSk7CiAgfQogIGZvciAoY29uc3Qgbm9kZTIgb2Ygbm9kZXMpIHsKICAgIGlmIChub2RlMi50ZXh0Q29udGVudCA9PT0gIm5nZXRuIikgewogICAgICBub2RlMi5yZXBsYWNlV2l0aChkb2MuY3JlYXRlVGV4dE5vZGUoIiIpKTsKICAgIH0gZWxzZSB7CiAgICAgIG5vZGUyLnJlbW92ZSgpOwogICAgfQogIH0KfQp2YXIgSHlkcmF0aW9uU3RhdHVzOwooZnVuY3Rpb24oSHlkcmF0aW9uU3RhdHVzMikgewogIEh5ZHJhdGlvblN0YXR1czJbIkh5ZHJhdGVkIl0gPSAiaHlkcmF0ZWQiOwogIEh5ZHJhdGlvblN0YXR1czJbIlNraXBwZWQiXSA9ICJza2lwcGVkIjsKICBIeWRyYXRpb25TdGF0dXMyWyJNaXNtYXRjaGVkIl0gPSAibWlzbWF0Y2hlZCI7Cn0pKEh5ZHJhdGlvblN0YXR1cyB8fCAoSHlkcmF0aW9uU3RhdHVzID0ge30pKTsKdmFyIEhZRFJBVElPTl9JTkZPX0tFWSA9ICJfX25nRGVidWdIeWRyYXRpb25JbmZvX18iOwpmdW5jdGlvbiBwYXRjaEh5ZHJhdGlvbkluZm8obm9kZSwgaW5mbykgewogIG5vZGVbSFlEUkFUSU9OX0lORk9fS0VZXSA9IGluZm87Cn0KZnVuY3Rpb24gcmVhZEh5ZHJhdGlvbkluZm8obm9kZSkgewogIHJldHVybiBub2RlW0hZRFJBVElPTl9JTkZPX0tFWV0gPz8gbnVsbDsKfQpmdW5jdGlvbiBtYXJrUk5vZGVBc0NsYWltZWRCeUh5ZHJhdGlvbihub2RlLCBjaGVja0lmQWxyZWFkeUNsYWltZWQgPSB0cnVlKSB7CiAgaWYgKCFuZ0Rldk1vZGUpIHsKICAgIHRocm93IG5ldyBFcnJvcigiQ2FsbGluZyBgbWFya1JOb2RlQXNDbGFpbWVkQnlIeWRyYXRpb25gIGluIHByb2QgbW9kZSBpcyBub3Qgc3VwcG9ydGVkIGFuZCBsaWtlbHkgYSBtaXN0YWtlLiIpOwogIH0KICBpZiAoY2hlY2tJZkFscmVhZHlDbGFpbWVkICYmIGlzUk5vZGVDbGFpbWVkRm9ySHlkcmF0aW9uKG5vZGUpKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIlRyeWluZyB0byBjbGFpbSBhIG5vZGUsIHdoaWNoIHdhcyBjbGFpbWVkIGFscmVhZHkuIik7CiAgfQogIHBhdGNoSHlkcmF0aW9uSW5mbyhub2RlLCB7CiAgICBzdGF0dXM6IEh5ZHJhdGlvblN0YXR1cy5IeWRyYXRlZAogIH0pOwogIG5nRGV2TW9kZS5oeWRyYXRlZE5vZGVzKys7Cn0KZnVuY3Rpb24gbWFya1JOb2RlQXNTa2lwcGVkQnlIeWRyYXRpb24obm9kZSkgewogIGlmICghbmdEZXZNb2RlKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbGxpbmcgYG1hcmtSTm9kZUFzU2tpcHBlZEJ5SHlkcmF0aW9uYCBpbiBwcm9kIG1vZGUgaXMgbm90IHN1cHBvcnRlZCBhbmQgbGlrZWx5IGEgbWlzdGFrZS4iKTsKICB9CiAgcGF0Y2hIeWRyYXRpb25JbmZvKG5vZGUsIHsKICAgIHN0YXR1czogSHlkcmF0aW9uU3RhdHVzLlNraXBwZWQKICB9KTsKICBuZ0Rldk1vZGUuY29tcG9uZW50c1NraXBwZWRIeWRyYXRpb24rKzsKfQpmdW5jdGlvbiBjb3VudEJsb2Nrc1NraXBwZWRCeUh5ZHJhdGlvbihpbmplY3RvcikgewogIGNvbnN0IHRyYW5zZmVyU3RhdGUgPSBpbmplY3Rvci5nZXQoVHJhbnNmZXJTdGF0ZSk7CiAgY29uc3QgbmdoRGVmZXJEYXRhID0gdHJhbnNmZXJTdGF0ZS5nZXQoTkdIX0RFRkVSX0JMT0NLU19LRVksIHt9KTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBuZ0Rldk1vZGUuZGVmZXJCbG9ja3NXaXRoSW5jcmVtZW50YWxIeWRyYXRpb24gPSBPYmplY3Qua2V5cyhuZ2hEZWZlckRhdGEpLmxlbmd0aDsKICB9Cn0KZnVuY3Rpb24gbWFya1JOb2RlQXNIYXZpbmdIeWRyYXRpb25NaXNtYXRjaChub2RlLCBleHBlY3RlZE5vZGVEZXRhaWxzID0gbnVsbCwgYWN0dWFsTm9kZURldGFpbHMgPSBudWxsKSB7CiAgaWYgKCFuZ0Rldk1vZGUpIHsKICAgIHRocm93IG5ldyBFcnJvcigiQ2FsbGluZyBgbWFya1JOb2RlQXNNaXNtYXRjaGVkQnlIeWRyYXRpb25gIGluIHByb2QgbW9kZSBpcyBub3Qgc3VwcG9ydGVkIGFuZCBsaWtlbHkgYSBtaXN0YWtlLiIpOwogIH0KICB3aGlsZSAobm9kZSAmJiAhZ2V0Q29tcG9uZW50KG5vZGUpKSB7CiAgICBub2RlID0gbm9kZT8ucGFyZW50Tm9kZTsKICB9CiAgaWYgKG5vZGUpIHsKICAgIHBhdGNoSHlkcmF0aW9uSW5mbyhub2RlLCB7CiAgICAgIHN0YXR1czogSHlkcmF0aW9uU3RhdHVzLk1pc21hdGNoZWQsCiAgICAgIGV4cGVjdGVkTm9kZURldGFpbHMsCiAgICAgIGFjdHVhbE5vZGVEZXRhaWxzCiAgICB9KTsKICB9Cn0KZnVuY3Rpb24gaXNSTm9kZUNsYWltZWRGb3JIeWRyYXRpb24obm9kZSkgewogIHJldHVybiByZWFkSHlkcmF0aW9uSW5mbyhub2RlKT8uc3RhdHVzID09PSBIeWRyYXRpb25TdGF0dXMuSHlkcmF0ZWQ7Cn0KZnVuY3Rpb24gc2V0U2VnbWVudEhlYWQoaHlkcmF0aW9uSW5mbywgaW5kZXgsIG5vZGUpIHsKICBoeWRyYXRpb25JbmZvLnNlZ21lbnRIZWFkcyA/Pz0ge307CiAgaHlkcmF0aW9uSW5mby5zZWdtZW50SGVhZHNbaW5kZXhdID0gbm9kZTsKfQpmdW5jdGlvbiBnZXRTZWdtZW50SGVhZChoeWRyYXRpb25JbmZvLCBpbmRleCkgewogIHJldHVybiBoeWRyYXRpb25JbmZvLnNlZ21lbnRIZWFkcz8uW2luZGV4XSA/PyBudWxsOwp9CmZ1bmN0aW9uIGlzSW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkKGluamVjdG9yKSB7CiAgcmV0dXJuIGluamVjdG9yLmdldChJU19JTkNSRU1FTlRBTF9IWURSQVRJT05fRU5BQkxFRCwgZmFsc2UsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSk7Cn0KdmFyIGluY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZFdhcm5lZCA9IGZhbHNlOwpmdW5jdGlvbiByZXNldEluY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZFdhcm5lZEZvclRlc3RzKCkgewogIGluY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZFdhcm5lZCA9IGZhbHNlOwp9CmZ1bmN0aW9uIHdhcm5JbmNyZW1lbnRhbEh5ZHJhdGlvbk5vdENvbmZpZ3VyZWQoKSB7CiAgaWYgKCFpbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWRXYXJuZWQpIHsKICAgIGluY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZFdhcm5lZCA9IHRydWU7CiAgICBjb25zb2xlLndhcm4oZm9ybWF0UnVudGltZUVycm9yKDUwOCwgIkFuZ3VsYXIgaGFzIGRldGVjdGVkIHRoYXQgc29tZSBgQGRlZmVyYCBibG9ja3MgdXNlIGBoeWRyYXRlYCB0cmlnZ2VycywgYnV0IGluY3JlbWVudGFsIGh5ZHJhdGlvbiB3YXMgbm90IGVuYWJsZWQuIFBsZWFzZSBlbnN1cmUgdGhhdCB0aGUgYHdpdGhJbmNyZW1lbnRhbEh5ZHJhdGlvbigpYCBjYWxsIGlzIGFkZGVkIGFzIGFuIGFyZ3VtZW50IGZvciB0aGUgYHByb3ZpZGVDbGllbnRIeWRyYXRpb24oKWAgZnVuY3Rpb24gY2FsbCBpbiB5b3VyIGFwcGxpY2F0aW9uIGNvbmZpZy4iKSk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydFNzcklkRGVmaW5lZChzc3JVbmlxdWVJZCkgewogIGFzc2VydERlZmluZWQoc3NyVW5pcXVlSWQsICJJbnRlcm5hbCBlcnJvcjogZXhwZWN0aW5nIGFuIFNTUiBpZCBmb3IgYSBkZWZlciBibG9jayB0aGF0IHNob3VsZCBiZSBoeWRyYXRlZCwgYnV0IHRoZSBpZCBpcyBub3QgcHJlc2VudCIpOwp9CmZ1bmN0aW9uIGdldE5nQ29udGFpbmVyU2l6ZShoeWRyYXRpb25JbmZvLCBpbmRleCkgewogIGNvbnN0IGRhdGEgPSBoeWRyYXRpb25JbmZvLmRhdGE7CiAgbGV0IHNpemUgPSBkYXRhW0VMRU1FTlRfQ09OVEFJTkVSU10/LltpbmRleF0gPz8gbnVsbDsKICBpZiAoc2l6ZSA9PT0gbnVsbCAmJiBkYXRhW0NPTlRBSU5FUlNdPy5baW5kZXhdKSB7CiAgICBzaXplID0gY2FsY1NlcmlhbGl6ZWRDb250YWluZXJTaXplKGh5ZHJhdGlvbkluZm8sIGluZGV4KTsKICB9CiAgcmV0dXJuIHNpemU7Cn0KZnVuY3Rpb24gaXNTZXJpYWxpemVkRWxlbWVudENvbnRhaW5lcihoeWRyYXRpb25JbmZvLCBpbmRleCkgewogIHJldHVybiBoeWRyYXRpb25JbmZvLmRhdGFbRUxFTUVOVF9DT05UQUlORVJTXT8uW2luZGV4XSAhPT0gdm9pZCAwOwp9CmZ1bmN0aW9uIGdldFNlcmlhbGl6ZWRDb250YWluZXJWaWV3cyhoeWRyYXRpb25JbmZvLCBpbmRleCkgewogIHJldHVybiBoeWRyYXRpb25JbmZvLmRhdGFbQ09OVEFJTkVSU10/LltpbmRleF0gPz8gbnVsbDsKfQpmdW5jdGlvbiBjYWxjU2VyaWFsaXplZENvbnRhaW5lclNpemUoaHlkcmF0aW9uSW5mbywgaW5kZXgpIHsKICBjb25zdCB2aWV3cyA9IGdldFNlcmlhbGl6ZWRDb250YWluZXJWaWV3cyhoeWRyYXRpb25JbmZvLCBpbmRleCkgPz8gW107CiAgbGV0IG51bU5vZGVzID0gMDsKICBmb3IgKGxldCB2aWV3IG9mIHZpZXdzKSB7CiAgICBudW1Ob2RlcyArPSB2aWV3W05VTV9ST09UX05PREVTXSAqICh2aWV3W01VTFRJUExJRVJdID8/IDEpOwogIH0KICByZXR1cm4gbnVtTm9kZXM7Cn0KZnVuY3Rpb24gaW5pdERpc2Nvbm5lY3RlZE5vZGVzKGh5ZHJhdGlvbkluZm8pIHsKICBpZiAodHlwZW9mIGh5ZHJhdGlvbkluZm8uZGlzY29ubmVjdGVkTm9kZXMgPT09ICJ1bmRlZmluZWQiKSB7CiAgICBjb25zdCBub2RlSWRzID0gaHlkcmF0aW9uSW5mby5kYXRhW0RJU0NPTk5FQ1RFRF9OT0RFU107CiAgICBoeWRyYXRpb25JbmZvLmRpc2Nvbm5lY3RlZE5vZGVzID0gbm9kZUlkcyA/IG5ldyBTZXQobm9kZUlkcykgOiBudWxsOwogIH0KICByZXR1cm4gaHlkcmF0aW9uSW5mby5kaXNjb25uZWN0ZWROb2RlczsKfQpmdW5jdGlvbiBpc0Rpc2Nvbm5lY3RlZE5vZGUkMShoeWRyYXRpb25JbmZvLCBpbmRleCkgewogIGlmICh0eXBlb2YgaHlkcmF0aW9uSW5mby5kaXNjb25uZWN0ZWROb2RlcyA9PT0gInVuZGVmaW5lZCIpIHsKICAgIGNvbnN0IG5vZGVJZHMgPSBoeWRyYXRpb25JbmZvLmRhdGFbRElTQ09OTkVDVEVEX05PREVTXTsKICAgIGh5ZHJhdGlvbkluZm8uZGlzY29ubmVjdGVkTm9kZXMgPSBub2RlSWRzID8gbmV3IFNldChub2RlSWRzKSA6IG51bGw7CiAgfQogIHJldHVybiAhIWluaXREaXNjb25uZWN0ZWROb2RlcyhoeWRyYXRpb25JbmZvKT8uaGFzKGluZGV4KTsKfQpmdW5jdGlvbiBjYW5IeWRyYXRlTm9kZShsVmlldywgdE5vZGUpIHsKICBjb25zdCBoeWRyYXRpb25JbmZvID0gbFZpZXdbSFlEUkFUSU9OXTsKICByZXR1cm4gaHlkcmF0aW9uSW5mbyAhPT0gbnVsbCAmJiAhaXNJblNraXBIeWRyYXRpb25CbG9jaygpICYmICFpc0RldGFjaGVkQnlJMThuKHROb2RlKSAmJiAhaXNEaXNjb25uZWN0ZWROb2RlJDEoaHlkcmF0aW9uSW5mbywgdE5vZGUuaW5kZXggLSBIRUFERVJfT0ZGU0VUKTsKfQpmdW5jdGlvbiBwcm9jZXNzVGV4dE5vZGVCZWZvcmVTZXJpYWxpemF0aW9uKGNvbnRleHQyLCBub2RlKSB7CiAgY29uc3QgZWwgPSBub2RlOwogIGNvbnN0IGNvcnJ1cHRlZFRleHROb2RlcyA9IGNvbnRleHQyLmNvcnJ1cHRlZFRleHROb2RlczsKICBpZiAoZWwudGV4dENvbnRlbnQgPT09ICIiKSB7CiAgICBjb3JydXB0ZWRUZXh0Tm9kZXMuc2V0KGVsLCAibmdldG4iKTsKICB9IGVsc2UgaWYgKGVsLm5leHRTaWJsaW5nPy5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHsKICAgIGNvcnJ1cHRlZFRleHROb2Rlcy5zZXQoZWwsICJuZ3RucyIpOwogIH0KfQpmdW5jdGlvbiBjb252ZXJ0SHlkcmF0ZVRyaWdnZXJzVG9Kc0FjdGlvbih0cmlnZ2VycykgewogIGxldCBhY3Rpb25MaXN0ID0gW107CiAgaWYgKHRyaWdnZXJzICE9PSBudWxsKSB7CiAgICBpZiAodHJpZ2dlcnMuaGFzKDQpKSB7CiAgICAgIGFjdGlvbkxpc3QucHVzaCguLi5ob3ZlckV2ZW50TmFtZXMpOwogICAgfQogICAgaWYgKHRyaWdnZXJzLmhhcygzKSkgewogICAgICBhY3Rpb25MaXN0LnB1c2goLi4uaW50ZXJhY3Rpb25FdmVudE5hbWVzKTsKICAgIH0KICB9CiAgcmV0dXJuIGFjdGlvbkxpc3Q7Cn0KZnVuY3Rpb24gZ2V0UGFyZW50QmxvY2tIeWRyYXRpb25RdWV1ZShkZWZlckJsb2NrSWQsIGluamVjdG9yKSB7CiAgY29uc3QgZGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkgPSBpbmplY3Rvci5nZXQoREVIWURSQVRFRF9CTE9DS19SRUdJU1RSWSk7CiAgY29uc3QgdHJhbnNmZXJTdGF0ZSA9IGluamVjdG9yLmdldChUcmFuc2ZlclN0YXRlKTsKICBjb25zdCBkZWZlckJsb2NrUGFyZW50cyA9IHRyYW5zZmVyU3RhdGUuZ2V0KE5HSF9ERUZFUl9CTE9DS1NfS0VZLCB7fSk7CiAgbGV0IGlzVG9wTW9zdERlZmVyQmxvY2sgPSBmYWxzZTsKICBsZXQgY3VycmVudEJsb2NrSWQgPSBkZWZlckJsb2NrSWQ7CiAgbGV0IHBhcmVudEJsb2NrUHJvbWlzZSA9IG51bGw7CiAgY29uc3QgaHlkcmF0aW9uUXVldWUgPSBbXTsKICB3aGlsZSAoIWlzVG9wTW9zdERlZmVyQmxvY2sgJiYgY3VycmVudEJsb2NrSWQpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChoeWRyYXRpb25RdWV1ZS5pbmRleE9mKGN1cnJlbnRCbG9ja0lkKSwgLTEsICJJbnRlcm5hbCBlcnJvcjogZGVmZXIgYmxvY2sgaGllcmFyY2h5IGhhcyBhIGN5Y2xlLiIpOwogICAgaXNUb3BNb3N0RGVmZXJCbG9jayA9IGRlaHlkcmF0ZWRCbG9ja1JlZ2lzdHJ5LmhhcyhjdXJyZW50QmxvY2tJZCk7CiAgICBjb25zdCBoeWRyYXRpbmdQYXJlbnRCbG9jayA9IGRlaHlkcmF0ZWRCbG9ja1JlZ2lzdHJ5Lmh5ZHJhdGluZy5nZXQoY3VycmVudEJsb2NrSWQpOwogICAgaWYgKHBhcmVudEJsb2NrUHJvbWlzZSA9PT0gbnVsbCAmJiBoeWRyYXRpbmdQYXJlbnRCbG9jayAhPSBudWxsKSB7CiAgICAgIHBhcmVudEJsb2NrUHJvbWlzZSA9IGh5ZHJhdGluZ1BhcmVudEJsb2NrLnByb21pc2U7CiAgICAgIGJyZWFrOwogICAgfQogICAgaHlkcmF0aW9uUXVldWUudW5zaGlmdChjdXJyZW50QmxvY2tJZCk7CiAgICBjdXJyZW50QmxvY2tJZCA9IGRlZmVyQmxvY2tQYXJlbnRzW2N1cnJlbnRCbG9ja0lkXVtERUZFUl9QQVJFTlRfQkxPQ0tfSURdOwogIH0KICByZXR1cm4gewogICAgcGFyZW50QmxvY2tQcm9taXNlLAogICAgaHlkcmF0aW9uUXVldWUKICB9Owp9CmZ1bmN0aW9uIGdhdGhlckRlZmVyQmxvY2tzQnlKU0FjdGlvbkF0dHJpYnV0ZShkb2MpIHsKICBjb25zdCBqc2FjdGlvbk5vZGVzID0gZG9jLmJvZHkucXVlcnlTZWxlY3RvckFsbCgiW2pzYWN0aW9uXSIpOwogIGNvbnN0IGJsb2NrTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICBjb25zdCBldmVudFR5cGVzID0gW2hvdmVyRXZlbnROYW1lcy5qb2luKCI6OyIpLCBpbnRlcmFjdGlvbkV2ZW50TmFtZXMuam9pbigiOjsiKV0uam9pbigifCIpOwogIGZvciAobGV0IG5vZGUgb2YganNhY3Rpb25Ob2RlcykgewogICAgY29uc3QgYXR0ciA9IG5vZGUuZ2V0QXR0cmlidXRlKCJqc2FjdGlvbiIpOwogICAgY29uc3QgYmxvY2tJZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJuZ2IiKTsKICAgIGlmIChhdHRyPy5tYXRjaChldmVudFR5cGVzKSAmJiBibG9ja0lkICE9PSBudWxsKSB7CiAgICAgIGJsb2NrTWFwLmFkZChub2RlKTsKICAgIH0KICB9CiAgcmV0dXJuIGJsb2NrTWFwOwp9CmZ1bmN0aW9uIGFwcGVuZERlZmVyQmxvY2tzVG9KU0FjdGlvbk1hcChkb2MsIGluamVjdG9yKSB7CiAgY29uc3QgYmxvY2tNYXAgPSBnYXRoZXJEZWZlckJsb2Nrc0J5SlNBY3Rpb25BdHRyaWJ1dGUoZG9jKTsKICBjb25zdCBqc0FjdGlvbk1hcCA9IGluamVjdG9yLmdldChKU0FDVElPTl9CTE9DS19FTEVNRU5UX01BUCk7CiAgZm9yIChsZXQgck5vZGUgb2YgYmxvY2tNYXApIHsKICAgIHNoYXJlZE1hcEZ1bmN0aW9uKHJOb2RlLCBqc0FjdGlvbk1hcCk7CiAgfQp9CnZhciBfcmV0cmlldmVEZWZlckJsb2NrRGF0YUltcGwgPSAoKSA9PiB7CiAgcmV0dXJuIHt9Owp9OwpmdW5jdGlvbiByZXRyaWV2ZURlZmVyQmxvY2tEYXRhSW1wbChpbmplY3RvcikgewogIGNvbnN0IHRyYW5zZmVyU3RhdGUgPSBpbmplY3Rvci5nZXQoVHJhbnNmZXJTdGF0ZSwgbnVsbCwgewogICAgb3B0aW9uYWw6IHRydWUKICB9KTsKICBpZiAodHJhbnNmZXJTdGF0ZSAhPT0gbnVsbCkgewogICAgY29uc3QgbmdoRGVmZXJEYXRhID0gdHJhbnNmZXJTdGF0ZS5nZXQoTkdIX0RFRkVSX0JMT0NLU19LRVksIHt9KTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKG5naERlZmVyRGF0YSwgIlVuYWJsZSB0byByZXRyaWV2ZSBkZWZlciBibG9jayBpbmZvIGZyb20gdGhlIFRyYW5zZmVyU3RhdGUuIik7CiAgICByZXR1cm4gbmdoRGVmZXJEYXRhOwogIH0KICByZXR1cm4ge307Cn0KZnVuY3Rpb24gZW5hYmxlUmV0cmlldmVEZWZlckJsb2NrRGF0YUltcGwoKSB7CiAgX3JldHJpZXZlRGVmZXJCbG9ja0RhdGFJbXBsID0gcmV0cmlldmVEZWZlckJsb2NrRGF0YUltcGw7Cn0KZnVuY3Rpb24gcmV0cmlldmVEZWZlckJsb2NrRGF0YShpbmplY3RvcikgewogIHJldHVybiBfcmV0cmlldmVEZWZlckJsb2NrRGF0YUltcGwoaW5qZWN0b3IpOwp9CmZ1bmN0aW9uIGlzVGltZXJUcmlnZ2VyKHRyaWdnZXJJbmZvKSB7CiAgcmV0dXJuIHR5cGVvZiB0cmlnZ2VySW5mbyA9PT0gIm9iamVjdCIgJiYgdHJpZ2dlckluZm8udHJpZ2dlciA9PT0gNTsKfQpmdW5jdGlvbiBnZXRIeWRyYXRlVGltZXJUcmlnZ2VyKGJsb2NrRGF0YSkgewogIGNvbnN0IHRyaWdnZXIgPSBibG9ja0RhdGFbREVGRVJfSFlEUkFURV9UUklHR0VSU10/LmZpbmQoKHQpID0+IGlzVGltZXJUcmlnZ2VyKHQpKTsKICByZXR1cm4gdHJpZ2dlcj8uZGVsYXkgPz8gbnVsbDsKfQpmdW5jdGlvbiBnZXRIeWRyYXRlVmlld3BvcnRUcmlnZ2VyKGJsb2NrRGF0YSkgewogIGNvbnN0IGRldGFpbHMgPSBibG9ja0RhdGFbREVGRVJfSFlEUkFURV9UUklHR0VSU107CiAgaWYgKGRldGFpbHMpIHsKICAgIGZvciAoY29uc3QgY3VycmVudCBvZiBkZXRhaWxzKSB7CiAgICAgIGlmIChjdXJyZW50ID09PSAyKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGN1cnJlbnQgPT09ICJvYmplY3QiICYmIGN1cnJlbnQudHJpZ2dlciA9PT0gMikgewogICAgICAgIHJldHVybiBjdXJyZW50LmludGVyc2VjdGlvbk9ic2VydmVyT3B0aW9ucyB8fCB0cnVlOwogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBudWxsOwp9CmZ1bmN0aW9uIGhhc0h5ZHJhdGVUcmlnZ2VyKGJsb2NrRGF0YSwgdHJpZ2dlcikgewogIHJldHVybiBibG9ja0RhdGFbREVGRVJfSFlEUkFURV9UUklHR0VSU10/LmluY2x1ZGVzKHRyaWdnZXIpID8/IGZhbHNlOwp9CmZ1bmN0aW9uIGNyZWF0ZUJsb2NrU3VtbWFyeShibG9ja0luZm8pIHsKICByZXR1cm4gewogICAgZGF0YTogYmxvY2tJbmZvLAogICAgaHlkcmF0ZTogewogICAgICBpZGxlOiBoYXNIeWRyYXRlVHJpZ2dlcihibG9ja0luZm8sIDApLAogICAgICBpbW1lZGlhdGU6IGhhc0h5ZHJhdGVUcmlnZ2VyKGJsb2NrSW5mbywgMSksCiAgICAgIHRpbWVyOiBnZXRIeWRyYXRlVGltZXJUcmlnZ2VyKGJsb2NrSW5mbyksCiAgICAgIHZpZXdwb3J0OiBnZXRIeWRyYXRlVmlld3BvcnRUcmlnZ2VyKGJsb2NrSW5mbykKICAgIH0KICB9Owp9CmZ1bmN0aW9uIHByb2Nlc3NCbG9ja0RhdGEoaW5qZWN0b3IpIHsKICBjb25zdCBibG9ja0RhdGEgPSByZXRyaWV2ZURlZmVyQmxvY2tEYXRhKGluamVjdG9yKTsKICBsZXQgYmxvY2tEZXRhaWxzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBmb3IgKGxldCBibG9ja0lkIGluIGJsb2NrRGF0YSkgewogICAgYmxvY2tEZXRhaWxzLnNldChibG9ja0lkLCBjcmVhdGVCbG9ja1N1bW1hcnkoYmxvY2tEYXRhW2Jsb2NrSWRdKSk7CiAgfQogIHJldHVybiBibG9ja0RldGFpbHM7Cn0KZnVuY3Rpb24gaXNTc3JDb250ZW50c0ludGVncml0eShub2RlKSB7CiAgcmV0dXJuICEhbm9kZSAmJiBub2RlLm5vZGVUeXBlID09PSBOb2RlLkNPTU1FTlRfTk9ERSAmJiBub2RlLnRleHRDb250ZW50Py50cmltKCkgPT09IFNTUl9DT05URU5UX0lOVEVHUklUWV9NQVJLRVI7Cn0KZnVuY3Rpb24gc2tpcFRleHROb2Rlcyhub2RlKSB7CiAgd2hpbGUgKG5vZGUgJiYgbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHsKICAgIG5vZGUgPSBub2RlLnByZXZpb3VzU2libGluZzsKICB9CiAgcmV0dXJuIG5vZGU7Cn0KZnVuY3Rpb24gdmVyaWZ5U3NyQ29udGVudHNJbnRlZ3JpdHkoZG9jKSB7CiAgZm9yIChjb25zdCBub2RlIG9mIGRvYy5ib2R5LmNoaWxkTm9kZXMpIHsKICAgIGlmIChpc1NzckNvbnRlbnRzSW50ZWdyaXR5KG5vZGUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICB9CiAgY29uc3QgYmVmb3JlQm9keSA9IHNraXBUZXh0Tm9kZXMoZG9jLmJvZHkucHJldmlvdXNTaWJsaW5nKTsKICBpZiAoaXNTc3JDb250ZW50c0ludGVncml0eShiZWZvcmVCb2R5KSkgewogICAgcmV0dXJuOwogIH0KICBsZXQgZW5kT2ZIZWFkID0gc2tpcFRleHROb2Rlcyhkb2MuaGVhZC5sYXN0Q2hpbGQpOwogIGlmIChpc1NzckNvbnRlbnRzSW50ZWdyaXR5KGVuZE9mSGVhZCkpIHsKICAgIHJldHVybjsKICB9CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtNTA3LCB0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgJiYgIkFuZ3VsYXIgaHlkcmF0aW9uIGxvZ2ljIGRldGVjdGVkIHRoYXQgSFRNTCBjb250ZW50IG9mIHRoaXMgcGFnZSB3YXMgbW9kaWZpZWQgYWZ0ZXIgaXQgd2FzIHByb2R1Y2VkIGR1cmluZyBzZXJ2ZXIgc2lkZSByZW5kZXJpbmcuIE1ha2Ugc3VyZSB0aGF0IHRoZXJlIGFyZSBubyBvcHRpbWl6YXRpb25zIHRoYXQgcmVtb3ZlIGNvbW1lbnQgbm9kZXMgZnJvbSBIVE1MIGVuYWJsZWQgb24geW91ciBDRE4uIEFuZ3VsYXIgaHlkcmF0aW9uIHJlbGllcyBvbiBIVE1MIHByb2R1Y2VkIGJ5IHRoZSBzZXJ2ZXIsIGluY2x1ZGluZyB3aGl0ZXNwYWNlcyBhbmQgY29tbWVudCBub2Rlcy4iKTsKfQpmdW5jdGlvbiByZWZyZXNoQ29udGVudFF1ZXJpZXModFZpZXcsIGxWaWV3KSB7CiAgY29uc3QgY29udGVudFF1ZXJpZXMgPSB0Vmlldy5jb250ZW50UXVlcmllczsKICBpZiAoY29udGVudFF1ZXJpZXMgIT09IG51bGwpIHsKICAgIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogICAgdHJ5IHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZW50UXVlcmllcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IHF1ZXJ5U3RhcnRJZHggPSBjb250ZW50UXVlcmllc1tpXTsKICAgICAgICBjb25zdCBkaXJlY3RpdmVEZWZJZHggPSBjb250ZW50UXVlcmllc1tpICsgMV07CiAgICAgICAgaWYgKGRpcmVjdGl2ZURlZklkeCAhPT0gLTEpIHsKICAgICAgICAgIGNvbnN0IGRpcmVjdGl2ZURlZiA9IHRWaWV3LmRhdGFbZGlyZWN0aXZlRGVmSWR4XTsKICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGRpcmVjdGl2ZURlZiwgIkRpcmVjdGl2ZURlZiBub3QgZm91bmQuIik7CiAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChkaXJlY3RpdmVEZWYuY29udGVudFF1ZXJpZXMsICJjb250ZW50UXVlcmllcyBmdW5jdGlvbiBzaG91bGQgYmUgZGVmaW5lZCIpOwogICAgICAgICAgc2V0Q3VycmVudFF1ZXJ5SW5kZXgocXVlcnlTdGFydElkeCk7CiAgICAgICAgICBkaXJlY3RpdmVEZWYuY29udGVudFF1ZXJpZXMoMiwgbFZpZXdbZGlyZWN0aXZlRGVmSWR4XSwgZGlyZWN0aXZlRGVmSWR4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGV4ZWN1dGVWaWV3UXVlcnlGbihmbGFncywgdmlld1F1ZXJ5Rm4sIGNvbXBvbmVudCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHZpZXdRdWVyeUZuLCAiVmlldyBxdWVyaWVzIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgbXVzdCBiZSBkZWZpbmVkLiIpOwogIHNldEN1cnJlbnRRdWVyeUluZGV4KDApOwogIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogIHRyeSB7CiAgICB2aWV3UXVlcnlGbihmbGFncywgY29tcG9uZW50KTsKICB9IGZpbmFsbHkgewogICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICB9Cn0KZnVuY3Rpb24gZXhlY3V0ZUNvbnRlbnRRdWVyaWVzKHRWaWV3LCB0Tm9kZSwgbFZpZXcpIHsKICBpZiAoaXNDb250ZW50UXVlcnlIb3N0KHROb2RlKSkgewogICAgY29uc3QgcHJldkNvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgICB0cnkgewogICAgICBjb25zdCBzdGFydCA9IHROb2RlLmRpcmVjdGl2ZVN0YXJ0OwogICAgICBjb25zdCBlbmQgPSB0Tm9kZS5kaXJlY3RpdmVFbmQ7CiAgICAgIGZvciAobGV0IGRpcmVjdGl2ZUluZGV4ID0gc3RhcnQ7IGRpcmVjdGl2ZUluZGV4IDwgZW5kOyBkaXJlY3RpdmVJbmRleCsrKSB7CiAgICAgICAgY29uc3QgZGVmID0gdFZpZXcuZGF0YVtkaXJlY3RpdmVJbmRleF07CiAgICAgICAgaWYgKGRlZi5jb250ZW50UXVlcmllcykgewogICAgICAgICAgY29uc3QgZGlyZWN0aXZlSW5zdGFuY2UgPSBsVmlld1tkaXJlY3RpdmVJbmRleF07CiAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChkaXJlY3RpdmVJbmRleCwgIkluY29ycmVjdCByZWZlcmVuY2UgdG8gYSBkaXJlY3RpdmUgZGVmaW5pbmcgYSBjb250ZW50IHF1ZXJ5Iik7CiAgICAgICAgICBkZWYuY29udGVudFF1ZXJpZXMoMSwgZGlyZWN0aXZlSW5zdGFuY2UsIGRpcmVjdGl2ZUluZGV4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICB9CiAgfQp9CnZhciBWaWV3RW5jYXBzdWxhdGlvbjsKKGZ1bmN0aW9uKFZpZXdFbmNhcHN1bGF0aW9uMykgewogIFZpZXdFbmNhcHN1bGF0aW9uM1tWaWV3RW5jYXBzdWxhdGlvbjNbIkVtdWxhdGVkIl0gPSAwXSA9ICJFbXVsYXRlZCI7CiAgVmlld0VuY2Fwc3VsYXRpb24zW1ZpZXdFbmNhcHN1bGF0aW9uM1siTm9uZSJdID0gMl0gPSAiTm9uZSI7CiAgVmlld0VuY2Fwc3VsYXRpb24zW1ZpZXdFbmNhcHN1bGF0aW9uM1siU2hhZG93RG9tIl0gPSAzXSA9ICJTaGFkb3dEb20iOwogIFZpZXdFbmNhcHN1bGF0aW9uM1tWaWV3RW5jYXBzdWxhdGlvbjNbIkV4cGVyaW1lbnRhbElzb2xhdGVkU2hhZG93RG9tIl0gPSA0XSA9ICJFeHBlcmltZW50YWxJc29sYXRlZFNoYWRvd0RvbSI7Cn0pKFZpZXdFbmNhcHN1bGF0aW9uIHx8IChWaWV3RW5jYXBzdWxhdGlvbiA9IHt9KSk7CnZhciBDVVNUT01fRUxFTUVOVFNfU0NIRU1BID0gewogIG5hbWU6ICJjdXN0b20tZWxlbWVudHMiCn07CnZhciBOT19FUlJPUlNfU0NIRU1BID0gewogIG5hbWU6ICJuby1lcnJvcnMtc2NoZW1hIgp9Owp2YXIgc2hvdWxkVGhyb3dFcnJvck9uVW5rbm93bkVsZW1lbnQgPSBmYWxzZTsKZnVuY3Rpb24gybVzZXRVbmtub3duRWxlbWVudFN0cmljdE1vZGUoc2hvdWxkVGhyb3cpIHsKICBzaG91bGRUaHJvd0Vycm9yT25Vbmtub3duRWxlbWVudCA9IHNob3VsZFRocm93Owp9CmZ1bmN0aW9uIMm1Z2V0VW5rbm93bkVsZW1lbnRTdHJpY3RNb2RlKCkgewogIHJldHVybiBzaG91bGRUaHJvd0Vycm9yT25Vbmtub3duRWxlbWVudDsKfQp2YXIgc2hvdWxkVGhyb3dFcnJvck9uVW5rbm93blByb3BlcnR5ID0gZmFsc2U7CmZ1bmN0aW9uIMm1c2V0VW5rbm93blByb3BlcnR5U3RyaWN0TW9kZShzaG91bGRUaHJvdykgewogIHNob3VsZFRocm93RXJyb3JPblVua25vd25Qcm9wZXJ0eSA9IHNob3VsZFRocm93Owp9CmZ1bmN0aW9uIMm1Z2V0VW5rbm93blByb3BlcnR5U3RyaWN0TW9kZSgpIHsKICByZXR1cm4gc2hvdWxkVGhyb3dFcnJvck9uVW5rbm93blByb3BlcnR5Owp9CmZ1bmN0aW9uIHZhbGlkYXRlRWxlbWVudElzS25vd24obFZpZXcsIHROb2RlKSB7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgaWYgKHRWaWV3LnNjaGVtYXMgPT09IG51bGwpIHJldHVybjsKICBjb25zdCB0YWdOYW1lID0gdE5vZGUudmFsdWU7CiAgaWYgKCFpc0RpcmVjdGl2ZUhvc3QodE5vZGUpICYmIHRhZ05hbWUgIT09IG51bGwpIHsKICAgIGNvbnN0IGlzVW5rbm93biA9IHR5cGVvZiBIVE1MVW5rbm93bkVsZW1lbnQgIT09ICJ1bmRlZmluZWQiICYmIEhUTUxVbmtub3duRWxlbWVudCAmJiBnZXROYXRpdmVCeVROb2RlKHROb2RlLCBsVmlldykgaW5zdGFuY2VvZiBIVE1MVW5rbm93bkVsZW1lbnQgfHwgdHlwZW9mIGN1c3RvbUVsZW1lbnRzICE9PSAidW5kZWZpbmVkIiAmJiB0YWdOYW1lLmluZGV4T2YoIi0iKSA+IC0xICYmICFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSk7CiAgICBpZiAoaXNVbmtub3duICYmICFtYXRjaGluZ1NjaGVtYXModFZpZXcuc2NoZW1hcywgdGFnTmFtZSkpIHsKICAgICAgY29uc3QgaXNIb3N0U3RhbmRhbG9uZSA9IGlzSG9zdENvbXBvbmVudFN0YW5kYWxvbmUobFZpZXcpOwogICAgICBjb25zdCB0ZW1wbGF0ZUxvY2F0aW9uID0gZ2V0VGVtcGxhdGVMb2NhdGlvbkRldGFpbHMobFZpZXcpOwogICAgICBjb25zdCBzY2hlbWFzID0gYCcke2lzSG9zdFN0YW5kYWxvbmUgPyAiQENvbXBvbmVudCIgOiAiQE5nTW9kdWxlIn0uc2NoZW1hcydgOwogICAgICBsZXQgbWVzc2FnZSA9IGAnJHt0YWdOYW1lfScgaXMgbm90IGEga25vd24gZWxlbWVudCR7dGVtcGxhdGVMb2NhdGlvbn06CmA7CiAgICAgIG1lc3NhZ2UgKz0gYDEuIElmICcke3RhZ05hbWV9JyBpcyBhbiBBbmd1bGFyIGNvbXBvbmVudCwgdGhlbiB2ZXJpZnkgdGhhdCBpdCBpcyAke2lzSG9zdFN0YW5kYWxvbmUgPyAiaW5jbHVkZWQgaW4gdGhlICdAQ29tcG9uZW50LmltcG9ydHMnIG9mIHRoaXMgY29tcG9uZW50IiA6ICJhIHBhcnQgb2YgYW4gQE5nTW9kdWxlIHdoZXJlIHRoaXMgY29tcG9uZW50IGlzIGRlY2xhcmVkIn0uCmA7CiAgICAgIGlmICh0YWdOYW1lICYmIHRhZ05hbWUuaW5kZXhPZigiLSIpID4gLTEpIHsKICAgICAgICBtZXNzYWdlICs9IGAyLiBJZiAnJHt0YWdOYW1lfScgaXMgYSBXZWIgQ29tcG9uZW50IHRoZW4gYWRkICdDVVNUT01fRUxFTUVOVFNfU0NIRU1BJyB0byB0aGUgJHtzY2hlbWFzfSBvZiB0aGlzIGNvbXBvbmVudCB0byBzdXBwcmVzcyB0aGlzIG1lc3NhZ2UuYDsKICAgICAgfSBlbHNlIHsKICAgICAgICBtZXNzYWdlICs9IGAyLiBUbyBhbGxvdyBhbnkgZWxlbWVudCBhZGQgJ05PX0VSUk9SU19TQ0hFTUEnIHRvIHRoZSAke3NjaGVtYXN9IG9mIHRoaXMgY29tcG9uZW50LmA7CiAgICAgIH0KICAgICAgaWYgKHNob3VsZFRocm93RXJyb3JPblVua25vd25FbGVtZW50KSB7CiAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigzMDQsIG1lc3NhZ2UpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0UnVudGltZUVycm9yKDMwNCwgbWVzc2FnZSkpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGlzUHJvcGVydHlWYWxpZChlbGVtZW50LCBwcm9wTmFtZSwgdGFnTmFtZSwgc2NoZW1hcykgewogIGlmIChzY2hlbWFzID09PSBudWxsKSByZXR1cm4gdHJ1ZTsKICBpZiAobWF0Y2hpbmdTY2hlbWFzKHNjaGVtYXMsIHRhZ05hbWUpIHx8IHByb3BOYW1lIGluIGVsZW1lbnQgfHwgaXNBbmltYXRpb25Qcm9wKHByb3BOYW1lKSkgewogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiB0eXBlb2YgTm9kZSA9PT0gInVuZGVmaW5lZCIgfHwgTm9kZSA9PT0gbnVsbCB8fCAhKGVsZW1lbnQgaW5zdGFuY2VvZiBOb2RlKTsKfQpmdW5jdGlvbiBoYW5kbGVVbmtub3duUHJvcGVydHlFcnJvcihwcm9wTmFtZSwgdGFnTmFtZSwgbm9kZVR5cGUsIGxWaWV3KSB7CiAgaWYgKCF0YWdOYW1lICYmIG5vZGVUeXBlID09PSA0KSB7CiAgICB0YWdOYW1lID0gIm5nLXRlbXBsYXRlIjsKICB9CiAgY29uc3QgaXNIb3N0U3RhbmRhbG9uZSA9IGlzSG9zdENvbXBvbmVudFN0YW5kYWxvbmUobFZpZXcpOwogIGNvbnN0IHRlbXBsYXRlTG9jYXRpb24gPSBnZXRUZW1wbGF0ZUxvY2F0aW9uRGV0YWlscyhsVmlldyk7CiAgbGV0IG1lc3NhZ2UgPSBgQ2FuJ3QgYmluZCB0byAnJHtwcm9wTmFtZX0nIHNpbmNlIGl0IGlzbid0IGEga25vd24gcHJvcGVydHkgb2YgJyR7dGFnTmFtZX0nJHt0ZW1wbGF0ZUxvY2F0aW9ufS5gOwogIGNvbnN0IHNjaGVtYXMgPSBgJyR7aXNIb3N0U3RhbmRhbG9uZSA/ICJAQ29tcG9uZW50IiA6ICJATmdNb2R1bGUifS5zY2hlbWFzJ2A7CiAgY29uc3QgaW1wb3J0TG9jYXRpb24gPSBpc0hvc3RTdGFuZGFsb25lID8gImluY2x1ZGVkIGluIHRoZSAnQENvbXBvbmVudC5pbXBvcnRzJyBvZiB0aGlzIGNvbXBvbmVudCIgOiAiYSBwYXJ0IG9mIGFuIEBOZ01vZHVsZSB3aGVyZSB0aGlzIGNvbXBvbmVudCBpcyBkZWNsYXJlZCI7CiAgaWYgKEtOT1dOX0NPTlRST0xfRkxPV19ESVJFQ1RJVkVTLmhhcyhwcm9wTmFtZSkpIHsKICAgIGNvbnN0IGNvcnJlc3BvbmRpbmdJbXBvcnQgPSBLTk9XTl9DT05UUk9MX0ZMT1dfRElSRUNUSVZFUy5nZXQocHJvcE5hbWUpOwogICAgbWVzc2FnZSArPSBgCklmIHRoZSAnJHtwcm9wTmFtZX0nIGlzIGFuIEFuZ3VsYXIgY29udHJvbCBmbG93IGRpcmVjdGl2ZSwgcGxlYXNlIG1ha2Ugc3VyZSB0aGF0IGVpdGhlciB0aGUgJyR7Y29ycmVzcG9uZGluZ0ltcG9ydH0nIGRpcmVjdGl2ZSBvciB0aGUgJ0NvbW1vbk1vZHVsZScgaXMgJHtpbXBvcnRMb2NhdGlvbn0uYDsKICB9IGVsc2UgewogICAgbWVzc2FnZSArPSBgCjEuIElmICcke3RhZ05hbWV9JyBpcyBhbiBBbmd1bGFyIGNvbXBvbmVudCBhbmQgaXQgaGFzIHRoZSAnJHtwcm9wTmFtZX0nIGlucHV0LCB0aGVuIHZlcmlmeSB0aGF0IGl0IGlzICR7aW1wb3J0TG9jYXRpb259LmA7CiAgICBpZiAodGFnTmFtZSAmJiB0YWdOYW1lLmluZGV4T2YoIi0iKSA+IC0xKSB7CiAgICAgIG1lc3NhZ2UgKz0gYAoyLiBJZiAnJHt0YWdOYW1lfScgaXMgYSBXZWIgQ29tcG9uZW50IHRoZW4gYWRkICdDVVNUT01fRUxFTUVOVFNfU0NIRU1BJyB0byB0aGUgJHtzY2hlbWFzfSBvZiB0aGlzIGNvbXBvbmVudCB0byBzdXBwcmVzcyB0aGlzIG1lc3NhZ2UuYDsKICAgICAgbWVzc2FnZSArPSBgCjMuIFRvIGFsbG93IGFueSBwcm9wZXJ0eSBhZGQgJ05PX0VSUk9SU19TQ0hFTUEnIHRvIHRoZSAke3NjaGVtYXN9IG9mIHRoaXMgY29tcG9uZW50LmA7CiAgICB9IGVsc2UgewogICAgICBtZXNzYWdlICs9IGAKMi4gVG8gYWxsb3cgYW55IHByb3BlcnR5IGFkZCAnTk9fRVJST1JTX1NDSEVNQScgdG8gdGhlICR7c2NoZW1hc30gb2YgdGhpcyBjb21wb25lbnQuYDsKICAgIH0KICB9CiAgcmVwb3J0VW5rbm93blByb3BlcnR5RXJyb3IobWVzc2FnZSk7Cn0KZnVuY3Rpb24gcmVwb3J0VW5rbm93blByb3BlcnR5RXJyb3IobWVzc2FnZSkgewogIGlmIChzaG91bGRUaHJvd0Vycm9yT25Vbmtub3duUHJvcGVydHkpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMzAzLCBtZXNzYWdlKTsKICB9IGVsc2UgewogICAgY29uc29sZS5lcnJvcihmb3JtYXRSdW50aW1lRXJyb3IoMzAzLCBtZXNzYWdlKSk7CiAgfQp9CmZ1bmN0aW9uIGdldERlY2xhcmF0aW9uQ29tcG9uZW50RGVmKGxWaWV3KSB7CiAgIW5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMigiTXVzdCBuZXZlciBiZSBjYWxsZWQgaW4gcHJvZHVjdGlvbiBtb2RlIik7CiAgY29uc3QgZGVjbGFyYXRpb25MVmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICBjb25zdCBjb250ZXh0MiA9IGRlY2xhcmF0aW9uTFZpZXdbQ09OVEVYVF07CiAgaWYgKCFjb250ZXh0MikgcmV0dXJuIG51bGw7CiAgcmV0dXJuIGNvbnRleHQyLmNvbnN0cnVjdG9yID8gZ2V0Q29tcG9uZW50RGVmKGNvbnRleHQyLmNvbnN0cnVjdG9yKSA6IG51bGw7Cn0KZnVuY3Rpb24gaXNIb3N0Q29tcG9uZW50U3RhbmRhbG9uZShsVmlldykgewogICFuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoIk11c3QgbmV2ZXIgYmUgY2FsbGVkIGluIHByb2R1Y3Rpb24gbW9kZSIpOwogIGNvbnN0IGNvbXBvbmVudERlZiA9IGdldERlY2xhcmF0aW9uQ29tcG9uZW50RGVmKGxWaWV3KTsKICByZXR1cm4gISFjb21wb25lbnREZWY/LnN0YW5kYWxvbmU7Cn0KZnVuY3Rpb24gZ2V0VGVtcGxhdGVMb2NhdGlvbkRldGFpbHMobFZpZXcpIHsKICAhbmdEZXZNb2RlICYmIHRocm93RXJyb3IyKCJNdXN0IG5ldmVyIGJlIGNhbGxlZCBpbiBwcm9kdWN0aW9uIG1vZGUiKTsKICBjb25zdCBob3N0Q29tcG9uZW50RGVmID0gZ2V0RGVjbGFyYXRpb25Db21wb25lbnREZWYobFZpZXcpOwogIGNvbnN0IGNvbXBvbmVudENsYXNzTmFtZSA9IGhvc3RDb21wb25lbnREZWY/LnR5cGU/Lm5hbWU7CiAgcmV0dXJuIGNvbXBvbmVudENsYXNzTmFtZSA/IGAgKHVzZWQgaW4gdGhlICcke2NvbXBvbmVudENsYXNzTmFtZX0nIGNvbXBvbmVudCB0ZW1wbGF0ZSlgIDogIiI7Cn0KdmFyIEtOT1dOX0NPTlRST0xfRkxPV19ESVJFQ1RJVkVTID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoW1sibmdJZiIsICJOZ0lmIl0sIFsibmdGb3IiLCAiTmdGb3IiXSwgWyJuZ1N3aXRjaENhc2UiLCAiTmdTd2l0Y2hDYXNlIl0sIFsibmdTd2l0Y2hEZWZhdWx0IiwgIk5nU3dpdGNoRGVmYXVsdCJdXSk7CmZ1bmN0aW9uIG1hdGNoaW5nU2NoZW1hcyhzY2hlbWFzLCB0YWdOYW1lKSB7CiAgaWYgKHNjaGVtYXMgIT09IG51bGwpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBzY2hlbWEgPSBzY2hlbWFzW2ldOwogICAgICBpZiAoc2NoZW1hID09PSBOT19FUlJPUlNfU0NIRU1BIHx8IHNjaGVtYSA9PT0gQ1VTVE9NX0VMRU1FTlRTX1NDSEVNQSAmJiB0YWdOYW1lICYmIHRhZ05hbWUuaW5kZXhPZigiLSIpID4gLTEpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gZmFsc2U7Cn0KdmFyIHBvbGljeSQxOwpmdW5jdGlvbiBnZXRQb2xpY3kkMSgpIHsKICBpZiAocG9saWN5JDEgPT09IHZvaWQgMCkgewogICAgcG9saWN5JDEgPSBudWxsOwogICAgaWYgKF9nbG9iYWwudHJ1c3RlZFR5cGVzKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcG9saWN5JDEgPSBfZ2xvYmFsLnRydXN0ZWRUeXBlcy5jcmVhdGVQb2xpY3koImFuZ3VsYXIiLCB7CiAgICAgICAgICBjcmVhdGVIVE1MOiAocykgPT4gcywKICAgICAgICAgIGNyZWF0ZVNjcmlwdDogKHMpID0+IHMsCiAgICAgICAgICBjcmVhdGVTY3JpcHRVUkw6IChzKSA9PiBzCiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggewogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBwb2xpY3kkMTsKfQpmdW5jdGlvbiB0cnVzdGVkSFRNTEZyb21TdHJpbmcoaHRtbCkgewogIHJldHVybiBnZXRQb2xpY3kkMSgpPy5jcmVhdGVIVE1MKGh0bWwpIHx8IGh0bWw7Cn0KZnVuY3Rpb24gdHJ1c3RlZFNjcmlwdFVSTEZyb21TdHJpbmcodXJsKSB7CiAgcmV0dXJuIGdldFBvbGljeSQxKCk/LmNyZWF0ZVNjcmlwdFVSTCh1cmwpIHx8IHVybDsKfQp2YXIgcG9saWN5OwpmdW5jdGlvbiBnZXRQb2xpY3koKSB7CiAgaWYgKHBvbGljeSA9PT0gdm9pZCAwKSB7CiAgICBwb2xpY3kgPSBudWxsOwogICAgaWYgKF9nbG9iYWwudHJ1c3RlZFR5cGVzKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcG9saWN5ID0gX2dsb2JhbC50cnVzdGVkVHlwZXMuY3JlYXRlUG9saWN5KCJhbmd1bGFyI3Vuc2FmZS1ieXBhc3MiLCB7CiAgICAgICAgICBjcmVhdGVIVE1MOiAocykgPT4gcywKICAgICAgICAgIGNyZWF0ZVNjcmlwdDogKHMpID0+IHMsCiAgICAgICAgICBjcmVhdGVTY3JpcHRVUkw6IChzKSA9PiBzCiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggewogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBwb2xpY3k7Cn0KZnVuY3Rpb24gdHJ1c3RlZEhUTUxGcm9tU3RyaW5nQnlwYXNzKGh0bWwpIHsKICByZXR1cm4gZ2V0UG9saWN5KCk/LmNyZWF0ZUhUTUwoaHRtbCkgfHwgaHRtbDsKfQpmdW5jdGlvbiB0cnVzdGVkU2NyaXB0RnJvbVN0cmluZ0J5cGFzcyhzY3JpcHQpIHsKICByZXR1cm4gZ2V0UG9saWN5KCk/LmNyZWF0ZVNjcmlwdChzY3JpcHQpIHx8IHNjcmlwdDsKfQpmdW5jdGlvbiB0cnVzdGVkU2NyaXB0VVJMRnJvbVN0cmluZ0J5cGFzcyh1cmwpIHsKICByZXR1cm4gZ2V0UG9saWN5KCk/LmNyZWF0ZVNjcmlwdFVSTCh1cmwpIHx8IHVybDsKfQp2YXIgU2FmZVZhbHVlSW1wbCA9IGNsYXNzIHsKICBjaGFuZ2luZ1RoaXNCcmVha3NBcHBsaWNhdGlvblNlY3VyaXR5OwogIGNvbnN0cnVjdG9yKGNoYW5naW5nVGhpc0JyZWFrc0FwcGxpY2F0aW9uU2VjdXJpdHkpIHsKICAgIHRoaXMuY2hhbmdpbmdUaGlzQnJlYWtzQXBwbGljYXRpb25TZWN1cml0eSA9IGNoYW5naW5nVGhpc0JyZWFrc0FwcGxpY2F0aW9uU2VjdXJpdHk7CiAgfQogIHRvU3RyaW5nKCkgewogICAgcmV0dXJuIGBTYWZlVmFsdWUgbXVzdCB1c2UgW3Byb3BlcnR5XT1iaW5kaW5nOiAke3RoaXMuY2hhbmdpbmdUaGlzQnJlYWtzQXBwbGljYXRpb25TZWN1cml0eX0gKHNlZSAke1hTU19TRUNVUklUWV9VUkx9KWA7CiAgfQp9Owp2YXIgU2FmZUh0bWxJbXBsID0gY2xhc3MgZXh0ZW5kcyBTYWZlVmFsdWVJbXBsIHsKICBnZXRUeXBlTmFtZSgpIHsKICAgIHJldHVybiAiSFRNTCI7CiAgfQp9Owp2YXIgU2FmZVN0eWxlSW1wbCA9IGNsYXNzIGV4dGVuZHMgU2FmZVZhbHVlSW1wbCB7CiAgZ2V0VHlwZU5hbWUoKSB7CiAgICByZXR1cm4gIlN0eWxlIjsKICB9Cn07CnZhciBTYWZlU2NyaXB0SW1wbCA9IGNsYXNzIGV4dGVuZHMgU2FmZVZhbHVlSW1wbCB7CiAgZ2V0VHlwZU5hbWUoKSB7CiAgICByZXR1cm4gIlNjcmlwdCI7CiAgfQp9Owp2YXIgU2FmZVVybEltcGwgPSBjbGFzcyBleHRlbmRzIFNhZmVWYWx1ZUltcGwgewogIGdldFR5cGVOYW1lKCkgewogICAgcmV0dXJuICJVUkwiOwogIH0KfTsKdmFyIFNhZmVSZXNvdXJjZVVybEltcGwgPSBjbGFzcyBleHRlbmRzIFNhZmVWYWx1ZUltcGwgewogIGdldFR5cGVOYW1lKCkgewogICAgcmV0dXJuICJSZXNvdXJjZVVSTCI7CiAgfQp9OwpmdW5jdGlvbiB1bndyYXBTYWZlVmFsdWUodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBTYWZlVmFsdWVJbXBsID8gdmFsdWUuY2hhbmdpbmdUaGlzQnJlYWtzQXBwbGljYXRpb25TZWN1cml0eSA6IHZhbHVlOwp9CmZ1bmN0aW9uIGFsbG93U2FuaXRpemF0aW9uQnlwYXNzQW5kVGhyb3codmFsdWUsIHR5cGUpIHsKICBjb25zdCBhY3R1YWxUeXBlID0gZ2V0U2FuaXRpemF0aW9uQnlwYXNzVHlwZSh2YWx1ZSk7CiAgaWYgKGFjdHVhbFR5cGUgIT0gbnVsbCAmJiBhY3R1YWxUeXBlICE9PSB0eXBlKSB7CiAgICBpZiAoYWN0dWFsVHlwZSA9PT0gIlJlc291cmNlVVJMIiAmJiB0eXBlID09PSAiVVJMIikgcmV0dXJuIHRydWU7CiAgICB0aHJvdyBuZXcgRXJyb3IoYFJlcXVpcmVkIGEgc2FmZSAke3R5cGV9LCBnb3QgYSAke2FjdHVhbFR5cGV9IChzZWUgJHtYU1NfU0VDVVJJVFlfVVJMfSlgKTsKICB9CiAgcmV0dXJuIGFjdHVhbFR5cGUgPT09IHR5cGU7Cn0KZnVuY3Rpb24gZ2V0U2FuaXRpemF0aW9uQnlwYXNzVHlwZSh2YWx1ZSkgewogIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFNhZmVWYWx1ZUltcGwgJiYgdmFsdWUuZ2V0VHlwZU5hbWUoKSB8fCBudWxsOwp9CmZ1bmN0aW9uIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0SHRtbCh0cnVzdGVkSHRtbCkgewogIHJldHVybiBuZXcgU2FmZUh0bWxJbXBsKHRydXN0ZWRIdG1sKTsKfQpmdW5jdGlvbiBieXBhc3NTYW5pdGl6YXRpb25UcnVzdFN0eWxlKHRydXN0ZWRTdHlsZSkgewogIHJldHVybiBuZXcgU2FmZVN0eWxlSW1wbCh0cnVzdGVkU3R5bGUpOwp9CmZ1bmN0aW9uIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0U2NyaXB0KHRydXN0ZWRTY3JpcHQpIHsKICByZXR1cm4gbmV3IFNhZmVTY3JpcHRJbXBsKHRydXN0ZWRTY3JpcHQpOwp9CmZ1bmN0aW9uIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0VXJsKHRydXN0ZWRVcmwpIHsKICByZXR1cm4gbmV3IFNhZmVVcmxJbXBsKHRydXN0ZWRVcmwpOwp9CmZ1bmN0aW9uIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0UmVzb3VyY2VVcmwodHJ1c3RlZFJlc291cmNlVXJsKSB7CiAgcmV0dXJuIG5ldyBTYWZlUmVzb3VyY2VVcmxJbXBsKHRydXN0ZWRSZXNvdXJjZVVybCk7Cn0KZnVuY3Rpb24gZ2V0SW5lcnRCb2R5SGVscGVyKGRlZmF1bHREb2MpIHsKICBjb25zdCBpbmVydERvY3VtZW50SGVscGVyID0gbmV3IEluZXJ0RG9jdW1lbnRIZWxwZXIoZGVmYXVsdERvYyk7CiAgcmV0dXJuIGlzRE9NUGFyc2VyQXZhaWxhYmxlKCkgPyBuZXcgRE9NUGFyc2VySGVscGVyKGluZXJ0RG9jdW1lbnRIZWxwZXIpIDogaW5lcnREb2N1bWVudEhlbHBlcjsKfQp2YXIgRE9NUGFyc2VySGVscGVyID0gY2xhc3MgewogIGluZXJ0RG9jdW1lbnRIZWxwZXI7CiAgY29uc3RydWN0b3IoaW5lcnREb2N1bWVudEhlbHBlcikgewogICAgdGhpcy5pbmVydERvY3VtZW50SGVscGVyID0gaW5lcnREb2N1bWVudEhlbHBlcjsKICB9CiAgZ2V0SW5lcnRCb2R5RWxlbWVudChodG1sKSB7CiAgICBodG1sID0gIjxib2R5PjxyZW1vdmU+PC9yZW1vdmU+IiArIGh0bWw7CiAgICB0cnkgewogICAgICBjb25zdCBib2R5ID0gbmV3IHdpbmRvdy5ET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcodHJ1c3RlZEhUTUxGcm9tU3RyaW5nKGh0bWwpLCAidGV4dC9odG1sIikuYm9keTsKICAgICAgaWYgKGJvZHkgPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5pbmVydERvY3VtZW50SGVscGVyLmdldEluZXJ0Qm9keUVsZW1lbnQoaHRtbCk7CiAgICAgIH0KICAgICAgYm9keS5maXJzdENoaWxkPy5yZW1vdmUoKTsKICAgICAgcmV0dXJuIGJvZHk7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQp9Owp2YXIgSW5lcnREb2N1bWVudEhlbHBlciA9IGNsYXNzIHsKICBkZWZhdWx0RG9jOwogIGluZXJ0RG9jdW1lbnQ7CiAgY29uc3RydWN0b3IoZGVmYXVsdERvYykgewogICAgdGhpcy5kZWZhdWx0RG9jID0gZGVmYXVsdERvYzsKICAgIHRoaXMuaW5lcnREb2N1bWVudCA9IHRoaXMuZGVmYXVsdERvYy5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoInNhbml0aXphdGlvbi1pbmVydCIpOwogIH0KICBnZXRJbmVydEJvZHlFbGVtZW50KGh0bWwpIHsKICAgIGNvbnN0IHRlbXBsYXRlRWwgPSB0aGlzLmluZXJ0RG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGVtcGxhdGUiKTsKICAgIHRlbXBsYXRlRWwuaW5uZXJIVE1MID0gdHJ1c3RlZEhUTUxGcm9tU3RyaW5nKGh0bWwpOwogICAgcmV0dXJuIHRlbXBsYXRlRWw7CiAgfQp9OwpmdW5jdGlvbiBpc0RPTVBhcnNlckF2YWlsYWJsZSgpIHsKICB0cnkgewogICAgcmV0dXJuICEhbmV3IHdpbmRvdy5ET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcodHJ1c3RlZEhUTUxGcm9tU3RyaW5nKCIiKSwgInRleHQvaHRtbCIpOwogIH0gY2F0Y2ggewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQp2YXIgU0FGRV9VUkxfUEFUVEVSTiA9IC9eKD8hamF2YXNjcmlwdDopKD86W2EtejAtOSsuLV0rOnxbXiY6XC8/I10qKD86W1wvPyNdfCQpKS9pOwpmdW5jdGlvbiBfc2FuaXRpemVVcmwodXJsKSB7CiAgdXJsID0gU3RyaW5nKHVybCk7CiAgaWYgKHVybC5tYXRjaChTQUZFX1VSTF9QQVRURVJOKSkgcmV0dXJuIHVybDsKICBpZiAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSB7CiAgICBjb25zb2xlLndhcm4oYFdBUk5JTkc6IHNhbml0aXppbmcgdW5zYWZlIFVSTCB2YWx1ZSAke3VybH0gKHNlZSAke1hTU19TRUNVUklUWV9VUkx9KWApOwogIH0KICByZXR1cm4gInVuc2FmZToiICsgdXJsOwp9CmZ1bmN0aW9uIHRhZ1NldCh0YWdzKSB7CiAgY29uc3QgcmVzID0ge307CiAgZm9yIChjb25zdCB0IG9mIHRhZ3Muc3BsaXQoIiwiKSkgcmVzW3RdID0gdHJ1ZTsKICByZXR1cm4gcmVzOwp9CmZ1bmN0aW9uIG1lcmdlMyguLi5zZXRzKSB7CiAgY29uc3QgcmVzID0ge307CiAgZm9yIChjb25zdCBzIG9mIHNldHMpIHsKICAgIGZvciAoY29uc3QgdiBpbiBzKSB7CiAgICAgIGlmIChzLmhhc093blByb3BlcnR5KHYpKSByZXNbdl0gPSB0cnVlOwogICAgfQogIH0KICByZXR1cm4gcmVzOwp9CnZhciBWT0lEX0VMRU1FTlRTID0gdGFnU2V0KCJhcmVhLGJyLGNvbCxocixpbWcsd2JyIik7CnZhciBPUFRJT05BTF9FTkRfVEFHX0JMT0NLX0VMRU1FTlRTID0gdGFnU2V0KCJjb2xncm91cCxkZCxkdCxsaSxwLHRib2R5LHRkLHRmb290LHRoLHRoZWFkLHRyIik7CnZhciBPUFRJT05BTF9FTkRfVEFHX0lOTElORV9FTEVNRU5UUyA9IHRhZ1NldCgicnAscnQiKTsKdmFyIE9QVElPTkFMX0VORF9UQUdfRUxFTUVOVFMgPSBtZXJnZTMoT1BUSU9OQUxfRU5EX1RBR19JTkxJTkVfRUxFTUVOVFMsIE9QVElPTkFMX0VORF9UQUdfQkxPQ0tfRUxFTUVOVFMpOwp2YXIgQkxPQ0tfRUxFTUVOVFMgPSBtZXJnZTMoT1BUSU9OQUxfRU5EX1RBR19CTE9DS19FTEVNRU5UUywgdGFnU2V0KCJhZGRyZXNzLGFydGljbGUsYXNpZGUsYmxvY2txdW90ZSxjYXB0aW9uLGNlbnRlcixkZWwsZGV0YWlscyxkaWFsb2csZGlyLGRpdixkbCxmaWd1cmUsZmlnY2FwdGlvbixmb290ZXIsaDEsaDIsaDMsaDQsaDUsaDYsaGVhZGVyLGhncm91cCxocixpbnMsbWFpbixtYXAsbWVudSxuYXYsb2wscHJlLHNlY3Rpb24sc3VtbWFyeSx0YWJsZSx1bCIpKTsKdmFyIElOTElORV9FTEVNRU5UUyA9IG1lcmdlMyhPUFRJT05BTF9FTkRfVEFHX0lOTElORV9FTEVNRU5UUywgdGFnU2V0KCJhLGFiYnIsYWNyb255bSxhdWRpbyxiLGJkaSxiZG8sYmlnLGJyLGNpdGUsY29kZSxkZWwsZGZuLGVtLGZvbnQsaSxpbWcsaW5zLGtiZCxsYWJlbCxtYXAsbWFyayxwaWN0dXJlLHEscnVieSxycCxydCxzLHNhbXAsc21hbGwsc291cmNlLHNwYW4sc3RyaWtlLHN0cm9uZyxzdWIsc3VwLHRpbWUsdHJhY2ssdHQsdSx2YXIsdmlkZW8iKSk7CnZhciBWQUxJRF9FTEVNRU5UUyA9IG1lcmdlMyhWT0lEX0VMRU1FTlRTLCBCTE9DS19FTEVNRU5UUywgSU5MSU5FX0VMRU1FTlRTLCBPUFRJT05BTF9FTkRfVEFHX0VMRU1FTlRTKTsKdmFyIFVSSV9BVFRSUyA9IHRhZ1NldCgiYmFja2dyb3VuZCxjaXRlLGhyZWYsaXRlbXR5cGUsbG9uZ2Rlc2MscG9zdGVyLHNyYyx4bGluazpocmVmIik7CnZhciBIVE1MX0FUVFJTID0gdGFnU2V0KCJhYmJyLGFjY2Vzc2tleSxhbGlnbixhbHQsYXV0b3BsYXksYXhpcyxiZ2NvbG9yLGJvcmRlcixjZWxscGFkZGluZyxjZWxsc3BhY2luZyxjbGFzcyxjbGVhcixjb2xvcixjb2xzLGNvbHNwYW4sY29tcGFjdCxjb250cm9scyxjb29yZHMsZGF0ZXRpbWUsZGVmYXVsdCxkaXIsZG93bmxvYWQsZmFjZSxoZWFkZXJzLGhlaWdodCxoaWRkZW4saHJlZmxhbmcsaHNwYWNlLGlzbWFwLGl0ZW1zY29wZSxpdGVtcHJvcCxraW5kLGxhYmVsLGxhbmcsbGFuZ3VhZ2UsbG9vcCxtZWRpYSxtdXRlZCxub2hyZWYsbm93cmFwLG9wZW4scHJlbG9hZCxyZWwscmV2LHJvbGUscm93cyxyb3dzcGFuLHJ1bGVzLHNjb3BlLHNjcm9sbGluZyxzaGFwZSxzaXplLHNpemVzLHNwYW4sc3JjbGFuZyxzcmNzZXQsc3RhcnQsc3VtbWFyeSx0YWJpbmRleCx0YXJnZXQsdGl0bGUsdHJhbnNsYXRlLHR5cGUsdXNlbWFwLHZhbGlnbix2YWx1ZSx2c3BhY2Usd2lkdGgiKTsKdmFyIEFSSUFfQVRUUlMgPSB0YWdTZXQoImFyaWEtYWN0aXZlZGVzY2VuZGFudCxhcmlhLWF0b21pYyxhcmlhLWF1dG9jb21wbGV0ZSxhcmlhLWJ1c3ksYXJpYS1jaGVja2VkLGFyaWEtY29sY291bnQsYXJpYS1jb2xpbmRleCxhcmlhLWNvbHNwYW4sYXJpYS1jb250cm9scyxhcmlhLWN1cnJlbnQsYXJpYS1kZXNjcmliZWRieSxhcmlhLWRldGFpbHMsYXJpYS1kaXNhYmxlZCxhcmlhLWRyb3BlZmZlY3QsYXJpYS1lcnJvcm1lc3NhZ2UsYXJpYS1leHBhbmRlZCxhcmlhLWZsb3d0byxhcmlhLWdyYWJiZWQsYXJpYS1oYXNwb3B1cCxhcmlhLWhpZGRlbixhcmlhLWludmFsaWQsYXJpYS1rZXlzaG9ydGN1dHMsYXJpYS1sYWJlbCxhcmlhLWxhYmVsbGVkYnksYXJpYS1sZXZlbCxhcmlhLWxpdmUsYXJpYS1tb2RhbCxhcmlhLW11bHRpbGluZSxhcmlhLW11bHRpc2VsZWN0YWJsZSxhcmlhLW9yaWVudGF0aW9uLGFyaWEtb3ducyxhcmlhLXBsYWNlaG9sZGVyLGFyaWEtcG9zaW5zZXQsYXJpYS1wcmVzc2VkLGFyaWEtcmVhZG9ubHksYXJpYS1yZWxldmFudCxhcmlhLXJlcXVpcmVkLGFyaWEtcm9sZWRlc2NyaXB0aW9uLGFyaWEtcm93Y291bnQsYXJpYS1yb3dpbmRleCxhcmlhLXJvd3NwYW4sYXJpYS1zZWxlY3RlZCxhcmlhLXNldHNpemUsYXJpYS1zb3J0LGFyaWEtdmFsdWVtYXgsYXJpYS12YWx1ZW1pbixhcmlhLXZhbHVlbm93LGFyaWEtdmFsdWV0ZXh0Iik7CnZhciBWQUxJRF9BVFRSUyA9IG1lcmdlMyhVUklfQVRUUlMsIEhUTUxfQVRUUlMsIEFSSUFfQVRUUlMpOwp2YXIgU0tJUF9UUkFWRVJTSU5HX0NPTlRFTlRfSUZfSU5WQUxJRF9FTEVNRU5UUyA9IHRhZ1NldCgic2NyaXB0LHN0eWxlLHRlbXBsYXRlIik7CnZhciBTYW5pdGl6aW5nSHRtbFNlcmlhbGl6ZXIgPSBjbGFzcyB7CiAgc2FuaXRpemVkU29tZXRoaW5nID0gZmFsc2U7CiAgYnVmID0gW107CiAgc2FuaXRpemVDaGlsZHJlbihlbCkgewogICAgbGV0IGN1cnJlbnQgPSBlbC5maXJzdENoaWxkOwogICAgbGV0IHRyYXZlcnNlQ29udGVudCA9IHRydWU7CiAgICBsZXQgcGFyZW50Tm9kZXMgPSBbXTsKICAgIHdoaWxlIChjdXJyZW50KSB7CiAgICAgIGlmIChjdXJyZW50Lm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkgewogICAgICAgIHRyYXZlcnNlQ29udGVudCA9IHRoaXMuc3RhcnRFbGVtZW50KGN1cnJlbnQpOwogICAgICB9IGVsc2UgaWYgKGN1cnJlbnQubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7CiAgICAgICAgdGhpcy5jaGFycyhjdXJyZW50Lm5vZGVWYWx1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zYW5pdGl6ZWRTb21ldGhpbmcgPSB0cnVlOwogICAgICB9CiAgICAgIGlmICh0cmF2ZXJzZUNvbnRlbnQgJiYgY3VycmVudC5maXJzdENoaWxkKSB7CiAgICAgICAgcGFyZW50Tm9kZXMucHVzaChjdXJyZW50KTsKICAgICAgICBjdXJyZW50ID0gZ2V0Rmlyc3RDaGlsZChjdXJyZW50KTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICB3aGlsZSAoY3VycmVudCkgewogICAgICAgIGlmIChjdXJyZW50Lm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgdGhpcy5lbmRFbGVtZW50KGN1cnJlbnQpOwogICAgICAgIH0KICAgICAgICBsZXQgbmV4dCA9IGdldE5leHRTaWJsaW5nKGN1cnJlbnQpOwogICAgICAgIGlmIChuZXh0KSB7CiAgICAgICAgICBjdXJyZW50ID0gbmV4dDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjdXJyZW50ID0gcGFyZW50Tm9kZXMucG9wKCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0aGlzLmJ1Zi5qb2luKCIiKTsKICB9CiAgc3RhcnRFbGVtZW50KGVsZW1lbnQpIHsKICAgIGNvbnN0IHRhZ05hbWUgPSBnZXROb2RlTmFtZShlbGVtZW50KS50b0xvd2VyQ2FzZSgpOwogICAgaWYgKCFWQUxJRF9FTEVNRU5UUy5oYXNPd25Qcm9wZXJ0eSh0YWdOYW1lKSkgewogICAgICB0aGlzLnNhbml0aXplZFNvbWV0aGluZyA9IHRydWU7CiAgICAgIHJldHVybiAhU0tJUF9UUkFWRVJTSU5HX0NPTlRFTlRfSUZfSU5WQUxJRF9FTEVNRU5UUy5oYXNPd25Qcm9wZXJ0eSh0YWdOYW1lKTsKICAgIH0KICAgIHRoaXMuYnVmLnB1c2goIjwiKTsKICAgIHRoaXMuYnVmLnB1c2godGFnTmFtZSk7CiAgICBjb25zdCBlbEF0dHJzID0gZWxlbWVudC5hdHRyaWJ1dGVzOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbEF0dHJzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGVsQXR0ciA9IGVsQXR0cnMuaXRlbShpKTsKICAgICAgY29uc3QgYXR0ck5hbWUgPSBlbEF0dHIubmFtZTsKICAgICAgY29uc3QgbG93ZXIgPSBhdHRyTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAoIVZBTElEX0FUVFJTLmhhc093blByb3BlcnR5KGxvd2VyKSkgewogICAgICAgIHRoaXMuc2FuaXRpemVkU29tZXRoaW5nID0gdHJ1ZTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBsZXQgdmFsdWUgPSBlbEF0dHIudmFsdWU7CiAgICAgIGlmIChVUklfQVRUUlNbbG93ZXJdKSB2YWx1ZSA9IF9zYW5pdGl6ZVVybCh2YWx1ZSk7CiAgICAgIHRoaXMuYnVmLnB1c2goIiAiLCBhdHRyTmFtZSwgJz0iJywgZW5jb2RlRW50aXRpZXModmFsdWUpLCAnIicpOwogICAgfQogICAgdGhpcy5idWYucHVzaCgiPiIpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGVuZEVsZW1lbnQoY3VycmVudCkgewogICAgY29uc3QgdGFnTmFtZSA9IGdldE5vZGVOYW1lKGN1cnJlbnQpLnRvTG93ZXJDYXNlKCk7CiAgICBpZiAoVkFMSURfRUxFTUVOVFMuaGFzT3duUHJvcGVydHkodGFnTmFtZSkgJiYgIVZPSURfRUxFTUVOVFMuaGFzT3duUHJvcGVydHkodGFnTmFtZSkpIHsKICAgICAgdGhpcy5idWYucHVzaCgiPC8iKTsKICAgICAgdGhpcy5idWYucHVzaCh0YWdOYW1lKTsKICAgICAgdGhpcy5idWYucHVzaCgiPiIpOwogICAgfQogIH0KICBjaGFycyhjaGFycykgewogICAgdGhpcy5idWYucHVzaChlbmNvZGVFbnRpdGllcyhjaGFycykpOwogIH0KfTsKZnVuY3Rpb24gaXNDbG9iYmVyZWRFbGVtZW50KHBhcmVudE5vZGUsIGNoaWxkTm9kZSkgewogIHJldHVybiAocGFyZW50Tm9kZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihjaGlsZE5vZGUpICYgTm9kZS5ET0NVTUVOVF9QT1NJVElPTl9DT05UQUlORURfQlkpICE9PSBOb2RlLkRPQ1VNRU5UX1BPU0lUSU9OX0NPTlRBSU5FRF9CWTsKfQpmdW5jdGlvbiBnZXROZXh0U2libGluZyhub2RlKSB7CiAgY29uc3QgbmV4dFNpYmxpbmcgPSBub2RlLm5leHRTaWJsaW5nOwogIGlmIChuZXh0U2libGluZyAmJiBub2RlICE9PSBuZXh0U2libGluZy5wcmV2aW91c1NpYmxpbmcpIHsKICAgIHRocm93IGNsb2JiZXJlZEVsZW1lbnRFcnJvcihuZXh0U2libGluZyk7CiAgfQogIHJldHVybiBuZXh0U2libGluZzsKfQpmdW5jdGlvbiBnZXRGaXJzdENoaWxkKG5vZGUpIHsKICBjb25zdCBmaXJzdENoaWxkID0gbm9kZS5maXJzdENoaWxkOwogIGlmIChmaXJzdENoaWxkICYmIGlzQ2xvYmJlcmVkRWxlbWVudChub2RlLCBmaXJzdENoaWxkKSkgewogICAgdGhyb3cgY2xvYmJlcmVkRWxlbWVudEVycm9yKGZpcnN0Q2hpbGQpOwogIH0KICByZXR1cm4gZmlyc3RDaGlsZDsKfQpmdW5jdGlvbiBnZXROb2RlTmFtZShub2RlKSB7CiAgY29uc3Qgbm9kZU5hbWUgPSBub2RlLm5vZGVOYW1lOwogIHJldHVybiB0eXBlb2Ygbm9kZU5hbWUgPT09ICJzdHJpbmciID8gbm9kZU5hbWUgOiAiRk9STSI7Cn0KZnVuY3Rpb24gY2xvYmJlcmVkRWxlbWVudEVycm9yKG5vZGUpIHsKICByZXR1cm4gbmV3IEVycm9yKGBGYWlsZWQgdG8gc2FuaXRpemUgaHRtbCBiZWNhdXNlIHRoZSBlbGVtZW50IGlzIGNsb2JiZXJlZDogJHtub2RlLm91dGVySFRNTH1gKTsKfQp2YXIgU1VSUk9HQVRFX1BBSVJfUkVHRVhQID0gL1tcdUQ4MDAtXHVEQkZGXVtcdURDMDAtXHVERkZGXS9nOwp2YXIgTk9OX0FMUEhBTlVNRVJJQ19SRUdFWFAgPSAvKFteXCMtfiB8IV0pL2c7CmZ1bmN0aW9uIGVuY29kZUVudGl0aWVzKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoLyYvZywgIiZhbXA7IikucmVwbGFjZShTVVJST0dBVEVfUEFJUl9SRUdFWFAsIGZ1bmN0aW9uKG1hdGNoKSB7CiAgICBjb25zdCBoaSA9IG1hdGNoLmNoYXJDb2RlQXQoMCk7CiAgICBjb25zdCBsb3cgPSBtYXRjaC5jaGFyQ29kZUF0KDEpOwogICAgcmV0dXJuICImIyIgKyAoKGhpIC0gNTUyOTYpICogMTAyNCArIChsb3cgLSA1NjMyMCkgKyA2NTUzNikgKyAiOyI7CiAgfSkucmVwbGFjZShOT05fQUxQSEFOVU1FUklDX1JFR0VYUCwgZnVuY3Rpb24obWF0Y2gpIHsKICAgIHJldHVybiAiJiMiICsgbWF0Y2guY2hhckNvZGVBdCgwKSArICI7IjsKICB9KS5yZXBsYWNlKC88L2csICImbHQ7IikucmVwbGFjZSgvPi9nLCAiJmd0OyIpOwp9CnZhciBpbmVydEJvZHlIZWxwZXI7CmZ1bmN0aW9uIF9zYW5pdGl6ZUh0bWwoZGVmYXVsdERvYywgdW5zYWZlSHRtbElucHV0KSB7CiAgbGV0IGluZXJ0Qm9keUVsZW1lbnQgPSBudWxsOwogIHRyeSB7CiAgICBpbmVydEJvZHlIZWxwZXIgPSBpbmVydEJvZHlIZWxwZXIgfHwgZ2V0SW5lcnRCb2R5SGVscGVyKGRlZmF1bHREb2MpOwogICAgbGV0IHVuc2FmZUh0bWwgPSB1bnNhZmVIdG1sSW5wdXQgPyBTdHJpbmcodW5zYWZlSHRtbElucHV0KSA6ICIiOwogICAgaW5lcnRCb2R5RWxlbWVudCA9IGluZXJ0Qm9keUhlbHBlci5nZXRJbmVydEJvZHlFbGVtZW50KHVuc2FmZUh0bWwpOwogICAgbGV0IG1YU1NBdHRlbXB0cyA9IDU7CiAgICBsZXQgcGFyc2VkSHRtbCA9IHVuc2FmZUh0bWw7CiAgICBkbyB7CiAgICAgIGlmIChtWFNTQXR0ZW1wdHMgPT09IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZhaWxlZCB0byBzYW5pdGl6ZSBodG1sIGJlY2F1c2UgdGhlIGlucHV0IGlzIHVuc3RhYmxlIik7CiAgICAgIH0KICAgICAgbVhTU0F0dGVtcHRzLS07CiAgICAgIHVuc2FmZUh0bWwgPSBwYXJzZWRIdG1sOwogICAgICBwYXJzZWRIdG1sID0gaW5lcnRCb2R5RWxlbWVudC5pbm5lckhUTUw7CiAgICAgIGluZXJ0Qm9keUVsZW1lbnQgPSBpbmVydEJvZHlIZWxwZXIuZ2V0SW5lcnRCb2R5RWxlbWVudCh1bnNhZmVIdG1sKTsKICAgIH0gd2hpbGUgKHVuc2FmZUh0bWwgIT09IHBhcnNlZEh0bWwpOwogICAgY29uc3Qgc2FuaXRpemVyID0gbmV3IFNhbml0aXppbmdIdG1sU2VyaWFsaXplcigpOwogICAgY29uc3Qgc2FmZUh0bWwgPSBzYW5pdGl6ZXIuc2FuaXRpemVDaGlsZHJlbihnZXRUZW1wbGF0ZUNvbnRlbnQoaW5lcnRCb2R5RWxlbWVudCkgfHwgaW5lcnRCb2R5RWxlbWVudCk7CiAgICBpZiAoKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgc2FuaXRpemVyLnNhbml0aXplZFNvbWV0aGluZykgewogICAgICBjb25zb2xlLndhcm4oYFdBUk5JTkc6IHNhbml0aXppbmcgSFRNTCBzdHJpcHBlZCBzb21lIGNvbnRlbnQsIHNlZSAke1hTU19TRUNVUklUWV9VUkx9YCk7CiAgICB9CiAgICByZXR1cm4gdHJ1c3RlZEhUTUxGcm9tU3RyaW5nKHNhZmVIdG1sKTsKICB9IGZpbmFsbHkgewogICAgaWYgKGluZXJ0Qm9keUVsZW1lbnQpIHsKICAgICAgY29uc3QgcGFyZW50ID0gZ2V0VGVtcGxhdGVDb250ZW50KGluZXJ0Qm9keUVsZW1lbnQpIHx8IGluZXJ0Qm9keUVsZW1lbnQ7CiAgICAgIHdoaWxlIChwYXJlbnQuZmlyc3RDaGlsZCkgewogICAgICAgIHBhcmVudC5maXJzdENoaWxkLnJlbW92ZSgpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGdldFRlbXBsYXRlQ29udGVudChlbCkgewogIHJldHVybiAiY29udGVudCIgaW4gZWwgJiYgaXNUZW1wbGF0ZUVsZW1lbnQoZWwpID8gZWwuY29udGVudCA6IG51bGw7Cn0KZnVuY3Rpb24gaXNUZW1wbGF0ZUVsZW1lbnQoZWwpIHsKICByZXR1cm4gZWwubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFICYmIGVsLm5vZGVOYW1lID09PSAiVEVNUExBVEUiOwp9CnZhciBDT01NRU5UX0RJU0FMTE9XRUQgPSAvXj58Xi0+fDwhLS18LS0+fC0tIT58PCEtJC9nOwp2YXIgQ09NTUVOVF9ERUxJTUlURVIgPSAvKDx8PikvZzsKdmFyIENPTU1FTlRfREVMSU1JVEVSX0VTQ0FQRUQgPSAi4oCLJDHigIsiOwpmdW5jdGlvbiBlc2NhcGVDb21tZW50VGV4dCh2YWx1ZSkgewogIHJldHVybiB2YWx1ZS5yZXBsYWNlKENPTU1FTlRfRElTQUxMT1dFRCwgKHRleHQpID0+IHRleHQucmVwbGFjZShDT01NRU5UX0RFTElNSVRFUiwgQ09NTUVOVF9ERUxJTUlURVJfRVNDQVBFRCkpOwp9CmZ1bmN0aW9uIGNyZWF0ZVRleHROb2RlKHJlbmRlcmVyLCB2YWx1ZSkgewogIHJldHVybiByZW5kZXJlci5jcmVhdGVUZXh0KHZhbHVlKTsKfQpmdW5jdGlvbiB1cGRhdGVUZXh0Tm9kZShyZW5kZXJlciwgck5vZGUsIHZhbHVlKSB7CiAgcmVuZGVyZXIuc2V0VmFsdWUock5vZGUsIHZhbHVlKTsKfQpmdW5jdGlvbiBjcmVhdGVDb21tZW50Tm9kZShyZW5kZXJlciwgdmFsdWUpIHsKICByZXR1cm4gcmVuZGVyZXIuY3JlYXRlQ29tbWVudChlc2NhcGVDb21tZW50VGV4dCh2YWx1ZSkpOwp9CmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnROb2RlKHJlbmRlcmVyLCBuYW1lLCBuYW1lc3BhY2UpIHsKICByZXR1cm4gcmVuZGVyZXIuY3JlYXRlRWxlbWVudChuYW1lLCBuYW1lc3BhY2UpOwp9CmZ1bmN0aW9uIG5hdGl2ZUluc2VydEJlZm9yZShyZW5kZXJlciwgcGFyZW50LCBjaGlsZCwgYmVmb3JlTm9kZSwgaXNNb3ZlKSB7CiAgcmVuZGVyZXIuaW5zZXJ0QmVmb3JlKHBhcmVudCwgY2hpbGQsIGJlZm9yZU5vZGUsIGlzTW92ZSk7Cn0KZnVuY3Rpb24gbmF0aXZlQXBwZW5kQ2hpbGQocmVuZGVyZXIsIHBhcmVudCwgY2hpbGQpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChwYXJlbnQsICJwYXJlbnQgbm9kZSBtdXN0IGJlIGRlZmluZWQiKTsKICByZW5kZXJlci5hcHBlbmRDaGlsZChwYXJlbnQsIGNoaWxkKTsKfQpmdW5jdGlvbiBuYXRpdmVBcHBlbmRPckluc2VydEJlZm9yZShyZW5kZXJlciwgcGFyZW50LCBjaGlsZCwgYmVmb3JlTm9kZSwgaXNNb3ZlKSB7CiAgaWYgKGJlZm9yZU5vZGUgIT09IG51bGwpIHsKICAgIG5hdGl2ZUluc2VydEJlZm9yZShyZW5kZXJlciwgcGFyZW50LCBjaGlsZCwgYmVmb3JlTm9kZSwgaXNNb3ZlKTsKICB9IGVsc2UgewogICAgbmF0aXZlQXBwZW5kQ2hpbGQocmVuZGVyZXIsIHBhcmVudCwgY2hpbGQpOwogIH0KfQpmdW5jdGlvbiBuYXRpdmVSZW1vdmVOb2RlKHJlbmRlcmVyLCByTm9kZSwgaXNIb3N0RWxlbWVudCwgcmVxdWlyZVN5bmNocm9ub3VzRWxlbWVudFJlbW92YWwpIHsKICByZW5kZXJlci5yZW1vdmVDaGlsZChudWxsLCByTm9kZSwgaXNIb3N0RWxlbWVudCwgcmVxdWlyZVN5bmNocm9ub3VzRWxlbWVudFJlbW92YWwpOwp9CmZ1bmN0aW9uIGNsZWFyRWxlbWVudENvbnRlbnRzKHJFbGVtZW50KSB7CiAgckVsZW1lbnQudGV4dENvbnRlbnQgPSAiIjsKfQpmdW5jdGlvbiB3cml0ZURpcmVjdFN0eWxlKHJlbmRlcmVyLCBlbGVtZW50LCBuZXdWYWx1ZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRTdHJpbmcobmV3VmFsdWUsICInbmV3VmFsdWUnIHNob3VsZCBiZSBhIHN0cmluZyIpOwogIHJlbmRlcmVyLnNldEF0dHJpYnV0ZShlbGVtZW50LCAic3R5bGUiLCBuZXdWYWx1ZSk7Cn0KZnVuY3Rpb24gd3JpdGVEaXJlY3RDbGFzcyhyZW5kZXJlciwgZWxlbWVudCwgbmV3VmFsdWUpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0U3RyaW5nKG5ld1ZhbHVlLCAiJ25ld1ZhbHVlJyBzaG91bGQgYmUgYSBzdHJpbmciKTsKICBpZiAobmV3VmFsdWUgPT09ICIiKSB7CiAgICByZW5kZXJlci5yZW1vdmVBdHRyaWJ1dGUoZWxlbWVudCwgImNsYXNzIik7CiAgfSBlbHNlIHsKICAgIHJlbmRlcmVyLnNldEF0dHJpYnV0ZShlbGVtZW50LCAiY2xhc3MiLCBuZXdWYWx1ZSk7CiAgfQp9CmZ1bmN0aW9uIHNldHVwU3RhdGljQXR0cmlidXRlcyhyZW5kZXJlciwgZWxlbWVudCwgdE5vZGUpIHsKICBjb25zdCB7CiAgICBtZXJnZWRBdHRycywKICAgIGNsYXNzZXMsCiAgICBzdHlsZXMKICB9ID0gdE5vZGU7CiAgaWYgKG1lcmdlZEF0dHJzICE9PSBudWxsKSB7CiAgICBzZXRVcEF0dHJpYnV0ZXMocmVuZGVyZXIsIGVsZW1lbnQsIG1lcmdlZEF0dHJzKTsKICB9CiAgaWYgKGNsYXNzZXMgIT09IG51bGwpIHsKICAgIHdyaXRlRGlyZWN0Q2xhc3MocmVuZGVyZXIsIGVsZW1lbnQsIGNsYXNzZXMpOwogIH0KICBpZiAoc3R5bGVzICE9PSBudWxsKSB7CiAgICB3cml0ZURpcmVjdFN0eWxlKHJlbmRlcmVyLCBlbGVtZW50LCBzdHlsZXMpOwogIH0KfQpmdW5jdGlvbiBlbmZvcmNlSWZyYW1lU2VjdXJpdHkoaWZyYW1lKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGlmcmFtZS5zcmMgPSAiIjsKICBpZnJhbWUuc3JjZG9jID0gdHJ1c3RlZEhUTUxGcm9tU3RyaW5nKCIiKTsKICBuYXRpdmVSZW1vdmVOb2RlKGxWaWV3W1JFTkRFUkVSXSwgaWZyYW1lKTsKfQp2YXIgU2VjdXJpdHlDb250ZXh0OwooZnVuY3Rpb24oU2VjdXJpdHlDb250ZXh0MikgewogIFNlY3VyaXR5Q29udGV4dDJbU2VjdXJpdHlDb250ZXh0MlsiTk9ORSJdID0gMF0gPSAiTk9ORSI7CiAgU2VjdXJpdHlDb250ZXh0MltTZWN1cml0eUNvbnRleHQyWyJIVE1MIl0gPSAxXSA9ICJIVE1MIjsKICBTZWN1cml0eUNvbnRleHQyW1NlY3VyaXR5Q29udGV4dDJbIlNUWUxFIl0gPSAyXSA9ICJTVFlMRSI7CiAgU2VjdXJpdHlDb250ZXh0MltTZWN1cml0eUNvbnRleHQyWyJTQ1JJUFQiXSA9IDNdID0gIlNDUklQVCI7CiAgU2VjdXJpdHlDb250ZXh0MltTZWN1cml0eUNvbnRleHQyWyJVUkwiXSA9IDRdID0gIlVSTCI7CiAgU2VjdXJpdHlDb250ZXh0MltTZWN1cml0eUNvbnRleHQyWyJSRVNPVVJDRV9VUkwiXSA9IDVdID0gIlJFU09VUkNFX1VSTCI7Cn0pKFNlY3VyaXR5Q29udGV4dCB8fCAoU2VjdXJpdHlDb250ZXh0ID0ge30pKTsKZnVuY3Rpb24gybXJtXNhbml0aXplSHRtbCh1bnNhZmVIdG1sKSB7CiAgY29uc3Qgc2FuaXRpemVyID0gZ2V0U2FuaXRpemVyKCk7CiAgaWYgKHNhbml0aXplcikgewogICAgcmV0dXJuIHRydXN0ZWRIVE1MRnJvbVN0cmluZ0J5cGFzcyhzYW5pdGl6ZXIuc2FuaXRpemUoU2VjdXJpdHlDb250ZXh0LkhUTUwsIHVuc2FmZUh0bWwpIHx8ICIiKTsKICB9CiAgaWYgKGFsbG93U2FuaXRpemF0aW9uQnlwYXNzQW5kVGhyb3codW5zYWZlSHRtbCwgIkhUTUwiKSkgewogICAgcmV0dXJuIHRydXN0ZWRIVE1MRnJvbVN0cmluZ0J5cGFzcyh1bndyYXBTYWZlVmFsdWUodW5zYWZlSHRtbCkpOwogIH0KICByZXR1cm4gX3Nhbml0aXplSHRtbChnZXREb2N1bWVudCgpLCByZW5kZXJTdHJpbmdpZnkodW5zYWZlSHRtbCkpOwp9CmZ1bmN0aW9uIMm1ybVzYW5pdGl6ZVN0eWxlKHVuc2FmZVN0eWxlKSB7CiAgY29uc3Qgc2FuaXRpemVyID0gZ2V0U2FuaXRpemVyKCk7CiAgaWYgKHNhbml0aXplcikgewogICAgcmV0dXJuIHNhbml0aXplci5zYW5pdGl6ZShTZWN1cml0eUNvbnRleHQuU1RZTEUsIHVuc2FmZVN0eWxlKSB8fCAiIjsKICB9CiAgaWYgKGFsbG93U2FuaXRpemF0aW9uQnlwYXNzQW5kVGhyb3codW5zYWZlU3R5bGUsICJTdHlsZSIpKSB7CiAgICByZXR1cm4gdW53cmFwU2FmZVZhbHVlKHVuc2FmZVN0eWxlKTsKICB9CiAgcmV0dXJuIHJlbmRlclN0cmluZ2lmeSh1bnNhZmVTdHlsZSk7Cn0KZnVuY3Rpb24gybXJtXNhbml0aXplVXJsKHVuc2FmZVVybCkgewogIGNvbnN0IHNhbml0aXplciA9IGdldFNhbml0aXplcigpOwogIGlmIChzYW5pdGl6ZXIpIHsKICAgIHJldHVybiBzYW5pdGl6ZXIuc2FuaXRpemUoU2VjdXJpdHlDb250ZXh0LlVSTCwgdW5zYWZlVXJsKSB8fCAiIjsKICB9CiAgaWYgKGFsbG93U2FuaXRpemF0aW9uQnlwYXNzQW5kVGhyb3codW5zYWZlVXJsLCAiVVJMIikpIHsKICAgIHJldHVybiB1bndyYXBTYWZlVmFsdWUodW5zYWZlVXJsKTsKICB9CiAgcmV0dXJuIF9zYW5pdGl6ZVVybChyZW5kZXJTdHJpbmdpZnkodW5zYWZlVXJsKSk7Cn0KZnVuY3Rpb24gybXJtXNhbml0aXplUmVzb3VyY2VVcmwodW5zYWZlUmVzb3VyY2VVcmwpIHsKICBjb25zdCBzYW5pdGl6ZXIgPSBnZXRTYW5pdGl6ZXIoKTsKICBpZiAoc2FuaXRpemVyKSB7CiAgICByZXR1cm4gdHJ1c3RlZFNjcmlwdFVSTEZyb21TdHJpbmdCeXBhc3Moc2FuaXRpemVyLnNhbml0aXplKFNlY3VyaXR5Q29udGV4dC5SRVNPVVJDRV9VUkwsIHVuc2FmZVJlc291cmNlVXJsKSB8fCAiIik7CiAgfQogIGlmIChhbGxvd1Nhbml0aXphdGlvbkJ5cGFzc0FuZFRocm93KHVuc2FmZVJlc291cmNlVXJsLCAiUmVzb3VyY2VVUkwiKSkgewogICAgcmV0dXJuIHRydXN0ZWRTY3JpcHRVUkxGcm9tU3RyaW5nQnlwYXNzKHVud3JhcFNhZmVWYWx1ZSh1bnNhZmVSZXNvdXJjZVVybCkpOwogIH0KICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDkwNCwgbmdEZXZNb2RlICYmIGB1bnNhZmUgdmFsdWUgdXNlZCBpbiBhIHJlc291cmNlIFVSTCBjb250ZXh0IChzZWUgJHtYU1NfU0VDVVJJVFlfVVJMfSlgKTsKfQpmdW5jdGlvbiDJtcm1c2FuaXRpemVTY3JpcHQodW5zYWZlU2NyaXB0KSB7CiAgY29uc3Qgc2FuaXRpemVyID0gZ2V0U2FuaXRpemVyKCk7CiAgaWYgKHNhbml0aXplcikgewogICAgcmV0dXJuIHRydXN0ZWRTY3JpcHRGcm9tU3RyaW5nQnlwYXNzKHNhbml0aXplci5zYW5pdGl6ZShTZWN1cml0eUNvbnRleHQuU0NSSVBULCB1bnNhZmVTY3JpcHQpIHx8ICIiKTsKICB9CiAgaWYgKGFsbG93U2FuaXRpemF0aW9uQnlwYXNzQW5kVGhyb3codW5zYWZlU2NyaXB0LCAiU2NyaXB0IikpIHsKICAgIHJldHVybiB0cnVzdGVkU2NyaXB0RnJvbVN0cmluZ0J5cGFzcyh1bndyYXBTYWZlVmFsdWUodW5zYWZlU2NyaXB0KSk7CiAgfQogIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTA1LCBuZ0Rldk1vZGUgJiYgInVuc2FmZSB2YWx1ZSB1c2VkIGluIGEgc2NyaXB0IGNvbnRleHQiKTsKfQpmdW5jdGlvbiDJtcm1dHJ1c3RDb25zdGFudEh0bWwoaHRtbCkgewogIGlmIChuZ0Rldk1vZGUgJiYgKCFBcnJheS5pc0FycmF5KGh0bWwpIHx8ICFBcnJheS5pc0FycmF5KGh0bWwucmF3KSB8fCBodG1sLmxlbmd0aCAhPT0gMSkpIHsKICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBpbnRlcnBvbGF0aW9uIGluIHRydXN0ZWQgSFRNTCBjb25zdGFudDogJHtodG1sLmpvaW4oIj8iKX1gKTsKICB9CiAgcmV0dXJuIHRydXN0ZWRIVE1MRnJvbVN0cmluZyhodG1sWzBdKTsKfQpmdW5jdGlvbiDJtcm1dHJ1c3RDb25zdGFudFJlc291cmNlVXJsKHVybCkgewogIGlmIChuZ0Rldk1vZGUgJiYgKCFBcnJheS5pc0FycmF5KHVybCkgfHwgIUFycmF5LmlzQXJyYXkodXJsLnJhdykgfHwgdXJsLmxlbmd0aCAhPT0gMSkpIHsKICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBpbnRlcnBvbGF0aW9uIGluIHRydXN0ZWQgVVJMIGNvbnN0YW50OiAke3VybC5qb2luKCI/Iil9YCk7CiAgfQogIHJldHVybiB0cnVzdGVkU2NyaXB0VVJMRnJvbVN0cmluZyh1cmxbMF0pOwp9CnZhciBTUkNfUkVTT1VSQ0VfVEFHUyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFsiZW1iZWQiLCAiZnJhbWUiLCAiaWZyYW1lIiwgIm1lZGlhIiwgInNjcmlwdCJdKTsKdmFyIEhSRUZfUkVTT1VSQ0VfVEFHUyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFsiYmFzZSIsICJsaW5rIiwgInNjcmlwdCJdKTsKZnVuY3Rpb24gZ2V0VXJsU2FuaXRpemVyKHRhZywgcHJvcCkgewogIGNvbnN0IGlzUmVzb3VyY2UgPSBwcm9wID09PSAic3JjIiAmJiBTUkNfUkVTT1VSQ0VfVEFHUy5oYXModGFnKSB8fCBwcm9wID09PSAiaHJlZiIgJiYgSFJFRl9SRVNPVVJDRV9UQUdTLmhhcyh0YWcpIHx8IHByb3AgPT09ICJ4bGluazpocmVmIiAmJiB0YWcgPT09ICJzY3JpcHQiOwogIHJldHVybiBpc1Jlc291cmNlID8gybXJtXNhbml0aXplUmVzb3VyY2VVcmwgOiDJtcm1c2FuaXRpemVVcmw7Cn0KZnVuY3Rpb24gybXJtXNhbml0aXplVXJsT3JSZXNvdXJjZVVybCh1bnNhZmVVcmwsIHRhZywgcHJvcCkgewogIHJldHVybiBnZXRVcmxTYW5pdGl6ZXIodGFnLCBwcm9wKSh1bnNhZmVVcmwpOwp9CmZ1bmN0aW9uIHZhbGlkYXRlQWdhaW5zdEV2ZW50UHJvcGVydGllcyhuYW1lKSB7CiAgaWYgKG5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCJvbiIpKSB7CiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBgQmluZGluZyB0byBldmVudCBwcm9wZXJ0eSAnJHtuYW1lfScgaXMgZGlzYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucywgcGxlYXNlIHVzZSAoJHtuYW1lLnNsaWNlKDIpfSk9Li4uCklmICcke25hbWV9JyBpcyBhIGRpcmVjdGl2ZSBpbnB1dCwgbWFrZSBzdXJlIHRoZSBkaXJlY3RpdmUgaXMgaW1wb3J0ZWQgYnkgdGhlIGN1cnJlbnQgbW9kdWxlLmA7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDMwNiwgZXJyb3JNZXNzYWdlKTsKICB9Cn0KZnVuY3Rpb24gdmFsaWRhdGVBZ2FpbnN0RXZlbnRBdHRyaWJ1dGVzKG5hbWUpIHsKICBpZiAobmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoIm9uIikpIHsKICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGBCaW5kaW5nIHRvIGV2ZW50IGF0dHJpYnV0ZSAnJHtuYW1lfScgaXMgZGlzYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucywgcGxlYXNlIHVzZSAoJHtuYW1lLnNsaWNlKDIpfSk9Li4uYDsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMzA2LCBlcnJvck1lc3NhZ2UpOwogIH0KfQpmdW5jdGlvbiBnZXRTYW5pdGl6ZXIoKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIHJldHVybiBsVmlldyAmJiBsVmlld1tFTlZJUk9OTUVOVF0uc2FuaXRpemVyOwp9CnZhciBhdHRyaWJ1dGVOYW1lID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoWyJhdHRyaWJ1dGVuYW1lIl0pOwp2YXIgU0VDVVJJVFlfU0VOU0lUSVZFX0VMRU1FTlRTID0gewogICJpZnJhbWUiOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbInNhbmRib3giLCAiYWxsb3ciLCAiYWxsb3dmdWxsc2NyZWVuIiwgInJlZmVycmVycG9saWN5IiwgImNzcCIsICJmZXRjaHByaW9yaXR5Il0pLAogICJhbmltYXRlIjogYXR0cmlidXRlTmFtZSwKICAic2V0IjogYXR0cmlidXRlTmFtZSwKICAiYW5pbWF0ZW1vdGlvbiI6IGF0dHJpYnV0ZU5hbWUsCiAgImFuaW1hdGV0cmFuc2Zvcm0iOiBhdHRyaWJ1dGVOYW1lCn07CmZ1bmN0aW9uIMm1ybV2YWxpZGF0ZUF0dHJpYnV0ZSh2YWx1ZSwgdGFnTmFtZSwgYXR0cmlidXRlTmFtZTIpIHsKICBjb25zdCBsb3dlckNhc2VUYWdOYW1lID0gdGFnTmFtZS50b0xvd2VyQ2FzZSgpOwogIGNvbnN0IGxvd2VyQ2FzZUF0dHJOYW1lID0gYXR0cmlidXRlTmFtZTIudG9Mb3dlckNhc2UoKTsKICBpZiAoIVNFQ1VSSVRZX1NFTlNJVElWRV9FTEVNRU5UU1tsb3dlckNhc2VUYWdOYW1lXT8uaGFzKGxvd2VyQ2FzZUF0dHJOYW1lKSkgewogICAgcmV0dXJuIHZhbHVlOwogIH0KICBjb25zdCB0Tm9kZSA9IGdldFNlbGVjdGVkVE5vZGUoKTsKICBpZiAodE5vZGUudHlwZSAhPT0gMikgewogICAgcmV0dXJuIHZhbHVlOwogIH0KICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgaWYgKGxvd2VyQ2FzZVRhZ05hbWUgPT09ICJpZnJhbWUiKSB7CiAgICBjb25zdCBlbGVtZW50ID0gZ2V0TmF0aXZlQnlUTm9kZSh0Tm9kZSwgbFZpZXcpOwogICAgZW5mb3JjZUlmcmFtZVNlY3VyaXR5KGVsZW1lbnQpOwogIH0KICBjb25zdCBlcnJvck1lc3NhZ2UgPSBuZ0Rldk1vZGUgJiYgYEFuZ3VsYXIgaGFzIGRldGVjdGVkIHRoYXQgdGhlIFxgJHthdHRyaWJ1dGVOYW1lMn1cYCB3YXMgYXBwbGllZCBhcyBhIGJpbmRpbmcgdG8gdGhlIDwke3RhZ05hbWV9PiBlbGVtZW50JHtnZXRUZW1wbGF0ZUxvY2F0aW9uRGV0YWlscyhsVmlldyl9LiBGb3Igc2VjdXJpdHkgcmVhc29ucywgdGhlIFxgJHthdHRyaWJ1dGVOYW1lMn1cYCBjYW4gYmUgc2V0IG9uIHRoZSA8JHt0YWdOYW1lfT4gZWxlbWVudCBhcyBhIHN0YXRpYyBhdHRyaWJ1dGUgb25seS4gClRvIGZpeCB0aGlzLCBzd2l0Y2ggdGhlIFxgJHthdHRyaWJ1dGVOYW1lMn1cYCBiaW5kaW5nIHRvIGEgc3RhdGljIGF0dHJpYnV0ZSBpbiBhIHRlbXBsYXRlIG9yIGluIGhvc3QgYmluZGluZ3Mgc2VjdGlvbi5gOwogIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTkxMCwgZXJyb3JNZXNzYWdlKTsKfQp2YXIgTkdfUkVGTEVDVF9BVFRSU19GTEFHX0RFRkFVTFQgPSBmYWxzZTsKdmFyIE5HX1JFRkxFQ1RfQVRUUlNfRkxBRyA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUgPyAiTkdfUkVGTEVDVF9GTEFHIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gTkdfUkVGTEVDVF9BVFRSU19GTEFHX0RFRkFVTFQKfSk7CmZ1bmN0aW9uIHByb3ZpZGVOZ1JlZmxlY3RBdHRyaWJ1dGVzKCkgewogIGNvbnN0IHByb3ZpZGVycyA9IHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSA/IFt7CiAgICBwcm92aWRlOiBOR19SRUZMRUNUX0FUVFJTX0ZMQUcsCiAgICB1c2VWYWx1ZTogdHJ1ZQogIH1dIDogW107CiAgcmV0dXJuIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhwcm92aWRlcnMpOwp9CmZ1bmN0aW9uIG5vcm1hbGl6ZURlYnVnQmluZGluZ05hbWUobmFtZSkgewogIG5hbWUgPSBjYW1lbENhc2VUb0Rhc2hDYXNlKG5hbWUucmVwbGFjZSgvWyRAXS9nLCAiXyIpKTsKICByZXR1cm4gYG5nLXJlZmxlY3QtJHtuYW1lfWA7Cn0KdmFyIENBTUVMX0NBU0VfUkVHRVhQID0gLyhbQS1aXSkvZzsKZnVuY3Rpb24gY2FtZWxDYXNlVG9EYXNoQ2FzZShpbnB1dDIpIHsKICByZXR1cm4gaW5wdXQyLnJlcGxhY2UoQ0FNRUxfQ0FTRV9SRUdFWFAsICguLi5tKSA9PiAiLSIgKyBtWzFdLnRvTG93ZXJDYXNlKCkpOwp9CmZ1bmN0aW9uIG5vcm1hbGl6ZURlYnVnQmluZGluZ1ZhbHVlKHZhbHVlKSB7CiAgdHJ5IHsKICAgIHJldHVybiB2YWx1ZSAhPSBudWxsID8gdmFsdWUudG9TdHJpbmcoKS5zbGljZSgwLCAzMCkgOiB2YWx1ZTsKICB9IGNhdGNoIChlKSB7CiAgICByZXR1cm4gIltFUlJPUl0gRXhjZXB0aW9uIHdoaWxlIHRyeWluZyB0byBzZXJpYWxpemUgdGhlIHZhbHVlIjsKICB9Cn0KZnVuY3Rpb24gybXJtXJlc29sdmVXaW5kb3coZWxlbWVudCkgewogIHJldHVybiBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7Cn0KZnVuY3Rpb24gybXJtXJlc29sdmVEb2N1bWVudChlbGVtZW50KSB7CiAgcmV0dXJuIGVsZW1lbnQub3duZXJEb2N1bWVudDsKfQpmdW5jdGlvbiDJtcm1cmVzb2x2ZUJvZHkoZWxlbWVudCkgewogIHJldHVybiBlbGVtZW50Lm93bmVyRG9jdW1lbnQuYm9keTsKfQp2YXIgSU5URVJQT0xBVElPTl9ERUxJTUlURVIgPSBg77+9YDsKZnVuY3Rpb24gbWF5YmVVbndyYXBGbih2YWx1ZSkgewogIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICByZXR1cm4gdmFsdWUoKTsKICB9IGVsc2UgewogICAgcmV0dXJuIHZhbHVlOwogIH0KfQp2YXIgVkFMVUVfU1RSSU5HX0xFTkdUSF9MSU1JVCA9IDIwMDsKZnVuY3Rpb24gYXNzZXJ0U3RhbmRhbG9uZUNvbXBvbmVudFR5cGUodHlwZSkgewogIGFzc2VydENvbXBvbmVudERlZih0eXBlKTsKICBjb25zdCBjb21wb25lbnREZWYgPSBnZXRDb21wb25lbnREZWYodHlwZSk7CiAgaWYgKCFjb21wb25lbnREZWYuc3RhbmRhbG9uZSkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDcsIGBUaGUgJHtzdHJpbmdpZnlGb3JFcnJvcih0eXBlKX0gY29tcG9uZW50IGlzIG5vdCBtYXJrZWQgYXMgc3RhbmRhbG9uZSwgYnV0IEFuZ3VsYXIgZXhwZWN0cyB0byBoYXZlIGEgc3RhbmRhbG9uZSBjb21wb25lbnQgaGVyZS4gUGxlYXNlIG1ha2Ugc3VyZSB0aGUgJHtzdHJpbmdpZnlGb3JFcnJvcih0eXBlKX0gY29tcG9uZW50IGRvZXMgbm90IGhhdmUgdGhlIFxgc3RhbmRhbG9uZTogZmFsc2VcYCBmbGFnIGluIHRoZSBkZWNvcmF0b3IuYCk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydENvbXBvbmVudERlZih0eXBlKSB7CiAgaWYgKCFnZXRDb21wb25lbnREZWYodHlwZSkpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTA2LCBgVGhlICR7c3RyaW5naWZ5Rm9yRXJyb3IodHlwZSl9IGlzIG5vdCBhbiBBbmd1bGFyIGNvbXBvbmVudCwgbWFrZSBzdXJlIGl0IGhhcyB0aGUgXGBAQ29tcG9uZW50XGAgZGVjb3JhdG9yLmApOwogIH0KfQpmdW5jdGlvbiB0aHJvd011bHRpcGxlQ29tcG9uZW50RXJyb3IodE5vZGUsIGZpcnN0Miwgc2Vjb25kKSB7CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtMzAwLCBgTXVsdGlwbGUgY29tcG9uZW50cyBtYXRjaCBub2RlIHdpdGggdGFnbmFtZSAke3ROb2RlLnZhbHVlfTogJHtzdHJpbmdpZnlGb3JFcnJvcihmaXJzdDIpfSBhbmQgJHtzdHJpbmdpZnlGb3JFcnJvcihzZWNvbmQpfWApOwp9CmZ1bmN0aW9uIHRocm93RXJyb3JJZk5vQ2hhbmdlc01vZGUoY3JlYXRpb25Nb2RlLCBvbGRWYWx1ZSwgY3VyclZhbHVlLCBwcm9wTmFtZSwgbFZpZXcpIHsKICBjb25zdCBob3N0Q29tcG9uZW50RGVmID0gZ2V0RGVjbGFyYXRpb25Db21wb25lbnREZWYobFZpZXcpOwogIGNvbnN0IGNvbXBvbmVudENsYXNzTmFtZSA9IGhvc3RDb21wb25lbnREZWY/LnR5cGU/Lm5hbWU7CiAgY29uc3QgZmllbGQgPSBwcm9wTmFtZSA/IGAgZm9yICcke3Byb3BOYW1lfSdgIDogIiI7CiAgbGV0IG1zZyA9IGBFeHByZXNzaW9uQ2hhbmdlZEFmdGVySXRIYXNCZWVuQ2hlY2tlZEVycm9yOiBFeHByZXNzaW9uIGhhcyBjaGFuZ2VkIGFmdGVyIGl0IHdhcyBjaGVja2VkLiBQcmV2aW91cyB2YWx1ZSR7ZmllbGR9OiAnJHtmb3JtYXRWYWx1ZShvbGRWYWx1ZSl9Jy4gQ3VycmVudCB2YWx1ZTogJyR7Zm9ybWF0VmFsdWUoY3VyclZhbHVlKX0nLiR7Y29tcG9uZW50Q2xhc3NOYW1lID8gYCBFeHByZXNzaW9uIGxvY2F0aW9uOiAke2NvbXBvbmVudENsYXNzTmFtZX0gY29tcG9uZW50YCA6ICIifWA7CiAgaWYgKGNyZWF0aW9uTW9kZSkgewogICAgbXNnICs9IGAgSXQgc2VlbXMgbGlrZSB0aGUgdmlldyBoYXMgYmVlbiBjcmVhdGVkIGFmdGVyIGl0cyBwYXJlbnQgYW5kIGl0cyBjaGlsZHJlbiBoYXZlIGJlZW4gZGlydHkgY2hlY2tlZC4gSGFzIGl0IGJlZW4gY3JlYXRlZCBpbiBhIGNoYW5nZSBkZXRlY3Rpb24gaG9vaz9gOwogIH0KICB0aHJvdyBuZXcgUnVudGltZUVycm9yKC0xMDAsIG1zZyk7Cn0KZnVuY3Rpb24gZm9ybWF0VmFsdWUodmFsdWUpIHsKICBsZXQgc3RyVmFsdWUgPSBTdHJpbmcodmFsdWUpOwogIHRyeSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgc3RyVmFsdWUgPT09ICJbb2JqZWN0IE9iamVjdF0iKSB7CiAgICAgIHN0clZhbHVlID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpOwogICAgfQogIH0gY2F0Y2ggKGVycm9yKSB7CiAgfQogIHJldHVybiBzdHJWYWx1ZS5sZW5ndGggPiBWQUxVRV9TVFJJTkdfTEVOR1RIX0xJTUlUID8gc3RyVmFsdWUuc3Vic3RyaW5nKDAsIFZBTFVFX1NUUklOR19MRU5HVEhfTElNSVQpICsgIuKApiIgOiBzdHJWYWx1ZTsKfQpmdW5jdGlvbiBjb25zdHJ1Y3REZXRhaWxzRm9ySW50ZXJwb2xhdGlvbihsVmlldywgcm9vdEluZGV4LCBleHByZXNzaW9uSW5kZXgsIG1ldGEsIGNoYW5nZWRWYWx1ZSkgewogIGNvbnN0IFtwcm9wTmFtZSwgcHJlZml4LCAuLi5jaHVua3NdID0gbWV0YS5zcGxpdChJTlRFUlBPTEFUSU9OX0RFTElNSVRFUik7CiAgbGV0IG9sZFZhbHVlID0gcHJlZml4LCBuZXdWYWx1ZSA9IHByZWZpeDsKICBmb3IgKGxldCBpID0gMDsgaSA8IGNodW5rcy5sZW5ndGg7IGkrKykgewogICAgY29uc3Qgc2xvdElkeCA9IHJvb3RJbmRleCArIGk7CiAgICBvbGRWYWx1ZSArPSBgJHtsVmlld1tzbG90SWR4XX0ke2NodW5rc1tpXX1gOwogICAgbmV3VmFsdWUgKz0gYCR7c2xvdElkeCA9PT0gZXhwcmVzc2lvbkluZGV4ID8gY2hhbmdlZFZhbHVlIDogbFZpZXdbc2xvdElkeF19JHtjaHVua3NbaV19YDsKICB9CiAgcmV0dXJuIHsKICAgIHByb3BOYW1lLAogICAgb2xkVmFsdWUsCiAgICBuZXdWYWx1ZQogIH07Cn0KZnVuY3Rpb24gZ2V0RXhwcmVzc2lvbkNoYW5nZWRFcnJvckRldGFpbHMobFZpZXcsIGJpbmRpbmdJbmRleCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7CiAgY29uc3QgdERhdGEgPSBsVmlld1tUVklFV10uZGF0YTsKICBjb25zdCBtZXRhZGF0YSA9IHREYXRhW2JpbmRpbmdJbmRleF07CiAgaWYgKHR5cGVvZiBtZXRhZGF0YSA9PT0gInN0cmluZyIpIHsKICAgIGlmIChtZXRhZGF0YS5pbmRleE9mKElOVEVSUE9MQVRJT05fREVMSU1JVEVSKSA+IC0xKSB7CiAgICAgIHJldHVybiBjb25zdHJ1Y3REZXRhaWxzRm9ySW50ZXJwb2xhdGlvbihsVmlldywgYmluZGluZ0luZGV4LCBiaW5kaW5nSW5kZXgsIG1ldGFkYXRhLCBuZXdWYWx1ZSk7CiAgICB9CiAgICByZXR1cm4gewogICAgICBwcm9wTmFtZTogbWV0YWRhdGEsCiAgICAgIG9sZFZhbHVlLAogICAgICBuZXdWYWx1ZQogICAgfTsKICB9CiAgaWYgKG1ldGFkYXRhID09PSBudWxsKSB7CiAgICBsZXQgaWR4ID0gYmluZGluZ0luZGV4IC0gMTsKICAgIHdoaWxlICh0eXBlb2YgdERhdGFbaWR4XSAhPT0gInN0cmluZyIgJiYgdERhdGFbaWR4ICsgMV0gPT09IG51bGwpIHsKICAgICAgaWR4LS07CiAgICB9CiAgICBjb25zdCBtZXRhID0gdERhdGFbaWR4XTsKICAgIGlmICh0eXBlb2YgbWV0YSA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgbWF0Y2hlcyA9IG1ldGEubWF0Y2gobmV3IFJlZ0V4cChJTlRFUlBPTEFUSU9OX0RFTElNSVRFUiwgImciKSk7CiAgICAgIGlmIChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoIC0gMSA+IGJpbmRpbmdJbmRleCAtIGlkeCkgewogICAgICAgIHJldHVybiBjb25zdHJ1Y3REZXRhaWxzRm9ySW50ZXJwb2xhdGlvbihsVmlldywgaWR4LCBiaW5kaW5nSW5kZXgsIG1ldGEsIG5ld1ZhbHVlKTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gewogICAgcHJvcE5hbWU6IHZvaWQgMCwKICAgIG9sZFZhbHVlLAogICAgbmV3VmFsdWUKICB9Owp9CmZ1bmN0aW9uIGNsYXNzSW5kZXhPZihjbGFzc05hbWUsIGNsYXNzVG9TZWFyY2gsIHN0YXJ0aW5nSW5kZXgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90RXF1YWwoY2xhc3NUb1NlYXJjaCwgIiIsICdjYW4gbm90IGxvb2sgZm9yICIiIHN0cmluZy4nKTsKICBsZXQgZW5kID0gY2xhc3NOYW1lLmxlbmd0aDsKICB3aGlsZSAodHJ1ZSkgewogICAgY29uc3QgZm91bmRJbmRleCA9IGNsYXNzTmFtZS5pbmRleE9mKGNsYXNzVG9TZWFyY2gsIHN0YXJ0aW5nSW5kZXgpOwogICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSByZXR1cm4gZm91bmRJbmRleDsKICAgIGlmIChmb3VuZEluZGV4ID09PSAwIHx8IGNsYXNzTmFtZS5jaGFyQ29kZUF0KGZvdW5kSW5kZXggLSAxKSA8PSAzMikgewogICAgICBjb25zdCBsZW5ndGggPSBjbGFzc1RvU2VhcmNoLmxlbmd0aDsKICAgICAgaWYgKGZvdW5kSW5kZXggKyBsZW5ndGggPT09IGVuZCB8fCBjbGFzc05hbWUuY2hhckNvZGVBdChmb3VuZEluZGV4ICsgbGVuZ3RoKSA8PSAzMikgewogICAgICAgIHJldHVybiBmb3VuZEluZGV4OwogICAgICB9CiAgICB9CiAgICBzdGFydGluZ0luZGV4ID0gZm91bmRJbmRleCArIDE7CiAgfQp9CnZhciBOR19URU1QTEFURV9TRUxFQ1RPUiA9ICJuZy10ZW1wbGF0ZSI7CmZ1bmN0aW9uIGlzQ3NzQ2xhc3NNYXRjaGluZyh0Tm9kZSwgYXR0cnMsIGNzc0NsYXNzVG9NYXRjaCwgaXNQcm9qZWN0aW9uTW9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChjc3NDbGFzc1RvTWF0Y2gsIGNzc0NsYXNzVG9NYXRjaC50b0xvd2VyQ2FzZSgpLCAiQ2xhc3MgbmFtZSBleHBlY3RlZCB0byBiZSBsb3dlcmNhc2UuIik7CiAgbGV0IGkgPSAwOwogIGlmIChpc1Byb2plY3Rpb25Nb2RlKSB7CiAgICBmb3IgKDsgaSA8IGF0dHJzLmxlbmd0aCAmJiB0eXBlb2YgYXR0cnNbaV0gPT09ICJzdHJpbmciOyBpICs9IDIpIHsKICAgICAgaWYgKGF0dHJzW2ldID09PSAiY2xhc3MiICYmIGNsYXNzSW5kZXhPZihhdHRyc1tpICsgMV0udG9Mb3dlckNhc2UoKSwgY3NzQ2xhc3NUb01hdGNoLCAwKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAoaXNJbmxpbmVUZW1wbGF0ZSh0Tm9kZSkpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgaSA9IGF0dHJzLmluZGV4T2YoMSwgaSk7CiAgaWYgKGkgPiAtMSkgewogICAgbGV0IGl0ZW07CiAgICB3aGlsZSAoKytpIDwgYXR0cnMubGVuZ3RoICYmIHR5cGVvZiAoaXRlbSA9IGF0dHJzW2ldKSA9PT0gInN0cmluZyIpIHsKICAgICAgaWYgKGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gY3NzQ2xhc3NUb01hdGNoKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGlzSW5saW5lVGVtcGxhdGUodE5vZGUpIHsKICByZXR1cm4gdE5vZGUudHlwZSA9PT0gNCAmJiB0Tm9kZS52YWx1ZSAhPT0gTkdfVEVNUExBVEVfU0VMRUNUT1I7Cn0KZnVuY3Rpb24gaGFzVGFnQW5kVHlwZU1hdGNoKHROb2RlLCBjdXJyZW50U2VsZWN0b3IsIGlzUHJvamVjdGlvbk1vZGUpIHsKICBjb25zdCB0YWdOYW1lVG9Db21wYXJlID0gdE5vZGUudHlwZSA9PT0gNCAmJiAhaXNQcm9qZWN0aW9uTW9kZSA/IE5HX1RFTVBMQVRFX1NFTEVDVE9SIDogdE5vZGUudmFsdWU7CiAgcmV0dXJuIGN1cnJlbnRTZWxlY3RvciA9PT0gdGFnTmFtZVRvQ29tcGFyZTsKfQpmdW5jdGlvbiBpc05vZGVNYXRjaGluZ1NlbGVjdG9yKHROb2RlLCBzZWxlY3RvciwgaXNQcm9qZWN0aW9uTW9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHNlbGVjdG9yWzBdLCAiU2VsZWN0b3Igc2hvdWxkIGhhdmUgYSB0YWcgbmFtZSIpOwogIGxldCBtb2RlID0gNDsKICBjb25zdCBub2RlQXR0cnMgPSB0Tm9kZS5hdHRyczsKICBjb25zdCBuYW1lT25seU1hcmtlcklkeCA9IG5vZGVBdHRycyAhPT0gbnVsbCA/IGdldE5hbWVPbmx5TWFya2VySW5kZXgobm9kZUF0dHJzKSA6IDA7CiAgbGV0IHNraXBUb05leHRTZWxlY3RvciA9IGZhbHNlOwogIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0b3IubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGN1cnJlbnQgPSBzZWxlY3RvcltpXTsKICAgIGlmICh0eXBlb2YgY3VycmVudCA9PT0gIm51bWJlciIpIHsKICAgICAgaWYgKCFza2lwVG9OZXh0U2VsZWN0b3IgJiYgIWlzUG9zaXRpdmUobW9kZSkgJiYgIWlzUG9zaXRpdmUoY3VycmVudCkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKHNraXBUb05leHRTZWxlY3RvciAmJiBpc1Bvc2l0aXZlKGN1cnJlbnQpKSBjb250aW51ZTsKICAgICAgc2tpcFRvTmV4dFNlbGVjdG9yID0gZmFsc2U7CiAgICAgIG1vZGUgPSBjdXJyZW50IHwgbW9kZSAmIDE7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKHNraXBUb05leHRTZWxlY3RvcikgY29udGludWU7CiAgICBpZiAobW9kZSAmIDQpIHsKICAgICAgbW9kZSA9IDIgfCBtb2RlICYgMTsKICAgICAgaWYgKGN1cnJlbnQgIT09ICIiICYmICFoYXNUYWdBbmRUeXBlTWF0Y2godE5vZGUsIGN1cnJlbnQsIGlzUHJvamVjdGlvbk1vZGUpIHx8IGN1cnJlbnQgPT09ICIiICYmIHNlbGVjdG9yLmxlbmd0aCA9PT0gMSkgewogICAgICAgIGlmIChpc1Bvc2l0aXZlKG1vZGUpKSByZXR1cm4gZmFsc2U7CiAgICAgICAgc2tpcFRvTmV4dFNlbGVjdG9yID0gdHJ1ZTsKICAgICAgfQogICAgfSBlbHNlIGlmIChtb2RlICYgOCkgewogICAgICBpZiAobm9kZUF0dHJzID09PSBudWxsIHx8ICFpc0Nzc0NsYXNzTWF0Y2hpbmcodE5vZGUsIG5vZGVBdHRycywgY3VycmVudCwgaXNQcm9qZWN0aW9uTW9kZSkpIHsKICAgICAgICBpZiAoaXNQb3NpdGl2ZShtb2RlKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHNraXBUb05leHRTZWxlY3RvciA9IHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHNlbGVjdG9yQXR0clZhbHVlID0gc2VsZWN0b3JbKytpXTsKICAgICAgY29uc3QgYXR0ckluZGV4SW5Ob2RlID0gZmluZEF0dHJJbmRleEluTm9kZShjdXJyZW50LCBub2RlQXR0cnMsIGlzSW5saW5lVGVtcGxhdGUodE5vZGUpLCBpc1Byb2plY3Rpb25Nb2RlKTsKICAgICAgaWYgKGF0dHJJbmRleEluTm9kZSA9PT0gLTEpIHsKICAgICAgICBpZiAoaXNQb3NpdGl2ZShtb2RlKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHNraXBUb05leHRTZWxlY3RvciA9IHRydWU7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgaWYgKHNlbGVjdG9yQXR0clZhbHVlICE9PSAiIikgewogICAgICAgIGxldCBub2RlQXR0clZhbHVlOwogICAgICAgIGlmIChhdHRySW5kZXhJbk5vZGUgPiBuYW1lT25seU1hcmtlcklkeCkgewogICAgICAgICAgbm9kZUF0dHJWYWx1ZSA9ICIiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90RXF1YWwobm9kZUF0dHJzW2F0dHJJbmRleEluTm9kZV0sIDAsICJXZSBkbyBub3QgbWF0Y2ggZGlyZWN0aXZlcyBvbiBuYW1lc3BhY2VkIGF0dHJpYnV0ZXMiKTsKICAgICAgICAgIG5vZGVBdHRyVmFsdWUgPSBub2RlQXR0cnNbYXR0ckluZGV4SW5Ob2RlICsgMV0udG9Mb3dlckNhc2UoKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1vZGUgJiAyICYmIHNlbGVjdG9yQXR0clZhbHVlICE9PSBub2RlQXR0clZhbHVlKSB7CiAgICAgICAgICBpZiAoaXNQb3NpdGl2ZShtb2RlKSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgc2tpcFRvTmV4dFNlbGVjdG9yID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGlzUG9zaXRpdmUobW9kZSkgfHwgc2tpcFRvTmV4dFNlbGVjdG9yOwp9CmZ1bmN0aW9uIGlzUG9zaXRpdmUobW9kZSkgewogIHJldHVybiAobW9kZSAmIDEpID09PSAwOwp9CmZ1bmN0aW9uIGZpbmRBdHRySW5kZXhJbk5vZGUobmFtZSwgYXR0cnMsIGlzSW5saW5lVGVtcGxhdGUyLCBpc1Byb2plY3Rpb25Nb2RlKSB7CiAgaWYgKGF0dHJzID09PSBudWxsKSByZXR1cm4gLTE7CiAgbGV0IGkgPSAwOwogIGlmIChpc1Byb2plY3Rpb25Nb2RlIHx8ICFpc0lubGluZVRlbXBsYXRlMikgewogICAgbGV0IGJpbmRpbmdzTW9kZSA9IGZhbHNlOwogICAgd2hpbGUgKGkgPCBhdHRycy5sZW5ndGgpIHsKICAgICAgY29uc3QgbWF5YmVBdHRyTmFtZSA9IGF0dHJzW2ldOwogICAgICBpZiAobWF5YmVBdHRyTmFtZSA9PT0gbmFtZSkgewogICAgICAgIHJldHVybiBpOwogICAgICB9IGVsc2UgaWYgKG1heWJlQXR0ck5hbWUgPT09IDMgfHwgbWF5YmVBdHRyTmFtZSA9PT0gNikgewogICAgICAgIGJpbmRpbmdzTW9kZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAobWF5YmVBdHRyTmFtZSA9PT0gMSB8fCBtYXliZUF0dHJOYW1lID09PSAyKSB7CiAgICAgICAgbGV0IHZhbHVlID0gYXR0cnNbKytpXTsKICAgICAgICB3aGlsZSAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICAgICAgdmFsdWUgPSBhdHRyc1srK2ldOwogICAgICAgIH0KICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIGlmIChtYXliZUF0dHJOYW1lID09PSA0KSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0gZWxzZSBpZiAobWF5YmVBdHRyTmFtZSA9PT0gMCkgewogICAgICAgIGkgKz0gNDsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpICs9IGJpbmRpbmdzTW9kZSA/IDEgOiAyOwogICAgfQogICAgcmV0dXJuIC0xOwogIH0gZWxzZSB7CiAgICByZXR1cm4gbWF0Y2hUZW1wbGF0ZUF0dHJpYnV0ZShhdHRycywgbmFtZSk7CiAgfQp9CmZ1bmN0aW9uIGlzTm9kZU1hdGNoaW5nU2VsZWN0b3JMaXN0KHROb2RlLCBzZWxlY3RvciwgaXNQcm9qZWN0aW9uTW9kZSA9IGZhbHNlKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Rvci5sZW5ndGg7IGkrKykgewogICAgaWYgKGlzTm9kZU1hdGNoaW5nU2VsZWN0b3IodE5vZGUsIHNlbGVjdG9yW2ldLCBpc1Byb2plY3Rpb25Nb2RlKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGdldFByb2plY3RBc0F0dHJWYWx1ZSh0Tm9kZSkgewogIGNvbnN0IG5vZGVBdHRycyA9IHROb2RlLmF0dHJzOwogIGlmIChub2RlQXR0cnMgIT0gbnVsbCkgewogICAgY29uc3QgbmdQcm9qZWN0QXNBdHRySWR4ID0gbm9kZUF0dHJzLmluZGV4T2YoNSk7CiAgICBpZiAoKG5nUHJvamVjdEFzQXR0cklkeCAmIDEpID09PSAwKSB7CiAgICAgIHJldHVybiBub2RlQXR0cnNbbmdQcm9qZWN0QXNBdHRySWR4ICsgMV07CiAgICB9CiAgfQogIHJldHVybiBudWxsOwp9CmZ1bmN0aW9uIGdldE5hbWVPbmx5TWFya2VySW5kZXgobm9kZUF0dHJzKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlQXR0cnMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IG5vZGVBdHRyID0gbm9kZUF0dHJzW2ldOwogICAgaWYgKGlzTmFtZU9ubHlBdHRyaWJ1dGVNYXJrZXIobm9kZUF0dHIpKSB7CiAgICAgIHJldHVybiBpOwogICAgfQogIH0KICByZXR1cm4gbm9kZUF0dHJzLmxlbmd0aDsKfQpmdW5jdGlvbiBtYXRjaFRlbXBsYXRlQXR0cmlidXRlKGF0dHJzLCBuYW1lKSB7CiAgbGV0IGkgPSBhdHRycy5pbmRleE9mKDQpOwogIGlmIChpID4gLTEpIHsKICAgIGkrKzsKICAgIHdoaWxlIChpIDwgYXR0cnMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGF0dHIgPSBhdHRyc1tpXTsKICAgICAgaWYgKHR5cGVvZiBhdHRyID09PSAibnVtYmVyIikgcmV0dXJuIC0xOwogICAgICBpZiAoYXR0ciA9PT0gbmFtZSkgcmV0dXJuIGk7CiAgICAgIGkrKzsKICAgIH0KICB9CiAgcmV0dXJuIC0xOwp9CmZ1bmN0aW9uIGlzU2VsZWN0b3JJblNlbGVjdG9yTGlzdChzZWxlY3RvciwgbGlzdCkgewogIHNlbGVjdG9yTGlzdExvb3A6IGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewogICAgY29uc3QgY3VycmVudFNlbGVjdG9ySW5MaXN0ID0gbGlzdFtpXTsKICAgIGlmIChzZWxlY3Rvci5sZW5ndGggIT09IGN1cnJlbnRTZWxlY3RvckluTGlzdC5sZW5ndGgpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNlbGVjdG9yLmxlbmd0aDsgaisrKSB7CiAgICAgIGlmIChzZWxlY3RvcltqXSAhPT0gY3VycmVudFNlbGVjdG9ySW5MaXN0W2pdKSB7CiAgICAgICAgY29udGludWUgc2VsZWN0b3JMaXN0TG9vcDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBtYXliZVdyYXBJbk5vdFNlbGVjdG9yKGlzTmVnYXRpdmVNb2RlLCBjaHVuaykgewogIHJldHVybiBpc05lZ2F0aXZlTW9kZSA/ICI6bm90KCIgKyBjaHVuay50cmltKCkgKyAiKSIgOiBjaHVuazsKfQpmdW5jdGlvbiBzdHJpbmdpZnlDU1NTZWxlY3RvcihzZWxlY3RvcikgewogIGxldCByZXN1bHQgPSBzZWxlY3RvclswXTsKICBsZXQgaSA9IDE7CiAgbGV0IG1vZGUgPSAyOwogIGxldCBjdXJyZW50Q2h1bmsgPSAiIjsKICBsZXQgaXNOZWdhdGl2ZU1vZGUgPSBmYWxzZTsKICB3aGlsZSAoaSA8IHNlbGVjdG9yLmxlbmd0aCkgewogICAgbGV0IHZhbHVlT3JNYXJrZXIgPSBzZWxlY3RvcltpXTsKICAgIGlmICh0eXBlb2YgdmFsdWVPck1hcmtlciA9PT0gInN0cmluZyIpIHsKICAgICAgaWYgKG1vZGUgJiAyKSB7CiAgICAgICAgY29uc3QgYXR0clZhbHVlID0gc2VsZWN0b3JbKytpXTsKICAgICAgICBjdXJyZW50Q2h1bmsgKz0gIlsiICsgdmFsdWVPck1hcmtlciArIChhdHRyVmFsdWUubGVuZ3RoID4gMCA/ICc9IicgKyBhdHRyVmFsdWUgKyAnIicgOiAiIikgKyAiXSI7CiAgICAgIH0gZWxzZSBpZiAobW9kZSAmIDgpIHsKICAgICAgICBjdXJyZW50Q2h1bmsgKz0gIi4iICsgdmFsdWVPck1hcmtlcjsKICAgICAgfSBlbHNlIGlmIChtb2RlICYgNCkgewogICAgICAgIGN1cnJlbnRDaHVuayArPSAiICIgKyB2YWx1ZU9yTWFya2VyOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoY3VycmVudENodW5rICE9PSAiIiAmJiAhaXNQb3NpdGl2ZSh2YWx1ZU9yTWFya2VyKSkgewogICAgICAgIHJlc3VsdCArPSBtYXliZVdyYXBJbk5vdFNlbGVjdG9yKGlzTmVnYXRpdmVNb2RlLCBjdXJyZW50Q2h1bmspOwogICAgICAgIGN1cnJlbnRDaHVuayA9ICIiOwogICAgICB9CiAgICAgIG1vZGUgPSB2YWx1ZU9yTWFya2VyOwogICAgICBpc05lZ2F0aXZlTW9kZSA9IGlzTmVnYXRpdmVNb2RlIHx8ICFpc1Bvc2l0aXZlKG1vZGUpOwogICAgfQogICAgaSsrOwogIH0KICBpZiAoY3VycmVudENodW5rICE9PSAiIikgewogICAgcmVzdWx0ICs9IG1heWJlV3JhcEluTm90U2VsZWN0b3IoaXNOZWdhdGl2ZU1vZGUsIGN1cnJlbnRDaHVuayk7CiAgfQogIHJldHVybiByZXN1bHQ7Cn0KZnVuY3Rpb24gc3RyaW5naWZ5Q1NTU2VsZWN0b3JMaXN0KHNlbGVjdG9yTGlzdCkgewogIHJldHVybiBzZWxlY3Rvckxpc3QubWFwKHN0cmluZ2lmeUNTU1NlbGVjdG9yKS5qb2luKCIsIik7Cn0KZnVuY3Rpb24gZXh0cmFjdEF0dHJzQW5kQ2xhc3Nlc0Zyb21TZWxlY3RvcihzZWxlY3RvcikgewogIGNvbnN0IGF0dHJzID0gW107CiAgY29uc3QgY2xhc3NlcyA9IFtdOwogIGxldCBpID0gMTsKICBsZXQgbW9kZSA9IDI7CiAgd2hpbGUgKGkgPCBzZWxlY3Rvci5sZW5ndGgpIHsKICAgIGxldCB2YWx1ZU9yTWFya2VyID0gc2VsZWN0b3JbaV07CiAgICBpZiAodHlwZW9mIHZhbHVlT3JNYXJrZXIgPT09ICJzdHJpbmciKSB7CiAgICAgIGlmIChtb2RlID09PSAyKSB7CiAgICAgICAgaWYgKHZhbHVlT3JNYXJrZXIgIT09ICIiKSB7CiAgICAgICAgICBhdHRycy5wdXNoKHZhbHVlT3JNYXJrZXIsIHNlbGVjdG9yWysraV0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtb2RlID09PSA4KSB7CiAgICAgICAgY2xhc3Nlcy5wdXNoKHZhbHVlT3JNYXJrZXIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoIWlzUG9zaXRpdmUobW9kZSkpIGJyZWFrOwogICAgICBtb2RlID0gdmFsdWVPck1hcmtlcjsKICAgIH0KICAgIGkrKzsKICB9CiAgaWYgKGNsYXNzZXMubGVuZ3RoKSB7CiAgICBhdHRycy5wdXNoKDEsIC4uLmNsYXNzZXMpOwogIH0KICByZXR1cm4gYXR0cnM7Cn0KdmFyIE5PX0NIQU5HRSA9IHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSA/IHsKICBfX2JyYW5kX186ICJOT19DSEFOR0UiCn0gOiB7fTsKZnVuY3Rpb24gY3JlYXRlVFZpZXcodHlwZSwgZGVjbFROb2RlLCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgZGlyZWN0aXZlcywgcGlwZXMsIHZpZXdRdWVyeSwgc2NoZW1hcywgY29uc3RzT3JGYWN0b3J5LCBzc3JJZCkgewogIGNvbnN0IGJpbmRpbmdTdGFydEluZGV4ID0gSEVBREVSX09GRlNFVCArIGRlY2xzOwogIGNvbnN0IGluaXRpYWxWaWV3TGVuZ3RoID0gYmluZGluZ1N0YXJ0SW5kZXggKyB2YXJzOwogIGNvbnN0IGJsdWVwcmludCA9IGNyZWF0ZVZpZXdCbHVlcHJpbnQoYmluZGluZ1N0YXJ0SW5kZXgsIGluaXRpYWxWaWV3TGVuZ3RoKTsKICBjb25zdCBjb25zdHMgPSB0eXBlb2YgY29uc3RzT3JGYWN0b3J5ID09PSAiZnVuY3Rpb24iID8gY29uc3RzT3JGYWN0b3J5KCkgOiBjb25zdHNPckZhY3Rvcnk7CiAgY29uc3QgdFZpZXcgPSBibHVlcHJpbnRbVFZJRVddID0gewogICAgdHlwZSwKICAgIGJsdWVwcmludCwKICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZUZuLAogICAgcXVlcmllczogbnVsbCwKICAgIHZpZXdRdWVyeSwKICAgIGRlY2xUTm9kZSwKICAgIGRhdGE6IGJsdWVwcmludC5zbGljZSgpLmZpbGwobnVsbCwgYmluZGluZ1N0YXJ0SW5kZXgpLAogICAgYmluZGluZ1N0YXJ0SW5kZXgsCiAgICBleHBhbmRvU3RhcnRJbmRleDogaW5pdGlhbFZpZXdMZW5ndGgsCiAgICBob3N0QmluZGluZ09wQ29kZXM6IG51bGwsCiAgICBmaXJzdENyZWF0ZVBhc3M6IHRydWUsCiAgICBmaXJzdFVwZGF0ZVBhc3M6IHRydWUsCiAgICBzdGF0aWNWaWV3UXVlcmllczogZmFsc2UsCiAgICBzdGF0aWNDb250ZW50UXVlcmllczogZmFsc2UsCiAgICBwcmVPcmRlckhvb2tzOiBudWxsLAogICAgcHJlT3JkZXJDaGVja0hvb2tzOiBudWxsLAogICAgY29udGVudEhvb2tzOiBudWxsLAogICAgY29udGVudENoZWNrSG9va3M6IG51bGwsCiAgICB2aWV3SG9va3M6IG51bGwsCiAgICB2aWV3Q2hlY2tIb29rczogbnVsbCwKICAgIGRlc3Ryb3lIb29rczogbnVsbCwKICAgIGNsZWFudXA6IG51bGwsCiAgICBjb250ZW50UXVlcmllczogbnVsbCwKICAgIGNvbXBvbmVudHM6IG51bGwsCiAgICBkaXJlY3RpdmVSZWdpc3RyeTogdHlwZW9mIGRpcmVjdGl2ZXMgPT09ICJmdW5jdGlvbiIgPyBkaXJlY3RpdmVzKCkgOiBkaXJlY3RpdmVzLAogICAgcGlwZVJlZ2lzdHJ5OiB0eXBlb2YgcGlwZXMgPT09ICJmdW5jdGlvbiIgPyBwaXBlcygpIDogcGlwZXMsCiAgICBmaXJzdENoaWxkOiBudWxsLAogICAgc2NoZW1hcywKICAgIGNvbnN0cywKICAgIGluY29tcGxldGVGaXJzdFBhc3M6IGZhbHNlLAogICAgc3NySWQKICB9OwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIE9iamVjdC5zZWFsKHRWaWV3KTsKICB9CiAgcmV0dXJuIHRWaWV3Owp9CmZ1bmN0aW9uIGNyZWF0ZVZpZXdCbHVlcHJpbnQoYmluZGluZ1N0YXJ0SW5kZXgsIGluaXRpYWxWaWV3TGVuZ3RoKSB7CiAgY29uc3QgYmx1ZXByaW50ID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbml0aWFsVmlld0xlbmd0aDsgaSsrKSB7CiAgICBibHVlcHJpbnQucHVzaChpIDwgYmluZGluZ1N0YXJ0SW5kZXggPyBudWxsIDogTk9fQ0hBTkdFKTsKICB9CiAgcmV0dXJuIGJsdWVwcmludDsKfQpmdW5jdGlvbiBnZXRPckNyZWF0ZUNvbXBvbmVudFRWaWV3KGRlZikgewogIGNvbnN0IHRWaWV3ID0gZGVmLnRWaWV3OwogIGlmICh0VmlldyA9PT0gbnVsbCB8fCB0Vmlldy5pbmNvbXBsZXRlRmlyc3RQYXNzKSB7CiAgICBjb25zdCBkZWNsVE5vZGUgPSBudWxsOwogICAgcmV0dXJuIGRlZi50VmlldyA9IGNyZWF0ZVRWaWV3KDEsIGRlY2xUTm9kZSwgZGVmLnRlbXBsYXRlLCBkZWYuZGVjbHMsIGRlZi52YXJzLCBkZWYuZGlyZWN0aXZlRGVmcywgZGVmLnBpcGVEZWZzLCBkZWYudmlld1F1ZXJ5LCBkZWYuc2NoZW1hcywgZGVmLmNvbnN0cywgZGVmLmlkKTsKICB9CiAgcmV0dXJuIHRWaWV3Owp9CmZ1bmN0aW9uIGNyZWF0ZUxWaWV3KHBhcmVudExWaWV3LCB0VmlldywgY29udGV4dDIsIGZsYWdzLCBob3N0LCB0SG9zdE5vZGUsIGVudmlyb25tZW50LCByZW5kZXJlciwgaW5qZWN0b3IsIGVtYmVkZGVkVmlld0luamVjdG9yLCBoeWRyYXRpb25JbmZvKSB7CiAgY29uc3QgbFZpZXcgPSB0Vmlldy5ibHVlcHJpbnQuc2xpY2UoKTsKICBsVmlld1tIT1NUXSA9IGhvc3Q7CiAgbFZpZXdbRkxBR1NdID0gZmxhZ3MgfCA0IHwgMTI4IHwgOCB8IDY0IHwgMTAyNDsKICBpZiAoZW1iZWRkZWRWaWV3SW5qZWN0b3IgIT09IG51bGwgfHwgcGFyZW50TFZpZXcgJiYgcGFyZW50TFZpZXdbRkxBR1NdICYgMjA0OCkgewogICAgbFZpZXdbRkxBR1NdIHw9IDIwNDg7CiAgfQogIHJlc2V0UHJlT3JkZXJIb29rRmxhZ3MobFZpZXcpOwogIG5nRGV2TW9kZSAmJiB0Vmlldy5kZWNsVE5vZGUgJiYgcGFyZW50TFZpZXcgJiYgYXNzZXJ0VE5vZGVGb3JMVmlldyh0Vmlldy5kZWNsVE5vZGUsIHBhcmVudExWaWV3KTsKICBsVmlld1tQQVJFTlRdID0gbFZpZXdbREVDTEFSQVRJT05fVklFV10gPSBwYXJlbnRMVmlldzsKICBsVmlld1tDT05URVhUXSA9IGNvbnRleHQyOwogIGxWaWV3W0VOVklST05NRU5UXSA9IGVudmlyb25tZW50IHx8IHBhcmVudExWaWV3ICYmIHBhcmVudExWaWV3W0VOVklST05NRU5UXTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChsVmlld1tFTlZJUk9OTUVOVF0sICJMVmlld0Vudmlyb25tZW50IGlzIHJlcXVpcmVkIik7CiAgbFZpZXdbUkVOREVSRVJdID0gcmVuZGVyZXIgfHwgcGFyZW50TFZpZXcgJiYgcGFyZW50TFZpZXdbUkVOREVSRVJdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGxWaWV3W1JFTkRFUkVSXSwgIlJlbmRlcmVyIGlzIHJlcXVpcmVkIik7CiAgbFZpZXdbSU5KRUNUT1JdID0gaW5qZWN0b3IgfHwgcGFyZW50TFZpZXcgJiYgcGFyZW50TFZpZXdbSU5KRUNUT1JdIHx8IG51bGw7CiAgbFZpZXdbVF9IT1NUXSA9IHRIb3N0Tm9kZTsKICBsVmlld1tJRF0gPSBnZXRVbmlxdWVMVmlld0lkKCk7CiAgbFZpZXdbSFlEUkFUSU9OXSA9IGh5ZHJhdGlvbkluZm87CiAgbFZpZXdbRU1CRURERURfVklFV19JTkpFQ1RPUl0gPSBlbWJlZGRlZFZpZXdJbmplY3RvcjsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwodFZpZXcudHlwZSA9PSAyID8gcGFyZW50TFZpZXcgIT09IG51bGwgOiB0cnVlLCB0cnVlLCAiRW1iZWRkZWQgdmlld3MgbXVzdCBoYXZlIHBhcmVudExWaWV3Iik7CiAgbFZpZXdbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddID0gdFZpZXcudHlwZSA9PSAyID8gcGFyZW50TFZpZXdbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddIDogbFZpZXc7CiAgcmV0dXJuIGxWaWV3Owp9CmZ1bmN0aW9uIGNyZWF0ZUNvbXBvbmVudExWaWV3KGxWaWV3LCBob3N0VE5vZGUsIGRlZikgewogIGNvbnN0IG5hdGl2ZSA9IGdldE5hdGl2ZUJ5VE5vZGUoaG9zdFROb2RlLCBsVmlldyk7CiAgY29uc3QgdFZpZXcgPSBnZXRPckNyZWF0ZUNvbXBvbmVudFRWaWV3KGRlZik7CiAgY29uc3QgcmVuZGVyZXJGYWN0b3J5ID0gbFZpZXdbRU5WSVJPTk1FTlRdLnJlbmRlcmVyRmFjdG9yeTsKICBjb25zdCBjb21wb25lbnRWaWV3ID0gYWRkVG9FbmRPZlZpZXdUcmVlKGxWaWV3LCBjcmVhdGVMVmlldyhsVmlldywgdFZpZXcsIG51bGwsIGdldEluaXRpYWxMVmlld0ZsYWdzRnJvbURlZihkZWYpLCBuYXRpdmUsIGhvc3RUTm9kZSwgbnVsbCwgcmVuZGVyZXJGYWN0b3J5LmNyZWF0ZVJlbmRlcmVyKG5hdGl2ZSwgZGVmKSwgbnVsbCwgbnVsbCwgbnVsbCkpOwogIHJldHVybiBsVmlld1tob3N0VE5vZGUuaW5kZXhdID0gY29tcG9uZW50VmlldzsKfQpmdW5jdGlvbiBnZXRJbml0aWFsTFZpZXdGbGFnc0Zyb21EZWYoZGVmKSB7CiAgbGV0IGZsYWdzID0gMTY7CiAgaWYgKGRlZi5zaWduYWxzKSB7CiAgICBmbGFncyA9IDQwOTY7CiAgfSBlbHNlIGlmIChkZWYub25QdXNoKSB7CiAgICBmbGFncyA9IDY0OwogIH0KICByZXR1cm4gZmxhZ3M7Cn0KZnVuY3Rpb24gYWxsb2NFeHBhbmRvKHRWaWV3LCBsVmlldywgbnVtU2xvdHNUb0FsbG9jLCBpbml0aWFsVmFsdWUpIHsKICBpZiAobnVtU2xvdHNUb0FsbG9jID09PSAwKSByZXR1cm4gLTE7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgYXNzZXJ0Rmlyc3RDcmVhdGVQYXNzKHRWaWV3KTsKICAgIGFzc2VydFNhbWUodFZpZXcsIGxWaWV3W1RWSUVXXSwgImBMVmlld2AgbXVzdCBiZSBhc3NvY2lhdGVkIHdpdGggYFRWaWV3YCEiKTsKICAgIGFzc2VydEVxdWFsKHRWaWV3LmRhdGEubGVuZ3RoLCBsVmlldy5sZW5ndGgsICJFeHBlY3RpbmcgTFZpZXcgdG8gYmUgc2FtZSBzaXplIGFzIFRWaWV3Iik7CiAgICBhc3NlcnRFcXVhbCh0Vmlldy5kYXRhLmxlbmd0aCwgdFZpZXcuYmx1ZXByaW50Lmxlbmd0aCwgIkV4cGVjdGluZyBCbHVlcHJpbnQgdG8gYmUgc2FtZSBzaXplIGFzIFRWaWV3Iik7CiAgICBhc3NlcnRGaXJzdFVwZGF0ZVBhc3ModFZpZXcpOwogIH0KICBjb25zdCBhbGxvY0lkeCA9IGxWaWV3Lmxlbmd0aDsKICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVNsb3RzVG9BbGxvYzsgaSsrKSB7CiAgICBsVmlldy5wdXNoKGluaXRpYWxWYWx1ZSk7CiAgICB0Vmlldy5ibHVlcHJpbnQucHVzaChpbml0aWFsVmFsdWUpOwogICAgdFZpZXcuZGF0YS5wdXNoKG51bGwpOwogIH0KICByZXR1cm4gYWxsb2NJZHg7Cn0KZnVuY3Rpb24gYWRkVG9FbmRPZlZpZXdUcmVlKGxWaWV3LCBsVmlld09yTENvbnRhaW5lcikgewogIGlmIChsVmlld1tDSElMRF9IRUFEXSkgewogICAgbFZpZXdbQ0hJTERfVEFJTF1bTkVYVF0gPSBsVmlld09yTENvbnRhaW5lcjsKICB9IGVsc2UgewogICAgbFZpZXdbQ0hJTERfSEVBRF0gPSBsVmlld09yTENvbnRhaW5lcjsKICB9CiAgbFZpZXdbQ0hJTERfVEFJTF0gPSBsVmlld09yTENvbnRhaW5lcjsKICByZXR1cm4gbFZpZXdPckxDb250YWluZXI7Cn0KZnVuY3Rpb24gybXJtWFkdmFuY2UoZGVsdGEgPSAxKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEdyZWF0ZXJUaGFuKGRlbHRhLCAwLCAiQ2FuIG9ubHkgYWR2YW5jZSBmb3J3YXJkIik7CiAgc2VsZWN0SW5kZXhJbnRlcm5hbChnZXRUVmlldygpLCBnZXRMVmlldygpLCBnZXRTZWxlY3RlZEluZGV4KCkgKyBkZWx0YSwgISFuZ0Rldk1vZGUgJiYgaXNJbkNoZWNrTm9DaGFuZ2VzTW9kZSgpKTsKfQpmdW5jdGlvbiBzZWxlY3RJbmRleEludGVybmFsKHRWaWV3LCBsVmlldywgaW5kZXgsIGNoZWNrTm9DaGFuZ2VzTW9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluRGVjbFJhbmdlKGxWaWV3W1RWSUVXXSwgaW5kZXgpOwogIGlmICghY2hlY2tOb0NoYW5nZXNNb2RlKSB7CiAgICBjb25zdCBob29rc0luaXRQaGFzZUNvbXBsZXRlZCA9IChsVmlld1tGTEFHU10gJiAzKSA9PT0gMzsKICAgIGlmIChob29rc0luaXRQaGFzZUNvbXBsZXRlZCkgewogICAgICBjb25zdCBwcmVPcmRlckNoZWNrSG9va3MgPSB0Vmlldy5wcmVPcmRlckNoZWNrSG9va3M7CiAgICAgIGlmIChwcmVPcmRlckNoZWNrSG9va3MgIT09IG51bGwpIHsKICAgICAgICBleGVjdXRlQ2hlY2tIb29rcyhsVmlldywgcHJlT3JkZXJDaGVja0hvb2tzLCBpbmRleCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHByZU9yZGVySG9va3MgPSB0Vmlldy5wcmVPcmRlckhvb2tzOwogICAgICBpZiAocHJlT3JkZXJIb29rcyAhPT0gbnVsbCkgewogICAgICAgIGV4ZWN1dGVJbml0QW5kQ2hlY2tIb29rcyhsVmlldywgcHJlT3JkZXJIb29rcywgMCwgaW5kZXgpOwogICAgICB9CiAgICB9CiAgfQogIHNldFNlbGVjdGVkSW5kZXgoaW5kZXgpOwp9CnZhciBJbnB1dEZsYWdzOwooZnVuY3Rpb24oSW5wdXRGbGFnczIpIHsKICBJbnB1dEZsYWdzMltJbnB1dEZsYWdzMlsiTm9uZSJdID0gMF0gPSAiTm9uZSI7CiAgSW5wdXRGbGFnczJbSW5wdXRGbGFnczJbIlNpZ25hbEJhc2VkIl0gPSAxXSA9ICJTaWduYWxCYXNlZCI7CiAgSW5wdXRGbGFnczJbSW5wdXRGbGFnczJbIkhhc0RlY29yYXRvcklucHV0VHJhbnNmb3JtIl0gPSAyXSA9ICJIYXNEZWNvcmF0b3JJbnB1dFRyYW5zZm9ybSI7Cn0pKElucHV0RmxhZ3MgfHwgKElucHV0RmxhZ3MgPSB7fSkpOwpmdW5jdGlvbiB3cml0ZVRvRGlyZWN0aXZlSW5wdXQoZGVmLCBpbnN0YW5jZSwgcHVibGljTmFtZSwgdmFsdWUpIHsKICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICB0cnkgewogICAgaWYgKG5nRGV2TW9kZSkgewogICAgICBpZiAoIWRlZi5pbnB1dHMuaGFzT3duUHJvcGVydHkocHVibGljTmFtZSkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFTU0VSVElPTiBFUlJPUjogRGlyZWN0aXZlICR7ZGVmLnR5cGUubmFtZX0gZG9lcyBub3QgaGF2ZSBhbiBpbnB1dCB3aXRoIGEgcHVibGljIG5hbWUgb2YgIiR7cHVibGljTmFtZX0iYCk7CiAgICAgIH0KICAgICAgaWYgKGluc3RhbmNlIGluc3RhbmNlb2YgTm9kZUluamVjdG9yRmFjdG9yeSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgQVNTRVJUSU9OIEVSUk9SOiBDYW5ub3Qgd3JpdGUgaW5wdXQgdG8gZmFjdG9yeSBmb3IgdHlwZSAke2RlZi50eXBlLm5hbWV9LiBEaXJlY3RpdmUgaGFzIG5vdCBiZWVuIGNyZWF0ZWQgeWV0LmApOwogICAgICB9CiAgICB9CiAgICBjb25zdCBbcHJpdmF0ZU5hbWUsIGZsYWdzLCB0cmFuc2Zvcm1dID0gZGVmLmlucHV0c1twdWJsaWNOYW1lXTsKICAgIGxldCBpbnB1dFNpZ25hbE5vZGUgPSBudWxsOwogICAgaWYgKChmbGFncyAmIElucHV0RmxhZ3MuU2lnbmFsQmFzZWQpICE9PSAwKSB7CiAgICAgIGNvbnN0IGZpZWxkID0gaW5zdGFuY2VbcHJpdmF0ZU5hbWVdOwogICAgICBpbnB1dFNpZ25hbE5vZGUgPSBmaWVsZFtTSUdOQUxdOwogICAgfQogICAgaWYgKGlucHV0U2lnbmFsTm9kZSAhPT0gbnVsbCAmJiBpbnB1dFNpZ25hbE5vZGUudHJhbnNmb3JtRm4gIT09IHZvaWQgMCkgewogICAgICB2YWx1ZSA9IGlucHV0U2lnbmFsTm9kZS50cmFuc2Zvcm1Gbih2YWx1ZSk7CiAgICB9IGVsc2UgaWYgKHRyYW5zZm9ybSAhPT0gbnVsbCkgewogICAgICB2YWx1ZSA9IHRyYW5zZm9ybS5jYWxsKGluc3RhbmNlLCB2YWx1ZSk7CiAgICB9CiAgICBpZiAoZGVmLnNldElucHV0ICE9PSBudWxsKSB7CiAgICAgIGRlZi5zZXRJbnB1dChpbnN0YW5jZSwgaW5wdXRTaWduYWxOb2RlLCB2YWx1ZSwgcHVibGljTmFtZSwgcHJpdmF0ZU5hbWUpOwogICAgfSBlbHNlIHsKICAgICAgYXBwbHlWYWx1ZVRvSW5wdXRGaWVsZChpbnN0YW5jZSwgaW5wdXRTaWduYWxOb2RlLCBwcml2YXRlTmFtZSwgdmFsdWUpOwogICAgfQogIH0gZmluYWxseSB7CiAgICBzZXRBY3RpdmVDb25zdW1lcihwcmV2Q29uc3VtZXIpOwogIH0KfQp2YXIgUmVuZGVyZXJTdHlsZUZsYWdzMjsKKGZ1bmN0aW9uKFJlbmRlcmVyU3R5bGVGbGFnczIyKSB7CiAgUmVuZGVyZXJTdHlsZUZsYWdzMjJbUmVuZGVyZXJTdHlsZUZsYWdzMjJbIkltcG9ydGFudCJdID0gMV0gPSAiSW1wb3J0YW50IjsKICBSZW5kZXJlclN0eWxlRmxhZ3MyMltSZW5kZXJlclN0eWxlRmxhZ3MyMlsiRGFzaENhc2UiXSA9IDJdID0gIkRhc2hDYXNlIjsKfSkoUmVuZGVyZXJTdHlsZUZsYWdzMiB8fCAoUmVuZGVyZXJTdHlsZUZsYWdzMiA9IHt9KSk7CnZhciBfaWN1Q29udGFpbmVySXRlcmF0ZTsKZnVuY3Rpb24gaWN1Q29udGFpbmVySXRlcmF0ZSh0SWN1Q29udGFpbmVyTm9kZSwgbFZpZXcpIHsKICByZXR1cm4gX2ljdUNvbnRhaW5lckl0ZXJhdGUodEljdUNvbnRhaW5lck5vZGUsIGxWaWV3KTsKfQpmdW5jdGlvbiBlbnN1cmVJY3VDb250YWluZXJWaXNpdG9yTG9hZGVkKGxvYWRlcikgewogIGlmIChfaWN1Q29udGFpbmVySXRlcmF0ZSA9PT0gdm9pZCAwKSB7CiAgICBfaWN1Q29udGFpbmVySXRlcmF0ZSA9IGxvYWRlcigpOwogIH0KfQpmdW5jdGlvbiBwYXJzZUNzc1RpbWVVbml0c1RvTXModmFsdWUpIHsKICBpZiAoIXZhbHVlKSByZXR1cm4gMDsKICBjb25zdCBtdWx0aXBsaWVyID0gdmFsdWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJtcyIpID4gLTEgPyAxIDogMWUzOwogIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKSAqIG11bHRpcGxpZXI7Cn0KZnVuY3Rpb24gcGFyc2VDc3NQcm9wZXJ0eVZhbHVlKGNvbXB1dGVkU3R5bGUsIG5hbWUpIHsKICBjb25zdCB2YWx1ZSA9IGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShuYW1lKTsKICByZXR1cm4gdmFsdWUuc3BsaXQoIiwiKS5tYXAoKHBhcnQpID0+IHBhcnQudHJpbSgpKTsKfQpmdW5jdGlvbiBnZXRMb25nZXN0Q29tcHV0ZWRUcmFuc2l0aW9uKGNvbXB1dGVkU3R5bGUpIHsKICBjb25zdCB0cmFuc2l0aW9uZWRQcm9wZXJ0aWVzID0gcGFyc2VDc3NQcm9wZXJ0eVZhbHVlKGNvbXB1dGVkU3R5bGUsICJ0cmFuc2l0aW9uLXByb3BlcnR5Iik7CiAgY29uc3QgcmF3RHVyYXRpb25zID0gcGFyc2VDc3NQcm9wZXJ0eVZhbHVlKGNvbXB1dGVkU3R5bGUsICJ0cmFuc2l0aW9uLWR1cmF0aW9uIik7CiAgY29uc3QgcmF3RGVsYXlzID0gcGFyc2VDc3NQcm9wZXJ0eVZhbHVlKGNvbXB1dGVkU3R5bGUsICJ0cmFuc2l0aW9uLWRlbGF5Iik7CiAgY29uc3QgbG9uZ2VzdCA9IHsKICAgIHByb3BlcnR5TmFtZTogIiIsCiAgICBkdXJhdGlvbjogMCwKICAgIGFuaW1hdGlvbk5hbWU6IHZvaWQgMAogIH07CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmFuc2l0aW9uZWRQcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBkdXJhdGlvbiA9IHBhcnNlQ3NzVGltZVVuaXRzVG9NcyhyYXdEZWxheXNbaV0pICsgcGFyc2VDc3NUaW1lVW5pdHNUb01zKHJhd0R1cmF0aW9uc1tpXSk7CiAgICBpZiAoZHVyYXRpb24gPiBsb25nZXN0LmR1cmF0aW9uKSB7CiAgICAgIGxvbmdlc3QucHJvcGVydHlOYW1lID0gdHJhbnNpdGlvbmVkUHJvcGVydGllc1tpXTsKICAgICAgbG9uZ2VzdC5kdXJhdGlvbiA9IGR1cmF0aW9uOwogICAgfQogIH0KICByZXR1cm4gbG9uZ2VzdDsKfQpmdW5jdGlvbiBnZXRMb25nZXN0Q29tcHV0ZWRBbmltYXRpb24oY29tcHV0ZWRTdHlsZSkgewogIGNvbnN0IHJhd05hbWVzID0gcGFyc2VDc3NQcm9wZXJ0eVZhbHVlKGNvbXB1dGVkU3R5bGUsICJhbmltYXRpb24tbmFtZSIpOwogIGNvbnN0IHJhd0RlbGF5cyA9IHBhcnNlQ3NzUHJvcGVydHlWYWx1ZShjb21wdXRlZFN0eWxlLCAiYW5pbWF0aW9uLWRlbGF5Iik7CiAgY29uc3QgcmF3RHVyYXRpb25zID0gcGFyc2VDc3NQcm9wZXJ0eVZhbHVlKGNvbXB1dGVkU3R5bGUsICJhbmltYXRpb24tZHVyYXRpb24iKTsKICBjb25zdCBsb25nZXN0ID0gewogICAgYW5pbWF0aW9uTmFtZTogIiIsCiAgICBwcm9wZXJ0eU5hbWU6IHZvaWQgMCwKICAgIGR1cmF0aW9uOiAwCiAgfTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHJhd05hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBkdXJhdGlvbiA9IHBhcnNlQ3NzVGltZVVuaXRzVG9NcyhyYXdEZWxheXNbaV0pICsgcGFyc2VDc3NUaW1lVW5pdHNUb01zKHJhd0R1cmF0aW9uc1tpXSk7CiAgICBpZiAoZHVyYXRpb24gPiBsb25nZXN0LmR1cmF0aW9uKSB7CiAgICAgIGxvbmdlc3QuYW5pbWF0aW9uTmFtZSA9IHJhd05hbWVzW2ldOwogICAgICBsb25nZXN0LmR1cmF0aW9uID0gZHVyYXRpb247CiAgICB9CiAgfQogIHJldHVybiBsb25nZXN0Owp9CmZ1bmN0aW9uIGlzU2hvcnRlclRoYW5FeGlzdGluZ0FuaW1hdGlvbihleGlzdGluZywgbG9uZ2VzdCkgewogIHJldHVybiBleGlzdGluZyAhPT0gdm9pZCAwICYmIGV4aXN0aW5nLmR1cmF0aW9uID4gbG9uZ2VzdC5kdXJhdGlvbjsKfQpmdW5jdGlvbiBsb25nZXN0RXhpc3RzKGxvbmdlc3QpIHsKICByZXR1cm4gKGxvbmdlc3QuYW5pbWF0aW9uTmFtZSAhPSB2b2lkIDAgfHwgbG9uZ2VzdC5wcm9wZXJ0eU5hbWUgIT0gdm9pZCAwKSAmJiBsb25nZXN0LmR1cmF0aW9uID4gMDsKfQpmdW5jdGlvbiBkZXRlcm1pbmVMb25nZXN0QW5pbWF0aW9uRnJvbUNvbXB1dGVkU3R5bGVzKGVsLCBhbmltYXRpb25zTWFwKSB7CiAgY29uc3QgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWwpOwogIGNvbnN0IGxvbmdlc3RBbmltYXRpb24gPSBnZXRMb25nZXN0Q29tcHV0ZWRBbmltYXRpb24oY29tcHV0ZWRTdHlsZSk7CiAgY29uc3QgbG9uZ2VzdFRyYW5zaXRpb24gPSBnZXRMb25nZXN0Q29tcHV0ZWRUcmFuc2l0aW9uKGNvbXB1dGVkU3R5bGUpOwogIGNvbnN0IGxvbmdlc3QgPSBsb25nZXN0QW5pbWF0aW9uLmR1cmF0aW9uID4gbG9uZ2VzdFRyYW5zaXRpb24uZHVyYXRpb24gPyBsb25nZXN0QW5pbWF0aW9uIDogbG9uZ2VzdFRyYW5zaXRpb247CiAgaWYgKGlzU2hvcnRlclRoYW5FeGlzdGluZ0FuaW1hdGlvbihhbmltYXRpb25zTWFwLmdldChlbCksIGxvbmdlc3QpKSByZXR1cm47CiAgaWYgKGxvbmdlc3RFeGlzdHMobG9uZ2VzdCkpIHsKICAgIGFuaW1hdGlvbnNNYXAuc2V0KGVsLCBsb25nZXN0KTsKICB9Cn0KZnVuY3Rpb24gZGV0ZXJtaW5lTG9uZ2VzdEFuaW1hdGlvbihlbCwgYW5pbWF0aW9uc01hcCwgYXJlQW5pbWF0aW9uU3VwcG9ydGVkMikgewogIGlmICghYXJlQW5pbWF0aW9uU3VwcG9ydGVkMikgcmV0dXJuOwogIGNvbnN0IGFuaW1hdGlvbnMgPSBlbC5nZXRBbmltYXRpb25zKCk7CiAgcmV0dXJuIGFuaW1hdGlvbnMubGVuZ3RoID09PSAwID8gZGV0ZXJtaW5lTG9uZ2VzdEFuaW1hdGlvbkZyb21Db21wdXRlZFN0eWxlcyhlbCwgYW5pbWF0aW9uc01hcCkgOiBkZXRlcm1pbmVMb25nZXN0QW5pbWF0aW9uRnJvbUVsZW1lbnRBbmltYXRpb25zKGVsLCBhbmltYXRpb25zTWFwLCBhbmltYXRpb25zKTsKfQpmdW5jdGlvbiBkZXRlcm1pbmVMb25nZXN0QW5pbWF0aW9uRnJvbUVsZW1lbnRBbmltYXRpb25zKGVsLCBhbmltYXRpb25zTWFwLCBhbmltYXRpb25zKSB7CiAgbGV0IGxvbmdlc3QgPSB7CiAgICBhbmltYXRpb25OYW1lOiB2b2lkIDAsCiAgICBwcm9wZXJ0eU5hbWU6IHZvaWQgMCwKICAgIGR1cmF0aW9uOiAwCiAgfTsKICBmb3IgKGNvbnN0IGFuaW1hdGlvbiBvZiBhbmltYXRpb25zKSB7CiAgICBjb25zdCB0aW1pbmcgPSBhbmltYXRpb24uZWZmZWN0Py5nZXRUaW1pbmcoKTsKICAgIGNvbnN0IGFuaW1EdXJhdGlvbiA9IHR5cGVvZiB0aW1pbmc/LmR1cmF0aW9uID09PSAibnVtYmVyIiA/IHRpbWluZy5kdXJhdGlvbiA6IDA7CiAgICBsZXQgZHVyYXRpb24gPSAodGltaW5nPy5kZWxheSA/PyAwKSArIGFuaW1EdXJhdGlvbjsKICAgIGxldCBwcm9wZXJ0eU5hbWU7CiAgICBsZXQgYW5pbWF0aW9uTmFtZTsKICAgIGlmIChhbmltYXRpb24uYW5pbWF0aW9uTmFtZSkgewogICAgICBhbmltYXRpb25OYW1lID0gYW5pbWF0aW9uLmFuaW1hdGlvbk5hbWU7CiAgICB9IGVsc2UgewogICAgICBwcm9wZXJ0eU5hbWUgPSBhbmltYXRpb24udHJhbnNpdGlvblByb3BlcnR5OwogICAgfQogICAgaWYgKGR1cmF0aW9uID49IGxvbmdlc3QuZHVyYXRpb24pIHsKICAgICAgbG9uZ2VzdCA9IHsKICAgICAgICBhbmltYXRpb25OYW1lLAogICAgICAgIHByb3BlcnR5TmFtZSwKICAgICAgICBkdXJhdGlvbgogICAgICB9OwogICAgfQogIH0KICBpZiAoaXNTaG9ydGVyVGhhbkV4aXN0aW5nQW5pbWF0aW9uKGFuaW1hdGlvbnNNYXAuZ2V0KGVsKSwgbG9uZ2VzdCkpIHJldHVybjsKICBpZiAobG9uZ2VzdEV4aXN0cyhsb25nZXN0KSkgewogICAgYW5pbWF0aW9uc01hcC5zZXQoZWwsIGxvbmdlc3QpOwogIH0KfQp2YXIgYWxsTGVhdmluZ0FuaW1hdGlvbnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwp2YXIgVHJhY2luZ0FjdGlvbjsKKGZ1bmN0aW9uKFRyYWNpbmdBY3Rpb24yKSB7CiAgVHJhY2luZ0FjdGlvbjJbVHJhY2luZ0FjdGlvbjJbIkNIQU5HRV9ERVRFQ1RJT04iXSA9IDBdID0gIkNIQU5HRV9ERVRFQ1RJT04iOwogIFRyYWNpbmdBY3Rpb24yW1RyYWNpbmdBY3Rpb24yWyJBRlRFUl9ORVhUX1JFTkRFUiJdID0gMV0gPSAiQUZURVJfTkVYVF9SRU5ERVIiOwp9KShUcmFjaW5nQWN0aW9uIHx8IChUcmFjaW5nQWN0aW9uID0ge30pKTsKdmFyIFRyYWNpbmdTZXJ2aWNlID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJUcmFjaW5nU2VydmljZSIgOiAiIik7CnZhciBtYXJrZWRGZWF0dXJlcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CmZ1bmN0aW9uIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUoZmVhdHVyZSkgewogIGlmIChtYXJrZWRGZWF0dXJlcy5oYXMoZmVhdHVyZSkpIHsKICAgIHJldHVybjsKICB9CiAgbWFya2VkRmVhdHVyZXMuYWRkKGZlYXR1cmUpOwogIHBlcmZvcm1hbmNlPy5tYXJrPy4oIm1hcmtfZmVhdHVyZV91c2FnZSIsIHsKICAgIGRldGFpbDogewogICAgICBmZWF0dXJlCiAgICB9CiAgfSk7Cn0KdmFyIEFmdGVyUmVuZGVyTWFuYWdlciA9IGNsYXNzIF9BZnRlclJlbmRlck1hbmFnZXIgewogIGltcGwgPSBudWxsOwogIGV4ZWN1dGUoKSB7CiAgICB0aGlzLmltcGw/LmV4ZWN1dGUoKTsKICB9CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfQWZ0ZXJSZW5kZXJNYW5hZ2VyLAogICAgcHJvdmlkZWRJbjogInJvb3QiLAogICAgZmFjdG9yeTogKCkgPT4gbmV3IF9BZnRlclJlbmRlck1hbmFnZXIoKQogIH0pOwp9Owp2YXIgQUZURVJfUkVOREVSX1BIQVNFUyA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gWzAsIDEsIDIsIDNdKSgpOwp2YXIgQWZ0ZXJSZW5kZXJJbXBsID0gY2xhc3MgX0FmdGVyUmVuZGVySW1wbCB7CiAgbmdab25lID0gaW5qZWN0MihOZ1pvbmUpOwogIHNjaGVkdWxlciA9IGluamVjdDIoQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyKTsKICBlcnJvckhhbmRsZXIgPSBpbmplY3QyKEVycm9ySGFuZGxlciwgewogICAgb3B0aW9uYWw6IHRydWUKICB9KTsKICBzZXF1ZW5jZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwogIGRlZmVycmVkUmVnaXN0cmF0aW9ucyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgZXhlY3V0aW5nID0gZmFsc2U7CiAgY29uc3RydWN0b3IoKSB7CiAgICBpbmplY3QyKFRyYWNpbmdTZXJ2aWNlLCB7CiAgICAgIG9wdGlvbmFsOiB0cnVlCiAgICB9KTsKICB9CiAgZXhlY3V0ZSgpIHsKICAgIGNvbnN0IGhhc1NlcXVlbmNlc1RvRXhlY3V0ZSA9IHRoaXMuc2VxdWVuY2VzLnNpemUgPiAwOwogICAgaWYgKGhhc1NlcXVlbmNlc1RvRXhlY3V0ZSkgewogICAgICBwcm9maWxlcihQcm9maWxlckV2ZW50LkFmdGVyUmVuZGVySG9va3NTdGFydCk7CiAgICB9CiAgICB0aGlzLmV4ZWN1dGluZyA9IHRydWU7CiAgICBmb3IgKGNvbnN0IHBoYXNlIG9mIEFGVEVSX1JFTkRFUl9QSEFTRVMpIHsKICAgICAgZm9yIChjb25zdCBzZXF1ZW5jZSBvZiB0aGlzLnNlcXVlbmNlcykgewogICAgICAgIGlmIChzZXF1ZW5jZS5lcnJvcmVkT3JEZXN0cm95ZWQgfHwgIXNlcXVlbmNlLmhvb2tzW3BoYXNlXSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICBzZXF1ZW5jZS5waXBlbGluZWRWYWx1ZSA9IHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMubWF5YmVUcmFjZSgoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGhvb2tGbiA9IHNlcXVlbmNlLmhvb2tzW3BoYXNlXTsKICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBob29rRm4oc2VxdWVuY2UucGlwZWxpbmVkVmFsdWUpOwogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICB9LCBzZXF1ZW5jZS5zbmFwc2hvdCkpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgc2VxdWVuY2UuZXJyb3JlZE9yRGVzdHJveWVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZXJyb3JIYW5kbGVyPy5oYW5kbGVFcnJvcihlcnIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgdGhpcy5leGVjdXRpbmcgPSBmYWxzZTsKICAgIGZvciAoY29uc3Qgc2VxdWVuY2Ugb2YgdGhpcy5zZXF1ZW5jZXMpIHsKICAgICAgc2VxdWVuY2UuYWZ0ZXJSdW4oKTsKICAgICAgaWYgKHNlcXVlbmNlLm9uY2UpIHsKICAgICAgICB0aGlzLnNlcXVlbmNlcy5kZWxldGUoc2VxdWVuY2UpOwogICAgICAgIHNlcXVlbmNlLmRlc3Ryb3koKTsKICAgICAgfQogICAgfQogICAgZm9yIChjb25zdCBzZXF1ZW5jZSBvZiB0aGlzLmRlZmVycmVkUmVnaXN0cmF0aW9ucykgewogICAgICB0aGlzLnNlcXVlbmNlcy5hZGQoc2VxdWVuY2UpOwogICAgfQogICAgaWYgKHRoaXMuZGVmZXJyZWRSZWdpc3RyYXRpb25zLnNpemUgPiAwKSB7CiAgICAgIHRoaXMuc2NoZWR1bGVyLm5vdGlmeSg3KTsKICAgIH0KICAgIHRoaXMuZGVmZXJyZWRSZWdpc3RyYXRpb25zLmNsZWFyKCk7CiAgICBpZiAoaGFzU2VxdWVuY2VzVG9FeGVjdXRlKSB7CiAgICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQWZ0ZXJSZW5kZXJIb29rc0VuZCk7CiAgICB9CiAgfQogIHJlZ2lzdGVyKHNlcXVlbmNlKSB7CiAgICBjb25zdCB7CiAgICAgIHZpZXcKICAgIH0gPSBzZXF1ZW5jZTsKICAgIGlmICh2aWV3ICE9PSB2b2lkIDApIHsKICAgICAgKHZpZXdbQUZURVJfUkVOREVSX1NFUVVFTkNFU19UT19BRERdID8/PSBbXSkucHVzaChzZXF1ZW5jZSk7CiAgICAgIG1hcmtBbmNlc3RvcnNGb3JUcmF2ZXJzYWwodmlldyk7CiAgICAgIHZpZXdbRkxBR1NdIHw9IDgxOTI7CiAgICB9IGVsc2UgaWYgKCF0aGlzLmV4ZWN1dGluZykgewogICAgICB0aGlzLmFkZFNlcXVlbmNlKHNlcXVlbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGVmZXJyZWRSZWdpc3RyYXRpb25zLmFkZChzZXF1ZW5jZSk7CiAgICB9CiAgfQogIGFkZFNlcXVlbmNlKHNlcXVlbmNlKSB7CiAgICB0aGlzLnNlcXVlbmNlcy5hZGQoc2VxdWVuY2UpOwogICAgdGhpcy5zY2hlZHVsZXIubm90aWZ5KDcpOwogIH0KICB1bnJlZ2lzdGVyKHNlcXVlbmNlKSB7CiAgICBpZiAodGhpcy5leGVjdXRpbmcgJiYgdGhpcy5zZXF1ZW5jZXMuaGFzKHNlcXVlbmNlKSkgewogICAgICBzZXF1ZW5jZS5lcnJvcmVkT3JEZXN0cm95ZWQgPSB0cnVlOwogICAgICBzZXF1ZW5jZS5waXBlbGluZWRWYWx1ZSA9IHZvaWQgMDsKICAgICAgc2VxdWVuY2Uub25jZSA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnNlcXVlbmNlcy5kZWxldGUoc2VxdWVuY2UpOwogICAgICB0aGlzLmRlZmVycmVkUmVnaXN0cmF0aW9ucy5kZWxldGUoc2VxdWVuY2UpOwogICAgfQogIH0KICBtYXliZVRyYWNlKGZuLCBzbmFwc2hvdCkgewogICAgcmV0dXJuIHNuYXBzaG90ID8gc25hcHNob3QucnVuKFRyYWNpbmdBY3Rpb24uQUZURVJfTkVYVF9SRU5ERVIsIGZuKSA6IGZuKCk7CiAgfQogIHN0YXRpYyDJtXByb3YgPSDJtcm1ZGVmaW5lSW5qZWN0YWJsZSh7CiAgICB0b2tlbjogX0FmdGVyUmVuZGVySW1wbCwKICAgIHByb3ZpZGVkSW46ICJyb290IiwKICAgIGZhY3Rvcnk6ICgpID0+IG5ldyBfQWZ0ZXJSZW5kZXJJbXBsKCkKICB9KTsKfTsKdmFyIEFmdGVyUmVuZGVyU2VxdWVuY2UgPSBjbGFzcyB7CiAgaW1wbDsKICBob29rczsKICB2aWV3OwogIG9uY2U7CiAgc25hcHNob3Q7CiAgZXJyb3JlZE9yRGVzdHJveWVkID0gZmFsc2U7CiAgcGlwZWxpbmVkVmFsdWUgPSB2b2lkIDA7CiAgdW5yZWdpc3Rlck9uRGVzdHJveTsKICBjb25zdHJ1Y3RvcihpbXBsLCBob29rcywgdmlldywgb25jZSwgZGVzdHJveVJlZiwgc25hcHNob3QgPSBudWxsKSB7CiAgICB0aGlzLmltcGwgPSBpbXBsOwogICAgdGhpcy5ob29rcyA9IGhvb2tzOwogICAgdGhpcy52aWV3ID0gdmlldzsKICAgIHRoaXMub25jZSA9IG9uY2U7CiAgICB0aGlzLnNuYXBzaG90ID0gc25hcHNob3Q7CiAgICB0aGlzLnVucmVnaXN0ZXJPbkRlc3Ryb3kgPSBkZXN0cm95UmVmPy5vbkRlc3Ryb3koKCkgPT4gdGhpcy5kZXN0cm95KCkpOwogIH0KICBhZnRlclJ1bigpIHsKICAgIHRoaXMuZXJyb3JlZE9yRGVzdHJveWVkID0gZmFsc2U7CiAgICB0aGlzLnBpcGVsaW5lZFZhbHVlID0gdm9pZCAwOwogICAgdGhpcy5zbmFwc2hvdD8uZGlzcG9zZSgpOwogICAgdGhpcy5zbmFwc2hvdCA9IG51bGw7CiAgfQogIGRlc3Ryb3koKSB7CiAgICB0aGlzLmltcGwudW5yZWdpc3Rlcih0aGlzKTsKICAgIHRoaXMudW5yZWdpc3Rlck9uRGVzdHJveT8uKCk7CiAgICBjb25zdCBzY2hlZHVsZWQyID0gdGhpcy52aWV3Py5bQUZURVJfUkVOREVSX1NFUVVFTkNFU19UT19BRERdOwogICAgaWYgKHNjaGVkdWxlZDIpIHsKICAgICAgdGhpcy52aWV3W0FGVEVSX1JFTkRFUl9TRVFVRU5DRVNfVE9fQUREXSA9IHNjaGVkdWxlZDIuZmlsdGVyKChzKSA9PiBzICE9PSB0aGlzKTsKICAgIH0KICB9Cn07CmZ1bmN0aW9uIGFmdGVyRXZlcnlSZW5kZXIoY2FsbGJhY2tPclNwZWMsIG9wdGlvbnMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90SW5SZWFjdGl2ZUNvbnRleHQoYWZ0ZXJFdmVyeVJlbmRlciwgIkNhbGwgYGFmdGVyRXZlcnlSZW5kZXJgIG91dHNpZGUgb2YgYSByZWFjdGl2ZSBjb250ZXh0LiBGb3IgZXhhbXBsZSwgc2NoZWR1bGUgdGhlIHJlbmRlciBjYWxsYmFjayBpbnNpZGUgdGhlIGNvbXBvbmVudCBjb25zdHJ1Y3RvcmAuIik7CiAgaWYgKG5nRGV2TW9kZSAmJiAhb3B0aW9ucz8uaW5qZWN0b3IpIHsKICAgIGFzc2VydEluSW5qZWN0aW9uQ29udGV4dChhZnRlckV2ZXJ5UmVuZGVyKTsKICB9CiAgY29uc3QgaW5qZWN0b3IgPSBvcHRpb25zPy5pbmplY3RvciA/PyBpbmplY3QyKEluamVjdG9yKTsKICBpZiAoZmFsc2UpIHsKICAgIHJldHVybiBOT09QX0FGVEVSX1JFTkRFUl9SRUY7CiAgfQogIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUoIk5nQWZ0ZXJSZW5kZXIiKTsKICByZXR1cm4gYWZ0ZXJFdmVyeVJlbmRlckltcGwoY2FsbGJhY2tPclNwZWMsIGluamVjdG9yLCBvcHRpb25zLCBmYWxzZSk7Cn0KZnVuY3Rpb24gYWZ0ZXJOZXh0UmVuZGVyKGNhbGxiYWNrT3JTcGVjLCBvcHRpb25zKSB7CiAgaWYgKG5nRGV2TW9kZSAmJiAhb3B0aW9ucz8uaW5qZWN0b3IpIHsKICAgIGFzc2VydEluSW5qZWN0aW9uQ29udGV4dChhZnRlck5leHRSZW5kZXIpOwogIH0KICBjb25zdCBpbmplY3RvciA9IG9wdGlvbnM/LmluamVjdG9yID8/IGluamVjdDIoSW5qZWN0b3IpOwogIGlmIChmYWxzZSkgewogICAgcmV0dXJuIE5PT1BfQUZURVJfUkVOREVSX1JFRjsKICB9CiAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiTmdBZnRlck5leHRSZW5kZXIiKTsKICByZXR1cm4gYWZ0ZXJFdmVyeVJlbmRlckltcGwoY2FsbGJhY2tPclNwZWMsIGluamVjdG9yLCBvcHRpb25zLCB0cnVlKTsKfQpmdW5jdGlvbiBnZXRIb29rcyhjYWxsYmFja09yU3BlYykgewogIGlmIChjYWxsYmFja09yU3BlYyBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICByZXR1cm4gW3ZvaWQgMCwgdm9pZCAwLCBjYWxsYmFja09yU3BlYywgdm9pZCAwXTsKICB9IGVsc2UgewogICAgcmV0dXJuIFtjYWxsYmFja09yU3BlYy5lYXJseVJlYWQsIGNhbGxiYWNrT3JTcGVjLndyaXRlLCBjYWxsYmFja09yU3BlYy5taXhlZFJlYWRXcml0ZSwgY2FsbGJhY2tPclNwZWMucmVhZF07CiAgfQp9CmZ1bmN0aW9uIGFmdGVyRXZlcnlSZW5kZXJJbXBsKGNhbGxiYWNrT3JTcGVjLCBpbmplY3Rvciwgb3B0aW9ucywgb25jZSkgewogIGNvbnN0IG1hbmFnZXIgPSBpbmplY3Rvci5nZXQoQWZ0ZXJSZW5kZXJNYW5hZ2VyKTsKICBtYW5hZ2VyLmltcGwgPz89IGluamVjdG9yLmdldChBZnRlclJlbmRlckltcGwpOwogIGNvbnN0IHRyYWNpbmcgPSBpbmplY3Rvci5nZXQoVHJhY2luZ1NlcnZpY2UsIG51bGwsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSk7CiAgY29uc3QgZGVzdHJveVJlZiA9IG9wdGlvbnM/Lm1hbnVhbENsZWFudXAgIT09IHRydWUgPyBpbmplY3Rvci5nZXQoRGVzdHJveVJlZikgOiBudWxsOwogIGNvbnN0IHZpZXdDb250ZXh0ID0gaW5qZWN0b3IuZ2V0KFZpZXdDb250ZXh0LCBudWxsLCB7CiAgICBvcHRpb25hbDogdHJ1ZQogIH0pOwogIGNvbnN0IHNlcXVlbmNlID0gbmV3IEFmdGVyUmVuZGVyU2VxdWVuY2UobWFuYWdlci5pbXBsLCBnZXRIb29rcyhjYWxsYmFja09yU3BlYyksIHZpZXdDb250ZXh0Py52aWV3LCBvbmNlLCBkZXN0cm95UmVmLCB0cmFjaW5nPy5zbmFwc2hvdChudWxsKSk7CiAgbWFuYWdlci5pbXBsLnJlZ2lzdGVyKHNlcXVlbmNlKTsKICByZXR1cm4gc2VxdWVuY2U7Cn0KdmFyIEFOSU1BVElPTl9RVUVVRSA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiQW5pbWF0aW9uUXVldWUiIDogIiIsIHsKICBmYWN0b3J5OiAoKSA9PiB7CiAgICByZXR1cm4gewogICAgICBxdWV1ZTogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSwKICAgICAgaXNTY2hlZHVsZWQ6IGZhbHNlLAogICAgICBzY2hlZHVsZXI6IG51bGwsCiAgICAgIGluamVjdG9yOiBpbmplY3QyKEVudmlyb25tZW50SW5qZWN0b3IpCiAgICB9OwogIH0KfSk7CmZ1bmN0aW9uIGFkZFRvQW5pbWF0aW9uUXVldWUoaW5qZWN0b3IsIGFuaW1hdGlvbkZucywgYW5pbWF0aW9uRGF0YSkgewogIGNvbnN0IGFuaW1hdGlvblF1ZXVlID0gaW5qZWN0b3IuZ2V0KEFOSU1BVElPTl9RVUVVRSk7CiAgaWYgKEFycmF5LmlzQXJyYXkoYW5pbWF0aW9uRm5zKSkgewogICAgZm9yIChjb25zdCBhbmltYXRlRm4gb2YgYW5pbWF0aW9uRm5zKSB7CiAgICAgIGFuaW1hdGlvblF1ZXVlLnF1ZXVlLmFkZChhbmltYXRlRm4pOwogICAgICBhbmltYXRpb25EYXRhPy5kZXRhY2hlZExlYXZlQW5pbWF0aW9uRm5zPy5wdXNoKGFuaW1hdGVGbik7CiAgICB9CiAgfSBlbHNlIHsKICAgIGFuaW1hdGlvblF1ZXVlLnF1ZXVlLmFkZChhbmltYXRpb25GbnMpOwogICAgYW5pbWF0aW9uRGF0YT8uZGV0YWNoZWRMZWF2ZUFuaW1hdGlvbkZucz8ucHVzaChhbmltYXRpb25GbnMpOwogIH0KICBhbmltYXRpb25RdWV1ZS5zY2hlZHVsZXIgJiYgYW5pbWF0aW9uUXVldWUuc2NoZWR1bGVyKGluamVjdG9yKTsKfQpmdW5jdGlvbiByZW1vdmVGcm9tQW5pbWF0aW9uUXVldWUoaW5qZWN0b3IsIGFuaW1hdGlvbkRhdGEpIHsKICBjb25zdCBhbmltYXRpb25RdWV1ZSA9IGluamVjdG9yLmdldChBTklNQVRJT05fUVVFVUUpOwogIGlmIChhbmltYXRpb25EYXRhLmRldGFjaGVkTGVhdmVBbmltYXRpb25GbnMpIHsKICAgIGZvciAoY29uc3QgYW5pbWF0aW9uRm4gb2YgYW5pbWF0aW9uRGF0YS5kZXRhY2hlZExlYXZlQW5pbWF0aW9uRm5zKSB7CiAgICAgIGFuaW1hdGlvblF1ZXVlLnF1ZXVlLmRlbGV0ZShhbmltYXRpb25Gbik7CiAgICB9CiAgICBhbmltYXRpb25EYXRhLmRldGFjaGVkTGVhdmVBbmltYXRpb25GbnMgPSB2b2lkIDA7CiAgfQp9CmZ1bmN0aW9uIHNjaGVkdWxlQW5pbWF0aW9uUXVldWUoaW5qZWN0b3IpIHsKICBjb25zdCBhbmltYXRpb25RdWV1ZSA9IGluamVjdG9yLmdldChBTklNQVRJT05fUVVFVUUpOwogIGlmICghYW5pbWF0aW9uUXVldWUuaXNTY2hlZHVsZWQpIHsKICAgIGFmdGVyTmV4dFJlbmRlcigoKSA9PiB7CiAgICAgIGFuaW1hdGlvblF1ZXVlLmlzU2NoZWR1bGVkID0gZmFsc2U7CiAgICAgIGZvciAobGV0IGFuaW1hdGVGbiBvZiBhbmltYXRpb25RdWV1ZS5xdWV1ZSkgewogICAgICAgIGFuaW1hdGVGbigpOwogICAgICB9CiAgICAgIGFuaW1hdGlvblF1ZXVlLnF1ZXVlLmNsZWFyKCk7CiAgICB9LCB7CiAgICAgIGluamVjdG9yOiBhbmltYXRpb25RdWV1ZS5pbmplY3RvcgogICAgfSk7CiAgICBhbmltYXRpb25RdWV1ZS5pc1NjaGVkdWxlZCA9IHRydWU7CiAgfQp9CmZ1bmN0aW9uIGluaXRpYWxpemVBbmltYXRpb25RdWV1ZVNjaGVkdWxlcihpbmplY3RvcikgewogIGNvbnN0IGFuaW1hdGlvblF1ZXVlID0gaW5qZWN0b3IuZ2V0KEFOSU1BVElPTl9RVUVVRSk7CiAgYW5pbWF0aW9uUXVldWUuc2NoZWR1bGVyID0gc2NoZWR1bGVBbmltYXRpb25RdWV1ZTsKICBhbmltYXRpb25RdWV1ZS5zY2hlZHVsZXIoaW5qZWN0b3IpOwp9CmZ1bmN0aW9uIHF1ZXVlRW50ZXJBbmltYXRpb25zKGluamVjdG9yLCBlbnRlckFuaW1hdGlvbnMpIHsKICBmb3IgKGNvbnN0IFtfLCBub2RlQW5pbWF0aW9uc10gb2YgZW50ZXJBbmltYXRpb25zKSB7CiAgICBhZGRUb0FuaW1hdGlvblF1ZXVlKGluamVjdG9yLCBub2RlQW5pbWF0aW9ucy5hbmltYXRlRm5zKTsKICB9Cn0KZnVuY3Rpb24gcmVtb3ZlQW5pbWF0aW9uc0Zyb21RdWV1ZShpbmplY3RvciwgYW5pbWF0aW9uRm5zKSB7CiAgY29uc3QgYW5pbWF0aW9uUXVldWUgPSBpbmplY3Rvci5nZXQoQU5JTUFUSU9OX1FVRVVFKTsKICBpZiAoQXJyYXkuaXNBcnJheShhbmltYXRpb25GbnMpKSB7CiAgICBmb3IgKGNvbnN0IGFuaW1hdGVGbiBvZiBhbmltYXRpb25GbnMpIHsKICAgICAgYW5pbWF0aW9uUXVldWUucXVldWUuZGVsZXRlKGFuaW1hdGVGbik7CiAgICB9CiAgfSBlbHNlIHsKICAgIGFuaW1hdGlvblF1ZXVlLnF1ZXVlLmRlbGV0ZShhbmltYXRpb25GbnMpOwogIH0KfQpmdW5jdGlvbiBtYXliZVF1ZXVlRW50ZXJBbmltYXRpb24ocGFyZW50TFZpZXcsIHBhcmVudCwgdE5vZGUsIGluamVjdG9yKSB7CiAgY29uc3QgZW50ZXJBbmltYXRpb25zID0gcGFyZW50TFZpZXc/LltBTklNQVRJT05TXT8uZW50ZXI7CiAgaWYgKHBhcmVudCAhPT0gbnVsbCAmJiBlbnRlckFuaW1hdGlvbnMgJiYgZW50ZXJBbmltYXRpb25zLmhhcyh0Tm9kZS5pbmRleCkpIHsKICAgIHF1ZXVlRW50ZXJBbmltYXRpb25zKGluamVjdG9yLCBlbnRlckFuaW1hdGlvbnMpOwogIH0KfQpmdW5jdGlvbiBhcHBseVRvRWxlbWVudE9yQ29udGFpbmVyKGFjdGlvbiwgcmVuZGVyZXIsIGluamVjdG9yLCBwYXJlbnQsIGxOb2RlVG9IYW5kbGUsIHROb2RlLCBiZWZvcmVOb2RlLCBwYXJlbnRMVmlldykgewogIGlmIChsTm9kZVRvSGFuZGxlICE9IG51bGwpIHsKICAgIGxldCBsQ29udGFpbmVyOwogICAgbGV0IGlzQ29tcG9uZW50MiA9IGZhbHNlOwogICAgaWYgKGlzTENvbnRhaW5lcihsTm9kZVRvSGFuZGxlKSkgewogICAgICBsQ29udGFpbmVyID0gbE5vZGVUb0hhbmRsZTsKICAgIH0gZWxzZSBpZiAoaXNMVmlldyhsTm9kZVRvSGFuZGxlKSkgewogICAgICBpc0NvbXBvbmVudDIgPSB0cnVlOwogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChsTm9kZVRvSGFuZGxlW0hPU1RdLCAiSE9TVCBtdXN0IGJlIGRlZmluZWQgZm9yIGEgY29tcG9uZW50IExWaWV3Iik7CiAgICAgIGxOb2RlVG9IYW5kbGUgPSBsTm9kZVRvSGFuZGxlW0hPU1RdOwogICAgfQogICAgY29uc3Qgck5vZGUgPSB1bndyYXBSTm9kZShsTm9kZVRvSGFuZGxlKTsKICAgIGlmIChhY3Rpb24gPT09IDAgJiYgcGFyZW50ICE9PSBudWxsKSB7CiAgICAgIG1heWJlUXVldWVFbnRlckFuaW1hdGlvbihwYXJlbnRMVmlldywgcGFyZW50LCB0Tm9kZSwgaW5qZWN0b3IpOwogICAgICBpZiAoYmVmb3JlTm9kZSA9PSBudWxsKSB7CiAgICAgICAgbmF0aXZlQXBwZW5kQ2hpbGQocmVuZGVyZXIsIHBhcmVudCwgck5vZGUpOwogICAgICB9IGVsc2UgewogICAgICAgIG5hdGl2ZUluc2VydEJlZm9yZShyZW5kZXJlciwgcGFyZW50LCByTm9kZSwgYmVmb3JlTm9kZSB8fCBudWxsLCB0cnVlKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IDEgJiYgcGFyZW50ICE9PSBudWxsKSB7CiAgICAgIG1heWJlUXVldWVFbnRlckFuaW1hdGlvbihwYXJlbnRMVmlldywgcGFyZW50LCB0Tm9kZSwgaW5qZWN0b3IpOwogICAgICBuYXRpdmVJbnNlcnRCZWZvcmUocmVuZGVyZXIsIHBhcmVudCwgck5vZGUsIGJlZm9yZU5vZGUgfHwgbnVsbCwgdHJ1ZSk7CiAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gMikgewogICAgICBydW5MZWF2ZUFuaW1hdGlvbnNXaXRoQ2FsbGJhY2socGFyZW50TFZpZXcsIHROb2RlLCBpbmplY3RvciwgKG5vZGVIYXNMZWF2ZUFuaW1hdGlvbnMpID0+IHsKICAgICAgICBuYXRpdmVSZW1vdmVOb2RlKHJlbmRlcmVyLCByTm9kZSwgaXNDb21wb25lbnQyLCBub2RlSGFzTGVhdmVBbmltYXRpb25zKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gMykgewogICAgICBydW5MZWF2ZUFuaW1hdGlvbnNXaXRoQ2FsbGJhY2socGFyZW50TFZpZXcsIHROb2RlLCBpbmplY3RvciwgKCkgPT4gewogICAgICAgIHJlbmRlcmVyLmRlc3Ryb3lOb2RlKHJOb2RlKTsKICAgICAgfSk7CiAgICB9CiAgICBpZiAobENvbnRhaW5lciAhPSBudWxsKSB7CiAgICAgIGFwcGx5Q29udGFpbmVyKHJlbmRlcmVyLCBhY3Rpb24sIGluamVjdG9yLCBsQ29udGFpbmVyLCB0Tm9kZSwgcGFyZW50LCBiZWZvcmVOb2RlKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gcmVtb3ZlVmlld0Zyb21ET00odFZpZXcsIGxWaWV3KSB7CiAgZGV0YWNoVmlld0Zyb21ET00odFZpZXcsIGxWaWV3KTsKICBsVmlld1tIT1NUXSA9IG51bGw7CiAgbFZpZXdbVF9IT1NUXSA9IG51bGw7Cn0KZnVuY3Rpb24gYWRkVmlld1RvRE9NKHRWaWV3LCBwYXJlbnRUTm9kZSwgcmVuZGVyZXIsIGxWaWV3LCBwYXJlbnROYXRpdmVOb2RlLCBiZWZvcmVOb2RlKSB7CiAgbFZpZXdbSE9TVF0gPSBwYXJlbnROYXRpdmVOb2RlOwogIGxWaWV3W1RfSE9TVF0gPSBwYXJlbnRUTm9kZTsKICBhcHBseVZpZXcodFZpZXcsIGxWaWV3LCByZW5kZXJlciwgMSwgcGFyZW50TmF0aXZlTm9kZSwgYmVmb3JlTm9kZSk7Cn0KZnVuY3Rpb24gZGV0YWNoVmlld0Zyb21ET00odFZpZXcsIGxWaWV3KSB7CiAgbFZpZXdbRU5WSVJPTk1FTlRdLmNoYW5nZURldGVjdGlvblNjaGVkdWxlcj8ubm90aWZ5KDkpOwogIGFwcGx5Vmlldyh0VmlldywgbFZpZXcsIGxWaWV3W1JFTkRFUkVSXSwgMiwgbnVsbCwgbnVsbCk7Cn0KZnVuY3Rpb24gZGVzdHJveVZpZXdUcmVlKHJvb3RWaWV3KSB7CiAgbGV0IGxWaWV3T3JMQ29udGFpbmVyID0gcm9vdFZpZXdbQ0hJTERfSEVBRF07CiAgaWYgKCFsVmlld09yTENvbnRhaW5lcikgewogICAgcmV0dXJuIGNsZWFuVXBWaWV3KHJvb3RWaWV3W1RWSUVXXSwgcm9vdFZpZXcpOwogIH0KICB3aGlsZSAobFZpZXdPckxDb250YWluZXIpIHsKICAgIGxldCBuZXh0ID0gbnVsbDsKICAgIGlmIChpc0xWaWV3KGxWaWV3T3JMQ29udGFpbmVyKSkgewogICAgICBuZXh0ID0gbFZpZXdPckxDb250YWluZXJbQ0hJTERfSEVBRF07CiAgICB9IGVsc2UgewogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TENvbnRhaW5lcihsVmlld09yTENvbnRhaW5lcik7CiAgICAgIGNvbnN0IGZpcnN0VmlldyA9IGxWaWV3T3JMQ29udGFpbmVyW0NPTlRBSU5FUl9IRUFERVJfT0ZGU0VUXTsKICAgICAgaWYgKGZpcnN0VmlldykgbmV4dCA9IGZpcnN0VmlldzsKICAgIH0KICAgIGlmICghbmV4dCkgewogICAgICB3aGlsZSAobFZpZXdPckxDb250YWluZXIgJiYgIWxWaWV3T3JMQ29udGFpbmVyW05FWFRdICYmIGxWaWV3T3JMQ29udGFpbmVyICE9PSByb290VmlldykgewogICAgICAgIGlmIChpc0xWaWV3KGxWaWV3T3JMQ29udGFpbmVyKSkgewogICAgICAgICAgY2xlYW5VcFZpZXcobFZpZXdPckxDb250YWluZXJbVFZJRVddLCBsVmlld09yTENvbnRhaW5lcik7CiAgICAgICAgfQogICAgICAgIGxWaWV3T3JMQ29udGFpbmVyID0gbFZpZXdPckxDb250YWluZXJbUEFSRU5UXTsKICAgICAgfQogICAgICBpZiAobFZpZXdPckxDb250YWluZXIgPT09IG51bGwpIGxWaWV3T3JMQ29udGFpbmVyID0gcm9vdFZpZXc7CiAgICAgIGlmIChpc0xWaWV3KGxWaWV3T3JMQ29udGFpbmVyKSkgewogICAgICAgIGNsZWFuVXBWaWV3KGxWaWV3T3JMQ29udGFpbmVyW1RWSUVXXSwgbFZpZXdPckxDb250YWluZXIpOwogICAgICB9CiAgICAgIG5leHQgPSBsVmlld09yTENvbnRhaW5lciAmJiBsVmlld09yTENvbnRhaW5lcltORVhUXTsKICAgIH0KICAgIGxWaWV3T3JMQ29udGFpbmVyID0gbmV4dDsKICB9Cn0KZnVuY3Rpb24gZGV0YWNoTW92ZWRWaWV3KGRlY2xhcmF0aW9uQ29udGFpbmVyLCBsVmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRMQ29udGFpbmVyKGRlY2xhcmF0aW9uQ29udGFpbmVyKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChkZWNsYXJhdGlvbkNvbnRhaW5lcltNT1ZFRF9WSUVXU10sICJBIHByb2plY3RlZCB2aWV3IHNob3VsZCBiZWxvbmcgdG8gYSBub24tZW1wdHkgcHJvamVjdGVkIHZpZXdzIGNvbGxlY3Rpb24iKTsKICBjb25zdCBtb3ZlZFZpZXdzID0gZGVjbGFyYXRpb25Db250YWluZXJbTU9WRURfVklFV1NdOwogIGNvbnN0IGRlY2xhcmF0aW9uVmlld0luZGV4ID0gbW92ZWRWaWV3cy5pbmRleE9mKGxWaWV3KTsKICBtb3ZlZFZpZXdzLnNwbGljZShkZWNsYXJhdGlvblZpZXdJbmRleCwgMSk7Cn0KZnVuY3Rpb24gZGVzdHJveUxWaWV3KHRWaWV3LCBsVmlldykgewogIGlmIChpc0Rlc3Ryb3llZChsVmlldykpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgaWYgKHJlbmRlcmVyLmRlc3Ryb3lOb2RlKSB7CiAgICBhcHBseVZpZXcodFZpZXcsIGxWaWV3LCByZW5kZXJlciwgMywgbnVsbCwgbnVsbCk7CiAgfQogIGRlc3Ryb3lWaWV3VHJlZShsVmlldyk7Cn0KZnVuY3Rpb24gY2xlYW5VcFZpZXcodFZpZXcsIGxWaWV3KSB7CiAgaWYgKGlzRGVzdHJveWVkKGxWaWV3KSkgewogICAgcmV0dXJuOwogIH0KICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICB0cnkgewogICAgbFZpZXdbRkxBR1NdICY9IH4xMjg7CiAgICBsVmlld1tGTEFHU10gfD0gMjU2OwogICAgbFZpZXdbUkVBQ1RJVkVfVEVNUExBVEVfQ09OU1VNRVJdICYmIGNvbnN1bWVyRGVzdHJveShsVmlld1tSRUFDVElWRV9URU1QTEFURV9DT05TVU1FUl0pOwogICAgZXhlY3V0ZU9uRGVzdHJveXModFZpZXcsIGxWaWV3KTsKICAgIHByb2Nlc3NDbGVhbnVwcyh0VmlldywgbFZpZXcpOwogICAgaWYgKGxWaWV3W1RWSUVXXS50eXBlID09PSAxKSB7CiAgICAgIGxWaWV3W1JFTkRFUkVSXS5kZXN0cm95KCk7CiAgICB9CiAgICBjb25zdCBkZWNsYXJhdGlvbkNvbnRhaW5lciA9IGxWaWV3W0RFQ0xBUkFUSU9OX0xDT05UQUlORVJdOwogICAgaWYgKGRlY2xhcmF0aW9uQ29udGFpbmVyICE9PSBudWxsICYmIGlzTENvbnRhaW5lcihsVmlld1tQQVJFTlRdKSkgewogICAgICBpZiAoZGVjbGFyYXRpb25Db250YWluZXIgIT09IGxWaWV3W1BBUkVOVF0pIHsKICAgICAgICBkZXRhY2hNb3ZlZFZpZXcoZGVjbGFyYXRpb25Db250YWluZXIsIGxWaWV3KTsKICAgICAgfQogICAgICBjb25zdCBsUXVlcmllcyA9IGxWaWV3W1FVRVJJRVNdOwogICAgICBpZiAobFF1ZXJpZXMgIT09IG51bGwpIHsKICAgICAgICBsUXVlcmllcy5kZXRhY2hWaWV3KHRWaWV3KTsKICAgICAgfQogICAgfQogICAgdW5yZWdpc3RlckxWaWV3KGxWaWV3KTsKICB9IGZpbmFsbHkgewogICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICB9Cn0KZnVuY3Rpb24gcnVuTGVhdmVBbmltYXRpb25zV2l0aENhbGxiYWNrKGxWaWV3LCB0Tm9kZSwgaW5qZWN0b3IsIGNhbGxiYWNrKSB7CiAgY29uc3QgYW5pbWF0aW9ucyA9IGxWaWV3Py5bQU5JTUFUSU9OU107CiAgaWYgKGFuaW1hdGlvbnM/LmVudGVyPy5oYXModE5vZGUuaW5kZXgpKSB7CiAgICByZW1vdmVBbmltYXRpb25zRnJvbVF1ZXVlKGluamVjdG9yLCBhbmltYXRpb25zLmVudGVyLmdldCh0Tm9kZS5pbmRleCkuYW5pbWF0ZUZucyk7CiAgfQogIGlmIChhbmltYXRpb25zID09IG51bGwgfHwgYW5pbWF0aW9ucy5sZWF2ZSA9PSB2b2lkIDAgfHwgIWFuaW1hdGlvbnMubGVhdmUuaGFzKHROb2RlLmluZGV4KSkgcmV0dXJuIGNhbGxiYWNrKGZhbHNlKTsKICBpZiAobFZpZXcpIGFsbExlYXZpbmdBbmltYXRpb25zLmFkZChsVmlld1tJRF0pOwogIGFkZFRvQW5pbWF0aW9uUXVldWUoaW5qZWN0b3IsICgpID0+IHsKICAgIGlmIChhbmltYXRpb25zLmxlYXZlICYmIGFuaW1hdGlvbnMubGVhdmUuaGFzKHROb2RlLmluZGV4KSkgewogICAgICBjb25zdCBsZWF2ZUFuaW1hdGlvbk1hcCA9IGFuaW1hdGlvbnMubGVhdmU7CiAgICAgIGNvbnN0IGxlYXZlQW5pbWF0aW9ucyA9IGxlYXZlQW5pbWF0aW9uTWFwLmdldCh0Tm9kZS5pbmRleCk7CiAgICAgIGNvbnN0IHJ1bm5pbmdBbmltYXRpb25zID0gW107CiAgICAgIGlmIChsZWF2ZUFuaW1hdGlvbnMpIHsKICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbGVhdmVBbmltYXRpb25zLmFuaW1hdGVGbnMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICBjb25zdCBhbmltYXRpb25GbiA9IGxlYXZlQW5pbWF0aW9ucy5hbmltYXRlRm5zW2luZGV4XTsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgcHJvbWlzZQogICAgICAgICAgfSA9IGFuaW1hdGlvbkZuKCk7CiAgICAgICAgICBydW5uaW5nQW5pbWF0aW9ucy5wdXNoKHByb21pc2UpOwogICAgICAgIH0KICAgICAgICBhbmltYXRpb25zLmRldGFjaGVkTGVhdmVBbmltYXRpb25GbnMgPSB2b2lkIDA7CiAgICAgIH0KICAgICAgYW5pbWF0aW9ucy5ydW5uaW5nID0gUHJvbWlzZS5hbGxTZXR0bGVkKHJ1bm5pbmdBbmltYXRpb25zKTsKICAgICAgcnVuQWZ0ZXJMZWF2ZUFuaW1hdGlvbnMobFZpZXcsIGNhbGxiYWNrKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChsVmlldykgYWxsTGVhdmluZ0FuaW1hdGlvbnMuZGVsZXRlKGxWaWV3W0lEXSk7CiAgICAgIGNhbGxiYWNrKGZhbHNlKTsKICAgIH0KICB9LCBhbmltYXRpb25zKTsKfQpmdW5jdGlvbiBydW5BZnRlckxlYXZlQW5pbWF0aW9ucyhsVmlldywgY2FsbGJhY2spIHsKICBjb25zdCBydW5uaW5nQW5pbWF0aW9ucyA9IGxWaWV3W0FOSU1BVElPTlNdPy5ydW5uaW5nOwogIGlmIChydW5uaW5nQW5pbWF0aW9ucykgewogICAgcnVubmluZ0FuaW1hdGlvbnMudGhlbigoKSA9PiB7CiAgICAgIGxWaWV3W0FOSU1BVElPTlNdLnJ1bm5pbmcgPSB2b2lkIDA7CiAgICAgIGFsbExlYXZpbmdBbmltYXRpb25zLmRlbGV0ZShsVmlld1tJRF0pOwogICAgICBjYWxsYmFjayh0cnVlKTsKICAgIH0pOwogICAgcmV0dXJuOwogIH0KICBjYWxsYmFjayhmYWxzZSk7Cn0KZnVuY3Rpb24gcHJvY2Vzc0NsZWFudXBzKHRWaWV3LCBsVmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3RSZWFjdGl2ZShwcm9jZXNzQ2xlYW51cHMubmFtZSk7CiAgY29uc3QgdENsZWFudXAgPSB0Vmlldy5jbGVhbnVwOwogIGNvbnN0IGxDbGVhbnVwID0gbFZpZXdbQ0xFQU5VUF07CiAgaWYgKHRDbGVhbnVwICE9PSBudWxsKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRDbGVhbnVwLmxlbmd0aCAtIDE7IGkgKz0gMikgewogICAgICBpZiAodHlwZW9mIHRDbGVhbnVwW2ldID09PSAic3RyaW5nIikgewogICAgICAgIGNvbnN0IHRhcmdldElkeCA9IHRDbGVhbnVwW2kgKyAzXTsKICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVyKHRhcmdldElkeCwgImNsZWFudXAgdGFyZ2V0IG11c3QgYmUgYSBudW1iZXIiKTsKICAgICAgICBpZiAodGFyZ2V0SWR4ID49IDApIHsKICAgICAgICAgIGxDbGVhbnVwW3RhcmdldElkeF0oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbENsZWFudXBbLXRhcmdldElkeF0udW5zdWJzY3JpYmUoKTsKICAgICAgICB9CiAgICAgICAgaSArPSAyOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGNvbnRleHQyID0gbENsZWFudXBbdENsZWFudXBbaSArIDFdXTsKICAgICAgICB0Q2xlYW51cFtpXS5jYWxsKGNvbnRleHQyKTsKICAgICAgfQogICAgfQogIH0KICBpZiAobENsZWFudXAgIT09IG51bGwpIHsKICAgIGxWaWV3W0NMRUFOVVBdID0gbnVsbDsKICB9CiAgY29uc3QgZGVzdHJveUhvb2tzID0gbFZpZXdbT05fREVTVFJPWV9IT09LU107CiAgaWYgKGRlc3Ryb3lIb29rcyAhPT0gbnVsbCkgewogICAgbFZpZXdbT05fREVTVFJPWV9IT09LU10gPSBudWxsOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkZXN0cm95SG9va3MubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgZGVzdHJveUhvb2tzRm4gPSBkZXN0cm95SG9va3NbaV07CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRGdW5jdGlvbihkZXN0cm95SG9va3NGbiwgIkV4cGVjdGluZyBkZXN0cm95IGhvb2sgdG8gYmUgYSBmdW5jdGlvbi4iKTsKICAgICAgZGVzdHJveUhvb2tzRm4oKTsKICAgIH0KICB9CiAgY29uc3QgZWZmZWN0cyA9IGxWaWV3W0VGRkVDVFNdOwogIGlmIChlZmZlY3RzICE9PSBudWxsKSB7CiAgICBsVmlld1tFRkZFQ1RTXSA9IG51bGw7CiAgICBmb3IgKGNvbnN0IGVmZmVjdDIgb2YgZWZmZWN0cykgewogICAgICBlZmZlY3QyLmRlc3Ryb3koKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gZXhlY3V0ZU9uRGVzdHJveXModFZpZXcsIGxWaWV3KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdFJlYWN0aXZlKGV4ZWN1dGVPbkRlc3Ryb3lzLm5hbWUpOwogIGxldCBkZXN0cm95SG9va3M7CiAgaWYgKHRWaWV3ICE9IG51bGwgJiYgKGRlc3Ryb3lIb29rcyA9IHRWaWV3LmRlc3Ryb3lIb29rcykgIT0gbnVsbCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkZXN0cm95SG9va3MubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgY29uc3QgY29udGV4dDIgPSBsVmlld1tkZXN0cm95SG9va3NbaV1dOwogICAgICBpZiAoIShjb250ZXh0MiBpbnN0YW5jZW9mIE5vZGVJbmplY3RvckZhY3RvcnkpKSB7CiAgICAgICAgY29uc3QgdG9DYWxsID0gZGVzdHJveUhvb2tzW2kgKyAxXTsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0b0NhbGwpKSB7CiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRvQ2FsbC5sZW5ndGg7IGogKz0gMikgewogICAgICAgICAgICBjb25zdCBjYWxsQ29udGV4dCA9IGNvbnRleHQyW3RvQ2FsbFtqXV07CiAgICAgICAgICAgIGNvbnN0IGhvb2sgPSB0b0NhbGxbaiArIDFdOwogICAgICAgICAgICBwcm9maWxlcihQcm9maWxlckV2ZW50LkxpZmVjeWNsZUhvb2tTdGFydCwgY2FsbENvbnRleHQsIGhvb2spOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGhvb2suY2FsbChjYWxsQ29udGV4dCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5MaWZlY3ljbGVIb29rRW5kLCBjYWxsQ29udGV4dCwgaG9vayk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5MaWZlY3ljbGVIb29rU3RhcnQsIGNvbnRleHQyLCB0b0NhbGwpOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdG9DYWxsLmNhbGwoY29udGV4dDIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5MaWZlY3ljbGVIb29rRW5kLCBjb250ZXh0MiwgdG9DYWxsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gZ2V0UGFyZW50UkVsZW1lbnQodFZpZXcsIHROb2RlLCBsVmlldykgewogIHJldHVybiBnZXRDbG9zZXN0UkVsZW1lbnQodFZpZXcsIHROb2RlLnBhcmVudCwgbFZpZXcpOwp9CmZ1bmN0aW9uIGdldENsb3Nlc3RSRWxlbWVudCh0VmlldywgdE5vZGUsIGxWaWV3KSB7CiAgbGV0IHBhcmVudFROb2RlID0gdE5vZGU7CiAgd2hpbGUgKHBhcmVudFROb2RlICE9PSBudWxsICYmIHBhcmVudFROb2RlLnR5cGUgJiAoOCB8IDMyIHwgMTI4KSkgewogICAgdE5vZGUgPSBwYXJlbnRUTm9kZTsKICAgIHBhcmVudFROb2RlID0gdE5vZGUucGFyZW50OwogIH0KICBpZiAocGFyZW50VE5vZGUgPT09IG51bGwpIHsKICAgIHJldHVybiBsVmlld1tIT1NUXTsKICB9IGVsc2UgewogICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZShwYXJlbnRUTm9kZSwgMyB8IDQpOwogICAgaWYgKGlzQ29tcG9uZW50SG9zdChwYXJlbnRUTm9kZSkpIHsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlRm9yTFZpZXcocGFyZW50VE5vZGUsIGxWaWV3KTsKICAgICAgY29uc3QgewogICAgICAgIGVuY2Fwc3VsYXRpb24KICAgICAgfSA9IHRWaWV3LmRhdGFbcGFyZW50VE5vZGUuZGlyZWN0aXZlU3RhcnQgKyBwYXJlbnRUTm9kZS5jb21wb25lbnRPZmZzZXRdOwogICAgICBpZiAoZW5jYXBzdWxhdGlvbiA9PT0gVmlld0VuY2Fwc3VsYXRpb24uTm9uZSB8fCBlbmNhcHN1bGF0aW9uID09PSBWaWV3RW5jYXBzdWxhdGlvbi5FbXVsYXRlZCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZ2V0TmF0aXZlQnlUTm9kZShwYXJlbnRUTm9kZSwgbFZpZXcpOwogIH0KfQpmdW5jdGlvbiBnZXRJbnNlcnRJbkZyb250T2ZSTm9kZShwYXJlbnRUTm9kZSwgY3VycmVudFROb2RlLCBsVmlldykgewogIHJldHVybiBfZ2V0SW5zZXJ0SW5Gcm9udE9mUk5vZGVXaXRoSTE4bihwYXJlbnRUTm9kZSwgY3VycmVudFROb2RlLCBsVmlldyk7Cn0KZnVuY3Rpb24gZ2V0SW5zZXJ0SW5Gcm9udE9mUk5vZGVXaXRoTm9JMThuKHBhcmVudFROb2RlLCBjdXJyZW50VE5vZGUsIGxWaWV3KSB7CiAgaWYgKHBhcmVudFROb2RlLnR5cGUgJiAoOCB8IDMyKSkgewogICAgcmV0dXJuIGdldE5hdGl2ZUJ5VE5vZGUocGFyZW50VE5vZGUsIGxWaWV3KTsKICB9CiAgcmV0dXJuIG51bGw7Cn0KdmFyIF9nZXRJbnNlcnRJbkZyb250T2ZSTm9kZVdpdGhJMThuID0gZ2V0SW5zZXJ0SW5Gcm9udE9mUk5vZGVXaXRoTm9JMThuOwp2YXIgX3Byb2Nlc3NJMThuSW5zZXJ0QmVmb3JlOwpmdW5jdGlvbiBzZXRJMThuSGFuZGxpbmcoZ2V0SW5zZXJ0SW5Gcm9udE9mUk5vZGVXaXRoSTE4bjIsIHByb2Nlc3NJMThuSW5zZXJ0QmVmb3JlMikgewogIF9nZXRJbnNlcnRJbkZyb250T2ZSTm9kZVdpdGhJMThuID0gZ2V0SW5zZXJ0SW5Gcm9udE9mUk5vZGVXaXRoSTE4bjI7CiAgX3Byb2Nlc3NJMThuSW5zZXJ0QmVmb3JlID0gcHJvY2Vzc0kxOG5JbnNlcnRCZWZvcmUyOwp9CmZ1bmN0aW9uIGFwcGVuZENoaWxkKHRWaWV3LCBsVmlldywgY2hpbGRSTm9kZSwgY2hpbGRUTm9kZSkgewogIGNvbnN0IHBhcmVudFJOb2RlID0gZ2V0UGFyZW50UkVsZW1lbnQodFZpZXcsIGNoaWxkVE5vZGUsIGxWaWV3KTsKICBjb25zdCByZW5kZXJlciA9IGxWaWV3W1JFTkRFUkVSXTsKICBjb25zdCBwYXJlbnRUTm9kZSA9IGNoaWxkVE5vZGUucGFyZW50IHx8IGxWaWV3W1RfSE9TVF07CiAgY29uc3QgYW5jaG9yTm9kZSA9IGdldEluc2VydEluRnJvbnRPZlJOb2RlKHBhcmVudFROb2RlLCBjaGlsZFROb2RlLCBsVmlldyk7CiAgaWYgKHBhcmVudFJOb2RlICE9IG51bGwpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGNoaWxkUk5vZGUpKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRSTm9kZS5sZW5ndGg7IGkrKykgewogICAgICAgIG5hdGl2ZUFwcGVuZE9ySW5zZXJ0QmVmb3JlKHJlbmRlcmVyLCBwYXJlbnRSTm9kZSwgY2hpbGRSTm9kZVtpXSwgYW5jaG9yTm9kZSwgZmFsc2UpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBuYXRpdmVBcHBlbmRPckluc2VydEJlZm9yZShyZW5kZXJlciwgcGFyZW50Uk5vZGUsIGNoaWxkUk5vZGUsIGFuY2hvck5vZGUsIGZhbHNlKTsKICAgIH0KICB9CiAgX3Byb2Nlc3NJMThuSW5zZXJ0QmVmb3JlICE9PSB2b2lkIDAgJiYgX3Byb2Nlc3NJMThuSW5zZXJ0QmVmb3JlKHJlbmRlcmVyLCBjaGlsZFROb2RlLCBsVmlldywgY2hpbGRSTm9kZSwgcGFyZW50Uk5vZGUpOwp9CmZ1bmN0aW9uIGdldEZpcnN0TmF0aXZlTm9kZShsVmlldywgdE5vZGUpIHsKICBpZiAodE5vZGUgIT09IG51bGwpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUodE5vZGUsIDMgfCAxMiB8IDMyIHwgMTYgfCAxMjgpOwogICAgY29uc3QgdE5vZGVUeXBlID0gdE5vZGUudHlwZTsKICAgIGlmICh0Tm9kZVR5cGUgJiAzKSB7CiAgICAgIHJldHVybiBnZXROYXRpdmVCeVROb2RlKHROb2RlLCBsVmlldyk7CiAgICB9IGVsc2UgaWYgKHROb2RlVHlwZSAmIDQpIHsKICAgICAgcmV0dXJuIGdldEJlZm9yZU5vZGVGb3JWaWV3KC0xLCBsVmlld1t0Tm9kZS5pbmRleF0pOwogICAgfSBlbHNlIGlmICh0Tm9kZVR5cGUgJiA4KSB7CiAgICAgIGNvbnN0IGVsSWN1Q29udGFpbmVyQ2hpbGQgPSB0Tm9kZS5jaGlsZDsKICAgICAgaWYgKGVsSWN1Q29udGFpbmVyQ2hpbGQgIT09IG51bGwpIHsKICAgICAgICByZXR1cm4gZ2V0Rmlyc3ROYXRpdmVOb2RlKGxWaWV3LCBlbEljdUNvbnRhaW5lckNoaWxkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCByTm9kZU9yTENvbnRhaW5lciA9IGxWaWV3W3ROb2RlLmluZGV4XTsKICAgICAgICBpZiAoaXNMQ29udGFpbmVyKHJOb2RlT3JMQ29udGFpbmVyKSkgewogICAgICAgICAgcmV0dXJuIGdldEJlZm9yZU5vZGVGb3JWaWV3KC0xLCByTm9kZU9yTENvbnRhaW5lcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB1bndyYXBSTm9kZShyTm9kZU9yTENvbnRhaW5lcik7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHROb2RlVHlwZSAmIDEyOCkgewogICAgICByZXR1cm4gZ2V0Rmlyc3ROYXRpdmVOb2RlKGxWaWV3LCB0Tm9kZS5uZXh0KTsKICAgIH0gZWxzZSBpZiAodE5vZGVUeXBlICYgMzIpIHsKICAgICAgbGV0IG5leHRSTm9kZSA9IGljdUNvbnRhaW5lckl0ZXJhdGUodE5vZGUsIGxWaWV3KTsKICAgICAgbGV0IHJOb2RlID0gbmV4dFJOb2RlKCk7CiAgICAgIHJldHVybiByTm9kZSB8fCB1bndyYXBSTm9kZShsVmlld1t0Tm9kZS5pbmRleF0pOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgcHJvamVjdGlvbk5vZGVzID0gZ2V0UHJvamVjdGlvbk5vZGVzKGxWaWV3LCB0Tm9kZSk7CiAgICAgIGlmIChwcm9qZWN0aW9uTm9kZXMgIT09IG51bGwpIHsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9qZWN0aW9uTm9kZXMpKSB7CiAgICAgICAgICByZXR1cm4gcHJvamVjdGlvbk5vZGVzWzBdOwogICAgICAgIH0KICAgICAgICBjb25zdCBwYXJlbnRWaWV3ID0gZ2V0TFZpZXdQYXJlbnQobFZpZXdbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddKTsKICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0UGFyZW50VmlldyhwYXJlbnRWaWV3KTsKICAgICAgICByZXR1cm4gZ2V0Rmlyc3ROYXRpdmVOb2RlKHBhcmVudFZpZXcsIHByb2plY3Rpb25Ob2Rlcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGdldEZpcnN0TmF0aXZlTm9kZShsVmlldywgdE5vZGUubmV4dCk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIG51bGw7Cn0KZnVuY3Rpb24gZ2V0UHJvamVjdGlvbk5vZGVzKGxWaWV3LCB0Tm9kZSkgewogIGlmICh0Tm9kZSAhPT0gbnVsbCkgewogICAgY29uc3QgY29tcG9uZW50VmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICAgIGNvbnN0IGNvbXBvbmVudEhvc3QgPSBjb21wb25lbnRWaWV3W1RfSE9TVF07CiAgICBjb25zdCBzbG90SWR4ID0gdE5vZGUucHJvamVjdGlvbjsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRQcm9qZWN0aW9uU2xvdHMobFZpZXcpOwogICAgcmV0dXJuIGNvbXBvbmVudEhvc3QucHJvamVjdGlvbltzbG90SWR4XTsKICB9CiAgcmV0dXJuIG51bGw7Cn0KZnVuY3Rpb24gZ2V0QmVmb3JlTm9kZUZvclZpZXcodmlld0luZGV4SW5Db250YWluZXIsIGxDb250YWluZXIpIHsKICBjb25zdCBuZXh0Vmlld0luZGV4ID0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQgKyB2aWV3SW5kZXhJbkNvbnRhaW5lciArIDE7CiAgaWYgKG5leHRWaWV3SW5kZXggPCBsQ29udGFpbmVyLmxlbmd0aCkgewogICAgY29uc3QgbFZpZXcgPSBsQ29udGFpbmVyW25leHRWaWV3SW5kZXhdOwogICAgY29uc3QgZmlyc3RUTm9kZU9mVmlldyA9IGxWaWV3W1RWSUVXXS5maXJzdENoaWxkOwogICAgaWYgKGZpcnN0VE5vZGVPZlZpZXcgIT09IG51bGwpIHsKICAgICAgcmV0dXJuIGdldEZpcnN0TmF0aXZlTm9kZShsVmlldywgZmlyc3RUTm9kZU9mVmlldyk7CiAgICB9CiAgfQogIHJldHVybiBsQ29udGFpbmVyW05BVElWRV07Cn0KZnVuY3Rpb24gYXBwbHlOb2RlcyhyZW5kZXJlciwgYWN0aW9uLCB0Tm9kZSwgbFZpZXcsIHBhcmVudFJFbGVtZW50LCBiZWZvcmVOb2RlLCBpc1Byb2plY3Rpb24pIHsKICB3aGlsZSAodE5vZGUgIT0gbnVsbCkgewogICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlRm9yTFZpZXcodE5vZGUsIGxWaWV3KTsKICAgIGNvbnN0IGluamVjdG9yID0gbFZpZXdbSU5KRUNUT1JdOwogICAgaWYgKHROb2RlLnR5cGUgPT09IDEyOCkgewogICAgICB0Tm9kZSA9IHROb2RlLm5leHQ7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZSh0Tm9kZSwgMyB8IDEyIHwgMTYgfCAzMik7CiAgICBjb25zdCByYXdTbG90VmFsdWUgPSBsVmlld1t0Tm9kZS5pbmRleF07CiAgICBjb25zdCB0Tm9kZVR5cGUgPSB0Tm9kZS50eXBlOwogICAgaWYgKGlzUHJvamVjdGlvbikgewogICAgICBpZiAoYWN0aW9uID09PSAwKSB7CiAgICAgICAgcmF3U2xvdFZhbHVlICYmIGF0dGFjaFBhdGNoRGF0YSh1bndyYXBSTm9kZShyYXdTbG90VmFsdWUpLCBsVmlldyk7CiAgICAgICAgdE5vZGUuZmxhZ3MgfD0gMjsKICAgICAgfQogICAgfQogICAgaWYgKCFpc0RldGFjaGVkQnlJMThuKHROb2RlKSkgewogICAgICBpZiAodE5vZGVUeXBlICYgOCkgewogICAgICAgIGFwcGx5Tm9kZXMocmVuZGVyZXIsIGFjdGlvbiwgdE5vZGUuY2hpbGQsIGxWaWV3LCBwYXJlbnRSRWxlbWVudCwgYmVmb3JlTm9kZSwgZmFsc2UpOwogICAgICAgIGFwcGx5VG9FbGVtZW50T3JDb250YWluZXIoYWN0aW9uLCByZW5kZXJlciwgaW5qZWN0b3IsIHBhcmVudFJFbGVtZW50LCByYXdTbG90VmFsdWUsIHROb2RlLCBiZWZvcmVOb2RlLCBsVmlldyk7CiAgICAgIH0gZWxzZSBpZiAodE5vZGVUeXBlICYgMzIpIHsKICAgICAgICBjb25zdCBuZXh0Uk5vZGUgPSBpY3VDb250YWluZXJJdGVyYXRlKHROb2RlLCBsVmlldyk7CiAgICAgICAgbGV0IHJOb2RlOwogICAgICAgIHdoaWxlIChyTm9kZSA9IG5leHRSTm9kZSgpKSB7CiAgICAgICAgICBhcHBseVRvRWxlbWVudE9yQ29udGFpbmVyKGFjdGlvbiwgcmVuZGVyZXIsIGluamVjdG9yLCBwYXJlbnRSRWxlbWVudCwgck5vZGUsIHROb2RlLCBiZWZvcmVOb2RlLCBsVmlldyk7CiAgICAgICAgfQogICAgICAgIGFwcGx5VG9FbGVtZW50T3JDb250YWluZXIoYWN0aW9uLCByZW5kZXJlciwgaW5qZWN0b3IsIHBhcmVudFJFbGVtZW50LCByYXdTbG90VmFsdWUsIHROb2RlLCBiZWZvcmVOb2RlLCBsVmlldyk7CiAgICAgIH0gZWxzZSBpZiAodE5vZGVUeXBlICYgMTYpIHsKICAgICAgICBhcHBseVByb2plY3Rpb25SZWN1cnNpdmUocmVuZGVyZXIsIGFjdGlvbiwgbFZpZXcsIHROb2RlLCBwYXJlbnRSRWxlbWVudCwgYmVmb3JlTm9kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZSh0Tm9kZSwgMyB8IDQpOwogICAgICAgIGFwcGx5VG9FbGVtZW50T3JDb250YWluZXIoYWN0aW9uLCByZW5kZXJlciwgaW5qZWN0b3IsIHBhcmVudFJFbGVtZW50LCByYXdTbG90VmFsdWUsIHROb2RlLCBiZWZvcmVOb2RlLCBsVmlldyk7CiAgICAgIH0KICAgIH0KICAgIHROb2RlID0gaXNQcm9qZWN0aW9uID8gdE5vZGUucHJvamVjdGlvbk5leHQgOiB0Tm9kZS5uZXh0OwogIH0KfQpmdW5jdGlvbiBhcHBseVZpZXcodFZpZXcsIGxWaWV3LCByZW5kZXJlciwgYWN0aW9uLCBwYXJlbnRSRWxlbWVudCwgYmVmb3JlTm9kZSkgewogIGFwcGx5Tm9kZXMocmVuZGVyZXIsIGFjdGlvbiwgdFZpZXcuZmlyc3RDaGlsZCwgbFZpZXcsIHBhcmVudFJFbGVtZW50LCBiZWZvcmVOb2RlLCBmYWxzZSk7Cn0KZnVuY3Rpb24gYXBwbHlQcm9qZWN0aW9uKHRWaWV3LCBsVmlldywgdFByb2plY3Rpb25Ob2RlKSB7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgY29uc3QgcGFyZW50Uk5vZGUgPSBnZXRQYXJlbnRSRWxlbWVudCh0VmlldywgdFByb2plY3Rpb25Ob2RlLCBsVmlldyk7CiAgY29uc3QgcGFyZW50VE5vZGUgPSB0UHJvamVjdGlvbk5vZGUucGFyZW50IHx8IGxWaWV3W1RfSE9TVF07CiAgbGV0IGJlZm9yZU5vZGUgPSBnZXRJbnNlcnRJbkZyb250T2ZSTm9kZShwYXJlbnRUTm9kZSwgdFByb2plY3Rpb25Ob2RlLCBsVmlldyk7CiAgYXBwbHlQcm9qZWN0aW9uUmVjdXJzaXZlKHJlbmRlcmVyLCAwLCBsVmlldywgdFByb2plY3Rpb25Ob2RlLCBwYXJlbnRSTm9kZSwgYmVmb3JlTm9kZSk7Cn0KZnVuY3Rpb24gYXBwbHlQcm9qZWN0aW9uUmVjdXJzaXZlKHJlbmRlcmVyLCBhY3Rpb24sIGxWaWV3LCB0UHJvamVjdGlvbk5vZGUsIHBhcmVudFJFbGVtZW50LCBiZWZvcmVOb2RlKSB7CiAgY29uc3QgY29tcG9uZW50TFZpZXcgPSBsVmlld1tERUNMQVJBVElPTl9DT01QT05FTlRfVklFV107CiAgY29uc3QgY29tcG9uZW50Tm9kZSA9IGNvbXBvbmVudExWaWV3W1RfSE9TVF07CiAgbmdEZXZNb2RlICYmIGFzc2VydEVxdWFsKHR5cGVvZiB0UHJvamVjdGlvbk5vZGUucHJvamVjdGlvbiwgIm51bWJlciIsICJleHBlY3RpbmcgcHJvamVjdGlvbiBpbmRleCIpOwogIGNvbnN0IG5vZGVUb1Byb2plY3RPclJOb2RlcyA9IGNvbXBvbmVudE5vZGUucHJvamVjdGlvblt0UHJvamVjdGlvbk5vZGUucHJvamVjdGlvbl07CiAgaWYgKEFycmF5LmlzQXJyYXkobm9kZVRvUHJvamVjdE9yUk5vZGVzKSkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlVG9Qcm9qZWN0T3JSTm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3Qgck5vZGUgPSBub2RlVG9Qcm9qZWN0T3JSTm9kZXNbaV07CiAgICAgIGFwcGx5VG9FbGVtZW50T3JDb250YWluZXIoYWN0aW9uLCByZW5kZXJlciwgbFZpZXdbSU5KRUNUT1JdLCBwYXJlbnRSRWxlbWVudCwgck5vZGUsIHRQcm9qZWN0aW9uTm9kZSwgYmVmb3JlTm9kZSwgbFZpZXcpOwogICAgfQogIH0gZWxzZSB7CiAgICBsZXQgbm9kZVRvUHJvamVjdCA9IG5vZGVUb1Byb2plY3RPclJOb2RlczsKICAgIGNvbnN0IHByb2plY3RlZENvbXBvbmVudExWaWV3ID0gY29tcG9uZW50TFZpZXdbUEFSRU5UXTsKICAgIGlmIChoYXNJblNraXBIeWRyYXRpb25CbG9ja0ZsYWcodFByb2plY3Rpb25Ob2RlKSkgewogICAgICBub2RlVG9Qcm9qZWN0LmZsYWdzIHw9IDEyODsKICAgIH0KICAgIGFwcGx5Tm9kZXMocmVuZGVyZXIsIGFjdGlvbiwgbm9kZVRvUHJvamVjdCwgcHJvamVjdGVkQ29tcG9uZW50TFZpZXcsIHBhcmVudFJFbGVtZW50LCBiZWZvcmVOb2RlLCB0cnVlKTsKICB9Cn0KZnVuY3Rpb24gYXBwbHlDb250YWluZXIocmVuZGVyZXIsIGFjdGlvbiwgaW5qZWN0b3IsIGxDb250YWluZXIsIHROb2RlLCBwYXJlbnRSRWxlbWVudCwgYmVmb3JlTm9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRMQ29udGFpbmVyKGxDb250YWluZXIpOwogIGNvbnN0IGFuY2hvciA9IGxDb250YWluZXJbTkFUSVZFXTsKICBjb25zdCBuYXRpdmUgPSB1bndyYXBSTm9kZShsQ29udGFpbmVyKTsKICBpZiAoYW5jaG9yICE9PSBuYXRpdmUpIHsKICAgIGFwcGx5VG9FbGVtZW50T3JDb250YWluZXIoYWN0aW9uLCByZW5kZXJlciwgaW5qZWN0b3IsIHBhcmVudFJFbGVtZW50LCBhbmNob3IsIHROb2RlLCBiZWZvcmVOb2RlKTsKICB9CiAgZm9yIChsZXQgaSA9IENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUOyBpIDwgbENvbnRhaW5lci5sZW5ndGg7IGkrKykgewogICAgY29uc3QgbFZpZXcgPSBsQ29udGFpbmVyW2ldOwogICAgYXBwbHlWaWV3KGxWaWV3W1RWSUVXXSwgbFZpZXcsIHJlbmRlcmVyLCBhY3Rpb24sIHBhcmVudFJFbGVtZW50LCBhbmNob3IpOwogIH0KfQpmdW5jdGlvbiBhcHBseVN0eWxpbmcocmVuZGVyZXIsIGlzQ2xhc3NCYXNlZCwgck5vZGUsIHByb3AsIHZhbHVlKSB7CiAgaWYgKGlzQ2xhc3NCYXNlZCkgewogICAgaWYgKCF2YWx1ZSkgewogICAgICByZW5kZXJlci5yZW1vdmVDbGFzcyhyTm9kZSwgcHJvcCk7CiAgICB9IGVsc2UgewogICAgICByZW5kZXJlci5hZGRDbGFzcyhyTm9kZSwgcHJvcCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGxldCBmbGFncyA9IHByb3AuaW5kZXhPZigiLSIpID09PSAtMSA/IHZvaWQgMCA6IFJlbmRlcmVyU3R5bGVGbGFnczIuRGFzaENhc2U7CiAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICByZW5kZXJlci5yZW1vdmVTdHlsZShyTm9kZSwgcHJvcCwgZmxhZ3MpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgaXNJbXBvcnRhbnQgPSB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciID8gdmFsdWUuZW5kc1dpdGgoIiFpbXBvcnRhbnQiKSA6IGZhbHNlOwogICAgICBpZiAoaXNJbXBvcnRhbnQpIHsKICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDAsIC0xMCk7CiAgICAgICAgZmxhZ3MgfD0gUmVuZGVyZXJTdHlsZUZsYWdzMi5JbXBvcnRhbnQ7CiAgICAgIH0KICAgICAgcmVuZGVyZXIuc2V0U3R5bGUock5vZGUsIHByb3AsIHZhbHVlLCBmbGFncyk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGV4ZWN1dGVUZW1wbGF0ZSh0VmlldywgbFZpZXcsIHRlbXBsYXRlRm4sIHJmLCBjb250ZXh0MikgewogIGNvbnN0IHByZXZTZWxlY3RlZEluZGV4ID0gZ2V0U2VsZWN0ZWRJbmRleCgpOwogIGNvbnN0IGlzVXBkYXRlUGhhc2UgPSByZiAmIDI7CiAgdHJ5IHsKICAgIHNldFNlbGVjdGVkSW5kZXgoLTEpOwogICAgaWYgKGlzVXBkYXRlUGhhc2UgJiYgbFZpZXcubGVuZ3RoID4gSEVBREVSX09GRlNFVCkgewogICAgICBzZWxlY3RJbmRleEludGVybmFsKHRWaWV3LCBsVmlldywgSEVBREVSX09GRlNFVCwgISFuZ0Rldk1vZGUgJiYgaXNJbkNoZWNrTm9DaGFuZ2VzTW9kZSgpKTsKICAgIH0KICAgIGNvbnN0IHByZUhvb2tUeXBlID0gaXNVcGRhdGVQaGFzZSA/IFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVVcGRhdGVTdGFydCA6IFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVDcmVhdGVTdGFydDsKICAgIHByb2ZpbGVyKHByZUhvb2tUeXBlLCBjb250ZXh0MiwgdGVtcGxhdGVGbik7CiAgICB0ZW1wbGF0ZUZuKHJmLCBjb250ZXh0Mik7CiAgfSBmaW5hbGx5IHsKICAgIHNldFNlbGVjdGVkSW5kZXgocHJldlNlbGVjdGVkSW5kZXgpOwogICAgY29uc3QgcG9zdEhvb2tUeXBlID0gaXNVcGRhdGVQaGFzZSA/IFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVVcGRhdGVFbmQgOiBQcm9maWxlckV2ZW50LlRlbXBsYXRlQ3JlYXRlRW5kOwogICAgcHJvZmlsZXIocG9zdEhvb2tUeXBlLCBjb250ZXh0MiwgdGVtcGxhdGVGbik7CiAgfQp9CmZ1bmN0aW9uIGNyZWF0ZURpcmVjdGl2ZXNJbnN0YW5jZXModFZpZXcsIGxWaWV3LCB0Tm9kZSkgewogIGluc3RhbnRpYXRlQWxsRGlyZWN0aXZlcyh0VmlldywgbFZpZXcsIHROb2RlKTsKICBpZiAoKHROb2RlLmZsYWdzICYgNjQpID09PSA2NCkgewogICAgaW52b2tlRGlyZWN0aXZlc0hvc3RCaW5kaW5ncyh0VmlldywgbFZpZXcsIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gc2F2ZVJlc29sdmVkTG9jYWxzSW5EYXRhKHZpZXdEYXRhLCB0Tm9kZSwgbG9jYWxSZWZFeHRyYWN0b3IgPSBnZXROYXRpdmVCeVROb2RlKSB7CiAgY29uc3QgbG9jYWxOYW1lcyA9IHROb2RlLmxvY2FsTmFtZXM7CiAgaWYgKGxvY2FsTmFtZXMgIT09IG51bGwpIHsKICAgIGxldCBsb2NhbEluZGV4ID0gdE5vZGUuaW5kZXggKyAxOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbE5hbWVzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIGNvbnN0IGluZGV4ID0gbG9jYWxOYW1lc1tpICsgMV07CiAgICAgIGNvbnN0IHZhbHVlID0gaW5kZXggPT09IC0xID8gbG9jYWxSZWZFeHRyYWN0b3IodE5vZGUsIHZpZXdEYXRhKSA6IHZpZXdEYXRhW2luZGV4XTsKICAgICAgdmlld0RhdGFbbG9jYWxJbmRleCsrXSA9IHZhbHVlOwogICAgfQogIH0KfQpmdW5jdGlvbiBsb2NhdGVIb3N0RWxlbWVudChyZW5kZXJlciwgZWxlbWVudE9yU2VsZWN0b3IsIGVuY2Fwc3VsYXRpb24sIGluamVjdG9yKSB7CiAgY29uc3QgcHJlc2VydmVIb3N0Q29udGVudCA9IGluamVjdG9yLmdldChQUkVTRVJWRV9IT1NUX0NPTlRFTlQsIFBSRVNFUlZFX0hPU1RfQ09OVEVOVF9ERUZBVUxUKTsKICBjb25zdCBwcmVzZXJ2ZUNvbnRlbnQgPSBwcmVzZXJ2ZUhvc3RDb250ZW50IHx8IGVuY2Fwc3VsYXRpb24gPT09IFZpZXdFbmNhcHN1bGF0aW9uLlNoYWRvd0RvbSB8fCBlbmNhcHN1bGF0aW9uID09PSBWaWV3RW5jYXBzdWxhdGlvbi5FeHBlcmltZW50YWxJc29sYXRlZFNoYWRvd0RvbTsKICBjb25zdCByb290RWxlbWVudCA9IHJlbmRlcmVyLnNlbGVjdFJvb3RFbGVtZW50KGVsZW1lbnRPclNlbGVjdG9yLCBwcmVzZXJ2ZUNvbnRlbnQpOwogIGFwcGx5Um9vdEVsZW1lbnRUcmFuc2Zvcm0ocm9vdEVsZW1lbnQpOwogIHJldHVybiByb290RWxlbWVudDsKfQpmdW5jdGlvbiBhcHBseVJvb3RFbGVtZW50VHJhbnNmb3JtKHJvb3RFbGVtZW50KSB7CiAgX2FwcGx5Um9vdEVsZW1lbnRUcmFuc2Zvcm1JbXBsKHJvb3RFbGVtZW50KTsKfQp2YXIgX2FwcGx5Um9vdEVsZW1lbnRUcmFuc2Zvcm1JbXBsID0gKCkgPT4gbnVsbDsKZnVuY3Rpb24gYXBwbHlSb290RWxlbWVudFRyYW5zZm9ybUltcGwocm9vdEVsZW1lbnQpIHsKICBpZiAoaGFzU2tpcEh5ZHJhdGlvbkF0dHJPblJFbGVtZW50KHJvb3RFbGVtZW50KSkgewogICAgY2xlYXJFbGVtZW50Q29udGVudHMocm9vdEVsZW1lbnQpOwogIH0gZWxzZSB7CiAgICBwcm9jZXNzVGV4dE5vZGVNYXJrZXJzQmVmb3JlSHlkcmF0aW9uKHJvb3RFbGVtZW50KTsKICB9Cn0KZnVuY3Rpb24gZW5hYmxlQXBwbHlSb290RWxlbWVudFRyYW5zZm9ybUltcGwoKSB7CiAgX2FwcGx5Um9vdEVsZW1lbnRUcmFuc2Zvcm1JbXBsID0gYXBwbHlSb290RWxlbWVudFRyYW5zZm9ybUltcGw7Cn0KZnVuY3Rpb24gbWFwUHJvcE5hbWUobmFtZSkgewogIGlmIChuYW1lID09PSAiY2xhc3MiKSByZXR1cm4gImNsYXNzTmFtZSI7CiAgaWYgKG5hbWUgPT09ICJmb3IiKSByZXR1cm4gImh0bWxGb3IiOwogIGlmIChuYW1lID09PSAiZm9ybWFjdGlvbiIpIHJldHVybiAiZm9ybUFjdGlvbiI7CiAgaWYgKG5hbWUgPT09ICJpbm5lckh0bWwiKSByZXR1cm4gImlubmVySFRNTCI7CiAgaWYgKG5hbWUgPT09ICJyZWFkb25seSIpIHJldHVybiAicmVhZE9ubHkiOwogIGlmIChuYW1lID09PSAidGFiaW5kZXgiKSByZXR1cm4gInRhYkluZGV4IjsKICByZXR1cm4gbmFtZTsKfQpmdW5jdGlvbiBzZXRQcm9wZXJ0eUFuZElucHV0cyh0Tm9kZSwgbFZpZXcsIHByb3BOYW1lLCB2YWx1ZSwgcmVuZGVyZXIsIHNhbml0aXplcikgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3RTYW1lKHZhbHVlLCBOT19DSEFOR0UsICJJbmNvbWluZyB2YWx1ZSBzaG91bGQgbmV2ZXIgYmUgTk9fQ0hBTkdFLiIpOwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IGhhc1NldElucHV0ID0gc2V0QWxsSW5wdXRzRm9yUHJvcGVydHkodE5vZGUsIHRWaWV3LCBsVmlldywgcHJvcE5hbWUsIHZhbHVlKTsKICBpZiAoaGFzU2V0SW5wdXQpIHsKICAgIGlzQ29tcG9uZW50SG9zdCh0Tm9kZSkgJiYgbWFya0RpcnR5SWZPblB1c2gobFZpZXcsIHROb2RlLmluZGV4KTsKICAgIG5nRGV2TW9kZSAmJiBzZXROZ1JlZmxlY3RQcm9wZXJ0aWVzKGxWaWV3LCB0VmlldywgdE5vZGUsIHByb3BOYW1lLCB2YWx1ZSk7CiAgICByZXR1cm47CiAgfQogIGlmICh0Tm9kZS50eXBlICYgMykgewogICAgcHJvcE5hbWUgPSBtYXBQcm9wTmFtZShwcm9wTmFtZSk7CiAgfQogIHNldERvbVByb3BlcnR5KHROb2RlLCBsVmlldywgcHJvcE5hbWUsIHZhbHVlLCByZW5kZXJlciwgc2FuaXRpemVyKTsKfQpmdW5jdGlvbiBzZXREb21Qcm9wZXJ0eSh0Tm9kZSwgbFZpZXcsIHByb3BOYW1lLCB2YWx1ZSwgcmVuZGVyZXIsIHNhbml0aXplcikgewogIGlmICh0Tm9kZS50eXBlICYgMykgewogICAgY29uc3QgZWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgdmFsaWRhdGVBZ2FpbnN0RXZlbnRQcm9wZXJ0aWVzKHByb3BOYW1lKTsKICAgICAgaWYgKCFpc1Byb3BlcnR5VmFsaWQoZWxlbWVudCwgcHJvcE5hbWUsIHROb2RlLnZhbHVlLCBsVmlld1tUVklFV10uc2NoZW1hcykpIHsKICAgICAgICBoYW5kbGVVbmtub3duUHJvcGVydHlFcnJvcihwcm9wTmFtZSwgdE5vZGUudmFsdWUsIHROb2RlLnR5cGUsIGxWaWV3KTsKICAgICAgfQogICAgfQogICAgdmFsdWUgPSBzYW5pdGl6ZXIgIT0gbnVsbCA/IHNhbml0aXplcih2YWx1ZSwgdE5vZGUudmFsdWUgfHwgIiIsIHByb3BOYW1lKSA6IHZhbHVlOwogICAgcmVuZGVyZXIuc2V0UHJvcGVydHkoZWxlbWVudCwgcHJvcE5hbWUsIHZhbHVlKTsKICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiAxMikgewogICAgaWYgKG5nRGV2TW9kZSAmJiAhbWF0Y2hpbmdTY2hlbWFzKGxWaWV3W1RWSUVXXS5zY2hlbWFzLCB0Tm9kZS52YWx1ZSkpIHsKICAgICAgaGFuZGxlVW5rbm93blByb3BlcnR5RXJyb3IocHJvcE5hbWUsIHROb2RlLnZhbHVlLCB0Tm9kZS50eXBlLCBsVmlldyk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIG1hcmtEaXJ0eUlmT25QdXNoKGxWaWV3LCB2aWV3SW5kZXgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TFZpZXcobFZpZXcpOwogIGNvbnN0IGNoaWxkQ29tcG9uZW50TFZpZXcgPSBnZXRDb21wb25lbnRMVmlld0J5SW5kZXgodmlld0luZGV4LCBsVmlldyk7CiAgaWYgKCEoY2hpbGRDb21wb25lbnRMVmlld1tGTEFHU10gJiAxNikpIHsKICAgIGNoaWxkQ29tcG9uZW50TFZpZXdbRkxBR1NdIHw9IDY0OwogIH0KfQpmdW5jdGlvbiBzZXROZ1JlZmxlY3RQcm9wZXJ0eShsVmlldywgdE5vZGUsIGF0dHJOYW1lLCB2YWx1ZSkgewogIGNvbnN0IGVudmlyb25tZW50ID0gbFZpZXdbRU5WSVJPTk1FTlRdOwogIGlmICghZW52aXJvbm1lbnQubmdSZWZsZWN0KSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IGVsZW1lbnQgPSBnZXROYXRpdmVCeVROb2RlKHROb2RlLCBsVmlldyk7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgYXR0ck5hbWUgPSBub3JtYWxpemVEZWJ1Z0JpbmRpbmdOYW1lKGF0dHJOYW1lKTsKICBjb25zdCBkZWJ1Z1ZhbHVlID0gbm9ybWFsaXplRGVidWdCaW5kaW5nVmFsdWUodmFsdWUpOwogIGlmICh0Tm9kZS50eXBlICYgMykgewogICAgaWYgKHZhbHVlID09IG51bGwpIHsKICAgICAgcmVuZGVyZXIucmVtb3ZlQXR0cmlidXRlKGVsZW1lbnQsIGF0dHJOYW1lKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlbmRlcmVyLnNldEF0dHJpYnV0ZShlbGVtZW50LCBhdHRyTmFtZSwgZGVidWdWYWx1ZSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGNvbnN0IHRleHRDb250ZW50ID0gZXNjYXBlQ29tbWVudFRleHQoYGJpbmRpbmdzPSR7SlNPTi5zdHJpbmdpZnkoewogICAgICBbYXR0ck5hbWVdOiBkZWJ1Z1ZhbHVlCiAgICB9LCBudWxsLCAyKX1gKTsKICAgIHJlbmRlcmVyLnNldFZhbHVlKGVsZW1lbnQsIHRleHRDb250ZW50KTsKICB9Cn0KZnVuY3Rpb24gc2V0TmdSZWZsZWN0UHJvcGVydGllcyhsVmlldywgdFZpZXcsIHROb2RlLCBwdWJsaWNOYW1lLCB2YWx1ZSkgewogIGNvbnN0IGVudmlyb25tZW50ID0gbFZpZXdbRU5WSVJPTk1FTlRdOwogIGlmICghZW52aXJvbm1lbnQubmdSZWZsZWN0IHx8ICEodE5vZGUudHlwZSAmICgzIHwgNCkpKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IGlucHV0Q29uZmlnID0gdE5vZGUuaW5wdXRzPy5bcHVibGljTmFtZV07CiAgY29uc3QgaG9zdElucHV0Q29uZmlnID0gdE5vZGUuaG9zdERpcmVjdGl2ZUlucHV0cz8uW3B1YmxpY05hbWVdOwogIGlmIChob3N0SW5wdXRDb25maWcpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9zdElucHV0Q29uZmlnLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIGNvbnN0IGluZGV4ID0gaG9zdElucHV0Q29uZmlnW2ldOwogICAgICBjb25zdCBwdWJsaWNOYW1lMiA9IGhvc3RJbnB1dENvbmZpZ1tpICsgMV07CiAgICAgIGNvbnN0IGRlZiA9IHRWaWV3LmRhdGFbaW5kZXhdOwogICAgICBzZXROZ1JlZmxlY3RQcm9wZXJ0eShsVmlldywgdE5vZGUsIGRlZi5pbnB1dHNbcHVibGljTmFtZTJdWzBdLCB2YWx1ZSk7CiAgICB9CiAgfQogIGlmIChpbnB1dENvbmZpZykgewogICAgZm9yIChjb25zdCBpbmRleCBvZiBpbnB1dENvbmZpZykgewogICAgICBjb25zdCBkZWYgPSB0Vmlldy5kYXRhW2luZGV4XTsKICAgICAgc2V0TmdSZWZsZWN0UHJvcGVydHkobFZpZXcsIHROb2RlLCBkZWYuaW5wdXRzW3B1YmxpY05hbWVdWzBdLCB2YWx1ZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGluc3RhbnRpYXRlQWxsRGlyZWN0aXZlcyh0VmlldywgbFZpZXcsIHROb2RlKSB7CiAgY29uc3Qgc3RhcnQgPSB0Tm9kZS5kaXJlY3RpdmVTdGFydDsKICBjb25zdCBlbmQgPSB0Tm9kZS5kaXJlY3RpdmVFbmQ7CiAgaWYgKGlzQ29tcG9uZW50SG9zdCh0Tm9kZSkpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUodE5vZGUsIDMpOwogICAgY3JlYXRlQ29tcG9uZW50TFZpZXcobFZpZXcsIHROb2RlLCB0Vmlldy5kYXRhW3N0YXJ0ICsgdE5vZGUuY29tcG9uZW50T2Zmc2V0XSk7CiAgfQogIGlmICghdFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICBnZXRPckNyZWF0ZU5vZGVJbmplY3RvckZvck5vZGUodE5vZGUsIGxWaWV3KTsKICB9CiAgY29uc3QgaW5pdGlhbElucHV0cyA9IHROb2RlLmluaXRpYWxJbnB1dHM7CiAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHsKICAgIGNvbnN0IGRlZiA9IHRWaWV3LmRhdGFbaV07CiAgICBjb25zdCBkaXJlY3RpdmUgPSBnZXROb2RlSW5qZWN0YWJsZShsVmlldywgdFZpZXcsIGksIHROb2RlKTsKICAgIGF0dGFjaFBhdGNoRGF0YShkaXJlY3RpdmUsIGxWaWV3KTsKICAgIGlmIChpbml0aWFsSW5wdXRzICE9PSBudWxsKSB7CiAgICAgIHNldElucHV0c0Zyb21BdHRycyhsVmlldywgaSAtIHN0YXJ0LCBkaXJlY3RpdmUsIGRlZiwgdE5vZGUsIGluaXRpYWxJbnB1dHMpOwogICAgfQogICAgaWYgKGlzQ29tcG9uZW50RGVmKGRlZikpIHsKICAgICAgY29uc3QgY29tcG9uZW50VmlldyA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleCh0Tm9kZS5pbmRleCwgbFZpZXcpOwogICAgICBjb21wb25lbnRWaWV3W0NPTlRFWFRdID0gZ2V0Tm9kZUluamVjdGFibGUobFZpZXcsIHRWaWV3LCBpLCB0Tm9kZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGludm9rZURpcmVjdGl2ZXNIb3N0QmluZGluZ3ModFZpZXcsIGxWaWV3LCB0Tm9kZSkgewogIGNvbnN0IHN0YXJ0ID0gdE5vZGUuZGlyZWN0aXZlU3RhcnQ7CiAgY29uc3QgZW5kID0gdE5vZGUuZGlyZWN0aXZlRW5kOwogIGNvbnN0IGVsZW1lbnRJbmRleCA9IHROb2RlLmluZGV4OwogIGNvbnN0IGN1cnJlbnREaXJlY3RpdmVJbmRleCA9IGdldEN1cnJlbnREaXJlY3RpdmVJbmRleCgpOwogIHRyeSB7CiAgICBzZXRTZWxlY3RlZEluZGV4KGVsZW1lbnRJbmRleCk7CiAgICBmb3IgKGxldCBkaXJJbmRleCA9IHN0YXJ0OyBkaXJJbmRleCA8IGVuZDsgZGlySW5kZXgrKykgewogICAgICBjb25zdCBkZWYgPSB0Vmlldy5kYXRhW2RpckluZGV4XTsKICAgICAgY29uc3QgZGlyZWN0aXZlID0gbFZpZXdbZGlySW5kZXhdOwogICAgICBzZXRDdXJyZW50RGlyZWN0aXZlSW5kZXgoZGlySW5kZXgpOwogICAgICBpZiAoZGVmLmhvc3RCaW5kaW5ncyAhPT0gbnVsbCB8fCBkZWYuaG9zdFZhcnMgIT09IDAgfHwgZGVmLmhvc3RBdHRycyAhPT0gbnVsbCkgewogICAgICAgIGludm9rZUhvc3RCaW5kaW5nc0luQ3JlYXRpb25Nb2RlKGRlZiwgZGlyZWN0aXZlKTsKICAgICAgfQogICAgfQogIH0gZmluYWxseSB7CiAgICBzZXRTZWxlY3RlZEluZGV4KC0xKTsKICAgIHNldEN1cnJlbnREaXJlY3RpdmVJbmRleChjdXJyZW50RGlyZWN0aXZlSW5kZXgpOwogIH0KfQpmdW5jdGlvbiBpbnZva2VIb3N0QmluZGluZ3NJbkNyZWF0aW9uTW9kZShkZWYsIGRpcmVjdGl2ZSkgewogIGlmIChkZWYuaG9zdEJpbmRpbmdzICE9PSBudWxsKSB7CiAgICBkZWYuaG9zdEJpbmRpbmdzKDEsIGRpcmVjdGl2ZSk7CiAgfQp9CmZ1bmN0aW9uIGZpbmREaXJlY3RpdmVEZWZNYXRjaGVzKHRWaWV3LCB0Tm9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUodE5vZGUsIDMgfCAxMik7CiAgY29uc3QgcmVnaXN0cnkgPSB0Vmlldy5kaXJlY3RpdmVSZWdpc3RyeTsKICBsZXQgbWF0Y2hlcyA9IG51bGw7CiAgaWYgKHJlZ2lzdHJ5KSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlZ2lzdHJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGRlZiA9IHJlZ2lzdHJ5W2ldOwogICAgICBpZiAoaXNOb2RlTWF0Y2hpbmdTZWxlY3Rvckxpc3QodE5vZGUsIGRlZi5zZWxlY3RvcnMsIGZhbHNlKSkgewogICAgICAgIG1hdGNoZXMgPz89IFtdOwogICAgICAgIGlmIChpc0NvbXBvbmVudERlZihkZWYpKSB7CiAgICAgICAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgICAgICAgIGFzc2VydFROb2RlVHlwZSh0Tm9kZSwgMiwgYCIke3ROb2RlLnZhbHVlfSIgdGFncyBjYW5ub3QgYmUgdXNlZCBhcyBjb21wb25lbnQgaG9zdHMuIFBsZWFzZSB1c2UgYSBkaWZmZXJlbnQgdGFnIHRvIGFjdGl2YXRlIHRoZSAke3N0cmluZ2lmeShkZWYudHlwZSl9IGNvbXBvbmVudC5gKTsKICAgICAgICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoICYmIGlzQ29tcG9uZW50RGVmKG1hdGNoZXNbMF0pKSB7CiAgICAgICAgICAgICAgdGhyb3dNdWx0aXBsZUNvbXBvbmVudEVycm9yKHROb2RlLCBtYXRjaGVzLmZpbmQoaXNDb21wb25lbnREZWYpLnR5cGUsIGRlZi50eXBlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgbWF0Y2hlcy51bnNoaWZ0KGRlZik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1hdGNoZXMucHVzaChkZWYpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICByZXR1cm4gbWF0Y2hlczsKfQpmdW5jdGlvbiBlbGVtZW50QXR0cmlidXRlSW50ZXJuYWwodE5vZGUsIGxWaWV3LCBuYW1lLCB2YWx1ZSwgc2FuaXRpemVyLCBuYW1lc3BhY2UpIHsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBhc3NlcnROb3RTYW1lKHZhbHVlLCBOT19DSEFOR0UsICJJbmNvbWluZyB2YWx1ZSBzaG91bGQgbmV2ZXIgYmUgTk9fQ0hBTkdFLiIpOwogICAgdmFsaWRhdGVBZ2FpbnN0RXZlbnRBdHRyaWJ1dGVzKG5hbWUpOwogICAgYXNzZXJ0VE5vZGVUeXBlKHROb2RlLCAyLCBgQXR0ZW1wdGVkIHRvIHNldCBhdHRyaWJ1dGUgXGAke25hbWV9XGAgb24gYSBjb250YWluZXIgbm9kZS4gSG9zdCBiaW5kaW5ncyBhcmUgbm90IHZhbGlkIG9uIG5nLWNvbnRhaW5lciBvciBuZy10ZW1wbGF0ZS5gKTsKICB9CiAgY29uc3QgZWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBzZXRFbGVtZW50QXR0cmlidXRlKGxWaWV3W1JFTkRFUkVSXSwgZWxlbWVudCwgbmFtZXNwYWNlLCB0Tm9kZS52YWx1ZSwgbmFtZSwgdmFsdWUsIHNhbml0aXplcik7Cn0KZnVuY3Rpb24gc2V0RWxlbWVudEF0dHJpYnV0ZShyZW5kZXJlciwgZWxlbWVudCwgbmFtZXNwYWNlLCB0YWdOYW1lLCBuYW1lLCB2YWx1ZSwgc2FuaXRpemVyKSB7CiAgaWYgKHZhbHVlID09IG51bGwpIHsKICAgIHJlbmRlcmVyLnJlbW92ZUF0dHJpYnV0ZShlbGVtZW50LCBuYW1lLCBuYW1lc3BhY2UpOwogIH0gZWxzZSB7CiAgICBjb25zdCBzdHJWYWx1ZSA9IHNhbml0aXplciA9PSBudWxsID8gcmVuZGVyU3RyaW5naWZ5KHZhbHVlKSA6IHNhbml0aXplcih2YWx1ZSwgdGFnTmFtZSB8fCAiIiwgbmFtZSk7CiAgICByZW5kZXJlci5zZXRBdHRyaWJ1dGUoZWxlbWVudCwgbmFtZSwgc3RyVmFsdWUsIG5hbWVzcGFjZSk7CiAgfQp9CmZ1bmN0aW9uIHNldElucHV0c0Zyb21BdHRycyhsVmlldywgZGlyZWN0aXZlSW5kZXgsIGluc3RhbmNlLCBkZWYsIHROb2RlLCBpbml0aWFsSW5wdXREYXRhKSB7CiAgY29uc3QgaW5pdGlhbElucHV0cyA9IGluaXRpYWxJbnB1dERhdGFbZGlyZWN0aXZlSW5kZXhdOwogIGlmIChpbml0aWFsSW5wdXRzICE9PSBudWxsKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluaXRpYWxJbnB1dHMubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgY29uc3QgbG9va3VwTmFtZSA9IGluaXRpYWxJbnB1dHNbaV07CiAgICAgIGNvbnN0IHZhbHVlID0gaW5pdGlhbElucHV0c1tpICsgMV07CiAgICAgIHdyaXRlVG9EaXJlY3RpdmVJbnB1dChkZWYsIGluc3RhbmNlLCBsb29rdXBOYW1lLCB2YWx1ZSk7CiAgICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgICBzZXROZ1JlZmxlY3RQcm9wZXJ0eShsVmlldywgdE5vZGUsIGRlZi5pbnB1dHNbbG9va3VwTmFtZV1bMF0sIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0KfQpmdW5jdGlvbiBlbGVtZW50TGlrZVN0YXJ0U2hhcmVkKHROb2RlLCBsVmlldywgaW5kZXgsIG5hbWUsIGxvY2F0ZU9yQ3JlYXRlTmF0aXZlTm9kZSkgewogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBIRUFERVJfT0ZGU0VUICsgaW5kZXg7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgbmF0aXZlID0gbG9jYXRlT3JDcmVhdGVOYXRpdmVOb2RlKHRWaWV3LCBsVmlldywgdE5vZGUsIG5hbWUsIGluZGV4KTsKICBsVmlld1thZGp1c3RlZEluZGV4XSA9IG5hdGl2ZTsKICBzZXRDdXJyZW50VE5vZGUodE5vZGUsIHRydWUpOwogIGNvbnN0IGlzRWxlbWVudCA9IHROb2RlLnR5cGUgPT09IDI7CiAgaWYgKGlzRWxlbWVudCkgewogICAgc2V0dXBTdGF0aWNBdHRyaWJ1dGVzKGxWaWV3W1JFTkRFUkVSXSwgbmF0aXZlLCB0Tm9kZSk7CiAgICBpZiAoZ2V0RWxlbWVudERlcHRoQ291bnQoKSA9PT0gMCB8fCBpc0RpcmVjdGl2ZUhvc3QodE5vZGUpKSB7CiAgICAgIGF0dGFjaFBhdGNoRGF0YShuYXRpdmUsIGxWaWV3KTsKICAgIH0KICAgIGluY3JlYXNlRWxlbWVudERlcHRoQ291bnQoKTsKICB9IGVsc2UgewogICAgYXR0YWNoUGF0Y2hEYXRhKG5hdGl2ZSwgbFZpZXcpOwogIH0KICBpZiAod2FzTGFzdE5vZGVDcmVhdGVkKCkgJiYgKCFpc0VsZW1lbnQgfHwgIWlzRGV0YWNoZWRCeUkxOG4odE5vZGUpKSkgewogICAgYXBwZW5kQ2hpbGQodFZpZXcsIGxWaWV3LCBuYXRpdmUsIHROb2RlKTsKICB9CiAgcmV0dXJuIHROb2RlOwp9CmZ1bmN0aW9uIGVsZW1lbnRMaWtlRW5kU2hhcmVkKHROb2RlKSB7CiAgbGV0IGN1cnJlbnRUTm9kZSA9IHROb2RlOwogIGlmIChpc0N1cnJlbnRUTm9kZVBhcmVudCgpKSB7CiAgICBzZXRDdXJyZW50VE5vZGVBc05vdFBhcmVudCgpOwogIH0gZWxzZSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SGFzUGFyZW50KGdldEN1cnJlbnRUTm9kZSgpKTsKICAgIGN1cnJlbnRUTm9kZSA9IGN1cnJlbnRUTm9kZS5wYXJlbnQ7CiAgICBzZXRDdXJyZW50VE5vZGUoY3VycmVudFROb2RlLCBmYWxzZSk7CiAgfQogIHJldHVybiBjdXJyZW50VE5vZGU7Cn0KZnVuY3Rpb24gc3RvcmVQcm9wZXJ0eUJpbmRpbmdNZXRhZGF0YSh0RGF0YSwgdE5vZGUsIHByb3BlcnR5TmFtZSwgYmluZGluZ0luZGV4LCAuLi5pbnRlcnBvbGF0aW9uUGFydHMpIHsKICBpZiAodERhdGFbYmluZGluZ0luZGV4XSA9PT0gbnVsbCkgewogICAgaWYgKCF0Tm9kZS5pbnB1dHM/Lltwcm9wZXJ0eU5hbWVdICYmICF0Tm9kZS5ob3N0RGlyZWN0aXZlSW5wdXRzPy5bcHJvcGVydHlOYW1lXSkgewogICAgICBjb25zdCBwcm9wQmluZGluZ0lkeHMgPSB0Tm9kZS5wcm9wZXJ0eUJpbmRpbmdzIHx8ICh0Tm9kZS5wcm9wZXJ0eUJpbmRpbmdzID0gW10pOwogICAgICBwcm9wQmluZGluZ0lkeHMucHVzaChiaW5kaW5nSW5kZXgpOwogICAgICBsZXQgYmluZGluZ01ldGFkYXRhID0gcHJvcGVydHlOYW1lOwogICAgICBpZiAoaW50ZXJwb2xhdGlvblBhcnRzLmxlbmd0aCA+IDApIHsKICAgICAgICBiaW5kaW5nTWV0YWRhdGEgKz0gSU5URVJQT0xBVElPTl9ERUxJTUlURVIgKyBpbnRlcnBvbGF0aW9uUGFydHMuam9pbihJTlRFUlBPTEFUSU9OX0RFTElNSVRFUik7CiAgICAgIH0KICAgICAgdERhdGFbYmluZGluZ0luZGV4XSA9IGJpbmRpbmdNZXRhZGF0YTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gbG9hZENvbXBvbmVudFJlbmRlcmVyKGN1cnJlbnREZWYsIHROb2RlLCBsVmlldykgewogIGlmIChjdXJyZW50RGVmID09PSBudWxsIHx8IGlzQ29tcG9uZW50RGVmKGN1cnJlbnREZWYpKSB7CiAgICBsVmlldyA9IHVud3JhcExWaWV3KGxWaWV3W3ROb2RlLmluZGV4XSk7CiAgfQogIHJldHVybiBsVmlld1tSRU5ERVJFUl07Cn0KZnVuY3Rpb24gaGFuZGxlVW5jYXVnaHRFcnJvcihsVmlldywgZXJyb3IpIHsKICBjb25zdCBpbmplY3RvciA9IGxWaWV3W0lOSkVDVE9SXTsKICBpZiAoIWluamVjdG9yKSB7CiAgICByZXR1cm47CiAgfQogIGxldCBlcnJvckhhbmRsZXI7CiAgdHJ5IHsKICAgIGVycm9ySGFuZGxlciA9IGluamVjdG9yLmdldChJTlRFUk5BTF9BUFBMSUNBVElPTl9FUlJPUl9IQU5ETEVSLCBudWxsKTsKICB9IGNhdGNoIHsKICAgIGVycm9ySGFuZGxlciA9IG51bGw7CiAgfQogIGVycm9ySGFuZGxlcj8uKGVycm9yKTsKfQpmdW5jdGlvbiBzZXRBbGxJbnB1dHNGb3JQcm9wZXJ0eSh0Tm9kZSwgdFZpZXcsIGxWaWV3LCBwdWJsaWNOYW1lLCB2YWx1ZSkgewogIGNvbnN0IGlucHV0cyA9IHROb2RlLmlucHV0cz8uW3B1YmxpY05hbWVdOwogIGNvbnN0IGhvc3REaXJlY3RpdmVJbnB1dHMgPSB0Tm9kZS5ob3N0RGlyZWN0aXZlSW5wdXRzPy5bcHVibGljTmFtZV07CiAgbGV0IGhhc01hdGNoID0gZmFsc2U7CiAgaWYgKGhvc3REaXJlY3RpdmVJbnB1dHMpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9zdERpcmVjdGl2ZUlucHV0cy5sZW5ndGg7IGkgKz0gMikgewogICAgICBjb25zdCBpbmRleCA9IGhvc3REaXJlY3RpdmVJbnB1dHNbaV07CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXcsIGluZGV4KTsKICAgICAgY29uc3QgcHVibGljTmFtZTIgPSBob3N0RGlyZWN0aXZlSW5wdXRzW2kgKyAxXTsKICAgICAgY29uc3QgZGVmID0gdFZpZXcuZGF0YVtpbmRleF07CiAgICAgIHdyaXRlVG9EaXJlY3RpdmVJbnB1dChkZWYsIGxWaWV3W2luZGV4XSwgcHVibGljTmFtZTIsIHZhbHVlKTsKICAgICAgaGFzTWF0Y2ggPSB0cnVlOwogICAgfQogIH0KICBpZiAoaW5wdXRzKSB7CiAgICBmb3IgKGNvbnN0IGluZGV4IG9mIGlucHV0cykgewogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJblJhbmdlKGxWaWV3LCBpbmRleCk7CiAgICAgIGNvbnN0IGluc3RhbmNlID0gbFZpZXdbaW5kZXhdOwogICAgICBjb25zdCBkZWYgPSB0Vmlldy5kYXRhW2luZGV4XTsKICAgICAgd3JpdGVUb0RpcmVjdGl2ZUlucHV0KGRlZiwgaW5zdGFuY2UsIHB1YmxpY05hbWUsIHZhbHVlKTsKICAgICAgaGFzTWF0Y2ggPSB0cnVlOwogICAgfQogIH0KICByZXR1cm4gaGFzTWF0Y2g7Cn0KZnVuY3Rpb24gc2V0RGlyZWN0aXZlSW5wdXQodE5vZGUsIHRWaWV3LCBsVmlldywgdGFyZ2V0LCBwdWJsaWNOYW1lLCB2YWx1ZSkgewogIGxldCBob3N0SW5kZXggPSBudWxsOwogIGxldCBob3N0RGlyZWN0aXZlc1N0YXJ0ID0gbnVsbDsKICBsZXQgaG9zdERpcmVjdGl2ZXNFbmQgPSBudWxsOwogIGxldCBoYXNTZXQgPSBmYWxzZTsKICBpZiAobmdEZXZNb2RlICYmICF0Tm9kZS5kaXJlY3RpdmVUb0luZGV4Py5oYXModGFyZ2V0LnR5cGUpKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoYE5vZGUgZG9lcyBub3QgaGF2ZSBhIGRpcmVjdGl2ZSB3aXRoIHR5cGUgJHt0YXJnZXQudHlwZS5uYW1lfWApOwogIH0KICBjb25zdCBkYXRhID0gdE5vZGUuZGlyZWN0aXZlVG9JbmRleC5nZXQodGFyZ2V0LnR5cGUpOwogIGlmICh0eXBlb2YgZGF0YSA9PT0gIm51bWJlciIpIHsKICAgIGhvc3RJbmRleCA9IGRhdGE7CiAgfSBlbHNlIHsKICAgIFtob3N0SW5kZXgsIGhvc3REaXJlY3RpdmVzU3RhcnQsIGhvc3REaXJlY3RpdmVzRW5kXSA9IGRhdGE7CiAgfQogIGlmIChob3N0RGlyZWN0aXZlc1N0YXJ0ICE9PSBudWxsICYmIGhvc3REaXJlY3RpdmVzRW5kICE9PSBudWxsICYmIHROb2RlLmhvc3REaXJlY3RpdmVJbnB1dHM/Lmhhc093blByb3BlcnR5KHB1YmxpY05hbWUpKSB7CiAgICBjb25zdCBob3N0RGlyZWN0aXZlSW5wdXRzID0gdE5vZGUuaG9zdERpcmVjdGl2ZUlucHV0c1twdWJsaWNOYW1lXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9zdERpcmVjdGl2ZUlucHV0cy5sZW5ndGg7IGkgKz0gMikgewogICAgICBjb25zdCBpbmRleCA9IGhvc3REaXJlY3RpdmVJbnB1dHNbaV07CiAgICAgIGlmIChpbmRleCA+PSBob3N0RGlyZWN0aXZlc1N0YXJ0ICYmIGluZGV4IDw9IGhvc3REaXJlY3RpdmVzRW5kKSB7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgaW5kZXgpOwogICAgICAgIGNvbnN0IGRlZiA9IHRWaWV3LmRhdGFbaW5kZXhdOwogICAgICAgIGNvbnN0IGhvc3REaXJlY3RpdmVQdWJsaWNOYW1lID0gaG9zdERpcmVjdGl2ZUlucHV0c1tpICsgMV07CiAgICAgICAgd3JpdGVUb0RpcmVjdGl2ZUlucHV0KGRlZiwgbFZpZXdbaW5kZXhdLCBob3N0RGlyZWN0aXZlUHVibGljTmFtZSwgdmFsdWUpOwogICAgICAgIGhhc1NldCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoaW5kZXggPiBob3N0RGlyZWN0aXZlc0VuZCkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQogIGlmIChob3N0SW5kZXggIT09IG51bGwgJiYgdGFyZ2V0LmlucHV0cy5oYXNPd25Qcm9wZXJ0eShwdWJsaWNOYW1lKSkgewogICAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgaG9zdEluZGV4KTsKICAgIHdyaXRlVG9EaXJlY3RpdmVJbnB1dCh0YXJnZXQsIGxWaWV3W2hvc3RJbmRleF0sIHB1YmxpY05hbWUsIHZhbHVlKTsKICAgIGhhc1NldCA9IHRydWU7CiAgfQogIHJldHVybiBoYXNTZXQ7Cn0KZnVuY3Rpb24gcmVuZGVyQ29tcG9uZW50KGhvc3RMVmlldywgY29tcG9uZW50SG9zdElkeCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChpc0NyZWF0aW9uTW9kZShob3N0TFZpZXcpLCB0cnVlLCAiU2hvdWxkIGJlIHJ1biBpbiBjcmVhdGlvbiBtb2RlIik7CiAgY29uc3QgY29tcG9uZW50VmlldyA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleChjb21wb25lbnRIb3N0SWR4LCBob3N0TFZpZXcpOwogIGNvbnN0IGNvbXBvbmVudFRWaWV3ID0gY29tcG9uZW50Vmlld1tUVklFV107CiAgc3luY1ZpZXdXaXRoQmx1ZXByaW50KGNvbXBvbmVudFRWaWV3LCBjb21wb25lbnRWaWV3KTsKICBjb25zdCBob3N0Uk5vZGUgPSBjb21wb25lbnRWaWV3W0hPU1RdOwogIGlmIChob3N0Uk5vZGUgIT09IG51bGwgJiYgY29tcG9uZW50Vmlld1tIWURSQVRJT05dID09PSBudWxsKSB7CiAgICBjb21wb25lbnRWaWV3W0hZRFJBVElPTl0gPSByZXRyaWV2ZUh5ZHJhdGlvbkluZm8oaG9zdFJOb2RlLCBjb21wb25lbnRWaWV3W0lOSkVDVE9SXSk7CiAgfQogIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQ29tcG9uZW50U3RhcnQpOwogIHRyeSB7CiAgICByZW5kZXJWaWV3KGNvbXBvbmVudFRWaWV3LCBjb21wb25lbnRWaWV3LCBjb21wb25lbnRWaWV3W0NPTlRFWFRdKTsKICB9IGZpbmFsbHkgewogICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5Db21wb25lbnRFbmQsIGNvbXBvbmVudFZpZXdbQ09OVEVYVF0pOwogIH0KfQpmdW5jdGlvbiBzeW5jVmlld1dpdGhCbHVlcHJpbnQodFZpZXcsIGxWaWV3KSB7CiAgZm9yIChsZXQgaSA9IGxWaWV3Lmxlbmd0aDsgaSA8IHRWaWV3LmJsdWVwcmludC5sZW5ndGg7IGkrKykgewogICAgbFZpZXcucHVzaCh0Vmlldy5ibHVlcHJpbnRbaV0pOwogIH0KfQpmdW5jdGlvbiByZW5kZXJWaWV3KHRWaWV3LCBsVmlldywgY29udGV4dDIpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwoaXNDcmVhdGlvbk1vZGUobFZpZXcpLCB0cnVlLCAiU2hvdWxkIGJlIHJ1biBpbiBjcmVhdGlvbiBtb2RlIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdFJlYWN0aXZlKHJlbmRlclZpZXcubmFtZSk7CiAgZW50ZXJWaWV3KGxWaWV3KTsKICB0cnkgewogICAgY29uc3Qgdmlld1F1ZXJ5ID0gdFZpZXcudmlld1F1ZXJ5OwogICAgaWYgKHZpZXdRdWVyeSAhPT0gbnVsbCkgewogICAgICBleGVjdXRlVmlld1F1ZXJ5Rm4oMSwgdmlld1F1ZXJ5LCBjb250ZXh0Mik7CiAgICB9CiAgICBjb25zdCB0ZW1wbGF0ZUZuID0gdFZpZXcudGVtcGxhdGU7CiAgICBpZiAodGVtcGxhdGVGbiAhPT0gbnVsbCkgewogICAgICBleGVjdXRlVGVtcGxhdGUodFZpZXcsIGxWaWV3LCB0ZW1wbGF0ZUZuLCAxLCBjb250ZXh0Mik7CiAgICB9CiAgICBpZiAodFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICAgIHRWaWV3LmZpcnN0Q3JlYXRlUGFzcyA9IGZhbHNlOwogICAgfQogICAgbFZpZXdbUVVFUklFU10/LmZpbmlzaFZpZXdDcmVhdGlvbih0Vmlldyk7CiAgICBpZiAodFZpZXcuc3RhdGljQ29udGVudFF1ZXJpZXMpIHsKICAgICAgcmVmcmVzaENvbnRlbnRRdWVyaWVzKHRWaWV3LCBsVmlldyk7CiAgICB9CiAgICBpZiAodFZpZXcuc3RhdGljVmlld1F1ZXJpZXMpIHsKICAgICAgZXhlY3V0ZVZpZXdRdWVyeUZuKDIsIHRWaWV3LnZpZXdRdWVyeSwgY29udGV4dDIpOwogICAgfQogICAgY29uc3QgY29tcG9uZW50cyA9IHRWaWV3LmNvbXBvbmVudHM7CiAgICBpZiAoY29tcG9uZW50cyAhPT0gbnVsbCkgewogICAgICByZW5kZXJDaGlsZENvbXBvbmVudHMobFZpZXcsIGNvbXBvbmVudHMpOwogICAgfQogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBpZiAodFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICAgIHRWaWV3LmluY29tcGxldGVGaXJzdFBhc3MgPSB0cnVlOwogICAgICB0Vmlldy5maXJzdENyZWF0ZVBhc3MgPSBmYWxzZTsKICAgIH0KICAgIHRocm93IGVycm9yOwogIH0gZmluYWxseSB7CiAgICBsVmlld1tGTEFHU10gJj0gfjQ7CiAgICBsZWF2ZVZpZXcoKTsKICB9Cn0KZnVuY3Rpb24gcmVuZGVyQ2hpbGRDb21wb25lbnRzKGhvc3RMVmlldywgY29tcG9uZW50cykgewogIGZvciAobGV0IGkgPSAwOyBpIDwgY29tcG9uZW50cy5sZW5ndGg7IGkrKykgewogICAgcmVuZGVyQ29tcG9uZW50KGhvc3RMVmlldywgY29tcG9uZW50c1tpXSk7CiAgfQp9CmZ1bmN0aW9uIGNyZWF0ZUFuZFJlbmRlckVtYmVkZGVkTFZpZXcoZGVjbGFyYXRpb25MVmlldywgdGVtcGxhdGVUTm9kZSwgY29udGV4dDIsIG9wdGlvbnMpIHsKICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICB0cnkgewogICAgY29uc3QgZW1iZWRkZWRUVmlldyA9IHRlbXBsYXRlVE5vZGUudFZpZXc7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChlbWJlZGRlZFRWaWV3LCAiVFZpZXcgbXVzdCBiZSBkZWZpbmVkIGZvciBhIHRlbXBsYXRlIG5vZGUuIik7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVGb3JMVmlldyh0ZW1wbGF0ZVROb2RlLCBkZWNsYXJhdGlvbkxWaWV3KTsKICAgIGNvbnN0IGlzU2lnbmFsVmlldyA9IGRlY2xhcmF0aW9uTFZpZXdbRkxBR1NdICYgNDA5NjsKICAgIGNvbnN0IHZpZXdGbGFncyA9IGlzU2lnbmFsVmlldyA/IDQwOTYgOiAxNjsKICAgIGNvbnN0IGVtYmVkZGVkTFZpZXcgPSBjcmVhdGVMVmlldyhkZWNsYXJhdGlvbkxWaWV3LCBlbWJlZGRlZFRWaWV3LCBjb250ZXh0Miwgdmlld0ZsYWdzLCBudWxsLCB0ZW1wbGF0ZVROb2RlLCBudWxsLCBudWxsLCBvcHRpb25zPy5pbmplY3RvciA/PyBudWxsLCBvcHRpb25zPy5lbWJlZGRlZFZpZXdJbmplY3RvciA/PyBudWxsLCBvcHRpb25zPy5kZWh5ZHJhdGVkVmlldyA/PyBudWxsKTsKICAgIGNvbnN0IGRlY2xhcmF0aW9uTENvbnRhaW5lciA9IGRlY2xhcmF0aW9uTFZpZXdbdGVtcGxhdGVUTm9kZS5pbmRleF07CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TENvbnRhaW5lcihkZWNsYXJhdGlvbkxDb250YWluZXIpOwogICAgZW1iZWRkZWRMVmlld1tERUNMQVJBVElPTl9MQ09OVEFJTkVSXSA9IGRlY2xhcmF0aW9uTENvbnRhaW5lcjsKICAgIGNvbnN0IGRlY2xhcmF0aW9uVmlld0xRdWVyaWVzID0gZGVjbGFyYXRpb25MVmlld1tRVUVSSUVTXTsKICAgIGlmIChkZWNsYXJhdGlvblZpZXdMUXVlcmllcyAhPT0gbnVsbCkgewogICAgICBlbWJlZGRlZExWaWV3W1FVRVJJRVNdID0gZGVjbGFyYXRpb25WaWV3TFF1ZXJpZXMuY3JlYXRlRW1iZWRkZWRWaWV3KGVtYmVkZGVkVFZpZXcpOwogICAgfQogICAgcmVuZGVyVmlldyhlbWJlZGRlZFRWaWV3LCBlbWJlZGRlZExWaWV3LCBjb250ZXh0Mik7CiAgICByZXR1cm4gZW1iZWRkZWRMVmlldzsKICB9IGZpbmFsbHkgewogICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICB9Cn0KZnVuY3Rpb24gc2hvdWxkQWRkVmlld1RvRG9tKHROb2RlLCBkZWh5ZHJhdGVkVmlldykgewogIHJldHVybiAhZGVoeWRyYXRlZFZpZXcgfHwgZGVoeWRyYXRlZFZpZXcuZmlyc3RDaGlsZCA9PT0gbnVsbCB8fCBoYXNJblNraXBIeWRyYXRpb25CbG9ja0ZsYWcodE5vZGUpOwp9CnZhciBVU0VfRVhIQVVTVElWRV9DSEVDS19OT19DSEFOR0VTX0RFRkFVTFQgPSBmYWxzZTsKdmFyIFVzZUV4aGF1c3RpdmVDaGVja05vQ2hhbmdlcyA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiZXhoYXVzdGl2ZSBjaGVja05vQ2hhbmdlcyIgOiAiIik7CmZ1bmN0aW9uIGNvbGxlY3ROYXRpdmVOb2Rlcyh0VmlldywgbFZpZXcsIHROb2RlLCByZXN1bHQsIGlzUHJvamVjdGlvbiA9IGZhbHNlKSB7CiAgd2hpbGUgKHROb2RlICE9PSBudWxsKSB7CiAgICBpZiAodE5vZGUudHlwZSA9PT0gMTI4KSB7CiAgICAgIHROb2RlID0gaXNQcm9qZWN0aW9uID8gdE5vZGUucHJvamVjdGlvbk5leHQgOiB0Tm9kZS5uZXh0OwogICAgICBjb250aW51ZTsKICAgIH0KICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUodE5vZGUsIDMgfCAxMiB8IDE2IHwgMzIpOwogICAgY29uc3QgbE5vZGUgPSBsVmlld1t0Tm9kZS5pbmRleF07CiAgICBpZiAobE5vZGUgIT09IG51bGwpIHsKICAgICAgcmVzdWx0LnB1c2godW53cmFwUk5vZGUobE5vZGUpKTsKICAgIH0KICAgIGlmIChpc0xDb250YWluZXIobE5vZGUpKSB7CiAgICAgIGNvbGxlY3ROYXRpdmVOb2Rlc0luTENvbnRhaW5lcihsTm9kZSwgcmVzdWx0KTsKICAgIH0KICAgIGNvbnN0IHROb2RlVHlwZSA9IHROb2RlLnR5cGU7CiAgICBpZiAodE5vZGVUeXBlICYgOCkgewogICAgICBjb2xsZWN0TmF0aXZlTm9kZXModFZpZXcsIGxWaWV3LCB0Tm9kZS5jaGlsZCwgcmVzdWx0KTsKICAgIH0gZWxzZSBpZiAodE5vZGVUeXBlICYgMzIpIHsKICAgICAgY29uc3QgbmV4dFJOb2RlID0gaWN1Q29udGFpbmVySXRlcmF0ZSh0Tm9kZSwgbFZpZXcpOwogICAgICBsZXQgck5vZGU7CiAgICAgIHdoaWxlIChyTm9kZSA9IG5leHRSTm9kZSgpKSB7CiAgICAgICAgcmVzdWx0LnB1c2gock5vZGUpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHROb2RlVHlwZSAmIDE2KSB7CiAgICAgIGNvbnN0IG5vZGVzSW5TbG90ID0gZ2V0UHJvamVjdGlvbk5vZGVzKGxWaWV3LCB0Tm9kZSk7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KG5vZGVzSW5TbG90KSkgewogICAgICAgIHJlc3VsdC5wdXNoKC4uLm5vZGVzSW5TbG90KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBwYXJlbnRWaWV3ID0gZ2V0TFZpZXdQYXJlbnQobFZpZXdbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddKTsKICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0UGFyZW50VmlldyhwYXJlbnRWaWV3KTsKICAgICAgICBjb2xsZWN0TmF0aXZlTm9kZXMocGFyZW50Vmlld1tUVklFV10sIHBhcmVudFZpZXcsIG5vZGVzSW5TbG90LCByZXN1bHQsIHRydWUpOwogICAgICB9CiAgICB9CiAgICB0Tm9kZSA9IGlzUHJvamVjdGlvbiA/IHROb2RlLnByb2plY3Rpb25OZXh0IDogdE5vZGUubmV4dDsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfQpmdW5jdGlvbiBjb2xsZWN0TmF0aXZlTm9kZXNJbkxDb250YWluZXIobENvbnRhaW5lciwgcmVzdWx0KSB7CiAgZm9yIChsZXQgaSA9IENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUOyBpIDwgbENvbnRhaW5lci5sZW5ndGg7IGkrKykgewogICAgY29uc3QgbFZpZXdJbkFDb250YWluZXIgPSBsQ29udGFpbmVyW2ldOwogICAgY29uc3QgbFZpZXdGaXJzdENoaWxkVE5vZGUgPSBsVmlld0luQUNvbnRhaW5lcltUVklFV10uZmlyc3RDaGlsZDsKICAgIGlmIChsVmlld0ZpcnN0Q2hpbGRUTm9kZSAhPT0gbnVsbCkgewogICAgICBjb2xsZWN0TmF0aXZlTm9kZXMobFZpZXdJbkFDb250YWluZXJbVFZJRVddLCBsVmlld0luQUNvbnRhaW5lciwgbFZpZXdGaXJzdENoaWxkVE5vZGUsIHJlc3VsdCk7CiAgICB9CiAgfQogIGlmIChsQ29udGFpbmVyW05BVElWRV0gIT09IGxDb250YWluZXJbSE9TVF0pIHsKICAgIHJlc3VsdC5wdXNoKGxDb250YWluZXJbTkFUSVZFXSk7CiAgfQp9CmZ1bmN0aW9uIGFkZEFmdGVyUmVuZGVyU2VxdWVuY2VzRm9yVmlldyhsVmlldykgewogIGlmIChsVmlld1tBRlRFUl9SRU5ERVJfU0VRVUVOQ0VTX1RPX0FERF0gIT09IG51bGwpIHsKICAgIGZvciAoY29uc3Qgc2VxdWVuY2Ugb2YgbFZpZXdbQUZURVJfUkVOREVSX1NFUVVFTkNFU19UT19BRERdKSB7CiAgICAgIHNlcXVlbmNlLmltcGwuYWRkU2VxdWVuY2Uoc2VxdWVuY2UpOwogICAgfQogICAgbFZpZXdbQUZURVJfUkVOREVSX1NFUVVFTkNFU19UT19BRERdLmxlbmd0aCA9IDA7CiAgfQp9CnZhciBmcmVlQ29uc3VtZXJzID0gW107CmZ1bmN0aW9uIGdldE9yQm9ycm93UmVhY3RpdmVMVmlld0NvbnN1bWVyKGxWaWV3KSB7CiAgcmV0dXJuIGxWaWV3W1JFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSXSA/PyBib3Jyb3dSZWFjdGl2ZUxWaWV3Q29uc3VtZXIobFZpZXcpOwp9CmZ1bmN0aW9uIGJvcnJvd1JlYWN0aXZlTFZpZXdDb25zdW1lcihsVmlldykgewogIGNvbnN0IGNvbnN1bWVyID0gZnJlZUNvbnN1bWVycy5wb3AoKSA/PyBPYmplY3QuY3JlYXRlKFJFQUNUSVZFX0xWSUVXX0NPTlNVTUVSX05PREUpOwogIGNvbnN1bWVyLmxWaWV3ID0gbFZpZXc7CiAgcmV0dXJuIGNvbnN1bWVyOwp9CmZ1bmN0aW9uIG1heWJlUmV0dXJuUmVhY3RpdmVMVmlld0NvbnN1bWVyKGNvbnN1bWVyKSB7CiAgaWYgKGNvbnN1bWVyLmxWaWV3W1JFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSXSA9PT0gY29uc3VtZXIpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3VtZXIubFZpZXcgPSBudWxsOwogIGZyZWVDb25zdW1lcnMucHVzaChjb25zdW1lcik7Cn0KdmFyIFJFQUNUSVZFX0xWSUVXX0NPTlNVTUVSX05PREUgPSBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBSRUFDVElWRV9OT0RFKSwgewogIGNvbnN1bWVySXNBbHdheXNMaXZlOiB0cnVlLAogIGtpbmQ6ICJ0ZW1wbGF0ZSIsCiAgY29uc3VtZXJNYXJrZWREaXJ0eTogKG5vZGUpID0+IHsKICAgIG1hcmtBbmNlc3RvcnNGb3JUcmF2ZXJzYWwobm9kZS5sVmlldyk7CiAgfSwKICBjb25zdW1lck9uU2lnbmFsUmVhZCgpIHsKICAgIHRoaXMubFZpZXdbUkVBQ1RJVkVfVEVNUExBVEVfQ09OU1VNRVJdID0gdGhpczsKICB9Cn0pOwpmdW5jdGlvbiBnZXRPckNyZWF0ZVRlbXBvcmFyeUNvbnN1bWVyKGxWaWV3KSB7CiAgY29uc3QgY29uc3VtZXIgPSBsVmlld1tSRUFDVElWRV9URU1QTEFURV9DT05TVU1FUl0gPz8gT2JqZWN0LmNyZWF0ZShURU1QT1JBUllfQ09OU1VNRVJfTk9ERSk7CiAgY29uc3VtZXIubFZpZXcgPSBsVmlldzsKICByZXR1cm4gY29uc3VtZXI7Cn0KdmFyIFRFTVBPUkFSWV9DT05TVU1FUl9OT0RFID0gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgUkVBQ1RJVkVfTk9ERSksIHsKICBjb25zdW1lcklzQWx3YXlzTGl2ZTogdHJ1ZSwKICBraW5kOiAidGVtcGxhdGUiLAogIGNvbnN1bWVyTWFya2VkRGlydHk6IChub2RlKSA9PiB7CiAgICBsZXQgcGFyZW50ID0gZ2V0TFZpZXdQYXJlbnQobm9kZS5sVmlldyk7CiAgICB3aGlsZSAocGFyZW50ICYmICF2aWV3U2hvdWxkSGF2ZVJlYWN0aXZlQ29uc3VtZXIocGFyZW50W1RWSUVXXSkpIHsKICAgICAgcGFyZW50ID0gZ2V0TFZpZXdQYXJlbnQocGFyZW50KTsKICAgIH0KICAgIGlmICghcGFyZW50KSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIG1hcmtWaWV3Rm9yUmVmcmVzaChwYXJlbnQpOwogIH0sCiAgY29uc3VtZXJPblNpZ25hbFJlYWQoKSB7CiAgICB0aGlzLmxWaWV3W1JFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSXSA9IHRoaXM7CiAgfQp9KTsKZnVuY3Rpb24gdmlld1Nob3VsZEhhdmVSZWFjdGl2ZUNvbnN1bWVyKHRWaWV3KSB7CiAgcmV0dXJuIHRWaWV3LnR5cGUgIT09IDI7Cn0KZnVuY3Rpb24gaXNSZWFjdGl2ZUxWaWV3Q29uc3VtZXIobm9kZSkgewogIHJldHVybiBub2RlLmtpbmQgPT09ICJ0ZW1wbGF0ZSI7Cn0KZnVuY3Rpb24gcnVuRWZmZWN0c0luVmlldyh2aWV3KSB7CiAgaWYgKHZpZXdbRUZGRUNUU10gPT09IG51bGwpIHsKICAgIHJldHVybjsKICB9CiAgbGV0IHRyeUZsdXNoRWZmZWN0cyA9IHRydWU7CiAgd2hpbGUgKHRyeUZsdXNoRWZmZWN0cykgewogICAgbGV0IGZvdW5kRGlydHlFZmZlY3QgPSBmYWxzZTsKICAgIGZvciAoY29uc3QgZWZmZWN0MiBvZiB2aWV3W0VGRkVDVFNdKSB7CiAgICAgIGlmICghZWZmZWN0Mi5kaXJ0eSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGZvdW5kRGlydHlFZmZlY3QgPSB0cnVlOwogICAgICBpZiAoZWZmZWN0Mi56b25lID09PSBudWxsIHx8IFpvbmUuY3VycmVudCA9PT0gZWZmZWN0Mi56b25lKSB7CiAgICAgICAgZWZmZWN0Mi5ydW4oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlZmZlY3QyLnpvbmUucnVuKCgpID0+IGVmZmVjdDIucnVuKCkpOwogICAgICB9CiAgICB9CiAgICB0cnlGbHVzaEVmZmVjdHMgPSBmb3VuZERpcnR5RWZmZWN0ICYmICEhKHZpZXdbRkxBR1NdICYgODE5Mik7CiAgfQp9CnZhciBNQVhJTVVNX1JFRlJFU0hfUkVSVU5TJDEgPSAxMDA7CmZ1bmN0aW9uIGRldGVjdENoYW5nZXNJbnRlcm5hbChsVmlldywgbW9kZSA9IDApIHsKICBjb25zdCBlbnZpcm9ubWVudCA9IGxWaWV3W0VOVklST05NRU5UXTsKICBjb25zdCByZW5kZXJlckZhY3RvcnkgPSBlbnZpcm9ubWVudC5yZW5kZXJlckZhY3Rvcnk7CiAgY29uc3QgY2hlY2tOb0NoYW5nZXNNb2RlID0gISFuZ0Rldk1vZGUgJiYgaXNJbkNoZWNrTm9DaGFuZ2VzTW9kZSgpOwogIGlmICghY2hlY2tOb0NoYW5nZXNNb2RlKSB7CiAgICByZW5kZXJlckZhY3RvcnkuYmVnaW4/LigpOwogIH0KICB0cnkgewogICAgZGV0ZWN0Q2hhbmdlc0luVmlld1doaWxlRGlydHkobFZpZXcsIG1vZGUpOwogIH0gZmluYWxseSB7CiAgICBpZiAoIWNoZWNrTm9DaGFuZ2VzTW9kZSkgewogICAgICByZW5kZXJlckZhY3RvcnkuZW5kPy4oKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gZGV0ZWN0Q2hhbmdlc0luVmlld1doaWxlRGlydHkobFZpZXcsIG1vZGUpIHsKICBjb25zdCBsYXN0SXNSZWZyZXNoaW5nVmlld3NWYWx1ZSA9IGlzUmVmcmVzaGluZ1ZpZXdzKCk7CiAgdHJ5IHsKICAgIHNldElzUmVmcmVzaGluZ1ZpZXdzKHRydWUpOwogICAgZGV0ZWN0Q2hhbmdlc0luVmlldyhsVmlldywgbW9kZSk7CiAgICBpZiAobmdEZXZNb2RlICYmIGlzRXhoYXVzdGl2ZUNoZWNrTm9DaGFuZ2VzKCkpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IHJldHJpZXMgPSAwOwogICAgd2hpbGUgKHJlcXVpcmVzUmVmcmVzaE9yVHJhdmVyc2FsKGxWaWV3KSkgewogICAgICBpZiAocmV0cmllcyA9PT0gTUFYSU1VTV9SRUZSRVNIX1JFUlVOUyQxKSB7CiAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigxMDMsIG5nRGV2TW9kZSAmJiAiSW5maW5pdGUgY2hhbmdlIGRldGVjdGlvbiB3aGlsZSB0cnlpbmcgdG8gcmVmcmVzaCB2aWV3cy4gVGhlcmUgbWF5IGJlIGNvbXBvbmVudHMgd2hpY2ggZWFjaCBjYXVzZSB0aGUgb3RoZXIgdG8gcmVxdWlyZSBhIHJlZnJlc2gsIGNhdXNpbmcgYW4gaW5maW5pdGUgbG9vcC4iKTsKICAgICAgfQogICAgICByZXRyaWVzKys7CiAgICAgIGRldGVjdENoYW5nZXNJblZpZXcobFZpZXcsIDEpOwogICAgfQogIH0gZmluYWxseSB7CiAgICBzZXRJc1JlZnJlc2hpbmdWaWV3cyhsYXN0SXNSZWZyZXNoaW5nVmlld3NWYWx1ZSk7CiAgfQp9CmZ1bmN0aW9uIGNoZWNrTm9DaGFuZ2VzSW50ZXJuYWwobFZpZXcsIGV4aGF1c3RpdmUpIHsKICBzZXRJc0luQ2hlY2tOb0NoYW5nZXNNb2RlKGV4aGF1c3RpdmUgPyBDaGVja05vQ2hhbmdlc01vZGUuRXhoYXVzdGl2ZSA6IENoZWNrTm9DaGFuZ2VzTW9kZS5Pbmx5RGlydHlWaWV3cyk7CiAgdHJ5IHsKICAgIGRldGVjdENoYW5nZXNJbnRlcm5hbChsVmlldyk7CiAgfSBmaW5hbGx5IHsKICAgIHNldElzSW5DaGVja05vQ2hhbmdlc01vZGUoQ2hlY2tOb0NoYW5nZXNNb2RlLk9mZik7CiAgfQp9CmZ1bmN0aW9uIHJlZnJlc2hWaWV3KHRWaWV3LCBsVmlldywgdGVtcGxhdGVGbiwgY29udGV4dDIpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwoaXNDcmVhdGlvbk1vZGUobFZpZXcpLCBmYWxzZSwgIlNob3VsZCBiZSBydW4gaW4gdXBkYXRlIG1vZGUiKTsKICBpZiAoaXNEZXN0cm95ZWQobFZpZXcpKSByZXR1cm47CiAgY29uc3QgZmxhZ3MgPSBsVmlld1tGTEFHU107CiAgY29uc3QgaXNJbkNoZWNrTm9DaGFuZ2VzUGFzcyA9IG5nRGV2TW9kZSAmJiBpc0luQ2hlY2tOb0NoYW5nZXNNb2RlKCk7CiAgY29uc3QgaXNJbkV4aGF1c3RpdmVDaGVja05vQ2hhbmdlc1Bhc3MgPSBuZ0Rldk1vZGUgJiYgaXNFeGhhdXN0aXZlQ2hlY2tOb0NoYW5nZXMoKTsKICBlbnRlclZpZXcobFZpZXcpOwogIGxldCByZXR1cm5Db25zdW1lclRvUG9vbCA9IHRydWU7CiAgbGV0IHByZXZDb25zdW1lciA9IG51bGw7CiAgbGV0IGN1cnJlbnRDb25zdW1lciA9IG51bGw7CiAgaWYgKCFpc0luQ2hlY2tOb0NoYW5nZXNQYXNzKSB7CiAgICBpZiAodmlld1Nob3VsZEhhdmVSZWFjdGl2ZUNvbnN1bWVyKHRWaWV3KSkgewogICAgICBjdXJyZW50Q29uc3VtZXIgPSBnZXRPckJvcnJvd1JlYWN0aXZlTFZpZXdDb25zdW1lcihsVmlldyk7CiAgICAgIHByZXZDb25zdW1lciA9IGNvbnN1bWVyQmVmb3JlQ29tcHV0YXRpb24oY3VycmVudENvbnN1bWVyKTsKICAgIH0gZWxzZSBpZiAoZ2V0QWN0aXZlQ29uc3VtZXIoKSA9PT0gbnVsbCkgewogICAgICByZXR1cm5Db25zdW1lclRvUG9vbCA9IGZhbHNlOwogICAgICBjdXJyZW50Q29uc3VtZXIgPSBnZXRPckNyZWF0ZVRlbXBvcmFyeUNvbnN1bWVyKGxWaWV3KTsKICAgICAgcHJldkNvbnN1bWVyID0gY29uc3VtZXJCZWZvcmVDb21wdXRhdGlvbihjdXJyZW50Q29uc3VtZXIpOwogICAgfSBlbHNlIGlmIChsVmlld1tSRUFDVElWRV9URU1QTEFURV9DT05TVU1FUl0pIHsKICAgICAgY29uc3VtZXJEZXN0cm95KGxWaWV3W1JFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSXSk7CiAgICAgIGxWaWV3W1JFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSXSA9IG51bGw7CiAgICB9CiAgfQogIHRyeSB7CiAgICByZXNldFByZU9yZGVySG9va0ZsYWdzKGxWaWV3KTsKICAgIHNldEJpbmRpbmdJbmRleCh0Vmlldy5iaW5kaW5nU3RhcnRJbmRleCk7CiAgICBpZiAodGVtcGxhdGVGbiAhPT0gbnVsbCkgewogICAgICBleGVjdXRlVGVtcGxhdGUodFZpZXcsIGxWaWV3LCB0ZW1wbGF0ZUZuLCAyLCBjb250ZXh0Mik7CiAgICB9CiAgICBjb25zdCBob29rc0luaXRQaGFzZUNvbXBsZXRlZCA9IChmbGFncyAmIDMpID09PSAzOwogICAgaWYgKCFpc0luQ2hlY2tOb0NoYW5nZXNQYXNzKSB7CiAgICAgIGlmIChob29rc0luaXRQaGFzZUNvbXBsZXRlZCkgewogICAgICAgIGNvbnN0IHByZU9yZGVyQ2hlY2tIb29rcyA9IHRWaWV3LnByZU9yZGVyQ2hlY2tIb29rczsKICAgICAgICBpZiAocHJlT3JkZXJDaGVja0hvb2tzICE9PSBudWxsKSB7CiAgICAgICAgICBleGVjdXRlQ2hlY2tIb29rcyhsVmlldywgcHJlT3JkZXJDaGVja0hvb2tzLCBudWxsKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgcHJlT3JkZXJIb29rcyA9IHRWaWV3LnByZU9yZGVySG9va3M7CiAgICAgICAgaWYgKHByZU9yZGVySG9va3MgIT09IG51bGwpIHsKICAgICAgICAgIGV4ZWN1dGVJbml0QW5kQ2hlY2tIb29rcyhsVmlldywgcHJlT3JkZXJIb29rcywgMCwgbnVsbCk7CiAgICAgICAgfQogICAgICAgIGluY3JlbWVudEluaXRQaGFzZUZsYWdzKGxWaWV3LCAwKTsKICAgICAgfQogICAgfQogICAgaWYgKCFpc0luRXhoYXVzdGl2ZUNoZWNrTm9DaGFuZ2VzUGFzcykgewogICAgICBtYXJrVHJhbnNwbGFudGVkVmlld3NGb3JSZWZyZXNoKGxWaWV3KTsKICAgIH0KICAgIHJ1bkVmZmVjdHNJblZpZXcobFZpZXcpOwogICAgZGV0ZWN0Q2hhbmdlc0luRW1iZWRkZWRWaWV3cyhsVmlldywgMCk7CiAgICBpZiAodFZpZXcuY29udGVudFF1ZXJpZXMgIT09IG51bGwpIHsKICAgICAgcmVmcmVzaENvbnRlbnRRdWVyaWVzKHRWaWV3LCBsVmlldyk7CiAgICB9CiAgICBpZiAoIWlzSW5DaGVja05vQ2hhbmdlc1Bhc3MpIHsKICAgICAgaWYgKGhvb2tzSW5pdFBoYXNlQ29tcGxldGVkKSB7CiAgICAgICAgY29uc3QgY29udGVudENoZWNrSG9va3MgPSB0Vmlldy5jb250ZW50Q2hlY2tIb29rczsKICAgICAgICBpZiAoY29udGVudENoZWNrSG9va3MgIT09IG51bGwpIHsKICAgICAgICAgIGV4ZWN1dGVDaGVja0hvb2tzKGxWaWV3LCBjb250ZW50Q2hlY2tIb29rcyk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGNvbnRlbnRIb29rcyA9IHRWaWV3LmNvbnRlbnRIb29rczsKICAgICAgICBpZiAoY29udGVudEhvb2tzICE9PSBudWxsKSB7CiAgICAgICAgICBleGVjdXRlSW5pdEFuZENoZWNrSG9va3MobFZpZXcsIGNvbnRlbnRIb29rcywgMSk7CiAgICAgICAgfQogICAgICAgIGluY3JlbWVudEluaXRQaGFzZUZsYWdzKGxWaWV3LCAxKTsKICAgICAgfQogICAgfQogICAgcHJvY2Vzc0hvc3RCaW5kaW5nT3BDb2Rlcyh0VmlldywgbFZpZXcpOwogICAgY29uc3QgY29tcG9uZW50cyA9IHRWaWV3LmNvbXBvbmVudHM7CiAgICBpZiAoY29tcG9uZW50cyAhPT0gbnVsbCkgewogICAgICBkZXRlY3RDaGFuZ2VzSW5DaGlsZENvbXBvbmVudHMobFZpZXcsIGNvbXBvbmVudHMsIDApOwogICAgfQogICAgY29uc3Qgdmlld1F1ZXJ5ID0gdFZpZXcudmlld1F1ZXJ5OwogICAgaWYgKHZpZXdRdWVyeSAhPT0gbnVsbCkgewogICAgICBleGVjdXRlVmlld1F1ZXJ5Rm4oMiwgdmlld1F1ZXJ5LCBjb250ZXh0Mik7CiAgICB9CiAgICBpZiAoIWlzSW5DaGVja05vQ2hhbmdlc1Bhc3MpIHsKICAgICAgaWYgKGhvb2tzSW5pdFBoYXNlQ29tcGxldGVkKSB7CiAgICAgICAgY29uc3Qgdmlld0NoZWNrSG9va3MgPSB0Vmlldy52aWV3Q2hlY2tIb29rczsKICAgICAgICBpZiAodmlld0NoZWNrSG9va3MgIT09IG51bGwpIHsKICAgICAgICAgIGV4ZWN1dGVDaGVja0hvb2tzKGxWaWV3LCB2aWV3Q2hlY2tIb29rcyk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHZpZXdIb29rcyA9IHRWaWV3LnZpZXdIb29rczsKICAgICAgICBpZiAodmlld0hvb2tzICE9PSBudWxsKSB7CiAgICAgICAgICBleGVjdXRlSW5pdEFuZENoZWNrSG9va3MobFZpZXcsIHZpZXdIb29rcywgMik7CiAgICAgICAgfQogICAgICAgIGluY3JlbWVudEluaXRQaGFzZUZsYWdzKGxWaWV3LCAyKTsKICAgICAgfQogICAgfQogICAgaWYgKHRWaWV3LmZpcnN0VXBkYXRlUGFzcyA9PT0gdHJ1ZSkgewogICAgICB0Vmlldy5maXJzdFVwZGF0ZVBhc3MgPSBmYWxzZTsKICAgIH0KICAgIGlmIChsVmlld1tFRkZFQ1RTX1RPX1NDSEVEVUxFXSkgewogICAgICBmb3IgKGNvbnN0IG5vdGlmeUVmZmVjdCBvZiBsVmlld1tFRkZFQ1RTX1RPX1NDSEVEVUxFXSkgewogICAgICAgIG5vdGlmeUVmZmVjdCgpOwogICAgICB9CiAgICAgIGxWaWV3W0VGRkVDVFNfVE9fU0NIRURVTEVdID0gbnVsbDsKICAgIH0KICAgIGlmICghaXNJbkNoZWNrTm9DaGFuZ2VzUGFzcykgewogICAgICBhZGRBZnRlclJlbmRlclNlcXVlbmNlc0ZvclZpZXcobFZpZXcpOwogICAgICBsVmlld1tGTEFHU10gJj0gfig2NCB8IDgpOwogICAgfQogIH0gY2F0Y2ggKGUpIHsKICAgIGlmICghaXNJbkNoZWNrTm9DaGFuZ2VzUGFzcykgewogICAgICBtYXJrQW5jZXN0b3JzRm9yVHJhdmVyc2FsKGxWaWV3KTsKICAgIH0KICAgIHRocm93IGU7CiAgfSBmaW5hbGx5IHsKICAgIGlmIChjdXJyZW50Q29uc3VtZXIgIT09IG51bGwpIHsKICAgICAgY29uc3VtZXJBZnRlckNvbXB1dGF0aW9uKGN1cnJlbnRDb25zdW1lciwgcHJldkNvbnN1bWVyKTsKICAgICAgaWYgKHJldHVybkNvbnN1bWVyVG9Qb29sKSB7CiAgICAgICAgbWF5YmVSZXR1cm5SZWFjdGl2ZUxWaWV3Q29uc3VtZXIoY3VycmVudENvbnN1bWVyKTsKICAgICAgfQogICAgfQogICAgbGVhdmVWaWV3KCk7CiAgfQp9CmZ1bmN0aW9uIGRldGVjdENoYW5nZXNJbkVtYmVkZGVkVmlld3MobFZpZXcsIG1vZGUpIHsKICBmb3IgKGxldCBsQ29udGFpbmVyID0gZ2V0Rmlyc3RMQ29udGFpbmVyKGxWaWV3KTsgbENvbnRhaW5lciAhPT0gbnVsbDsgbENvbnRhaW5lciA9IGdldE5leHRMQ29udGFpbmVyKGxDb250YWluZXIpKSB7CiAgICBmb3IgKGxldCBpID0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQ7IGkgPCBsQ29udGFpbmVyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGVtYmVkZGVkTFZpZXcgPSBsQ29udGFpbmVyW2ldOwogICAgICBkZXRlY3RDaGFuZ2VzSW5WaWV3SWZBdHRhY2hlZChlbWJlZGRlZExWaWV3LCBtb2RlKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gbWFya1RyYW5zcGxhbnRlZFZpZXdzRm9yUmVmcmVzaChsVmlldykgewogIGZvciAobGV0IGxDb250YWluZXIgPSBnZXRGaXJzdExDb250YWluZXIobFZpZXcpOyBsQ29udGFpbmVyICE9PSBudWxsOyBsQ29udGFpbmVyID0gZ2V0TmV4dExDb250YWluZXIobENvbnRhaW5lcikpIHsKICAgIGlmICghKGxDb250YWluZXJbRkxBR1NdICYgMikpIGNvbnRpbnVlOwogICAgY29uc3QgbW92ZWRWaWV3cyA9IGxDb250YWluZXJbTU9WRURfVklFV1NdOwogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQobW92ZWRWaWV3cywgIlRyYW5zcGxhbnRlZCBWaWV3IGZsYWdzIHNldCBidXQgbWlzc2luZyBNT1ZFRF9WSUVXUyIpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb3ZlZFZpZXdzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IG1vdmVkTFZpZXcgPSBtb3ZlZFZpZXdzW2ldOwogICAgICBtYXJrVmlld0ZvclJlZnJlc2gobW92ZWRMVmlldyk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGRldGVjdENoYW5nZXNJbkNvbXBvbmVudChob3N0TFZpZXcsIGNvbXBvbmVudEhvc3RJZHgsIG1vZGUpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwoaXNDcmVhdGlvbk1vZGUoaG9zdExWaWV3KSwgZmFsc2UsICJTaG91bGQgYmUgcnVuIGluIHVwZGF0ZSBtb2RlIik7CiAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5Db21wb25lbnRTdGFydCk7CiAgY29uc3QgY29tcG9uZW50VmlldyA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleChjb21wb25lbnRIb3N0SWR4LCBob3N0TFZpZXcpOwogIHRyeSB7CiAgICBkZXRlY3RDaGFuZ2VzSW5WaWV3SWZBdHRhY2hlZChjb21wb25lbnRWaWV3LCBtb2RlKTsKICB9IGZpbmFsbHkgewogICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5Db21wb25lbnRFbmQsIGNvbXBvbmVudFZpZXdbQ09OVEVYVF0pOwogIH0KfQpmdW5jdGlvbiBkZXRlY3RDaGFuZ2VzSW5WaWV3SWZBdHRhY2hlZChsVmlldywgbW9kZSkgewogIGlmICghdmlld0F0dGFjaGVkVG9DaGFuZ2VEZXRlY3RvcihsVmlldykpIHsKICAgIHJldHVybjsKICB9CiAgZGV0ZWN0Q2hhbmdlc0luVmlldyhsVmlldywgbW9kZSk7Cn0KZnVuY3Rpb24gZGV0ZWN0Q2hhbmdlc0luVmlldyhsVmlldywgbW9kZSkgewogIGNvbnN0IGlzSW5DaGVja05vQ2hhbmdlc1Bhc3MgPSBuZ0Rldk1vZGUgJiYgaXNJbkNoZWNrTm9DaGFuZ2VzTW9kZSgpOwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IGZsYWdzID0gbFZpZXdbRkxBR1NdOwogIGNvbnN0IGNvbnN1bWVyID0gbFZpZXdbUkVBQ1RJVkVfVEVNUExBVEVfQ09OU1VNRVJdOwogIGxldCBzaG91bGRSZWZyZXNoVmlldyA9ICEhKG1vZGUgPT09IDAgJiYgZmxhZ3MgJiAxNik7CiAgc2hvdWxkUmVmcmVzaFZpZXcgfHw9ICEhKGZsYWdzICYgNjQgJiYgbW9kZSA9PT0gMCAmJiAhaXNJbkNoZWNrTm9DaGFuZ2VzUGFzcyk7CiAgc2hvdWxkUmVmcmVzaFZpZXcgfHw9ICEhKGZsYWdzICYgMTAyNCk7CiAgc2hvdWxkUmVmcmVzaFZpZXcgfHw9ICEhKGNvbnN1bWVyPy5kaXJ0eSAmJiBjb25zdW1lclBvbGxQcm9kdWNlcnNGb3JDaGFuZ2UoY29uc3VtZXIpKTsKICBzaG91bGRSZWZyZXNoVmlldyB8fD0gISEobmdEZXZNb2RlICYmIGlzRXhoYXVzdGl2ZUNoZWNrTm9DaGFuZ2VzKCkpOwogIGlmIChjb25zdW1lcikgewogICAgY29uc3VtZXIuZGlydHkgPSBmYWxzZTsKICB9CiAgbFZpZXdbRkxBR1NdICY9IH4oODE5MiB8IDEwMjQpOwogIGlmIChzaG91bGRSZWZyZXNoVmlldykgewogICAgcmVmcmVzaFZpZXcodFZpZXcsIGxWaWV3LCB0Vmlldy50ZW1wbGF0ZSwgbFZpZXdbQ09OVEVYVF0pOwogIH0gZWxzZSBpZiAoZmxhZ3MgJiA4MTkyKSB7CiAgICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgIHRyeSB7CiAgICAgIGlmICghaXNJbkNoZWNrTm9DaGFuZ2VzUGFzcykgewogICAgICAgIHJ1bkVmZmVjdHNJblZpZXcobFZpZXcpOwogICAgICB9CiAgICAgIGRldGVjdENoYW5nZXNJbkVtYmVkZGVkVmlld3MobFZpZXcsIDEpOwogICAgICBjb25zdCBjb21wb25lbnRzID0gdFZpZXcuY29tcG9uZW50czsKICAgICAgaWYgKGNvbXBvbmVudHMgIT09IG51bGwpIHsKICAgICAgICBkZXRlY3RDaGFuZ2VzSW5DaGlsZENvbXBvbmVudHMobFZpZXcsIGNvbXBvbmVudHMsIDEpOwogICAgICB9CiAgICAgIGlmICghaXNJbkNoZWNrTm9DaGFuZ2VzUGFzcykgewogICAgICAgIGFkZEFmdGVyUmVuZGVyU2VxdWVuY2VzRm9yVmlldyhsVmlldyk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGRldGVjdENoYW5nZXNJbkNoaWxkQ29tcG9uZW50cyhob3N0TFZpZXcsIGNvbXBvbmVudHMsIG1vZGUpIHsKICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKICAgIGRldGVjdENoYW5nZXNJbkNvbXBvbmVudChob3N0TFZpZXcsIGNvbXBvbmVudHNbaV0sIG1vZGUpOwogIH0KfQpmdW5jdGlvbiBwcm9jZXNzSG9zdEJpbmRpbmdPcENvZGVzKHRWaWV3LCBsVmlldykgewogIGNvbnN0IGhvc3RCaW5kaW5nT3BDb2RlcyA9IHRWaWV3Lmhvc3RCaW5kaW5nT3BDb2RlczsKICBpZiAoaG9zdEJpbmRpbmdPcENvZGVzID09PSBudWxsKSByZXR1cm47CiAgdHJ5IHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9zdEJpbmRpbmdPcENvZGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IG9wQ29kZSA9IGhvc3RCaW5kaW5nT3BDb2Rlc1tpXTsKICAgICAgaWYgKG9wQ29kZSA8IDApIHsKICAgICAgICBzZXRTZWxlY3RlZEluZGV4KH5vcENvZGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGRpcmVjdGl2ZUlkeCA9IG9wQ29kZTsKICAgICAgICBjb25zdCBiaW5kaW5nUm9vdEluZHggPSBob3N0QmluZGluZ09wQ29kZXNbKytpXTsKICAgICAgICBjb25zdCBob3N0QmluZGluZ0ZuID0gaG9zdEJpbmRpbmdPcENvZGVzWysraV07CiAgICAgICAgc2V0QmluZGluZ1Jvb3RGb3JIb3N0QmluZGluZ3MoYmluZGluZ1Jvb3RJbmR4LCBkaXJlY3RpdmVJZHgpOwogICAgICAgIGNvbnN0IGNvbnRleHQyID0gbFZpZXdbZGlyZWN0aXZlSWR4XTsKICAgICAgICBwcm9maWxlcihQcm9maWxlckV2ZW50Lkhvc3RCaW5kaW5nc1VwZGF0ZVN0YXJ0LCBjb250ZXh0Mik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGhvc3RCaW5kaW5nRm4oMiwgY29udGV4dDIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBwcm9maWxlcihQcm9maWxlckV2ZW50Lkhvc3RCaW5kaW5nc1VwZGF0ZUVuZCwgY29udGV4dDIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0gZmluYWxseSB7CiAgICBzZXRTZWxlY3RlZEluZGV4KC0xKTsKICB9Cn0KZnVuY3Rpb24gbWFya1ZpZXdEaXJ0eShsVmlldywgc291cmNlKSB7CiAgY29uc3QgZGlydHlCaXRzVG9Vc2UgPSBpc1JlZnJlc2hpbmdWaWV3cygpID8gNjQgOiAxMDI0IHwgNjQ7CiAgbFZpZXdbRU5WSVJPTk1FTlRdLmNoYW5nZURldGVjdGlvblNjaGVkdWxlcj8ubm90aWZ5KHNvdXJjZSk7CiAgd2hpbGUgKGxWaWV3KSB7CiAgICBsVmlld1tGTEFHU10gfD0gZGlydHlCaXRzVG9Vc2U7CiAgICBjb25zdCBwYXJlbnQgPSBnZXRMVmlld1BhcmVudChsVmlldyk7CiAgICBpZiAoaXNSb290VmlldyhsVmlldykgJiYgIXBhcmVudCkgewogICAgICByZXR1cm4gbFZpZXc7CiAgICB9CiAgICBsVmlldyA9IHBhcmVudDsKICB9CiAgcmV0dXJuIG51bGw7Cn0KZnVuY3Rpb24gY3JlYXRlTENvbnRhaW5lcihob3N0TmF0aXZlLCBjdXJyZW50VmlldywgbmF0aXZlLCB0Tm9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRMVmlldyhjdXJyZW50Vmlldyk7CiAgY29uc3QgbENvbnRhaW5lciA9IFtob3N0TmF0aXZlLCB0cnVlLCAwLCBjdXJyZW50VmlldywgbnVsbCwgdE5vZGUsIG51bGwsIG5hdGl2ZSwgbnVsbCwgbnVsbF07CiAgbmdEZXZNb2RlICYmIGFzc2VydEVxdWFsKGxDb250YWluZXIubGVuZ3RoLCBDT05UQUlORVJfSEVBREVSX09GRlNFVCwgIlNob3VsZCBhbGxvY2F0ZSBjb3JyZWN0IG51bWJlciBvZiBzbG90cyBmb3IgTENvbnRhaW5lciBoZWFkZXIuIik7CiAgcmV0dXJuIGxDb250YWluZXI7Cn0KZnVuY3Rpb24gZ2V0TFZpZXdGcm9tTENvbnRhaW5lcihsQ29udGFpbmVyLCBpbmRleCkgewogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBDT05UQUlORVJfSEVBREVSX09GRlNFVCArIGluZGV4OwogIGlmIChhZGp1c3RlZEluZGV4IDwgbENvbnRhaW5lci5sZW5ndGgpIHsKICAgIGNvbnN0IGxWaWV3ID0gbENvbnRhaW5lclthZGp1c3RlZEluZGV4XTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRMVmlldyhsVmlldyk7CiAgICByZXR1cm4gbFZpZXc7CiAgfQogIHJldHVybiB2b2lkIDA7Cn0KZnVuY3Rpb24gYWRkTFZpZXdUb0xDb250YWluZXIobENvbnRhaW5lciwgbFZpZXcsIGluZGV4LCBhZGRUb0RPTSA9IHRydWUpIHsKICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBpbnNlcnRWaWV3KHRWaWV3LCBsVmlldywgbENvbnRhaW5lciwgaW5kZXgpOwogIGlmIChhZGRUb0RPTSkgewogICAgY29uc3QgYmVmb3JlTm9kZSA9IGdldEJlZm9yZU5vZGVGb3JWaWV3KGluZGV4LCBsQ29udGFpbmVyKTsKICAgIGNvbnN0IHJlbmRlcmVyID0gbFZpZXdbUkVOREVSRVJdOwogICAgY29uc3QgcGFyZW50Uk5vZGUgPSByZW5kZXJlci5wYXJlbnROb2RlKGxDb250YWluZXJbTkFUSVZFXSk7CiAgICBpZiAocGFyZW50Uk5vZGUgIT09IG51bGwpIHsKICAgICAgYWRkVmlld1RvRE9NKHRWaWV3LCBsQ29udGFpbmVyW1RfSE9TVF0sIHJlbmRlcmVyLCBsVmlldywgcGFyZW50Uk5vZGUsIGJlZm9yZU5vZGUpOwogICAgfQogIH0KICBjb25zdCBoeWRyYXRpb25JbmZvID0gbFZpZXdbSFlEUkFUSU9OXTsKICBpZiAoaHlkcmF0aW9uSW5mbyAhPT0gbnVsbCAmJiBoeWRyYXRpb25JbmZvLmZpcnN0Q2hpbGQgIT09IG51bGwpIHsKICAgIGh5ZHJhdGlvbkluZm8uZmlyc3RDaGlsZCA9IG51bGw7CiAgfQp9CmZ1bmN0aW9uIHJlbW92ZUxWaWV3RnJvbUxDb250YWluZXIobENvbnRhaW5lciwgaW5kZXgpIHsKICBjb25zdCBsVmlldyA9IGRldGFjaFZpZXcobENvbnRhaW5lciwgaW5kZXgpOwogIGlmIChsVmlldyAhPT0gdm9pZCAwKSB7CiAgICBkZXN0cm95TFZpZXcobFZpZXdbVFZJRVddLCBsVmlldyk7CiAgfQogIHJldHVybiBsVmlldzsKfQpmdW5jdGlvbiBkZXRhY2hWaWV3KGxDb250YWluZXIsIHJlbW92ZUluZGV4KSB7CiAgaWYgKGxDb250YWluZXIubGVuZ3RoIDw9IENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUKSByZXR1cm47CiAgY29uc3QgaW5kZXhJbkNvbnRhaW5lciA9IENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUICsgcmVtb3ZlSW5kZXg7CiAgY29uc3Qgdmlld1RvRGV0YWNoID0gbENvbnRhaW5lcltpbmRleEluQ29udGFpbmVyXTsKICBpZiAodmlld1RvRGV0YWNoKSB7CiAgICBjb25zdCBkZWNsYXJhdGlvbkxDb250YWluZXIgPSB2aWV3VG9EZXRhY2hbREVDTEFSQVRJT05fTENPTlRBSU5FUl07CiAgICBpZiAoZGVjbGFyYXRpb25MQ29udGFpbmVyICE9PSBudWxsICYmIGRlY2xhcmF0aW9uTENvbnRhaW5lciAhPT0gbENvbnRhaW5lcikgewogICAgICBkZXRhY2hNb3ZlZFZpZXcoZGVjbGFyYXRpb25MQ29udGFpbmVyLCB2aWV3VG9EZXRhY2gpOwogICAgfQogICAgaWYgKHJlbW92ZUluZGV4ID4gMCkgewogICAgICBsQ29udGFpbmVyW2luZGV4SW5Db250YWluZXIgLSAxXVtORVhUXSA9IHZpZXdUb0RldGFjaFtORVhUXTsKICAgIH0KICAgIGNvbnN0IHJlbW92ZWRMVmlldyA9IHJlbW92ZUZyb21BcnJheShsQ29udGFpbmVyLCBDT05UQUlORVJfSEVBREVSX09GRlNFVCArIHJlbW92ZUluZGV4KTsKICAgIHJlbW92ZVZpZXdGcm9tRE9NKHZpZXdUb0RldGFjaFtUVklFV10sIHZpZXdUb0RldGFjaCk7CiAgICBjb25zdCBsUXVlcmllcyA9IHJlbW92ZWRMVmlld1tRVUVSSUVTXTsKICAgIGlmIChsUXVlcmllcyAhPT0gbnVsbCkgewogICAgICBsUXVlcmllcy5kZXRhY2hWaWV3KHJlbW92ZWRMVmlld1tUVklFV10pOwogICAgfQogICAgdmlld1RvRGV0YWNoW1BBUkVOVF0gPSBudWxsOwogICAgdmlld1RvRGV0YWNoW05FWFRdID0gbnVsbDsKICAgIHZpZXdUb0RldGFjaFtGTEFHU10gJj0gfjEyODsKICB9CiAgcmV0dXJuIHZpZXdUb0RldGFjaDsKfQpmdW5jdGlvbiBpbnNlcnRWaWV3KHRWaWV3LCBsVmlldywgbENvbnRhaW5lciwgaW5kZXgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TFZpZXcobFZpZXcpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRMQ29udGFpbmVyKGxDb250YWluZXIpOwogIGNvbnN0IGluZGV4SW5Db250YWluZXIgPSBDT05UQUlORVJfSEVBREVSX09GRlNFVCArIGluZGV4OwogIGNvbnN0IGNvbnRhaW5lckxlbmd0aCA9IGxDb250YWluZXIubGVuZ3RoOwogIGlmIChpbmRleCA+IDApIHsKICAgIGxDb250YWluZXJbaW5kZXhJbkNvbnRhaW5lciAtIDFdW05FWFRdID0gbFZpZXc7CiAgfQogIGlmIChpbmRleCA8IGNvbnRhaW5lckxlbmd0aCAtIENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUKSB7CiAgICBsVmlld1tORVhUXSA9IGxDb250YWluZXJbaW5kZXhJbkNvbnRhaW5lcl07CiAgICBhZGRUb0FycmF5KGxDb250YWluZXIsIENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUICsgaW5kZXgsIGxWaWV3KTsKICB9IGVsc2UgewogICAgbENvbnRhaW5lci5wdXNoKGxWaWV3KTsKICAgIGxWaWV3W05FWFRdID0gbnVsbDsKICB9CiAgbFZpZXdbUEFSRU5UXSA9IGxDb250YWluZXI7CiAgY29uc3QgZGVjbGFyYXRpb25MQ29udGFpbmVyID0gbFZpZXdbREVDTEFSQVRJT05fTENPTlRBSU5FUl07CiAgaWYgKGRlY2xhcmF0aW9uTENvbnRhaW5lciAhPT0gbnVsbCAmJiBsQ29udGFpbmVyICE9PSBkZWNsYXJhdGlvbkxDb250YWluZXIpIHsKICAgIHRyYWNrTW92ZWRWaWV3KGRlY2xhcmF0aW9uTENvbnRhaW5lciwgbFZpZXcpOwogIH0KICBjb25zdCBsUXVlcmllcyA9IGxWaWV3W1FVRVJJRVNdOwogIGlmIChsUXVlcmllcyAhPT0gbnVsbCkgewogICAgbFF1ZXJpZXMuaW5zZXJ0Vmlldyh0Vmlldyk7CiAgfQogIHVwZGF0ZUFuY2VzdG9yVHJhdmVyc2FsRmxhZ3NPbkF0dGFjaChsVmlldyk7CiAgbFZpZXdbRkxBR1NdIHw9IDEyODsKfQpmdW5jdGlvbiB0cmFja01vdmVkVmlldyhkZWNsYXJhdGlvbkNvbnRhaW5lciwgbFZpZXcpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChsVmlldywgIkxWaWV3IHJlcXVpcmVkIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydExDb250YWluZXIoZGVjbGFyYXRpb25Db250YWluZXIpOwogIGNvbnN0IG1vdmVkVmlld3MgPSBkZWNsYXJhdGlvbkNvbnRhaW5lcltNT1ZFRF9WSUVXU107CiAgY29uc3QgcGFyZW50ID0gbFZpZXdbUEFSRU5UXTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChwYXJlbnQsICJtaXNzaW5nIHBhcmVudCIpOwogIGlmIChpc0xWaWV3KHBhcmVudCkpIHsKICAgIGRlY2xhcmF0aW9uQ29udGFpbmVyW0ZMQUdTXSB8PSAyOwogIH0gZWxzZSB7CiAgICBjb25zdCBpbnNlcnRlZENvbXBvbmVudExWaWV3ID0gcGFyZW50W1BBUkVOVF1bREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddOwogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoaW5zZXJ0ZWRDb21wb25lbnRMVmlldywgIk1pc3NpbmcgaW5zZXJ0ZWRDb21wb25lbnRMVmlldyIpOwogICAgY29uc3QgZGVjbGFyZWRDb21wb25lbnRMVmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGRlY2xhcmVkQ29tcG9uZW50TFZpZXcsICJNaXNzaW5nIGRlY2xhcmVkQ29tcG9uZW50TFZpZXciKTsKICAgIGlmIChkZWNsYXJlZENvbXBvbmVudExWaWV3ICE9PSBpbnNlcnRlZENvbXBvbmVudExWaWV3KSB7CiAgICAgIGRlY2xhcmF0aW9uQ29udGFpbmVyW0ZMQUdTXSB8PSAyOwogICAgfQogIH0KICBpZiAobW92ZWRWaWV3cyA9PT0gbnVsbCkgewogICAgZGVjbGFyYXRpb25Db250YWluZXJbTU9WRURfVklFV1NdID0gW2xWaWV3XTsKICB9IGVsc2UgewogICAgbW92ZWRWaWV3cy5wdXNoKGxWaWV3KTsKICB9Cn0KdmFyIFZpZXdSZWYgPSBjbGFzcyB7CiAgX2xWaWV3OwogIF9jZFJlZkluamVjdGluZ1ZpZXc7CiAgX2FwcFJlZiA9IG51bGw7CiAgX2F0dGFjaGVkVG9WaWV3Q29udGFpbmVyID0gZmFsc2U7CiAgZXhoYXVzdGl2ZTsKICBnZXQgcm9vdE5vZGVzKCkgewogICAgY29uc3QgbFZpZXcgPSB0aGlzLl9sVmlldzsKICAgIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogICAgcmV0dXJuIGNvbGxlY3ROYXRpdmVOb2Rlcyh0VmlldywgbFZpZXcsIHRWaWV3LmZpcnN0Q2hpbGQsIFtdKTsKICB9CiAgY29uc3RydWN0b3IoX2xWaWV3LCBfY2RSZWZJbmplY3RpbmdWaWV3KSB7CiAgICB0aGlzLl9sVmlldyA9IF9sVmlldzsKICAgIHRoaXMuX2NkUmVmSW5qZWN0aW5nVmlldyA9IF9jZFJlZkluamVjdGluZ1ZpZXc7CiAgfQogIGdldCBjb250ZXh0KCkgewogICAgcmV0dXJuIHRoaXMuX2xWaWV3W0NPTlRFWFRdOwogIH0KICBzZXQgY29udGV4dCh2YWx1ZSkgewogICAgaWYgKG5nRGV2TW9kZSkgewogICAgICBjb25zb2xlLndhcm4oIkFuZ3VsYXI6IFJlcGxhY2luZyB0aGUgYGNvbnRleHRgIG9iamVjdCBvZiBhbiBgRW1iZWRkZWRWaWV3UmVmYCBpcyBkZXByZWNhdGVkLiIpOwogICAgfQogICAgdGhpcy5fbFZpZXdbQ09OVEVYVF0gPSB2YWx1ZTsKICB9CiAgZ2V0IGRlc3Ryb3llZCgpIHsKICAgIHJldHVybiBpc0Rlc3Ryb3llZCh0aGlzLl9sVmlldyk7CiAgfQogIGRlc3Ryb3koKSB7CiAgICBpZiAodGhpcy5fYXBwUmVmKSB7CiAgICAgIHRoaXMuX2FwcFJlZi5kZXRhY2hWaWV3KHRoaXMpOwogICAgfSBlbHNlIGlmICh0aGlzLl9hdHRhY2hlZFRvVmlld0NvbnRhaW5lcikgewogICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLl9sVmlld1tQQVJFTlRdOwogICAgICBpZiAoaXNMQ29udGFpbmVyKHBhcmVudCkpIHsKICAgICAgICBjb25zdCB2aWV3UmVmcyA9IHBhcmVudFtWSUVXX1JFRlNdOwogICAgICAgIGNvbnN0IGluZGV4ID0gdmlld1JlZnMgPyB2aWV3UmVmcy5pbmRleE9mKHRoaXMpIDogLTE7CiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChpbmRleCwgcGFyZW50LmluZGV4T2YodGhpcy5fbFZpZXcpIC0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQsICJBbiBhdHRhY2hlZCB2aWV3IHNob3VsZCBiZSBpbiB0aGUgc2FtZSBwb3NpdGlvbiB3aXRoaW4gaXRzIGNvbnRhaW5lciBhcyBpdHMgVmlld1JlZiBpbiB0aGUgVklFV19SRUZTIGFycmF5LiIpOwogICAgICAgICAgZGV0YWNoVmlldyhwYXJlbnQsIGluZGV4KTsKICAgICAgICAgIHJlbW92ZUZyb21BcnJheSh2aWV3UmVmcywgaW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLl9hdHRhY2hlZFRvVmlld0NvbnRhaW5lciA9IGZhbHNlOwogICAgfQogICAgZGVzdHJveUxWaWV3KHRoaXMuX2xWaWV3W1RWSUVXXSwgdGhpcy5fbFZpZXcpOwogIH0KICBvbkRlc3Ryb3koY2FsbGJhY2spIHsKICAgIHN0b3JlTFZpZXdPbkRlc3Ryb3kodGhpcy5fbFZpZXcsIGNhbGxiYWNrKTsKICB9CiAgbWFya0ZvckNoZWNrKCkgewogICAgbWFya1ZpZXdEaXJ0eSh0aGlzLl9jZFJlZkluamVjdGluZ1ZpZXcgfHwgdGhpcy5fbFZpZXcsIDQpOwogIH0KICBkZXRhY2goKSB7CiAgICB0aGlzLl9sVmlld1tGTEFHU10gJj0gfjEyODsKICB9CiAgcmVhdHRhY2goKSB7CiAgICB1cGRhdGVBbmNlc3RvclRyYXZlcnNhbEZsYWdzT25BdHRhY2godGhpcy5fbFZpZXcpOwogICAgdGhpcy5fbFZpZXdbRkxBR1NdIHw9IDEyODsKICB9CiAgZGV0ZWN0Q2hhbmdlcygpIHsKICAgIHRoaXMuX2xWaWV3W0ZMQUdTXSB8PSAxMDI0OwogICAgZGV0ZWN0Q2hhbmdlc0ludGVybmFsKHRoaXMuX2xWaWV3KTsKICB9CiAgY2hlY2tOb0NoYW5nZXMoKSB7CiAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5leGhhdXN0aXZlID8/PSB0aGlzLl9sVmlld1tJTkpFQ1RPUl0uZ2V0KFVzZUV4aGF1c3RpdmVDaGVja05vQ2hhbmdlcywgVVNFX0VYSEFVU1RJVkVfQ0hFQ0tfTk9fQ0hBTkdFU19ERUZBVUxUKTsKICAgICAgfSBjYXRjaCB7CiAgICAgICAgdGhpcy5leGhhdXN0aXZlID0gVVNFX0VYSEFVU1RJVkVfQ0hFQ0tfTk9fQ0hBTkdFU19ERUZBVUxUOwogICAgICB9CiAgICAgIGNoZWNrTm9DaGFuZ2VzSW50ZXJuYWwodGhpcy5fbFZpZXcsIHRoaXMuZXhoYXVzdGl2ZSk7CiAgICB9CiAgfQogIGF0dGFjaFRvVmlld0NvbnRhaW5lclJlZigpIHsKICAgIGlmICh0aGlzLl9hcHBSZWYpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDIsIG5nRGV2TW9kZSAmJiAiVGhpcyB2aWV3IGlzIGFscmVhZHkgYXR0YWNoZWQgZGlyZWN0bHkgdG8gdGhlIEFwcGxpY2F0aW9uUmVmISIpOwogICAgfQogICAgdGhpcy5fYXR0YWNoZWRUb1ZpZXdDb250YWluZXIgPSB0cnVlOwogIH0KICBkZXRhY2hGcm9tQXBwUmVmKCkgewogICAgdGhpcy5fYXBwUmVmID0gbnVsbDsKICAgIGNvbnN0IGlzUm9vdCA9IGlzUm9vdFZpZXcodGhpcy5fbFZpZXcpOwogICAgY29uc3QgZGVjbGFyYXRpb25Db250YWluZXIgPSB0aGlzLl9sVmlld1tERUNMQVJBVElPTl9MQ09OVEFJTkVSXTsKICAgIGlmIChkZWNsYXJhdGlvbkNvbnRhaW5lciAhPT0gbnVsbCAmJiAhaXNSb290KSB7CiAgICAgIGRldGFjaE1vdmVkVmlldyhkZWNsYXJhdGlvbkNvbnRhaW5lciwgdGhpcy5fbFZpZXcpOwogICAgfQogICAgZGV0YWNoVmlld0Zyb21ET00odGhpcy5fbFZpZXdbVFZJRVddLCB0aGlzLl9sVmlldyk7CiAgfQogIGF0dGFjaFRvQXBwUmVmKGFwcFJlZikgewogICAgaWYgKHRoaXMuX2F0dGFjaGVkVG9WaWV3Q29udGFpbmVyKSB7CiAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTAyLCBuZ0Rldk1vZGUgJiYgIlRoaXMgdmlldyBpcyBhbHJlYWR5IGF0dGFjaGVkIHRvIGEgVmlld0NvbnRhaW5lciEiKTsKICAgIH0KICAgIHRoaXMuX2FwcFJlZiA9IGFwcFJlZjsKICAgIGNvbnN0IGlzUm9vdCA9IGlzUm9vdFZpZXcodGhpcy5fbFZpZXcpOwogICAgY29uc3QgZGVjbGFyYXRpb25Db250YWluZXIgPSB0aGlzLl9sVmlld1tERUNMQVJBVElPTl9MQ09OVEFJTkVSXTsKICAgIGlmIChkZWNsYXJhdGlvbkNvbnRhaW5lciAhPT0gbnVsbCAmJiAhaXNSb290KSB7CiAgICAgIHRyYWNrTW92ZWRWaWV3KGRlY2xhcmF0aW9uQ29udGFpbmVyLCB0aGlzLl9sVmlldyk7CiAgICB9CiAgICB1cGRhdGVBbmNlc3RvclRyYXZlcnNhbEZsYWdzT25BdHRhY2godGhpcy5fbFZpZXcpOwogIH0KfTsKZnVuY3Rpb24gaXNWaWV3RGlydHkodmlldykgewogIHJldHVybiByZXF1aXJlc1JlZnJlc2hPclRyYXZlcnNhbCh2aWV3Ll9sVmlldykgfHwgISEodmlldy5fbFZpZXdbRkxBR1NdICYgNjQpOwp9CmZ1bmN0aW9uIG1hcmtGb3JSZWZyZXNoKHZpZXcpIHsKICBtYXJrVmlld0ZvclJlZnJlc2godmlldy5fbFZpZXcpOwp9CnZhciBUZW1wbGF0ZVJlZiA9IGNsYXNzIHsKICBfZGVjbGFyYXRpb25MVmlldzsKICBfZGVjbGFyYXRpb25UQ29udGFpbmVyOwogIGVsZW1lbnRSZWY7CiAgc3RhdGljIF9fTkdfRUxFTUVOVF9JRF9fID0gaW5qZWN0VGVtcGxhdGVSZWY7CiAgY29uc3RydWN0b3IoX2RlY2xhcmF0aW9uTFZpZXcsIF9kZWNsYXJhdGlvblRDb250YWluZXIsIGVsZW1lbnRSZWYpIHsKICAgIHRoaXMuX2RlY2xhcmF0aW9uTFZpZXcgPSBfZGVjbGFyYXRpb25MVmlldzsKICAgIHRoaXMuX2RlY2xhcmF0aW9uVENvbnRhaW5lciA9IF9kZWNsYXJhdGlvblRDb250YWluZXI7CiAgICB0aGlzLmVsZW1lbnRSZWYgPSBlbGVtZW50UmVmOwogIH0KICBnZXQgc3NySWQoKSB7CiAgICByZXR1cm4gdGhpcy5fZGVjbGFyYXRpb25UQ29udGFpbmVyLnRWaWV3Py5zc3JJZCB8fCBudWxsOwogIH0KICBjcmVhdGVFbWJlZGRlZFZpZXcoY29udGV4dDIsIGluamVjdG9yKSB7CiAgICByZXR1cm4gdGhpcy5jcmVhdGVFbWJlZGRlZFZpZXdJbXBsKGNvbnRleHQyLCBpbmplY3Rvcik7CiAgfQogIGNyZWF0ZUVtYmVkZGVkVmlld0ltcGwoY29udGV4dDIsIGluamVjdG9yLCBkZWh5ZHJhdGVkVmlldykgewogICAgY29uc3QgZW1iZWRkZWRMVmlldyA9IGNyZWF0ZUFuZFJlbmRlckVtYmVkZGVkTFZpZXcodGhpcy5fZGVjbGFyYXRpb25MVmlldywgdGhpcy5fZGVjbGFyYXRpb25UQ29udGFpbmVyLCBjb250ZXh0MiwgewogICAgICBlbWJlZGRlZFZpZXdJbmplY3RvcjogaW5qZWN0b3IsCiAgICAgIGRlaHlkcmF0ZWRWaWV3CiAgICB9KTsKICAgIHJldHVybiBuZXcgVmlld1JlZihlbWJlZGRlZExWaWV3KTsKICB9Cn07CmZ1bmN0aW9uIGluamVjdFRlbXBsYXRlUmVmKCkgewogIHJldHVybiBjcmVhdGVUZW1wbGF0ZVJlZihnZXRDdXJyZW50VE5vZGUoKSwgZ2V0TFZpZXcoKSk7Cn0KZnVuY3Rpb24gY3JlYXRlVGVtcGxhdGVSZWYoaG9zdFROb2RlLCBob3N0TFZpZXcpIHsKICBpZiAoaG9zdFROb2RlLnR5cGUgJiA0KSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChob3N0VE5vZGUudFZpZXcsICJUVmlldyBtdXN0IGJlIGFsbG9jYXRlZCIpOwogICAgcmV0dXJuIG5ldyBUZW1wbGF0ZVJlZihob3N0TFZpZXcsIGhvc3RUTm9kZSwgY3JlYXRlRWxlbWVudFJlZihob3N0VE5vZGUsIGhvc3RMVmlldykpOwogIH0KICByZXR1cm4gbnVsbDsKfQp2YXIgQVRfVEhJU19MT0NBVElPTiA9ICI8LS0gQVQgVEhJUyBMT0NBVElPTiI7CmZ1bmN0aW9uIGdldEZyaWVuZGx5U3RyaW5nRnJvbVROb2RlVHlwZSh0Tm9kZVR5cGUpIHsKICBzd2l0Y2ggKHROb2RlVHlwZSkgewogICAgY2FzZSA0OgogICAgICByZXR1cm4gInZpZXcgY29udGFpbmVyIjsKICAgIGNhc2UgMjoKICAgICAgcmV0dXJuICJlbGVtZW50IjsKICAgIGNhc2UgODoKICAgICAgcmV0dXJuICJuZy1jb250YWluZXIiOwogICAgY2FzZSAzMjoKICAgICAgcmV0dXJuICJpY3UiOwogICAgY2FzZSA2NDoKICAgICAgcmV0dXJuICJpMThuIjsKICAgIGNhc2UgMTY6CiAgICAgIHJldHVybiAicHJvamVjdGlvbiI7CiAgICBjYXNlIDE6CiAgICAgIHJldHVybiAidGV4dCI7CiAgICBjYXNlIDEyODoKICAgICAgcmV0dXJuICJAbGV0IjsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAiPHVua25vd24+IjsKICB9Cn0KZnVuY3Rpb24gdmFsaWRhdGVNYXRjaGluZ05vZGUobm9kZSwgbm9kZVR5cGUsIHRhZ05hbWUsIGxWaWV3LCB0Tm9kZSwgaXNWaWV3Q29udGFpbmVyQW5jaG9yID0gZmFsc2UpIHsKICBpZiAoIW5vZGUgfHwgbm9kZS5ub2RlVHlwZSAhPT0gbm9kZVR5cGUgfHwgbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUgJiYgbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09IHRhZ05hbWU/LnRvTG93ZXJDYXNlKCkpIHsKICAgIGNvbnN0IGV4cGVjdGVkTm9kZSA9IHNob3J0Uk5vZGVEZXNjcmlwdGlvbihub2RlVHlwZSwgdGFnTmFtZSwgbnVsbCk7CiAgICBsZXQgaGVhZGVyID0gYER1cmluZyBoeWRyYXRpb24gQW5ndWxhciBleHBlY3RlZCAke2V4cGVjdGVkTm9kZX0gYnV0IGA7CiAgICBjb25zdCBob3N0Q29tcG9uZW50RGVmID0gZ2V0RGVjbGFyYXRpb25Db21wb25lbnREZWYobFZpZXcpOwogICAgY29uc3QgY29tcG9uZW50Q2xhc3NOYW1lID0gaG9zdENvbXBvbmVudERlZj8udHlwZT8ubmFtZTsKICAgIGNvbnN0IGV4cGVjdGVkRG9tID0gZGVzY3JpYmVFeHBlY3RlZERvbShsVmlldywgdE5vZGUsIGlzVmlld0NvbnRhaW5lckFuY2hvcik7CiAgICBjb25zdCBleHBlY3RlZCA9IGBBbmd1bGFyIGV4cGVjdGVkIHRoaXMgRE9NOgoKJHtleHBlY3RlZERvbX0KCmA7CiAgICBsZXQgYWN0dWFsID0gIiI7CiAgICBjb25zdCBjb21wb25lbnRIb3N0RWxlbWVudCA9IHVud3JhcFJOb2RlKGxWaWV3W0hPU1RdKTsKICAgIGlmICghbm9kZSkgewogICAgICBoZWFkZXIgKz0gYHRoZSBub2RlIHdhcyBub3QgZm91bmQuCgpgOwogICAgICBtYXJrUk5vZGVBc0hhdmluZ0h5ZHJhdGlvbk1pc21hdGNoKGNvbXBvbmVudEhvc3RFbGVtZW50LCBleHBlY3RlZERvbSk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBhY3R1YWxOb2RlID0gc2hvcnRSTm9kZURlc2NyaXB0aW9uKG5vZGUubm9kZVR5cGUsIG5vZGUudGFnTmFtZSA/PyBudWxsLCBub2RlLnRleHRDb250ZW50ID8/IG51bGwpOwogICAgICBoZWFkZXIgKz0gYGZvdW5kICR7YWN0dWFsTm9kZX0uCgpgOwogICAgICBjb25zdCBhY3R1YWxEb20gPSBkZXNjcmliZURvbUZyb21Ob2RlKG5vZGUpOwogICAgICBhY3R1YWwgPSBgQWN0dWFsIERPTSBpczoKCiR7YWN0dWFsRG9tfQoKYDsKICAgICAgbWFya1JOb2RlQXNIYXZpbmdIeWRyYXRpb25NaXNtYXRjaChjb21wb25lbnRIb3N0RWxlbWVudCwgZXhwZWN0ZWREb20sIGFjdHVhbERvbSk7CiAgICB9CiAgICBjb25zdCBmb290ZXIgPSBnZXRIeWRyYXRpb25FcnJvckZvb3Rlcihjb21wb25lbnRDbGFzc05hbWUpOwogICAgY29uc3QgbWVzc2FnZSA9IGhlYWRlciArIGV4cGVjdGVkICsgYWN0dWFsICsgZ2V0SHlkcmF0aW9uQXR0cmlidXRlTm90ZSgpICsgZm9vdGVyOwogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtNTAwLCBtZXNzYWdlKTsKICB9Cn0KZnVuY3Rpb24gdmFsaWRhdGVTaWJsaW5nTm9kZUV4aXN0cyhub2RlKSB7CiAgdmFsaWRhdGVOb2RlRXhpc3RzKG5vZGUpOwogIGlmICghbm9kZS5uZXh0U2libGluZykgewogICAgY29uc3QgaGVhZGVyID0gIkR1cmluZyBoeWRyYXRpb24gQW5ndWxhciBleHBlY3RlZCBtb3JlIHNpYmxpbmcgbm9kZXMgdG8gYmUgcHJlc2VudC5cblxuIjsKICAgIGNvbnN0IGFjdHVhbCA9IGBBY3R1YWwgRE9NIGlzOgoKJHtkZXNjcmliZURvbUZyb21Ob2RlKG5vZGUpfQoKYDsKICAgIGNvbnN0IGZvb3RlciA9IGdldEh5ZHJhdGlvbkVycm9yRm9vdGVyKCk7CiAgICBjb25zdCBtZXNzYWdlID0gaGVhZGVyICsgYWN0dWFsICsgZm9vdGVyOwogICAgbWFya1JOb2RlQXNIYXZpbmdIeWRyYXRpb25NaXNtYXRjaChub2RlLCAiIiwgYWN0dWFsKTsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTUwMSwgbWVzc2FnZSk7CiAgfQp9CmZ1bmN0aW9uIHZhbGlkYXRlTm9kZUV4aXN0cyhub2RlLCBsVmlldyA9IG51bGwsIHROb2RlID0gbnVsbCkgewogIGlmICghbm9kZSkgewogICAgY29uc3QgaGVhZGVyID0gIkR1cmluZyBoeWRyYXRpb24sIEFuZ3VsYXIgZXhwZWN0ZWQgYW4gZWxlbWVudCB0byBiZSBwcmVzZW50IGF0IHRoaXMgbG9jYXRpb24uXG5cbiI7CiAgICBsZXQgZXhwZWN0ZWQgPSAiIjsKICAgIGxldCBmb290ZXIgPSAiIjsKICAgIGlmIChsVmlldyAhPT0gbnVsbCAmJiB0Tm9kZSAhPT0gbnVsbCkgewogICAgICBleHBlY3RlZCA9IGRlc2NyaWJlRXhwZWN0ZWREb20obFZpZXcsIHROb2RlLCBmYWxzZSk7CiAgICAgIGZvb3RlciA9IGdldEh5ZHJhdGlvbkVycm9yRm9vdGVyKCk7CiAgICAgIG1hcmtSTm9kZUFzSGF2aW5nSHlkcmF0aW9uTWlzbWF0Y2godW53cmFwUk5vZGUobFZpZXdbSE9TVF0pLCBleHBlY3RlZCwgIiIpOwogICAgfQogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtNTAyLCBgJHtoZWFkZXJ9JHtleHBlY3RlZH0KCiR7Zm9vdGVyfWApOwogIH0KfQpmdW5jdGlvbiBub2RlTm90Rm91bmRFcnJvcihsVmlldywgdE5vZGUpIHsKICBjb25zdCBoZWFkZXIgPSAiRHVyaW5nIHNlcmlhbGl6YXRpb24sIEFuZ3VsYXIgd2FzIHVuYWJsZSB0byBmaW5kIGFuIGVsZW1lbnQgaW4gdGhlIERPTTpcblxuIjsKICBjb25zdCBleHBlY3RlZCA9IGAke2Rlc2NyaWJlRXhwZWN0ZWREb20obFZpZXcsIHROb2RlLCBmYWxzZSl9CgpgOwogIGNvbnN0IGZvb3RlciA9IGdldEh5ZHJhdGlvbkVycm9yRm9vdGVyKCk7CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtNTAyLCBoZWFkZXIgKyBleHBlY3RlZCArIGZvb3Rlcik7Cn0KZnVuY3Rpb24gbm9kZU5vdEZvdW5kQXRQYXRoRXJyb3IoaG9zdCwgcGF0aCkgewogIGNvbnN0IGhlYWRlciA9IGBEdXJpbmcgaHlkcmF0aW9uIEFuZ3VsYXIgd2FzIHVuYWJsZSB0byBsb2NhdGUgYSBub2RlIHVzaW5nIHRoZSAiJHtwYXRofSIgcGF0aCwgc3RhcnRpbmcgZnJvbSB0aGUgJHtkZXNjcmliZVJOb2RlKGhvc3QpfSBub2RlLgoKYDsKICBjb25zdCBmb290ZXIgPSBnZXRIeWRyYXRpb25FcnJvckZvb3RlcigpOwogIG1hcmtSTm9kZUFzSGF2aW5nSHlkcmF0aW9uTWlzbWF0Y2goaG9zdCk7CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtNTAyLCBoZWFkZXIgKyBmb290ZXIpOwp9CmZ1bmN0aW9uIHVuc3VwcG9ydGVkUHJvamVjdGlvbk9mRG9tTm9kZXMock5vZGUpIHsKICBjb25zdCBoZWFkZXIgPSAiRHVyaW5nIHNlcmlhbGl6YXRpb24sIEFuZ3VsYXIgZGV0ZWN0ZWQgRE9NIG5vZGVzIHRoYXQgd2VyZSBjcmVhdGVkIG91dHNpZGUgb2YgQW5ndWxhciBjb250ZXh0IGFuZCBwcm92aWRlZCBhcyBwcm9qZWN0YWJsZSBub2RlcyAobGlrZWx5IHZpYSBgVmlld0NvbnRhaW5lclJlZi5jcmVhdGVDb21wb25lbnRgIG9yIGBjcmVhdGVDb21wb25lbnRgIEFQSXMpLiBIeWRyYXRpb24gaXMgbm90IHN1cHBvcnRlZCBmb3Igc3VjaCBjYXNlcywgY29uc2lkZXIgcmVmYWN0b3JpbmcgdGhlIGNvZGUgdG8gYXZvaWQgdGhpcyBwYXR0ZXJuIG9yIHVzaW5nIGBuZ1NraXBIeWRyYXRpb25gIG9uIHRoZSBob3N0IGVsZW1lbnQgb2YgdGhlIGNvbXBvbmVudC5cblxuIjsKICBjb25zdCBhY3R1YWwgPSBgJHtkZXNjcmliZURvbUZyb21Ob2RlKHJOb2RlKX0KCmA7CiAgY29uc3QgbWVzc2FnZSA9IGhlYWRlciArIGFjdHVhbCArIGdldEh5ZHJhdGlvbkF0dHJpYnV0ZU5vdGUoKTsKICByZXR1cm4gbmV3IFJ1bnRpbWVFcnJvcigtNTAzLCBtZXNzYWdlKTsKfQpmdW5jdGlvbiBpbnZhbGlkU2tpcEh5ZHJhdGlvbkhvc3Qock5vZGUpIHsKICBjb25zdCBoZWFkZXIgPSAiVGhlIGBuZ1NraXBIeWRyYXRpb25gIGZsYWcgaXMgYXBwbGllZCBvbiBhIG5vZGUgdGhhdCBkb2Vzbid0IGFjdCBhcyBhIGNvbXBvbmVudCBob3N0LiBIeWRyYXRpb24gY2FuIGJlIHNraXBwZWQgb25seSBvbiBwZXItY29tcG9uZW50IGJhc2lzLlxuXG4iOwogIGNvbnN0IGFjdHVhbCA9IGAke2Rlc2NyaWJlRG9tRnJvbU5vZGUock5vZGUpfQoKYDsKICBjb25zdCBmb290ZXIgPSAiUGxlYXNlIG1vdmUgdGhlIGBuZ1NraXBIeWRyYXRpb25gIGF0dHJpYnV0ZSB0byB0aGUgY29tcG9uZW50IGhvc3QgZWxlbWVudC5cblxuIjsKICBjb25zdCBtZXNzYWdlID0gaGVhZGVyICsgYWN0dWFsICsgZm9vdGVyOwogIHJldHVybiBuZXcgUnVudGltZUVycm9yKC01MDQsIG1lc3NhZ2UpOwp9CmZ1bmN0aW9uIHN0cmluZ2lmeVROb2RlQXR0cnModE5vZGUpIHsKICBjb25zdCByZXN1bHRzID0gW107CiAgaWYgKHROb2RlLmF0dHJzKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHROb2RlLmF0dHJzLmxlbmd0aDsgKSB7CiAgICAgIGNvbnN0IGF0dHJOYW1lID0gdE5vZGUuYXR0cnNbaSsrXTsKICAgICAgaWYgKHR5cGVvZiBhdHRyTmFtZSA9PSAibnVtYmVyIikgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNvbnN0IGF0dHJWYWx1ZSA9IHROb2RlLmF0dHJzW2krK107CiAgICAgIHJlc3VsdHMucHVzaChgJHthdHRyTmFtZX09IiR7c2hvcnRlbihhdHRyVmFsdWUpfSJgKTsKICAgIH0KICB9CiAgcmV0dXJuIHJlc3VsdHMuam9pbigiICIpOwp9CnZhciBpbnRlcm5hbEF0dHJzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoWyJuZ2giLCAibmctdmVyc2lvbiIsICJuZy1zZXJ2ZXItY29udGV4dCJdKTsKZnVuY3Rpb24gc3RyaW5naWZ5Uk5vZGVBdHRycyhyTm9kZSkgewogIGNvbnN0IHJlc3VsdHMgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHJOb2RlLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGF0dHIgPSByTm9kZS5hdHRyaWJ1dGVzW2ldOwogICAgaWYgKGludGVybmFsQXR0cnMuaGFzKGF0dHIubmFtZSkpIGNvbnRpbnVlOwogICAgcmVzdWx0cy5wdXNoKGAke2F0dHIubmFtZX09IiR7c2hvcnRlbihhdHRyLnZhbHVlKX0iYCk7CiAgfQogIHJldHVybiByZXN1bHRzLmpvaW4oIiAiKTsKfQpmdW5jdGlvbiBkZXNjcmliZVROb2RlKHROb2RlLCBpbm5lckNvbnRlbnQgPSAi4oCmIikgewogIHN3aXRjaCAodE5vZGUudHlwZSkgewogICAgY2FzZSAxOgogICAgICBjb25zdCBjb250ZW50ID0gdE5vZGUudmFsdWUgPyBgKCR7dE5vZGUudmFsdWV9KWAgOiAiIjsKICAgICAgcmV0dXJuIGAjdGV4dCR7Y29udGVudH1gOwogICAgY2FzZSAyOgogICAgICBjb25zdCBhdHRycyA9IHN0cmluZ2lmeVROb2RlQXR0cnModE5vZGUpOwogICAgICBjb25zdCB0YWcgPSB0Tm9kZS52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICByZXR1cm4gYDwke3RhZ30ke2F0dHJzID8gIiAiICsgYXR0cnMgOiAiIn0+JHtpbm5lckNvbnRlbnR9PC8ke3RhZ30+YDsKICAgIGNhc2UgODoKICAgICAgcmV0dXJuICI8IS0tIG5nLWNvbnRhaW5lciAtLT4iOwogICAgY2FzZSA0OgogICAgICByZXR1cm4gIjwhLS0gY29udGFpbmVyIC0tPiI7CiAgICBkZWZhdWx0OgogICAgICBjb25zdCB0eXBlQXNTdHJpbmcgPSBnZXRGcmllbmRseVN0cmluZ0Zyb21UTm9kZVR5cGUodE5vZGUudHlwZSk7CiAgICAgIHJldHVybiBgI25vZGUoJHt0eXBlQXNTdHJpbmd9KWA7CiAgfQp9CmZ1bmN0aW9uIGRlc2NyaWJlUk5vZGUock5vZGUsIGlubmVyQ29udGVudCA9ICLigKYiKSB7CiAgY29uc3Qgbm9kZSA9IHJOb2RlOwogIHN3aXRjaCAobm9kZS5ub2RlVHlwZSkgewogICAgY2FzZSBOb2RlLkVMRU1FTlRfTk9ERToKICAgICAgY29uc3QgdGFnID0gbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgIGNvbnN0IGF0dHJzID0gc3RyaW5naWZ5Uk5vZGVBdHRycyhub2RlKTsKICAgICAgcmV0dXJuIGA8JHt0YWd9JHthdHRycyA/ICIgIiArIGF0dHJzIDogIiJ9PiR7aW5uZXJDb250ZW50fTwvJHt0YWd9PmA7CiAgICBjYXNlIE5vZGUuVEVYVF9OT0RFOgogICAgICBjb25zdCBjb250ZW50ID0gbm9kZS50ZXh0Q29udGVudCA/IHNob3J0ZW4obm9kZS50ZXh0Q29udGVudCkgOiAiIjsKICAgICAgcmV0dXJuIGAjdGV4dCR7Y29udGVudCA/IGAoJHtjb250ZW50fSlgIDogIiJ9YDsKICAgIGNhc2UgTm9kZS5DT01NRU5UX05PREU6CiAgICAgIHJldHVybiBgPCEtLSAke3Nob3J0ZW4obm9kZS50ZXh0Q29udGVudCA/PyAiIil9IC0tPmA7CiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gYCNub2RlKCR7bm9kZS5ub2RlVHlwZX0pYDsKICB9Cn0KZnVuY3Rpb24gZGVzY3JpYmVFeHBlY3RlZERvbShsVmlldywgdE5vZGUsIGlzVmlld0NvbnRhaW5lckFuY2hvcikgewogIGNvbnN0IHNwYWNlciA9ICIgICI7CiAgbGV0IGNvbnRlbnQgPSAiIjsKICBpZiAodE5vZGUucHJldikgewogICAgY29udGVudCArPSBzcGFjZXIgKyAi4oCmXG4iOwogICAgY29udGVudCArPSBzcGFjZXIgKyBkZXNjcmliZVROb2RlKHROb2RlLnByZXYpICsgIlxuIjsKICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiYgdE5vZGUudHlwZSAmIDEyKSB7CiAgICBjb250ZW50ICs9IHNwYWNlciArICLigKZcbiI7CiAgfQogIGlmIChpc1ZpZXdDb250YWluZXJBbmNob3IpIHsKICAgIGNvbnRlbnQgKz0gc3BhY2VyICsgZGVzY3JpYmVUTm9kZSh0Tm9kZSkgKyAiXG4iOwogICAgY29udGVudCArPSBzcGFjZXIgKyBgPCEtLSBjb250YWluZXIgLS0+ICAke0FUX1RISVNfTE9DQVRJT059CmA7CiAgfSBlbHNlIHsKICAgIGNvbnRlbnQgKz0gc3BhY2VyICsgZGVzY3JpYmVUTm9kZSh0Tm9kZSkgKyBgICAke0FUX1RISVNfTE9DQVRJT059CmA7CiAgfQogIGNvbnRlbnQgKz0gc3BhY2VyICsgIuKAplxuIjsKICBjb25zdCBwYXJlbnRSTm9kZSA9IHROb2RlLnR5cGUgPyBnZXRQYXJlbnRSRWxlbWVudChsVmlld1tUVklFV10sIHROb2RlLCBsVmlldykgOiBudWxsOwogIGlmIChwYXJlbnRSTm9kZSkgewogICAgY29udGVudCA9IGRlc2NyaWJlUk5vZGUocGFyZW50Uk5vZGUsICJcbiIgKyBjb250ZW50KTsKICB9CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KZnVuY3Rpb24gZGVzY3JpYmVEb21Gcm9tTm9kZShub2RlKSB7CiAgY29uc3Qgc3BhY2VyID0gIiAgIjsKICBsZXQgY29udGVudCA9ICIiOwogIGNvbnN0IGN1cnJlbnROb2RlID0gbm9kZTsKICBpZiAoY3VycmVudE5vZGUucHJldmlvdXNTaWJsaW5nKSB7CiAgICBjb250ZW50ICs9IHNwYWNlciArICLigKZcbiI7CiAgICBjb250ZW50ICs9IHNwYWNlciArIGRlc2NyaWJlUk5vZGUoY3VycmVudE5vZGUucHJldmlvdXNTaWJsaW5nKSArICJcbiI7CiAgfQogIGNvbnRlbnQgKz0gc3BhY2VyICsgZGVzY3JpYmVSTm9kZShjdXJyZW50Tm9kZSkgKyBgICAke0FUX1RISVNfTE9DQVRJT059CmA7CiAgaWYgKG5vZGUubmV4dFNpYmxpbmcpIHsKICAgIGNvbnRlbnQgKz0gc3BhY2VyICsgIuKAplxuIjsKICB9CiAgaWYgKG5vZGUucGFyZW50Tm9kZSkgewogICAgY29udGVudCA9IGRlc2NyaWJlUk5vZGUoY3VycmVudE5vZGUucGFyZW50Tm9kZSwgIlxuIiArIGNvbnRlbnQpOwogIH0KICByZXR1cm4gY29udGVudDsKfQpmdW5jdGlvbiBzaG9ydFJOb2RlRGVzY3JpcHRpb24obm9kZVR5cGUsIHRhZ05hbWUsIHRleHRDb250ZW50KSB7CiAgc3dpdGNoIChub2RlVHlwZSkgewogICAgY2FzZSBOb2RlLkVMRU1FTlRfTk9ERToKICAgICAgcmV0dXJuIGA8JHt0YWdOYW1lLnRvTG93ZXJDYXNlKCl9PmA7CiAgICBjYXNlIE5vZGUuVEVYVF9OT0RFOgogICAgICBjb25zdCBjb250ZW50ID0gdGV4dENvbnRlbnQgPyBgICh3aXRoIHRoZSAiJHtzaG9ydGVuKHRleHRDb250ZW50KX0iIGNvbnRlbnQpYCA6ICIiOwogICAgICByZXR1cm4gYGEgdGV4dCBub2RlJHtjb250ZW50fWA7CiAgICBjYXNlIE5vZGUuQ09NTUVOVF9OT0RFOgogICAgICByZXR1cm4gImEgY29tbWVudCBub2RlIjsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBgI25vZGUobm9kZVR5cGU9JHtub2RlVHlwZX0pYDsKICB9Cn0KZnVuY3Rpb24gZ2V0SHlkcmF0aW9uRXJyb3JGb290ZXIoY29tcG9uZW50Q2xhc3NOYW1lKSB7CiAgY29uc3QgY29tcG9uZW50SW5mbyA9IGNvbXBvbmVudENsYXNzTmFtZSA/IGB0aGUgIiR7Y29tcG9uZW50Q2xhc3NOYW1lfSJgIDogImNvcnJlc3BvbmRpbmciOwogIHJldHVybiBgVG8gZml4IHRoaXMgcHJvYmxlbToKICAqIGNoZWNrICR7Y29tcG9uZW50SW5mb30gY29tcG9uZW50IGZvciBoeWRyYXRpb24tcmVsYXRlZCBpc3N1ZXMKICAqIGNoZWNrIHRvIHNlZSBpZiB5b3VyIHRlbXBsYXRlIGhhcyB2YWxpZCBIVE1MIHN0cnVjdHVyZQogICogb3Igc2tpcCBoeWRyYXRpb24gYnkgYWRkaW5nIHRoZSBcYG5nU2tpcEh5ZHJhdGlvblxgIGF0dHJpYnV0ZSB0byBpdHMgaG9zdCBub2RlIGluIGEgdGVtcGxhdGUKCmA7Cn0KZnVuY3Rpb24gZ2V0SHlkcmF0aW9uQXR0cmlidXRlTm90ZSgpIHsKICByZXR1cm4gIk5vdGU6IGF0dHJpYnV0ZXMgYXJlIG9ubHkgZGlzcGxheWVkIHRvIGJldHRlciByZXByZXNlbnQgdGhlIERPTSBidXQgaGF2ZSBubyBlZmZlY3Qgb24gaHlkcmF0aW9uIG1pc21hdGNoZXMuXG5cbiI7Cn0KZnVuY3Rpb24gc3RyaXBOZXdsaW5lcyhpbnB1dDIpIHsKICByZXR1cm4gaW5wdXQyLnJlcGxhY2UoL1xzKy9nbSwgIiIpOwp9CmZ1bmN0aW9uIHNob3J0ZW4oaW5wdXQyLCBtYXhMZW5ndGggPSA1MCkgewogIGlmICghaW5wdXQyKSB7CiAgICByZXR1cm4gIiI7CiAgfQogIGlucHV0MiA9IHN0cmlwTmV3bGluZXMoaW5wdXQyKTsKICByZXR1cm4gaW5wdXQyLmxlbmd0aCA+IG1heExlbmd0aCA/IGAke2lucHV0Mi5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoIC0gMSl94oCmYCA6IGlucHV0MjsKfQpmdW5jdGlvbiBnZXRJbnNlcnRJbkZyb250T2ZSTm9kZVdpdGhJMThuKHBhcmVudFROb2RlLCBjdXJyZW50VE5vZGUsIGxWaWV3KSB7CiAgY29uc3QgdE5vZGVJbnNlcnRCZWZvcmVJbmRleCA9IGN1cnJlbnRUTm9kZS5pbnNlcnRCZWZvcmVJbmRleDsKICBjb25zdCBpbnNlcnRCZWZvcmVJbmRleCA9IEFycmF5LmlzQXJyYXkodE5vZGVJbnNlcnRCZWZvcmVJbmRleCkgPyB0Tm9kZUluc2VydEJlZm9yZUluZGV4WzBdIDogdE5vZGVJbnNlcnRCZWZvcmVJbmRleDsKICBpZiAoaW5zZXJ0QmVmb3JlSW5kZXggPT09IG51bGwpIHsKICAgIHJldHVybiBnZXRJbnNlcnRJbkZyb250T2ZSTm9kZVdpdGhOb0kxOG4ocGFyZW50VE5vZGUsIGN1cnJlbnRUTm9kZSwgbFZpZXcpOwogIH0gZWxzZSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJblJhbmdlKGxWaWV3LCBpbnNlcnRCZWZvcmVJbmRleCk7CiAgICByZXR1cm4gdW53cmFwUk5vZGUobFZpZXdbaW5zZXJ0QmVmb3JlSW5kZXhdKTsKICB9Cn0KZnVuY3Rpb24gcHJvY2Vzc0kxOG5JbnNlcnRCZWZvcmUocmVuZGVyZXIsIGNoaWxkVE5vZGUsIGxWaWV3LCBjaGlsZFJOb2RlLCBwYXJlbnRSRWxlbWVudCkgewogIGNvbnN0IHROb2RlSW5zZXJ0QmVmb3JlSW5kZXggPSBjaGlsZFROb2RlLmluc2VydEJlZm9yZUluZGV4OwogIGlmIChBcnJheS5pc0FycmF5KHROb2RlSW5zZXJ0QmVmb3JlSW5kZXgpKSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RG9tTm9kZShjaGlsZFJOb2RlKTsKICAgIGxldCBpMThuUGFyZW50ID0gY2hpbGRSTm9kZTsKICAgIGxldCBhbmNob3JSTm9kZSA9IG51bGw7CiAgICBpZiAoIShjaGlsZFROb2RlLnR5cGUgJiAzKSkgewogICAgICBhbmNob3JSTm9kZSA9IGkxOG5QYXJlbnQ7CiAgICAgIGkxOG5QYXJlbnQgPSBwYXJlbnRSRWxlbWVudDsKICAgIH0KICAgIGlmIChpMThuUGFyZW50ICE9PSBudWxsICYmIGNoaWxkVE5vZGUuY29tcG9uZW50T2Zmc2V0ID09PSAtMSkgewogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHROb2RlSW5zZXJ0QmVmb3JlSW5kZXgubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBpMThuQ2hpbGQgPSBsVmlld1t0Tm9kZUluc2VydEJlZm9yZUluZGV4W2ldXTsKICAgICAgICBuYXRpdmVJbnNlcnRCZWZvcmUocmVuZGVyZXIsIGkxOG5QYXJlbnQsIGkxOG5DaGlsZCwgYW5jaG9yUk5vZGUsIGZhbHNlKTsKICAgICAgfQogICAgfQogIH0KfQpmdW5jdGlvbiBnZXRPckNyZWF0ZVROb2RlKHRWaWV3LCBpbmRleCwgdHlwZSwgbmFtZSwgYXR0cnMpIHsKICBuZ0Rldk1vZGUgJiYgaW5kZXggIT09IDAgJiYgYXNzZXJ0R3JlYXRlclRoYW5PckVxdWFsKGluZGV4LCBIRUFERVJfT0ZGU0VULCAiVE5vZGVzIGNhbid0IGJlIGluIHRoZSBMVmlldyBoZWFkZXIuIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydFB1cmVUTm9kZVR5cGUodHlwZSk7CiAgbGV0IHROb2RlID0gdFZpZXcuZGF0YVtpbmRleF07CiAgaWYgKHROb2RlID09PSBudWxsKSB7CiAgICB0Tm9kZSA9IGNyZWF0ZVROb2RlQXRJbmRleCh0VmlldywgaW5kZXgsIHR5cGUsIG5hbWUsIGF0dHJzKTsKICAgIGlmIChpc0luSTE4bkJsb2NrKCkpIHsKICAgICAgdE5vZGUuZmxhZ3MgfD0gMzI7CiAgICB9CiAgfSBlbHNlIGlmICh0Tm9kZS50eXBlICYgNjQpIHsKICAgIHROb2RlLnR5cGUgPSB0eXBlOwogICAgdE5vZGUudmFsdWUgPSBuYW1lOwogICAgdE5vZGUuYXR0cnMgPSBhdHRyczsKICAgIGNvbnN0IHBhcmVudCA9IGdldEN1cnJlbnRQYXJlbnRUTm9kZSgpOwogICAgdE5vZGUuaW5qZWN0b3JJbmRleCA9IHBhcmVudCA9PT0gbnVsbCA/IC0xIDogcGFyZW50LmluamVjdG9ySW5kZXg7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVGb3JUVmlldyh0Tm9kZSwgdFZpZXcpOwogICAgbmdEZXZNb2RlICYmIGFzc2VydEVxdWFsKGluZGV4LCB0Tm9kZS5pbmRleCwgIkV4cGVjdGluZyBzYW1lIGluZGV4Iik7CiAgfQogIHNldEN1cnJlbnRUTm9kZSh0Tm9kZSwgdHJ1ZSk7CiAgcmV0dXJuIHROb2RlOwp9CmZ1bmN0aW9uIGNyZWF0ZVROb2RlQXRJbmRleCh0VmlldywgaW5kZXgsIHR5cGUsIG5hbWUsIGF0dHJzKSB7CiAgY29uc3QgY3VycmVudFROb2RlID0gZ2V0Q3VycmVudFROb2RlUGxhY2Vob2xkZXJPaygpOwogIGNvbnN0IGlzUGFyZW50ID0gaXNDdXJyZW50VE5vZGVQYXJlbnQoKTsKICBjb25zdCBwYXJlbnQgPSBpc1BhcmVudCA/IGN1cnJlbnRUTm9kZSA6IGN1cnJlbnRUTm9kZSAmJiBjdXJyZW50VE5vZGUucGFyZW50OwogIGNvbnN0IHROb2RlID0gdFZpZXcuZGF0YVtpbmRleF0gPSBjcmVhdGVUTm9kZSh0VmlldywgcGFyZW50LCB0eXBlLCBpbmRleCwgbmFtZSwgYXR0cnMpOwogIGxpbmtUTm9kZUluVFZpZXcodFZpZXcsIHROb2RlLCBjdXJyZW50VE5vZGUsIGlzUGFyZW50KTsKICByZXR1cm4gdE5vZGU7Cn0KZnVuY3Rpb24gbGlua1ROb2RlSW5UVmlldyh0VmlldywgdE5vZGUsIGN1cnJlbnRUTm9kZSwgaXNQYXJlbnQpIHsKICBpZiAodFZpZXcuZmlyc3RDaGlsZCA9PT0gbnVsbCkgewogICAgdFZpZXcuZmlyc3RDaGlsZCA9IHROb2RlOwogIH0KICBpZiAoY3VycmVudFROb2RlICE9PSBudWxsKSB7CiAgICBpZiAoaXNQYXJlbnQpIHsKICAgICAgaWYgKGN1cnJlbnRUTm9kZS5jaGlsZCA9PSBudWxsICYmIHROb2RlLnBhcmVudCAhPT0gbnVsbCkgewogICAgICAgIGN1cnJlbnRUTm9kZS5jaGlsZCA9IHROb2RlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoY3VycmVudFROb2RlLm5leHQgPT09IG51bGwpIHsKICAgICAgICBjdXJyZW50VE5vZGUubmV4dCA9IHROb2RlOwogICAgICAgIHROb2RlLnByZXYgPSBjdXJyZW50VE5vZGU7CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gY3JlYXRlVE5vZGUodFZpZXcsIHRQYXJlbnQsIHR5cGUsIGluZGV4LCB2YWx1ZSwgYXR0cnMpIHsKICBuZ0Rldk1vZGUgJiYgaW5kZXggIT09IDAgJiYgYXNzZXJ0R3JlYXRlclRoYW5PckVxdWFsKGluZGV4LCBIRUFERVJfT0ZGU0VULCAiVE5vZGVzIGNhbid0IGJlIGluIHRoZSBMVmlldyBoZWFkZXIuIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdFNhbWUoYXR0cnMsIHZvaWQgMCwgIid1bmRlZmluZWQnIGlzIG5vdCB2YWxpZCB2YWx1ZSBmb3IgJ2F0dHJzJyIpOwogIG5nRGV2TW9kZSAmJiB0UGFyZW50ICYmIGFzc2VydFROb2RlRm9yVFZpZXcodFBhcmVudCwgdFZpZXcpOwogIGxldCBpbmplY3RvckluZGV4ID0gdFBhcmVudCA/IHRQYXJlbnQuaW5qZWN0b3JJbmRleCA6IC0xOwogIGxldCBmbGFncyA9IDA7CiAgaWYgKGlzSW5Ta2lwSHlkcmF0aW9uQmxvY2soKSkgewogICAgZmxhZ3MgfD0gMTI4OwogIH0KICBjb25zdCB0Tm9kZSA9IHsKICAgIHR5cGUsCiAgICBpbmRleCwKICAgIGluc2VydEJlZm9yZUluZGV4OiBudWxsLAogICAgaW5qZWN0b3JJbmRleCwKICAgIGRpcmVjdGl2ZVN0YXJ0OiAtMSwKICAgIGRpcmVjdGl2ZUVuZDogLTEsCiAgICBkaXJlY3RpdmVTdHlsaW5nTGFzdDogLTEsCiAgICBjb21wb25lbnRPZmZzZXQ6IC0xLAogICAgZmllbGRJbmRleDogLTEsCiAgICBjdXN0b21Db250cm9sSW5kZXg6IC0xLAogICAgcHJvcGVydHlCaW5kaW5nczogbnVsbCwKICAgIGZsYWdzLAogICAgcHJvdmlkZXJJbmRleGVzOiAwLAogICAgdmFsdWUsCiAgICBhdHRycywKICAgIG1lcmdlZEF0dHJzOiBudWxsLAogICAgbG9jYWxOYW1lczogbnVsbCwKICAgIGluaXRpYWxJbnB1dHM6IG51bGwsCiAgICBpbnB1dHM6IG51bGwsCiAgICBob3N0RGlyZWN0aXZlSW5wdXRzOiBudWxsLAogICAgb3V0cHV0czogbnVsbCwKICAgIGhvc3REaXJlY3RpdmVPdXRwdXRzOiBudWxsLAogICAgZGlyZWN0aXZlVG9JbmRleDogbnVsbCwKICAgIHRWaWV3OiBudWxsLAogICAgbmV4dDogbnVsbCwKICAgIHByZXY6IG51bGwsCiAgICBwcm9qZWN0aW9uTmV4dDogbnVsbCwKICAgIGNoaWxkOiBudWxsLAogICAgcGFyZW50OiB0UGFyZW50LAogICAgcHJvamVjdGlvbjogbnVsbCwKICAgIHN0eWxlczogbnVsbCwKICAgIHN0eWxlc1dpdGhvdXRIb3N0OiBudWxsLAogICAgcmVzaWR1YWxTdHlsZXM6IHZvaWQgMCwKICAgIGNsYXNzZXM6IG51bGwsCiAgICBjbGFzc2VzV2l0aG91dEhvc3Q6IG51bGwsCiAgICByZXNpZHVhbENsYXNzZXM6IHZvaWQgMCwKICAgIGNsYXNzQmluZGluZ3M6IDAsCiAgICBzdHlsZUJpbmRpbmdzOiAwCiAgfTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBPYmplY3Quc2VhbCh0Tm9kZSk7CiAgfQogIHJldHVybiB0Tm9kZTsKfQpmdW5jdGlvbiBhZGRUTm9kZUFuZFVwZGF0ZUluc2VydEJlZm9yZUluZGV4KHByZXZpb3VzVE5vZGVzLCBuZXdUTm9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChuZXdUTm9kZS5pbnNlcnRCZWZvcmVJbmRleCwgbnVsbCwgIldlIGV4cGVjdCB0aGF0IGluc2VydEJlZm9yZUluZGV4IGlzIG5vdCBzZXQiKTsKICBwcmV2aW91c1ROb2Rlcy5wdXNoKG5ld1ROb2RlKTsKICBpZiAocHJldmlvdXNUTm9kZXMubGVuZ3RoID4gMSkgewogICAgZm9yIChsZXQgaSA9IHByZXZpb3VzVE5vZGVzLmxlbmd0aCAtIDI7IGkgPj0gMDsgaS0tKSB7CiAgICAgIGNvbnN0IGV4aXN0aW5nVE5vZGUgPSBwcmV2aW91c1ROb2Rlc1tpXTsKICAgICAgaWYgKCFpc0kxOG5UZXh0KGV4aXN0aW5nVE5vZGUpKSB7CiAgICAgICAgaWYgKGlzTmV3VE5vZGVDcmVhdGVkQmVmb3JlKGV4aXN0aW5nVE5vZGUsIG5ld1ROb2RlKSAmJiBnZXRJbnNlcnRCZWZvcmVJbmRleChleGlzdGluZ1ROb2RlKSA9PT0gbnVsbCkgewogICAgICAgICAgc2V0SW5zZXJ0QmVmb3JlSW5kZXgoZXhpc3RpbmdUTm9kZSwgbmV3VE5vZGUuaW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQpmdW5jdGlvbiBpc0kxOG5UZXh0KHROb2RlKSB7CiAgcmV0dXJuICEodE5vZGUudHlwZSAmIDY0KTsKfQpmdW5jdGlvbiBpc05ld1ROb2RlQ3JlYXRlZEJlZm9yZShleGlzdGluZ1ROb2RlLCBuZXdUTm9kZSkgewogIHJldHVybiBpc0kxOG5UZXh0KG5ld1ROb2RlKSB8fCBleGlzdGluZ1ROb2RlLmluZGV4ID4gbmV3VE5vZGUuaW5kZXg7Cn0KZnVuY3Rpb24gZ2V0SW5zZXJ0QmVmb3JlSW5kZXgodE5vZGUpIHsKICBjb25zdCBpbmRleCA9IHROb2RlLmluc2VydEJlZm9yZUluZGV4OwogIHJldHVybiBBcnJheS5pc0FycmF5KGluZGV4KSA/IGluZGV4WzBdIDogaW5kZXg7Cn0KZnVuY3Rpb24gc2V0SW5zZXJ0QmVmb3JlSW5kZXgodE5vZGUsIHZhbHVlKSB7CiAgY29uc3QgaW5kZXggPSB0Tm9kZS5pbnNlcnRCZWZvcmVJbmRleDsKICBpZiAoQXJyYXkuaXNBcnJheShpbmRleCkpIHsKICAgIGluZGV4WzBdID0gdmFsdWU7CiAgfSBlbHNlIHsKICAgIHNldEkxOG5IYW5kbGluZyhnZXRJbnNlcnRJbkZyb250T2ZSTm9kZVdpdGhJMThuLCBwcm9jZXNzSTE4bkluc2VydEJlZm9yZSk7CiAgICB0Tm9kZS5pbnNlcnRCZWZvcmVJbmRleCA9IHZhbHVlOwogIH0KfQpmdW5jdGlvbiBnZXRUSWN1KHRWaWV3LCBpbmRleCkgewogIGNvbnN0IHZhbHVlID0gdFZpZXcuZGF0YVtpbmRleF07CiAgaWYgKHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHJldHVybiBudWxsOwogIGlmIChuZ0Rldk1vZGUgJiYgISh2YWx1ZS5oYXNPd25Qcm9wZXJ0eSgidFZpZXciKSB8fCB2YWx1ZS5oYXNPd25Qcm9wZXJ0eSgiY3VycmVudENhc2VMVmlld0luZGV4IikpKSB7CiAgICB0aHJvd0Vycm9yMigiV2UgZXhwZWN0IHRvIGdldCAnbnVsbCd8J1RJY3UnfCdUSWN1Q29udGFpbmVyJywgYnV0IGdvdDogIiArIHZhbHVlKTsKICB9CiAgY29uc3QgdEljdSA9IHZhbHVlLmhhc093blByb3BlcnR5KCJjdXJyZW50Q2FzZUxWaWV3SW5kZXgiKSA/IHZhbHVlIDogdmFsdWUudmFsdWU7CiAgbmdEZXZNb2RlICYmIGFzc2VydFRJY3UodEljdSk7CiAgcmV0dXJuIHRJY3U7Cn0KZnVuY3Rpb24gc2V0VEljdSh0VmlldywgaW5kZXgsIHRJY3UpIHsKICBjb25zdCB0Tm9kZSA9IHRWaWV3LmRhdGFbaW5kZXhdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbCh0Tm9kZSA9PT0gbnVsbCB8fCB0Tm9kZS5oYXNPd25Qcm9wZXJ0eSgidFZpZXciKSwgdHJ1ZSwgIldlIGV4cGVjdCB0byBnZXQgJ251bGwnfCdUSWN1Q29udGFpbmVyJyIpOwogIGlmICh0Tm9kZSA9PT0gbnVsbCkgewogICAgdFZpZXcuZGF0YVtpbmRleF0gPSB0SWN1OwogIH0gZWxzZSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVUeXBlKHROb2RlLCAzMik7CiAgICB0Tm9kZS52YWx1ZSA9IHRJY3U7CiAgfQp9CmZ1bmN0aW9uIHNldFROb2RlSW5zZXJ0QmVmb3JlSW5kZXgodE5vZGUsIGluZGV4KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlKHROb2RlKTsKICBsZXQgaW5zZXJ0QmVmb3JlSW5kZXggPSB0Tm9kZS5pbnNlcnRCZWZvcmVJbmRleDsKICBpZiAoaW5zZXJ0QmVmb3JlSW5kZXggPT09IG51bGwpIHsKICAgIHNldEkxOG5IYW5kbGluZyhnZXRJbnNlcnRJbkZyb250T2ZSTm9kZVdpdGhJMThuLCBwcm9jZXNzSTE4bkluc2VydEJlZm9yZSk7CiAgICBpbnNlcnRCZWZvcmVJbmRleCA9IHROb2RlLmluc2VydEJlZm9yZUluZGV4ID0gW251bGwsIGluZGV4XTsKICB9IGVsc2UgewogICAgYXNzZXJ0RXF1YWwoQXJyYXkuaXNBcnJheShpbnNlcnRCZWZvcmVJbmRleCksIHRydWUsICJFeHBlY3RpbmcgYXJyYXkgaGVyZSIpOwogICAgaW5zZXJ0QmVmb3JlSW5kZXgucHVzaChpbmRleCk7CiAgfQp9CmZ1bmN0aW9uIGNyZWF0ZVROb2RlUGxhY2Vob2xkZXIodFZpZXcsIHByZXZpb3VzVE5vZGVzLCBpbmRleCkgewogIGNvbnN0IHROb2RlID0gY3JlYXRlVE5vZGVBdEluZGV4KHRWaWV3LCBpbmRleCwgNjQsIG51bGwsIG51bGwpOwogIGFkZFROb2RlQW5kVXBkYXRlSW5zZXJ0QmVmb3JlSW5kZXgocHJldmlvdXNUTm9kZXMsIHROb2RlKTsKICByZXR1cm4gdE5vZGU7Cn0KZnVuY3Rpb24gZ2V0Q3VycmVudElDVUNhc2VJbmRleCh0SWN1LCBsVmlldykgewogIGNvbnN0IGN1cnJlbnRDYXNlID0gbFZpZXdbdEljdS5jdXJyZW50Q2FzZUxWaWV3SW5kZXhdOwogIHJldHVybiBjdXJyZW50Q2FzZSA9PT0gbnVsbCA/IGN1cnJlbnRDYXNlIDogY3VycmVudENhc2UgPCAwID8gfmN1cnJlbnRDYXNlIDogY3VycmVudENhc2U7Cn0KZnVuY3Rpb24gZ2V0UGFyZW50RnJvbUljdUNyZWF0ZU9wQ29kZShtZXJnZWRDb2RlKSB7CiAgcmV0dXJuIG1lcmdlZENvZGUgPj4+IDE3Owp9CmZ1bmN0aW9uIGdldFJlZkZyb21JY3VDcmVhdGVPcENvZGUobWVyZ2VkQ29kZSkgewogIHJldHVybiAobWVyZ2VkQ29kZSAmIDEzMTA3MCkgPj4+IDE7Cn0KZnVuY3Rpb24gZ2V0SW5zdHJ1Y3Rpb25Gcm9tSWN1Q3JlYXRlT3BDb2RlKG1lcmdlZENvZGUpIHsKICByZXR1cm4gbWVyZ2VkQ29kZSAmIDE7Cn0KZnVuY3Rpb24gaWN1Q3JlYXRlT3BDb2RlKG9wQ29kZSwgcGFyZW50SWR4LCByZWZJZHgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0R3JlYXRlclRoYW5PckVxdWFsKHBhcmVudElkeCwgMCwgIk1pc3NpbmcgcGFyZW50IGluZGV4Iik7CiAgbmdEZXZNb2RlICYmIGFzc2VydEdyZWF0ZXJUaGFuKHJlZklkeCwgMCwgIk1pc3NpbmcgcmVmIGluZGV4Iik7CiAgcmV0dXJuIG9wQ29kZSB8IHBhcmVudElkeCA8PCAxNyB8IHJlZklkeCA8PCAxOwp9CmZ1bmN0aW9uIGlzUm9vdFRlbXBsYXRlTWVzc2FnZShzdWJUZW1wbGF0ZUluZGV4KSB7CiAgcmV0dXJuIHN1YlRlbXBsYXRlSW5kZXggPT09IC0xOwp9CmZ1bmN0aW9uIGVudGVySWN1KHN0YXRlLCB0SWN1LCBsVmlldykgewogIHN0YXRlLmluZGV4ID0gMDsKICBjb25zdCBjdXJyZW50Q2FzZSA9IGdldEN1cnJlbnRJQ1VDYXNlSW5kZXgodEljdSwgbFZpZXcpOwogIGlmIChjdXJyZW50Q2FzZSAhPT0gbnVsbCkgewogICAgbmdEZXZNb2RlICYmIGFzc2VydE51bWJlckluUmFuZ2UoY3VycmVudENhc2UsIDAsIHRJY3UuY2FzZXMubGVuZ3RoIC0gMSk7CiAgICBzdGF0ZS5yZW1vdmVzID0gdEljdS5yZW1vdmVbY3VycmVudENhc2VdOwogIH0gZWxzZSB7CiAgICBzdGF0ZS5yZW1vdmVzID0gRU1QVFlfQVJSQVk7CiAgfQp9CmZ1bmN0aW9uIGljdUNvbnRhaW5lckl0ZXJhdG9yTmV4dChzdGF0ZSkgewogIGlmIChzdGF0ZS5pbmRleCA8IHN0YXRlLnJlbW92ZXMubGVuZ3RoKSB7CiAgICBjb25zdCByZW1vdmVPcENvZGUgPSBzdGF0ZS5yZW1vdmVzW3N0YXRlLmluZGV4KytdOwogICAgbmdEZXZNb2RlICYmIGFzc2VydE51bWJlcihyZW1vdmVPcENvZGUsICJFeHBlY3RpbmcgT3BDb2RlIG51bWJlciIpOwogICAgaWYgKHJlbW92ZU9wQ29kZSA+IDApIHsKICAgICAgY29uc3Qgck5vZGUgPSBzdGF0ZS5sVmlld1tyZW1vdmVPcENvZGVdOwogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RG9tTm9kZShyTm9kZSk7CiAgICAgIHJldHVybiByTm9kZTsKICAgIH0gZWxzZSB7CiAgICAgIHN0YXRlLnN0YWNrLnB1c2goc3RhdGUuaW5kZXgsIHN0YXRlLnJlbW92ZXMpOwogICAgICBjb25zdCB0SWN1SW5kZXggPSB+cmVtb3ZlT3BDb2RlOwogICAgICBjb25zdCB0SWN1ID0gc3RhdGUubFZpZXdbVFZJRVddLmRhdGFbdEljdUluZGV4XTsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydFRJY3UodEljdSk7CiAgICAgIGVudGVySWN1KHN0YXRlLCB0SWN1LCBzdGF0ZS5sVmlldyk7CiAgICAgIHJldHVybiBpY3VDb250YWluZXJJdGVyYXRvck5leHQoc3RhdGUpOwogICAgfQogIH0gZWxzZSB7CiAgICBpZiAoc3RhdGUuc3RhY2subGVuZ3RoID09PSAwKSB7CiAgICAgIHN0YXRlLmxWaWV3ID0gdm9pZCAwOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHN0YXRlLnJlbW92ZXMgPSBzdGF0ZS5zdGFjay5wb3AoKTsKICAgICAgc3RhdGUuaW5kZXggPSBzdGF0ZS5zdGFjay5wb3AoKTsKICAgICAgcmV0dXJuIGljdUNvbnRhaW5lckl0ZXJhdG9yTmV4dChzdGF0ZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGxvYWRJY3VDb250YWluZXJWaXNpdG9yKCkgewogIGNvbnN0IF9zdGF0ZSA9IHsKICAgIHN0YWNrOiBbXSwKICAgIGluZGV4OiAtMQogIH07CiAgZnVuY3Rpb24gaWN1Q29udGFpbmVySXRlcmF0b3JTdGFydCh0SWN1Q29udGFpbmVyTm9kZSwgbFZpZXcpIHsKICAgIF9zdGF0ZS5sVmlldyA9IGxWaWV3OwogICAgd2hpbGUgKF9zdGF0ZS5zdGFjay5sZW5ndGgpIF9zdGF0ZS5zdGFjay5wb3AoKTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZUZvckxWaWV3KHRJY3VDb250YWluZXJOb2RlLCBsVmlldyk7CiAgICBlbnRlckljdShfc3RhdGUsIHRJY3VDb250YWluZXJOb2RlLnZhbHVlLCBsVmlldyk7CiAgICByZXR1cm4gaWN1Q29udGFpbmVySXRlcmF0b3JOZXh0LmJpbmQobnVsbCwgX3N0YXRlKTsKICB9CiAgcmV0dXJuIGljdUNvbnRhaW5lckl0ZXJhdG9yU3RhcnQ7Cn0KZnVuY3Rpb24gY3JlYXRlSWN1SXRlcmF0b3IodEljdSwgbFZpZXcpIHsKICBjb25zdCBzdGF0ZSA9IHsKICAgIHN0YWNrOiBbXSwKICAgIGluZGV4OiAtMSwKICAgIGxWaWV3CiAgfTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VEljdSh0SWN1KTsKICBlbnRlckljdShzdGF0ZSwgdEljdSwgbFZpZXcpOwogIHJldHVybiBpY3VDb250YWluZXJJdGVyYXRvck5leHQuYmluZChudWxsLCBzdGF0ZSk7Cn0KdmFyIFJFRl9FWFRSQUNUT1JfUkVHRVhQID0gKCgpID0+IHsKICByZXR1cm4gbmV3IFJlZ0V4cChgXihcXGQrKSooJHtSRUZFUkVOQ0VfTk9ERV9CT0RZfXwke1JFRkVSRU5DRV9OT0RFX0hPU1R9KSooLiopYCk7Cn0pKCk7CmZ1bmN0aW9uIGNvbXByZXNzTm9kZUxvY2F0aW9uKHJlZmVyZW5jZU5vZGUsIHBhdGgpIHsKICBjb25zdCByZXN1bHQgPSBbcmVmZXJlbmNlTm9kZV07CiAgZm9yIChjb25zdCBzZWdtZW50IG9mIHBhdGgpIHsKICAgIGNvbnN0IGxhc3RJZHggPSByZXN1bHQubGVuZ3RoIC0gMTsKICAgIGlmIChsYXN0SWR4ID4gMCAmJiByZXN1bHRbbGFzdElkeCAtIDFdID09PSBzZWdtZW50KSB7CiAgICAgIGNvbnN0IHZhbHVlID0gcmVzdWx0W2xhc3RJZHhdIHx8IDE7CiAgICAgIHJlc3VsdFtsYXN0SWR4XSA9IHZhbHVlICsgMTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5wdXNoKHNlZ21lbnQsICIiKTsKICAgIH0KICB9CiAgcmV0dXJuIHJlc3VsdC5qb2luKCIiKTsKfQpmdW5jdGlvbiBkZWNvbXByZXNzTm9kZUxvY2F0aW9uKHBhdGgpIHsKICBjb25zdCBtYXRjaGVzID0gcGF0aC5tYXRjaChSRUZfRVhUUkFDVE9SX1JFR0VYUCk7CiAgY29uc3QgW18sIHJlZk5vZGVJZCwgcmVmTm9kZU5hbWUsIHJlc3RdID0gbWF0Y2hlczsKICBjb25zdCByZWYgPSByZWZOb2RlSWQgPyBwYXJzZUludChyZWZOb2RlSWQsIDEwKSA6IHJlZk5vZGVOYW1lOwogIGNvbnN0IHN0ZXBzID0gW107CiAgZm9yIChjb25zdCBbXzIsIHN0ZXAsIGNvdW50Ml0gb2YgcmVzdC5tYXRjaEFsbCgvKGZ8bikoXGQqKS9nKSkgewogICAgY29uc3QgcmVwZWF0MiA9IHBhcnNlSW50KGNvdW50MiwgMTApIHx8IDE7CiAgICBzdGVwcy5wdXNoKHN0ZXAsIHJlcGVhdDIpOwogIH0KICByZXR1cm4gW3JlZiwgLi4uc3RlcHNdOwp9CmZ1bmN0aW9uIGlzRmlyc3RFbGVtZW50SW5OZ0NvbnRhaW5lcih0Tm9kZSkgewogIHJldHVybiAhdE5vZGUucHJldiAmJiB0Tm9kZS5wYXJlbnQ/LnR5cGUgPT09IDg7Cn0KZnVuY3Rpb24gZ2V0Tm9PZmZzZXRJbmRleCh0Tm9kZSkgewogIHJldHVybiB0Tm9kZS5pbmRleCAtIEhFQURFUl9PRkZTRVQ7Cn0KZnVuY3Rpb24gaXNEaXNjb25uZWN0ZWROb2RlKHROb2RlLCBsVmlldykgewogIHJldHVybiAhKHROb2RlLnR5cGUgJiAoMTYgfCAxMjgpKSAmJiAhIWxWaWV3W3ROb2RlLmluZGV4XSAmJiBpc0Rpc2Nvbm5lY3RlZFJOb2RlKHVud3JhcFJOb2RlKGxWaWV3W3ROb2RlLmluZGV4XSkpOwp9CmZ1bmN0aW9uIGlzRGlzY29ubmVjdGVkUk5vZGUock5vZGUpIHsKICByZXR1cm4gISFyTm9kZSAmJiAhck5vZGUuaXNDb25uZWN0ZWQ7Cn0KZnVuY3Rpb24gbG9jYXRlSTE4blJOb2RlQnlJbmRleChoeWRyYXRpb25JbmZvLCBub09mZnNldEluZGV4KSB7CiAgY29uc3QgaTE4bk5vZGVzID0gaHlkcmF0aW9uSW5mby5pMThuTm9kZXM7CiAgaWYgKGkxOG5Ob2RlcykgewogICAgcmV0dXJuIGkxOG5Ob2Rlcy5nZXQobm9PZmZzZXRJbmRleCk7CiAgfQogIHJldHVybiB2b2lkIDA7Cn0KZnVuY3Rpb24gdHJ5TG9jYXRlUk5vZGVCeVBhdGgoaHlkcmF0aW9uSW5mbywgbFZpZXcsIG5vT2Zmc2V0SW5kZXgpIHsKICBjb25zdCBub2RlcyA9IGh5ZHJhdGlvbkluZm8uZGF0YVtOT0RFU107CiAgY29uc3QgcGF0aCA9IG5vZGVzPy5bbm9PZmZzZXRJbmRleF07CiAgcmV0dXJuIHBhdGggPyBsb2NhdGVSTm9kZUJ5UGF0aChwYXRoLCBsVmlldykgOiBudWxsOwp9CmZ1bmN0aW9uIGxvY2F0ZU5leHRSTm9kZShoeWRyYXRpb25JbmZvLCB0VmlldywgbFZpZXcsIHROb2RlKSB7CiAgY29uc3Qgbm9PZmZzZXRJbmRleCA9IGdldE5vT2Zmc2V0SW5kZXgodE5vZGUpOwogIGxldCBuYXRpdmUgPSBsb2NhdGVJMThuUk5vZGVCeUluZGV4KGh5ZHJhdGlvbkluZm8sIG5vT2Zmc2V0SW5kZXgpOwogIGlmIChuYXRpdmUgPT09IHZvaWQgMCkgewogICAgY29uc3Qgbm9kZXMgPSBoeWRyYXRpb25JbmZvLmRhdGFbTk9ERVNdOwogICAgaWYgKG5vZGVzPy5bbm9PZmZzZXRJbmRleF0pIHsKICAgICAgbmF0aXZlID0gbG9jYXRlUk5vZGVCeVBhdGgobm9kZXNbbm9PZmZzZXRJbmRleF0sIGxWaWV3KTsKICAgIH0gZWxzZSBpZiAodFZpZXcuZmlyc3RDaGlsZCA9PT0gdE5vZGUpIHsKICAgICAgbmF0aXZlID0gaHlkcmF0aW9uSW5mby5maXJzdENoaWxkOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgcHJldmlvdXNUTm9kZVBhcmVudCA9IHROb2RlLnByZXYgPT09IG51bGw7CiAgICAgIGNvbnN0IHByZXZpb3VzVE5vZGUgPSB0Tm9kZS5wcmV2ID8/IHROb2RlLnBhcmVudDsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQocHJldmlvdXNUTm9kZSwgIlVuZXhwZWN0ZWQgc3RhdGU6IGN1cnJlbnQgVE5vZGUgZG9lcyBub3QgaGF2ZSBhIGNvbm5lY3Rpb24gdG8gdGhlIHByZXZpb3VzIG5vZGUgb3IgYSBwYXJlbnQgbm9kZS4iKTsKICAgICAgaWYgKGlzRmlyc3RFbGVtZW50SW5OZ0NvbnRhaW5lcih0Tm9kZSkpIHsKICAgICAgICBjb25zdCBub09mZnNldFBhcmVudEluZGV4ID0gZ2V0Tm9PZmZzZXRJbmRleCh0Tm9kZS5wYXJlbnQpOwogICAgICAgIG5hdGl2ZSA9IGdldFNlZ21lbnRIZWFkKGh5ZHJhdGlvbkluZm8sIG5vT2Zmc2V0UGFyZW50SW5kZXgpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBwcmV2aW91c1JFbGVtZW50ID0gZ2V0TmF0aXZlQnlUTm9kZShwcmV2aW91c1ROb2RlLCBsVmlldyk7CiAgICAgICAgaWYgKHByZXZpb3VzVE5vZGVQYXJlbnQpIHsKICAgICAgICAgIG5hdGl2ZSA9IHByZXZpb3VzUkVsZW1lbnQuZmlyc3RDaGlsZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3Qgbm9PZmZzZXRQcmV2U2libGluZ0luZGV4ID0gZ2V0Tm9PZmZzZXRJbmRleChwcmV2aW91c1ROb2RlKTsKICAgICAgICAgIGNvbnN0IHNlZ21lbnRIZWFkID0gZ2V0U2VnbWVudEhlYWQoaHlkcmF0aW9uSW5mbywgbm9PZmZzZXRQcmV2U2libGluZ0luZGV4KTsKICAgICAgICAgIGlmIChwcmV2aW91c1ROb2RlLnR5cGUgPT09IDIgJiYgc2VnbWVudEhlYWQpIHsKICAgICAgICAgICAgY29uc3QgbnVtUm9vdE5vZGVzVG9Ta2lwID0gY2FsY1NlcmlhbGl6ZWRDb250YWluZXJTaXplKGh5ZHJhdGlvbkluZm8sIG5vT2Zmc2V0UHJldlNpYmxpbmdJbmRleCk7CiAgICAgICAgICAgIGNvbnN0IG5vZGVzVG9Ta2lwID0gbnVtUm9vdE5vZGVzVG9Ta2lwICsgMTsKICAgICAgICAgICAgbmF0aXZlID0gc2libGluZ0FmdGVyKG5vZGVzVG9Ta2lwLCBzZWdtZW50SGVhZCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuYXRpdmUgPSBwcmV2aW91c1JFbGVtZW50Lm5leHRTaWJsaW5nOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICByZXR1cm4gbmF0aXZlOwp9CmZ1bmN0aW9uIHNpYmxpbmdBZnRlcihza2lwMiwgZnJvbTIpIHsKICBsZXQgY3VycmVudE5vZGUgPSBmcm9tMjsKICBmb3IgKGxldCBpID0gMDsgaSA8IHNraXAyOyBpKyspIHsKICAgIG5nRGV2TW9kZSAmJiB2YWxpZGF0ZVNpYmxpbmdOb2RlRXhpc3RzKGN1cnJlbnROb2RlKTsKICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dFNpYmxpbmc7CiAgfQogIHJldHVybiBjdXJyZW50Tm9kZTsKfQpmdW5jdGlvbiBzdHJpbmdpZnlOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucykgewogIGNvbnN0IGNvbnRhaW5lciA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgaW5zdHJ1Y3Rpb25zLmxlbmd0aDsgaSArPSAyKSB7CiAgICBjb25zdCBzdGVwID0gaW5zdHJ1Y3Rpb25zW2ldOwogICAgY29uc3QgcmVwZWF0MiA9IGluc3RydWN0aW9uc1tpICsgMV07CiAgICBmb3IgKGxldCByID0gMDsgciA8IHJlcGVhdDI7IHIrKykgewogICAgICBjb250YWluZXIucHVzaChzdGVwID09PSBOT0RFX05BVklHQVRJT05fU1RFUF9GSVJTVF9DSElMRCA/ICJmaXJzdENoaWxkIiA6ICJuZXh0U2libGluZyIpOwogICAgfQogIH0KICByZXR1cm4gY29udGFpbmVyLmpvaW4oIi4iKTsKfQpmdW5jdGlvbiBuYXZpZ2F0ZVRvTm9kZShmcm9tMiwgaW5zdHJ1Y3Rpb25zKSB7CiAgbGV0IG5vZGUgPSBmcm9tMjsKICBmb3IgKGxldCBpID0gMDsgaSA8IGluc3RydWN0aW9ucy5sZW5ndGg7IGkgKz0gMikgewogICAgY29uc3Qgc3RlcCA9IGluc3RydWN0aW9uc1tpXTsKICAgIGNvbnN0IHJlcGVhdDIgPSBpbnN0cnVjdGlvbnNbaSArIDFdOwogICAgZm9yIChsZXQgciA9IDA7IHIgPCByZXBlYXQyOyByKyspIHsKICAgICAgaWYgKG5nRGV2TW9kZSAmJiAhbm9kZSkgewogICAgICAgIHRocm93IG5vZGVOb3RGb3VuZEF0UGF0aEVycm9yKGZyb20yLCBzdHJpbmdpZnlOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucykpOwogICAgICB9CiAgICAgIHN3aXRjaCAoc3RlcCkgewogICAgICAgIGNhc2UgTk9ERV9OQVZJR0FUSU9OX1NURVBfRklSU1RfQ0hJTEQ6CiAgICAgICAgICBub2RlID0gbm9kZS5maXJzdENoaWxkOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBOT0RFX05BVklHQVRJT05fU1RFUF9ORVhUX1NJQkxJTkc6CiAgICAgICAgICBub2RlID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQogIGlmIChuZ0Rldk1vZGUgJiYgIW5vZGUpIHsKICAgIHRocm93IG5vZGVOb3RGb3VuZEF0UGF0aEVycm9yKGZyb20yLCBzdHJpbmdpZnlOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucykpOwogIH0KICByZXR1cm4gbm9kZTsKfQpmdW5jdGlvbiBsb2NhdGVSTm9kZUJ5UGF0aChwYXRoLCBsVmlldykgewogIGNvbnN0IFtyZWZlcmVuY2VOb2RlLCAuLi5uYXZpZ2F0aW9uSW5zdHJ1Y3Rpb25zXSA9IGRlY29tcHJlc3NOb2RlTG9jYXRpb24ocGF0aCk7CiAgbGV0IHJlZjsKICBpZiAocmVmZXJlbmNlTm9kZSA9PT0gUkVGRVJFTkNFX05PREVfSE9TVCkgewogICAgcmVmID0gbFZpZXdbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddW0hPU1RdOwogIH0gZWxzZSBpZiAocmVmZXJlbmNlTm9kZSA9PT0gUkVGRVJFTkNFX05PREVfQk9EWSkgewogICAgcmVmID0gybXJtXJlc29sdmVCb2R5KGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXVtIT1NUXSk7CiAgfSBlbHNlIHsKICAgIGNvbnN0IHBhcmVudEVsZW1lbnRJZCA9IE51bWJlcihyZWZlcmVuY2VOb2RlKTsKICAgIHJlZiA9IHVud3JhcFJOb2RlKGxWaWV3W3BhcmVudEVsZW1lbnRJZCArIEhFQURFUl9PRkZTRVRdKTsKICB9CiAgcmV0dXJuIG5hdmlnYXRlVG9Ob2RlKHJlZiwgbmF2aWdhdGlvbkluc3RydWN0aW9ucyk7Cn0KZnVuY3Rpb24gbmF2aWdhdGVCZXR3ZWVuKHN0YXJ0LCBmaW5pc2gpIHsKICBpZiAoc3RhcnQgPT09IGZpbmlzaCkgewogICAgcmV0dXJuIFtdOwogIH0gZWxzZSBpZiAoc3RhcnQucGFyZW50RWxlbWVudCA9PSBudWxsIHx8IGZpbmlzaC5wYXJlbnRFbGVtZW50ID09IG51bGwpIHsKICAgIHJldHVybiBudWxsOwogIH0gZWxzZSBpZiAoc3RhcnQucGFyZW50RWxlbWVudCA9PT0gZmluaXNoLnBhcmVudEVsZW1lbnQpIHsKICAgIHJldHVybiBuYXZpZ2F0ZUJldHdlZW5TaWJsaW5ncyhzdGFydCwgZmluaXNoKTsKICB9IGVsc2UgewogICAgY29uc3QgcGFyZW50ID0gZmluaXNoLnBhcmVudEVsZW1lbnQ7CiAgICBjb25zdCBwYXJlbnRQYXRoID0gbmF2aWdhdGVCZXR3ZWVuKHN0YXJ0LCBwYXJlbnQpOwogICAgY29uc3QgY2hpbGRQYXRoID0gbmF2aWdhdGVCZXR3ZWVuKHBhcmVudC5maXJzdENoaWxkLCBmaW5pc2gpOwogICAgaWYgKCFwYXJlbnRQYXRoIHx8ICFjaGlsZFBhdGgpIHJldHVybiBudWxsOwogICAgcmV0dXJuIFsuLi5wYXJlbnRQYXRoLCBOT0RFX05BVklHQVRJT05fU1RFUF9GSVJTVF9DSElMRCwgLi4uY2hpbGRQYXRoXTsKICB9Cn0KZnVuY3Rpb24gbmF2aWdhdGVCZXR3ZWVuU2libGluZ3Moc3RhcnQsIGZpbmlzaCkgewogIGNvbnN0IG5hdiA9IFtdOwogIGxldCBub2RlID0gbnVsbDsKICBmb3IgKG5vZGUgPSBzdGFydDsgbm9kZSAhPSBudWxsICYmIG5vZGUgIT09IGZpbmlzaDsgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpIHsKICAgIG5hdi5wdXNoKE5PREVfTkFWSUdBVElPTl9TVEVQX05FWFRfU0lCTElORyk7CiAgfQogIHJldHVybiBub2RlID09IG51bGwgPyBudWxsIDogbmF2Owp9CmZ1bmN0aW9uIGNhbGNQYXRoQmV0d2Vlbihmcm9tMiwgdG8sIGZyb21Ob2RlTmFtZSkgewogIGNvbnN0IHBhdGggPSBuYXZpZ2F0ZUJldHdlZW4oZnJvbTIsIHRvKTsKICByZXR1cm4gcGF0aCA9PT0gbnVsbCA/IG51bGwgOiBjb21wcmVzc05vZGVMb2NhdGlvbihmcm9tTm9kZU5hbWUsIHBhdGgpOwp9CmZ1bmN0aW9uIGNhbGNQYXRoRm9yTm9kZSh0Tm9kZSwgbFZpZXcsIGV4Y2x1ZGVkUGFyZW50Tm9kZXMpIHsKICBsZXQgcGFyZW50VE5vZGUgPSB0Tm9kZS5wYXJlbnQ7CiAgbGV0IHBhcmVudEluZGV4OwogIGxldCBwYXJlbnRSTm9kZTsKICBsZXQgcmVmZXJlbmNlTm9kZU5hbWU7CiAgd2hpbGUgKHBhcmVudFROb2RlICE9PSBudWxsICYmIChpc0Rpc2Nvbm5lY3RlZE5vZGUocGFyZW50VE5vZGUsIGxWaWV3KSB8fCBleGNsdWRlZFBhcmVudE5vZGVzPy5oYXMocGFyZW50VE5vZGUuaW5kZXgpKSkgewogICAgcGFyZW50VE5vZGUgPSBwYXJlbnRUTm9kZS5wYXJlbnQ7CiAgfQogIGlmIChwYXJlbnRUTm9kZSA9PT0gbnVsbCB8fCAhKHBhcmVudFROb2RlLnR5cGUgJiAzKSkgewogICAgcGFyZW50SW5kZXggPSByZWZlcmVuY2VOb2RlTmFtZSA9IFJFRkVSRU5DRV9OT0RFX0hPU1Q7CiAgICBwYXJlbnRSTm9kZSA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXVtIT1NUXTsKICB9IGVsc2UgewogICAgcGFyZW50SW5kZXggPSBwYXJlbnRUTm9kZS5pbmRleDsKICAgIHBhcmVudFJOb2RlID0gdW53cmFwUk5vZGUobFZpZXdbcGFyZW50SW5kZXhdKTsKICAgIHJlZmVyZW5jZU5vZGVOYW1lID0gcmVuZGVyU3RyaW5naWZ5KHBhcmVudEluZGV4IC0gSEVBREVSX09GRlNFVCk7CiAgfQogIGxldCByTm9kZSA9IHVud3JhcFJOb2RlKGxWaWV3W3ROb2RlLmluZGV4XSk7CiAgaWYgKHROb2RlLnR5cGUgJiAoMTIgfCAzMikpIHsKICAgIGNvbnN0IGZpcnN0Uk5vZGUgPSBnZXRGaXJzdE5hdGl2ZU5vZGUobFZpZXcsIHROb2RlKTsKICAgIGlmIChmaXJzdFJOb2RlKSB7CiAgICAgIHJOb2RlID0gZmlyc3RSTm9kZTsKICAgIH0KICB9CiAgbGV0IHBhdGggPSBjYWxjUGF0aEJldHdlZW4ocGFyZW50Uk5vZGUsIHJOb2RlLCByZWZlcmVuY2VOb2RlTmFtZSk7CiAgaWYgKHBhdGggPT09IG51bGwgJiYgcGFyZW50Uk5vZGUgIT09IHJOb2RlKSB7CiAgICBjb25zdCBib2R5ID0gcGFyZW50Uk5vZGUub3duZXJEb2N1bWVudC5ib2R5OwogICAgcGF0aCA9IGNhbGNQYXRoQmV0d2Vlbihib2R5LCByTm9kZSwgUkVGRVJFTkNFX05PREVfQk9EWSk7CiAgICBpZiAocGF0aCA9PT0gbnVsbCkgewogICAgICB0aHJvdyBub2RlTm90Rm91bmRFcnJvcihsVmlldywgdE5vZGUpOwogICAgfQogIH0KICByZXR1cm4gcGF0aDsKfQpmdW5jdGlvbiBnYXRoZXJEZWZlckJsb2Nrc0NvbW1lbnROb2Rlcyhkb2MsIG5vZGUpIHsKICBjb25zdCBjb21tZW50Tm9kZXNJdGVyYXRvciA9IGRvYy5jcmVhdGVOb2RlSXRlcmF0b3Iobm9kZSwgTm9kZUZpbHRlci5TSE9XX0NPTU1FTlQsIHsKICAgIGFjY2VwdE5vZGUKICB9KTsKICBsZXQgY3VycmVudE5vZGU7CiAgY29uc3Qgbm9kZXNCeUJsb2NrSWQgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHdoaWxlIChjdXJyZW50Tm9kZSA9IGNvbW1lbnROb2Rlc0l0ZXJhdG9yLm5leHROb2RlKCkpIHsKICAgIGNvbnN0IG5naFBhdHRlcm4gPSAibmdoPSI7CiAgICBjb25zdCBjb250ZW50ID0gY3VycmVudE5vZGU/LnRleHRDb250ZW50OwogICAgY29uc3QgbmdoSWR4ID0gY29udGVudD8uaW5kZXhPZihuZ2hQYXR0ZXJuKSA/PyAtMTsKICAgIGlmIChuZ2hJZHggPiAtMSkgewogICAgICBjb25zdCBuZ2hWYWx1ZSA9IGNvbnRlbnQuc3Vic3RyaW5nKG5naElkeCArIG5naFBhdHRlcm4ubGVuZ3RoKS50cmltKCk7CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChuZ2hWYWx1ZS5zdGFydHNXaXRoKCJkIiksIHRydWUsICJJbnZhbGlkIGRlZmVyIGJsb2NrIGlkIGZvdW5kIGluIGEgY29tbWVudCBub2RlLiIpOwogICAgICBub2Rlc0J5QmxvY2tJZC5zZXQobmdoVmFsdWUsIGN1cnJlbnROb2RlKTsKICAgIH0KICB9CiAgcmV0dXJuIG5vZGVzQnlCbG9ja0lkOwp9CmZ1bmN0aW9uIGFjY2VwdE5vZGUobm9kZSkgewogIHJldHVybiBub2RlLnRleHRDb250ZW50Py50cmltU3RhcnQoKS5zdGFydHNXaXRoKCJuZ2g9IikgPyBOb2RlRmlsdGVyLkZJTFRFUl9BQ0NFUFQgOiBOb2RlRmlsdGVyLkZJTFRFUl9SRUpFQ1Q7Cn0KdmFyIF9pc0kxOG5IeWRyYXRpb25TdXBwb3J0RW5hYmxlZCA9IGZhbHNlOwp2YXIgX3ByZXBhcmVJMThuQmxvY2tGb3JIeWRyYXRpb25JbXBsID0gKCkgPT4gewp9OwpmdW5jdGlvbiBzZXRJc0kxOG5IeWRyYXRpb25TdXBwb3J0RW5hYmxlZChlbmFibGVkKSB7CiAgX2lzSTE4bkh5ZHJhdGlvblN1cHBvcnRFbmFibGVkID0gZW5hYmxlZDsKfQpmdW5jdGlvbiBpc0kxOG5IeWRyYXRpb25TdXBwb3J0RW5hYmxlZCgpIHsKICByZXR1cm4gX2lzSTE4bkh5ZHJhdGlvblN1cHBvcnRFbmFibGVkOwp9CmZ1bmN0aW9uIHByZXBhcmVJMThuQmxvY2tGb3JIeWRyYXRpb24obFZpZXcsIGluZGV4LCBwYXJlbnRUTm9kZSwgc3ViVGVtcGxhdGVJbmRleCkgewogIF9wcmVwYXJlSTE4bkJsb2NrRm9ySHlkcmF0aW9uSW1wbChsVmlldywgaW5kZXgsIHBhcmVudFROb2RlLCBzdWJUZW1wbGF0ZUluZGV4KTsKfQpmdW5jdGlvbiBlbmFibGVQcmVwYXJlSTE4bkJsb2NrRm9ySHlkcmF0aW9uSW1wbCgpIHsKICBfcHJlcGFyZUkxOG5CbG9ja0Zvckh5ZHJhdGlvbkltcGwgPSBwcmVwYXJlSTE4bkJsb2NrRm9ySHlkcmF0aW9uSW1wbDsKfQpmdW5jdGlvbiBpc0kxOG5IeWRyYXRpb25FbmFibGVkKGluamVjdG9yKSB7CiAgaW5qZWN0b3IgPSBpbmplY3RvciA/PyBpbmplY3QyKEluamVjdG9yKTsKICByZXR1cm4gaW5qZWN0b3IuZ2V0KElTX0kxOE5fSFlEUkFUSU9OX0VOQUJMRUQsIGZhbHNlKTsKfQpmdW5jdGlvbiBnZXRPckNvbXB1dGVJMThuQ2hpbGRyZW4odFZpZXcsIGNvbnRleHQyKSB7CiAgbGV0IGkxOG5DaGlsZHJlbiA9IGNvbnRleHQyLmkxOG5DaGlsZHJlbi5nZXQodFZpZXcpOwogIGlmIChpMThuQ2hpbGRyZW4gPT09IHZvaWQgMCkgewogICAgaTE4bkNoaWxkcmVuID0gY29sbGVjdEkxOG5DaGlsZHJlbih0Vmlldyk7CiAgICBjb250ZXh0Mi5pMThuQ2hpbGRyZW4uc2V0KHRWaWV3LCBpMThuQ2hpbGRyZW4pOwogIH0KICByZXR1cm4gaTE4bkNoaWxkcmVuOwp9CmZ1bmN0aW9uIGNvbGxlY3RJMThuQ2hpbGRyZW4odFZpZXcpIHsKICBjb25zdCBjaGlsZHJlbiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgZnVuY3Rpb24gY29sbGVjdEkxOG5WaWV3cyhub2RlKSB7CiAgICBjaGlsZHJlbi5hZGQobm9kZS5pbmRleCk7CiAgICBzd2l0Y2ggKG5vZGUua2luZCkgewogICAgICBjYXNlIDE6CiAgICAgIGNhc2UgMjogewogICAgICAgIGZvciAoY29uc3QgY2hpbGROb2RlIG9mIG5vZGUuY2hpbGRyZW4pIHsKICAgICAgICAgIGNvbGxlY3RJMThuVmlld3MoY2hpbGROb2RlKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAzOiB7CiAgICAgICAgZm9yIChjb25zdCBjYXNlTm9kZXMgb2Ygbm9kZS5jYXNlcykgewogICAgICAgICAgZm9yIChjb25zdCBjYXNlTm9kZSBvZiBjYXNlTm9kZXMpIHsKICAgICAgICAgICAgY29sbGVjdEkxOG5WaWV3cyhjYXNlTm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQogIGZvciAobGV0IGkgPSBIRUFERVJfT0ZGU0VUOyBpIDwgdFZpZXcuYmluZGluZ1N0YXJ0SW5kZXg7IGkrKykgewogICAgY29uc3QgdEkxOG4gPSB0Vmlldy5kYXRhW2ldOwogICAgaWYgKCF0STE4biB8fCAhdEkxOG4uYXN0KSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgZm9yIChjb25zdCBub2RlIG9mIHRJMThuLmFzdCkgewogICAgICBjb2xsZWN0STE4blZpZXdzKG5vZGUpOwogICAgfQogIH0KICByZXR1cm4gY2hpbGRyZW4uc2l6ZSA9PT0gMCA/IG51bGwgOiBjaGlsZHJlbjsKfQpmdW5jdGlvbiB0cnlTZXJpYWxpemVJMThuQmxvY2sobFZpZXcsIGluZGV4LCBjb250ZXh0MikgewogIGlmICghY29udGV4dDIuaXNJMThuSHlkcmF0aW9uRW5hYmxlZCkgewogICAgcmV0dXJuIG51bGw7CiAgfQogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IHRJMThuID0gdFZpZXcuZGF0YVtpbmRleF07CiAgaWYgKCF0STE4biB8fCAhdEkxOG4uYXN0KSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgY29uc3QgcGFyZW50VE5vZGUgPSB0Vmlldy5kYXRhW3RJMThuLnBhcmVudFROb2RlSW5kZXhdOwogIGlmIChwYXJlbnRUTm9kZSAmJiBpc0kxOG5JblNraXBIeWRyYXRpb25CbG9jayhwYXJlbnRUTm9kZSkpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBzZXJpYWxpemVkSTE4bkJsb2NrID0gewogICAgY2FzZVF1ZXVlOiBbXSwKICAgIGRpc2Nvbm5lY3RlZE5vZGVzOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpLAogICAgZGlzam9pbnROb2RlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKQogIH07CiAgc2VyaWFsaXplSTE4bkJsb2NrKGxWaWV3LCBzZXJpYWxpemVkSTE4bkJsb2NrLCBjb250ZXh0MiwgdEkxOG4uYXN0KTsKICByZXR1cm4gc2VyaWFsaXplZEkxOG5CbG9jay5jYXNlUXVldWUubGVuZ3RoID09PSAwICYmIHNlcmlhbGl6ZWRJMThuQmxvY2suZGlzY29ubmVjdGVkTm9kZXMuc2l6ZSA9PT0gMCAmJiBzZXJpYWxpemVkSTE4bkJsb2NrLmRpc2pvaW50Tm9kZXMuc2l6ZSA9PT0gMCA/IG51bGwgOiBzZXJpYWxpemVkSTE4bkJsb2NrOwp9CmZ1bmN0aW9uIHNlcmlhbGl6ZUkxOG5CbG9jayhsVmlldywgc2VyaWFsaXplZEkxOG5CbG9jaywgY29udGV4dDIsIG5vZGVzKSB7CiAgbGV0IHByZXZSTm9kZSA9IG51bGw7CiAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7CiAgICBjb25zdCBuZXh0Uk5vZGUgPSBzZXJpYWxpemVJMThuTm9kZShsVmlldywgc2VyaWFsaXplZEkxOG5CbG9jaywgY29udGV4dDIsIG5vZGUpOwogICAgaWYgKG5leHRSTm9kZSkgewogICAgICBpZiAoaXNEaXNqb2ludE5vZGUocHJldlJOb2RlLCBuZXh0Uk5vZGUpKSB7CiAgICAgICAgc2VyaWFsaXplZEkxOG5CbG9jay5kaXNqb2ludE5vZGVzLmFkZChub2RlLmluZGV4IC0gSEVBREVSX09GRlNFVCk7CiAgICAgIH0KICAgICAgcHJldlJOb2RlID0gbmV4dFJOb2RlOwogICAgfQogIH0KICByZXR1cm4gcHJldlJOb2RlOwp9CmZ1bmN0aW9uIGlzRGlzam9pbnROb2RlKHByZXZOb2RlLCBuZXh0Tm9kZSkgewogIHJldHVybiBwcmV2Tm9kZSAmJiBwcmV2Tm9kZS5uZXh0U2libGluZyAhPT0gbmV4dE5vZGU7Cn0KZnVuY3Rpb24gc2VyaWFsaXplSTE4bk5vZGUobFZpZXcsIHNlcmlhbGl6ZWRJMThuQmxvY2ssIGNvbnRleHQyLCBub2RlKSB7CiAgY29uc3QgbWF5YmVSTm9kZSA9IHVud3JhcFJOb2RlKGxWaWV3W25vZGUuaW5kZXhdKTsKICBpZiAoIW1heWJlUk5vZGUgfHwgaXNEaXNjb25uZWN0ZWRSTm9kZShtYXliZVJOb2RlKSkgewogICAgc2VyaWFsaXplZEkxOG5CbG9jay5kaXNjb25uZWN0ZWROb2Rlcy5hZGQobm9kZS5pbmRleCAtIEhFQURFUl9PRkZTRVQpOwogICAgcmV0dXJuIG51bGw7CiAgfQogIGNvbnN0IHJOb2RlID0gbWF5YmVSTm9kZTsKICBzd2l0Y2ggKG5vZGUua2luZCkgewogICAgY2FzZSAwOiB7CiAgICAgIHByb2Nlc3NUZXh0Tm9kZUJlZm9yZVNlcmlhbGl6YXRpb24oY29udGV4dDIsIHJOb2RlKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIDE6CiAgICBjYXNlIDI6IHsKICAgICAgc2VyaWFsaXplSTE4bkJsb2NrKGxWaWV3LCBzZXJpYWxpemVkSTE4bkJsb2NrLCBjb250ZXh0Miwgbm9kZS5jaGlsZHJlbik7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSAzOiB7CiAgICAgIGNvbnN0IGN1cnJlbnRDYXNlID0gbFZpZXdbbm9kZS5jdXJyZW50Q2FzZUxWaWV3SW5kZXhdOwogICAgICBpZiAoY3VycmVudENhc2UgIT0gbnVsbCkgewogICAgICAgIGNvbnN0IGNhc2VJZHggPSBjdXJyZW50Q2FzZSA8IDAgPyB+Y3VycmVudENhc2UgOiBjdXJyZW50Q2FzZTsKICAgICAgICBzZXJpYWxpemVkSTE4bkJsb2NrLmNhc2VRdWV1ZS5wdXNoKGNhc2VJZHgpOwogICAgICAgIHNlcmlhbGl6ZUkxOG5CbG9jayhsVmlldywgc2VyaWFsaXplZEkxOG5CbG9jaywgY29udGV4dDIsIG5vZGUuY2FzZXNbY2FzZUlkeF0pOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gZ2V0Rmlyc3ROYXRpdmVOb2RlRm9ySTE4bk5vZGUobFZpZXcsIG5vZGUpOwp9CmZ1bmN0aW9uIGdldEZpcnN0TmF0aXZlTm9kZUZvckkxOG5Ob2RlKGxWaWV3LCBub2RlKSB7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgbWF5YmVUTm9kZSA9IHRWaWV3LmRhdGFbbm9kZS5pbmRleF07CiAgaWYgKGlzVE5vZGVTaGFwZShtYXliZVROb2RlKSkgewogICAgcmV0dXJuIGdldEZpcnN0TmF0aXZlTm9kZShsVmlldywgbWF5YmVUTm9kZSk7CiAgfSBlbHNlIGlmIChub2RlLmtpbmQgPT09IDMpIHsKICAgIGNvbnN0IGljdUl0ZXJhdG9yID0gY3JlYXRlSWN1SXRlcmF0b3IobWF5YmVUTm9kZSwgbFZpZXcpOwogICAgbGV0IHJOb2RlID0gaWN1SXRlcmF0b3IoKTsKICAgIHJldHVybiByTm9kZSA/PyB1bndyYXBSTm9kZShsVmlld1tub2RlLmluZGV4XSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB1bndyYXBSTm9kZShsVmlld1tub2RlLmluZGV4XSkgPz8gbnVsbDsKICB9Cn0KZnVuY3Rpb24gc2V0Q3VycmVudE5vZGUoc3RhdGUsIG5vZGUpIHsKICBzdGF0ZS5jdXJyZW50Tm9kZSA9IG5vZGU7Cn0KZnVuY3Rpb24gYXBwZW5kSTE4bk5vZGVUb0NvbGxlY3Rpb24oY29udGV4dDIsIHN0YXRlLCBhc3ROb2RlKSB7CiAgY29uc3Qgbm9PZmZzZXRJbmRleCA9IGFzdE5vZGUuaW5kZXggLSBIRUFERVJfT0ZGU0VUOwogIGNvbnN0IHsKICAgIGRpc2Nvbm5lY3RlZE5vZGVzCiAgfSA9IGNvbnRleHQyOwogIGNvbnN0IGN1cnJlbnROb2RlID0gc3RhdGUuY3VycmVudE5vZGU7CiAgaWYgKHN0YXRlLmlzQ29ubmVjdGVkKSB7CiAgICBjb250ZXh0Mi5pMThuTm9kZXMuc2V0KG5vT2Zmc2V0SW5kZXgsIGN1cnJlbnROb2RlKTsKICAgIGRpc2Nvbm5lY3RlZE5vZGVzLmRlbGV0ZShub09mZnNldEluZGV4KTsKICB9IGVsc2UgewogICAgZGlzY29ubmVjdGVkTm9kZXMuYWRkKG5vT2Zmc2V0SW5kZXgpOwogIH0KICByZXR1cm4gY3VycmVudE5vZGU7Cn0KZnVuY3Rpb24gc2tpcFNpYmxpbmdOb2RlcyhzdGF0ZSwgc2tpcDIpIHsKICBsZXQgY3VycmVudE5vZGUgPSBzdGF0ZS5jdXJyZW50Tm9kZTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHNraXAyOyBpKyspIHsKICAgIGlmICghY3VycmVudE5vZGUpIHsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlPy5uZXh0U2libGluZyA/PyBudWxsOwogIH0KICByZXR1cm4gY3VycmVudE5vZGU7Cn0KZnVuY3Rpb24gZm9ya0h5ZHJhdGlvblN0YXRlKHN0YXRlLCBuZXh0Tm9kZSkgewogIHJldHVybiB7CiAgICBjdXJyZW50Tm9kZTogbmV4dE5vZGUsCiAgICBpc0Nvbm5lY3RlZDogc3RhdGUuaXNDb25uZWN0ZWQKICB9Owp9CmZ1bmN0aW9uIHByZXBhcmVJMThuQmxvY2tGb3JIeWRyYXRpb25JbXBsKGxWaWV3LCBpbmRleCwgcGFyZW50VE5vZGUsIHN1YlRlbXBsYXRlSW5kZXgpIHsKICBjb25zdCBoeWRyYXRpb25JbmZvID0gbFZpZXdbSFlEUkFUSU9OXTsKICBpZiAoIWh5ZHJhdGlvbkluZm8pIHsKICAgIHJldHVybjsKICB9CiAgaWYgKCFpc0kxOG5IeWRyYXRpb25TdXBwb3J0RW5hYmxlZCgpIHx8IHBhcmVudFROb2RlICYmIChpc0kxOG5JblNraXBIeWRyYXRpb25CbG9jayhwYXJlbnRUTm9kZSkgfHwgaXNEaXNjb25uZWN0ZWROb2RlJDEoaHlkcmF0aW9uSW5mbywgcGFyZW50VE5vZGUuaW5kZXggLSBIRUFERVJfT0ZGU0VUKSkpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgdEkxOG4gPSB0Vmlldy5kYXRhW2luZGV4XTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZCh0STE4biwgIkV4cGVjdGVkIGkxOG4gZGF0YSB0byBiZSBwcmVzZW50IGluIGEgZ2l2ZW4gVFZpZXcgc2xvdCBkdXJpbmcgaHlkcmF0aW9uIik7CiAgZnVuY3Rpb24gZmluZEh5ZHJhdGlvblJvb3QoKSB7CiAgICBpZiAoaXNSb290VGVtcGxhdGVNZXNzYWdlKHN1YlRlbXBsYXRlSW5kZXgpKSB7CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHBhcmVudFROb2RlLCAiRXhwZWN0ZWQgcGFyZW50IFROb2RlIHdoaWxlIGh5ZHJhdGluZyBpMThuIHJvb3QiKTsKICAgICAgY29uc3Qgcm9vdE5vZGUgPSBsb2NhdGVOZXh0Uk5vZGUoaHlkcmF0aW9uSW5mbywgdFZpZXcsIGxWaWV3LCBwYXJlbnRUTm9kZSk7CiAgICAgIHJldHVybiBwYXJlbnRUTm9kZS50eXBlICYgOCA/IHJvb3ROb2RlIDogcm9vdE5vZGUuZmlyc3RDaGlsZDsKICAgIH0KICAgIHJldHVybiBoeWRyYXRpb25JbmZvPy5maXJzdENoaWxkOwogIH0KICBjb25zdCBjdXJyZW50Tm9kZSA9IGZpbmRIeWRyYXRpb25Sb290KCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoY3VycmVudE5vZGUsICJFeHBlY3RlZCByb290IGkxOG4gbm9kZSBkdXJpbmcgaHlkcmF0aW9uIik7CiAgY29uc3QgZGlzY29ubmVjdGVkTm9kZXMgPSBpbml0RGlzY29ubmVjdGVkTm9kZXMoaHlkcmF0aW9uSW5mbykgPz8gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICBjb25zdCBpMThuTm9kZXMgPSBoeWRyYXRpb25JbmZvLmkxOG5Ob2RlcyA/Pz0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBjb25zdCBjYXNlUXVldWUgPSBoeWRyYXRpb25JbmZvLmRhdGFbSTE4Tl9EQVRBXT8uW2luZGV4IC0gSEVBREVSX09GRlNFVF0gPz8gW107CiAgY29uc3QgZGVoeWRyYXRlZEljdURhdGEgPSBoeWRyYXRpb25JbmZvLmRlaHlkcmF0ZWRJY3VEYXRhID8/PSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIGNvbGxlY3RJMThuTm9kZXNGcm9tRG9tKHsKICAgIGh5ZHJhdGlvbkluZm8sCiAgICBsVmlldywKICAgIGkxOG5Ob2RlcywKICAgIGRpc2Nvbm5lY3RlZE5vZGVzLAogICAgY2FzZVF1ZXVlLAogICAgZGVoeWRyYXRlZEljdURhdGEKICB9LCB7CiAgICBjdXJyZW50Tm9kZSwKICAgIGlzQ29ubmVjdGVkOiB0cnVlCiAgfSwgdEkxOG4uYXN0KTsKICBoeWRyYXRpb25JbmZvLmRpc2Nvbm5lY3RlZE5vZGVzID0gZGlzY29ubmVjdGVkTm9kZXMuc2l6ZSA9PT0gMCA/IG51bGwgOiBkaXNjb25uZWN0ZWROb2RlczsKfQpmdW5jdGlvbiBjb2xsZWN0STE4bk5vZGVzRnJvbURvbShjb250ZXh0Miwgc3RhdGUsIG5vZGVPck5vZGVzKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkobm9kZU9yTm9kZXMpKSB7CiAgICBsZXQgbmV4dFN0YXRlID0gc3RhdGU7CiAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZU9yTm9kZXMpIHsKICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IHRyeUxvY2F0ZVJOb2RlQnlQYXRoKGNvbnRleHQyLmh5ZHJhdGlvbkluZm8sIGNvbnRleHQyLmxWaWV3LCBub2RlLmluZGV4IC0gSEVBREVSX09GRlNFVCk7CiAgICAgIGlmICh0YXJnZXROb2RlKSB7CiAgICAgICAgbmV4dFN0YXRlID0gZm9ya0h5ZHJhdGlvblN0YXRlKHN0YXRlLCB0YXJnZXROb2RlKTsKICAgICAgfQogICAgICBjb2xsZWN0STE4bk5vZGVzRnJvbURvbShjb250ZXh0MiwgbmV4dFN0YXRlLCBub2RlKTsKICAgIH0KICB9IGVsc2UgewogICAgaWYgKGNvbnRleHQyLmRpc2Nvbm5lY3RlZE5vZGVzLmhhcyhub2RlT3JOb2Rlcy5pbmRleCAtIEhFQURFUl9PRkZTRVQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHN3aXRjaCAobm9kZU9yTm9kZXMua2luZCkgewogICAgICBjYXNlIDA6IHsKICAgICAgICBjb25zdCBjdXJyZW50Tm9kZSA9IGFwcGVuZEkxOG5Ob2RlVG9Db2xsZWN0aW9uKGNvbnRleHQyLCBzdGF0ZSwgbm9kZU9yTm9kZXMpOwogICAgICAgIHNldEN1cnJlbnROb2RlKHN0YXRlLCBjdXJyZW50Tm9kZT8ubmV4dFNpYmxpbmcgPz8gbnVsbCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAxOiB7CiAgICAgICAgY29sbGVjdEkxOG5Ob2Rlc0Zyb21Eb20oY29udGV4dDIsIGZvcmtIeWRyYXRpb25TdGF0ZShzdGF0ZSwgc3RhdGUuY3VycmVudE5vZGU/LmZpcnN0Q2hpbGQgPz8gbnVsbCksIG5vZGVPck5vZGVzLmNoaWxkcmVuKTsKICAgICAgICBjb25zdCBjdXJyZW50Tm9kZSA9IGFwcGVuZEkxOG5Ob2RlVG9Db2xsZWN0aW9uKGNvbnRleHQyLCBzdGF0ZSwgbm9kZU9yTm9kZXMpOwogICAgICAgIHNldEN1cnJlbnROb2RlKHN0YXRlLCBjdXJyZW50Tm9kZT8ubmV4dFNpYmxpbmcgPz8gbnVsbCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAyOiB7CiAgICAgICAgY29uc3Qgbm9PZmZzZXRJbmRleCA9IG5vZGVPck5vZGVzLmluZGV4IC0gSEVBREVSX09GRlNFVDsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBoeWRyYXRpb25JbmZvCiAgICAgICAgfSA9IGNvbnRleHQyOwogICAgICAgIGNvbnN0IGNvbnRhaW5lclNpemUgPSBnZXROZ0NvbnRhaW5lclNpemUoaHlkcmF0aW9uSW5mbywgbm9PZmZzZXRJbmRleCk7CiAgICAgICAgc3dpdGNoIChub2RlT3JOb2Rlcy50eXBlKSB7CiAgICAgICAgICBjYXNlIDA6IHsKICAgICAgICAgICAgY29uc3QgY3VycmVudE5vZGUgPSBhcHBlbmRJMThuTm9kZVRvQ29sbGVjdGlvbihjb250ZXh0Miwgc3RhdGUsIG5vZGVPck5vZGVzKTsKICAgICAgICAgICAgaWYgKGlzU2VyaWFsaXplZEVsZW1lbnRDb250YWluZXIoaHlkcmF0aW9uSW5mbywgbm9PZmZzZXRJbmRleCkpIHsKICAgICAgICAgICAgICBjb2xsZWN0STE4bk5vZGVzRnJvbURvbShjb250ZXh0Miwgc3RhdGUsIG5vZGVPck5vZGVzLmNoaWxkcmVuKTsKICAgICAgICAgICAgICBjb25zdCBuZXh0Tm9kZSA9IHNraXBTaWJsaW5nTm9kZXMoc3RhdGUsIDEpOwogICAgICAgICAgICAgIHNldEN1cnJlbnROb2RlKHN0YXRlLCBuZXh0Tm9kZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29sbGVjdEkxOG5Ob2Rlc0Zyb21Eb20oY29udGV4dDIsIGZvcmtIeWRyYXRpb25TdGF0ZShzdGF0ZSwgc3RhdGUuY3VycmVudE5vZGU/LmZpcnN0Q2hpbGQgPz8gbnVsbCksIG5vZGVPck5vZGVzLmNoaWxkcmVuKTsKICAgICAgICAgICAgICBzZXRDdXJyZW50Tm9kZShzdGF0ZSwgY3VycmVudE5vZGU/Lm5leHRTaWJsaW5nID8/IG51bGwpOwogICAgICAgICAgICAgIGlmIChjb250YWluZXJTaXplICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBjb25zdCBuZXh0Tm9kZSA9IHNraXBTaWJsaW5nTm9kZXMoc3RhdGUsIGNvbnRhaW5lclNpemUgKyAxKTsKICAgICAgICAgICAgICAgIHNldEN1cnJlbnROb2RlKHN0YXRlLCBuZXh0Tm9kZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgY2FzZSAxOiB7CiAgICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnROb3RFcXVhbChjb250YWluZXJTaXplLCBudWxsLCAiRXhwZWN0ZWQgYSBjb250YWluZXIgc2l6ZSB3aGlsZSBoeWRyYXRpbmcgaTE4biBzdWJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICBhcHBlbmRJMThuTm9kZVRvQ29sbGVjdGlvbihjb250ZXh0Miwgc3RhdGUsIG5vZGVPck5vZGVzKTsKICAgICAgICAgICAgY29uc3QgbmV4dE5vZGUgPSBza2lwU2libGluZ05vZGVzKHN0YXRlLCBjb250YWluZXJTaXplICsgMSk7CiAgICAgICAgICAgIHNldEN1cnJlbnROb2RlKHN0YXRlLCBuZXh0Tm9kZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgfQogICAgICBjYXNlIDM6IHsKICAgICAgICBjb25zdCBzZWxlY3RlZENhc2UgPSBzdGF0ZS5pc0Nvbm5lY3RlZCA/IGNvbnRleHQyLmNhc2VRdWV1ZS5zaGlmdCgpIDogbnVsbDsKICAgICAgICBjb25zdCBjaGlsZFN0YXRlID0gewogICAgICAgICAgY3VycmVudE5vZGU6IG51bGwsCiAgICAgICAgICBpc0Nvbm5lY3RlZDogZmFsc2UKICAgICAgICB9OwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZU9yTm9kZXMuY2FzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbGxlY3RJMThuTm9kZXNGcm9tRG9tKGNvbnRleHQyLCBpID09PSBzZWxlY3RlZENhc2UgPyBzdGF0ZSA6IGNoaWxkU3RhdGUsIG5vZGVPck5vZGVzLmNhc2VzW2ldKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNlbGVjdGVkQ2FzZSAhPT0gbnVsbCkgewogICAgICAgICAgY29udGV4dDIuZGVoeWRyYXRlZEljdURhdGEuc2V0KG5vZGVPck5vZGVzLmluZGV4LCB7CiAgICAgICAgICAgIGNhc2U6IHNlbGVjdGVkQ2FzZSwKICAgICAgICAgICAgbm9kZTogbm9kZU9yTm9kZXMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCBjdXJyZW50Tm9kZSA9IGFwcGVuZEkxOG5Ob2RlVG9Db2xsZWN0aW9uKGNvbnRleHQyLCBzdGF0ZSwgbm9kZU9yTm9kZXMpOwogICAgICAgIHNldEN1cnJlbnROb2RlKHN0YXRlLCBjdXJyZW50Tm9kZT8ubmV4dFNpYmxpbmcgPz8gbnVsbCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9Cn0KdmFyIF9jbGFpbURlaHlkcmF0ZWRJY3VDYXNlSW1wbCA9ICgpID0+IHsKfTsKZnVuY3Rpb24gY2xhaW1EZWh5ZHJhdGVkSWN1Q2FzZShsVmlldywgaWN1SW5kZXgsIGNhc2VJbmRleCkgewogIF9jbGFpbURlaHlkcmF0ZWRJY3VDYXNlSW1wbChsVmlldywgaWN1SW5kZXgsIGNhc2VJbmRleCk7Cn0KZnVuY3Rpb24gZW5hYmxlQ2xhaW1EZWh5ZHJhdGVkSWN1Q2FzZUltcGwoKSB7CiAgX2NsYWltRGVoeWRyYXRlZEljdUNhc2VJbXBsID0gY2xhaW1EZWh5ZHJhdGVkSWN1Q2FzZUltcGw7Cn0KZnVuY3Rpb24gY2xhaW1EZWh5ZHJhdGVkSWN1Q2FzZUltcGwobFZpZXcsIGljdUluZGV4LCBjYXNlSW5kZXgpIHsKICBjb25zdCBkZWh5ZHJhdGVkSWN1RGF0YU1hcCA9IGxWaWV3W0hZRFJBVElPTl0/LmRlaHlkcmF0ZWRJY3VEYXRhOwogIGlmIChkZWh5ZHJhdGVkSWN1RGF0YU1hcCkgewogICAgY29uc3QgZGVoeWRyYXRlZEljdURhdGEgPSBkZWh5ZHJhdGVkSWN1RGF0YU1hcC5nZXQoaWN1SW5kZXgpOwogICAgaWYgKGRlaHlkcmF0ZWRJY3VEYXRhPy5jYXNlID09PSBjYXNlSW5kZXgpIHsKICAgICAgZGVoeWRyYXRlZEljdURhdGFNYXAuZGVsZXRlKGljdUluZGV4KTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gY2xlYW51cEkxOG5IeWRyYXRpb25EYXRhKGxWaWV3KSB7CiAgY29uc3QgaHlkcmF0aW9uSW5mbyA9IGxWaWV3W0hZRFJBVElPTl07CiAgaWYgKGh5ZHJhdGlvbkluZm8pIHsKICAgIGNvbnN0IHsKICAgICAgaTE4bk5vZGVzLAogICAgICBkZWh5ZHJhdGVkSWN1RGF0YTogZGVoeWRyYXRlZEljdURhdGFNYXAKICAgIH0gPSBoeWRyYXRpb25JbmZvOwogICAgaWYgKGkxOG5Ob2RlcyAmJiBkZWh5ZHJhdGVkSWN1RGF0YU1hcCkgewogICAgICBjb25zdCByZW5kZXJlciA9IGxWaWV3W1JFTkRFUkVSXTsKICAgICAgZm9yIChjb25zdCBkZWh5ZHJhdGVkSWN1RGF0YSBvZiBkZWh5ZHJhdGVkSWN1RGF0YU1hcC52YWx1ZXMoKSkgewogICAgICAgIGNsZWFudXBEZWh5ZHJhdGVkSWN1RGF0YShyZW5kZXJlciwgaTE4bk5vZGVzLCBkZWh5ZHJhdGVkSWN1RGF0YSk7CiAgICAgIH0KICAgIH0KICAgIGh5ZHJhdGlvbkluZm8uaTE4bk5vZGVzID0gdm9pZCAwOwogICAgaHlkcmF0aW9uSW5mby5kZWh5ZHJhdGVkSWN1RGF0YSA9IHZvaWQgMDsKICB9Cn0KZnVuY3Rpb24gY2xlYW51cERlaHlkcmF0ZWRJY3VEYXRhKHJlbmRlcmVyLCBpMThuTm9kZXMsIGRlaHlkcmF0ZWRJY3VEYXRhKSB7CiAgZm9yIChjb25zdCBub2RlIG9mIGRlaHlkcmF0ZWRJY3VEYXRhLm5vZGUuY2FzZXNbZGVoeWRyYXRlZEljdURhdGEuY2FzZV0pIHsKICAgIGNvbnN0IHJOb2RlID0gaTE4bk5vZGVzLmdldChub2RlLmluZGV4IC0gSEVBREVSX09GRlNFVCk7CiAgICBpZiAock5vZGUpIHsKICAgICAgbmF0aXZlUmVtb3ZlTm9kZShyZW5kZXJlciwgck5vZGUsIGZhbHNlKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gcmVtb3ZlRGVoeWRyYXRlZFZpZXdzKGxDb250YWluZXIpIHsKICBjb25zdCB2aWV3cyA9IGxDb250YWluZXJbREVIWURSQVRFRF9WSUVXU10gPz8gW107CiAgY29uc3QgcGFyZW50TFZpZXcgPSBsQ29udGFpbmVyW1BBUkVOVF07CiAgY29uc3QgcmVuZGVyZXIgPSBwYXJlbnRMVmlld1tSRU5ERVJFUl07CiAgY29uc3QgcmV0YWluZWRWaWV3cyA9IFtdOwogIGZvciAoY29uc3QgdmlldyBvZiB2aWV3cykgewogICAgaWYgKHZpZXcuZGF0YVtERUZFUl9CTE9DS19JRF0gIT09IHZvaWQgMCkgewogICAgICByZXRhaW5lZFZpZXdzLnB1c2godmlldyk7CiAgICB9IGVsc2UgewogICAgICByZW1vdmVEZWh5ZHJhdGVkVmlldyh2aWV3LCByZW5kZXJlcik7CiAgICAgIG5nRGV2TW9kZSAmJiBuZ0Rldk1vZGUuZGVoeWRyYXRlZFZpZXdzUmVtb3ZlZCsrOwogICAgfQogIH0KICBsQ29udGFpbmVyW0RFSFlEUkFURURfVklFV1NdID0gcmV0YWluZWRWaWV3czsKfQpmdW5jdGlvbiByZW1vdmVEZWh5ZHJhdGVkVmlld0xpc3QoZGVmZXJCbG9jaykgewogIGNvbnN0IHsKICAgIGxDb250YWluZXIKICB9ID0gZGVmZXJCbG9jazsKICBjb25zdCBkZWh5ZHJhdGVkVmlld3MgPSBsQ29udGFpbmVyW0RFSFlEUkFURURfVklFV1NdOwogIGlmIChkZWh5ZHJhdGVkVmlld3MgPT09IG51bGwpIHJldHVybjsKICBjb25zdCBwYXJlbnRMVmlldyA9IGxDb250YWluZXJbUEFSRU5UXTsKICBjb25zdCByZW5kZXJlciA9IHBhcmVudExWaWV3W1JFTkRFUkVSXTsKICBmb3IgKGNvbnN0IHZpZXcgb2YgZGVoeWRyYXRlZFZpZXdzKSB7CiAgICByZW1vdmVEZWh5ZHJhdGVkVmlldyh2aWV3LCByZW5kZXJlcik7CiAgICBuZ0Rldk1vZGUgJiYgbmdEZXZNb2RlLmRlaHlkcmF0ZWRWaWV3c1JlbW92ZWQrKzsKICB9Cn0KZnVuY3Rpb24gcmVtb3ZlRGVoeWRyYXRlZFZpZXcoZGVoeWRyYXRlZFZpZXcsIHJlbmRlcmVyKSB7CiAgbGV0IG5vZGVzUmVtb3ZlZCA9IDA7CiAgbGV0IGN1cnJlbnRSTm9kZSA9IGRlaHlkcmF0ZWRWaWV3LmZpcnN0Q2hpbGQ7CiAgaWYgKGN1cnJlbnRSTm9kZSkgewogICAgY29uc3QgbnVtTm9kZXMgPSBkZWh5ZHJhdGVkVmlldy5kYXRhW05VTV9ST09UX05PREVTXTsKICAgIHdoaWxlIChub2Rlc1JlbW92ZWQgPCBudW1Ob2RlcykgewogICAgICBuZ0Rldk1vZGUgJiYgdmFsaWRhdGVTaWJsaW5nTm9kZUV4aXN0cyhjdXJyZW50Uk5vZGUpOwogICAgICBjb25zdCBuZXh0U2libGluZyA9IGN1cnJlbnRSTm9kZS5uZXh0U2libGluZzsKICAgICAgbmF0aXZlUmVtb3ZlTm9kZShyZW5kZXJlciwgY3VycmVudFJOb2RlLCBmYWxzZSk7CiAgICAgIGN1cnJlbnRSTm9kZSA9IG5leHRTaWJsaW5nOwogICAgICBub2Rlc1JlbW92ZWQrKzsKICAgIH0KICB9Cn0KZnVuY3Rpb24gY2xlYW51cExDb250YWluZXIobENvbnRhaW5lcikgewogIHJlbW92ZURlaHlkcmF0ZWRWaWV3cyhsQ29udGFpbmVyKTsKICBjb25zdCBob3N0TFZpZXcgPSBsQ29udGFpbmVyW0hPU1RdOwogIGlmIChpc0xWaWV3KGhvc3RMVmlldykpIHsKICAgIGNsZWFudXBMVmlldyhob3N0TFZpZXcpOwogIH0KICBmb3IgKGxldCBpID0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQ7IGkgPCBsQ29udGFpbmVyLmxlbmd0aDsgaSsrKSB7CiAgICBjbGVhbnVwTFZpZXcobENvbnRhaW5lcltpXSk7CiAgfQp9CmZ1bmN0aW9uIGNsZWFudXBMVmlldyhsVmlldykgewogIGNsZWFudXBJMThuSHlkcmF0aW9uRGF0YShsVmlldyk7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgZm9yIChsZXQgaSA9IEhFQURFUl9PRkZTRVQ7IGkgPCB0Vmlldy5iaW5kaW5nU3RhcnRJbmRleDsgaSsrKSB7CiAgICBpZiAoaXNMQ29udGFpbmVyKGxWaWV3W2ldKSkgewogICAgICBjb25zdCBsQ29udGFpbmVyID0gbFZpZXdbaV07CiAgICAgIGNsZWFudXBMQ29udGFpbmVyKGxDb250YWluZXIpOwogICAgfSBlbHNlIGlmIChpc0xWaWV3KGxWaWV3W2ldKSkgewogICAgICBjbGVhbnVwTFZpZXcobFZpZXdbaV0pOwogICAgfQogIH0KfQpmdW5jdGlvbiBjbGVhbnVwRGVoeWRyYXRlZFZpZXdzKGFwcFJlZikgewogIGNvbnN0IHZpZXdSZWZzID0gYXBwUmVmLl92aWV3czsKICBmb3IgKGNvbnN0IHZpZXdSZWYgb2Ygdmlld1JlZnMpIHsKICAgIGNvbnN0IGxOb2RlID0gZ2V0TE5vZGVGb3JIeWRyYXRpb24odmlld1JlZik7CiAgICBpZiAobE5vZGUgIT09IG51bGwgJiYgbE5vZGVbSE9TVF0gIT09IG51bGwpIHsKICAgICAgaWYgKGlzTFZpZXcobE5vZGUpKSB7CiAgICAgICAgY2xlYW51cExWaWV3KGxOb2RlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjbGVhbnVwTENvbnRhaW5lcihsTm9kZSk7CiAgICAgIH0KICAgICAgbmdEZXZNb2RlICYmIG5nRGV2TW9kZS5kZWh5ZHJhdGVkVmlld3NDbGVhbnVwUnVucysrOwogICAgfQogIH0KfQpmdW5jdGlvbiBjbGVhbnVwSHlkcmF0ZWREZWZlckJsb2NrcyhkZWZlckJsb2NrLCBoeWRyYXRlZEJsb2NrcywgcmVnaXN0cnksIGFwcFJlZikgewogIGlmIChkZWZlckJsb2NrICE9PSBudWxsKSB7CiAgICByZWdpc3RyeS5jbGVhbnVwKGh5ZHJhdGVkQmxvY2tzKTsKICAgIGNsZWFudXBMQ29udGFpbmVyKGRlZmVyQmxvY2subENvbnRhaW5lcik7CiAgICBjbGVhbnVwRGVoeWRyYXRlZFZpZXdzKGFwcFJlZik7CiAgfQp9CmZ1bmN0aW9uIGxvY2F0ZURlaHlkcmF0ZWRWaWV3c0luQ29udGFpbmVyKGN1cnJlbnRSTm9kZSwgc2VyaWFsaXplZFZpZXdzKSB7CiAgY29uc3QgZGVoeWRyYXRlZFZpZXdzID0gW107CiAgZm9yIChjb25zdCBzZXJpYWxpemVkVmlldyBvZiBzZXJpYWxpemVkVmlld3MpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKHNlcmlhbGl6ZWRWaWV3W01VTFRJUExJRVJdID8/IDEpOyBpKyspIHsKICAgICAgY29uc3QgdmlldyA9IHsKICAgICAgICBkYXRhOiBzZXJpYWxpemVkVmlldywKICAgICAgICBmaXJzdENoaWxkOiBudWxsCiAgICAgIH07CiAgICAgIGlmIChzZXJpYWxpemVkVmlld1tOVU1fUk9PVF9OT0RFU10gPiAwKSB7CiAgICAgICAgdmlldy5maXJzdENoaWxkID0gY3VycmVudFJOb2RlOwogICAgICAgIGN1cnJlbnRSTm9kZSA9IHNpYmxpbmdBZnRlcihzZXJpYWxpemVkVmlld1tOVU1fUk9PVF9OT0RFU10sIGN1cnJlbnRSTm9kZSk7CiAgICAgIH0KICAgICAgZGVoeWRyYXRlZFZpZXdzLnB1c2godmlldyk7CiAgICB9CiAgfQogIHJldHVybiBbY3VycmVudFJOb2RlLCBkZWh5ZHJhdGVkVmlld3NdOwp9CnZhciBfZmluZE1hdGNoaW5nRGVoeWRyYXRlZFZpZXdJbXBsID0gKCkgPT4gbnVsbDsKdmFyIF9maW5kQW5kUmVjb25jaWxlTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld3NJbXBsID0gKCkgPT4gbnVsbDsKZnVuY3Rpb24gZW5hYmxlRmluZE1hdGNoaW5nRGVoeWRyYXRlZFZpZXdJbXBsKCkgewogIF9maW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld0ltcGwgPSBmaW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld0ltcGw7CiAgX2ZpbmRBbmRSZWNvbmNpbGVNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3c0ltcGwgPSBmaW5kQW5kUmVjb25jaWxlTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld3NJbXBsOwp9CmZ1bmN0aW9uIGZpbmRNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3SW1wbChsQ29udGFpbmVyLCB0ZW1wbGF0ZSkgewogIGlmIChoYXNNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3KGxDb250YWluZXIsIHRlbXBsYXRlKSkgewogICAgcmV0dXJuIGxDb250YWluZXJbREVIWURSQVRFRF9WSUVXU10uc2hpZnQoKTsKICB9IGVsc2UgewogICAgcmVtb3ZlRGVoeWRyYXRlZFZpZXdzKGxDb250YWluZXIpOwogICAgcmV0dXJuIG51bGw7CiAgfQp9CmZ1bmN0aW9uIGZpbmRNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3KGxDb250YWluZXIsIHRlbXBsYXRlKSB7CiAgcmV0dXJuIF9maW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld0ltcGwobENvbnRhaW5lciwgdGVtcGxhdGUpOwp9CmZ1bmN0aW9uIGZpbmRBbmRSZWNvbmNpbGVNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3c0ltcGwobENvbnRhaW5lciwgdGVtcGxhdGVUTm9kZSwgaG9zdExWaWV3KSB7CiAgaWYgKHRlbXBsYXRlVE5vZGUudFZpZXcuc3NySWQgPT09IG51bGwpIHJldHVybiBudWxsOwogIGNvbnN0IGRlaHlkcmF0ZWRWaWV3ID0gZmluZE1hdGNoaW5nRGVoeWRyYXRlZFZpZXcobENvbnRhaW5lciwgdGVtcGxhdGVUTm9kZS50Vmlldy5zc3JJZCk7CiAgaWYgKGhvc3RMVmlld1tUVklFV10uZmlyc3RVcGRhdGVQYXNzICYmIGRlaHlkcmF0ZWRWaWV3ID09PSBudWxsKSB7CiAgICByZW1vdmVTdGFsZURlaHlkcmF0ZWRCcmFuY2goaG9zdExWaWV3LCB0ZW1wbGF0ZVROb2RlKTsKICB9CiAgcmV0dXJuIGRlaHlkcmF0ZWRWaWV3Owp9CmZ1bmN0aW9uIGZpbmRBbmRSZWNvbmNpbGVNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3cyhsQ29udGFpbmVyLCB0ZW1wbGF0ZVROb2RlLCBob3N0TFZpZXcpIHsKICByZXR1cm4gX2ZpbmRBbmRSZWNvbmNpbGVNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3c0ltcGwobENvbnRhaW5lciwgdGVtcGxhdGVUTm9kZSwgaG9zdExWaWV3KTsKfQpmdW5jdGlvbiByZW1vdmVTdGFsZURlaHlkcmF0ZWRCcmFuY2goaG9zdExWaWV3LCB0Tm9kZSkgewogIGxldCBjdXJyZW50VE5vZGUgPSB0Tm9kZTsKICB3aGlsZSAoY3VycmVudFROb2RlKSB7CiAgICBpZiAoY2xlYW51cE1hdGNoaW5nRGVoeWRyYXRlZFZpZXdzKGhvc3RMVmlldywgY3VycmVudFROb2RlKSkgcmV0dXJuOwogICAgaWYgKChjdXJyZW50VE5vZGUuZmxhZ3MgJiAyNTYpID09PSAyNTYpIHsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjdXJyZW50VE5vZGUgPSBjdXJyZW50VE5vZGUucHJldjsKICB9CiAgY3VycmVudFROb2RlID0gdE5vZGUubmV4dDsKICB3aGlsZSAoY3VycmVudFROb2RlKSB7CiAgICBpZiAoKGN1cnJlbnRUTm9kZS5mbGFncyAmIDUxMikgIT09IDUxMikgewogICAgICBicmVhazsKICAgIH0KICAgIGlmIChjbGVhbnVwTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld3MoaG9zdExWaWV3LCBjdXJyZW50VE5vZGUpKSByZXR1cm47CiAgICBjdXJyZW50VE5vZGUgPSBjdXJyZW50VE5vZGUubmV4dDsKICB9Cn0KZnVuY3Rpb24gaGFzTWF0Y2hpbmdEZWh5ZHJhdGVkVmlldyhsQ29udGFpbmVyLCB0ZW1wbGF0ZSkgewogIGNvbnN0IHZpZXdzID0gbENvbnRhaW5lcltERUhZRFJBVEVEX1ZJRVdTXTsKICBpZiAoIXRlbXBsYXRlIHx8IHZpZXdzID09PSBudWxsIHx8IHZpZXdzLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdmlld3NbMF0uZGF0YVtURU1QTEFURV9JRF0gPT09IHRlbXBsYXRlOwp9CmZ1bmN0aW9uIGNsZWFudXBNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3cyhob3N0TFZpZXcsIGN1cnJlbnRUTm9kZSkgewogIGNvbnN0IHNzcklkID0gY3VycmVudFROb2RlLnRWaWV3Py5zc3JJZDsKICBpZiAoc3NySWQgPT0gbnVsbCkgcmV0dXJuIGZhbHNlOwogIGNvbnN0IGNvbnRhaW5lciA9IGhvc3RMVmlld1tjdXJyZW50VE5vZGUuaW5kZXhdOwogIGlmIChpc0xDb250YWluZXIoY29udGFpbmVyKSAmJiBoYXNNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3KGNvbnRhaW5lciwgc3NySWQpKSB7CiAgICByZW1vdmVEZWh5ZHJhdGVkVmlld3MoY29udGFpbmVyKTsKICAgIHJldHVybiB0cnVlOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KdmFyIENvbXBvbmVudFJlZiQxID0gY2xhc3MgQ29tcG9uZW50UmVmIHsKfTsKdmFyIENvbXBvbmVudEZhY3RvcnkkMSA9IGNsYXNzIENvbXBvbmVudEZhY3Rvcnkgewp9Owp2YXIgX051bGxDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIgPSBjbGFzcyB7CiAgcmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoY29tcG9uZW50KSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDkxNywgdHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlICYmIGBObyBjb21wb25lbnQgZmFjdG9yeSBmb3VuZCBmb3IgJHtzdHJpbmdpZnkoY29tcG9uZW50KX0uYCk7CiAgfQp9Owp2YXIgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyJDEgPSBjbGFzcyBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIgewogIHN0YXRpYyBOVUxMID0gbmV3IF9OdWxsQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyKCk7Cn07CnZhciBSZW5kZXJlckZhY3RvcnkyID0gY2xhc3Mgewp9Owp2YXIgUmVuZGVyZXIyID0gY2xhc3MgewogIGRlc3Ryb3lOb2RlID0gbnVsbDsKICBzdGF0aWMgX19OR19FTEVNRU5UX0lEX18gPSAoKSA9PiBpbmplY3RSZW5kZXJlcjIoKTsKfTsKZnVuY3Rpb24gaW5qZWN0UmVuZGVyZXIyKCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGNvbnN0IG5vZGVBdEluZGV4ID0gZ2V0Q29tcG9uZW50TFZpZXdCeUluZGV4KHROb2RlLmluZGV4LCBsVmlldyk7CiAgcmV0dXJuIChpc0xWaWV3KG5vZGVBdEluZGV4KSA/IG5vZGVBdEluZGV4IDogbFZpZXcpW1JFTkRFUkVSXTsKfQp2YXIgU2FuaXRpemVyID0gY2xhc3MgX1Nhbml0aXplciB7CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfU2FuaXRpemVyLAogICAgcHJvdmlkZWRJbjogInJvb3QiLAogICAgZmFjdG9yeTogKCkgPT4gbnVsbAogIH0pOwp9OwpmdW5jdGlvbiBpc01vZHVsZVdpdGhQcm92aWRlcnModmFsdWUpIHsKICByZXR1cm4gdmFsdWUubmdNb2R1bGUgIT09IHZvaWQgMDsKfQpmdW5jdGlvbiBpc05nTW9kdWxlKHZhbHVlKSB7CiAgcmV0dXJuICEhZ2V0TmdNb2R1bGVEZWYodmFsdWUpOwp9CmZ1bmN0aW9uIGlzUGlwZSh2YWx1ZSkgewogIHJldHVybiAhIWdldFBpcGVEZWYodmFsdWUpOwp9CmZ1bmN0aW9uIGlzRGlyZWN0aXZlKHZhbHVlKSB7CiAgcmV0dXJuICEhZ2V0RGlyZWN0aXZlRGVmKHZhbHVlKTsKfQpmdW5jdGlvbiBpc0NvbXBvbmVudCh2YWx1ZSkgewogIHJldHVybiAhIWdldENvbXBvbmVudERlZih2YWx1ZSk7Cn0KZnVuY3Rpb24gZ2V0RGVwZW5kZW5jeVR5cGVGb3JFcnJvcih0eXBlKSB7CiAgaWYgKGdldENvbXBvbmVudERlZih0eXBlKSkgcmV0dXJuICJjb21wb25lbnQiOwogIGlmIChnZXREaXJlY3RpdmVEZWYodHlwZSkpIHJldHVybiAiZGlyZWN0aXZlIjsKICBpZiAoZ2V0UGlwZURlZih0eXBlKSkgcmV0dXJuICJwaXBlIjsKICByZXR1cm4gInR5cGUiOwp9CmZ1bmN0aW9uIHZlcmlmeVN0YW5kYWxvbmVJbXBvcnQoZGVwVHlwZSwgaW1wb3J0aW5nVHlwZSkgewogIGlmIChpc0ZvcndhcmRSZWYoZGVwVHlwZSkpIHsKICAgIGRlcFR5cGUgPSByZXNvbHZlRm9yd2FyZFJlZihkZXBUeXBlKTsKICAgIGlmICghZGVwVHlwZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGZvcndhcmRSZWYgZnVuY3Rpb24sIGltcG9ydGVkIGZyb20gIiR7c3RyaW5naWZ5Rm9yRXJyb3IoaW1wb3J0aW5nVHlwZSl9IiwgdG8gcmV0dXJuIGEgc3RhbmRhbG9uZSBlbnRpdHkgb3IgTmdNb2R1bGUgYnV0IGdvdCAiJHtzdHJpbmdpZnlGb3JFcnJvcihkZXBUeXBlKSB8fCBkZXBUeXBlfSIuYCk7CiAgICB9CiAgfQogIGlmIChnZXROZ01vZHVsZURlZihkZXBUeXBlKSA9PSBudWxsKSB7CiAgICBjb25zdCBkZWYgPSBnZXRDb21wb25lbnREZWYoZGVwVHlwZSkgfHwgZ2V0RGlyZWN0aXZlRGVmKGRlcFR5cGUpIHx8IGdldFBpcGVEZWYoZGVwVHlwZSk7CiAgICBpZiAoZGVmICE9IG51bGwpIHsKICAgICAgaWYgKCFkZWYuc3RhbmRhbG9uZSkgewogICAgICAgIGNvbnN0IHR5cGUgPSBnZXREZXBlbmRlbmN5VHlwZUZvckVycm9yKGRlcFR5cGUpOwogICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlICIke3N0cmluZ2lmeUZvckVycm9yKGRlcFR5cGUpfSIgJHt0eXBlfSwgaW1wb3J0ZWQgZnJvbSAiJHtzdHJpbmdpZnlGb3JFcnJvcihpbXBvcnRpbmdUeXBlKX0iLCBpcyBub3Qgc3RhbmRhbG9uZS4gRG9lcyB0aGUgJHt0eXBlfSBoYXZlIHRoZSBzdGFuZGFsb25lOiBmYWxzZSBmbGFnP2ApOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoaXNNb2R1bGVXaXRoUHJvdmlkZXJzKGRlcFR5cGUpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBIG1vZHVsZSB3aXRoIHByb3ZpZGVycyB3YXMgaW1wb3J0ZWQgZnJvbSAiJHtzdHJpbmdpZnlGb3JFcnJvcihpbXBvcnRpbmdUeXBlKX0iLiBNb2R1bGVzIHdpdGggcHJvdmlkZXJzIGFyZSBub3Qgc3VwcG9ydGVkIGluIHN0YW5kYWxvbmUgY29tcG9uZW50cyBpbXBvcnRzLmApOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlICIke3N0cmluZ2lmeUZvckVycm9yKGRlcFR5cGUpfSIgdHlwZSwgaW1wb3J0ZWQgZnJvbSAiJHtzdHJpbmdpZnlGb3JFcnJvcihpbXBvcnRpbmdUeXBlKX0iLCBtdXN0IGJlIGEgc3RhbmRhbG9uZSBjb21wb25lbnQgLyBkaXJlY3RpdmUgLyBwaXBlIG9yIGFuIE5nTW9kdWxlLiBEaWQgeW91IGZvcmdldCB0byBhZGQgdGhlIHJlcXVpcmVkIEBDb21wb25lbnQgLyBARGlyZWN0aXZlIC8gQFBpcGUgb3IgQE5nTW9kdWxlIGFubm90YXRpb24/YCk7CiAgICAgIH0KICAgIH0KICB9Cn0KdmFyIERlcHNUcmFja2VyID0gY2xhc3MgewogIG93bmVyTmdNb2R1bGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICBuZ01vZHVsZXNXaXRoU29tZVVucmVzb2x2ZWREZWNscyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgbmdNb2R1bGVzU2NvcGVDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIHN0YW5kYWxvbmVDb21wb25lbnRzU2NvcGVDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIHJlc29sdmVOZ01vZHVsZXNEZWNscygpIHsKICAgIGlmICh0aGlzLm5nTW9kdWxlc1dpdGhTb21lVW5yZXNvbHZlZERlY2xzLnNpemUgPT09IDApIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgZm9yIChjb25zdCBtb2R1bGVUeXBlIG9mIHRoaXMubmdNb2R1bGVzV2l0aFNvbWVVbnJlc29sdmVkRGVjbHMpIHsKICAgICAgY29uc3QgZGVmID0gZ2V0TmdNb2R1bGVEZWYobW9kdWxlVHlwZSk7CiAgICAgIGlmIChkZWY/LmRlY2xhcmF0aW9ucykgewogICAgICAgIGZvciAoY29uc3QgZGVjbCBvZiBtYXliZVVud3JhcEZuKGRlZi5kZWNsYXJhdGlvbnMpKSB7CiAgICAgICAgICBpZiAoaXNDb21wb25lbnQoZGVjbCkpIHsKICAgICAgICAgICAgdGhpcy5vd25lck5nTW9kdWxlLnNldChkZWNsLCBtb2R1bGVUeXBlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHRoaXMubmdNb2R1bGVzV2l0aFNvbWVVbnJlc29sdmVkRGVjbHMuY2xlYXIoKTsKICB9CiAgZ2V0Q29tcG9uZW50RGVwZW5kZW5jaWVzKHR5cGUsIHJhd0ltcG9ydHMpIHsKICAgIHRoaXMucmVzb2x2ZU5nTW9kdWxlc0RlY2xzKCk7CiAgICBjb25zdCBkZWYgPSBnZXRDb21wb25lbnREZWYodHlwZSk7CiAgICBpZiAoZGVmID09PSBudWxsKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgQXR0ZW1wdGluZyB0byBnZXQgY29tcG9uZW50IGRlcGVuZGVuY2llcyBmb3IgYSB0eXBlIHRoYXQgaXMgbm90IGEgY29tcG9uZW50OiAke3R5cGV9YCk7CiAgICB9CiAgICBpZiAoZGVmLnN0YW5kYWxvbmUpIHsKICAgICAgY29uc3Qgc2NvcGUgPSB0aGlzLmdldFN0YW5kYWxvbmVDb21wb25lbnRTY29wZSh0eXBlLCByYXdJbXBvcnRzKTsKICAgICAgaWYgKHNjb3BlLmNvbXBpbGF0aW9uLmlzUG9pc29uZWQpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgZGVwZW5kZW5jaWVzOiBbXQogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICBkZXBlbmRlbmNpZXM6IFsuLi5zY29wZS5jb21waWxhdGlvbi5kaXJlY3RpdmVzLCAuLi5zY29wZS5jb21waWxhdGlvbi5waXBlcywgLi4uc2NvcGUuY29tcGlsYXRpb24ubmdNb2R1bGVzXQogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgaWYgKCF0aGlzLm93bmVyTmdNb2R1bGUuaGFzKHR5cGUpKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGRlcGVuZGVuY2llczogW10KICAgICAgICB9OwogICAgICB9CiAgICAgIGNvbnN0IHNjb3BlID0gdGhpcy5nZXROZ01vZHVsZVNjb3BlKHRoaXMub3duZXJOZ01vZHVsZS5nZXQodHlwZSkpOwogICAgICBpZiAoc2NvcGUuY29tcGlsYXRpb24uaXNQb2lzb25lZCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBkZXBlbmRlbmNpZXM6IFtdCiAgICAgICAgfTsKICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIGRlcGVuZGVuY2llczogWy4uLnNjb3BlLmNvbXBpbGF0aW9uLmRpcmVjdGl2ZXMsIC4uLnNjb3BlLmNvbXBpbGF0aW9uLnBpcGVzXQogICAgICB9OwogICAgfQogIH0KICByZWdpc3Rlck5nTW9kdWxlKHR5cGUsIHNjb3BlSW5mbykgewogICAgaWYgKCFpc05nTW9kdWxlKHR5cGUpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgQXR0ZW1wdGluZyB0byByZWdpc3RlciBhIFR5cGUgd2hpY2ggaXMgbm90IE5nTW9kdWxlIGFzIE5nTW9kdWxlOiAke3R5cGV9YCk7CiAgICB9CiAgICB0aGlzLm5nTW9kdWxlc1dpdGhTb21lVW5yZXNvbHZlZERlY2xzLmFkZCh0eXBlKTsKICB9CiAgY2xlYXJTY29wZUNhY2hlRm9yKHR5cGUpIHsKICAgIHRoaXMubmdNb2R1bGVzU2NvcGVDYWNoZS5kZWxldGUodHlwZSk7CiAgICB0aGlzLnN0YW5kYWxvbmVDb21wb25lbnRzU2NvcGVDYWNoZS5kZWxldGUodHlwZSk7CiAgfQogIGdldE5nTW9kdWxlU2NvcGUodHlwZSkgewogICAgaWYgKHRoaXMubmdNb2R1bGVzU2NvcGVDYWNoZS5oYXModHlwZSkpIHsKICAgICAgcmV0dXJuIHRoaXMubmdNb2R1bGVzU2NvcGVDYWNoZS5nZXQodHlwZSk7CiAgICB9CiAgICBjb25zdCBzY29wZSA9IHRoaXMuY29tcHV0ZU5nTW9kdWxlU2NvcGUodHlwZSk7CiAgICB0aGlzLm5nTW9kdWxlc1Njb3BlQ2FjaGUuc2V0KHR5cGUsIHNjb3BlKTsKICAgIHJldHVybiBzY29wZTsKICB9CiAgY29tcHV0ZU5nTW9kdWxlU2NvcGUodHlwZSkgewogICAgY29uc3QgZGVmID0gZ2V0TmdNb2R1bGVEZWZPclRocm93KHR5cGUpOwogICAgY29uc3Qgc2NvcGUgPSB7CiAgICAgIGV4cG9ydGVkOiB7CiAgICAgICAgZGlyZWN0aXZlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSwKICAgICAgICBwaXBlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKQogICAgICB9LAogICAgICBjb21waWxhdGlvbjogewogICAgICAgIGRpcmVjdGl2ZXM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksCiAgICAgICAgcGlwZXM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkKICAgICAgfQogICAgfTsKICAgIGZvciAoY29uc3QgaW1wb3J0ZWQgb2YgbWF5YmVVbndyYXBGbihkZWYuaW1wb3J0cykpIHsKICAgICAgaWYgKGlzTmdNb2R1bGUoaW1wb3J0ZWQpKSB7CiAgICAgICAgY29uc3QgaW1wb3J0ZWRTY29wZSA9IHRoaXMuZ2V0TmdNb2R1bGVTY29wZShpbXBvcnRlZCk7CiAgICAgICAgYWRkU2V0KGltcG9ydGVkU2NvcGUuZXhwb3J0ZWQuZGlyZWN0aXZlcywgc2NvcGUuY29tcGlsYXRpb24uZGlyZWN0aXZlcyk7CiAgICAgICAgYWRkU2V0KGltcG9ydGVkU2NvcGUuZXhwb3J0ZWQucGlwZXMsIHNjb3BlLmNvbXBpbGF0aW9uLnBpcGVzKTsKICAgICAgfSBlbHNlIGlmIChpc1N0YW5kYWxvbmUoaW1wb3J0ZWQpKSB7CiAgICAgICAgaWYgKGlzRGlyZWN0aXZlKGltcG9ydGVkKSB8fCBpc0NvbXBvbmVudChpbXBvcnRlZCkpIHsKICAgICAgICAgIHNjb3BlLmNvbXBpbGF0aW9uLmRpcmVjdGl2ZXMuYWRkKGltcG9ydGVkKTsKICAgICAgICB9IGVsc2UgaWYgKGlzUGlwZShpbXBvcnRlZCkpIHsKICAgICAgICAgIHNjb3BlLmNvbXBpbGF0aW9uLnBpcGVzLmFkZChpbXBvcnRlZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTgwLCAiVGhlIHN0YW5kYWxvbmUgaW1wb3J0ZWQgdHlwZSBpcyBuZWl0aGVyIGEgY29tcG9uZW50IG5vciBhIGRpcmVjdGl2ZSBub3IgYSBwaXBlIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHNjb3BlLmNvbXBpbGF0aW9uLmlzUG9pc29uZWQgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBpZiAoIXNjb3BlLmNvbXBpbGF0aW9uLmlzUG9pc29uZWQpIHsKICAgICAgZm9yIChjb25zdCBkZWNsIG9mIG1heWJlVW53cmFwRm4oZGVmLmRlY2xhcmF0aW9ucykpIHsKICAgICAgICBpZiAoaXNOZ01vZHVsZShkZWNsKSB8fCBpc1N0YW5kYWxvbmUoZGVjbCkpIHsKICAgICAgICAgIHNjb3BlLmNvbXBpbGF0aW9uLmlzUG9pc29uZWQgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGlmIChpc1BpcGUoZGVjbCkpIHsKICAgICAgICAgIHNjb3BlLmNvbXBpbGF0aW9uLnBpcGVzLmFkZChkZWNsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2NvcGUuY29tcGlsYXRpb24uZGlyZWN0aXZlcy5hZGQoZGVjbCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBmb3IgKGNvbnN0IGV4cG9ydGVkIG9mIG1heWJlVW53cmFwRm4oZGVmLmV4cG9ydHMpKSB7CiAgICAgIGlmIChpc05nTW9kdWxlKGV4cG9ydGVkKSkgewogICAgICAgIGNvbnN0IGV4cG9ydGVkU2NvcGUgPSB0aGlzLmdldE5nTW9kdWxlU2NvcGUoZXhwb3J0ZWQpOwogICAgICAgIGFkZFNldChleHBvcnRlZFNjb3BlLmV4cG9ydGVkLmRpcmVjdGl2ZXMsIHNjb3BlLmV4cG9ydGVkLmRpcmVjdGl2ZXMpOwogICAgICAgIGFkZFNldChleHBvcnRlZFNjb3BlLmV4cG9ydGVkLnBpcGVzLCBzY29wZS5leHBvcnRlZC5waXBlcyk7CiAgICAgICAgYWRkU2V0KGV4cG9ydGVkU2NvcGUuZXhwb3J0ZWQuZGlyZWN0aXZlcywgc2NvcGUuY29tcGlsYXRpb24uZGlyZWN0aXZlcyk7CiAgICAgICAgYWRkU2V0KGV4cG9ydGVkU2NvcGUuZXhwb3J0ZWQucGlwZXMsIHNjb3BlLmNvbXBpbGF0aW9uLnBpcGVzKTsKICAgICAgfSBlbHNlIGlmIChpc1BpcGUoZXhwb3J0ZWQpKSB7CiAgICAgICAgc2NvcGUuZXhwb3J0ZWQucGlwZXMuYWRkKGV4cG9ydGVkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzY29wZS5leHBvcnRlZC5kaXJlY3RpdmVzLmFkZChleHBvcnRlZCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBzY29wZTsKICB9CiAgZ2V0U3RhbmRhbG9uZUNvbXBvbmVudFNjb3BlKHR5cGUsIHJhd0ltcG9ydHMpIHsKICAgIGlmICh0aGlzLnN0YW5kYWxvbmVDb21wb25lbnRzU2NvcGVDYWNoZS5oYXModHlwZSkpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhbmRhbG9uZUNvbXBvbmVudHNTY29wZUNhY2hlLmdldCh0eXBlKTsKICAgIH0KICAgIGNvbnN0IGFucyA9IHRoaXMuY29tcHV0ZVN0YW5kYWxvbmVDb21wb25lbnRTY29wZSh0eXBlLCByYXdJbXBvcnRzKTsKICAgIHRoaXMuc3RhbmRhbG9uZUNvbXBvbmVudHNTY29wZUNhY2hlLnNldCh0eXBlLCBhbnMpOwogICAgcmV0dXJuIGFuczsKICB9CiAgY29tcHV0ZVN0YW5kYWxvbmVDb21wb25lbnRTY29wZSh0eXBlLCByYXdJbXBvcnRzKSB7CiAgICBjb25zdCBhbnMgPSB7CiAgICAgIGNvbXBpbGF0aW9uOiB7CiAgICAgICAgZGlyZWN0aXZlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW3R5cGVdKSwKICAgICAgICBwaXBlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSwKICAgICAgICBuZ01vZHVsZXM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkKICAgICAgfQogICAgfTsKICAgIGZvciAoY29uc3QgcmF3SW1wb3J0IG9mIGZsYXR0ZW4ocmF3SW1wb3J0cyA/PyBbXSkpIHsKICAgICAgY29uc3QgaW1wb3J0ZWQgPSByZXNvbHZlRm9yd2FyZFJlZihyYXdJbXBvcnQpOwogICAgICB0cnkgewogICAgICAgIHZlcmlmeVN0YW5kYWxvbmVJbXBvcnQoaW1wb3J0ZWQsIHR5cGUpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgYW5zLmNvbXBpbGF0aW9uLmlzUG9pc29uZWQgPSB0cnVlOwogICAgICAgIHJldHVybiBhbnM7CiAgICAgIH0KICAgICAgaWYgKGlzTmdNb2R1bGUoaW1wb3J0ZWQpKSB7CiAgICAgICAgYW5zLmNvbXBpbGF0aW9uLm5nTW9kdWxlcy5hZGQoaW1wb3J0ZWQpOwogICAgICAgIGNvbnN0IGltcG9ydGVkU2NvcGUgPSB0aGlzLmdldE5nTW9kdWxlU2NvcGUoaW1wb3J0ZWQpOwogICAgICAgIGlmIChpbXBvcnRlZFNjb3BlLmV4cG9ydGVkLmlzUG9pc29uZWQpIHsKICAgICAgICAgIGFucy5jb21waWxhdGlvbi5pc1BvaXNvbmVkID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiBhbnM7CiAgICAgICAgfQogICAgICAgIGFkZFNldChpbXBvcnRlZFNjb3BlLmV4cG9ydGVkLmRpcmVjdGl2ZXMsIGFucy5jb21waWxhdGlvbi5kaXJlY3RpdmVzKTsKICAgICAgICBhZGRTZXQoaW1wb3J0ZWRTY29wZS5leHBvcnRlZC5waXBlcywgYW5zLmNvbXBpbGF0aW9uLnBpcGVzKTsKICAgICAgfSBlbHNlIGlmIChpc1BpcGUoaW1wb3J0ZWQpKSB7CiAgICAgICAgYW5zLmNvbXBpbGF0aW9uLnBpcGVzLmFkZChpbXBvcnRlZCk7CiAgICAgIH0gZWxzZSBpZiAoaXNEaXJlY3RpdmUoaW1wb3J0ZWQpIHx8IGlzQ29tcG9uZW50KGltcG9ydGVkKSkgewogICAgICAgIGFucy5jb21waWxhdGlvbi5kaXJlY3RpdmVzLmFkZChpbXBvcnRlZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYW5zLmNvbXBpbGF0aW9uLmlzUG9pc29uZWQgPSB0cnVlOwogICAgICAgIHJldHVybiBhbnM7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBhbnM7CiAgfQogIGlzT3JwaGFuQ29tcG9uZW50KGNtcCkgewogICAgY29uc3QgZGVmID0gZ2V0Q29tcG9uZW50RGVmKGNtcCk7CiAgICBpZiAoIWRlZiB8fCBkZWYuc3RhbmRhbG9uZSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB0aGlzLnJlc29sdmVOZ01vZHVsZXNEZWNscygpOwogICAgcmV0dXJuICF0aGlzLm93bmVyTmdNb2R1bGUuaGFzKGNtcCk7CiAgfQp9OwpmdW5jdGlvbiBhZGRTZXQoc291cmNlU2V0LCB0YXJnZXRTZXQpIHsKICBmb3IgKGNvbnN0IG0gb2Ygc291cmNlU2V0KSB7CiAgICB0YXJnZXRTZXQuYWRkKG0pOwogIH0KfQp2YXIgZGVwc1RyYWNrZXIgPSBuZXcgRGVwc1RyYWNrZXIoKTsKdmFyIE5PVF9GT1VORF9DSEVDS19PTkxZX0VMRU1FTlRfSU5KRUNUT1IgPSB7fTsKdmFyIENoYWluZWRJbmplY3RvciA9IGNsYXNzIHsKICBpbmplY3RvcjsKICBwYXJlbnRJbmplY3RvcjsKICBjb25zdHJ1Y3RvcihpbmplY3RvciwgcGFyZW50SW5qZWN0b3IpIHsKICAgIHRoaXMuaW5qZWN0b3IgPSBpbmplY3RvcjsKICAgIHRoaXMucGFyZW50SW5qZWN0b3IgPSBwYXJlbnRJbmplY3RvcjsKICB9CiAgZ2V0KHRva2VuLCBub3RGb3VuZFZhbHVlLCBvcHRpb25zKSB7CiAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KHRva2VuLCBOT1RfRk9VTkRfQ0hFQ0tfT05MWV9FTEVNRU5UX0lOSkVDVE9SLCBvcHRpb25zKTsKICAgIGlmICh2YWx1ZSAhPT0gTk9UX0ZPVU5EX0NIRUNLX09OTFlfRUxFTUVOVF9JTkpFQ1RPUiB8fCBub3RGb3VuZFZhbHVlID09PSBOT1RfRk9VTkRfQ0hFQ0tfT05MWV9FTEVNRU5UX0lOSkVDVE9SKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICAgIHJldHVybiB0aGlzLnBhcmVudEluamVjdG9yLmdldCh0b2tlbiwgbm90Rm91bmRWYWx1ZSwgb3B0aW9ucyk7CiAgfQp9OwpmdW5jdGlvbiBjb21wdXRlU3RhdGljU3R5bGluZyh0Tm9kZSwgYXR0cnMsIHdyaXRlVG9Ib3N0KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEZpcnN0Q3JlYXRlUGFzcyhnZXRUVmlldygpLCAiRXhwZWN0aW5nIHRvIGJlIGNhbGxlZCBpbiBmaXJzdCB0ZW1wbGF0ZSBwYXNzIG9ubHkiKTsKICBsZXQgc3R5bGVzID0gd3JpdGVUb0hvc3QgPyB0Tm9kZS5zdHlsZXMgOiBudWxsOwogIGxldCBjbGFzc2VzID0gd3JpdGVUb0hvc3QgPyB0Tm9kZS5jbGFzc2VzIDogbnVsbDsKICBsZXQgbW9kZSA9IDA7CiAgaWYgKGF0dHJzICE9PSBudWxsKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF0dHJzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gYXR0cnNbaV07CiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiKSB7CiAgICAgICAgbW9kZSA9IHZhbHVlOwogICAgICB9IGVsc2UgaWYgKG1vZGUgPT0gMSkgewogICAgICAgIGNsYXNzZXMgPSBjb25jYXRTdHJpbmdzV2l0aFNwYWNlKGNsYXNzZXMsIHZhbHVlKTsKICAgICAgfSBlbHNlIGlmIChtb2RlID09IDIpIHsKICAgICAgICBjb25zdCBzdHlsZSA9IHZhbHVlOwogICAgICAgIGNvbnN0IHN0eWxlVmFsdWUgPSBhdHRyc1srK2ldOwogICAgICAgIHN0eWxlcyA9IGNvbmNhdFN0cmluZ3NXaXRoU3BhY2Uoc3R5bGVzLCBzdHlsZSArICI6ICIgKyBzdHlsZVZhbHVlICsgIjsiKTsKICAgICAgfQogICAgfQogIH0KICB3cml0ZVRvSG9zdCA/IHROb2RlLnN0eWxlcyA9IHN0eWxlcyA6IHROb2RlLnN0eWxlc1dpdGhvdXRIb3N0ID0gc3R5bGVzOwogIHdyaXRlVG9Ib3N0ID8gdE5vZGUuY2xhc3NlcyA9IGNsYXNzZXMgOiB0Tm9kZS5jbGFzc2VzV2l0aG91dEhvc3QgPSBjbGFzc2VzOwp9CmZ1bmN0aW9uIMm1ybVkaXJlY3RpdmVJbmplY3QodG9rZW4sIGZsYWdzID0gMCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBpZiAobFZpZXcgPT09IG51bGwpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmplY3RJbXBsZW1lbnRhdGlvbk5vdEVxdWFsKMm1ybVkaXJlY3RpdmVJbmplY3QpOwogICAgcmV0dXJuIMm1ybVpbmplY3QodG9rZW4sIGZsYWdzKTsKICB9CiAgY29uc3QgdE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBjb25zdCB2YWx1ZSA9IGdldE9yQ3JlYXRlSW5qZWN0YWJsZSh0Tm9kZSwgbFZpZXcsIHJlc29sdmVGb3J3YXJkUmVmKHRva2VuKSwgZmxhZ3MpOwogIG5nRGV2TW9kZSAmJiBlbWl0SW5qZWN0RXZlbnQodG9rZW4sIHZhbHVlLCBmbGFncyk7CiAgcmV0dXJuIHZhbHVlOwp9CmZ1bmN0aW9uIMm1ybVpbnZhbGlkRmFjdG9yeSgpIHsKICBjb25zdCBtc2cgPSBuZ0Rldk1vZGUgPyBgVGhpcyBjb25zdHJ1Y3RvciB3YXMgbm90IGNvbXBhdGlibGUgd2l0aCBEZXBlbmRlbmN5IEluamVjdGlvbi5gIDogImludmFsaWQiOwogIHRocm93IG5ldyBFcnJvcihtc2cpOwp9CmZ1bmN0aW9uIHJlc29sdmVEaXJlY3RpdmVzKHRWaWV3LCBsVmlldywgdE5vZGUsIGxvY2FsUmVmcywgZGlyZWN0aXZlTWF0Y2hlcikgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIGNvbnN0IGV4cG9ydHNNYXAgPSBsb2NhbFJlZnMgPT09IG51bGwgPyBudWxsIDogewogICAgIiI6IC0xCiAgfTsKICBjb25zdCBtYXRjaGVkRGlyZWN0aXZlRGVmcyA9IGRpcmVjdGl2ZU1hdGNoZXIodFZpZXcsIHROb2RlKTsKICBpZiAobWF0Y2hlZERpcmVjdGl2ZURlZnMgIT09IG51bGwpIHsKICAgIGxldCBkaXJlY3RpdmVEZWZzID0gbWF0Y2hlZERpcmVjdGl2ZURlZnM7CiAgICBsZXQgaG9zdERpcmVjdGl2ZURlZnMgPSBudWxsOwogICAgbGV0IGhvc3REaXJlY3RpdmVSYW5nZXMgPSBudWxsOwogICAgZm9yIChjb25zdCBkZWYgb2YgbWF0Y2hlZERpcmVjdGl2ZURlZnMpIHsKICAgICAgaWYgKGRlZi5yZXNvbHZlSG9zdERpcmVjdGl2ZXMgIT09IG51bGwpIHsKICAgICAgICBbZGlyZWN0aXZlRGVmcywgaG9zdERpcmVjdGl2ZURlZnMsIGhvc3REaXJlY3RpdmVSYW5nZXNdID0gZGVmLnJlc29sdmVIb3N0RGlyZWN0aXZlcyhtYXRjaGVkRGlyZWN0aXZlRGVmcyk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIG5nRGV2TW9kZSAmJiBhc3NlcnROb0R1cGxpY2F0ZURpcmVjdGl2ZXMoZGlyZWN0aXZlRGVmcyk7CiAgICBpbml0aWFsaXplRGlyZWN0aXZlcyh0VmlldywgbFZpZXcsIHROb2RlLCBkaXJlY3RpdmVEZWZzLCBleHBvcnRzTWFwLCBob3N0RGlyZWN0aXZlRGVmcywgaG9zdERpcmVjdGl2ZVJhbmdlcyk7CiAgfQogIGlmIChleHBvcnRzTWFwICE9PSBudWxsICYmIGxvY2FsUmVmcyAhPT0gbnVsbCkgewogICAgY2FjaGVNYXRjaGluZ0xvY2FsTmFtZXModE5vZGUsIGxvY2FsUmVmcywgZXhwb3J0c01hcCk7CiAgfQp9CmZ1bmN0aW9uIGNhY2hlTWF0Y2hpbmdMb2NhbE5hbWVzKHROb2RlLCBsb2NhbFJlZnMsIGV4cG9ydHNNYXApIHsKICBjb25zdCBsb2NhbE5hbWVzID0gdE5vZGUubG9jYWxOYW1lcyA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxSZWZzLmxlbmd0aDsgaSArPSAyKSB7CiAgICBjb25zdCBpbmRleCA9IGV4cG9ydHNNYXBbbG9jYWxSZWZzW2kgKyAxXV07CiAgICBpZiAoaW5kZXggPT0gbnVsbCkgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtMzAxLCBuZ0Rldk1vZGUgJiYgYEV4cG9ydCBvZiBuYW1lICcke2xvY2FsUmVmc1tpICsgMV19JyBub3QgZm91bmQhYCk7CiAgICBsb2NhbE5hbWVzLnB1c2gobG9jYWxSZWZzW2ldLCBpbmRleCk7CiAgfQp9CmZ1bmN0aW9uIG1hcmtBc0NvbXBvbmVudEhvc3QodFZpZXcsIGhvc3RUTm9kZSwgY29tcG9uZW50T2Zmc2V0KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEZpcnN0Q3JlYXRlUGFzcyh0Vmlldyk7CiAgbmdEZXZNb2RlICYmIGFzc2VydEdyZWF0ZXJUaGFuKGNvbXBvbmVudE9mZnNldCwgLTEsICJjb21wb25lbnRPZmZzZXQgbXVzdCBiZSBncmVhdCB0aGFuIC0xIik7CiAgaG9zdFROb2RlLmNvbXBvbmVudE9mZnNldCA9IGNvbXBvbmVudE9mZnNldDsKICAodFZpZXcuY29tcG9uZW50cyA/Pz0gW10pLnB1c2goaG9zdFROb2RlLmluZGV4KTsKfQpmdW5jdGlvbiBpbml0aWFsaXplRGlyZWN0aXZlcyh0VmlldywgbFZpZXcsIHROb2RlLCBkaXJlY3RpdmVzLCBleHBvcnRzTWFwLCBob3N0RGlyZWN0aXZlRGVmcywgaG9zdERpcmVjdGl2ZVJhbmdlcykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIGNvbnN0IGRpcmVjdGl2ZXNMZW5ndGggPSBkaXJlY3RpdmVzLmxlbmd0aDsKICBsZXQgY29tcG9uZW50RGVmID0gbnVsbDsKICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGl2ZXNMZW5ndGg7IGkrKykgewogICAgY29uc3QgZGVmID0gZGlyZWN0aXZlc1tpXTsKICAgIGlmIChjb21wb25lbnREZWYgPT09IG51bGwgJiYgaXNDb21wb25lbnREZWYoZGVmKSkgewogICAgICBjb21wb25lbnREZWYgPSBkZWY7CiAgICAgIG1hcmtBc0NvbXBvbmVudEhvc3QodFZpZXcsIHROb2RlLCBpKTsKICAgIH0KICAgIGRpUHVibGljSW5JbmplY3RvcihnZXRPckNyZWF0ZU5vZGVJbmplY3RvckZvck5vZGUodE5vZGUsIGxWaWV3KSwgdFZpZXcsIGRlZi50eXBlKTsKICB9CiAgaW5pdFROb2RlRmxhZ3ModE5vZGUsIHRWaWV3LmRhdGEubGVuZ3RoLCBkaXJlY3RpdmVzTGVuZ3RoKTsKICBpZiAoY29tcG9uZW50RGVmPy52aWV3UHJvdmlkZXJzUmVzb2x2ZXIpIHsKICAgIGNvbXBvbmVudERlZi52aWV3UHJvdmlkZXJzUmVzb2x2ZXIoY29tcG9uZW50RGVmKTsKICB9CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXJlY3RpdmVzTGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGRlZiA9IGRpcmVjdGl2ZXNbaV07CiAgICBpZiAoZGVmLnByb3ZpZGVyc1Jlc29sdmVyKSB7CiAgICAgIGRlZi5wcm92aWRlcnNSZXNvbHZlcihkZWYpOwogICAgfQogIH0KICBsZXQgcHJlT3JkZXJIb29rc0ZvdW5kID0gZmFsc2U7CiAgbGV0IHByZU9yZGVyQ2hlY2tIb29rc0ZvdW5kID0gZmFsc2U7CiAgbGV0IGRpcmVjdGl2ZUlkeCA9IGFsbG9jRXhwYW5kbyh0VmlldywgbFZpZXcsIGRpcmVjdGl2ZXNMZW5ndGgsIG51bGwpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRTYW1lKGRpcmVjdGl2ZUlkeCwgdE5vZGUuZGlyZWN0aXZlU3RhcnQsICJUTm9kZS5kaXJlY3RpdmVTdGFydCBzaG91bGQgcG9pbnQgdG8ganVzdCBhbGxvY2F0ZWQgc3BhY2UiKTsKICBpZiAoZGlyZWN0aXZlc0xlbmd0aCA+IDApIHsKICAgIHROb2RlLmRpcmVjdGl2ZVRvSW5kZXggPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIH0KICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGl2ZXNMZW5ndGg7IGkrKykgewogICAgY29uc3QgZGVmID0gZGlyZWN0aXZlc1tpXTsKICAgIHROb2RlLm1lcmdlZEF0dHJzID0gbWVyZ2VIb3N0QXR0cnModE5vZGUubWVyZ2VkQXR0cnMsIGRlZi5ob3N0QXR0cnMpOwogICAgY29uZmlndXJlVmlld1dpdGhEaXJlY3RpdmUodFZpZXcsIHROb2RlLCBsVmlldywgZGlyZWN0aXZlSWR4LCBkZWYpOwogICAgc2F2ZU5hbWVUb0V4cG9ydE1hcChkaXJlY3RpdmVJZHgsIGRlZiwgZXhwb3J0c01hcCk7CiAgICBpZiAoaG9zdERpcmVjdGl2ZVJhbmdlcyAhPT0gbnVsbCAmJiBob3N0RGlyZWN0aXZlUmFuZ2VzLmhhcyhkZWYpKSB7CiAgICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IGhvc3REaXJlY3RpdmVSYW5nZXMuZ2V0KGRlZik7CiAgICAgIHROb2RlLmRpcmVjdGl2ZVRvSW5kZXguc2V0KGRlZi50eXBlLCBbZGlyZWN0aXZlSWR4LCBzdGFydCArIHROb2RlLmRpcmVjdGl2ZVN0YXJ0LCBlbmQgKyB0Tm9kZS5kaXJlY3RpdmVTdGFydF0pOwogICAgfSBlbHNlIGlmIChob3N0RGlyZWN0aXZlRGVmcyA9PT0gbnVsbCB8fCAhaG9zdERpcmVjdGl2ZURlZnMuaGFzKGRlZikpIHsKICAgICAgdE5vZGUuZGlyZWN0aXZlVG9JbmRleC5zZXQoZGVmLnR5cGUsIGRpcmVjdGl2ZUlkeCk7CiAgICB9CiAgICBpZiAoZGVmLmNvbnRlbnRRdWVyaWVzICE9PSBudWxsKSB0Tm9kZS5mbGFncyB8PSA0OwogICAgaWYgKGRlZi5ob3N0QmluZGluZ3MgIT09IG51bGwgfHwgZGVmLmhvc3RBdHRycyAhPT0gbnVsbCB8fCBkZWYuaG9zdFZhcnMgIT09IDApIHROb2RlLmZsYWdzIHw9IDY0OwogICAgY29uc3QgbGlmZUN5Y2xlSG9va3MgPSBkZWYudHlwZS5wcm90b3R5cGU7CiAgICBpZiAoIXByZU9yZGVySG9va3NGb3VuZCAmJiAobGlmZUN5Y2xlSG9va3MubmdPbkNoYW5nZXMgfHwgbGlmZUN5Y2xlSG9va3MubmdPbkluaXQgfHwgbGlmZUN5Y2xlSG9va3MubmdEb0NoZWNrKSkgewogICAgICAodFZpZXcucHJlT3JkZXJIb29rcyA/Pz0gW10pLnB1c2godE5vZGUuaW5kZXgpOwogICAgICBwcmVPcmRlckhvb2tzRm91bmQgPSB0cnVlOwogICAgfQogICAgaWYgKCFwcmVPcmRlckNoZWNrSG9va3NGb3VuZCAmJiAobGlmZUN5Y2xlSG9va3MubmdPbkNoYW5nZXMgfHwgbGlmZUN5Y2xlSG9va3MubmdEb0NoZWNrKSkgewogICAgICAodFZpZXcucHJlT3JkZXJDaGVja0hvb2tzID8/PSBbXSkucHVzaCh0Tm9kZS5pbmRleCk7CiAgICAgIHByZU9yZGVyQ2hlY2tIb29rc0ZvdW5kID0gdHJ1ZTsKICAgIH0KICAgIGRpcmVjdGl2ZUlkeCsrOwogIH0KICBpbml0aWFsaXplSW5wdXRBbmRPdXRwdXRBbGlhc2VzKHRWaWV3LCB0Tm9kZSwgaG9zdERpcmVjdGl2ZURlZnMpOwp9CmZ1bmN0aW9uIGluaXRpYWxpemVJbnB1dEFuZE91dHB1dEFsaWFzZXModFZpZXcsIHROb2RlLCBob3N0RGlyZWN0aXZlRGVmcykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIGZvciAobGV0IGluZGV4ID0gdE5vZGUuZGlyZWN0aXZlU3RhcnQ7IGluZGV4IDwgdE5vZGUuZGlyZWN0aXZlRW5kOyBpbmRleCsrKSB7CiAgICBjb25zdCBkaXJlY3RpdmVEZWYgPSB0Vmlldy5kYXRhW2luZGV4XTsKICAgIGlmIChob3N0RGlyZWN0aXZlRGVmcyA9PT0gbnVsbCB8fCAhaG9zdERpcmVjdGl2ZURlZnMuaGFzKGRpcmVjdGl2ZURlZikpIHsKICAgICAgc2V0dXBTZWxlY3Rvck1hdGNoZWRJbnB1dHNPck91dHB1dHMoMCwgdE5vZGUsIGRpcmVjdGl2ZURlZiwgaW5kZXgpOwogICAgICBzZXR1cFNlbGVjdG9yTWF0Y2hlZElucHV0c09yT3V0cHV0cygxLCB0Tm9kZSwgZGlyZWN0aXZlRGVmLCBpbmRleCk7CiAgICAgIHNldHVwSW5pdGlhbElucHV0cyh0Tm9kZSwgaW5kZXgsIGZhbHNlKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGhvc3REaXJlY3RpdmVEZWYgPSBob3N0RGlyZWN0aXZlRGVmcy5nZXQoZGlyZWN0aXZlRGVmKTsKICAgICAgc2V0dXBIb3N0RGlyZWN0aXZlSW5wdXRzT3JPdXRwdXRzKDAsIHROb2RlLCBob3N0RGlyZWN0aXZlRGVmLCBpbmRleCk7CiAgICAgIHNldHVwSG9zdERpcmVjdGl2ZUlucHV0c09yT3V0cHV0cygxLCB0Tm9kZSwgaG9zdERpcmVjdGl2ZURlZiwgaW5kZXgpOwogICAgICBzZXR1cEluaXRpYWxJbnB1dHModE5vZGUsIGluZGV4LCB0cnVlKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gc2V0dXBTZWxlY3Rvck1hdGNoZWRJbnB1dHNPck91dHB1dHMobW9kZSwgdE5vZGUsIGRlZiwgZGlyZWN0aXZlSW5kZXgpIHsKICBjb25zdCBhbGlhc01hcCA9IG1vZGUgPT09IDAgPyBkZWYuaW5wdXRzIDogZGVmLm91dHB1dHM7CiAgZm9yIChjb25zdCBwdWJsaWNOYW1lIGluIGFsaWFzTWFwKSB7CiAgICBpZiAoYWxpYXNNYXAuaGFzT3duUHJvcGVydHkocHVibGljTmFtZSkpIHsKICAgICAgbGV0IGJpbmRpbmdzOwogICAgICBpZiAobW9kZSA9PT0gMCkgewogICAgICAgIGJpbmRpbmdzID0gdE5vZGUuaW5wdXRzID8/PSB7fTsKICAgICAgfSBlbHNlIHsKICAgICAgICBiaW5kaW5ncyA9IHROb2RlLm91dHB1dHMgPz89IHt9OwogICAgICB9CiAgICAgIGJpbmRpbmdzW3B1YmxpY05hbWVdID8/PSBbXTsKICAgICAgYmluZGluZ3NbcHVibGljTmFtZV0ucHVzaChkaXJlY3RpdmVJbmRleCk7CiAgICAgIHNldFNoYWRvd1N0eWxpbmdJbnB1dEZsYWdzKHROb2RlLCBwdWJsaWNOYW1lKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gc2V0dXBIb3N0RGlyZWN0aXZlSW5wdXRzT3JPdXRwdXRzKG1vZGUsIHROb2RlLCBjb25maWcyLCBkaXJlY3RpdmVJbmRleCkgewogIGNvbnN0IGFsaWFzTWFwID0gbW9kZSA9PT0gMCA/IGNvbmZpZzIuaW5wdXRzIDogY29uZmlnMi5vdXRwdXRzOwogIGZvciAoY29uc3QgaW5pdGlhbE5hbWUgaW4gYWxpYXNNYXApIHsKICAgIGlmIChhbGlhc01hcC5oYXNPd25Qcm9wZXJ0eShpbml0aWFsTmFtZSkpIHsKICAgICAgY29uc3QgcHVibGljTmFtZSA9IGFsaWFzTWFwW2luaXRpYWxOYW1lXTsKICAgICAgbGV0IGJpbmRpbmdzOwogICAgICBpZiAobW9kZSA9PT0gMCkgewogICAgICAgIGJpbmRpbmdzID0gdE5vZGUuaG9zdERpcmVjdGl2ZUlucHV0cyA/Pz0ge307CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYmluZGluZ3MgPSB0Tm9kZS5ob3N0RGlyZWN0aXZlT3V0cHV0cyA/Pz0ge307CiAgICAgIH0KICAgICAgYmluZGluZ3NbcHVibGljTmFtZV0gPz89IFtdOwogICAgICBiaW5kaW5nc1twdWJsaWNOYW1lXS5wdXNoKGRpcmVjdGl2ZUluZGV4LCBpbml0aWFsTmFtZSk7CiAgICAgIHNldFNoYWRvd1N0eWxpbmdJbnB1dEZsYWdzKHROb2RlLCBwdWJsaWNOYW1lKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gc2V0U2hhZG93U3R5bGluZ0lucHV0RmxhZ3ModE5vZGUsIHB1YmxpY05hbWUpIHsKICBpZiAocHVibGljTmFtZSA9PT0gImNsYXNzIikgewogICAgdE5vZGUuZmxhZ3MgfD0gODsKICB9IGVsc2UgaWYgKHB1YmxpY05hbWUgPT09ICJzdHlsZSIpIHsKICAgIHROb2RlLmZsYWdzIHw9IDE2OwogIH0KfQpmdW5jdGlvbiBzZXR1cEluaXRpYWxJbnB1dHModE5vZGUsIGRpcmVjdGl2ZUluZGV4LCBpc0hvc3REaXJlY3RpdmUpIHsKICBjb25zdCB7CiAgICBhdHRycywKICAgIGlucHV0cywKICAgIGhvc3REaXJlY3RpdmVJbnB1dHMKICB9ID0gdE5vZGU7CiAgaWYgKGF0dHJzID09PSBudWxsIHx8ICFpc0hvc3REaXJlY3RpdmUgJiYgaW5wdXRzID09PSBudWxsIHx8IGlzSG9zdERpcmVjdGl2ZSAmJiBob3N0RGlyZWN0aXZlSW5wdXRzID09PSBudWxsIHx8IGlzSW5saW5lVGVtcGxhdGUodE5vZGUpKSB7CiAgICB0Tm9kZS5pbml0aWFsSW5wdXRzID8/PSBbXTsKICAgIHROb2RlLmluaXRpYWxJbnB1dHMucHVzaChudWxsKTsKICAgIHJldHVybjsKICB9CiAgbGV0IGlucHV0c1RvU3RvcmUgPSBudWxsOwogIGxldCBpID0gMDsKICB3aGlsZSAoaSA8IGF0dHJzLmxlbmd0aCkgewogICAgY29uc3QgYXR0ck5hbWUgPSBhdHRyc1tpXTsKICAgIGlmIChhdHRyTmFtZSA9PT0gMCkgewogICAgICBpICs9IDQ7CiAgICAgIGNvbnRpbnVlOwogICAgfSBlbHNlIGlmIChhdHRyTmFtZSA9PT0gNSkgewogICAgICBpICs9IDI7CiAgICAgIGNvbnRpbnVlOwogICAgfSBlbHNlIGlmICh0eXBlb2YgYXR0ck5hbWUgPT09ICJudW1iZXIiKSB7CiAgICAgIGJyZWFrOwogICAgfQogICAgaWYgKCFpc0hvc3REaXJlY3RpdmUgJiYgaW5wdXRzLmhhc093blByb3BlcnR5KGF0dHJOYW1lKSkgewogICAgICBjb25zdCBpbnB1dENvbmZpZyA9IGlucHV0c1thdHRyTmFtZV07CiAgICAgIGZvciAoY29uc3QgaW5kZXggb2YgaW5wdXRDb25maWcpIHsKICAgICAgICBpZiAoaW5kZXggPT09IGRpcmVjdGl2ZUluZGV4KSB7CiAgICAgICAgICBpbnB1dHNUb1N0b3JlID8/PSBbXTsKICAgICAgICAgIGlucHV0c1RvU3RvcmUucHVzaChhdHRyTmFtZSwgYXR0cnNbaSArIDFdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChpc0hvc3REaXJlY3RpdmUgJiYgaG9zdERpcmVjdGl2ZUlucHV0cy5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkpIHsKICAgICAgY29uc3QgY29uZmlnMiA9IGhvc3REaXJlY3RpdmVJbnB1dHNbYXR0ck5hbWVdOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNvbmZpZzIubGVuZ3RoOyBqICs9IDIpIHsKICAgICAgICBpZiAoY29uZmlnMltqXSA9PT0gZGlyZWN0aXZlSW5kZXgpIHsKICAgICAgICAgIGlucHV0c1RvU3RvcmUgPz89IFtdOwogICAgICAgICAgaW5wdXRzVG9TdG9yZS5wdXNoKGNvbmZpZzJbaiArIDFdLCBhdHRyc1tpICsgMV0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpICs9IDI7CiAgfQogIHROb2RlLmluaXRpYWxJbnB1dHMgPz89IFtdOwogIHROb2RlLmluaXRpYWxJbnB1dHMucHVzaChpbnB1dHNUb1N0b3JlKTsKfQpmdW5jdGlvbiBjb25maWd1cmVWaWV3V2l0aERpcmVjdGl2ZSh0VmlldywgdE5vZGUsIGxWaWV3LCBkaXJlY3RpdmVJbmRleCwgZGVmKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEdyZWF0ZXJUaGFuT3JFcXVhbChkaXJlY3RpdmVJbmRleCwgSEVBREVSX09GRlNFVCwgIk11c3QgYmUgaW4gRXhwYW5kbyBzZWN0aW9uIik7CiAgdFZpZXcuZGF0YVtkaXJlY3RpdmVJbmRleF0gPSBkZWY7CiAgY29uc3QgZGlyZWN0aXZlRmFjdG9yeSA9IGRlZi5mYWN0b3J5IHx8IChkZWYuZmFjdG9yeSA9IGdldEZhY3RvcnlEZWYoZGVmLnR5cGUsIHRydWUpKTsKICBjb25zdCBub2RlSW5qZWN0b3JGYWN0b3J5ID0gbmV3IE5vZGVJbmplY3RvckZhY3RvcnkoZGlyZWN0aXZlRmFjdG9yeSwgaXNDb21wb25lbnREZWYoZGVmKSwgybXJtWRpcmVjdGl2ZUluamVjdCwgbmdEZXZNb2RlID8gZGVmLnR5cGUubmFtZSA6IG51bGwpOwogIHRWaWV3LmJsdWVwcmludFtkaXJlY3RpdmVJbmRleF0gPSBub2RlSW5qZWN0b3JGYWN0b3J5OwogIGxWaWV3W2RpcmVjdGl2ZUluZGV4XSA9IG5vZGVJbmplY3RvckZhY3Rvcnk7CiAgcmVnaXN0ZXJIb3N0QmluZGluZ09wQ29kZXModFZpZXcsIHROb2RlLCBkaXJlY3RpdmVJbmRleCwgYWxsb2NFeHBhbmRvKHRWaWV3LCBsVmlldywgZGVmLmhvc3RWYXJzLCBOT19DSEFOR0UpLCBkZWYpOwp9CmZ1bmN0aW9uIHJlZ2lzdGVySG9zdEJpbmRpbmdPcENvZGVzKHRWaWV3LCB0Tm9kZSwgZGlyZWN0aXZlSWR4LCBkaXJlY3RpdmVWYXJzSWR4LCBkZWYpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Rmlyc3RDcmVhdGVQYXNzKHRWaWV3KTsKICBjb25zdCBob3N0QmluZGluZ3MgPSBkZWYuaG9zdEJpbmRpbmdzOwogIGlmIChob3N0QmluZGluZ3MpIHsKICAgIGxldCBob3N0QmluZGluZ09wQ29kZXMgPSB0Vmlldy5ob3N0QmluZGluZ09wQ29kZXM7CiAgICBpZiAoaG9zdEJpbmRpbmdPcENvZGVzID09PSBudWxsKSB7CiAgICAgIGhvc3RCaW5kaW5nT3BDb2RlcyA9IHRWaWV3Lmhvc3RCaW5kaW5nT3BDb2RlcyA9IFtdOwogICAgfQogICAgY29uc3QgZWxlbWVudEluZHggPSB+dE5vZGUuaW5kZXg7CiAgICBpZiAobGFzdFNlbGVjdGVkRWxlbWVudElkeChob3N0QmluZGluZ09wQ29kZXMpICE9IGVsZW1lbnRJbmR4KSB7CiAgICAgIGhvc3RCaW5kaW5nT3BDb2Rlcy5wdXNoKGVsZW1lbnRJbmR4KTsKICAgIH0KICAgIGhvc3RCaW5kaW5nT3BDb2Rlcy5wdXNoKGRpcmVjdGl2ZUlkeCwgZGlyZWN0aXZlVmFyc0lkeCwgaG9zdEJpbmRpbmdzKTsKICB9Cn0KZnVuY3Rpb24gbGFzdFNlbGVjdGVkRWxlbWVudElkeChob3N0QmluZGluZ09wQ29kZXMpIHsKICBsZXQgaSA9IGhvc3RCaW5kaW5nT3BDb2Rlcy5sZW5ndGg7CiAgd2hpbGUgKGkgPiAwKSB7CiAgICBjb25zdCB2YWx1ZSA9IGhvc3RCaW5kaW5nT3BDb2Rlc1stLWldOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIgJiYgdmFsdWUgPCAwKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9CiAgcmV0dXJuIDA7Cn0KZnVuY3Rpb24gc2F2ZU5hbWVUb0V4cG9ydE1hcChkaXJlY3RpdmVJZHgsIGRlZiwgZXhwb3J0c01hcCkgewogIGlmIChleHBvcnRzTWFwKSB7CiAgICBpZiAoZGVmLmV4cG9ydEFzKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVmLmV4cG9ydEFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZXhwb3J0c01hcFtkZWYuZXhwb3J0QXNbaV1dID0gZGlyZWN0aXZlSWR4OwogICAgICB9CiAgICB9CiAgICBpZiAoaXNDb21wb25lbnREZWYoZGVmKSkgZXhwb3J0c01hcFsiIl0gPSBkaXJlY3RpdmVJZHg7CiAgfQp9CmZ1bmN0aW9uIGluaXRUTm9kZUZsYWdzKHROb2RlLCBpbmRleCwgbnVtYmVyT2ZEaXJlY3RpdmVzKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdEVxdWFsKG51bWJlck9mRGlyZWN0aXZlcywgdE5vZGUuZGlyZWN0aXZlRW5kIC0gdE5vZGUuZGlyZWN0aXZlU3RhcnQsICJSZWFjaGVkIHRoZSBtYXggbnVtYmVyIG9mIGRpcmVjdGl2ZXMiKTsKICB0Tm9kZS5mbGFncyB8PSAxOwogIHROb2RlLmRpcmVjdGl2ZVN0YXJ0ID0gaW5kZXg7CiAgdE5vZGUuZGlyZWN0aXZlRW5kID0gaW5kZXggKyBudW1iZXJPZkRpcmVjdGl2ZXM7CiAgdE5vZGUucHJvdmlkZXJJbmRleGVzID0gaW5kZXg7Cn0KZnVuY3Rpb24gYXNzZXJ0Tm9EdXBsaWNhdGVEaXJlY3RpdmVzKGRpcmVjdGl2ZXMpIHsKICBpZiAoZGlyZWN0aXZlcy5sZW5ndGggPCAyKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHNlZW5EaXJlY3RpdmVzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICBmb3IgKGNvbnN0IGN1cnJlbnQgb2YgZGlyZWN0aXZlcykgewogICAgaWYgKHNlZW5EaXJlY3RpdmVzLmhhcyhjdXJyZW50KSkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDMwOSwgYERpcmVjdGl2ZSAke2N1cnJlbnQudHlwZS5uYW1lfSBtYXRjaGVzIG11bHRpcGxlIHRpbWVzIG9uIHRoZSBzYW1lIGVsZW1lbnQuIERpcmVjdGl2ZXMgY2FuIG9ubHkgbWF0Y2ggYW4gZWxlbWVudCBvbmNlLmApOwogICAgfQogICAgc2VlbkRpcmVjdGl2ZXMuYWRkKGN1cnJlbnQpOwogIH0KfQpmdW5jdGlvbiBkaXJlY3RpdmVIb3N0Rmlyc3RDcmVhdGVQYXNzKGluZGV4LCBsVmlldywgdHlwZSwgbmFtZSwgZGlyZWN0aXZlTWF0Y2hlciwgYmluZGluZ3NFbmFibGVkLCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCkgewogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIGNvbnN0IHRWaWV3Q29uc3RzID0gdFZpZXcuY29uc3RzOwogIGNvbnN0IGF0dHJzID0gZ2V0Q29uc3RhbnQodFZpZXdDb25zdHMsIGF0dHJzSW5kZXgpOwogIGNvbnN0IHROb2RlID0gZ2V0T3JDcmVhdGVUTm9kZSh0VmlldywgaW5kZXgsIHR5cGUsIG5hbWUsIGF0dHJzKTsKICBpZiAoYmluZGluZ3NFbmFibGVkKSB7CiAgICByZXNvbHZlRGlyZWN0aXZlcyh0VmlldywgbFZpZXcsIHROb2RlLCBnZXRDb25zdGFudCh0Vmlld0NvbnN0cywgbG9jYWxSZWZzSW5kZXgpLCBkaXJlY3RpdmVNYXRjaGVyKTsKICB9CiAgdE5vZGUubWVyZ2VkQXR0cnMgPSBtZXJnZUhvc3RBdHRycyh0Tm9kZS5tZXJnZWRBdHRycywgdE5vZGUuYXR0cnMpOwogIGlmICh0Tm9kZS5hdHRycyAhPT0gbnVsbCkgewogICAgY29tcHV0ZVN0YXRpY1N0eWxpbmcodE5vZGUsIHROb2RlLmF0dHJzLCBmYWxzZSk7CiAgfQogIGlmICh0Tm9kZS5tZXJnZWRBdHRycyAhPT0gbnVsbCkgewogICAgY29tcHV0ZVN0YXRpY1N0eWxpbmcodE5vZGUsIHROb2RlLm1lcmdlZEF0dHJzLCB0cnVlKTsKICB9CiAgaWYgKHRWaWV3LnF1ZXJpZXMgIT09IG51bGwpIHsKICAgIHRWaWV3LnF1ZXJpZXMuZWxlbWVudFN0YXJ0KHRWaWV3LCB0Tm9kZSk7CiAgfQogIHJldHVybiB0Tm9kZTsKfQpmdW5jdGlvbiBkaXJlY3RpdmVIb3N0RW5kRmlyc3RDcmVhdGVQYXNzKHRWaWV3LCB0Tm9kZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIHJlZ2lzdGVyUG9zdE9yZGVySG9va3ModFZpZXcsIHROb2RlKTsKICBpZiAoaXNDb250ZW50UXVlcnlIb3N0KHROb2RlKSkgewogICAgdFZpZXcucXVlcmllcy5lbGVtZW50RW5kKHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gZG9tT25seUZpcnN0Q3JlYXRlUGFzcyhpbmRleCwgdFZpZXcsIHR5cGUsIG5hbWUsIGF0dHJzSW5kZXgsIGxvY2FsUmVmc0luZGV4KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEZpcnN0Q3JlYXRlUGFzcyh0Vmlldyk7CiAgY29uc3QgdFZpZXdDb25zdHMgPSB0Vmlldy5jb25zdHM7CiAgY29uc3QgYXR0cnMgPSBnZXRDb25zdGFudCh0Vmlld0NvbnN0cywgYXR0cnNJbmRleCk7CiAgY29uc3QgdE5vZGUgPSBnZXRPckNyZWF0ZVROb2RlKHRWaWV3LCBpbmRleCwgdHlwZSwgbmFtZSwgYXR0cnMpOwogIHROb2RlLm1lcmdlZEF0dHJzID0gbWVyZ2VIb3N0QXR0cnModE5vZGUubWVyZ2VkQXR0cnMsIHROb2RlLmF0dHJzKTsKICBpZiAobG9jYWxSZWZzSW5kZXggIT0gbnVsbCkgewogICAgY29uc3QgcmVmcyA9IGdldENvbnN0YW50KHRWaWV3Q29uc3RzLCBsb2NhbFJlZnNJbmRleCk7CiAgICB0Tm9kZS5sb2NhbE5hbWVzID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlZnMubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgdE5vZGUubG9jYWxOYW1lcy5wdXNoKHJlZnNbaV0sIC0xKTsKICAgIH0KICB9CiAgaWYgKHROb2RlLmF0dHJzICE9PSBudWxsKSB7CiAgICBjb21wdXRlU3RhdGljU3R5bGluZyh0Tm9kZSwgdE5vZGUuYXR0cnMsIGZhbHNlKTsKICB9CiAgaWYgKHROb2RlLm1lcmdlZEF0dHJzICE9PSBudWxsKSB7CiAgICBjb21wdXRlU3RhdGljU3R5bGluZyh0Tm9kZSwgdE5vZGUubWVyZ2VkQXR0cnMsIHRydWUpOwogIH0KICBpZiAodFZpZXcucXVlcmllcyAhPT0gbnVsbCkgewogICAgdFZpZXcucXVlcmllcy5lbGVtZW50U3RhcnQodFZpZXcsIHROb2RlKTsKICB9CiAgcmV0dXJuIHROb2RlOwp9CmZ1bmN0aW9uIGlzTGlzdExpa2VJdGVyYWJsZShvYmopIHsKICBpZiAoIWlzSnNPYmplY3Qob2JqKSkgcmV0dXJuIGZhbHNlOwogIHJldHVybiBBcnJheS5pc0FycmF5KG9iaikgfHwgIShvYmogaW5zdGFuY2VvZiBNYXApICYmIFN5bWJvbC5pdGVyYXRvciBpbiBvYmo7Cn0KZnVuY3Rpb24gYXJlSXRlcmFibGVzRXF1YWwoYSwgYiwgY29tcGFyYXRvcikgewogIGNvbnN0IGl0ZXJhdG9yMSA9IGFbU3ltYm9sLml0ZXJhdG9yXSgpOwogIGNvbnN0IGl0ZXJhdG9yMiA9IGJbU3ltYm9sLml0ZXJhdG9yXSgpOwogIHdoaWxlICh0cnVlKSB7CiAgICBjb25zdCBpdGVtMSA9IGl0ZXJhdG9yMS5uZXh0KCk7CiAgICBjb25zdCBpdGVtMiA9IGl0ZXJhdG9yMi5uZXh0KCk7CiAgICBpZiAoaXRlbTEuZG9uZSAmJiBpdGVtMi5kb25lKSByZXR1cm4gdHJ1ZTsKICAgIGlmIChpdGVtMS5kb25lIHx8IGl0ZW0yLmRvbmUpIHJldHVybiBmYWxzZTsKICAgIGlmICghY29tcGFyYXRvcihpdGVtMS52YWx1ZSwgaXRlbTIudmFsdWUpKSByZXR1cm4gZmFsc2U7CiAgfQp9CmZ1bmN0aW9uIGl0ZXJhdGVMaXN0TGlrZShvYmosIGZuKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHsKICAgICAgZm4ob2JqW2ldKTsKICAgIH0KICB9IGVsc2UgewogICAgY29uc3QgaXRlcmF0b3IyID0gb2JqW1N5bWJvbC5pdGVyYXRvcl0oKTsKICAgIGxldCBpdGVtOwogICAgd2hpbGUgKCEoaXRlbSA9IGl0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpIHsKICAgICAgZm4oaXRlbS52YWx1ZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGlzSnNPYmplY3QobykgewogIHJldHVybiBvICE9PSBudWxsICYmICh0eXBlb2YgbyA9PT0gImZ1bmN0aW9uIiB8fCB0eXBlb2YgbyA9PT0gIm9iamVjdCIpOwp9CmZ1bmN0aW9uIGRldk1vZGVFcXVhbChhLCBiKSB7CiAgY29uc3QgaXNMaXN0TGlrZUl0ZXJhYmxlQSA9IGlzTGlzdExpa2VJdGVyYWJsZShhKTsKICBjb25zdCBpc0xpc3RMaWtlSXRlcmFibGVCID0gaXNMaXN0TGlrZUl0ZXJhYmxlKGIpOwogIGlmIChpc0xpc3RMaWtlSXRlcmFibGVBICYmIGlzTGlzdExpa2VJdGVyYWJsZUIpIHsKICAgIHJldHVybiBhcmVJdGVyYWJsZXNFcXVhbChhLCBiLCBkZXZNb2RlRXF1YWwpOwogIH0gZWxzZSB7CiAgICBjb25zdCBpc0FPYmplY3QgPSBhICYmICh0eXBlb2YgYSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGEgPT09ICJmdW5jdGlvbiIpOwogICAgY29uc3QgaXNCT2JqZWN0ID0gYiAmJiAodHlwZW9mIGIgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBiID09PSAiZnVuY3Rpb24iKTsKICAgIGlmICghaXNMaXN0TGlrZUl0ZXJhYmxlQSAmJiBpc0FPYmplY3QgJiYgIWlzTGlzdExpa2VJdGVyYWJsZUIgJiYgaXNCT2JqZWN0KSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIE9iamVjdC5pcyhhLCBiKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gdXBkYXRlQmluZGluZyhsVmlldywgYmluZGluZ0luZGV4LCB2YWx1ZSkgewogIHJldHVybiBsVmlld1tiaW5kaW5nSW5kZXhdID0gdmFsdWU7Cn0KZnVuY3Rpb24gZ2V0QmluZGluZyhsVmlldywgYmluZGluZ0luZGV4KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgYmluZGluZ0luZGV4KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90U2FtZShsVmlld1tiaW5kaW5nSW5kZXhdLCBOT19DSEFOR0UsICJTdG9yZWQgdmFsdWUgc2hvdWxkIG5ldmVyIGJlIE5PX0NIQU5HRS4iKTsKICByZXR1cm4gbFZpZXdbYmluZGluZ0luZGV4XTsKfQpmdW5jdGlvbiBiaW5kaW5nVXBkYXRlZChsVmlldywgYmluZGluZ0luZGV4LCB2YWx1ZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRMZXNzVGhhbihiaW5kaW5nSW5kZXgsIGxWaWV3Lmxlbmd0aCwgYFNsb3Qgc2hvdWxkIGhhdmUgYmVlbiBpbml0aWFsaXplZCB0byBOT19DSEFOR0VgKTsKICBpZiAodmFsdWUgPT09IE5PX0NIQU5HRSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICBjb25zdCBvbGRWYWx1ZSA9IGxWaWV3W2JpbmRpbmdJbmRleF07CiAgaWYgKE9iamVjdC5pcyhvbGRWYWx1ZSwgdmFsdWUpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfSBlbHNlIHsKICAgIGlmIChuZ0Rldk1vZGUgJiYgaXNJbkNoZWNrTm9DaGFuZ2VzTW9kZSgpKSB7CiAgICAgIGNvbnN0IG9sZFZhbHVlVG9Db21wYXJlID0gb2xkVmFsdWUgIT09IE5PX0NIQU5HRSA/IG9sZFZhbHVlIDogdm9pZCAwOwogICAgICBpZiAoIWRldk1vZGVFcXVhbChvbGRWYWx1ZVRvQ29tcGFyZSwgdmFsdWUpKSB7CiAgICAgICAgY29uc3QgZGV0YWlscyA9IGdldEV4cHJlc3Npb25DaGFuZ2VkRXJyb3JEZXRhaWxzKGxWaWV3LCBiaW5kaW5nSW5kZXgsIG9sZFZhbHVlVG9Db21wYXJlLCB2YWx1ZSk7CiAgICAgICAgdGhyb3dFcnJvcklmTm9DaGFuZ2VzTW9kZShvbGRWYWx1ZSA9PT0gTk9fQ0hBTkdFLCBkZXRhaWxzLm9sZFZhbHVlLCBkZXRhaWxzLm5ld1ZhbHVlLCBkZXRhaWxzLnByb3BOYW1lLCBsVmlldyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgbFZpZXdbYmluZGluZ0luZGV4XSA9IHZhbHVlOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CmZ1bmN0aW9uIGJpbmRpbmdVcGRhdGVkMihsVmlldywgYmluZGluZ0luZGV4LCBleHAxLCBleHAyKSB7CiAgY29uc3QgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQobFZpZXcsIGJpbmRpbmdJbmRleCwgZXhwMSk7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXggKyAxLCBleHAyKSB8fCBkaWZmZXJlbnQ7Cn0KZnVuY3Rpb24gYmluZGluZ1VwZGF0ZWQzKGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cDEsIGV4cDIsIGV4cDMpIHsKICBjb25zdCBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDIobFZpZXcsIGJpbmRpbmdJbmRleCwgZXhwMSwgZXhwMik7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXggKyAyLCBleHAzKSB8fCBkaWZmZXJlbnQ7Cn0KZnVuY3Rpb24gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpIHsKICBjb25zdCBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDIobFZpZXcsIGJpbmRpbmdJbmRleCwgZXhwMSwgZXhwMik7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkMihsVmlldywgYmluZGluZ0luZGV4ICsgMiwgZXhwMywgZXhwNCkgfHwgZGlmZmVyZW50Owp9CnZhciDJtUNPTlRST0wgPSAvKiBAX19QVVJFX18gKi8gU3ltYm9sKCJDT05UUk9MIik7CmZ1bmN0aW9uIHdyYXBMaXN0ZW5lcih0Tm9kZSwgbFZpZXcsIGxpc3RlbmVyRm4pIHsKICByZXR1cm4gZnVuY3Rpb24gd3JhcExpc3RlbmVySW5fbWFya0RpcnR5QW5kUHJldmVudERlZmF1bHQoZXZlbnQpIHsKICAgIGNvbnN0IHN0YXJ0VmlldyA9IGlzQ29tcG9uZW50SG9zdCh0Tm9kZSkgPyBnZXRDb21wb25lbnRMVmlld0J5SW5kZXgodE5vZGUuaW5kZXgsIGxWaWV3KSA6IGxWaWV3OwogICAgbWFya1ZpZXdEaXJ0eShzdGFydFZpZXcsIDUpOwogICAgY29uc3QgY29udGV4dDIgPSBsVmlld1tDT05URVhUXTsKICAgIGxldCByZXN1bHQgPSBleGVjdXRlTGlzdGVuZXJXaXRoRXJyb3JIYW5kbGluZyhsVmlldywgY29udGV4dDIsIGxpc3RlbmVyRm4sIGV2ZW50KTsKICAgIGxldCBuZXh0TGlzdGVuZXJGbiA9IHdyYXBMaXN0ZW5lckluX21hcmtEaXJ0eUFuZFByZXZlbnREZWZhdWx0Ll9fbmdOZXh0TGlzdGVuZXJGbl9fOwogICAgd2hpbGUgKG5leHRMaXN0ZW5lckZuKSB7CiAgICAgIHJlc3VsdCA9IGV4ZWN1dGVMaXN0ZW5lcldpdGhFcnJvckhhbmRsaW5nKGxWaWV3LCBjb250ZXh0MiwgbmV4dExpc3RlbmVyRm4sIGV2ZW50KSAmJiByZXN1bHQ7CiAgICAgIG5leHRMaXN0ZW5lckZuID0gbmV4dExpc3RlbmVyRm4uX19uZ05leHRMaXN0ZW5lckZuX187CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH07Cn0KZnVuY3Rpb24gZXhlY3V0ZUxpc3RlbmVyV2l0aEVycm9ySGFuZGxpbmcobFZpZXcsIGNvbnRleHQyLCBsaXN0ZW5lckZuLCBlKSB7CiAgY29uc3QgcHJldkNvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgdHJ5IHsKICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuT3V0cHV0U3RhcnQsIGNvbnRleHQyLCBsaXN0ZW5lckZuKTsKICAgIHJldHVybiBsaXN0ZW5lckZuKGUpICE9PSBmYWxzZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgaGFuZGxlVW5jYXVnaHRFcnJvcihsVmlldywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0gZmluYWxseSB7CiAgICBwcm9maWxlcihQcm9maWxlckV2ZW50Lk91dHB1dEVuZCwgY29udGV4dDIsIGxpc3RlbmVyRm4pOwogICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICB9Cn0KZnVuY3Rpb24gbGlzdGVuVG9Eb21FdmVudCh0Tm9kZSwgdFZpZXcsIGxWaWV3LCBldmVudFRhcmdldFJlc29sdmVyLCByZW5kZXJlciwgZXZlbnROYW1lLCBvcmlnaW5hbExpc3RlbmVyLCB3cmFwcGVkTGlzdGVuZXIpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90U2FtZSh3cmFwcGVkTGlzdGVuZXIsIG9yaWdpbmFsTGlzdGVuZXIsICJFeHBlY3RlZCB3cmFwcGVkIGFuZCBvcmlnaW5hbCBsaXN0ZW5lcnMgdG8gYmUgZGlmZmVyZW50LiIpOwogIGNvbnN0IGlzVE5vZGVEaXJlY3RpdmVIb3N0ID0gaXNEaXJlY3RpdmVIb3N0KHROb2RlKTsKICBsZXQgaGFzQ29hbGVzY2VkID0gZmFsc2U7CiAgbGV0IGV4aXN0aW5nTGlzdGVuZXIgPSBudWxsOwogIGlmICghZXZlbnRUYXJnZXRSZXNvbHZlciAmJiBpc1ROb2RlRGlyZWN0aXZlSG9zdCkgewogICAgZXhpc3RpbmdMaXN0ZW5lciA9IGZpbmRFeGlzdGluZ0xpc3RlbmVyKHRWaWV3LCBsVmlldywgZXZlbnROYW1lLCB0Tm9kZS5pbmRleCk7CiAgfQogIGlmIChleGlzdGluZ0xpc3RlbmVyICE9PSBudWxsKSB7CiAgICBjb25zdCBsYXN0TGlzdGVuZXJGbiA9IGV4aXN0aW5nTGlzdGVuZXIuX19uZ0xhc3RMaXN0ZW5lckZuX18gfHwgZXhpc3RpbmdMaXN0ZW5lcjsKICAgIGxhc3RMaXN0ZW5lckZuLl9fbmdOZXh0TGlzdGVuZXJGbl9fID0gb3JpZ2luYWxMaXN0ZW5lcjsKICAgIGV4aXN0aW5nTGlzdGVuZXIuX19uZ0xhc3RMaXN0ZW5lckZuX18gPSBvcmlnaW5hbExpc3RlbmVyOwogICAgaGFzQ29hbGVzY2VkID0gdHJ1ZTsKICB9IGVsc2UgewogICAgY29uc3QgbmF0aXZlID0gZ2V0TmF0aXZlQnlUTm9kZSh0Tm9kZSwgbFZpZXcpOwogICAgY29uc3QgdGFyZ2V0ID0gZXZlbnRUYXJnZXRSZXNvbHZlciA/IGV2ZW50VGFyZ2V0UmVzb2x2ZXIobmF0aXZlKSA6IG5hdGl2ZTsKICAgIHN0YXNoRXZlbnRMaXN0ZW5lckltcGwobFZpZXcsIHRhcmdldCwgZXZlbnROYW1lLCB3cmFwcGVkTGlzdGVuZXIpOwogICAgY29uc3QgY2xlYW51cEZuID0gcmVuZGVyZXIubGlzdGVuKHRhcmdldCwgZXZlbnROYW1lLCB3cmFwcGVkTGlzdGVuZXIpOwogICAgaWYgKCFpc0FuaW1hdGlvbkV2ZW50VHlwZShldmVudE5hbWUpKSB7CiAgICAgIGNvbnN0IGlkeE9yVGFyZ2V0R2V0dGVyID0gZXZlbnRUYXJnZXRSZXNvbHZlciA/IChfbFZpZXcpID0+IGV2ZW50VGFyZ2V0UmVzb2x2ZXIodW53cmFwUk5vZGUoX2xWaWV3W3ROb2RlLmluZGV4XSkpIDogdE5vZGUuaW5kZXg7CiAgICAgIHN0b3JlTGlzdGVuZXJDbGVhbnVwKGlkeE9yVGFyZ2V0R2V0dGVyLCB0VmlldywgbFZpZXcsIGV2ZW50TmFtZSwgd3JhcHBlZExpc3RlbmVyLCBjbGVhbnVwRm4sIGZhbHNlKTsKICAgIH0KICB9CiAgcmV0dXJuIGhhc0NvYWxlc2NlZDsKfQpmdW5jdGlvbiBpc0FuaW1hdGlvbkV2ZW50VHlwZShldmVudE5hbWUpIHsKICByZXR1cm4gZXZlbnROYW1lLnN0YXJ0c1dpdGgoImFuaW1hdGlvbiIpIHx8IGV2ZW50TmFtZS5zdGFydHNXaXRoKCJ0cmFuc2l0aW9uIik7Cn0KZnVuY3Rpb24gZmluZEV4aXN0aW5nTGlzdGVuZXIodFZpZXcsIGxWaWV3LCBldmVudE5hbWUsIHROb2RlSW5kZXgpIHsKICBjb25zdCB0Q2xlYW51cCA9IHRWaWV3LmNsZWFudXA7CiAgaWYgKHRDbGVhbnVwICE9IG51bGwpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdENsZWFudXAubGVuZ3RoIC0gMTsgaSArPSAyKSB7CiAgICAgIGNvbnN0IGNsZWFudXBFdmVudE5hbWUgPSB0Q2xlYW51cFtpXTsKICAgICAgaWYgKGNsZWFudXBFdmVudE5hbWUgPT09IGV2ZW50TmFtZSAmJiB0Q2xlYW51cFtpICsgMV0gPT09IHROb2RlSW5kZXgpIHsKICAgICAgICBjb25zdCBsQ2xlYW51cCA9IGxWaWV3W0NMRUFOVVBdOwogICAgICAgIGNvbnN0IGxpc3RlbmVySWR4SW5MQ2xlYW51cCA9IHRDbGVhbnVwW2kgKyAyXTsKICAgICAgICByZXR1cm4gbENsZWFudXAgJiYgbENsZWFudXAubGVuZ3RoID4gbGlzdGVuZXJJZHhJbkxDbGVhbnVwID8gbENsZWFudXBbbGlzdGVuZXJJZHhJbkxDbGVhbnVwXSA6IG51bGw7CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjbGVhbnVwRXZlbnROYW1lID09PSAic3RyaW5nIikgewogICAgICAgIGkgKz0gMjsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBzdG9yZUxpc3RlbmVyQ2xlYW51cChpbmRleE9yVGFyZ2V0R2V0dGVyLCB0VmlldywgbFZpZXcsIGV2ZW50TmFtZSwgbGlzdGVuZXJGbiwgY2xlYW51cCwgaXNPdXRwdXQpIHsKICBjb25zdCB0Q2xlYW51cCA9IHRWaWV3LmZpcnN0Q3JlYXRlUGFzcyA/IGdldE9yQ3JlYXRlVFZpZXdDbGVhbnVwKHRWaWV3KSA6IG51bGw7CiAgY29uc3QgbENsZWFudXAgPSBnZXRPckNyZWF0ZUxWaWV3Q2xlYW51cChsVmlldyk7CiAgY29uc3QgaW5kZXggPSBsQ2xlYW51cC5sZW5ndGg7CiAgbENsZWFudXAucHVzaChsaXN0ZW5lckZuLCBjbGVhbnVwKTsKICB0Q2xlYW51cCAmJiB0Q2xlYW51cC5wdXNoKGV2ZW50TmFtZSwgaW5kZXhPclRhcmdldEdldHRlciwgaW5kZXgsIChpbmRleCArIDEpICogKGlzT3V0cHV0ID8gLTEgOiAxKSk7Cn0KZnVuY3Rpb24gY3JlYXRlT3V0cHV0TGlzdGVuZXIodE5vZGUsIGxWaWV3LCBsaXN0ZW5lckZuLCB0YXJnZXREZWYsIGV2ZW50TmFtZSkgewogIGNvbnN0IHdyYXBwZWRMaXN0ZW5lciA9IHdyYXBMaXN0ZW5lcih0Tm9kZSwgbFZpZXcsIGxpc3RlbmVyRm4pOwogIGNvbnN0IGhhc0JvdW5kID0gbGlzdGVuVG9EaXJlY3RpdmVPdXRwdXQodE5vZGUsIGxWaWV3LCB0YXJnZXREZWYsIGV2ZW50TmFtZSwgd3JhcHBlZExpc3RlbmVyKTsKICBpZiAoIWhhc0JvdW5kICYmIG5nRGV2TW9kZSkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigzMTYsIGAke3N0cmluZ2lmeUZvckVycm9yKHRhcmdldERlZi50eXBlKX0gZG9lcyBub3QgaGF2ZSBhbiBvdXRwdXQgd2l0aCBhIHB1YmxpYyBuYW1lIG9mICIke2V2ZW50TmFtZX0iLmApOwogIH0KfQpmdW5jdGlvbiBsaXN0ZW5Ub0RpcmVjdGl2ZU91dHB1dCh0Tm9kZSwgbFZpZXcsIHRhcmdldCwgZXZlbnROYW1lLCBsaXN0ZW5lckZuKSB7CiAgbGV0IGhvc3RJbmRleCA9IG51bGw7CiAgbGV0IGhvc3REaXJlY3RpdmVzU3RhcnQgPSBudWxsOwogIGxldCBob3N0RGlyZWN0aXZlc0VuZCA9IG51bGw7CiAgbGV0IGhhc091dHB1dDIgPSBmYWxzZTsKICBpZiAobmdEZXZNb2RlICYmICF0Tm9kZS5kaXJlY3RpdmVUb0luZGV4Py5oYXModGFyZ2V0LnR5cGUpKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoYE5vZGUgZG9lcyBub3QgaGF2ZSBhIGRpcmVjdGl2ZSB3aXRoIHR5cGUgJHt0YXJnZXQudHlwZS5uYW1lfWApOwogIH0KICBjb25zdCBkYXRhID0gdE5vZGUuZGlyZWN0aXZlVG9JbmRleC5nZXQodGFyZ2V0LnR5cGUpOwogIGlmICh0eXBlb2YgZGF0YSA9PT0gIm51bWJlciIpIHsKICAgIGhvc3RJbmRleCA9IGRhdGE7CiAgfSBlbHNlIHsKICAgIFtob3N0SW5kZXgsIGhvc3REaXJlY3RpdmVzU3RhcnQsIGhvc3REaXJlY3RpdmVzRW5kXSA9IGRhdGE7CiAgfQogIGlmIChob3N0RGlyZWN0aXZlc1N0YXJ0ICE9PSBudWxsICYmIGhvc3REaXJlY3RpdmVzRW5kICE9PSBudWxsICYmIHROb2RlLmhvc3REaXJlY3RpdmVPdXRwdXRzPy5oYXNPd25Qcm9wZXJ0eShldmVudE5hbWUpKSB7CiAgICBjb25zdCBob3N0RGlyZWN0aXZlT3V0cHV0cyA9IHROb2RlLmhvc3REaXJlY3RpdmVPdXRwdXRzW2V2ZW50TmFtZV07CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhvc3REaXJlY3RpdmVPdXRwdXRzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIGNvbnN0IGluZGV4ID0gaG9zdERpcmVjdGl2ZU91dHB1dHNbaV07CiAgICAgIGlmIChpbmRleCA+PSBob3N0RGlyZWN0aXZlc1N0YXJ0ICYmIGluZGV4IDw9IGhvc3REaXJlY3RpdmVzRW5kKSB7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgaW5kZXgpOwogICAgICAgIGhhc091dHB1dDIgPSB0cnVlOwogICAgICAgIGxpc3RlblRvT3V0cHV0KHROb2RlLCBsVmlldywgaW5kZXgsIGhvc3REaXJlY3RpdmVPdXRwdXRzW2kgKyAxXSwgZXZlbnROYW1lLCBsaXN0ZW5lckZuKTsKICAgICAgfSBlbHNlIGlmIChpbmRleCA+IGhvc3REaXJlY3RpdmVzRW5kKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9CiAgaWYgKHRhcmdldC5vdXRwdXRzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXcsIGhvc3RJbmRleCk7CiAgICBoYXNPdXRwdXQyID0gdHJ1ZTsKICAgIGxpc3RlblRvT3V0cHV0KHROb2RlLCBsVmlldywgaG9zdEluZGV4LCBldmVudE5hbWUsIGV2ZW50TmFtZSwgbGlzdGVuZXJGbik7CiAgfQogIHJldHVybiBoYXNPdXRwdXQyOwp9CmZ1bmN0aW9uIGxpc3RlblRvT3V0cHV0KHROb2RlLCBsVmlldywgZGlyZWN0aXZlSW5kZXgsIGxvb2t1cE5hbWUsIGV2ZW50TmFtZSwgbGlzdGVuZXJGbikgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXcsIGRpcmVjdGl2ZUluZGV4KTsKICBjb25zdCBpbnN0YW5jZSA9IGxWaWV3W2RpcmVjdGl2ZUluZGV4XTsKICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCBkZWYgPSB0Vmlldy5kYXRhW2RpcmVjdGl2ZUluZGV4XTsKICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBkZWYub3V0cHV0c1tsb29rdXBOYW1lXTsKICBjb25zdCBvdXRwdXQyID0gaW5zdGFuY2VbcHJvcGVydHlOYW1lXTsKICBpZiAobmdEZXZNb2RlICYmICFpc091dHB1dFN1YnNjcmliYWJsZShvdXRwdXQyKSkgewogICAgdGhyb3cgbmV3IEVycm9yKGBAT3V0cHV0ICR7cHJvcGVydHlOYW1lfSBub3QgaW5pdGlhbGl6ZWQgaW4gJyR7aW5zdGFuY2UuY29uc3RydWN0b3IubmFtZX0nLmApOwogIH0KICBjb25zdCBzdWJzY3JpcHRpb24gPSBvdXRwdXQyLnN1YnNjcmliZShsaXN0ZW5lckZuKTsKICBzdG9yZUxpc3RlbmVyQ2xlYW51cCh0Tm9kZS5pbmRleCwgdFZpZXcsIGxWaWV3LCBldmVudE5hbWUsIGxpc3RlbmVyRm4sIHN1YnNjcmlwdGlvbiwgdHJ1ZSk7Cn0KZnVuY3Rpb24gaXNPdXRwdXRTdWJzY3JpYmFibGUodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUuc3Vic2NyaWJlID09PSAiZnVuY3Rpb24iOwp9CnZhciBCSU5ESU5HID0gLyogQF9fUFVSRV9fICovIFN5bWJvbCgiQklORElORyIpOwp2YXIgSU5QVVRfQklORElOR19NRVRBREFUQSA9IHsKICBraW5kOiAiaW5wdXQiLAogIHJlcXVpcmVkVmFyczogMQp9Owp2YXIgRklFTERfQklORElOR19NRVRBREFUQSA9IHsKICBraW5kOiAiZmllbGQiLAogIHJlcXVpcmVkVmFyczogMgp9Owp2YXIgT1VUUFVUX0JJTkRJTkdfTUVUQURBVEEgPSB7CiAga2luZDogIm91dHB1dCIsCiAgcmVxdWlyZWRWYXJzOiAwCn07CmZ1bmN0aW9uIGlucHV0QmluZGluZ1VwZGF0ZSh0YXJnZXREaXJlY3RpdmVJZHgsIHB1YmxpY05hbWUsIHZhbHVlKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGJpbmRpbmdJbmRleCA9IG5leHRCaW5kaW5nSW5kZXgoKTsKICBpZiAoYmluZGluZ1VwZGF0ZWQobFZpZXcsIGJpbmRpbmdJbmRleCwgdmFsdWUpKSB7CiAgICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICAgIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogICAgY29uc3QgY29tcG9uZW50TFZpZXcgPSBnZXRDb21wb25lbnRMVmlld0J5SW5kZXgodE5vZGUuaW5kZXgsIGxWaWV3KTsKICAgIG1hcmtWaWV3RGlydHkoY29tcG9uZW50TFZpZXcsIDEpOwogICAgY29uc3QgdGFyZ2V0RGVmID0gdFZpZXcuZGlyZWN0aXZlUmVnaXN0cnlbdGFyZ2V0RGlyZWN0aXZlSWR4XTsKICAgIGlmIChuZ0Rldk1vZGUgJiYgIXRhcmdldERlZikgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDMxNSwgYElucHV0IGJpbmRpbmcgdG8gcHJvcGVydHkgIiR7cHVibGljTmFtZX0iIGRvZXMgbm90IGhhdmUgYSB0YXJnZXQuYCk7CiAgICB9CiAgICBjb25zdCBoYXNTZXQgPSBzZXREaXJlY3RpdmVJbnB1dCh0Tm9kZSwgdFZpZXcsIGxWaWV3LCB0YXJnZXREZWYsIHB1YmxpY05hbWUsIHZhbHVlKTsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgaWYgKCFoYXNTZXQpIHsKICAgICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDMxNSwgYCR7c3RyaW5naWZ5Rm9yRXJyb3IodGFyZ2V0RGVmLnR5cGUpfSBkb2VzIG5vdCBoYXZlIGFuIGlucHV0IHdpdGggYSBwdWJsaWMgbmFtZSBvZiAiJHtwdWJsaWNOYW1lfSIuYCk7CiAgICAgIH0KICAgICAgc3RvcmVQcm9wZXJ0eUJpbmRpbmdNZXRhZGF0YSh0Vmlldy5kYXRhLCB0Tm9kZSwgcHVibGljTmFtZSwgYmluZGluZ0luZGV4KTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gY29udHJvbEJpbmRpbmcoYmluZGluZywgdE5vZGUpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgZGlyZWN0aXZlID0gbFZpZXdbdE5vZGUuZGlyZWN0aXZlU3RhcnQgKyBiaW5kaW5nLnRhcmdldElkeF07CiAgcmV0dXJuIGRpcmVjdGl2ZVvJtUNPTlRST0xdOwp9CmZ1bmN0aW9uIGlucHV0QmluZGluZyhwdWJsaWNOYW1lLCB2YWx1ZSkgewogIGlmIChwdWJsaWNOYW1lID09PSAiZm9ybUZpZWxkIikgewogICAgY29uc3QgYmluZGluZzIgPSB7CiAgICAgIFtCSU5ESU5HXTogRklFTERfQklORElOR19NRVRBREFUQSwKICAgICAgY3JlYXRlOiAoKSA9PiB7CiAgICAgICAgY29udHJvbEJpbmRpbmcoYmluZGluZzIsIGdldEN1cnJlbnRUTm9kZSgpKT8uY3JlYXRlKCk7CiAgICAgIH0sCiAgICAgIHVwZGF0ZTogKCkgPT4gewogICAgICAgIGlucHV0QmluZGluZ1VwZGF0ZShiaW5kaW5nMi50YXJnZXRJZHgsIHB1YmxpY05hbWUsIHZhbHVlKCkpOwogICAgICAgIGNvbnRyb2xCaW5kaW5nKGJpbmRpbmcyLCBnZXRTZWxlY3RlZFROb2RlKCkpPy51cGRhdGUoKTsKICAgICAgfQogICAgfTsKICAgIHJldHVybiBiaW5kaW5nMjsKICB9CiAgY29uc3QgYmluZGluZyA9IHsKICAgIFtCSU5ESU5HXTogSU5QVVRfQklORElOR19NRVRBREFUQSwKICAgIHVwZGF0ZTogKCkgPT4gaW5wdXRCaW5kaW5nVXBkYXRlKGJpbmRpbmcudGFyZ2V0SWR4LCBwdWJsaWNOYW1lLCB2YWx1ZSgpKQogIH07CiAgcmV0dXJuIGJpbmRpbmc7Cn0KZnVuY3Rpb24gb3V0cHV0QmluZGluZyhldmVudE5hbWUsIGxpc3RlbmVyKSB7CiAgY29uc3QgYmluZGluZyA9IHsKICAgIFtCSU5ESU5HXTogT1VUUFVUX0JJTkRJTkdfTUVUQURBVEEsCiAgICBjcmVhdGU6ICgpID0+IHsKICAgICAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogICAgICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogICAgICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICAgICAgY29uc3QgdGFyZ2V0RGVmID0gdFZpZXcuZGlyZWN0aXZlUmVnaXN0cnlbYmluZGluZy50YXJnZXRJZHhdOwogICAgICBjcmVhdGVPdXRwdXRMaXN0ZW5lcih0Tm9kZSwgbFZpZXcsIGxpc3RlbmVyLCB0YXJnZXREZWYsIGV2ZW50TmFtZSk7CiAgICB9CiAgfTsKICByZXR1cm4gYmluZGluZzsKfQpmdW5jdGlvbiB0d29XYXlCaW5kaW5nKHB1YmxpY05hbWUsIHZhbHVlKSB7CiAgY29uc3QgaW5wdXQyID0gaW5wdXRCaW5kaW5nKHB1YmxpY05hbWUsIHZhbHVlKTsKICBjb25zdCBvdXRwdXQyID0gb3V0cHV0QmluZGluZyhwdWJsaWNOYW1lICsgIkNoYW5nZSIsIChldmVudFZhbHVlKSA9PiB2YWx1ZS5zZXQoZXZlbnRWYWx1ZSkpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3REZWZpbmVkKGlucHV0Mi5jcmVhdGUsICJVbmV4cGVjdGVkIGBjcmVhdGVgIGNhbGxiYWNrIGluIGlucHV0QmluZGluZyIpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3REZWZpbmVkKG91dHB1dDIudXBkYXRlLCAiVW5leHBlY3RlZCBgdXBkYXRlYCBjYWxsYmFjayBpbiBvdXRwdXRCaW5kaW5nIik7CiAgY29uc3QgYmluZGluZyA9IHsKICAgIFtCSU5ESU5HXTogewogICAgICBraW5kOiAidHdvV2F5IiwKICAgICAgcmVxdWlyZWRWYXJzOiBpbnB1dDJbQklORElOR10ucmVxdWlyZWRWYXJzICsgb3V0cHV0MltCSU5ESU5HXS5yZXF1aXJlZFZhcnMKICAgIH0sCiAgICBzZXQgdGFyZ2V0SWR4KGlkeCkgewogICAgICBpbnB1dDIudGFyZ2V0SWR4ID0gaWR4OwogICAgICBvdXRwdXQyLnRhcmdldElkeCA9IGlkeDsKICAgIH0sCiAgICBjcmVhdGU6IG91dHB1dDIuY3JlYXRlLAogICAgdXBkYXRlOiBpbnB1dDIudXBkYXRlCiAgfTsKICByZXR1cm4gYmluZGluZzsKfQp2YXIgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyMiA9IGNsYXNzIGV4dGVuZHMgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyJDEgewogIG5nTW9kdWxlOwogIGNvbnN0cnVjdG9yKG5nTW9kdWxlKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5uZ01vZHVsZSA9IG5nTW9kdWxlOwogIH0KICByZXNvbHZlQ29tcG9uZW50RmFjdG9yeShjb21wb25lbnQpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRDb21wb25lbnRUeXBlKGNvbXBvbmVudCk7CiAgICBjb25zdCBjb21wb25lbnREZWYgPSBnZXRDb21wb25lbnREZWYoY29tcG9uZW50KTsKICAgIHJldHVybiBuZXcgQ29tcG9uZW50RmFjdG9yeTIoY29tcG9uZW50RGVmLCB0aGlzLm5nTW9kdWxlKTsKICB9Cn07CmZ1bmN0aW9uIHRvSW5wdXRSZWZBcnJheShtYXAyKSB7CiAgcmV0dXJuIE9iamVjdC5rZXlzKG1hcDIpLm1hcCgobmFtZSkgPT4gewogICAgY29uc3QgW3Byb3BOYW1lLCBmbGFncywgdHJhbnNmb3JtXSA9IG1hcDJbbmFtZV07CiAgICBjb25zdCBpbnB1dERhdGEgPSB7CiAgICAgIHByb3BOYW1lLAogICAgICB0ZW1wbGF0ZU5hbWU6IG5hbWUsCiAgICAgIGlzU2lnbmFsOiAoZmxhZ3MgJiBJbnB1dEZsYWdzLlNpZ25hbEJhc2VkKSAhPT0gMAogICAgfTsKICAgIGlmICh0cmFuc2Zvcm0pIHsKICAgICAgaW5wdXREYXRhLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTsKICAgIH0KICAgIHJldHVybiBpbnB1dERhdGE7CiAgfSk7Cn0KZnVuY3Rpb24gdG9PdXRwdXRSZWZBcnJheShtYXAyKSB7CiAgcmV0dXJuIE9iamVjdC5rZXlzKG1hcDIpLm1hcCgobmFtZSkgPT4gKHsKICAgIHByb3BOYW1lOiBtYXAyW25hbWVdLAogICAgdGVtcGxhdGVOYW1lOiBuYW1lCiAgfSkpOwp9CmZ1bmN0aW9uIHZlcmlmeU5vdEFuT3JwaGFuQ29tcG9uZW50KGNvbXBvbmVudERlZikgewogIGlmIChmYWxzZSkgewogICAgaWYgKGRlcHNUcmFja2VyLmlzT3JwaGFuQ29tcG9uZW50KGNvbXBvbmVudERlZi50eXBlKSkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDk4MSwgYE9ycGhhbiBjb21wb25lbnQgZm91bmQhIFRyeWluZyB0byByZW5kZXIgdGhlIGNvbXBvbmVudCAke2RlYnVnU3RyaW5naWZ5VHlwZUZvckVycm9yKGNvbXBvbmVudERlZi50eXBlKX0gd2l0aG91dCBmaXJzdCBsb2FkaW5nIHRoZSBOZ01vZHVsZSB0aGF0IGRlY2xhcmVzIGl0LiBJdCBpcyByZWNvbW1lbmRlZCB0byBtYWtlIHRoaXMgY29tcG9uZW50IHN0YW5kYWxvbmUgaW4gb3JkZXIgdG8gYXZvaWQgdGhpcyBlcnJvci4gSWYgdGhpcyBpcyBub3QgcG9zc2libGUgbm93LCBpbXBvcnQgdGhlIGNvbXBvbmVudCdzIE5nTW9kdWxlIGluIHRoZSBhcHByb3ByaWF0ZSBOZ01vZHVsZSwgb3IgdGhlIHN0YW5kYWxvbmUgY29tcG9uZW50IGluIHdoaWNoIHlvdSBhcmUgdHJ5aW5nIHRvIHJlbmRlciB0aGlzIGNvbXBvbmVudC4gSWYgdGhpcyBpcyBhIGxhenkgaW1wb3J0LCBsb2FkIHRoZSBOZ01vZHVsZSBsYXppbHkgYXMgd2VsbCBhbmQgdXNlIGl0cyBtb2R1bGUgaW5qZWN0b3IuYCk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGNyZWF0ZVJvb3RWaWV3SW5qZWN0b3IoY29tcG9uZW50RGVmLCBlbnZpcm9ubWVudEluamVjdG9yLCBpbmplY3RvcikgewogIGxldCByZWFsRW52aXJvbm1lbnRJbmplY3RvciA9IGVudmlyb25tZW50SW5qZWN0b3IgaW5zdGFuY2VvZiBFbnZpcm9ubWVudEluamVjdG9yID8gZW52aXJvbm1lbnRJbmplY3RvciA6IGVudmlyb25tZW50SW5qZWN0b3I/LmluamVjdG9yOwogIGlmIChyZWFsRW52aXJvbm1lbnRJbmplY3RvciAmJiBjb21wb25lbnREZWYuZ2V0U3RhbmRhbG9uZUluamVjdG9yICE9PSBudWxsKSB7CiAgICByZWFsRW52aXJvbm1lbnRJbmplY3RvciA9IGNvbXBvbmVudERlZi5nZXRTdGFuZGFsb25lSW5qZWN0b3IocmVhbEVudmlyb25tZW50SW5qZWN0b3IpIHx8IHJlYWxFbnZpcm9ubWVudEluamVjdG9yOwogIH0KICBjb25zdCByb290Vmlld0luamVjdG9yID0gcmVhbEVudmlyb25tZW50SW5qZWN0b3IgPyBuZXcgQ2hhaW5lZEluamVjdG9yKGluamVjdG9yLCByZWFsRW52aXJvbm1lbnRJbmplY3RvcikgOiBpbmplY3RvcjsKICByZXR1cm4gcm9vdFZpZXdJbmplY3RvcjsKfQpmdW5jdGlvbiBjcmVhdGVSb290TFZpZXdFbnZpcm9ubWVudChyb290TFZpZXdJbmplY3RvcikgewogIGNvbnN0IHJlbmRlcmVyRmFjdG9yeSA9IHJvb3RMVmlld0luamVjdG9yLmdldChSZW5kZXJlckZhY3RvcnkyLCBudWxsKTsKICBpZiAocmVuZGVyZXJGYWN0b3J5ID09PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDQwNywgbmdEZXZNb2RlICYmICJBbmd1bGFyIHdhcyBub3QgYWJsZSB0byBpbmplY3QgYSByZW5kZXJlciAoUmVuZGVyZXJGYWN0b3J5MikuIExpa2VseSB0aGlzIGlzIGR1ZSB0byBhIGJyb2tlbiBESSBoaWVyYXJjaHkuIE1ha2Ugc3VyZSB0aGF0IGFueSBpbmplY3RvciB1c2VkIHRvIGNyZWF0ZSB0aGlzIGNvbXBvbmVudCBoYXMgYSBjb3JyZWN0IHBhcmVudC4iKTsKICB9CiAgY29uc3Qgc2FuaXRpemVyID0gcm9vdExWaWV3SW5qZWN0b3IuZ2V0KFNhbml0aXplciwgbnVsbCk7CiAgY29uc3QgY2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyID0gcm9vdExWaWV3SW5qZWN0b3IuZ2V0KENoYW5nZURldGVjdGlvblNjaGVkdWxlciwgbnVsbCk7CiAgbGV0IG5nUmVmbGVjdCA9IGZhbHNlOwogIGlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICAgIG5nUmVmbGVjdCA9IHJvb3RMVmlld0luamVjdG9yLmdldChOR19SRUZMRUNUX0FUVFJTX0ZMQUcsIE5HX1JFRkxFQ1RfQVRUUlNfRkxBR19ERUZBVUxUKTsKICB9CiAgcmV0dXJuIHsKICAgIHJlbmRlcmVyRmFjdG9yeSwKICAgIHNhbml0aXplciwKICAgIGNoYW5nZURldGVjdGlvblNjaGVkdWxlciwKICAgIG5nUmVmbGVjdAogIH07Cn0KZnVuY3Rpb24gY3JlYXRlSG9zdEVsZW1lbnQoY29tcG9uZW50RGVmLCByZW5kZXJlcikgewogIGNvbnN0IHRhZ05hbWUgPSBpbmZlclRhZ05hbWVGcm9tRGVmaW5pdGlvbihjb21wb25lbnREZWYpOwogIGNvbnN0IG5hbWVzcGFjZSA9IHRhZ05hbWUgPT09ICJzdmciID8gU1ZHX05BTUVTUEFDRSA6IHRhZ05hbWUgPT09ICJtYXRoIiA/IE1BVEhfTUxfTkFNRVNQQUNFIDogbnVsbDsKICByZXR1cm4gY3JlYXRlRWxlbWVudE5vZGUocmVuZGVyZXIsIHRhZ05hbWUsIG5hbWVzcGFjZSk7Cn0KZnVuY3Rpb24gaW5mZXJUYWdOYW1lRnJvbURlZmluaXRpb24oY29tcG9uZW50RGVmKSB7CiAgcmV0dXJuIChjb21wb25lbnREZWYuc2VsZWN0b3JzWzBdWzBdIHx8ICJkaXYiKS50b0xvd2VyQ2FzZSgpOwp9CnZhciBDb21wb25lbnRGYWN0b3J5MiA9IGNsYXNzIGV4dGVuZHMgQ29tcG9uZW50RmFjdG9yeSQxIHsKICBjb21wb25lbnREZWY7CiAgbmdNb2R1bGU7CiAgc2VsZWN0b3I7CiAgY29tcG9uZW50VHlwZTsKICBuZ0NvbnRlbnRTZWxlY3RvcnM7CiAgaXNCb3VuZFRvTW9kdWxlOwogIGNhY2hlZElucHV0cyA9IG51bGw7CiAgY2FjaGVkT3V0cHV0cyA9IG51bGw7CiAgZ2V0IGlucHV0cygpIHsKICAgIHRoaXMuY2FjaGVkSW5wdXRzID8/PSB0b0lucHV0UmVmQXJyYXkodGhpcy5jb21wb25lbnREZWYuaW5wdXRzKTsKICAgIHJldHVybiB0aGlzLmNhY2hlZElucHV0czsKICB9CiAgZ2V0IG91dHB1dHMoKSB7CiAgICB0aGlzLmNhY2hlZE91dHB1dHMgPz89IHRvT3V0cHV0UmVmQXJyYXkodGhpcy5jb21wb25lbnREZWYub3V0cHV0cyk7CiAgICByZXR1cm4gdGhpcy5jYWNoZWRPdXRwdXRzOwogIH0KICBjb25zdHJ1Y3Rvcihjb21wb25lbnREZWYsIG5nTW9kdWxlKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5jb21wb25lbnREZWYgPSBjb21wb25lbnREZWY7CiAgICB0aGlzLm5nTW9kdWxlID0gbmdNb2R1bGU7CiAgICB0aGlzLmNvbXBvbmVudFR5cGUgPSBjb21wb25lbnREZWYudHlwZTsKICAgIHRoaXMuc2VsZWN0b3IgPSBzdHJpbmdpZnlDU1NTZWxlY3Rvckxpc3QoY29tcG9uZW50RGVmLnNlbGVjdG9ycyk7CiAgICB0aGlzLm5nQ29udGVudFNlbGVjdG9ycyA9IGNvbXBvbmVudERlZi5uZ0NvbnRlbnRTZWxlY3RvcnMgPz8gW107CiAgICB0aGlzLmlzQm91bmRUb01vZHVsZSA9ICEhbmdNb2R1bGU7CiAgfQogIGNyZWF0ZShpbmplY3RvciwgcHJvamVjdGFibGVOb2Rlcywgcm9vdFNlbGVjdG9yT3JOb2RlLCBlbnZpcm9ubWVudEluamVjdG9yLCBkaXJlY3RpdmVzLCBjb21wb25lbnRCaW5kaW5ncykgewogICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5EeW5hbWljQ29tcG9uZW50U3RhcnQpOwogICAgY29uc3QgcHJldkNvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgICB0cnkgewogICAgICBjb25zdCBjbXBEZWYgPSB0aGlzLmNvbXBvbmVudERlZjsKICAgICAgbmdEZXZNb2RlICYmIHZlcmlmeU5vdEFuT3JwaGFuQ29tcG9uZW50KGNtcERlZik7CiAgICAgIGNvbnN0IHJvb3RUVmlldyA9IGNyZWF0ZVJvb3RUVmlldyhyb290U2VsZWN0b3JPck5vZGUsIGNtcERlZiwgY29tcG9uZW50QmluZGluZ3MsIGRpcmVjdGl2ZXMpOwogICAgICBjb25zdCByb290Vmlld0luamVjdG9yID0gY3JlYXRlUm9vdFZpZXdJbmplY3RvcihjbXBEZWYsIGVudmlyb25tZW50SW5qZWN0b3IgfHwgdGhpcy5uZ01vZHVsZSwgaW5qZWN0b3IpOwogICAgICBjb25zdCBlbnZpcm9ubWVudCA9IGNyZWF0ZVJvb3RMVmlld0Vudmlyb25tZW50KHJvb3RWaWV3SW5qZWN0b3IpOwogICAgICBjb25zdCBob3N0UmVuZGVyZXIgPSBlbnZpcm9ubWVudC5yZW5kZXJlckZhY3RvcnkuY3JlYXRlUmVuZGVyZXIobnVsbCwgY21wRGVmKTsKICAgICAgY29uc3QgaG9zdEVsZW1lbnQgPSByb290U2VsZWN0b3JPck5vZGUgPyBsb2NhdGVIb3N0RWxlbWVudChob3N0UmVuZGVyZXIsIHJvb3RTZWxlY3Rvck9yTm9kZSwgY21wRGVmLmVuY2Fwc3VsYXRpb24sIHJvb3RWaWV3SW5qZWN0b3IpIDogY3JlYXRlSG9zdEVsZW1lbnQoY21wRGVmLCBob3N0UmVuZGVyZXIpOwogICAgICBjb25zdCBoYXNJbnB1dEJpbmRpbmdzID0gY29tcG9uZW50QmluZGluZ3M/LnNvbWUoaXNJbnB1dEJpbmRpbmcpIHx8IGRpcmVjdGl2ZXM/LnNvbWUoKGQpID0+IHR5cGVvZiBkICE9PSAiZnVuY3Rpb24iICYmIGQuYmluZGluZ3Muc29tZShpc0lucHV0QmluZGluZykpOwogICAgICBjb25zdCByb290TFZpZXcgPSBjcmVhdGVMVmlldyhudWxsLCByb290VFZpZXcsIG51bGwsIDUxMiB8IGdldEluaXRpYWxMVmlld0ZsYWdzRnJvbURlZihjbXBEZWYpLCBudWxsLCBudWxsLCBlbnZpcm9ubWVudCwgaG9zdFJlbmRlcmVyLCByb290Vmlld0luamVjdG9yLCBudWxsLCByZXRyaWV2ZUh5ZHJhdGlvbkluZm8oaG9zdEVsZW1lbnQsIHJvb3RWaWV3SW5qZWN0b3IsIHRydWUpKTsKICAgICAgcm9vdExWaWV3W0hFQURFUl9PRkZTRVRdID0gaG9zdEVsZW1lbnQ7CiAgICAgIGVudGVyVmlldyhyb290TFZpZXcpOwogICAgICBsZXQgY29tcG9uZW50VmlldyA9IG51bGw7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgaG9zdFROb2RlID0gZGlyZWN0aXZlSG9zdEZpcnN0Q3JlYXRlUGFzcyhIRUFERVJfT0ZGU0VULCByb290TFZpZXcsIDIsICIjaG9zdCIsICgpID0+IHJvb3RUVmlldy5kaXJlY3RpdmVSZWdpc3RyeSwgdHJ1ZSwgMCk7CiAgICAgICAgc2V0dXBTdGF0aWNBdHRyaWJ1dGVzKGhvc3RSZW5kZXJlciwgaG9zdEVsZW1lbnQsIGhvc3RUTm9kZSk7CiAgICAgICAgYXR0YWNoUGF0Y2hEYXRhKGhvc3RFbGVtZW50LCByb290TFZpZXcpOwogICAgICAgIGNyZWF0ZURpcmVjdGl2ZXNJbnN0YW5jZXMocm9vdFRWaWV3LCByb290TFZpZXcsIGhvc3RUTm9kZSk7CiAgICAgICAgZXhlY3V0ZUNvbnRlbnRRdWVyaWVzKHJvb3RUVmlldywgaG9zdFROb2RlLCByb290TFZpZXcpOwogICAgICAgIGRpcmVjdGl2ZUhvc3RFbmRGaXJzdENyZWF0ZVBhc3Mocm9vdFRWaWV3LCBob3N0VE5vZGUpOwogICAgICAgIGlmIChwcm9qZWN0YWJsZU5vZGVzICE9PSB2b2lkIDApIHsKICAgICAgICAgIHByb2plY3ROb2Rlcyhob3N0VE5vZGUsIHRoaXMubmdDb250ZW50U2VsZWN0b3JzLCBwcm9qZWN0YWJsZU5vZGVzKTsKICAgICAgICB9CiAgICAgICAgY29tcG9uZW50VmlldyA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleChob3N0VE5vZGUuaW5kZXgsIHJvb3RMVmlldyk7CiAgICAgICAgcm9vdExWaWV3W0NPTlRFWFRdID0gY29tcG9uZW50Vmlld1tDT05URVhUXTsKICAgICAgICByZW5kZXJWaWV3KHJvb3RUVmlldywgcm9vdExWaWV3LCBudWxsKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGlmIChjb21wb25lbnRWaWV3ICE9PSBudWxsKSB7CiAgICAgICAgICB1bnJlZ2lzdGVyTFZpZXcoY29tcG9uZW50Vmlldyk7CiAgICAgICAgfQogICAgICAgIHVucmVnaXN0ZXJMVmlldyhyb290TFZpZXcpOwogICAgICAgIHRocm93IGU7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5EeW5hbWljQ29tcG9uZW50RW5kKTsKICAgICAgICBsZWF2ZVZpZXcoKTsKICAgICAgfQogICAgICByZXR1cm4gbmV3IENvbXBvbmVudFJlZjIodGhpcy5jb21wb25lbnRUeXBlLCByb290TFZpZXcsICEhaGFzSW5wdXRCaW5kaW5ncyk7CiAgICB9IGZpbmFsbHkgewogICAgICBzZXRBY3RpdmVDb25zdW1lcihwcmV2Q29uc3VtZXIpOwogICAgfQogIH0KfTsKZnVuY3Rpb24gY3JlYXRlUm9vdFRWaWV3KHJvb3RTZWxlY3Rvck9yTm9kZSwgY29tcG9uZW50RGVmLCBjb21wb25lbnRCaW5kaW5ncywgZGlyZWN0aXZlcykgewogIGNvbnN0IHRBdHRyaWJ1dGVzID0gcm9vdFNlbGVjdG9yT3JOb2RlID8gWyJuZy12ZXJzaW9uIiwgIjIxLjEuMyJdIDogZXh0cmFjdEF0dHJzQW5kQ2xhc3Nlc0Zyb21TZWxlY3Rvcihjb21wb25lbnREZWYuc2VsZWN0b3JzWzBdKTsKICBsZXQgY3JlYXRpb25CaW5kaW5ncyA9IG51bGw7CiAgbGV0IHVwZGF0ZUJpbmRpbmdzID0gbnVsbDsKICBsZXQgdmFyc1RvQWxsb2NhdGUgPSAwOwogIGlmIChjb21wb25lbnRCaW5kaW5ncykgewogICAgZm9yIChjb25zdCBiaW5kaW5nIG9mIGNvbXBvbmVudEJpbmRpbmdzKSB7CiAgICAgIHZhcnNUb0FsbG9jYXRlICs9IGJpbmRpbmdbQklORElOR10ucmVxdWlyZWRWYXJzOwogICAgICBpZiAoYmluZGluZy5jcmVhdGUpIHsKICAgICAgICBiaW5kaW5nLnRhcmdldElkeCA9IDA7CiAgICAgICAgKGNyZWF0aW9uQmluZGluZ3MgPz89IFtdKS5wdXNoKGJpbmRpbmcpOwogICAgICB9CiAgICAgIGlmIChiaW5kaW5nLnVwZGF0ZSkgewogICAgICAgIGJpbmRpbmcudGFyZ2V0SWR4ID0gMDsKICAgICAgICAodXBkYXRlQmluZGluZ3MgPz89IFtdKS5wdXNoKGJpbmRpbmcpOwogICAgICB9CiAgICB9CiAgfQogIGlmIChkaXJlY3RpdmVzKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGl2ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgZGlyZWN0aXZlID0gZGlyZWN0aXZlc1tpXTsKICAgICAgaWYgKHR5cGVvZiBkaXJlY3RpdmUgIT09ICJmdW5jdGlvbiIpIHsKICAgICAgICBmb3IgKGNvbnN0IGJpbmRpbmcgb2YgZGlyZWN0aXZlLmJpbmRpbmdzKSB7CiAgICAgICAgICB2YXJzVG9BbGxvY2F0ZSArPSBiaW5kaW5nW0JJTkRJTkddLnJlcXVpcmVkVmFyczsKICAgICAgICAgIGNvbnN0IHRhcmdldERpcmVjdGl2ZUlkeCA9IGkgKyAxOwogICAgICAgICAgaWYgKGJpbmRpbmcuY3JlYXRlKSB7CiAgICAgICAgICAgIGJpbmRpbmcudGFyZ2V0SWR4ID0gdGFyZ2V0RGlyZWN0aXZlSWR4OwogICAgICAgICAgICAoY3JlYXRpb25CaW5kaW5ncyA/Pz0gW10pLnB1c2goYmluZGluZyk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYmluZGluZy51cGRhdGUpIHsKICAgICAgICAgICAgYmluZGluZy50YXJnZXRJZHggPSB0YXJnZXREaXJlY3RpdmVJZHg7CiAgICAgICAgICAgICh1cGRhdGVCaW5kaW5ncyA/Pz0gW10pLnB1c2goYmluZGluZyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGNvbnN0IGRpcmVjdGl2ZXNUb0FwcGx5ID0gW2NvbXBvbmVudERlZl07CiAgaWYgKGRpcmVjdGl2ZXMpIHsKICAgIGZvciAoY29uc3QgZGlyZWN0aXZlIG9mIGRpcmVjdGl2ZXMpIHsKICAgICAgY29uc3QgZGlyZWN0aXZlVHlwZSA9IHR5cGVvZiBkaXJlY3RpdmUgPT09ICJmdW5jdGlvbiIgPyBkaXJlY3RpdmUgOiBkaXJlY3RpdmUudHlwZTsKICAgICAgY29uc3QgZGlyZWN0aXZlRGVmID0gbmdEZXZNb2RlID8gZ2V0RGlyZWN0aXZlRGVmT3JUaHJvdyhkaXJlY3RpdmVUeXBlKSA6IGdldERpcmVjdGl2ZURlZihkaXJlY3RpdmVUeXBlKTsKICAgICAgaWYgKG5nRGV2TW9kZSAmJiAhZGlyZWN0aXZlRGVmLnN0YW5kYWxvbmUpIHsKICAgICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDkwNywgYFRoZSAke3N0cmluZ2lmeUZvckVycm9yKGRpcmVjdGl2ZVR5cGUpfSBkaXJlY3RpdmUgbXVzdCBiZSBzdGFuZGFsb25lIGluIG9yZGVyIHRvIGJlIGFwcGxpZWQgdG8gYSBkeW5hbWljYWxseS1jcmVhdGVkIGNvbXBvbmVudC5gKTsKICAgICAgfQogICAgICBkaXJlY3RpdmVzVG9BcHBseS5wdXNoKGRpcmVjdGl2ZURlZik7CiAgICB9CiAgfQogIGNvbnN0IHJvb3RUVmlldyA9IGNyZWF0ZVRWaWV3KDAsIG51bGwsIGdldFJvb3RUVmlld1RlbXBsYXRlKGNyZWF0aW9uQmluZGluZ3MsIHVwZGF0ZUJpbmRpbmdzKSwgMSwgdmFyc1RvQWxsb2NhdGUsIGRpcmVjdGl2ZXNUb0FwcGx5LCBudWxsLCBudWxsLCBudWxsLCBbdEF0dHJpYnV0ZXNdLCBudWxsKTsKICByZXR1cm4gcm9vdFRWaWV3Owp9CmZ1bmN0aW9uIGdldFJvb3RUVmlld1RlbXBsYXRlKGNyZWF0aW9uQmluZGluZ3MsIHVwZGF0ZUJpbmRpbmdzKSB7CiAgaWYgKCFjcmVhdGlvbkJpbmRpbmdzICYmICF1cGRhdGVCaW5kaW5ncykgewogICAgcmV0dXJuIG51bGw7CiAgfQogIHJldHVybiAoZmxhZ3MpID0+IHsKICAgIGlmIChmbGFncyAmIDEgJiYgY3JlYXRpb25CaW5kaW5ncykgewogICAgICBmb3IgKGNvbnN0IGJpbmRpbmcgb2YgY3JlYXRpb25CaW5kaW5ncykgewogICAgICAgIGJpbmRpbmcuY3JlYXRlKCk7CiAgICAgIH0KICAgIH0KICAgIGlmIChmbGFncyAmIDIgJiYgdXBkYXRlQmluZGluZ3MpIHsKICAgICAgZm9yIChjb25zdCBiaW5kaW5nIG9mIHVwZGF0ZUJpbmRpbmdzKSB7CiAgICAgICAgYmluZGluZy51cGRhdGUoKTsKICAgICAgfQogICAgfQogIH07Cn0KZnVuY3Rpb24gaXNJbnB1dEJpbmRpbmcoYmluZGluZykgewogIGNvbnN0IGtpbmQgPSBiaW5kaW5nW0JJTkRJTkddLmtpbmQ7CiAgcmV0dXJuIGtpbmQgPT09ICJpbnB1dCIgfHwga2luZCA9PT0gInR3b1dheSI7Cn0KdmFyIENvbXBvbmVudFJlZjIgPSBjbGFzcyBleHRlbmRzIENvbXBvbmVudFJlZiQxIHsKICBfcm9vdExWaWV3OwogIF9oYXNJbnB1dEJpbmRpbmdzOwogIGluc3RhbmNlOwogIGhvc3RWaWV3OwogIGNoYW5nZURldGVjdG9yUmVmOwogIGNvbXBvbmVudFR5cGU7CiAgbG9jYXRpb247CiAgcHJldmlvdXNJbnB1dFZhbHVlcyA9IG51bGw7CiAgX3ROb2RlOwogIGNvbnN0cnVjdG9yKGNvbXBvbmVudFR5cGUsIF9yb290TFZpZXcsIF9oYXNJbnB1dEJpbmRpbmdzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5fcm9vdExWaWV3ID0gX3Jvb3RMVmlldzsKICAgIHRoaXMuX2hhc0lucHV0QmluZGluZ3MgPSBfaGFzSW5wdXRCaW5kaW5nczsKICAgIHRoaXMuX3ROb2RlID0gZ2V0VE5vZGUoX3Jvb3RMVmlld1tUVklFV10sIEhFQURFUl9PRkZTRVQpOwogICAgdGhpcy5sb2NhdGlvbiA9IGNyZWF0ZUVsZW1lbnRSZWYodGhpcy5fdE5vZGUsIF9yb290TFZpZXcpOwogICAgdGhpcy5pbnN0YW5jZSA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleCh0aGlzLl90Tm9kZS5pbmRleCwgX3Jvb3RMVmlldylbQ09OVEVYVF07CiAgICB0aGlzLmhvc3RWaWV3ID0gdGhpcy5jaGFuZ2VEZXRlY3RvclJlZiA9IG5ldyBWaWV3UmVmKF9yb290TFZpZXcsIHZvaWQgMCk7CiAgICB0aGlzLmNvbXBvbmVudFR5cGUgPSBjb21wb25lbnRUeXBlOwogIH0KICBzZXRJbnB1dChuYW1lLCB2YWx1ZSkgewogICAgaWYgKHRoaXMuX2hhc0lucHV0QmluZGluZ3MgJiYgbmdEZXZNb2RlKSB7CiAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMzE3LCAiQ2Fubm90IGNhbGwgYHNldElucHV0YCBvbiBhIGNvbXBvbmVudCB0aGF0IGlzIHVzaW5nIHRoZSBgaW5wdXRCaW5kaW5nYCBvciBgdHdvV2F5QmluZGluZ2AgZnVuY3Rpb25zLiIpOwogICAgfQogICAgY29uc3QgdE5vZGUgPSB0aGlzLl90Tm9kZTsKICAgIHRoaXMucHJldmlvdXNJbnB1dFZhbHVlcyA/Pz0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGlmICh0aGlzLnByZXZpb3VzSW5wdXRWYWx1ZXMuaGFzKG5hbWUpICYmIE9iamVjdC5pcyh0aGlzLnByZXZpb3VzSW5wdXRWYWx1ZXMuZ2V0KG5hbWUpLCB2YWx1ZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgbFZpZXcgPSB0aGlzLl9yb290TFZpZXc7CiAgICBjb25zdCBoYXNTZXRJbnB1dCA9IHNldEFsbElucHV0c0ZvclByb3BlcnR5KHROb2RlLCBsVmlld1tUVklFV10sIGxWaWV3LCBuYW1lLCB2YWx1ZSk7CiAgICB0aGlzLnByZXZpb3VzSW5wdXRWYWx1ZXMuc2V0KG5hbWUsIHZhbHVlKTsKICAgIGNvbnN0IGNoaWxkQ29tcG9uZW50TFZpZXcgPSBnZXRDb21wb25lbnRMVmlld0J5SW5kZXgodE5vZGUuaW5kZXgsIGxWaWV3KTsKICAgIG1hcmtWaWV3RGlydHkoY2hpbGRDb21wb25lbnRMVmlldywgMSk7CiAgICBpZiAobmdEZXZNb2RlICYmICFoYXNTZXRJbnB1dCkgewogICAgICBjb25zdCBjbXBOYW1lRm9yRXJyb3IgPSBzdHJpbmdpZnlGb3JFcnJvcih0aGlzLmNvbXBvbmVudFR5cGUpOwogICAgICBsZXQgbWVzc2FnZSA9IGBDYW4ndCBzZXQgdmFsdWUgb2YgdGhlICcke25hbWV9JyBpbnB1dCBvbiB0aGUgJyR7Y21wTmFtZUZvckVycm9yfScgY29tcG9uZW50LiBgOwogICAgICBtZXNzYWdlICs9IGBNYWtlIHN1cmUgdGhhdCB0aGUgJyR7bmFtZX0nIHByb3BlcnR5IGlzIGRlY2xhcmVkIGFzIGFuIGlucHV0IHVzaW5nIHRoZSBpbnB1dCgpIG9yIG1vZGVsKCkgZnVuY3Rpb24gb3IgdGhlIEBJbnB1dCgpIGRlY29yYXRvci5gOwogICAgICByZXBvcnRVbmtub3duUHJvcGVydHlFcnJvcihtZXNzYWdlKTsKICAgIH0KICB9CiAgZ2V0IGluamVjdG9yKCkgewogICAgcmV0dXJuIG5ldyBOb2RlSW5qZWN0b3IodGhpcy5fdE5vZGUsIHRoaXMuX3Jvb3RMVmlldyk7CiAgfQogIGRlc3Ryb3koKSB7CiAgICB0aGlzLmhvc3RWaWV3LmRlc3Ryb3koKTsKICB9CiAgb25EZXN0cm95KGNhbGxiYWNrKSB7CiAgICB0aGlzLmhvc3RWaWV3Lm9uRGVzdHJveShjYWxsYmFjayk7CiAgfQp9OwpmdW5jdGlvbiBwcm9qZWN0Tm9kZXModE5vZGUsIG5nQ29udGVudFNlbGVjdG9ycywgcHJvamVjdGFibGVOb2RlcykgewogIGNvbnN0IHByb2plY3Rpb24gPSB0Tm9kZS5wcm9qZWN0aW9uID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZ0NvbnRlbnRTZWxlY3RvcnMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IG5vZGVzZm9yU2xvdCA9IHByb2plY3RhYmxlTm9kZXNbaV07CiAgICBwcm9qZWN0aW9uLnB1c2gobm9kZXNmb3JTbG90ICE9IG51bGwgJiYgbm9kZXNmb3JTbG90Lmxlbmd0aCA/IEFycmF5LmZyb20obm9kZXNmb3JTbG90KSA6IG51bGwpOwogIH0KfQp2YXIgVmlld0NvbnRhaW5lclJlZiA9IGNsYXNzIHsKICBzdGF0aWMgX19OR19FTEVNRU5UX0lEX18gPSBpbmplY3RWaWV3Q29udGFpbmVyUmVmOwp9OwpmdW5jdGlvbiBpbmplY3RWaWV3Q29udGFpbmVyUmVmKCkgewogIGNvbnN0IHByZXZpb3VzVE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICByZXR1cm4gY3JlYXRlQ29udGFpbmVyUmVmKHByZXZpb3VzVE5vZGUsIGdldExWaWV3KCkpOwp9CnZhciBWRV9WaWV3Q29udGFpbmVyUmVmID0gVmlld0NvbnRhaW5lclJlZjsKdmFyIFIzVmlld0NvbnRhaW5lclJlZiA9IGNsYXNzIFZpZXdDb250YWluZXJSZWYyIGV4dGVuZHMgVkVfVmlld0NvbnRhaW5lclJlZiB7CiAgX2xDb250YWluZXI7CiAgX2hvc3RUTm9kZTsKICBfaG9zdExWaWV3OwogIGNvbnN0cnVjdG9yKF9sQ29udGFpbmVyLCBfaG9zdFROb2RlLCBfaG9zdExWaWV3KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5fbENvbnRhaW5lciA9IF9sQ29udGFpbmVyOwogICAgdGhpcy5faG9zdFROb2RlID0gX2hvc3RUTm9kZTsKICAgIHRoaXMuX2hvc3RMVmlldyA9IF9ob3N0TFZpZXc7CiAgfQogIGdldCBlbGVtZW50KCkgewogICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnRSZWYodGhpcy5faG9zdFROb2RlLCB0aGlzLl9ob3N0TFZpZXcpOwogIH0KICBnZXQgaW5qZWN0b3IoKSB7CiAgICByZXR1cm4gbmV3IE5vZGVJbmplY3Rvcih0aGlzLl9ob3N0VE5vZGUsIHRoaXMuX2hvc3RMVmlldyk7CiAgfQogIGdldCBwYXJlbnRJbmplY3RvcigpIHsKICAgIGNvbnN0IHBhcmVudExvY2F0aW9uID0gZ2V0UGFyZW50SW5qZWN0b3JMb2NhdGlvbih0aGlzLl9ob3N0VE5vZGUsIHRoaXMuX2hvc3RMVmlldyk7CiAgICBpZiAoaGFzUGFyZW50SW5qZWN0b3IocGFyZW50TG9jYXRpb24pKSB7CiAgICAgIGNvbnN0IHBhcmVudFZpZXcgPSBnZXRQYXJlbnRJbmplY3RvclZpZXcocGFyZW50TG9jYXRpb24sIHRoaXMuX2hvc3RMVmlldyk7CiAgICAgIGNvbnN0IGluamVjdG9ySW5kZXggPSBnZXRQYXJlbnRJbmplY3RvckluZGV4KHBhcmVudExvY2F0aW9uKTsKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydE5vZGVJbmplY3RvcihwYXJlbnRWaWV3LCBpbmplY3RvckluZGV4KTsKICAgICAgY29uc3QgcGFyZW50VE5vZGUgPSBwYXJlbnRWaWV3W1RWSUVXXS5kYXRhW2luamVjdG9ySW5kZXggKyA4XTsKICAgICAgcmV0dXJuIG5ldyBOb2RlSW5qZWN0b3IocGFyZW50VE5vZGUsIHBhcmVudFZpZXcpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG5ldyBOb2RlSW5qZWN0b3IobnVsbCwgdGhpcy5faG9zdExWaWV3KTsKICAgIH0KICB9CiAgY2xlYXIoKSB7CiAgICB3aGlsZSAodGhpcy5sZW5ndGggPiAwKSB7CiAgICAgIHRoaXMucmVtb3ZlKHRoaXMubGVuZ3RoIC0gMSk7CiAgICB9CiAgfQogIGdldChpbmRleCkgewogICAgY29uc3Qgdmlld1JlZnMgPSBnZXRWaWV3UmVmcyh0aGlzLl9sQ29udGFpbmVyKTsKICAgIHJldHVybiB2aWV3UmVmcyAhPT0gbnVsbCAmJiB2aWV3UmVmc1tpbmRleF0gfHwgbnVsbDsKICB9CiAgZ2V0IGxlbmd0aCgpIHsKICAgIHJldHVybiB0aGlzLl9sQ29udGFpbmVyLmxlbmd0aCAtIENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUOwogIH0KICBjcmVhdGVFbWJlZGRlZFZpZXcodGVtcGxhdGVSZWYsIGNvbnRleHQyLCBpbmRleE9yT3B0aW9ucykgewogICAgbGV0IGluZGV4OwogICAgbGV0IGluamVjdG9yOwogICAgaWYgKHR5cGVvZiBpbmRleE9yT3B0aW9ucyA9PT0gIm51bWJlciIpIHsKICAgICAgaW5kZXggPSBpbmRleE9yT3B0aW9uczsKICAgIH0gZWxzZSBpZiAoaW5kZXhPck9wdGlvbnMgIT0gbnVsbCkgewogICAgICBpbmRleCA9IGluZGV4T3JPcHRpb25zLmluZGV4OwogICAgICBpbmplY3RvciA9IGluZGV4T3JPcHRpb25zLmluamVjdG9yOwogICAgfQogICAgY29uc3QgZGVoeWRyYXRlZFZpZXcgPSBmaW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlldyh0aGlzLl9sQ29udGFpbmVyLCB0ZW1wbGF0ZVJlZi5zc3JJZCk7CiAgICBjb25zdCB2aWV3UmVmID0gdGVtcGxhdGVSZWYuY3JlYXRlRW1iZWRkZWRWaWV3SW1wbChjb250ZXh0MiB8fCB7fSwgaW5qZWN0b3IsIGRlaHlkcmF0ZWRWaWV3KTsKICAgIHRoaXMuaW5zZXJ0SW1wbCh2aWV3UmVmLCBpbmRleCwgc2hvdWxkQWRkVmlld1RvRG9tKHRoaXMuX2hvc3RUTm9kZSwgZGVoeWRyYXRlZFZpZXcpKTsKICAgIHJldHVybiB2aWV3UmVmOwogIH0KICBjcmVhdGVDb21wb25lbnQoY29tcG9uZW50RmFjdG9yeU9yVHlwZSwgaW5kZXhPck9wdGlvbnMsIGluamVjdG9yLCBwcm9qZWN0YWJsZU5vZGVzLCBlbnZpcm9ubWVudEluamVjdG9yLCBkaXJlY3RpdmVzLCBiaW5kaW5ncykgewogICAgY29uc3QgaXNDb21wb25lbnRGYWN0b3J5ID0gY29tcG9uZW50RmFjdG9yeU9yVHlwZSAmJiAhaXNUeXBlKGNvbXBvbmVudEZhY3RvcnlPclR5cGUpOwogICAgbGV0IGluZGV4OwogICAgaWYgKGlzQ29tcG9uZW50RmFjdG9yeSkgewogICAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgICAgYXNzZXJ0RXF1YWwodHlwZW9mIGluZGV4T3JPcHRpb25zICE9PSAib2JqZWN0IiwgdHJ1ZSwgIkl0IGxvb2tzIGxpa2UgQ29tcG9uZW50IGZhY3Rvcnkgd2FzIHByb3ZpZGVkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCBhbmQgYW4gb3B0aW9ucyBvYmplY3QgYXMgdGhlIHNlY29uZCBhcmd1bWVudC4gVGhpcyBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMgaXMgaW5jb21wYXRpYmxlLiBZb3UgY2FuIGVpdGhlciBjaGFuZ2UgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHByb3ZpZGUgQ29tcG9uZW50IHR5cGUgb3IgY2hhbmdlIHRoZSBzZWNvbmQgYXJndW1lbnQgdG8gYmUgYSBudW1iZXIgKHJlcHJlc2VudGluZyBhbiBpbmRleCBhdCB3aGljaCB0byBpbnNlcnQgdGhlIG5ldyBjb21wb25lbnQncyBob3N0IHZpZXcgaW50byB0aGlzIGNvbnRhaW5lcikiKTsKICAgICAgfQogICAgICBpbmRleCA9IGluZGV4T3JPcHRpb25zOwogICAgfSBlbHNlIHsKICAgICAgaWYgKG5nRGV2TW9kZSkgewogICAgICAgIGFzc2VydERlZmluZWQoZ2V0Q29tcG9uZW50RGVmKGNvbXBvbmVudEZhY3RvcnlPclR5cGUpLCBgUHJvdmlkZWQgQ29tcG9uZW50IGNsYXNzIGRvZXNuJ3QgY29udGFpbiBDb21wb25lbnQgZGVmaW5pdGlvbi4gUGxlYXNlIGNoZWNrIHdoZXRoZXIgcHJvdmlkZWQgY2xhc3MgaGFzIEBDb21wb25lbnQgZGVjb3JhdG9yLmApOwogICAgICAgIGFzc2VydEVxdWFsKHR5cGVvZiBpbmRleE9yT3B0aW9ucyAhPT0gIm51bWJlciIsIHRydWUsICJJdCBsb29rcyBsaWtlIENvbXBvbmVudCB0eXBlIHdhcyBwcm92aWRlZCBhcyB0aGUgZmlyc3QgYXJndW1lbnQgYW5kIGEgbnVtYmVyIChyZXByZXNlbnRpbmcgYW4gaW5kZXggYXQgd2hpY2ggdG8gaW5zZXJ0IHRoZSBuZXcgY29tcG9uZW50J3MgaG9zdCB2aWV3IGludG8gdGhpcyBjb250YWluZXIgYXMgdGhlIHNlY29uZCBhcmd1bWVudC4gVGhpcyBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMgaXMgaW5jb21wYXRpYmxlLiBQbGVhc2UgdXNlIGFuIG9iamVjdCBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50IGluc3RlYWQuIik7CiAgICAgIH0KICAgICAgY29uc3Qgb3B0aW9ucyA9IGluZGV4T3JPcHRpb25zIHx8IHt9OwogICAgICBpZiAobmdEZXZNb2RlICYmIG9wdGlvbnMuZW52aXJvbm1lbnRJbmplY3RvciAmJiBvcHRpb25zLm5nTW9kdWxlUmVmKSB7CiAgICAgICAgdGhyb3dFcnJvcjIoYENhbm5vdCBwYXNzIGJvdGggZW52aXJvbm1lbnRJbmplY3RvciBhbmQgbmdNb2R1bGVSZWYgb3B0aW9ucyB0byBjcmVhdGVDb21wb25lbnQoKS5gKTsKICAgICAgfQogICAgICBpbmRleCA9IG9wdGlvbnMuaW5kZXg7CiAgICAgIGluamVjdG9yID0gb3B0aW9ucy5pbmplY3RvcjsKICAgICAgcHJvamVjdGFibGVOb2RlcyA9IG9wdGlvbnMucHJvamVjdGFibGVOb2RlczsKICAgICAgZW52aXJvbm1lbnRJbmplY3RvciA9IG9wdGlvbnMuZW52aXJvbm1lbnRJbmplY3RvciB8fCBvcHRpb25zLm5nTW9kdWxlUmVmOwogICAgICBkaXJlY3RpdmVzID0gb3B0aW9ucy5kaXJlY3RpdmVzOwogICAgICBiaW5kaW5ncyA9IG9wdGlvbnMuYmluZGluZ3M7CiAgICB9CiAgICBjb25zdCBjb21wb25lbnRGYWN0b3J5ID0gaXNDb21wb25lbnRGYWN0b3J5ID8gY29tcG9uZW50RmFjdG9yeU9yVHlwZSA6IG5ldyBDb21wb25lbnRGYWN0b3J5MihnZXRDb21wb25lbnREZWYoY29tcG9uZW50RmFjdG9yeU9yVHlwZSkpOwogICAgY29uc3QgY29udGV4dEluamVjdG9yID0gaW5qZWN0b3IgfHwgdGhpcy5wYXJlbnRJbmplY3RvcjsKICAgIGlmICghZW52aXJvbm1lbnRJbmplY3RvciAmJiBjb21wb25lbnRGYWN0b3J5Lm5nTW9kdWxlID09IG51bGwpIHsKICAgICAgY29uc3QgX2luamVjdG9yID0gaXNDb21wb25lbnRGYWN0b3J5ID8gY29udGV4dEluamVjdG9yIDogdGhpcy5wYXJlbnRJbmplY3RvcjsKICAgICAgY29uc3QgcmVzdWx0ID0gX2luamVjdG9yLmdldChFbnZpcm9ubWVudEluamVjdG9yLCBudWxsKTsKICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgIGVudmlyb25tZW50SW5qZWN0b3IgPSByZXN1bHQ7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGNvbXBvbmVudERlZiA9IGdldENvbXBvbmVudERlZihjb21wb25lbnRGYWN0b3J5LmNvbXBvbmVudFR5cGUgPz8ge30pOwogICAgY29uc3QgZGVoeWRyYXRlZFZpZXcgPSBmaW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlldyh0aGlzLl9sQ29udGFpbmVyLCBjb21wb25lbnREZWY/LmlkID8/IG51bGwpOwogICAgY29uc3Qgck5vZGUgPSBkZWh5ZHJhdGVkVmlldz8uZmlyc3RDaGlsZCA/PyBudWxsOwogICAgY29uc3QgY29tcG9uZW50UmVmID0gY29tcG9uZW50RmFjdG9yeS5jcmVhdGUoY29udGV4dEluamVjdG9yLCBwcm9qZWN0YWJsZU5vZGVzLCByTm9kZSwgZW52aXJvbm1lbnRJbmplY3RvciwgZGlyZWN0aXZlcywgYmluZGluZ3MpOwogICAgdGhpcy5pbnNlcnRJbXBsKGNvbXBvbmVudFJlZi5ob3N0VmlldywgaW5kZXgsIHNob3VsZEFkZFZpZXdUb0RvbSh0aGlzLl9ob3N0VE5vZGUsIGRlaHlkcmF0ZWRWaWV3KSk7CiAgICByZXR1cm4gY29tcG9uZW50UmVmOwogIH0KICBpbnNlcnQodmlld1JlZiwgaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmluc2VydEltcGwodmlld1JlZiwgaW5kZXgsIHRydWUpOwogIH0KICBpbnNlcnRJbXBsKHZpZXdSZWYsIGluZGV4LCBhZGRUb0RPTSkgewogICAgY29uc3QgbFZpZXcgPSB2aWV3UmVmLl9sVmlldzsKICAgIGlmIChuZ0Rldk1vZGUgJiYgdmlld1JlZi5kZXN0cm95ZWQpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MjIsIG5nRGV2TW9kZSAmJiAiQ2Fubm90IGluc2VydCBhIGRlc3Ryb3llZCBWaWV3IGluIGEgVmlld0NvbnRhaW5lciEiKTsKICAgIH0KICAgIGlmICh2aWV3QXR0YWNoZWRUb0NvbnRhaW5lcihsVmlldykpIHsKICAgICAgY29uc3QgcHJldklkeCA9IHRoaXMuaW5kZXhPZih2aWV3UmVmKTsKICAgICAgaWYgKHByZXZJZHggIT09IC0xKSB7CiAgICAgICAgdGhpcy5kZXRhY2gocHJldklkeCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgcHJldkxDb250YWluZXIgPSBsVmlld1tQQVJFTlRdOwogICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbChpc0xDb250YWluZXIocHJldkxDb250YWluZXIpLCB0cnVlLCAiQW4gYXR0YWNoZWQgdmlldyBzaG91bGQgaGF2ZSBpdHMgUEFSRU5UIHBvaW50IHRvIGEgY29udGFpbmVyLiIpOwogICAgICAgIGNvbnN0IHByZXZWQ1JlZiA9IG5ldyBSM1ZpZXdDb250YWluZXJSZWYocHJldkxDb250YWluZXIsIHByZXZMQ29udGFpbmVyW1RfSE9TVF0sIHByZXZMQ29udGFpbmVyW1BBUkVOVF0pOwogICAgICAgIHByZXZWQ1JlZi5kZXRhY2gocHJldlZDUmVmLmluZGV4T2Yodmlld1JlZikpOwogICAgICB9CiAgICB9CiAgICBjb25zdCBhZGp1c3RlZElkeCA9IHRoaXMuX2FkanVzdEluZGV4KGluZGV4KTsKICAgIGNvbnN0IGxDb250YWluZXIgPSB0aGlzLl9sQ29udGFpbmVyOwogICAgYWRkTFZpZXdUb0xDb250YWluZXIobENvbnRhaW5lciwgbFZpZXcsIGFkanVzdGVkSWR4LCBhZGRUb0RPTSk7CiAgICB2aWV3UmVmLmF0dGFjaFRvVmlld0NvbnRhaW5lclJlZigpOwogICAgYWRkVG9BcnJheShnZXRPckNyZWF0ZVZpZXdSZWZzKGxDb250YWluZXIpLCBhZGp1c3RlZElkeCwgdmlld1JlZik7CiAgICByZXR1cm4gdmlld1JlZjsKICB9CiAgbW92ZSh2aWV3UmVmLCBuZXdJbmRleCkgewogICAgaWYgKG5nRGV2TW9kZSAmJiB2aWV3UmVmLmRlc3Ryb3llZCkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDkyMywgbmdEZXZNb2RlICYmICJDYW5ub3QgbW92ZSBhIGRlc3Ryb3llZCBWaWV3IGluIGEgVmlld0NvbnRhaW5lciEiKTsKICAgIH0KICAgIHJldHVybiB0aGlzLmluc2VydCh2aWV3UmVmLCBuZXdJbmRleCk7CiAgfQogIGluZGV4T2Yodmlld1JlZikgewogICAgY29uc3Qgdmlld1JlZnNBcnIgPSBnZXRWaWV3UmVmcyh0aGlzLl9sQ29udGFpbmVyKTsKICAgIHJldHVybiB2aWV3UmVmc0FyciAhPT0gbnVsbCA/IHZpZXdSZWZzQXJyLmluZGV4T2Yodmlld1JlZikgOiAtMTsKICB9CiAgcmVtb3ZlKGluZGV4KSB7CiAgICBjb25zdCBhZGp1c3RlZElkeCA9IHRoaXMuX2FkanVzdEluZGV4KGluZGV4LCAtMSk7CiAgICBjb25zdCBkZXRhY2hlZFZpZXcgPSBkZXRhY2hWaWV3KHRoaXMuX2xDb250YWluZXIsIGFkanVzdGVkSWR4KTsKICAgIGlmIChkZXRhY2hlZFZpZXcpIHsKICAgICAgcmVtb3ZlRnJvbUFycmF5KGdldE9yQ3JlYXRlVmlld1JlZnModGhpcy5fbENvbnRhaW5lciksIGFkanVzdGVkSWR4KTsKICAgICAgZGVzdHJveUxWaWV3KGRldGFjaGVkVmlld1tUVklFV10sIGRldGFjaGVkVmlldyk7CiAgICB9CiAgfQogIGRldGFjaChpbmRleCkgewogICAgY29uc3QgYWRqdXN0ZWRJZHggPSB0aGlzLl9hZGp1c3RJbmRleChpbmRleCwgLTEpOwogICAgY29uc3QgdmlldyA9IGRldGFjaFZpZXcodGhpcy5fbENvbnRhaW5lciwgYWRqdXN0ZWRJZHgpOwogICAgY29uc3Qgd2FzRGV0YWNoZWQgPSB2aWV3ICYmIHJlbW92ZUZyb21BcnJheShnZXRPckNyZWF0ZVZpZXdSZWZzKHRoaXMuX2xDb250YWluZXIpLCBhZGp1c3RlZElkeCkgIT0gbnVsbDsKICAgIHJldHVybiB3YXNEZXRhY2hlZCA/IG5ldyBWaWV3UmVmKHZpZXcpIDogbnVsbDsKICB9CiAgX2FkanVzdEluZGV4KGluZGV4LCBzaGlmdCA9IDApIHsKICAgIGlmIChpbmRleCA9PSBudWxsKSB7CiAgICAgIHJldHVybiB0aGlzLmxlbmd0aCArIHNoaWZ0OwogICAgfQogICAgaWYgKG5nRGV2TW9kZSkgewogICAgICBhc3NlcnRHcmVhdGVyVGhhbihpbmRleCwgLTEsIGBWaWV3UmVmIGluZGV4IG11c3QgYmUgcG9zaXRpdmUsIGdvdCAke2luZGV4fWApOwogICAgICBhc3NlcnRMZXNzVGhhbihpbmRleCwgdGhpcy5sZW5ndGggKyAxICsgc2hpZnQsICJpbmRleCIpOwogICAgfQogICAgcmV0dXJuIGluZGV4OwogIH0KfTsKZnVuY3Rpb24gZ2V0Vmlld1JlZnMobENvbnRhaW5lcikgewogIHJldHVybiBsQ29udGFpbmVyW1ZJRVdfUkVGU107Cn0KZnVuY3Rpb24gZ2V0T3JDcmVhdGVWaWV3UmVmcyhsQ29udGFpbmVyKSB7CiAgcmV0dXJuIGxDb250YWluZXJbVklFV19SRUZTXSB8fCAobENvbnRhaW5lcltWSUVXX1JFRlNdID0gW10pOwp9CmZ1bmN0aW9uIGNyZWF0ZUNvbnRhaW5lclJlZihob3N0VE5vZGUsIGhvc3RMVmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUoaG9zdFROb2RlLCAxMiB8IDMpOwogIGxldCBsQ29udGFpbmVyOwogIGNvbnN0IHNsb3RWYWx1ZSA9IGhvc3RMVmlld1tob3N0VE5vZGUuaW5kZXhdOwogIGlmIChpc0xDb250YWluZXIoc2xvdFZhbHVlKSkgewogICAgbENvbnRhaW5lciA9IHNsb3RWYWx1ZTsKICB9IGVsc2UgewogICAgbENvbnRhaW5lciA9IGNyZWF0ZUxDb250YWluZXIoc2xvdFZhbHVlLCBob3N0TFZpZXcsIG51bGwsIGhvc3RUTm9kZSk7CiAgICBob3N0TFZpZXdbaG9zdFROb2RlLmluZGV4XSA9IGxDb250YWluZXI7CiAgICBhZGRUb0VuZE9mVmlld1RyZWUoaG9zdExWaWV3LCBsQ29udGFpbmVyKTsKICB9CiAgX2xvY2F0ZU9yQ3JlYXRlQW5jaG9yTm9kZShsQ29udGFpbmVyLCBob3N0TFZpZXcsIGhvc3RUTm9kZSwgc2xvdFZhbHVlKTsKICByZXR1cm4gbmV3IFIzVmlld0NvbnRhaW5lclJlZihsQ29udGFpbmVyLCBob3N0VE5vZGUsIGhvc3RMVmlldyk7Cn0KZnVuY3Rpb24gaW5zZXJ0QW5jaG9yTm9kZShob3N0TFZpZXcsIGhvc3RUTm9kZSkgewogIGNvbnN0IHJlbmRlcmVyID0gaG9zdExWaWV3W1JFTkRFUkVSXTsKICBjb25zdCBjb21tZW50Tm9kZSA9IHJlbmRlcmVyLmNyZWF0ZUNvbW1lbnQobmdEZXZNb2RlID8gImNvbnRhaW5lciIgOiAiIik7CiAgY29uc3QgaG9zdE5hdGl2ZSA9IGdldE5hdGl2ZUJ5VE5vZGUoaG9zdFROb2RlLCBob3N0TFZpZXcpOwogIGNvbnN0IHBhcmVudE9mSG9zdE5hdGl2ZSA9IHJlbmRlcmVyLnBhcmVudE5vZGUoaG9zdE5hdGl2ZSk7CiAgbmF0aXZlSW5zZXJ0QmVmb3JlKHJlbmRlcmVyLCBwYXJlbnRPZkhvc3ROYXRpdmUsIGNvbW1lbnROb2RlLCByZW5kZXJlci5uZXh0U2libGluZyhob3N0TmF0aXZlKSwgZmFsc2UpOwogIHJldHVybiBjb21tZW50Tm9kZTsKfQp2YXIgX2xvY2F0ZU9yQ3JlYXRlQW5jaG9yTm9kZSA9IGNyZWF0ZUFuY2hvck5vZGU7CnZhciBfcG9wdWxhdGVEZWh5ZHJhdGVkVmlld3NJbkxDb250YWluZXIgPSAoKSA9PiBmYWxzZTsKZnVuY3Rpb24gcG9wdWxhdGVEZWh5ZHJhdGVkVmlld3NJbkxDb250YWluZXIobENvbnRhaW5lciwgdE5vZGUsIGhvc3RMVmlldykgewogIHJldHVybiBfcG9wdWxhdGVEZWh5ZHJhdGVkVmlld3NJbkxDb250YWluZXIobENvbnRhaW5lciwgdE5vZGUsIGhvc3RMVmlldyk7Cn0KZnVuY3Rpb24gY3JlYXRlQW5jaG9yTm9kZShsQ29udGFpbmVyLCBob3N0TFZpZXcsIGhvc3RUTm9kZSwgc2xvdFZhbHVlKSB7CiAgaWYgKGxDb250YWluZXJbTkFUSVZFXSkgcmV0dXJuOwogIGxldCBjb21tZW50Tm9kZTsKICBpZiAoaG9zdFROb2RlLnR5cGUgJiA4KSB7CiAgICBjb21tZW50Tm9kZSA9IHVud3JhcFJOb2RlKHNsb3RWYWx1ZSk7CiAgfSBlbHNlIHsKICAgIGNvbW1lbnROb2RlID0gaW5zZXJ0QW5jaG9yTm9kZShob3N0TFZpZXcsIGhvc3RUTm9kZSk7CiAgfQogIGxDb250YWluZXJbTkFUSVZFXSA9IGNvbW1lbnROb2RlOwp9CmZ1bmN0aW9uIHBvcHVsYXRlRGVoeWRyYXRlZFZpZXdzSW5MQ29udGFpbmVySW1wbChsQ29udGFpbmVyLCB0Tm9kZSwgaG9zdExWaWV3KSB7CiAgaWYgKGxDb250YWluZXJbTkFUSVZFXSAmJiBsQ29udGFpbmVyW0RFSFlEUkFURURfVklFV1NdKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgY29uc3QgaHlkcmF0aW9uSW5mbyA9IGhvc3RMVmlld1tIWURSQVRJT05dOwogIGNvbnN0IG5vT2Zmc2V0SW5kZXggPSB0Tm9kZS5pbmRleCAtIEhFQURFUl9PRkZTRVQ7CiAgY29uc3QgaXNOb2RlQ3JlYXRpb25Nb2RlID0gIWh5ZHJhdGlvbkluZm8gfHwgaXNJblNraXBIeWRyYXRpb25CbG9jazIodE5vZGUpIHx8IGlzRGlzY29ubmVjdGVkTm9kZSQxKGh5ZHJhdGlvbkluZm8sIG5vT2Zmc2V0SW5kZXgpOwogIGlmIChpc05vZGVDcmVhdGlvbk1vZGUpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgY29uc3QgY3VycmVudFJOb2RlID0gZ2V0U2VnbWVudEhlYWQoaHlkcmF0aW9uSW5mbywgbm9PZmZzZXRJbmRleCk7CiAgY29uc3Qgc2VyaWFsaXplZFZpZXdzID0gaHlkcmF0aW9uSW5mby5kYXRhW0NPTlRBSU5FUlNdPy5bbm9PZmZzZXRJbmRleF07CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoc2VyaWFsaXplZFZpZXdzLCAiVW5leHBlY3RlZCBzdGF0ZTogbm8gaHlkcmF0aW9uIGluZm8gYXZhaWxhYmxlIGZvciBhIGdpdmVuIFROb2RlLCB3aGljaCByZXByZXNlbnRzIGEgdmlldyBjb250YWluZXIuIik7CiAgY29uc3QgW2NvbW1lbnROb2RlLCBkZWh5ZHJhdGVkVmlld3NdID0gbG9jYXRlRGVoeWRyYXRlZFZpZXdzSW5Db250YWluZXIoY3VycmVudFJOb2RlLCBzZXJpYWxpemVkVmlld3MpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHZhbGlkYXRlTWF0Y2hpbmdOb2RlKGNvbW1lbnROb2RlLCBOb2RlLkNPTU1FTlRfTk9ERSwgbnVsbCwgaG9zdExWaWV3LCB0Tm9kZSwgdHJ1ZSk7CiAgICBtYXJrUk5vZGVBc0NsYWltZWRCeUh5ZHJhdGlvbihjb21tZW50Tm9kZSwgZmFsc2UpOwogIH0KICBsQ29udGFpbmVyW05BVElWRV0gPSBjb21tZW50Tm9kZTsKICBsQ29udGFpbmVyW0RFSFlEUkFURURfVklFV1NdID0gZGVoeWRyYXRlZFZpZXdzOwogIHJldHVybiB0cnVlOwp9CmZ1bmN0aW9uIGxvY2F0ZU9yQ3JlYXRlQW5jaG9yTm9kZShsQ29udGFpbmVyLCBob3N0TFZpZXcsIGhvc3RUTm9kZSwgc2xvdFZhbHVlKSB7CiAgaWYgKCFfcG9wdWxhdGVEZWh5ZHJhdGVkVmlld3NJbkxDb250YWluZXIobENvbnRhaW5lciwgaG9zdFROb2RlLCBob3N0TFZpZXcpKSB7CiAgICBjcmVhdGVBbmNob3JOb2RlKGxDb250YWluZXIsIGhvc3RMVmlldywgaG9zdFROb2RlLCBzbG90VmFsdWUpOwogIH0KfQpmdW5jdGlvbiBlbmFibGVMb2NhdGVPckNyZWF0ZUNvbnRhaW5lclJlZkltcGwoKSB7CiAgX2xvY2F0ZU9yQ3JlYXRlQW5jaG9yTm9kZSA9IGxvY2F0ZU9yQ3JlYXRlQW5jaG9yTm9kZTsKICBfcG9wdWxhdGVEZWh5ZHJhdGVkVmlld3NJbkxDb250YWluZXIgPSBwb3B1bGF0ZURlaHlkcmF0ZWRWaWV3c0luTENvbnRhaW5lckltcGw7Cn0KdmFyIExRdWVyeV8gPSBjbGFzcyBfTFF1ZXJ5XyB7CiAgcXVlcnlMaXN0OwogIG1hdGNoZXMgPSBudWxsOwogIGNvbnN0cnVjdG9yKHF1ZXJ5TGlzdCkgewogICAgdGhpcy5xdWVyeUxpc3QgPSBxdWVyeUxpc3Q7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyBfTFF1ZXJ5Xyh0aGlzLnF1ZXJ5TGlzdCk7CiAgfQogIHNldERpcnR5KCkgewogICAgdGhpcy5xdWVyeUxpc3Quc2V0RGlydHkoKTsKICB9Cn07CnZhciBMUXVlcmllc18gPSBjbGFzcyBfTFF1ZXJpZXNfIHsKICBxdWVyaWVzOwogIGNvbnN0cnVjdG9yKHF1ZXJpZXMgPSBbXSkgewogICAgdGhpcy5xdWVyaWVzID0gcXVlcmllczsKICB9CiAgY3JlYXRlRW1iZWRkZWRWaWV3KHRWaWV3KSB7CiAgICBjb25zdCB0UXVlcmllcyA9IHRWaWV3LnF1ZXJpZXM7CiAgICBpZiAodFF1ZXJpZXMgIT09IG51bGwpIHsKICAgICAgY29uc3Qgbm9PZkluaGVyaXRlZFF1ZXJpZXMgPSB0Vmlldy5jb250ZW50UXVlcmllcyAhPT0gbnVsbCA/IHRWaWV3LmNvbnRlbnRRdWVyaWVzWzBdIDogdFF1ZXJpZXMubGVuZ3RoOwogICAgICBjb25zdCB2aWV3TFF1ZXJpZXMgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub09mSW5oZXJpdGVkUXVlcmllczsgaSsrKSB7CiAgICAgICAgY29uc3QgdFF1ZXJ5ID0gdFF1ZXJpZXMuZ2V0QnlJbmRleChpKTsKICAgICAgICBjb25zdCBwYXJlbnRMUXVlcnkgPSB0aGlzLnF1ZXJpZXNbdFF1ZXJ5LmluZGV4SW5EZWNsYXJhdGlvblZpZXddOwogICAgICAgIHZpZXdMUXVlcmllcy5wdXNoKHBhcmVudExRdWVyeS5jbG9uZSgpKTsKICAgICAgfQogICAgICByZXR1cm4gbmV3IF9MUXVlcmllc18odmlld0xRdWVyaWVzKTsKICAgIH0KICAgIHJldHVybiBudWxsOwogIH0KICBpbnNlcnRWaWV3KHRWaWV3KSB7CiAgICB0aGlzLmRpcnR5UXVlcmllc1dpdGhNYXRjaGVzKHRWaWV3KTsKICB9CiAgZGV0YWNoVmlldyh0VmlldykgewogICAgdGhpcy5kaXJ0eVF1ZXJpZXNXaXRoTWF0Y2hlcyh0Vmlldyk7CiAgfQogIGZpbmlzaFZpZXdDcmVhdGlvbih0VmlldykgewogICAgdGhpcy5kaXJ0eVF1ZXJpZXNXaXRoTWF0Y2hlcyh0Vmlldyk7CiAgfQogIGRpcnR5UXVlcmllc1dpdGhNYXRjaGVzKHRWaWV3KSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucXVlcmllcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoZ2V0VFF1ZXJ5KHRWaWV3LCBpKS5tYXRjaGVzICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5xdWVyaWVzW2ldLnNldERpcnR5KCk7CiAgICAgIH0KICAgIH0KICB9Cn07CnZhciBUUXVlcnlNZXRhZGF0YV8gPSBjbGFzcyB7CiAgZmxhZ3M7CiAgcmVhZDsKICBwcmVkaWNhdGU7CiAgY29uc3RydWN0b3IocHJlZGljYXRlLCBmbGFncywgcmVhZCA9IG51bGwpIHsKICAgIHRoaXMuZmxhZ3MgPSBmbGFnczsKICAgIHRoaXMucmVhZCA9IHJlYWQ7CiAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSA9PT0gInN0cmluZyIpIHsKICAgICAgdGhpcy5wcmVkaWNhdGUgPSBzcGxpdFF1ZXJ5TXVsdGlTZWxlY3RvcnMocHJlZGljYXRlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucHJlZGljYXRlID0gcHJlZGljYXRlOwogICAgfQogIH0KfTsKdmFyIFRRdWVyaWVzXyA9IGNsYXNzIF9UUXVlcmllc18gewogIHF1ZXJpZXM7CiAgY29uc3RydWN0b3IocXVlcmllcyA9IFtdKSB7CiAgICB0aGlzLnF1ZXJpZXMgPSBxdWVyaWVzOwogIH0KICBlbGVtZW50U3RhcnQodFZpZXcsIHROb2RlKSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Rmlyc3RDcmVhdGVQYXNzKHRWaWV3LCAiUXVlcmllcyBzaG91bGQgY29sbGVjdCByZXN1bHRzIG9uIHRoZSBmaXJzdCB0ZW1wbGF0ZSBwYXNzIG9ubHkiKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5xdWVyaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHRoaXMucXVlcmllc1tpXS5lbGVtZW50U3RhcnQodFZpZXcsIHROb2RlKTsKICAgIH0KICB9CiAgZWxlbWVudEVuZCh0Tm9kZSkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnF1ZXJpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5xdWVyaWVzW2ldLmVsZW1lbnRFbmQodE5vZGUpOwogICAgfQogIH0KICBlbWJlZGRlZFRWaWV3KHROb2RlKSB7CiAgICBsZXQgcXVlcmllc0ZvclRlbXBsYXRlUmVmID0gbnVsbDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjaGlsZFF1ZXJ5SW5kZXggPSBxdWVyaWVzRm9yVGVtcGxhdGVSZWYgIT09IG51bGwgPyBxdWVyaWVzRm9yVGVtcGxhdGVSZWYubGVuZ3RoIDogMDsKICAgICAgY29uc3QgdHF1ZXJ5Q2xvbmUgPSB0aGlzLmdldEJ5SW5kZXgoaSkuZW1iZWRkZWRUVmlldyh0Tm9kZSwgY2hpbGRRdWVyeUluZGV4KTsKICAgICAgaWYgKHRxdWVyeUNsb25lKSB7CiAgICAgICAgdHF1ZXJ5Q2xvbmUuaW5kZXhJbkRlY2xhcmF0aW9uVmlldyA9IGk7CiAgICAgICAgaWYgKHF1ZXJpZXNGb3JUZW1wbGF0ZVJlZiAhPT0gbnVsbCkgewogICAgICAgICAgcXVlcmllc0ZvclRlbXBsYXRlUmVmLnB1c2godHF1ZXJ5Q2xvbmUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBxdWVyaWVzRm9yVGVtcGxhdGVSZWYgPSBbdHF1ZXJ5Q2xvbmVdOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHF1ZXJpZXNGb3JUZW1wbGF0ZVJlZiAhPT0gbnVsbCA/IG5ldyBfVFF1ZXJpZXNfKHF1ZXJpZXNGb3JUZW1wbGF0ZVJlZikgOiBudWxsOwogIH0KICB0ZW1wbGF0ZSh0VmlldywgdE5vZGUpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcsICJRdWVyaWVzIHNob3VsZCBjb2xsZWN0IHJlc3VsdHMgb24gdGhlIGZpcnN0IHRlbXBsYXRlIHBhc3Mgb25seSIpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnF1ZXJpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5xdWVyaWVzW2ldLnRlbXBsYXRlKHRWaWV3LCB0Tm9kZSk7CiAgICB9CiAgfQogIGdldEJ5SW5kZXgoaW5kZXgpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UodGhpcy5xdWVyaWVzLCBpbmRleCk7CiAgICByZXR1cm4gdGhpcy5xdWVyaWVzW2luZGV4XTsKICB9CiAgZ2V0IGxlbmd0aCgpIHsKICAgIHJldHVybiB0aGlzLnF1ZXJpZXMubGVuZ3RoOwogIH0KICB0cmFjayh0cXVlcnkpIHsKICAgIHRoaXMucXVlcmllcy5wdXNoKHRxdWVyeSk7CiAgfQp9Owp2YXIgVFF1ZXJ5XyA9IGNsYXNzIF9UUXVlcnlfIHsKICBtZXRhZGF0YTsKICBtYXRjaGVzID0gbnVsbDsKICBpbmRleEluRGVjbGFyYXRpb25WaWV3ID0gLTE7CiAgY3Jvc3Nlc05nVGVtcGxhdGUgPSBmYWxzZTsKICBfZGVjbGFyYXRpb25Ob2RlSW5kZXg7CiAgX2FwcGxpZXNUb05leHROb2RlID0gdHJ1ZTsKICBjb25zdHJ1Y3RvcihtZXRhZGF0YSwgbm9kZUluZGV4ID0gLTEpIHsKICAgIHRoaXMubWV0YWRhdGEgPSBtZXRhZGF0YTsKICAgIHRoaXMuX2RlY2xhcmF0aW9uTm9kZUluZGV4ID0gbm9kZUluZGV4OwogIH0KICBlbGVtZW50U3RhcnQodFZpZXcsIHROb2RlKSB7CiAgICBpZiAodGhpcy5pc0FwcGx5aW5nVG9Ob2RlKHROb2RlKSkgewogICAgICB0aGlzLm1hdGNoVE5vZGUodFZpZXcsIHROb2RlKTsKICAgIH0KICB9CiAgZWxlbWVudEVuZCh0Tm9kZSkgewogICAgaWYgKHRoaXMuX2RlY2xhcmF0aW9uTm9kZUluZGV4ID09PSB0Tm9kZS5pbmRleCkgewogICAgICB0aGlzLl9hcHBsaWVzVG9OZXh0Tm9kZSA9IGZhbHNlOwogICAgfQogIH0KICB0ZW1wbGF0ZSh0VmlldywgdE5vZGUpIHsKICAgIHRoaXMuZWxlbWVudFN0YXJ0KHRWaWV3LCB0Tm9kZSk7CiAgfQogIGVtYmVkZGVkVFZpZXcodE5vZGUsIGNoaWxkUXVlcnlJbmRleCkgewogICAgaWYgKHRoaXMuaXNBcHBseWluZ1RvTm9kZSh0Tm9kZSkpIHsKICAgICAgdGhpcy5jcm9zc2VzTmdUZW1wbGF0ZSA9IHRydWU7CiAgICAgIHRoaXMuYWRkTWF0Y2goLXROb2RlLmluZGV4LCBjaGlsZFF1ZXJ5SW5kZXgpOwogICAgICByZXR1cm4gbmV3IF9UUXVlcnlfKHRoaXMubWV0YWRhdGEpOwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfQogIGlzQXBwbHlpbmdUb05vZGUodE5vZGUpIHsKICAgIGlmICh0aGlzLl9hcHBsaWVzVG9OZXh0Tm9kZSAmJiAodGhpcy5tZXRhZGF0YS5mbGFncyAmIDEpICE9PSAxKSB7CiAgICAgIGNvbnN0IGRlY2xhcmF0aW9uTm9kZUlkeCA9IHRoaXMuX2RlY2xhcmF0aW9uTm9kZUluZGV4OwogICAgICBsZXQgcGFyZW50ID0gdE5vZGUucGFyZW50OwogICAgICB3aGlsZSAocGFyZW50ICE9PSBudWxsICYmIHBhcmVudC50eXBlICYgOCAmJiBwYXJlbnQuaW5kZXggIT09IGRlY2xhcmF0aW9uTm9kZUlkeCkgewogICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7CiAgICAgIH0KICAgICAgcmV0dXJuIGRlY2xhcmF0aW9uTm9kZUlkeCA9PT0gKHBhcmVudCAhPT0gbnVsbCA/IHBhcmVudC5pbmRleCA6IC0xKTsKICAgIH0KICAgIHJldHVybiB0aGlzLl9hcHBsaWVzVG9OZXh0Tm9kZTsKICB9CiAgbWF0Y2hUTm9kZSh0VmlldywgdE5vZGUpIHsKICAgIGNvbnN0IHByZWRpY2F0ZSA9IHRoaXMubWV0YWRhdGEucHJlZGljYXRlOwogICAgaWYgKEFycmF5LmlzQXJyYXkocHJlZGljYXRlKSkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZWRpY2F0ZS5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IG5hbWUgPSBwcmVkaWNhdGVbaV07CiAgICAgICAgdGhpcy5tYXRjaFROb2RlV2l0aFJlYWRPcHRpb24odFZpZXcsIHROb2RlLCBnZXRJZHhPZk1hdGNoaW5nU2VsZWN0b3IodE5vZGUsIG5hbWUpKTsKICAgICAgICB0aGlzLm1hdGNoVE5vZGVXaXRoUmVhZE9wdGlvbih0VmlldywgdE5vZGUsIGxvY2F0ZURpcmVjdGl2ZU9yUHJvdmlkZXIodE5vZGUsIHRWaWV3LCBuYW1lLCBmYWxzZSwgZmFsc2UpKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKHByZWRpY2F0ZSA9PT0gVGVtcGxhdGVSZWYpIHsKICAgICAgICBpZiAodE5vZGUudHlwZSAmIDQpIHsKICAgICAgICAgIHRoaXMubWF0Y2hUTm9kZVdpdGhSZWFkT3B0aW9uKHRWaWV3LCB0Tm9kZSwgLTEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm1hdGNoVE5vZGVXaXRoUmVhZE9wdGlvbih0VmlldywgdE5vZGUsIGxvY2F0ZURpcmVjdGl2ZU9yUHJvdmlkZXIodE5vZGUsIHRWaWV3LCBwcmVkaWNhdGUsIGZhbHNlLCBmYWxzZSkpOwogICAgICB9CiAgICB9CiAgfQogIG1hdGNoVE5vZGVXaXRoUmVhZE9wdGlvbih0VmlldywgdE5vZGUsIG5vZGVNYXRjaElkeCkgewogICAgaWYgKG5vZGVNYXRjaElkeCAhPT0gbnVsbCkgewogICAgICBjb25zdCByZWFkID0gdGhpcy5tZXRhZGF0YS5yZWFkOwogICAgICBpZiAocmVhZCAhPT0gbnVsbCkgewogICAgICAgIGlmIChyZWFkID09PSBFbGVtZW50UmVmIHx8IHJlYWQgPT09IFZpZXdDb250YWluZXJSZWYgfHwgcmVhZCA9PT0gVGVtcGxhdGVSZWYgJiYgdE5vZGUudHlwZSAmIDQpIHsKICAgICAgICAgIHRoaXMuYWRkTWF0Y2godE5vZGUuaW5kZXgsIC0yKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgZGlyZWN0aXZlT3JQcm92aWRlcklkeCA9IGxvY2F0ZURpcmVjdGl2ZU9yUHJvdmlkZXIodE5vZGUsIHRWaWV3LCByZWFkLCBmYWxzZSwgZmFsc2UpOwogICAgICAgICAgaWYgKGRpcmVjdGl2ZU9yUHJvdmlkZXJJZHggIT09IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5hZGRNYXRjaCh0Tm9kZS5pbmRleCwgZGlyZWN0aXZlT3JQcm92aWRlcklkeCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWRkTWF0Y2godE5vZGUuaW5kZXgsIG5vZGVNYXRjaElkeCk7CiAgICAgIH0KICAgIH0KICB9CiAgYWRkTWF0Y2godE5vZGVJZHgsIG1hdGNoSWR4KSB7CiAgICBpZiAodGhpcy5tYXRjaGVzID09PSBudWxsKSB7CiAgICAgIHRoaXMubWF0Y2hlcyA9IFt0Tm9kZUlkeCwgbWF0Y2hJZHhdOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5tYXRjaGVzLnB1c2godE5vZGVJZHgsIG1hdGNoSWR4KTsKICAgIH0KICB9Cn07CmZ1bmN0aW9uIGdldElkeE9mTWF0Y2hpbmdTZWxlY3Rvcih0Tm9kZSwgc2VsZWN0b3IpIHsKICBjb25zdCBsb2NhbE5hbWVzID0gdE5vZGUubG9jYWxOYW1lczsKICBpZiAobG9jYWxOYW1lcyAhPT0gbnVsbCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbE5hbWVzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIGlmIChsb2NhbE5hbWVzW2ldID09PSBzZWxlY3RvcikgewogICAgICAgIHJldHVybiBsb2NhbE5hbWVzW2kgKyAxXTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBjcmVhdGVSZXN1bHRCeVROb2RlVHlwZSh0Tm9kZSwgY3VycmVudFZpZXcpIHsKICBpZiAodE5vZGUudHlwZSAmICgzIHwgOCkpIHsKICAgIHJldHVybiBjcmVhdGVFbGVtZW50UmVmKHROb2RlLCBjdXJyZW50Vmlldyk7CiAgfSBlbHNlIGlmICh0Tm9kZS50eXBlICYgNCkgewogICAgcmV0dXJuIGNyZWF0ZVRlbXBsYXRlUmVmKHROb2RlLCBjdXJyZW50Vmlldyk7CiAgfQogIHJldHVybiBudWxsOwp9CmZ1bmN0aW9uIGNyZWF0ZVJlc3VsdEZvck5vZGUobFZpZXcsIHROb2RlLCBtYXRjaGluZ0lkeCwgcmVhZCkgewogIGlmIChtYXRjaGluZ0lkeCA9PT0gLTEpIHsKICAgIHJldHVybiBjcmVhdGVSZXN1bHRCeVROb2RlVHlwZSh0Tm9kZSwgbFZpZXcpOwogIH0gZWxzZSBpZiAobWF0Y2hpbmdJZHggPT09IC0yKSB7CiAgICByZXR1cm4gY3JlYXRlU3BlY2lhbFRva2VuKGxWaWV3LCB0Tm9kZSwgcmVhZCk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBnZXROb2RlSW5qZWN0YWJsZShsVmlldywgbFZpZXdbVFZJRVddLCBtYXRjaGluZ0lkeCwgdE5vZGUpOwogIH0KfQpmdW5jdGlvbiBjcmVhdGVTcGVjaWFsVG9rZW4obFZpZXcsIHROb2RlLCByZWFkKSB7CiAgaWYgKHJlYWQgPT09IEVsZW1lbnRSZWYpIHsKICAgIHJldHVybiBjcmVhdGVFbGVtZW50UmVmKHROb2RlLCBsVmlldyk7CiAgfSBlbHNlIGlmIChyZWFkID09PSBUZW1wbGF0ZVJlZikgewogICAgcmV0dXJuIGNyZWF0ZVRlbXBsYXRlUmVmKHROb2RlLCBsVmlldyk7CiAgfSBlbHNlIGlmIChyZWFkID09PSBWaWV3Q29udGFpbmVyUmVmKSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVUeXBlKHROb2RlLCAzIHwgMTIpOwogICAgcmV0dXJuIGNyZWF0ZUNvbnRhaW5lclJlZih0Tm9kZSwgbFZpZXcpOwogIH0gZWxzZSB7CiAgICBuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoYFNwZWNpYWwgdG9rZW4gdG8gcmVhZCBzaG91bGQgYmUgb25lIG9mIEVsZW1lbnRSZWYsIFRlbXBsYXRlUmVmIG9yIFZpZXdDb250YWluZXJSZWYgYnV0IGdvdCAke3N0cmluZ2lmeShyZWFkKX0uYCk7CiAgfQp9CmZ1bmN0aW9uIG1hdGVyaWFsaXplVmlld1Jlc3VsdHModFZpZXcsIGxWaWV3LCB0UXVlcnksIHF1ZXJ5SW5kZXgpIHsKICBjb25zdCBsUXVlcnkgPSBsVmlld1tRVUVSSUVTXS5xdWVyaWVzW3F1ZXJ5SW5kZXhdOwogIGlmIChsUXVlcnkubWF0Y2hlcyA9PT0gbnVsbCkgewogICAgY29uc3QgdFZpZXdEYXRhID0gdFZpZXcuZGF0YTsKICAgIGNvbnN0IHRRdWVyeU1hdGNoZXMgPSB0UXVlcnkubWF0Y2hlczsKICAgIGNvbnN0IHJlc3VsdCA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IHRRdWVyeU1hdGNoZXMgIT09IG51bGwgJiYgaSA8IHRRdWVyeU1hdGNoZXMubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgY29uc3QgbWF0Y2hlZE5vZGVJZHggPSB0UXVlcnlNYXRjaGVzW2ldOwogICAgICBpZiAobWF0Y2hlZE5vZGVJZHggPCAwKSB7CiAgICAgICAgcmVzdWx0LnB1c2gobnVsbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZSh0Vmlld0RhdGEsIG1hdGNoZWROb2RlSWR4KTsKICAgICAgICBjb25zdCB0Tm9kZSA9IHRWaWV3RGF0YVttYXRjaGVkTm9kZUlkeF07CiAgICAgICAgcmVzdWx0LnB1c2goY3JlYXRlUmVzdWx0Rm9yTm9kZShsVmlldywgdE5vZGUsIHRRdWVyeU1hdGNoZXNbaSArIDFdLCB0UXVlcnkubWV0YWRhdGEucmVhZCkpOwogICAgICB9CiAgICB9CiAgICBsUXVlcnkubWF0Y2hlcyA9IHJlc3VsdDsKICB9CiAgcmV0dXJuIGxRdWVyeS5tYXRjaGVzOwp9CmZ1bmN0aW9uIGNvbGxlY3RRdWVyeVJlc3VsdHModFZpZXcsIGxWaWV3LCBxdWVyeUluZGV4LCByZXN1bHQpIHsKICBjb25zdCB0UXVlcnkgPSB0Vmlldy5xdWVyaWVzLmdldEJ5SW5kZXgocXVlcnlJbmRleCk7CiAgY29uc3QgdFF1ZXJ5TWF0Y2hlcyA9IHRRdWVyeS5tYXRjaGVzOwogIGlmICh0UXVlcnlNYXRjaGVzICE9PSBudWxsKSB7CiAgICBjb25zdCBsVmlld1Jlc3VsdHMgPSBtYXRlcmlhbGl6ZVZpZXdSZXN1bHRzKHRWaWV3LCBsVmlldywgdFF1ZXJ5LCBxdWVyeUluZGV4KTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdFF1ZXJ5TWF0Y2hlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICBjb25zdCB0Tm9kZUlkeCA9IHRRdWVyeU1hdGNoZXNbaV07CiAgICAgIGlmICh0Tm9kZUlkeCA+IDApIHsKICAgICAgICByZXN1bHQucHVzaChsVmlld1Jlc3VsdHNbaSAvIDJdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBjaGlsZFF1ZXJ5SW5kZXggPSB0UXVlcnlNYXRjaGVzW2kgKyAxXTsKICAgICAgICBjb25zdCBkZWNsYXJhdGlvbkxDb250YWluZXIgPSBsVmlld1stdE5vZGVJZHhdOwogICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRMQ29udGFpbmVyKGRlY2xhcmF0aW9uTENvbnRhaW5lcik7CiAgICAgICAgZm9yIChsZXQgaTIgPSBDT05UQUlORVJfSEVBREVSX09GRlNFVDsgaTIgPCBkZWNsYXJhdGlvbkxDb250YWluZXIubGVuZ3RoOyBpMisrKSB7CiAgICAgICAgICBjb25zdCBlbWJlZGRlZExWaWV3ID0gZGVjbGFyYXRpb25MQ29udGFpbmVyW2kyXTsKICAgICAgICAgIGlmIChlbWJlZGRlZExWaWV3W0RFQ0xBUkFUSU9OX0xDT05UQUlORVJdID09PSBlbWJlZGRlZExWaWV3W1BBUkVOVF0pIHsKICAgICAgICAgICAgY29sbGVjdFF1ZXJ5UmVzdWx0cyhlbWJlZGRlZExWaWV3W1RWSUVXXSwgZW1iZWRkZWRMVmlldywgY2hpbGRRdWVyeUluZGV4LCByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZGVjbGFyYXRpb25MQ29udGFpbmVyW01PVkVEX1ZJRVdTXSAhPT0gbnVsbCkgewogICAgICAgICAgY29uc3QgZW1iZWRkZWRMVmlld3MgPSBkZWNsYXJhdGlvbkxDb250YWluZXJbTU9WRURfVklFV1NdOwogICAgICAgICAgZm9yIChsZXQgaTIgPSAwOyBpMiA8IGVtYmVkZGVkTFZpZXdzLmxlbmd0aDsgaTIrKykgewogICAgICAgICAgICBjb25zdCBlbWJlZGRlZExWaWV3ID0gZW1iZWRkZWRMVmlld3NbaTJdOwogICAgICAgICAgICBjb2xsZWN0UXVlcnlSZXN1bHRzKGVtYmVkZGVkTFZpZXdbVFZJRVddLCBlbWJlZGRlZExWaWV3LCBjaGlsZFF1ZXJ5SW5kZXgsIHJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHJldHVybiByZXN1bHQ7Cn0KZnVuY3Rpb24gbG9hZFF1ZXJ5SW50ZXJuYWwobFZpZXcsIHF1ZXJ5SW5kZXgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChsVmlld1tRVUVSSUVTXSwgIkxRdWVyaWVzIHNob3VsZCBiZSBkZWZpbmVkIHdoZW4gdHJ5aW5nIHRvIGxvYWQgYSBxdWVyeSIpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXdbUVVFUklFU10ucXVlcmllcywgcXVlcnlJbmRleCk7CiAgcmV0dXJuIGxWaWV3W1FVRVJJRVNdLnF1ZXJpZXNbcXVlcnlJbmRleF0ucXVlcnlMaXN0Owp9CmZ1bmN0aW9uIGNyZWF0ZUxRdWVyeSh0VmlldywgbFZpZXcsIGZsYWdzKSB7CiAgY29uc3QgcXVlcnlMaXN0ID0gbmV3IFF1ZXJ5TGlzdCgoZmxhZ3MgJiA0KSA9PT0gNCk7CiAgc3RvcmVDbGVhbnVwV2l0aENvbnRleHQodFZpZXcsIGxWaWV3LCBxdWVyeUxpc3QsIHF1ZXJ5TGlzdC5kZXN0cm95KTsKICBjb25zdCBsUXVlcmllcyA9IChsVmlld1tRVUVSSUVTXSA/Pz0gbmV3IExRdWVyaWVzXygpKS5xdWVyaWVzOwogIHJldHVybiBsUXVlcmllcy5wdXNoKG5ldyBMUXVlcnlfKHF1ZXJ5TGlzdCkpIC0gMTsKfQpmdW5jdGlvbiBjcmVhdGVWaWV3UXVlcnkocHJlZGljYXRlLCBmbGFncywgcmVhZCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIoZmxhZ3MsICJFeHBlY3RpbmcgZmxhZ3MiKTsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgaWYgKHRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgY3JlYXRlVFF1ZXJ5KHRWaWV3LCBuZXcgVFF1ZXJ5TWV0YWRhdGFfKHByZWRpY2F0ZSwgZmxhZ3MsIHJlYWQpLCAtMSk7CiAgICBpZiAoKGZsYWdzICYgMikgPT09IDIpIHsKICAgICAgdFZpZXcuc3RhdGljVmlld1F1ZXJpZXMgPSB0cnVlOwogICAgfQogIH0KICByZXR1cm4gY3JlYXRlTFF1ZXJ5KHRWaWV3LCBnZXRMVmlldygpLCBmbGFncyk7Cn0KZnVuY3Rpb24gY3JlYXRlQ29udGVudFF1ZXJ5KGRpcmVjdGl2ZUluZGV4LCBwcmVkaWNhdGUsIGZsYWdzLCByZWFkKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE51bWJlcihmbGFncywgIkV4cGVjdGluZyBmbGFncyIpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBpZiAodFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogICAgY3JlYXRlVFF1ZXJ5KHRWaWV3LCBuZXcgVFF1ZXJ5TWV0YWRhdGFfKHByZWRpY2F0ZSwgZmxhZ3MsIHJlYWQpLCB0Tm9kZS5pbmRleCk7CiAgICBzYXZlQ29udGVudFF1ZXJ5QW5kRGlyZWN0aXZlSW5kZXgodFZpZXcsIGRpcmVjdGl2ZUluZGV4KTsKICAgIGlmICgoZmxhZ3MgJiAyKSA9PT0gMikgewogICAgICB0Vmlldy5zdGF0aWNDb250ZW50UXVlcmllcyA9IHRydWU7CiAgICB9CiAgfQogIHJldHVybiBjcmVhdGVMUXVlcnkodFZpZXcsIGdldExWaWV3KCksIGZsYWdzKTsKfQpmdW5jdGlvbiBzcGxpdFF1ZXJ5TXVsdGlTZWxlY3RvcnMobG9jYXRvcikgewogIHJldHVybiBsb2NhdG9yLnNwbGl0KCIsIikubWFwKChzKSA9PiBzLnRyaW0oKSk7Cn0KZnVuY3Rpb24gY3JlYXRlVFF1ZXJ5KHRWaWV3LCBtZXRhZGF0YSwgbm9kZUluZGV4KSB7CiAgaWYgKHRWaWV3LnF1ZXJpZXMgPT09IG51bGwpIHRWaWV3LnF1ZXJpZXMgPSBuZXcgVFF1ZXJpZXNfKCk7CiAgdFZpZXcucXVlcmllcy50cmFjayhuZXcgVFF1ZXJ5XyhtZXRhZGF0YSwgbm9kZUluZGV4KSk7Cn0KZnVuY3Rpb24gc2F2ZUNvbnRlbnRRdWVyeUFuZERpcmVjdGl2ZUluZGV4KHRWaWV3LCBkaXJlY3RpdmVJbmRleCkgewogIGNvbnN0IHRWaWV3Q29udGVudFF1ZXJpZXMgPSB0Vmlldy5jb250ZW50UXVlcmllcyB8fCAodFZpZXcuY29udGVudFF1ZXJpZXMgPSBbXSk7CiAgY29uc3QgbGFzdFNhdmVkRGlyZWN0aXZlSW5kZXggPSB0Vmlld0NvbnRlbnRRdWVyaWVzLmxlbmd0aCA/IHRWaWV3Q29udGVudFF1ZXJpZXNbdFZpZXdDb250ZW50UXVlcmllcy5sZW5ndGggLSAxXSA6IC0xOwogIGlmIChkaXJlY3RpdmVJbmRleCAhPT0gbGFzdFNhdmVkRGlyZWN0aXZlSW5kZXgpIHsKICAgIHRWaWV3Q29udGVudFF1ZXJpZXMucHVzaCh0Vmlldy5xdWVyaWVzLmxlbmd0aCAtIDEsIGRpcmVjdGl2ZUluZGV4KTsKICB9Cn0KZnVuY3Rpb24gZ2V0VFF1ZXJ5KHRWaWV3LCBpbmRleCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHRWaWV3LnF1ZXJpZXMsICJUUXVlcmllcyBtdXN0IGJlIGRlZmluZWQgdG8gcmV0cmlldmUgYSBUUXVlcnkiKTsKICByZXR1cm4gdFZpZXcucXVlcmllcy5nZXRCeUluZGV4KGluZGV4KTsKfQpmdW5jdGlvbiBnZXRRdWVyeVJlc3VsdHMobFZpZXcsIHF1ZXJ5SW5kZXgpIHsKICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCB0UXVlcnkgPSBnZXRUUXVlcnkodFZpZXcsIHF1ZXJ5SW5kZXgpOwogIHJldHVybiB0UXVlcnkuY3Jvc3Nlc05nVGVtcGxhdGUgPyBjb2xsZWN0UXVlcnlSZXN1bHRzKHRWaWV3LCBsVmlldywgcXVlcnlJbmRleCwgW10pIDogbWF0ZXJpYWxpemVWaWV3UmVzdWx0cyh0VmlldywgbFZpZXcsIHRRdWVyeSwgcXVlcnlJbmRleCk7Cn0KZnVuY3Rpb24gY3JlYXRlUXVlcnlTaWduYWxGbihmaXJzdE9ubHksIHJlcXVpcmVkLCBvcHRzKSB7CiAgbGV0IG5vZGU7CiAgY29uc3Qgc2lnbmFsRm4gPSBjcmVhdGVDb21wdXRlZCgoKSA9PiB7CiAgICBub2RlLl9kaXJ0eUNvdW50ZXIoKTsKICAgIGNvbnN0IHZhbHVlID0gcmVmcmVzaFNpZ25hbFF1ZXJ5KG5vZGUsIGZpcnN0T25seSk7CiAgICBpZiAocmVxdWlyZWQgJiYgdmFsdWUgPT09IHZvaWQgMCkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKC05NTEsIG5nRGV2TW9kZSAmJiAiQ2hpbGQgcXVlcnkgcmVzdWx0IGlzIHJlcXVpcmVkIGJ1dCBubyB2YWx1ZSBpcyBhdmFpbGFibGUuIik7CiAgICB9CiAgICByZXR1cm4gdmFsdWU7CiAgfSk7CiAgbm9kZSA9IHNpZ25hbEZuW1NJR05BTF07CiAgbm9kZS5fZGlydHlDb3VudGVyID0gc2lnbmFsKDApOwogIG5vZGUuX2ZsYXRWYWx1ZSA9IHZvaWQgMDsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBzaWduYWxGbi50b1N0cmluZyA9ICgpID0+IGBbUXVlcnkgU2lnbmFsXWA7CiAgICBub2RlLmRlYnVnTmFtZSA9IG9wdHM/LmRlYnVnTmFtZTsKICB9CiAgcmV0dXJuIHNpZ25hbEZuOwp9CmZ1bmN0aW9uIGNyZWF0ZVNpbmdsZVJlc3VsdE9wdGlvbmFsUXVlcnlTaWduYWxGbihvcHRzKSB7CiAgcmV0dXJuIGNyZWF0ZVF1ZXJ5U2lnbmFsRm4odHJ1ZSwgZmFsc2UsIG9wdHMpOwp9CmZ1bmN0aW9uIGNyZWF0ZVNpbmdsZVJlc3VsdFJlcXVpcmVkUXVlcnlTaWduYWxGbihvcHRzKSB7CiAgcmV0dXJuIGNyZWF0ZVF1ZXJ5U2lnbmFsRm4odHJ1ZSwgdHJ1ZSwgb3B0cyk7Cn0KZnVuY3Rpb24gY3JlYXRlTXVsdGlSZXN1bHRRdWVyeVNpZ25hbEZuKG9wdHMpIHsKICByZXR1cm4gY3JlYXRlUXVlcnlTaWduYWxGbihmYWxzZSwgZmFsc2UsIG9wdHMpOwp9CmZ1bmN0aW9uIGJpbmRRdWVyeVRvU2lnbmFsKHRhcmdldCwgcXVlcnlJbmRleCkgewogIGNvbnN0IG5vZGUgPSB0YXJnZXRbU0lHTkFMXTsKICBub2RlLl9sVmlldyA9IGdldExWaWV3KCk7CiAgbm9kZS5fcXVlcnlJbmRleCA9IHF1ZXJ5SW5kZXg7CiAgbm9kZS5fcXVlcnlMaXN0ID0gbG9hZFF1ZXJ5SW50ZXJuYWwobm9kZS5fbFZpZXcsIHF1ZXJ5SW5kZXgpOwogIG5vZGUuX3F1ZXJ5TGlzdC5vbkRpcnR5KCgpID0+IG5vZGUuX2RpcnR5Q291bnRlci51cGRhdGUoKHYpID0+IHYgKyAxKSk7Cn0KZnVuY3Rpb24gcmVmcmVzaFNpZ25hbFF1ZXJ5KG5vZGUsIGZpcnN0T25seSkgewogIGNvbnN0IGxWaWV3ID0gbm9kZS5fbFZpZXc7CiAgY29uc3QgcXVlcnlJbmRleCA9IG5vZGUuX3F1ZXJ5SW5kZXg7CiAgaWYgKGxWaWV3ID09PSB2b2lkIDAgfHwgcXVlcnlJbmRleCA9PT0gdm9pZCAwIHx8IGxWaWV3W0ZMQUdTXSAmIDQpIHsKICAgIHJldHVybiBmaXJzdE9ubHkgPyB2b2lkIDAgOiBFTVBUWV9BUlJBWTsKICB9CiAgY29uc3QgcXVlcnlMaXN0ID0gbG9hZFF1ZXJ5SW50ZXJuYWwobFZpZXcsIHF1ZXJ5SW5kZXgpOwogIGNvbnN0IHJlc3VsdHMgPSBnZXRRdWVyeVJlc3VsdHMobFZpZXcsIHF1ZXJ5SW5kZXgpOwogIHF1ZXJ5TGlzdC5yZXNldChyZXN1bHRzLCB1bndyYXBFbGVtZW50UmVmKTsKICBpZiAoZmlyc3RPbmx5KSB7CiAgICByZXR1cm4gcXVlcnlMaXN0LmZpcnN0OwogIH0gZWxzZSB7CiAgICBjb25zdCByZXN1bHRDaGFuZ2VkID0gcXVlcnlMaXN0Ll9jaGFuZ2VzRGV0ZWN0ZWQ7CiAgICBpZiAocmVzdWx0Q2hhbmdlZCB8fCBub2RlLl9mbGF0VmFsdWUgPT09IHZvaWQgMCkgewogICAgICByZXR1cm4gbm9kZS5fZmxhdFZhbHVlID0gcXVlcnlMaXN0LnRvQXJyYXkoKTsKICAgIH0KICAgIHJldHVybiBub2RlLl9mbGF0VmFsdWU7CiAgfQp9CnZhciBjb21wb25lbnRSZXNvdXJjZVJlc29sdXRpb25RdWV1ZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CnZhciBjb21wb25lbnREZWZQZW5kaW5nUmVzb2x1dGlvbiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CmFzeW5jIGZ1bmN0aW9uIHJlc29sdmVDb21wb25lbnRSZXNvdXJjZXMocmVzb3VyY2VSZXNvbHZlcikgewogIGNvbnN0IGN1cnJlbnRRdWV1ZSA9IGNvbXBvbmVudFJlc291cmNlUmVzb2x1dGlvblF1ZXVlOwogIGNvbXBvbmVudFJlc291cmNlUmVzb2x1dGlvblF1ZXVlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBjb25zdCB1cmxDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgZnVuY3Rpb24gY2FjaGVkUmVzb3VyY2VSZXNvbHZlKHVybCkgewogICAgY29uc3QgcHJvbWlzZUNhY2hlZCA9IHVybENhY2hlLmdldCh1cmwpOwogICAgaWYgKHByb21pc2VDYWNoZWQpIHsKICAgICAgcmV0dXJuIHByb21pc2VDYWNoZWQ7CiAgICB9CiAgICBjb25zdCBwcm9taXNlID0gcmVzb3VyY2VSZXNvbHZlcih1cmwpLnRoZW4oKHJlc3BvbnNlKSA9PiB1bndyYXBSZXNwb25zZSh1cmwsIHJlc3BvbnNlKSk7CiAgICB1cmxDYWNoZS5zZXQodXJsLCBwcm9taXNlKTsKICAgIHJldHVybiBwcm9taXNlOwogIH0KICBjb25zdCByZXNvbHV0aW9uUHJvbWlzZXMgPSBBcnJheS5mcm9tKGN1cnJlbnRRdWV1ZSkubWFwKGFzeW5jIChbdHlwZSwgY29tcG9uZW50XSkgPT4gewogICAgaWYgKGNvbXBvbmVudC5zdHlsZVVybCAmJiBjb21wb25lbnQuc3R5bGVVcmxzPy5sZW5ndGgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJAQ29tcG9uZW50IGNhbm5vdCBkZWZpbmUgYm90aCBgc3R5bGVVcmxgIGFuZCBgc3R5bGVVcmxzYC4gVXNlIGBzdHlsZVVybGAgaWYgdGhlIGNvbXBvbmVudCBoYXMgb25lIHN0eWxlc2hlZXQsIG9yIGBzdHlsZVVybHNgIGlmIGl0IGhhcyBtdWx0aXBsZSIpOwogICAgfQogICAgY29uc3QgY29tcG9uZW50VGFza3MgPSBbXTsKICAgIGlmIChjb21wb25lbnQudGVtcGxhdGVVcmwpIHsKICAgICAgY29tcG9uZW50VGFza3MucHVzaChjYWNoZWRSZXNvdXJjZVJlc29sdmUoY29tcG9uZW50LnRlbXBsYXRlVXJsKS50aGVuKCh0ZW1wbGF0ZSkgPT4gewogICAgICAgIGNvbXBvbmVudC50ZW1wbGF0ZSA9IHRlbXBsYXRlOwogICAgICB9KSk7CiAgICB9CiAgICBjb25zdCBzdHlsZXMgPSB0eXBlb2YgY29tcG9uZW50LnN0eWxlcyA9PT0gInN0cmluZyIgPyBbY29tcG9uZW50LnN0eWxlc10gOiBjb21wb25lbnQuc3R5bGVzID8/IFtdOwogICAgY29tcG9uZW50LnN0eWxlcyA9IHN0eWxlczsKICAgIGxldCB7CiAgICAgIHN0eWxlVXJsLAogICAgICBzdHlsZVVybHMKICAgIH0gPSBjb21wb25lbnQ7CiAgICBpZiAoc3R5bGVVcmwpIHsKICAgICAgc3R5bGVVcmxzID0gW3N0eWxlVXJsXTsKICAgICAgY29tcG9uZW50LnN0eWxlVXJsID0gdm9pZCAwOwogICAgfQogICAgaWYgKHN0eWxlVXJscz8ubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGFsbEZldGNoZWQgPSBQcm9taXNlLmFsbChzdHlsZVVybHMubWFwKCh1cmwpID0+IGNhY2hlZFJlc291cmNlUmVzb2x2ZSh1cmwpKSkudGhlbigoZmV0Y2hlZFN0eWxlcykgPT4gewogICAgICAgIHN0eWxlcy5wdXNoKC4uLmZldGNoZWRTdHlsZXMpOwogICAgICAgIGNvbXBvbmVudC5zdHlsZVVybHMgPSB2b2lkIDA7CiAgICAgIH0pOwogICAgICBjb21wb25lbnRUYXNrcy5wdXNoKGFsbEZldGNoZWQpOwogICAgfQogICAgYXdhaXQgUHJvbWlzZS5hbGwoY29tcG9uZW50VGFza3MpOwogICAgY29tcG9uZW50RGVmUGVuZGluZ1Jlc29sdXRpb24uZGVsZXRlKHR5cGUpOwogIH0pOwogIGF3YWl0IFByb21pc2UuYWxsKHJlc29sdXRpb25Qcm9taXNlcyk7Cn0KZnVuY3Rpb24gbWF5YmVRdWV1ZVJlc29sdXRpb25PZkNvbXBvbmVudFJlc291cmNlcyh0eXBlLCBtZXRhZGF0YSkgewogIGlmIChjb21wb25lbnROZWVkc1Jlc29sdXRpb24obWV0YWRhdGEpKSB7CiAgICBjb21wb25lbnRSZXNvdXJjZVJlc29sdXRpb25RdWV1ZS5zZXQodHlwZSwgbWV0YWRhdGEpOwogICAgY29tcG9uZW50RGVmUGVuZGluZ1Jlc29sdXRpb24uYWRkKHR5cGUpOwogIH0KfQpmdW5jdGlvbiBpc0NvbXBvbmVudERlZlBlbmRpbmdSZXNvbHV0aW9uKHR5cGUpIHsKICByZXR1cm4gY29tcG9uZW50RGVmUGVuZGluZ1Jlc29sdXRpb24uaGFzKHR5cGUpOwp9CmZ1bmN0aW9uIGNvbXBvbmVudE5lZWRzUmVzb2x1dGlvbihjb21wb25lbnQpIHsKICByZXR1cm4gISEoY29tcG9uZW50LnRlbXBsYXRlVXJsICYmICFjb21wb25lbnQuaGFzT3duUHJvcGVydHkoInRlbXBsYXRlIikgfHwgY29tcG9uZW50LnN0eWxlVXJscz8ubGVuZ3RoIHx8IGNvbXBvbmVudC5zdHlsZVVybCk7Cn0KZnVuY3Rpb24gY2xlYXJSZXNvbHV0aW9uT2ZDb21wb25lbnRSZXNvdXJjZXNRdWV1ZSgpIHsKICBjb25zdCBvbGQgPSBjb21wb25lbnRSZXNvdXJjZVJlc29sdXRpb25RdWV1ZTsKICBjb21wb25lbnRSZXNvdXJjZVJlc29sdXRpb25RdWV1ZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgcmV0dXJuIG9sZDsKfQpmdW5jdGlvbiByZXN0b3JlQ29tcG9uZW50UmVzb2x1dGlvblF1ZXVlKHF1ZXVlMikgewogIGNvbXBvbmVudERlZlBlbmRpbmdSZXNvbHV0aW9uLmNsZWFyKCk7CiAgZm9yIChjb25zdCB0eXBlIG9mIHF1ZXVlMi5rZXlzKCkpIHsKICAgIGNvbXBvbmVudERlZlBlbmRpbmdSZXNvbHV0aW9uLmFkZCh0eXBlKTsKICB9CiAgY29tcG9uZW50UmVzb3VyY2VSZXNvbHV0aW9uUXVldWUgPSBxdWV1ZTI7Cn0KZnVuY3Rpb24gaXNDb21wb25lbnRSZXNvdXJjZVJlc29sdXRpb25RdWV1ZUVtcHR5KCkgewogIHJldHVybiBjb21wb25lbnRSZXNvdXJjZVJlc29sdXRpb25RdWV1ZS5zaXplID09PSAwOwp9CmFzeW5jIGZ1bmN0aW9uIHVud3JhcFJlc3BvbnNlKHVybCwgcmVzcG9uc2UpIHsKICBpZiAodHlwZW9mIHJlc3BvbnNlID09PSAic3RyaW5nIikgewogICAgcmV0dXJuIHJlc3BvbnNlOwogIH0KICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSB2b2lkIDAgJiYgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTE4LCBuZ0Rldk1vZGUgJiYgYENvdWxkIG5vdCBsb2FkIHJlc291cmNlOiAke3VybH0uIFJlc3BvbnNlIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7CiAgfQogIHJldHVybiByZXNwb25zZS50ZXh0KCk7Cn0KdmFyIG1vZHVsZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwp2YXIgY2hlY2tGb3JEdXBsaWNhdGVOZ01vZHVsZXMgPSB0cnVlOwpmdW5jdGlvbiBhc3NlcnRTYW1lT3JOb3RFeGlzdGluZyhpZCwgdHlwZSwgaW5jb21pbmcpIHsKICBpZiAodHlwZSAmJiB0eXBlICE9PSBpbmNvbWluZyAmJiBjaGVja0ZvckR1cGxpY2F0ZU5nTW9kdWxlcykgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MjEsIG5nRGV2TW9kZSAmJiBgRHVwbGljYXRlIG1vZHVsZSByZWdpc3RlcmVkIGZvciAke2lkfSAtICR7c3RyaW5naWZ5KHR5cGUpfSB2cyAke3N0cmluZ2lmeSh0eXBlLm5hbWUpfWApOwogIH0KfQpmdW5jdGlvbiByZWdpc3Rlck5nTW9kdWxlVHlwZShuZ01vZHVsZVR5cGUsIGlkKSB7CiAgY29uc3QgZXhpc3RpbmcgPSBtb2R1bGVzLmdldChpZCkgfHwgbnVsbDsKICBhc3NlcnRTYW1lT3JOb3RFeGlzdGluZyhpZCwgZXhpc3RpbmcsIG5nTW9kdWxlVHlwZSk7CiAgbW9kdWxlcy5zZXQoaWQsIG5nTW9kdWxlVHlwZSk7Cn0KZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZE5nTW9kdWxlVHlwZShpZCkgewogIHJldHVybiBtb2R1bGVzLmdldChpZCk7Cn0KZnVuY3Rpb24gc2V0QWxsb3dEdXBsaWNhdGVOZ01vZHVsZUlkc0ZvclRlc3QoYWxsb3dEdXBsaWNhdGVzKSB7CiAgY2hlY2tGb3JEdXBsaWNhdGVOZ01vZHVsZXMgPSAhYWxsb3dEdXBsaWNhdGVzOwp9CnZhciBOZ01vZHVsZVJlZiQxID0gY2xhc3MgTmdNb2R1bGVSZWYgewp9Owp2YXIgTmdNb2R1bGVGYWN0b3J5JDEgPSBjbGFzcyBOZ01vZHVsZUZhY3Rvcnkgewp9OwpmdW5jdGlvbiBjcmVhdGVOZ01vZHVsZShuZ01vZHVsZSwgcGFyZW50SW5qZWN0b3IpIHsKICByZXR1cm4gbmV3IE5nTW9kdWxlUmVmMihuZ01vZHVsZSwgcGFyZW50SW5qZWN0b3IgPz8gbnVsbCwgW10pOwp9CnZhciBjcmVhdGVOZ01vZHVsZVJlZiA9IGNyZWF0ZU5nTW9kdWxlOwp2YXIgTmdNb2R1bGVSZWYyID0gY2xhc3MgZXh0ZW5kcyBOZ01vZHVsZVJlZiQxIHsKICBuZ01vZHVsZVR5cGU7CiAgX3BhcmVudDsKICBfYm9vdHN0cmFwQ29tcG9uZW50cyA9IFtdOwogIF9yM0luamVjdG9yOwogIGluc3RhbmNlOwogIGRlc3Ryb3lDYnMgPSBbXTsKICBjb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIgPSBuZXcgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyMih0aGlzKTsKICBjb25zdHJ1Y3RvcihuZ01vZHVsZVR5cGUsIF9wYXJlbnQsIGFkZGl0aW9uYWxQcm92aWRlcnMsIHJ1bkluamVjdG9ySW5pdGlhbGl6ZXJzID0gdHJ1ZSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMubmdNb2R1bGVUeXBlID0gbmdNb2R1bGVUeXBlOwogICAgdGhpcy5fcGFyZW50ID0gX3BhcmVudDsKICAgIGNvbnN0IG5nTW9kdWxlRGVmID0gZ2V0TmdNb2R1bGVEZWYobmdNb2R1bGVUeXBlKTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKG5nTW9kdWxlRGVmLCBgTmdNb2R1bGUgJyR7c3RyaW5naWZ5KG5nTW9kdWxlVHlwZSl9JyBpcyBub3QgYSBzdWJ0eXBlIG9mICdOZ01vZHVsZVR5cGUnLmApOwogICAgdGhpcy5fYm9vdHN0cmFwQ29tcG9uZW50cyA9IG1heWJlVW53cmFwRm4obmdNb2R1bGVEZWYuYm9vdHN0cmFwKTsKICAgIHRoaXMuX3IzSW5qZWN0b3IgPSBjcmVhdGVJbmplY3RvcldpdGhvdXRJbmplY3Rvckluc3RhbmNlcyhuZ01vZHVsZVR5cGUsIF9wYXJlbnQsIFt7CiAgICAgIHByb3ZpZGU6IE5nTW9kdWxlUmVmJDEsCiAgICAgIHVzZVZhbHVlOiB0aGlzCiAgICB9LCB7CiAgICAgIHByb3ZpZGU6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciQxLAogICAgICB1c2VWYWx1ZTogdGhpcy5jb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIKICAgIH0sIC4uLmFkZGl0aW9uYWxQcm92aWRlcnNdLCBzdHJpbmdpZnkobmdNb2R1bGVUeXBlKSwgLyogQF9fUFVSRV9fICovIG5ldyBTZXQoWyJlbnZpcm9ubWVudCJdKSk7CiAgICBpZiAocnVuSW5qZWN0b3JJbml0aWFsaXplcnMpIHsKICAgICAgdGhpcy5yZXNvbHZlSW5qZWN0b3JJbml0aWFsaXplcnMoKTsKICAgIH0KICB9CiAgcmVzb2x2ZUluamVjdG9ySW5pdGlhbGl6ZXJzKCkgewogICAgdGhpcy5fcjNJbmplY3Rvci5yZXNvbHZlSW5qZWN0b3JJbml0aWFsaXplcnMoKTsKICAgIHRoaXMuaW5zdGFuY2UgPSB0aGlzLl9yM0luamVjdG9yLmdldCh0aGlzLm5nTW9kdWxlVHlwZSk7CiAgfQogIGdldCBpbmplY3RvcigpIHsKICAgIHJldHVybiB0aGlzLl9yM0luamVjdG9yOwogIH0KICBkZXN0cm95KCkgewogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQodGhpcy5kZXN0cm95Q2JzLCAiTmdNb2R1bGUgYWxyZWFkeSBkZXN0cm95ZWQiKTsKICAgIGNvbnN0IGluamVjdG9yID0gdGhpcy5fcjNJbmplY3RvcjsKICAgICFpbmplY3Rvci5kZXN0cm95ZWQgJiYgaW5qZWN0b3IuZGVzdHJveSgpOwogICAgdGhpcy5kZXN0cm95Q2JzLmZvckVhY2goKGZuKSA9PiBmbigpKTsKICAgIHRoaXMuZGVzdHJveUNicyA9IG51bGw7CiAgfQogIG9uRGVzdHJveShjYWxsYmFjaykgewogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQodGhpcy5kZXN0cm95Q2JzLCAiTmdNb2R1bGUgYWxyZWFkeSBkZXN0cm95ZWQiKTsKICAgIHRoaXMuZGVzdHJveUNicy5wdXNoKGNhbGxiYWNrKTsKICB9Cn07CnZhciBOZ01vZHVsZUZhY3RvcnkyID0gY2xhc3MgZXh0ZW5kcyBOZ01vZHVsZUZhY3RvcnkkMSB7CiAgbW9kdWxlVHlwZTsKICBjb25zdHJ1Y3Rvcihtb2R1bGVUeXBlKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5tb2R1bGVUeXBlID0gbW9kdWxlVHlwZTsKICB9CiAgY3JlYXRlKHBhcmVudEluamVjdG9yKSB7CiAgICByZXR1cm4gbmV3IE5nTW9kdWxlUmVmMih0aGlzLm1vZHVsZVR5cGUsIHBhcmVudEluamVjdG9yLCBbXSk7CiAgfQp9OwpmdW5jdGlvbiBjcmVhdGVOZ01vZHVsZVJlZldpdGhQcm92aWRlcnMobW9kdWxlVHlwZSwgcGFyZW50SW5qZWN0b3IsIGFkZGl0aW9uYWxQcm92aWRlcnMpIHsKICByZXR1cm4gbmV3IE5nTW9kdWxlUmVmMihtb2R1bGVUeXBlLCBwYXJlbnRJbmplY3RvciwgYWRkaXRpb25hbFByb3ZpZGVycywgZmFsc2UpOwp9CnZhciBFbnZpcm9ubWVudE5nTW9kdWxlUmVmQWRhcHRlciA9IGNsYXNzIGV4dGVuZHMgTmdNb2R1bGVSZWYkMSB7CiAgaW5qZWN0b3I7CiAgY29tcG9uZW50RmFjdG9yeVJlc29sdmVyID0gbmV3IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcjIodGhpcyk7CiAgaW5zdGFuY2UgPSBudWxsOwogIGNvbnN0cnVjdG9yKGNvbmZpZzIpIHsKICAgIHN1cGVyKCk7CiAgICBjb25zdCBpbmplY3RvciA9IG5ldyBSM0luamVjdG9yKFsuLi5jb25maWcyLnByb3ZpZGVycywgewogICAgICBwcm92aWRlOiBOZ01vZHVsZVJlZiQxLAogICAgICB1c2VWYWx1ZTogdGhpcwogICAgfSwgewogICAgICBwcm92aWRlOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIkMSwKICAgICAgdXNlVmFsdWU6IHRoaXMuY29tcG9uZW50RmFjdG9yeVJlc29sdmVyCiAgICB9XSwgY29uZmlnMi5wYXJlbnQgfHwgZ2V0TnVsbEluamVjdG9yKCksIGNvbmZpZzIuZGVidWdOYW1lLCAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbImVudmlyb25tZW50Il0pKTsKICAgIHRoaXMuaW5qZWN0b3IgPSBpbmplY3RvcjsKICAgIGlmIChjb25maWcyLnJ1bkVudmlyb25tZW50SW5pdGlhbGl6ZXJzKSB7CiAgICAgIGluamVjdG9yLnJlc29sdmVJbmplY3RvckluaXRpYWxpemVycygpOwogICAgfQogIH0KICBkZXN0cm95KCkgewogICAgdGhpcy5pbmplY3Rvci5kZXN0cm95KCk7CiAgfQogIG9uRGVzdHJveShjYWxsYmFjaykgewogICAgdGhpcy5pbmplY3Rvci5vbkRlc3Ryb3koY2FsbGJhY2spOwogIH0KfTsKZnVuY3Rpb24gY3JlYXRlRW52aXJvbm1lbnRJbmplY3Rvcihwcm92aWRlcnMsIHBhcmVudCwgZGVidWdOYW1lID0gbnVsbCkgewogIGNvbnN0IGFkYXB0ZXIgPSBuZXcgRW52aXJvbm1lbnROZ01vZHVsZVJlZkFkYXB0ZXIoewogICAgcHJvdmlkZXJzLAogICAgcGFyZW50LAogICAgZGVidWdOYW1lLAogICAgcnVuRW52aXJvbm1lbnRJbml0aWFsaXplcnM6IHRydWUKICB9KTsKICByZXR1cm4gYWRhcHRlci5pbmplY3RvcjsKfQp2YXIgU3RhbmRhbG9uZVNlcnZpY2UgPSBjbGFzcyBfU3RhbmRhbG9uZVNlcnZpY2UgewogIF9pbmplY3RvcjsKICBjYWNoZWRJbmplY3RvcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIGNvbnN0cnVjdG9yKF9pbmplY3RvcikgewogICAgdGhpcy5faW5qZWN0b3IgPSBfaW5qZWN0b3I7CiAgfQogIGdldE9yQ3JlYXRlU3RhbmRhbG9uZUluamVjdG9yKGNvbXBvbmVudERlZikgewogICAgaWYgKCFjb21wb25lbnREZWYuc3RhbmRhbG9uZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGlmICghdGhpcy5jYWNoZWRJbmplY3RvcnMuaGFzKGNvbXBvbmVudERlZikpIHsKICAgICAgY29uc3QgcHJvdmlkZXJzID0gaW50ZXJuYWxJbXBvcnRQcm92aWRlcnNGcm9tKGZhbHNlLCBjb21wb25lbnREZWYudHlwZSk7CiAgICAgIGNvbnN0IHN0YW5kYWxvbmVJbmplY3RvciA9IHByb3ZpZGVycy5sZW5ndGggPiAwID8gY3JlYXRlRW52aXJvbm1lbnRJbmplY3RvcihbcHJvdmlkZXJzXSwgdGhpcy5faW5qZWN0b3IsIHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/IGBTdGFuZGFsb25lWyR7Y29tcG9uZW50RGVmLnR5cGUubmFtZX1dYCA6ICIiKSA6IG51bGw7CiAgICAgIHRoaXMuY2FjaGVkSW5qZWN0b3JzLnNldChjb21wb25lbnREZWYsIHN0YW5kYWxvbmVJbmplY3Rvcik7CiAgICB9CiAgICByZXR1cm4gdGhpcy5jYWNoZWRJbmplY3RvcnMuZ2V0KGNvbXBvbmVudERlZik7CiAgfQogIG5nT25EZXN0cm95KCkgewogICAgdHJ5IHsKICAgICAgZm9yIChjb25zdCBpbmplY3RvciBvZiB0aGlzLmNhY2hlZEluamVjdG9ycy52YWx1ZXMoKSkgewogICAgICAgIGlmIChpbmplY3RvciAhPT0gbnVsbCkgewogICAgICAgICAgaW5qZWN0b3IuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgdGhpcy5jYWNoZWRJbmplY3RvcnMuY2xlYXIoKTsKICAgIH0KICB9CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfU3RhbmRhbG9uZVNlcnZpY2UsCiAgICBwcm92aWRlZEluOiAiZW52aXJvbm1lbnQiLAogICAgZmFjdG9yeTogKCkgPT4gbmV3IF9TdGFuZGFsb25lU2VydmljZSjJtcm1aW5qZWN0KEVudmlyb25tZW50SW5qZWN0b3IpKQogIH0pOwp9OwpmdW5jdGlvbiDJtcm1ZGVmaW5lQ29tcG9uZW50KGNvbXBvbmVudERlZmluaXRpb24pIHsKICByZXR1cm4gbm9TaWRlRWZmZWN0cygoKSA9PiB7CiAgICAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBpbml0TmdEZXZNb2RlKCk7CiAgICBjb25zdCBiYXNlRGVmID0gZ2V0TmdEaXJlY3RpdmVEZWYoY29tcG9uZW50RGVmaW5pdGlvbik7CiAgICBjb25zdCBkZWYgPSBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBiYXNlRGVmKSwgewogICAgICBkZWNsczogY29tcG9uZW50RGVmaW5pdGlvbi5kZWNscywKICAgICAgdmFyczogY29tcG9uZW50RGVmaW5pdGlvbi52YXJzLAogICAgICB0ZW1wbGF0ZTogY29tcG9uZW50RGVmaW5pdGlvbi50ZW1wbGF0ZSwKICAgICAgY29uc3RzOiBjb21wb25lbnREZWZpbml0aW9uLmNvbnN0cyB8fCBudWxsLAogICAgICBuZ0NvbnRlbnRTZWxlY3RvcnM6IGNvbXBvbmVudERlZmluaXRpb24ubmdDb250ZW50U2VsZWN0b3JzLAogICAgICBvblB1c2g6IGNvbXBvbmVudERlZmluaXRpb24uY2hhbmdlRGV0ZWN0aW9uID09PSBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsCiAgICAgIGRpcmVjdGl2ZURlZnM6IG51bGwsCiAgICAgIHBpcGVEZWZzOiBudWxsLAogICAgICBkZXBlbmRlbmNpZXM6IGJhc2VEZWYuc3RhbmRhbG9uZSAmJiBjb21wb25lbnREZWZpbml0aW9uLmRlcGVuZGVuY2llcyB8fCBudWxsLAogICAgICBnZXRTdGFuZGFsb25lSW5qZWN0b3I6IGJhc2VEZWYuc3RhbmRhbG9uZSA/IChwYXJlbnRJbmplY3RvcikgPT4gewogICAgICAgIHJldHVybiBwYXJlbnRJbmplY3Rvci5nZXQoU3RhbmRhbG9uZVNlcnZpY2UpLmdldE9yQ3JlYXRlU3RhbmRhbG9uZUluamVjdG9yKGRlZik7CiAgICAgIH0gOiBudWxsLAogICAgICBnZXRFeHRlcm5hbFN0eWxlczogbnVsbCwKICAgICAgc2lnbmFsczogY29tcG9uZW50RGVmaW5pdGlvbi5zaWduYWxzID8/IGZhbHNlLAogICAgICBkYXRhOiBjb21wb25lbnREZWZpbml0aW9uLmRhdGEgfHwge30sCiAgICAgIGVuY2Fwc3VsYXRpb246IGNvbXBvbmVudERlZmluaXRpb24uZW5jYXBzdWxhdGlvbiB8fCBWaWV3RW5jYXBzdWxhdGlvbi5FbXVsYXRlZCwKICAgICAgc3R5bGVzOiBjb21wb25lbnREZWZpbml0aW9uLnN0eWxlcyB8fCBFTVBUWV9BUlJBWSwKICAgICAgXzogbnVsbCwKICAgICAgc2NoZW1hczogY29tcG9uZW50RGVmaW5pdGlvbi5zY2hlbWFzIHx8IG51bGwsCiAgICAgIHRWaWV3OiBudWxsLAogICAgICBpZDogIiIKICAgIH0pOwogICAgaWYgKGJhc2VEZWYuc3RhbmRhbG9uZSkgewogICAgICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ1N0YW5kYWxvbmUiKTsKICAgIH0KICAgIGluaXRGZWF0dXJlcyhkZWYpOwogICAgY29uc3QgZGVwZW5kZW5jaWVzID0gY29tcG9uZW50RGVmaW5pdGlvbi5kZXBlbmRlbmNpZXM7CiAgICBkZWYuZGlyZWN0aXZlRGVmcyA9IGV4dHJhY3REZWZMaXN0T3JGYWN0b3J5KGRlcGVuZGVuY2llcywgZXh0cmFjdERpcmVjdGl2ZURlZik7CiAgICBkZWYucGlwZURlZnMgPSBleHRyYWN0RGVmTGlzdE9yRmFjdG9yeShkZXBlbmRlbmNpZXMsIGdldFBpcGVEZWYpOwogICAgZGVmLmlkID0gZ2V0Q29tcG9uZW50SWQoZGVmKTsKICAgIHJldHVybiBkZWY7CiAgfSk7Cn0KZnVuY3Rpb24gZXh0cmFjdERpcmVjdGl2ZURlZih0eXBlKSB7CiAgcmV0dXJuIGdldENvbXBvbmVudERlZih0eXBlKSB8fCBnZXREaXJlY3RpdmVEZWYodHlwZSk7Cn0KZnVuY3Rpb24gybXJtWRlZmluZU5nTW9kdWxlKGRlZikgewogIHJldHVybiBub1NpZGVFZmZlY3RzKCgpID0+IHsKICAgIGNvbnN0IHJlcyA9IHsKICAgICAgdHlwZTogZGVmLnR5cGUsCiAgICAgIGJvb3RzdHJhcDogZGVmLmJvb3RzdHJhcCB8fCBFTVBUWV9BUlJBWSwKICAgICAgZGVjbGFyYXRpb25zOiBkZWYuZGVjbGFyYXRpb25zIHx8IEVNUFRZX0FSUkFZLAogICAgICBpbXBvcnRzOiBkZWYuaW1wb3J0cyB8fCBFTVBUWV9BUlJBWSwKICAgICAgZXhwb3J0czogZGVmLmV4cG9ydHMgfHwgRU1QVFlfQVJSQVksCiAgICAgIHRyYW5zaXRpdmVDb21waWxlU2NvcGVzOiBudWxsLAogICAgICBzY2hlbWFzOiBkZWYuc2NoZW1hcyB8fCBudWxsLAogICAgICBpZDogZGVmLmlkIHx8IG51bGwKICAgIH07CiAgICByZXR1cm4gcmVzOwogIH0pOwp9CmZ1bmN0aW9uIHBhcnNlQW5kQ29udmVydElucHV0c0ZvckRlZmluaXRpb24ob2JqLCBkZWNsYXJlZElucHV0cykgewogIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIEVNUFRZX09CSjsKICBjb25zdCBuZXdMb29rdXAgPSB7fTsKICBmb3IgKGNvbnN0IG1pbmlmaWVkS2V5IGluIG9iaikgewogICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShtaW5pZmllZEtleSkpIHsKICAgICAgY29uc3QgdmFsdWUgPSBvYmpbbWluaWZpZWRLZXldOwogICAgICBsZXQgcHVibGljTmFtZTsKICAgICAgbGV0IGRlY2xhcmVkTmFtZTsKICAgICAgbGV0IGlucHV0RmxhZ3M7CiAgICAgIGxldCB0cmFuc2Zvcm07CiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgIGlucHV0RmxhZ3MgPSB2YWx1ZVswXTsKICAgICAgICBwdWJsaWNOYW1lID0gdmFsdWVbMV07CiAgICAgICAgZGVjbGFyZWROYW1lID0gdmFsdWVbMl0gPz8gcHVibGljTmFtZTsKICAgICAgICB0cmFuc2Zvcm0gPSB2YWx1ZVszXSB8fCBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHB1YmxpY05hbWUgPSB2YWx1ZTsKICAgICAgICBkZWNsYXJlZE5hbWUgPSB2YWx1ZTsKICAgICAgICBpbnB1dEZsYWdzID0gSW5wdXRGbGFncy5Ob25lOwogICAgICAgIHRyYW5zZm9ybSA9IG51bGw7CiAgICAgIH0KICAgICAgbmV3TG9va3VwW3B1YmxpY05hbWVdID0gW21pbmlmaWVkS2V5LCBpbnB1dEZsYWdzLCB0cmFuc2Zvcm1dOwogICAgICBkZWNsYXJlZElucHV0c1twdWJsaWNOYW1lXSA9IGRlY2xhcmVkTmFtZTsKICAgIH0KICB9CiAgcmV0dXJuIG5ld0xvb2t1cDsKfQpmdW5jdGlvbiBwYXJzZUFuZENvbnZlcnRPdXRwdXRzRm9yRGVmaW5pdGlvbihvYmopIHsKICBpZiAob2JqID09IG51bGwpIHJldHVybiBFTVBUWV9PQko7CiAgY29uc3QgbmV3TG9va3VwID0ge307CiAgZm9yIChjb25zdCBtaW5pZmllZEtleSBpbiBvYmopIHsKICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkobWluaWZpZWRLZXkpKSB7CiAgICAgIG5ld0xvb2t1cFtvYmpbbWluaWZpZWRLZXldXSA9IG1pbmlmaWVkS2V5OwogICAgfQogIH0KICByZXR1cm4gbmV3TG9va3VwOwp9CmZ1bmN0aW9uIMm1ybVkZWZpbmVEaXJlY3RpdmUoZGlyZWN0aXZlRGVmaW5pdGlvbikgewogIHJldHVybiBub1NpZGVFZmZlY3RzKCgpID0+IHsKICAgIGNvbnN0IGRlZiA9IGdldE5nRGlyZWN0aXZlRGVmKGRpcmVjdGl2ZURlZmluaXRpb24pOwogICAgaW5pdEZlYXR1cmVzKGRlZik7CiAgICByZXR1cm4gZGVmOwogIH0pOwp9CmZ1bmN0aW9uIMm1ybVkZWZpbmVQaXBlKHBpcGVEZWYpIHsKICByZXR1cm4gewogICAgdHlwZTogcGlwZURlZi50eXBlLAogICAgbmFtZTogcGlwZURlZi5uYW1lLAogICAgZmFjdG9yeTogbnVsbCwKICAgIHB1cmU6IHBpcGVEZWYucHVyZSAhPT0gZmFsc2UsCiAgICBzdGFuZGFsb25lOiBwaXBlRGVmLnN0YW5kYWxvbmUgPz8gdHJ1ZSwKICAgIG9uRGVzdHJveTogcGlwZURlZi50eXBlLnByb3RvdHlwZS5uZ09uRGVzdHJveSB8fCBudWxsCiAgfTsKfQpmdW5jdGlvbiBnZXROZ0RpcmVjdGl2ZURlZihkaXJlY3RpdmVEZWZpbml0aW9uKSB7CiAgY29uc3QgZGVjbGFyZWRJbnB1dHMgPSB7fTsKICByZXR1cm4gewogICAgdHlwZTogZGlyZWN0aXZlRGVmaW5pdGlvbi50eXBlLAogICAgcHJvdmlkZXJzUmVzb2x2ZXI6IG51bGwsCiAgICB2aWV3UHJvdmlkZXJzUmVzb2x2ZXI6IG51bGwsCiAgICBmYWN0b3J5OiBudWxsLAogICAgaG9zdEJpbmRpbmdzOiBkaXJlY3RpdmVEZWZpbml0aW9uLmhvc3RCaW5kaW5ncyB8fCBudWxsLAogICAgaG9zdFZhcnM6IGRpcmVjdGl2ZURlZmluaXRpb24uaG9zdFZhcnMgfHwgMCwKICAgIGhvc3RBdHRyczogZGlyZWN0aXZlRGVmaW5pdGlvbi5ob3N0QXR0cnMgfHwgbnVsbCwKICAgIGNvbnRlbnRRdWVyaWVzOiBkaXJlY3RpdmVEZWZpbml0aW9uLmNvbnRlbnRRdWVyaWVzIHx8IG51bGwsCiAgICBkZWNsYXJlZElucHV0cywKICAgIGlucHV0Q29uZmlnOiBkaXJlY3RpdmVEZWZpbml0aW9uLmlucHV0cyB8fCBFTVBUWV9PQkosCiAgICBleHBvcnRBczogZGlyZWN0aXZlRGVmaW5pdGlvbi5leHBvcnRBcyB8fCBudWxsLAogICAgc3RhbmRhbG9uZTogZGlyZWN0aXZlRGVmaW5pdGlvbi5zdGFuZGFsb25lID8/IHRydWUsCiAgICBzaWduYWxzOiBkaXJlY3RpdmVEZWZpbml0aW9uLnNpZ25hbHMgPT09IHRydWUsCiAgICBzZWxlY3RvcnM6IGRpcmVjdGl2ZURlZmluaXRpb24uc2VsZWN0b3JzIHx8IEVNUFRZX0FSUkFZLAogICAgdmlld1F1ZXJ5OiBkaXJlY3RpdmVEZWZpbml0aW9uLnZpZXdRdWVyeSB8fCBudWxsLAogICAgZmVhdHVyZXM6IGRpcmVjdGl2ZURlZmluaXRpb24uZmVhdHVyZXMgfHwgbnVsbCwKICAgIHNldElucHV0OiBudWxsLAogICAgcmVzb2x2ZUhvc3REaXJlY3RpdmVzOiBudWxsLAogICAgaG9zdERpcmVjdGl2ZXM6IG51bGwsCiAgICBpbnB1dHM6IHBhcnNlQW5kQ29udmVydElucHV0c0ZvckRlZmluaXRpb24oZGlyZWN0aXZlRGVmaW5pdGlvbi5pbnB1dHMsIGRlY2xhcmVkSW5wdXRzKSwKICAgIG91dHB1dHM6IHBhcnNlQW5kQ29udmVydE91dHB1dHNGb3JEZWZpbml0aW9uKGRpcmVjdGl2ZURlZmluaXRpb24ub3V0cHV0cyksCiAgICBkZWJ1Z0luZm86IG51bGwKICB9Owp9CmZ1bmN0aW9uIGluaXRGZWF0dXJlcyhkZWZpbml0aW9uKSB7CiAgZGVmaW5pdGlvbi5mZWF0dXJlcz8uZm9yRWFjaCgoZm4pID0+IGZuKGRlZmluaXRpb24pKTsKfQpmdW5jdGlvbiBleHRyYWN0RGVmTGlzdE9yRmFjdG9yeShkZXBlbmRlbmNpZXMsIGRlZkV4dHJhY3RvcikgewogIGlmICghZGVwZW5kZW5jaWVzKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgcmV0dXJuICgpID0+IHsKICAgIGNvbnN0IHJlc29sdmVkRGVwZW5kZW5jaWVzID0gdHlwZW9mIGRlcGVuZGVuY2llcyA9PT0gImZ1bmN0aW9uIiA/IGRlcGVuZGVuY2llcygpIDogZGVwZW5kZW5jaWVzOwogICAgY29uc3QgcmVzdWx0ID0gW107CiAgICBmb3IgKGNvbnN0IGRlcCBvZiByZXNvbHZlZERlcGVuZGVuY2llcykgewogICAgICBjb25zdCBkZWZpbml0aW9uID0gZGVmRXh0cmFjdG9yKGRlcCk7CiAgICAgIGlmIChkZWZpbml0aW9uICE9PSBudWxsKSB7CiAgICAgICAgcmVzdWx0LnB1c2goZGVmaW5pdGlvbik7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfTsKfQp2YXIgR0VORVJBVEVEX0NPTVBfSURTID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKZnVuY3Rpb24gZ2V0Q29tcG9uZW50SWQoY29tcG9uZW50RGVmKSB7CiAgbGV0IGhhc2ggPSAwOwogIGNvbnN0IGNvbXBvbmVudERlZkNvbnN0cyA9IHR5cGVvZiBjb21wb25lbnREZWYuY29uc3RzID09PSAiZnVuY3Rpb24iID8gIiIgOiBjb21wb25lbnREZWYuY29uc3RzOwogIGNvbnN0IGhhc2hTZWxlY3RvcnMgPSBbY29tcG9uZW50RGVmLnNlbGVjdG9ycywgY29tcG9uZW50RGVmLm5nQ29udGVudFNlbGVjdG9ycywgY29tcG9uZW50RGVmLmhvc3RWYXJzLCBjb21wb25lbnREZWYuaG9zdEF0dHJzLCBjb21wb25lbnREZWZDb25zdHMsIGNvbXBvbmVudERlZi52YXJzLCBjb21wb25lbnREZWYuZGVjbHMsIGNvbXBvbmVudERlZi5lbmNhcHN1bGF0aW9uLCBjb21wb25lbnREZWYuc3RhbmRhbG9uZSwgY29tcG9uZW50RGVmLnNpZ25hbHMsIGNvbXBvbmVudERlZi5leHBvcnRBcywgSlNPTi5zdHJpbmdpZnkoY29tcG9uZW50RGVmLmlucHV0cyksIEpTT04uc3RyaW5naWZ5KGNvbXBvbmVudERlZi5vdXRwdXRzKSwgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoY29tcG9uZW50RGVmLnR5cGUucHJvdG90eXBlKSwgISFjb21wb25lbnREZWYuY29udGVudFF1ZXJpZXMsICEhY29tcG9uZW50RGVmLnZpZXdRdWVyeV07CiAgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgewogICAgZm9yIChjb25zdCBpdGVtIG9mIGhhc2hTZWxlY3RvcnMpIHsKICAgICAgYXNzZXJ0Tm90RXF1YWwodHlwZW9mIGl0ZW0sICJmdW5jdGlvbiIsICJJbnRlcm5hbCBlcnJvcjogYXR0ZW1wdGluZyB0byB1c2UgYSBmdW5jdGlvbiBpbiBjb21wb25lbnQgaWQgY29tcHV0YXRpb24gbG9naWMuIik7CiAgICB9CiAgfQogIGZvciAoY29uc3QgY2hhciBvZiBoYXNoU2VsZWN0b3JzLmpvaW4oInwiKSkgewogICAgaGFzaCA9IE1hdGguaW11bCgzMSwgaGFzaCkgKyBjaGFyLmNoYXJDb2RlQXQoMCkgPDwgMDsKICB9CiAgaGFzaCArPSAyMTQ3NDgzNjQ3ICsgMTsKICBjb25zdCBjb21wSWQgPSAiYyIgKyBoYXNoOwogIGlmICgodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiB0cnVlKSB7CiAgICBpZiAoR0VORVJBVEVEX0NPTVBfSURTLmhhcyhjb21wSWQpKSB7CiAgICAgIGNvbnN0IHByZXZpb3VzQ29tcERlZlR5cGUgPSBHRU5FUkFURURfQ09NUF9JRFMuZ2V0KGNvbXBJZCk7CiAgICAgIGlmIChwcmV2aW91c0NvbXBEZWZUeXBlICE9PSBjb21wb25lbnREZWYudHlwZSkgewogICAgICAgIGNvbnNvbGUud2Fybihmb3JtYXRSdW50aW1lRXJyb3IoLTkxMiwgYENvbXBvbmVudCBJRCBnZW5lcmF0aW9uIGNvbGxpc2lvbiBkZXRlY3RlZC4gQ29tcG9uZW50cyAnJHtwcmV2aW91c0NvbXBEZWZUeXBlLm5hbWV9JyBhbmQgJyR7Y29tcG9uZW50RGVmLnR5cGUubmFtZX0nIHdpdGggc2VsZWN0b3IgJyR7c3RyaW5naWZ5Q1NTU2VsZWN0b3JMaXN0KGNvbXBvbmVudERlZi5zZWxlY3RvcnMpfScgZ2VuZXJhdGVkIHRoZSBzYW1lIGNvbXBvbmVudCBJRC4gVG8gZml4IHRoaXMsIHlvdSBjYW4gY2hhbmdlIHRoZSBzZWxlY3RvciBvZiBvbmUgb2YgdGhvc2UgY29tcG9uZW50cyBvciBhZGQgYW4gZXh0cmEgaG9zdCBhdHRyaWJ1dGUgdG8gZm9yY2UgYSBkaWZmZXJlbnQgSUQuYCkpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBHRU5FUkFURURfQ09NUF9JRFMuc2V0KGNvbXBJZCwgY29tcG9uZW50RGVmLnR5cGUpOwogICAgfQogIH0KICByZXR1cm4gY29tcElkOwp9CmZ1bmN0aW9uIMm1ybVIb3N0RGlyZWN0aXZlc0ZlYXR1cmUocmF3SG9zdERpcmVjdGl2ZXMpIHsKICBjb25zdCBmZWF0dXJlID0gKGRlZmluaXRpb24pID0+IHsKICAgIGNvbnN0IGlzRWFnZXIgPSBBcnJheS5pc0FycmF5KHJhd0hvc3REaXJlY3RpdmVzKTsKICAgIGlmIChkZWZpbml0aW9uLmhvc3REaXJlY3RpdmVzID09PSBudWxsKSB7CiAgICAgIGRlZmluaXRpb24ucmVzb2x2ZUhvc3REaXJlY3RpdmVzID0gcmVzb2x2ZUhvc3REaXJlY3RpdmVzOwogICAgICBkZWZpbml0aW9uLmhvc3REaXJlY3RpdmVzID0gaXNFYWdlciA/IHJhd0hvc3REaXJlY3RpdmVzLm1hcChjcmVhdGVIb3N0RGlyZWN0aXZlRGVmKSA6IFtyYXdIb3N0RGlyZWN0aXZlc107CiAgICB9IGVsc2UgaWYgKGlzRWFnZXIpIHsKICAgICAgZGVmaW5pdGlvbi5ob3N0RGlyZWN0aXZlcy51bnNoaWZ0KC4uLnJhd0hvc3REaXJlY3RpdmVzLm1hcChjcmVhdGVIb3N0RGlyZWN0aXZlRGVmKSk7CiAgICB9IGVsc2UgewogICAgICBkZWZpbml0aW9uLmhvc3REaXJlY3RpdmVzLnVuc2hpZnQocmF3SG9zdERpcmVjdGl2ZXMpOwogICAgfQogIH07CiAgZmVhdHVyZS5uZ0luaGVyaXQgPSB0cnVlOwogIHJldHVybiBmZWF0dXJlOwp9CmZ1bmN0aW9uIHJlc29sdmVIb3N0RGlyZWN0aXZlcyhtYXRjaGVzKSB7CiAgY29uc3QgYWxsRGlyZWN0aXZlRGVmcyA9IFtdOwogIGxldCBoYXNDb21wb25lbnQgPSBmYWxzZTsKICBsZXQgaG9zdERpcmVjdGl2ZURlZnMgPSBudWxsOwogIGxldCBob3N0RGlyZWN0aXZlUmFuZ2VzID0gbnVsbDsKICBmb3IgKGxldCBpID0gMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGRlZiA9IG1hdGNoZXNbaV07CiAgICBpZiAoZGVmLmhvc3REaXJlY3RpdmVzICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IHN0YXJ0ID0gYWxsRGlyZWN0aXZlRGVmcy5sZW5ndGg7CiAgICAgIGhvc3REaXJlY3RpdmVEZWZzID8/PSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogICAgICBob3N0RGlyZWN0aXZlUmFuZ2VzID8/PSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogICAgICBmaW5kSG9zdERpcmVjdGl2ZURlZnMoZGVmLCBhbGxEaXJlY3RpdmVEZWZzLCBob3N0RGlyZWN0aXZlRGVmcyk7CiAgICAgIGhvc3REaXJlY3RpdmVSYW5nZXMuc2V0KGRlZiwgW3N0YXJ0LCBhbGxEaXJlY3RpdmVEZWZzLmxlbmd0aCAtIDFdKTsKICAgIH0KICAgIGlmIChpID09PSAwICYmIGlzQ29tcG9uZW50RGVmKGRlZikpIHsKICAgICAgaGFzQ29tcG9uZW50ID0gdHJ1ZTsKICAgICAgYWxsRGlyZWN0aXZlRGVmcy5wdXNoKGRlZik7CiAgICB9CiAgfQogIGZvciAobGV0IGkgPSBoYXNDb21wb25lbnQgPyAxIDogMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHsKICAgIGFsbERpcmVjdGl2ZURlZnMucHVzaChtYXRjaGVzW2ldKTsKICB9CiAgcmV0dXJuIFthbGxEaXJlY3RpdmVEZWZzLCBob3N0RGlyZWN0aXZlRGVmcywgaG9zdERpcmVjdGl2ZVJhbmdlc107Cn0KZnVuY3Rpb24gZmluZEhvc3REaXJlY3RpdmVEZWZzKGN1cnJlbnREZWYsIG1hdGNoZWREZWZzLCBob3N0RGlyZWN0aXZlRGVmcykgewogIGlmIChjdXJyZW50RGVmLmhvc3REaXJlY3RpdmVzICE9PSBudWxsKSB7CiAgICBmb3IgKGNvbnN0IGNvbmZpZ09yRm4gb2YgY3VycmVudERlZi5ob3N0RGlyZWN0aXZlcykgewogICAgICBpZiAodHlwZW9mIGNvbmZpZ09yRm4gPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICBjb25zdCByZXNvbHZlZDIgPSBjb25maWdPckZuKCk7CiAgICAgICAgZm9yIChjb25zdCBjb25maWcyIG9mIHJlc29sdmVkMikgewogICAgICAgICAgdHJhY2tIb3N0RGlyZWN0aXZlRGVmKGNyZWF0ZUhvc3REaXJlY3RpdmVEZWYoY29uZmlnMiksIG1hdGNoZWREZWZzLCBob3N0RGlyZWN0aXZlRGVmcyk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRyYWNrSG9zdERpcmVjdGl2ZURlZihjb25maWdPckZuLCBtYXRjaGVkRGVmcywgaG9zdERpcmVjdGl2ZURlZnMpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHRyYWNrSG9zdERpcmVjdGl2ZURlZihkZWYsIG1hdGNoZWREZWZzLCBob3N0RGlyZWN0aXZlRGVmcykgewogIGNvbnN0IGhvc3REaXJlY3RpdmVEZWYgPSBnZXREaXJlY3RpdmVEZWYoZGVmLmRpcmVjdGl2ZSk7CiAgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgewogICAgdmFsaWRhdGVIb3N0RGlyZWN0aXZlKGRlZiwgaG9zdERpcmVjdGl2ZURlZik7CiAgfQogIHBhdGNoRGVjbGFyZWRJbnB1dHMoaG9zdERpcmVjdGl2ZURlZi5kZWNsYXJlZElucHV0cywgZGVmLmlucHV0cyk7CiAgZmluZEhvc3REaXJlY3RpdmVEZWZzKGhvc3REaXJlY3RpdmVEZWYsIG1hdGNoZWREZWZzLCBob3N0RGlyZWN0aXZlRGVmcyk7CiAgaG9zdERpcmVjdGl2ZURlZnMuc2V0KGhvc3REaXJlY3RpdmVEZWYsIGRlZik7CiAgbWF0Y2hlZERlZnMucHVzaChob3N0RGlyZWN0aXZlRGVmKTsKfQpmdW5jdGlvbiBjcmVhdGVIb3N0RGlyZWN0aXZlRGVmKGNvbmZpZzIpIHsKICByZXR1cm4gdHlwZW9mIGNvbmZpZzIgPT09ICJmdW5jdGlvbiIgPyB7CiAgICBkaXJlY3RpdmU6IHJlc29sdmVGb3J3YXJkUmVmKGNvbmZpZzIpLAogICAgaW5wdXRzOiBFTVBUWV9PQkosCiAgICBvdXRwdXRzOiBFTVBUWV9PQkoKICB9IDogewogICAgZGlyZWN0aXZlOiByZXNvbHZlRm9yd2FyZFJlZihjb25maWcyLmRpcmVjdGl2ZSksCiAgICBpbnB1dHM6IGJpbmRpbmdBcnJheVRvTWFwKGNvbmZpZzIuaW5wdXRzKSwKICAgIG91dHB1dHM6IGJpbmRpbmdBcnJheVRvTWFwKGNvbmZpZzIub3V0cHV0cykKICB9Owp9CmZ1bmN0aW9uIGJpbmRpbmdBcnJheVRvTWFwKGJpbmRpbmdzKSB7CiAgaWYgKGJpbmRpbmdzID09PSB2b2lkIDAgfHwgYmluZGluZ3MubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gRU1QVFlfT0JKOwogIH0KICBjb25zdCByZXN1bHQgPSB7fTsKICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmRpbmdzLmxlbmd0aDsgaSArPSAyKSB7CiAgICByZXN1bHRbYmluZGluZ3NbaV1dID0gYmluZGluZ3NbaSArIDFdOwogIH0KICByZXR1cm4gcmVzdWx0Owp9CmZ1bmN0aW9uIHBhdGNoRGVjbGFyZWRJbnB1dHMoZGVjbGFyZWRJbnB1dHMsIGV4cG9zZWRJbnB1dHMpIHsKICBmb3IgKGNvbnN0IHB1YmxpY05hbWUgaW4gZXhwb3NlZElucHV0cykgewogICAgaWYgKGV4cG9zZWRJbnB1dHMuaGFzT3duUHJvcGVydHkocHVibGljTmFtZSkpIHsKICAgICAgY29uc3QgcmVtYXBwZWRQdWJsaWNOYW1lID0gZXhwb3NlZElucHV0c1twdWJsaWNOYW1lXTsKICAgICAgY29uc3QgcHJpdmF0ZU5hbWUgPSBkZWNsYXJlZElucHV0c1twdWJsaWNOYW1lXTsKICAgICAgaWYgKCh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIGRlY2xhcmVkSW5wdXRzLmhhc093blByb3BlcnR5KHJlbWFwcGVkUHVibGljTmFtZSkpIHsKICAgICAgICBhc3NlcnRFcXVhbChkZWNsYXJlZElucHV0c1tyZW1hcHBlZFB1YmxpY05hbWVdLCBkZWNsYXJlZElucHV0c1twdWJsaWNOYW1lXSwgYENvbmZsaWN0aW5nIGhvc3QgZGlyZWN0aXZlIGlucHV0IGFsaWFzICR7cHVibGljTmFtZX0uYCk7CiAgICAgIH0KICAgICAgZGVjbGFyZWRJbnB1dHNbcmVtYXBwZWRQdWJsaWNOYW1lXSA9IHByaXZhdGVOYW1lOwogICAgfQogIH0KfQpmdW5jdGlvbiB2YWxpZGF0ZUhvc3REaXJlY3RpdmUoaG9zdERpcmVjdGl2ZUNvbmZpZywgZGlyZWN0aXZlRGVmKSB7CiAgY29uc3QgdHlwZSA9IGhvc3REaXJlY3RpdmVDb25maWcuZGlyZWN0aXZlOwogIGlmIChkaXJlY3RpdmVEZWYgPT09IG51bGwpIHsKICAgIGlmIChnZXRDb21wb25lbnREZWYodHlwZSkgIT09IG51bGwpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigzMTAsIGBIb3N0IGRpcmVjdGl2ZSAke3R5cGUubmFtZX0gY2Fubm90IGJlIGEgY29tcG9uZW50LmApOwogICAgfQogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigzMDcsIGBDb3VsZCBub3QgcmVzb2x2ZSBtZXRhZGF0YSBmb3IgaG9zdCBkaXJlY3RpdmUgJHt0eXBlLm5hbWV9LiBNYWtlIHN1cmUgdGhhdCB0aGUgJHt0eXBlLm5hbWV9IGNsYXNzIGlzIGFubm90YXRlZCB3aXRoIGFuIEBEaXJlY3RpdmUgZGVjb3JhdG9yLmApOwogIH0KICBpZiAoIWRpcmVjdGl2ZURlZi5zdGFuZGFsb25lKSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDMwOCwgYEhvc3QgZGlyZWN0aXZlICR7ZGlyZWN0aXZlRGVmLnR5cGUubmFtZX0gbXVzdCBiZSBzdGFuZGFsb25lLmApOwogIH0KICB2YWxpZGF0ZU1hcHBpbmdzKCJpbnB1dCIsIGRpcmVjdGl2ZURlZiwgaG9zdERpcmVjdGl2ZUNvbmZpZy5pbnB1dHMpOwogIHZhbGlkYXRlTWFwcGluZ3MoIm91dHB1dCIsIGRpcmVjdGl2ZURlZiwgaG9zdERpcmVjdGl2ZUNvbmZpZy5vdXRwdXRzKTsKfQpmdW5jdGlvbiB2YWxpZGF0ZU1hcHBpbmdzKGJpbmRpbmdUeXBlLCBkZWYsIGhvc3REaXJlY3RpdmVCaW5kaW5ncykgewogIGNvbnN0IGNsYXNzTmFtZSA9IGRlZi50eXBlLm5hbWU7CiAgY29uc3QgYmluZGluZ3MgPSBiaW5kaW5nVHlwZSA9PT0gImlucHV0IiA/IGRlZi5pbnB1dHMgOiBkZWYub3V0cHV0czsKICBmb3IgKGNvbnN0IHB1YmxpY05hbWUgaW4gaG9zdERpcmVjdGl2ZUJpbmRpbmdzKSB7CiAgICBpZiAoaG9zdERpcmVjdGl2ZUJpbmRpbmdzLmhhc093blByb3BlcnR5KHB1YmxpY05hbWUpKSB7CiAgICAgIGlmICghYmluZGluZ3MuaGFzT3duUHJvcGVydHkocHVibGljTmFtZSkpIHsKICAgICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDMxMSwgYERpcmVjdGl2ZSAke2NsYXNzTmFtZX0gZG9lcyBub3QgaGF2ZSBhbiAke2JpbmRpbmdUeXBlfSB3aXRoIGEgcHVibGljIG5hbWUgb2YgJHtwdWJsaWNOYW1lfS5gKTsKICAgICAgfQogICAgICBjb25zdCByZW1hcHBlZFB1YmxpY05hbWUgPSBob3N0RGlyZWN0aXZlQmluZGluZ3NbcHVibGljTmFtZV07CiAgICAgIGlmIChiaW5kaW5ncy5oYXNPd25Qcm9wZXJ0eShyZW1hcHBlZFB1YmxpY05hbWUpICYmIHJlbWFwcGVkUHVibGljTmFtZSAhPT0gcHVibGljTmFtZSkgewogICAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMzEyLCBgQ2Fubm90IGFsaWFzICR7YmluZGluZ1R5cGV9ICR7cHVibGljTmFtZX0gb2YgaG9zdCBkaXJlY3RpdmUgJHtjbGFzc05hbWV9IHRvICR7cmVtYXBwZWRQdWJsaWNOYW1lfSwgYmVjYXVzZSBpdCBhbHJlYWR5IGhhcyBhIGRpZmZlcmVudCAke2JpbmRpbmdUeXBlfSB3aXRoIHRoZSBzYW1lIHB1YmxpYyBuYW1lLmApOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGdldFN1cGVyVHlwZSh0eXBlKSB7CiAgcmV0dXJuIE9iamVjdC5nZXRQcm90b3R5cGVPZih0eXBlLnByb3RvdHlwZSkuY29uc3RydWN0b3I7Cn0KZnVuY3Rpb24gybXJtUluaGVyaXREZWZpbml0aW9uRmVhdHVyZShkZWZpbml0aW9uKSB7CiAgbGV0IHN1cGVyVHlwZSA9IGdldFN1cGVyVHlwZShkZWZpbml0aW9uLnR5cGUpOwogIGxldCBzaG91bGRJbmhlcml0RmllbGRzID0gdHJ1ZTsKICBjb25zdCBpbmhlcml0YW5jZUNoYWluID0gW2RlZmluaXRpb25dOwogIHdoaWxlIChzdXBlclR5cGUpIHsKICAgIGxldCBzdXBlckRlZiA9IHZvaWQgMDsKICAgIGlmIChpc0NvbXBvbmVudERlZihkZWZpbml0aW9uKSkgewogICAgICBzdXBlckRlZiA9IHN1cGVyVHlwZS7JtWNtcCB8fCBzdXBlclR5cGUuybVkaXI7CiAgICB9IGVsc2UgewogICAgICBpZiAoc3VwZXJUeXBlLsm1Y21wKSB7CiAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDMsIG5nRGV2TW9kZSAmJiBgRGlyZWN0aXZlcyBjYW5ub3QgaW5oZXJpdCBDb21wb25lbnRzLiBEaXJlY3RpdmUgJHtzdHJpbmdpZnlGb3JFcnJvcihkZWZpbml0aW9uLnR5cGUpfSBpcyBhdHRlbXB0aW5nIHRvIGV4dGVuZCBjb21wb25lbnQgJHtzdHJpbmdpZnlGb3JFcnJvcihzdXBlclR5cGUpfWApOwogICAgICB9CiAgICAgIHN1cGVyRGVmID0gc3VwZXJUeXBlLsm1ZGlyOwogICAgfQogICAgaWYgKHN1cGVyRGVmKSB7CiAgICAgIGlmIChzaG91bGRJbmhlcml0RmllbGRzKSB7CiAgICAgICAgaW5oZXJpdGFuY2VDaGFpbi5wdXNoKHN1cGVyRGVmKTsKICAgICAgICBjb25zdCB3cml0ZWFibGVEZWYgPSBkZWZpbml0aW9uOwogICAgICAgIHdyaXRlYWJsZURlZi5pbnB1dHMgPSBtYXliZVVud3JhcEVtcHR5KGRlZmluaXRpb24uaW5wdXRzKTsKICAgICAgICB3cml0ZWFibGVEZWYuZGVjbGFyZWRJbnB1dHMgPSBtYXliZVVud3JhcEVtcHR5KGRlZmluaXRpb24uZGVjbGFyZWRJbnB1dHMpOwogICAgICAgIHdyaXRlYWJsZURlZi5vdXRwdXRzID0gbWF5YmVVbndyYXBFbXB0eShkZWZpbml0aW9uLm91dHB1dHMpOwogICAgICAgIGNvbnN0IHN1cGVySG9zdEJpbmRpbmdzID0gc3VwZXJEZWYuaG9zdEJpbmRpbmdzOwogICAgICAgIHN1cGVySG9zdEJpbmRpbmdzICYmIGluaGVyaXRIb3N0QmluZGluZ3MoZGVmaW5pdGlvbiwgc3VwZXJIb3N0QmluZGluZ3MpOwogICAgICAgIGNvbnN0IHN1cGVyVmlld1F1ZXJ5ID0gc3VwZXJEZWYudmlld1F1ZXJ5OwogICAgICAgIGNvbnN0IHN1cGVyQ29udGVudFF1ZXJpZXMgPSBzdXBlckRlZi5jb250ZW50UXVlcmllczsKICAgICAgICBzdXBlclZpZXdRdWVyeSAmJiBpbmhlcml0Vmlld1F1ZXJ5KGRlZmluaXRpb24sIHN1cGVyVmlld1F1ZXJ5KTsKICAgICAgICBzdXBlckNvbnRlbnRRdWVyaWVzICYmIGluaGVyaXRDb250ZW50UXVlcmllcyhkZWZpbml0aW9uLCBzdXBlckNvbnRlbnRRdWVyaWVzKTsKICAgICAgICBtZXJnZUlucHV0c1dpdGhUcmFuc2Zvcm1zKGRlZmluaXRpb24sIHN1cGVyRGVmKTsKICAgICAgICBmaWxsUHJvcGVydGllcyhkZWZpbml0aW9uLm91dHB1dHMsIHN1cGVyRGVmLm91dHB1dHMpOwogICAgICAgIGlmIChpc0NvbXBvbmVudERlZihzdXBlckRlZikgJiYgc3VwZXJEZWYuZGF0YS5hbmltYXRpb24pIHsKICAgICAgICAgIGNvbnN0IGRlZkRhdGEgPSBkZWZpbml0aW9uLmRhdGE7CiAgICAgICAgICBkZWZEYXRhLmFuaW1hdGlvbiA9IChkZWZEYXRhLmFuaW1hdGlvbiB8fCBbXSkuY29uY2F0KHN1cGVyRGVmLmRhdGEuYW5pbWF0aW9uKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgZmVhdHVyZXMgPSBzdXBlckRlZi5mZWF0dXJlczsKICAgICAgaWYgKGZlYXR1cmVzKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmZWF0dXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgZmVhdHVyZSA9IGZlYXR1cmVzW2ldOwogICAgICAgICAgaWYgKGZlYXR1cmUgJiYgZmVhdHVyZS5uZ0luaGVyaXQpIHsKICAgICAgICAgICAgZmVhdHVyZShkZWZpbml0aW9uKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChmZWF0dXJlID09PSDJtcm1SW5oZXJpdERlZmluaXRpb25GZWF0dXJlKSB7CiAgICAgICAgICAgIHNob3VsZEluaGVyaXRGaWVsZHMgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHN1cGVyVHlwZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihzdXBlclR5cGUpOwogIH0KICBtZXJnZUhvc3RBdHRyc0Fjcm9zc0luaGVyaXRhbmNlKGluaGVyaXRhbmNlQ2hhaW4pOwp9CmZ1bmN0aW9uIG1lcmdlSW5wdXRzV2l0aFRyYW5zZm9ybXModGFyZ2V0LCBzb3VyY2UpIHsKICBmb3IgKGNvbnN0IGtleSBpbiBzb3VyY2UuaW5wdXRzKSB7CiAgICBpZiAoIXNvdXJjZS5pbnB1dHMuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmICh0YXJnZXQuaW5wdXRzLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBjb25zdCB2YWx1ZSA9IHNvdXJjZS5pbnB1dHNba2V5XTsKICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7CiAgICAgIHRhcmdldC5pbnB1dHNba2V5XSA9IHZhbHVlOwogICAgICB0YXJnZXQuZGVjbGFyZWRJbnB1dHNba2V5XSA9IHNvdXJjZS5kZWNsYXJlZElucHV0c1trZXldOwogICAgfQogIH0KfQpmdW5jdGlvbiBtZXJnZUhvc3RBdHRyc0Fjcm9zc0luaGVyaXRhbmNlKGluaGVyaXRhbmNlQ2hhaW4pIHsKICBsZXQgaG9zdFZhcnMgPSAwOwogIGxldCBob3N0QXR0cnMgPSBudWxsOwogIGZvciAobGV0IGkgPSBpbmhlcml0YW5jZUNoYWluLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICBjb25zdCBkZWYgPSBpbmhlcml0YW5jZUNoYWluW2ldOwogICAgZGVmLmhvc3RWYXJzID0gaG9zdFZhcnMgKz0gZGVmLmhvc3RWYXJzOwogICAgZGVmLmhvc3RBdHRycyA9IG1lcmdlSG9zdEF0dHJzKGRlZi5ob3N0QXR0cnMsIGhvc3RBdHRycyA9IG1lcmdlSG9zdEF0dHJzKGhvc3RBdHRycywgZGVmLmhvc3RBdHRycykpOwogIH0KfQpmdW5jdGlvbiBtYXliZVVud3JhcEVtcHR5KHZhbHVlKSB7CiAgaWYgKHZhbHVlID09PSBFTVBUWV9PQkopIHsKICAgIHJldHVybiB7fTsKICB9IGVsc2UgaWYgKHZhbHVlID09PSBFTVBUWV9BUlJBWSkgewogICAgcmV0dXJuIFtdOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfQp9CmZ1bmN0aW9uIGluaGVyaXRWaWV3UXVlcnkoZGVmaW5pdGlvbiwgc3VwZXJWaWV3UXVlcnkpIHsKICBjb25zdCBwcmV2Vmlld1F1ZXJ5ID0gZGVmaW5pdGlvbi52aWV3UXVlcnk7CiAgaWYgKHByZXZWaWV3UXVlcnkpIHsKICAgIGRlZmluaXRpb24udmlld1F1ZXJ5ID0gKHJmLCBjdHgpID0+IHsKICAgICAgc3VwZXJWaWV3UXVlcnkocmYsIGN0eCk7CiAgICAgIHByZXZWaWV3UXVlcnkocmYsIGN0eCk7CiAgICB9OwogIH0gZWxzZSB7CiAgICBkZWZpbml0aW9uLnZpZXdRdWVyeSA9IHN1cGVyVmlld1F1ZXJ5OwogIH0KfQpmdW5jdGlvbiBpbmhlcml0Q29udGVudFF1ZXJpZXMoZGVmaW5pdGlvbiwgc3VwZXJDb250ZW50UXVlcmllcykgewogIGNvbnN0IHByZXZDb250ZW50UXVlcmllcyA9IGRlZmluaXRpb24uY29udGVudFF1ZXJpZXM7CiAgaWYgKHByZXZDb250ZW50UXVlcmllcykgewogICAgZGVmaW5pdGlvbi5jb250ZW50UXVlcmllcyA9IChyZiwgY3R4LCBkaXJlY3RpdmVJbmRleCkgPT4gewogICAgICBzdXBlckNvbnRlbnRRdWVyaWVzKHJmLCBjdHgsIGRpcmVjdGl2ZUluZGV4KTsKICAgICAgcHJldkNvbnRlbnRRdWVyaWVzKHJmLCBjdHgsIGRpcmVjdGl2ZUluZGV4KTsKICAgIH07CiAgfSBlbHNlIHsKICAgIGRlZmluaXRpb24uY29udGVudFF1ZXJpZXMgPSBzdXBlckNvbnRlbnRRdWVyaWVzOwogIH0KfQpmdW5jdGlvbiBpbmhlcml0SG9zdEJpbmRpbmdzKGRlZmluaXRpb24sIHN1cGVySG9zdEJpbmRpbmdzKSB7CiAgY29uc3QgcHJldkhvc3RCaW5kaW5ncyA9IGRlZmluaXRpb24uaG9zdEJpbmRpbmdzOwogIGlmIChwcmV2SG9zdEJpbmRpbmdzKSB7CiAgICBkZWZpbml0aW9uLmhvc3RCaW5kaW5ncyA9IChyZiwgY3R4KSA9PiB7CiAgICAgIHN1cGVySG9zdEJpbmRpbmdzKHJmLCBjdHgpOwogICAgICBwcmV2SG9zdEJpbmRpbmdzKHJmLCBjdHgpOwogICAgfTsKICB9IGVsc2UgewogICAgZGVmaW5pdGlvbi5ob3N0QmluZGluZ3MgPSBzdXBlckhvc3RCaW5kaW5nczsKICB9Cn0KZnVuY3Rpb24gdGVtcGxhdGVDcmVhdGUodE5vZGUsIGRlY2xhcmF0aW9uTFZpZXcsIGRlY2xhcmF0aW9uVFZpZXcsIGluZGV4LCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgZmxhZ3MpIHsKICBpZiAoZGVjbGFyYXRpb25UVmlldy5maXJzdENyZWF0ZVBhc3MpIHsKICAgIHROb2RlLm1lcmdlZEF0dHJzID0gbWVyZ2VIb3N0QXR0cnModE5vZGUubWVyZ2VkQXR0cnMsIHROb2RlLmF0dHJzKTsKICAgIGNvbnN0IGVtYmVkZGVkVFZpZXcgPSB0Tm9kZS50VmlldyA9IGNyZWF0ZVRWaWV3KDIsIHROb2RlLCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgZGVjbGFyYXRpb25UVmlldy5kaXJlY3RpdmVSZWdpc3RyeSwgZGVjbGFyYXRpb25UVmlldy5waXBlUmVnaXN0cnksIG51bGwsIGRlY2xhcmF0aW9uVFZpZXcuc2NoZW1hcywgZGVjbGFyYXRpb25UVmlldy5jb25zdHMsIG51bGwpOwogICAgaWYgKGRlY2xhcmF0aW9uVFZpZXcucXVlcmllcyAhPT0gbnVsbCkgewogICAgICBkZWNsYXJhdGlvblRWaWV3LnF1ZXJpZXMudGVtcGxhdGUoZGVjbGFyYXRpb25UVmlldywgdE5vZGUpOwogICAgICBlbWJlZGRlZFRWaWV3LnF1ZXJpZXMgPSBkZWNsYXJhdGlvblRWaWV3LnF1ZXJpZXMuZW1iZWRkZWRUVmlldyh0Tm9kZSk7CiAgICB9CiAgfQogIGlmIChmbGFncykgewogICAgdE5vZGUuZmxhZ3MgfD0gZmxhZ3M7CiAgfQogIHNldEN1cnJlbnRUTm9kZSh0Tm9kZSwgZmFsc2UpOwogIGNvbnN0IGNvbW1lbnQgPSBfbG9jYXRlT3JDcmVhdGVDb250YWluZXJBbmNob3IoZGVjbGFyYXRpb25UVmlldywgZGVjbGFyYXRpb25MVmlldywgdE5vZGUsIGluZGV4KTsKICBpZiAod2FzTGFzdE5vZGVDcmVhdGVkKCkpIHsKICAgIGFwcGVuZENoaWxkKGRlY2xhcmF0aW9uVFZpZXcsIGRlY2xhcmF0aW9uTFZpZXcsIGNvbW1lbnQsIHROb2RlKTsKICB9CiAgYXR0YWNoUGF0Y2hEYXRhKGNvbW1lbnQsIGRlY2xhcmF0aW9uTFZpZXcpOwogIGNvbnN0IGxDb250YWluZXIgPSBjcmVhdGVMQ29udGFpbmVyKGNvbW1lbnQsIGRlY2xhcmF0aW9uTFZpZXcsIGNvbW1lbnQsIHROb2RlKTsKICBkZWNsYXJhdGlvbkxWaWV3W2luZGV4ICsgSEVBREVSX09GRlNFVF0gPSBsQ29udGFpbmVyOwogIGFkZFRvRW5kT2ZWaWV3VHJlZShkZWNsYXJhdGlvbkxWaWV3LCBsQ29udGFpbmVyKTsKICBwb3B1bGF0ZURlaHlkcmF0ZWRWaWV3c0luTENvbnRhaW5lcihsQ29udGFpbmVyLCB0Tm9kZSwgZGVjbGFyYXRpb25MVmlldyk7Cn0KZnVuY3Rpb24gZGVjbGFyZURpcmVjdGl2ZUhvc3RUZW1wbGF0ZShkZWNsYXJhdGlvbkxWaWV3LCBkZWNsYXJhdGlvblRWaWV3LCBpbmRleCwgdGVtcGxhdGVGbiwgZGVjbHMsIHZhcnMsIHRhZ05hbWUsIGF0dHJzLCBmbGFncywgbG9jYWxSZWZzSW5kZXgsIGxvY2FsUmVmRXh0cmFjdG9yKSB7CiAgY29uc3QgYWRqdXN0ZWRJbmRleCA9IGluZGV4ICsgSEVBREVSX09GRlNFVDsKICBsZXQgdE5vZGU7CiAgaWYgKGRlY2xhcmF0aW9uVFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICB0Tm9kZSA9IGdldE9yQ3JlYXRlVE5vZGUoZGVjbGFyYXRpb25UVmlldywgYWRqdXN0ZWRJbmRleCwgNCwgdGFnTmFtZSB8fCBudWxsLCBhdHRycyB8fCBudWxsKTsKICAgIGlmIChnZXRCaW5kaW5nc0VuYWJsZWQoKSkgewogICAgICByZXNvbHZlRGlyZWN0aXZlcyhkZWNsYXJhdGlvblRWaWV3LCBkZWNsYXJhdGlvbkxWaWV3LCB0Tm9kZSwgZ2V0Q29uc3RhbnQoZGVjbGFyYXRpb25UVmlldy5jb25zdHMsIGxvY2FsUmVmc0luZGV4KSwgZmluZERpcmVjdGl2ZURlZk1hdGNoZXMpOwogICAgfQogICAgcmVnaXN0ZXJQb3N0T3JkZXJIb29rcyhkZWNsYXJhdGlvblRWaWV3LCB0Tm9kZSk7CiAgfSBlbHNlIHsKICAgIHROb2RlID0gZGVjbGFyYXRpb25UVmlldy5kYXRhW2FkanVzdGVkSW5kZXhdOwogIH0KICB0ZW1wbGF0ZUNyZWF0ZSh0Tm9kZSwgZGVjbGFyYXRpb25MVmlldywgZGVjbGFyYXRpb25UVmlldywgaW5kZXgsIHRlbXBsYXRlRm4sIGRlY2xzLCB2YXJzLCBmbGFncyk7CiAgaWYgKGlzRGlyZWN0aXZlSG9zdCh0Tm9kZSkpIHsKICAgIGNyZWF0ZURpcmVjdGl2ZXNJbnN0YW5jZXMoZGVjbGFyYXRpb25UVmlldywgZGVjbGFyYXRpb25MVmlldywgdE5vZGUpOwogIH0KICBpZiAobG9jYWxSZWZzSW5kZXggIT0gbnVsbCkgewogICAgc2F2ZVJlc29sdmVkTG9jYWxzSW5EYXRhKGRlY2xhcmF0aW9uTFZpZXcsIHROb2RlLCBsb2NhbFJlZkV4dHJhY3Rvcik7CiAgfQogIHJldHVybiB0Tm9kZTsKfQpmdW5jdGlvbiBkZWNsYXJlTm9EaXJlY3RpdmVIb3N0VGVtcGxhdGUoZGVjbGFyYXRpb25MVmlldywgZGVjbGFyYXRpb25UVmlldywgaW5kZXgsIHRlbXBsYXRlRm4sIGRlY2xzLCB2YXJzLCB0YWdOYW1lLCBhdHRycywgZmxhZ3MsIGxvY2FsUmVmc0luZGV4LCBsb2NhbFJlZkV4dHJhY3RvcikgewogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBpbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgbGV0IHROb2RlOwogIGlmIChkZWNsYXJhdGlvblRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgdE5vZGUgPSBnZXRPckNyZWF0ZVROb2RlKGRlY2xhcmF0aW9uVFZpZXcsIGFkanVzdGVkSW5kZXgsIDQsIHRhZ05hbWUgfHwgbnVsbCwgYXR0cnMgfHwgbnVsbCk7CiAgICBpZiAobG9jYWxSZWZzSW5kZXggIT0gbnVsbCkgewogICAgICBjb25zdCByZWZzID0gZ2V0Q29uc3RhbnQoZGVjbGFyYXRpb25UVmlldy5jb25zdHMsIGxvY2FsUmVmc0luZGV4KTsKICAgICAgdE5vZGUubG9jYWxOYW1lcyA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlZnMubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICB0Tm9kZS5sb2NhbE5hbWVzLnB1c2gocmVmc1tpXSwgLTEpOwogICAgICB9CiAgICB9CiAgfSBlbHNlIHsKICAgIHROb2RlID0gZGVjbGFyYXRpb25UVmlldy5kYXRhW2FkanVzdGVkSW5kZXhdOwogIH0KICB0ZW1wbGF0ZUNyZWF0ZSh0Tm9kZSwgZGVjbGFyYXRpb25MVmlldywgZGVjbGFyYXRpb25UVmlldywgaW5kZXgsIHRlbXBsYXRlRm4sIGRlY2xzLCB2YXJzLCBmbGFncyk7CiAgaWYgKGxvY2FsUmVmc0luZGV4ICE9IG51bGwpIHsKICAgIHNhdmVSZXNvbHZlZExvY2Fsc0luRGF0YShkZWNsYXJhdGlvbkxWaWV3LCB0Tm9kZSwgbG9jYWxSZWZFeHRyYWN0b3IpOwogIH0KICByZXR1cm4gdE5vZGU7Cn0KZnVuY3Rpb24gybXJtXRlbXBsYXRlKGluZGV4LCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgdGFnTmFtZSwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgsIGxvY2FsUmVmRXh0cmFjdG9yKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBhdHRycyA9IGdldENvbnN0YW50KHRWaWV3LmNvbnN0cywgYXR0cnNJbmRleCk7CiAgZGVjbGFyZURpcmVjdGl2ZUhvc3RUZW1wbGF0ZShsVmlldywgdFZpZXcsIGluZGV4LCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgdGFnTmFtZSwgYXR0cnMsIHZvaWQgMCwgbG9jYWxSZWZzSW5kZXgsIGxvY2FsUmVmRXh0cmFjdG9yKTsKICByZXR1cm4gybXJtXRlbXBsYXRlOwp9CmZ1bmN0aW9uIMm1ybVkb21UZW1wbGF0ZShpbmRleCwgdGVtcGxhdGVGbiwgZGVjbHMsIHZhcnMsIHRhZ05hbWUsIGF0dHJzSW5kZXgsIGxvY2FsUmVmc0luZGV4LCBsb2NhbFJlZkV4dHJhY3RvcikgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgYXR0cnMgPSBnZXRDb25zdGFudCh0Vmlldy5jb25zdHMsIGF0dHJzSW5kZXgpOwogIGRlY2xhcmVOb0RpcmVjdGl2ZUhvc3RUZW1wbGF0ZShsVmlldywgdFZpZXcsIGluZGV4LCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgdGFnTmFtZSwgYXR0cnMsIHZvaWQgMCwgbG9jYWxSZWZzSW5kZXgsIGxvY2FsUmVmRXh0cmFjdG9yKTsKICByZXR1cm4gybXJtWRvbVRlbXBsYXRlOwp9CnZhciBfbG9jYXRlT3JDcmVhdGVDb250YWluZXJBbmNob3IgPSBjcmVhdGVDb250YWluZXJBbmNob3JJbXBsOwpmdW5jdGlvbiBjcmVhdGVDb250YWluZXJBbmNob3JJbXBsKHRWaWV3LCBsVmlldywgdE5vZGUsIGluZGV4KSB7CiAgbGFzdE5vZGVXYXNDcmVhdGVkKHRydWUpOwogIHJldHVybiBsVmlld1tSRU5ERVJFUl0uY3JlYXRlQ29tbWVudChuZ0Rldk1vZGUgPyAiY29udGFpbmVyIiA6ICIiKTsKfQpmdW5jdGlvbiBsb2NhdGVPckNyZWF0ZUNvbnRhaW5lckFuY2hvckltcGwodFZpZXcsIGxWaWV3LCB0Tm9kZSwgaW5kZXgpIHsKICBjb25zdCBpc05vZGVDcmVhdGlvbk1vZGUgPSAhY2FuSHlkcmF0ZU5vZGUobFZpZXcsIHROb2RlKTsKICBsYXN0Tm9kZVdhc0NyZWF0ZWQoaXNOb2RlQ3JlYXRpb25Nb2RlKTsKICBjb25zdCBzc3JJZCA9IGxWaWV3W0hZRFJBVElPTl0/LmRhdGFbVEVNUExBVEVTXT8uW2luZGV4XSA/PyBudWxsOwogIGlmIChzc3JJZCAhPT0gbnVsbCAmJiB0Tm9kZS50VmlldyAhPT0gbnVsbCkgewogICAgaWYgKHROb2RlLnRWaWV3LnNzcklkID09PSBudWxsKSB7CiAgICAgIHROb2RlLnRWaWV3LnNzcklkID0gc3NySWQ7CiAgICB9IGVsc2UgewogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwodE5vZGUudFZpZXcuc3NySWQsIHNzcklkLCAiVW5leHBlY3RlZCB2YWx1ZSBvZiB0aGUgYHNzcklkYCBmb3IgdGhpcyBUVmlldyIpOwogICAgfQogIH0KICBpZiAoaXNOb2RlQ3JlYXRpb25Nb2RlKSB7CiAgICByZXR1cm4gY3JlYXRlQ29udGFpbmVyQW5jaG9ySW1wbCh0VmlldywgbFZpZXcpOwogIH0KICBjb25zdCBoeWRyYXRpb25JbmZvID0gbFZpZXdbSFlEUkFUSU9OXTsKICBjb25zdCBjdXJyZW50Uk5vZGUgPSBsb2NhdGVOZXh0Uk5vZGUoaHlkcmF0aW9uSW5mbywgdFZpZXcsIGxWaWV3LCB0Tm9kZSk7CiAgbmdEZXZNb2RlICYmIHZhbGlkYXRlTm9kZUV4aXN0cyhjdXJyZW50Uk5vZGUsIGxWaWV3LCB0Tm9kZSk7CiAgc2V0U2VnbWVudEhlYWQoaHlkcmF0aW9uSW5mbywgaW5kZXgsIGN1cnJlbnRSTm9kZSk7CiAgY29uc3Qgdmlld0NvbnRhaW5lclNpemUgPSBjYWxjU2VyaWFsaXplZENvbnRhaW5lclNpemUoaHlkcmF0aW9uSW5mbywgaW5kZXgpOwogIGNvbnN0IGNvbW1lbnQgPSBzaWJsaW5nQWZ0ZXIodmlld0NvbnRhaW5lclNpemUsIGN1cnJlbnRSTm9kZSk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdmFsaWRhdGVNYXRjaGluZ05vZGUoY29tbWVudCwgTm9kZS5DT01NRU5UX05PREUsIG51bGwsIGxWaWV3LCB0Tm9kZSk7CiAgICBtYXJrUk5vZGVBc0NsYWltZWRCeUh5ZHJhdGlvbihjb21tZW50KTsKICB9CiAgcmV0dXJuIGNvbW1lbnQ7Cn0KZnVuY3Rpb24gZW5hYmxlTG9jYXRlT3JDcmVhdGVDb250YWluZXJBbmNob3JJbXBsKCkgewogIF9sb2NhdGVPckNyZWF0ZUNvbnRhaW5lckFuY2hvciA9IGxvY2F0ZU9yQ3JlYXRlQ29udGFpbmVyQW5jaG9ySW1wbDsKfQp2YXIgRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGU7CihmdW5jdGlvbihEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZTIpIHsKICBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZTJbRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUyWyJOT1RfU1RBUlRFRCJdID0gMF0gPSAiTk9UX1NUQVJURUQiOwogIERlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlMltEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZTJbIklOX1BST0dSRVNTIl0gPSAxXSA9ICJJTl9QUk9HUkVTUyI7CiAgRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUyW0RlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlMlsiQ09NUExFVEUiXSA9IDJdID0gIkNPTVBMRVRFIjsKICBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZTJbRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUyWyJGQUlMRUQiXSA9IDNdID0gIkZBSUxFRCI7Cn0pKERlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlIHx8IChEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZSA9IHt9KSk7CnZhciBNSU5JTVVNX1NMT1QgPSAwOwp2YXIgTE9BRElOR19BRlRFUl9TTE9UID0gMTsKdmFyIERlZmVyQmxvY2tTdGF0ZTsKKGZ1bmN0aW9uKERlZmVyQmxvY2tTdGF0ZTIpIHsKICBEZWZlckJsb2NrU3RhdGUyW0RlZmVyQmxvY2tTdGF0ZTJbIlBsYWNlaG9sZGVyIl0gPSAwXSA9ICJQbGFjZWhvbGRlciI7CiAgRGVmZXJCbG9ja1N0YXRlMltEZWZlckJsb2NrU3RhdGUyWyJMb2FkaW5nIl0gPSAxXSA9ICJMb2FkaW5nIjsKICBEZWZlckJsb2NrU3RhdGUyW0RlZmVyQmxvY2tTdGF0ZTJbIkNvbXBsZXRlIl0gPSAyXSA9ICJDb21wbGV0ZSI7CiAgRGVmZXJCbG9ja1N0YXRlMltEZWZlckJsb2NrU3RhdGUyWyJFcnJvciJdID0gM10gPSAiRXJyb3IiOwp9KShEZWZlckJsb2NrU3RhdGUgfHwgKERlZmVyQmxvY2tTdGF0ZSA9IHt9KSk7CnZhciBEZWZlckJsb2NrSW50ZXJuYWxTdGF0ZTsKKGZ1bmN0aW9uKERlZmVyQmxvY2tJbnRlcm5hbFN0YXRlMikgewogIERlZmVyQmxvY2tJbnRlcm5hbFN0YXRlMltEZWZlckJsb2NrSW50ZXJuYWxTdGF0ZTJbIkluaXRpYWwiXSA9IC0xXSA9ICJJbml0aWFsIjsKfSkoRGVmZXJCbG9ja0ludGVybmFsU3RhdGUgfHwgKERlZmVyQmxvY2tJbnRlcm5hbFN0YXRlID0ge30pKTsKdmFyIE5FWFRfREVGRVJfQkxPQ0tfU1RBVEUgPSAwOwp2YXIgREVGRVJfQkxPQ0tfU1RBVEUgPSAxOwp2YXIgU1RBVEVfSVNfRlJPWkVOX1VOVElMID0gMjsKdmFyIExPQURJTkdfQUZURVJfQ0xFQU5VUF9GTiA9IDM7CnZhciBUUklHR0VSX0NMRUFOVVBfRk5TID0gNDsKdmFyIFBSRUZFVENIX1RSSUdHRVJfQ0xFQU5VUF9GTlMgPSA1Owp2YXIgU1NSX1VOSVFVRV9JRCA9IDY7CnZhciBTU1JfQkxPQ0tfU1RBVEUgPSA3Owp2YXIgT05fQ09NUExFVEVfRk5TID0gODsKdmFyIEhZRFJBVEVfVFJJR0dFUl9DTEVBTlVQX0ZOUyA9IDk7CnZhciBEZWZlckJsb2NrQmVoYXZpb3I7CihmdW5jdGlvbihEZWZlckJsb2NrQmVoYXZpb3IyKSB7CiAgRGVmZXJCbG9ja0JlaGF2aW9yMltEZWZlckJsb2NrQmVoYXZpb3IyWyJNYW51YWwiXSA9IDBdID0gIk1hbnVhbCI7CiAgRGVmZXJCbG9ja0JlaGF2aW9yMltEZWZlckJsb2NrQmVoYXZpb3IyWyJQbGF5dGhyb3VnaCJdID0gMV0gPSAiUGxheXRocm91Z2giOwp9KShEZWZlckJsb2NrQmVoYXZpb3IgfHwgKERlZmVyQmxvY2tCZWhhdmlvciA9IHt9KSk7CmZ1bmN0aW9uIHN0b3JlVHJpZ2dlckNsZWFudXBGbih0eXBlLCBsRGV0YWlscywgY2xlYW51cEZuKSB7CiAgY29uc3Qga2V5ID0gZ2V0Q2xlYW51cEZuS2V5QnlUeXBlKHR5cGUpOwogIGlmIChsRGV0YWlsc1trZXldID09PSBudWxsKSB7CiAgICBsRGV0YWlsc1trZXldID0gW107CiAgfQogIGxEZXRhaWxzW2tleV0ucHVzaChjbGVhbnVwRm4pOwp9CmZ1bmN0aW9uIGludm9rZVRyaWdnZXJDbGVhbnVwRm5zKHR5cGUsIGxEZXRhaWxzKSB7CiAgY29uc3Qga2V5ID0gZ2V0Q2xlYW51cEZuS2V5QnlUeXBlKHR5cGUpOwogIGNvbnN0IGNsZWFudXBGbnMgPSBsRGV0YWlsc1trZXldOwogIGlmIChjbGVhbnVwRm5zICE9PSBudWxsKSB7CiAgICBmb3IgKGNvbnN0IGNsZWFudXBGbiBvZiBjbGVhbnVwRm5zKSB7CiAgICAgIGNsZWFudXBGbigpOwogICAgfQogICAgbERldGFpbHNba2V5XSA9IG51bGw7CiAgfQp9CmZ1bmN0aW9uIGludm9rZUFsbFRyaWdnZXJDbGVhbnVwRm5zKGxEZXRhaWxzKSB7CiAgaW52b2tlVHJpZ2dlckNsZWFudXBGbnMoMSwgbERldGFpbHMpOwogIGludm9rZVRyaWdnZXJDbGVhbnVwRm5zKDAsIGxEZXRhaWxzKTsKICBpbnZva2VUcmlnZ2VyQ2xlYW51cEZucygyLCBsRGV0YWlscyk7Cn0KZnVuY3Rpb24gZ2V0Q2xlYW51cEZuS2V5QnlUeXBlKHR5cGUpIHsKICBsZXQga2V5ID0gVFJJR0dFUl9DTEVBTlVQX0ZOUzsKICBpZiAodHlwZSA9PT0gMSkgewogICAga2V5ID0gUFJFRkVUQ0hfVFJJR0dFUl9DTEVBTlVQX0ZOUzsKICB9IGVsc2UgaWYgKHR5cGUgPT09IDIpIHsKICAgIGtleSA9IEhZRFJBVEVfVFJJR0dFUl9DTEVBTlVQX0ZOUzsKICB9CiAgcmV0dXJuIGtleTsKfQpmdW5jdGlvbiBnZXREZWZlckJsb2NrRGF0YUluZGV4KGRlZmVyQmxvY2tJbmRleCkgewogIHJldHVybiBkZWZlckJsb2NrSW5kZXggKyAxOwp9CmZ1bmN0aW9uIGdldExEZWZlckJsb2NrRGV0YWlscyhsVmlldywgdE5vZGUpIHsKICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCBzbG90SW5kZXggPSBnZXREZWZlckJsb2NrRGF0YUluZGV4KHROb2RlLmluZGV4KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJbkRlY2xSYW5nZSh0Vmlldywgc2xvdEluZGV4KTsKICByZXR1cm4gbFZpZXdbc2xvdEluZGV4XTsKfQpmdW5jdGlvbiBzZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIGRlZmVyQmxvY2tJbmRleCwgbERldGFpbHMpIHsKICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCBzbG90SW5kZXggPSBnZXREZWZlckJsb2NrRGF0YUluZGV4KGRlZmVyQmxvY2tJbmRleCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5EZWNsUmFuZ2UodFZpZXcsIHNsb3RJbmRleCk7CiAgbFZpZXdbc2xvdEluZGV4XSA9IGxEZXRhaWxzOwp9CmZ1bmN0aW9uIGdldFREZWZlckJsb2NrRGV0YWlscyh0VmlldywgdE5vZGUpIHsKICBjb25zdCBzbG90SW5kZXggPSBnZXREZWZlckJsb2NrRGF0YUluZGV4KHROb2RlLmluZGV4KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJbkRlY2xSYW5nZSh0Vmlldywgc2xvdEluZGV4KTsKICByZXR1cm4gdFZpZXcuZGF0YVtzbG90SW5kZXhdOwp9CmZ1bmN0aW9uIHNldFREZWZlckJsb2NrRGV0YWlscyh0VmlldywgZGVmZXJCbG9ja0luZGV4LCBkZWZlckJsb2NrQ29uZmlnKSB7CiAgY29uc3Qgc2xvdEluZGV4ID0gZ2V0RGVmZXJCbG9ja0RhdGFJbmRleChkZWZlckJsb2NrSW5kZXgpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluRGVjbFJhbmdlKHRWaWV3LCBzbG90SW5kZXgpOwogIHRWaWV3LmRhdGFbc2xvdEluZGV4XSA9IGRlZmVyQmxvY2tDb25maWc7Cn0KZnVuY3Rpb24gZ2V0VGVtcGxhdGVJbmRleEZvclN0YXRlKG5ld1N0YXRlLCBob3N0TFZpZXcsIHROb2RlKSB7CiAgY29uc3QgdFZpZXcgPSBob3N0TFZpZXdbVFZJRVddOwogIGNvbnN0IHREZXRhaWxzID0gZ2V0VERlZmVyQmxvY2tEZXRhaWxzKHRWaWV3LCB0Tm9kZSk7CiAgc3dpdGNoIChuZXdTdGF0ZSkgewogICAgY2FzZSBEZWZlckJsb2NrU3RhdGUuQ29tcGxldGU6CiAgICAgIHJldHVybiB0RGV0YWlscy5wcmltYXJ5VG1wbEluZGV4OwogICAgY2FzZSBEZWZlckJsb2NrU3RhdGUuTG9hZGluZzoKICAgICAgcmV0dXJuIHREZXRhaWxzLmxvYWRpbmdUbXBsSW5kZXg7CiAgICBjYXNlIERlZmVyQmxvY2tTdGF0ZS5FcnJvcjoKICAgICAgcmV0dXJuIHREZXRhaWxzLmVycm9yVG1wbEluZGV4OwogICAgY2FzZSBEZWZlckJsb2NrU3RhdGUuUGxhY2Vob2xkZXI6CiAgICAgIHJldHVybiB0RGV0YWlscy5wbGFjZWhvbGRlclRtcGxJbmRleDsKICAgIGRlZmF1bHQ6CiAgICAgIG5nRGV2TW9kZSAmJiB0aHJvd0Vycm9yMihgVW5leHBlY3RlZCBkZWZlciBibG9jayBzdGF0ZTogJHtuZXdTdGF0ZX1gKTsKICAgICAgcmV0dXJuIG51bGw7CiAgfQp9CmZ1bmN0aW9uIGdldE1pbmltdW1EdXJhdGlvbkZvclN0YXRlKHREZXRhaWxzLCBjdXJyZW50U3RhdGUpIHsKICBpZiAoY3VycmVudFN0YXRlID09PSBEZWZlckJsb2NrU3RhdGUuUGxhY2Vob2xkZXIpIHsKICAgIHJldHVybiB0RGV0YWlscy5wbGFjZWhvbGRlckJsb2NrQ29uZmlnPy5bTUlOSU1VTV9TTE9UXSA/PyBudWxsOwogIH0gZWxzZSBpZiAoY3VycmVudFN0YXRlID09PSBEZWZlckJsb2NrU3RhdGUuTG9hZGluZykgewogICAgcmV0dXJuIHREZXRhaWxzLmxvYWRpbmdCbG9ja0NvbmZpZz8uW01JTklNVU1fU0xPVF0gPz8gbnVsbDsKICB9CiAgcmV0dXJuIG51bGw7Cn0KZnVuY3Rpb24gZ2V0TG9hZGluZ0Jsb2NrQWZ0ZXIodERldGFpbHMpIHsKICByZXR1cm4gdERldGFpbHMubG9hZGluZ0Jsb2NrQ29uZmlnPy5bTE9BRElOR19BRlRFUl9TTE9UXSA/PyBudWxsOwp9CmZ1bmN0aW9uIGFkZERlcHNUb1JlZ2lzdHJ5KGN1cnJlbnREZXBzLCBuZXdEZXBzKSB7CiAgaWYgKCFjdXJyZW50RGVwcyB8fCBjdXJyZW50RGVwcy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBuZXdEZXBzOwogIH0KICBjb25zdCBjdXJyZW50RGVwU2V0ID0gbmV3IFNldChjdXJyZW50RGVwcyk7CiAgZm9yIChjb25zdCBkZXAgb2YgbmV3RGVwcykgewogICAgY3VycmVudERlcFNldC5hZGQoZGVwKTsKICB9CiAgcmV0dXJuIGN1cnJlbnREZXBzLmxlbmd0aCA9PT0gY3VycmVudERlcFNldC5zaXplID8gY3VycmVudERlcHMgOiBBcnJheS5mcm9tKGN1cnJlbnREZXBTZXQpOwp9CmZ1bmN0aW9uIGdldFByaW1hcnlCbG9ja1ROb2RlKHRWaWV3LCB0RGV0YWlscykgewogIGNvbnN0IGFkanVzdGVkSW5kZXggPSB0RGV0YWlscy5wcmltYXJ5VG1wbEluZGV4ICsgSEVBREVSX09GRlNFVDsKICByZXR1cm4gZ2V0VE5vZGUodFZpZXcsIGFkanVzdGVkSW5kZXgpOwp9CmZ1bmN0aW9uIGFzc2VydERlZmVycmVkRGVwZW5kZW5jaWVzTG9hZGVkKHREZXRhaWxzKSB7CiAgYXNzZXJ0RXF1YWwodERldGFpbHMubG9hZGluZ1N0YXRlLCBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5DT01QTEVURSwgIkV4cGVjdGluZyBhbGwgZGVmZXJyZWQgZGVwZW5kZW5jaWVzIHRvIGJlIGxvYWRlZC4iKTsKfQpmdW5jdGlvbiBpc1REZWZlckJsb2NrRGV0YWlscyh2YWx1ZSkgewogIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICJvYmplY3QiICYmIHR5cGVvZiB2YWx1ZS5wcmltYXJ5VG1wbEluZGV4ID09PSAibnVtYmVyIjsKfQpmdW5jdGlvbiBpc0RlZmVyQmxvY2sodFZpZXcsIHROb2RlKSB7CiAgbGV0IHREZXRhaWxzID0gbnVsbDsKICBjb25zdCBzbG90SW5kZXggPSBnZXREZWZlckJsb2NrRGF0YUluZGV4KHROb2RlLmluZGV4KTsKICBpZiAoSEVBREVSX09GRlNFVCA8IHNsb3RJbmRleCAmJiBzbG90SW5kZXggPCB0Vmlldy5iaW5kaW5nU3RhcnRJbmRleCkgewogICAgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICB9CiAgcmV0dXJuICEhdERldGFpbHMgJiYgaXNURGVmZXJCbG9ja0RldGFpbHModERldGFpbHMpOwp9CmZ1bmN0aW9uIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyh0VmlldywgdE5vZGUsIHRleHRSZXByZXNlbnRhdGlvbikgewogIGNvbnN0IHREZXRhaWxzID0gZ2V0VERlZmVyQmxvY2tEZXRhaWxzKHRWaWV3LCB0Tm9kZSk7CiAgdERldGFpbHMuZGVidWcgPz89IHt9OwogIHREZXRhaWxzLmRlYnVnLnRyaWdnZXJzID8/PSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwogIHREZXRhaWxzLmRlYnVnLnRyaWdnZXJzLmFkZCh0ZXh0UmVwcmVzZW50YXRpb24pOwp9CmZ1bmN0aW9uIG9uVmlld3BvcnRXcmFwcGVyKHRyaWdnZXIsIGNhbGxiYWNrLCBpbmplY3Rvciwgd3JhcHBlck9wdGlvbnMpIHsKICBjb25zdCBuZ1pvbmUgPSBpbmplY3Rvci5nZXQoTmdab25lKTsKICByZXR1cm4gb25WaWV3cG9ydCh0cmlnZ2VyLCAoKSA9PiBuZ1pvbmUucnVuKGNhbGxiYWNrKSwgKG9wdGlvbnMpID0+IG5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiBjcmVhdGVJbnRlcnNlY3Rpb25PYnNlcnZlcihvcHRpb25zKSksIHdyYXBwZXJPcHRpb25zKTsKfQpmdW5jdGlvbiBnZXRUcmlnZ2VyTFZpZXcoZGVmZXJyZWRIb3N0TFZpZXcsIGRlZmVycmVkVE5vZGUsIHdhbGtVcFRpbWVzKSB7CiAgaWYgKHdhbGtVcFRpbWVzID09IG51bGwpIHsKICAgIHJldHVybiBkZWZlcnJlZEhvc3RMVmlldzsKICB9CiAgaWYgKHdhbGtVcFRpbWVzID49IDApIHsKICAgIHJldHVybiB3YWxrVXBWaWV3cyh3YWxrVXBUaW1lcywgZGVmZXJyZWRIb3N0TFZpZXcpOwogIH0KICBjb25zdCBkZWZlcnJlZENvbnRhaW5lciA9IGRlZmVycmVkSG9zdExWaWV3W2RlZmVycmVkVE5vZGUuaW5kZXhdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRMQ29udGFpbmVyKGRlZmVycmVkQ29udGFpbmVyKTsKICBjb25zdCB0cmlnZ2VyTFZpZXcgPSBkZWZlcnJlZENvbnRhaW5lcltDT05UQUlORVJfSEVBREVSX09GRlNFVF0gPz8gbnVsbDsKICBpZiAobmdEZXZNb2RlICYmIHRyaWdnZXJMVmlldyAhPT0gbnVsbCkgewogICAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMoZGVmZXJyZWRIb3N0TFZpZXcsIGRlZmVycmVkVE5vZGUpOwogICAgY29uc3QgcmVuZGVyZWRTdGF0ZSA9IGxEZXRhaWxzW0RFRkVSX0JMT0NLX1NUQVRFXTsKICAgIGFzc2VydEVxdWFsKHJlbmRlcmVkU3RhdGUsIERlZmVyQmxvY2tTdGF0ZS5QbGFjZWhvbGRlciwgIkV4cGVjdGVkIGEgcGxhY2Vob2xkZXIgdG8gYmUgcmVuZGVyZWQgaW4gdGhpcyBkZWZlciBibG9jay4iKTsKICAgIGFzc2VydExWaWV3KHRyaWdnZXJMVmlldyk7CiAgfQogIHJldHVybiB0cmlnZ2VyTFZpZXc7Cn0KZnVuY3Rpb24gZ2V0VHJpZ2dlckVsZW1lbnQodHJpZ2dlckxWaWV3LCB0cmlnZ2VySW5kZXgpIHsKICBjb25zdCBlbGVtZW50ID0gZ2V0TmF0aXZlQnlJbmRleChIRUFERVJfT0ZGU0VUICsgdHJpZ2dlckluZGV4LCB0cmlnZ2VyTFZpZXcpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRFbGVtZW50KGVsZW1lbnQpOwogIHJldHVybiBlbGVtZW50Owp9CmZ1bmN0aW9uIHJlZ2lzdGVyRG9tVHJpZ2dlcihpbml0aWFsTFZpZXcsIHROb2RlLCB0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzLCByZWdpc3RlckZuLCBjYWxsYmFjaywgdHlwZSwgb3B0aW9ucykgewogIGNvbnN0IGluamVjdG9yID0gaW5pdGlhbExWaWV3W0lOSkVDVE9SXTsKICBjb25zdCB6b25lID0gaW5qZWN0b3IuZ2V0KE5nWm9uZSk7CiAgbGV0IHBvbGw7CiAgZnVuY3Rpb24gcG9sbERvbVRyaWdnZXIoKSB7CiAgICBpZiAoaXNEZXN0cm95ZWQoaW5pdGlhbExWaWV3KSkgewogICAgICBwb2xsLmRlc3Ryb3koKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMoaW5pdGlhbExWaWV3LCB0Tm9kZSk7CiAgICBjb25zdCByZW5kZXJlZFN0YXRlID0gbERldGFpbHNbREVGRVJfQkxPQ0tfU1RBVEVdOwogICAgaWYgKHJlbmRlcmVkU3RhdGUgIT09IERlZmVyQmxvY2tJbnRlcm5hbFN0YXRlLkluaXRpYWwgJiYgcmVuZGVyZWRTdGF0ZSAhPT0gRGVmZXJCbG9ja1N0YXRlLlBsYWNlaG9sZGVyKSB7CiAgICAgIHBvbGwuZGVzdHJveSgpOwogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCB0cmlnZ2VyTFZpZXcgPSBnZXRUcmlnZ2VyTFZpZXcoaW5pdGlhbExWaWV3LCB0Tm9kZSwgd2Fsa1VwVGltZXMpOwogICAgaWYgKCF0cmlnZ2VyTFZpZXcpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgcG9sbC5kZXN0cm95KCk7CiAgICBpZiAoaXNEZXN0cm95ZWQodHJpZ2dlckxWaWV3KSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCBlbGVtZW50ID0gZ2V0VHJpZ2dlckVsZW1lbnQodHJpZ2dlckxWaWV3LCB0cmlnZ2VySW5kZXgpOwogICAgY29uc3QgY2xlYW51cCA9IHJlZ2lzdGVyRm4oZWxlbWVudCwgKCkgPT4gewogICAgICB6b25lLnJ1bigoKSA9PiB7CiAgICAgICAgaWYgKGluaXRpYWxMVmlldyAhPT0gdHJpZ2dlckxWaWV3KSB7CiAgICAgICAgICByZW1vdmVMVmlld09uRGVzdHJveSh0cmlnZ2VyTFZpZXcsIGNsZWFudXApOwogICAgICAgIH0KICAgICAgICBjYWxsYmFjaygpOwogICAgICB9KTsKICAgIH0sIGluamVjdG9yLCBvcHRpb25zKTsKICAgIGlmIChpbml0aWFsTFZpZXcgIT09IHRyaWdnZXJMVmlldykgewogICAgICBzdG9yZUxWaWV3T25EZXN0cm95KHRyaWdnZXJMVmlldywgY2xlYW51cCk7CiAgICB9CiAgICBzdG9yZVRyaWdnZXJDbGVhbnVwRm4odHlwZSwgbERldGFpbHMsIGNsZWFudXApOwogIH0KICBwb2xsID0gYWZ0ZXJFdmVyeVJlbmRlcih7CiAgICByZWFkOiBwb2xsRG9tVHJpZ2dlcgogIH0sIHsKICAgIGluamVjdG9yCiAgfSk7Cn0KZnVuY3Rpb24gb25JZGxlKGNhbGxiYWNrLCBpbmplY3RvcikgewogIGNvbnN0IHNjaGVkdWxlciA9IGluamVjdG9yLmdldChJZGxlU2NoZWR1bGVyKTsKICBjb25zdCBjbGVhbnVwRm4gPSAoKSA9PiBzY2hlZHVsZXIucmVtb3ZlKGNhbGxiYWNrKTsKICBzY2hlZHVsZXIuYWRkKGNhbGxiYWNrKTsKICByZXR1cm4gY2xlYW51cEZuOwp9CnZhciBfcmVxdWVzdElkbGVDYWxsYmFjayA9ICgpID0+IHR5cGVvZiByZXF1ZXN0SWRsZUNhbGxiYWNrICE9PSAidW5kZWZpbmVkIiA/IHJlcXVlc3RJZGxlQ2FsbGJhY2sgOiBzZXRUaW1lb3V0Owp2YXIgX2NhbmNlbElkbGVDYWxsYmFjayA9ICgpID0+IHR5cGVvZiByZXF1ZXN0SWRsZUNhbGxiYWNrICE9PSAidW5kZWZpbmVkIiA/IGNhbmNlbElkbGVDYWxsYmFjayA6IGNsZWFyVGltZW91dDsKdmFyIElkbGVTY2hlZHVsZXIgPSBjbGFzcyBfSWRsZVNjaGVkdWxlciB7CiAgZXhlY3V0aW5nQ2FsbGJhY2tzID0gZmFsc2U7CiAgaWRsZUlkID0gbnVsbDsKICBjdXJyZW50ID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICBkZWZlcnJlZCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgbmdab25lID0gaW5qZWN0MihOZ1pvbmUpOwogIHJlcXVlc3RJZGxlQ2FsbGJhY2tGbiA9IF9yZXF1ZXN0SWRsZUNhbGxiYWNrKCkuYmluZChnbG9iYWxUaGlzKTsKICBjYW5jZWxJZGxlQ2FsbGJhY2tGbiA9IF9jYW5jZWxJZGxlQ2FsbGJhY2soKS5iaW5kKGdsb2JhbFRoaXMpOwogIGFkZChjYWxsYmFjaykgewogICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5leGVjdXRpbmdDYWxsYmFja3MgPyB0aGlzLmRlZmVycmVkIDogdGhpcy5jdXJyZW50OwogICAgdGFyZ2V0LmFkZChjYWxsYmFjayk7CiAgICBpZiAodGhpcy5pZGxlSWQgPT09IG51bGwpIHsKICAgICAgdGhpcy5zY2hlZHVsZUlkbGVDYWxsYmFjaygpOwogICAgfQogIH0KICByZW1vdmUoY2FsbGJhY2spIHsKICAgIGNvbnN0IHsKICAgICAgY3VycmVudCwKICAgICAgZGVmZXJyZWQKICAgIH0gPSB0aGlzOwogICAgY3VycmVudC5kZWxldGUoY2FsbGJhY2spOwogICAgZGVmZXJyZWQuZGVsZXRlKGNhbGxiYWNrKTsKICAgIGlmIChjdXJyZW50LnNpemUgPT09IDAgJiYgZGVmZXJyZWQuc2l6ZSA9PT0gMCkgewogICAgICB0aGlzLmNhbmNlbElkbGVDYWxsYmFjaygpOwogICAgfQogIH0KICBzY2hlZHVsZUlkbGVDYWxsYmFjaygpIHsKICAgIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4gewogICAgICB0aGlzLmNhbmNlbElkbGVDYWxsYmFjaygpOwogICAgICB0aGlzLmV4ZWN1dGluZ0NhbGxiYWNrcyA9IHRydWU7CiAgICAgIGZvciAoY29uc3QgY2FsbGJhY2syIG9mIHRoaXMuY3VycmVudCkgewogICAgICAgIGNhbGxiYWNrMigpOwogICAgICB9CiAgICAgIHRoaXMuY3VycmVudC5jbGVhcigpOwogICAgICB0aGlzLmV4ZWN1dGluZ0NhbGxiYWNrcyA9IGZhbHNlOwogICAgICBpZiAodGhpcy5kZWZlcnJlZC5zaXplID4gMCkgewogICAgICAgIGZvciAoY29uc3QgY2FsbGJhY2syIG9mIHRoaXMuZGVmZXJyZWQpIHsKICAgICAgICAgIHRoaXMuY3VycmVudC5hZGQoY2FsbGJhY2syKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5kZWZlcnJlZC5jbGVhcigpOwogICAgICAgIHRoaXMuc2NoZWR1bGVJZGxlQ2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICAgIHRoaXMuaWRsZUlkID0gdGhpcy5yZXF1ZXN0SWRsZUNhbGxiYWNrRm4oKCkgPT4gdGhpcy5uZ1pvbmUucnVuKGNhbGxiYWNrKSk7CiAgfQogIGNhbmNlbElkbGVDYWxsYmFjaygpIHsKICAgIGlmICh0aGlzLmlkbGVJZCAhPT0gbnVsbCkgewogICAgICB0aGlzLmNhbmNlbElkbGVDYWxsYmFja0ZuKHRoaXMuaWRsZUlkKTsKICAgICAgdGhpcy5pZGxlSWQgPSBudWxsOwogICAgfQogIH0KICBuZ09uRGVzdHJveSgpIHsKICAgIHRoaXMuY2FuY2VsSWRsZUNhbGxiYWNrKCk7CiAgICB0aGlzLmN1cnJlbnQuY2xlYXIoKTsKICAgIHRoaXMuZGVmZXJyZWQuY2xlYXIoKTsKICB9CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfSWRsZVNjaGVkdWxlciwKICAgIHByb3ZpZGVkSW46ICJyb290IiwKICAgIGZhY3Rvcnk6ICgpID0+IG5ldyBfSWRsZVNjaGVkdWxlcigpCiAgfSk7Cn07CmZ1bmN0aW9uIG9uVGltZXIoZGVsYXkyKSB7CiAgcmV0dXJuIChjYWxsYmFjaywgaW5qZWN0b3IpID0+IHNjaGVkdWxlVGltZXJUcmlnZ2VyKGRlbGF5MiwgY2FsbGJhY2ssIGluamVjdG9yKTsKfQpmdW5jdGlvbiBzY2hlZHVsZVRpbWVyVHJpZ2dlcihkZWxheTIsIGNhbGxiYWNrLCBpbmplY3RvcikgewogIGNvbnN0IHNjaGVkdWxlciA9IGluamVjdG9yLmdldChUaW1lclNjaGVkdWxlcik7CiAgY29uc3Qgbmdab25lID0gaW5qZWN0b3IuZ2V0KE5nWm9uZSk7CiAgY29uc3QgY2xlYW51cEZuID0gKCkgPT4gc2NoZWR1bGVyLnJlbW92ZShjYWxsYmFjayk7CiAgc2NoZWR1bGVyLmFkZChkZWxheTIsIGNhbGxiYWNrLCBuZ1pvbmUpOwogIHJldHVybiBjbGVhbnVwRm47Cn0KdmFyIFRpbWVyU2NoZWR1bGVyID0gY2xhc3MgX1RpbWVyU2NoZWR1bGVyIHsKICBleGVjdXRpbmdDYWxsYmFja3MgPSBmYWxzZTsKICB0aW1lb3V0SWQgPSBudWxsOwogIGludm9rZVRpbWVyQXQgPSBudWxsOwogIGN1cnJlbnQgPSBbXTsKICBkZWZlcnJlZCA9IFtdOwogIGFkZChkZWxheTIsIGNhbGxiYWNrLCBuZ1pvbmUpIHsKICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZXhlY3V0aW5nQ2FsbGJhY2tzID8gdGhpcy5kZWZlcnJlZCA6IHRoaXMuY3VycmVudDsKICAgIHRoaXMuYWRkVG9RdWV1ZSh0YXJnZXQsIERhdGUubm93KCkgKyBkZWxheTIsIGNhbGxiYWNrKTsKICAgIHRoaXMuc2NoZWR1bGVUaW1lcihuZ1pvbmUpOwogIH0KICByZW1vdmUoY2FsbGJhY2spIHsKICAgIGNvbnN0IHsKICAgICAgY3VycmVudCwKICAgICAgZGVmZXJyZWQKICAgIH0gPSB0aGlzOwogICAgY29uc3QgY2FsbGJhY2tJbmRleCA9IHRoaXMucmVtb3ZlRnJvbVF1ZXVlKGN1cnJlbnQsIGNhbGxiYWNrKTsKICAgIGlmIChjYWxsYmFja0luZGV4ID09PSAtMSkgewogICAgICB0aGlzLnJlbW92ZUZyb21RdWV1ZShkZWZlcnJlZCwgY2FsbGJhY2spOwogICAgfQogICAgaWYgKGN1cnJlbnQubGVuZ3RoID09PSAwICYmIGRlZmVycmVkLmxlbmd0aCA9PT0gMCkgewogICAgICB0aGlzLmNsZWFyVGltZW91dCgpOwogICAgfQogIH0KICBhZGRUb1F1ZXVlKHRhcmdldCwgaW52b2tlQXQsIGNhbGxiYWNrKSB7CiAgICBsZXQgaW5zZXJ0QXRJbmRleCA9IHRhcmdldC5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldC5sZW5ndGg7IGkgKz0gMikgewogICAgICBjb25zdCBpbnZva2VRdWV1ZWRDYWxsYmFja0F0ID0gdGFyZ2V0W2ldOwogICAgICBpZiAoaW52b2tlUXVldWVkQ2FsbGJhY2tBdCA+IGludm9rZUF0KSB7CiAgICAgICAgaW5zZXJ0QXRJbmRleCA9IGk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGFycmF5SW5zZXJ0Mih0YXJnZXQsIGluc2VydEF0SW5kZXgsIGludm9rZUF0LCBjYWxsYmFjayk7CiAgfQogIHJlbW92ZUZyb21RdWV1ZSh0YXJnZXQsIGNhbGxiYWNrKSB7CiAgICBsZXQgaW5kZXggPSAtMTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0Lmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIGNvbnN0IHF1ZXVlZENhbGxiYWNrID0gdGFyZ2V0W2kgKyAxXTsKICAgICAgaWYgKHF1ZXVlZENhbGxiYWNrID09PSBjYWxsYmFjaykgewogICAgICAgIGluZGV4ID0gaTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgYXJyYXlTcGxpY2UodGFyZ2V0LCBpbmRleCwgMik7CiAgICB9CiAgICByZXR1cm4gaW5kZXg7CiAgfQogIHNjaGVkdWxlVGltZXIobmdab25lKSB7CiAgICBjb25zdCBjYWxsYmFjayA9ICgpID0+IHsKICAgICAgdGhpcy5jbGVhclRpbWVvdXQoKTsKICAgICAgdGhpcy5leGVjdXRpbmdDYWxsYmFja3MgPSB0cnVlOwogICAgICBjb25zdCBjdXJyZW50ID0gWy4uLnRoaXMuY3VycmVudF07CiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudC5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGludm9rZUF0ID0gY3VycmVudFtpXTsKICAgICAgICBjb25zdCBjYWxsYmFjazIgPSBjdXJyZW50W2kgKyAxXTsKICAgICAgICBpZiAoaW52b2tlQXQgPD0gbm93KSB7CiAgICAgICAgICBjYWxsYmFjazIoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIGxldCBsYXN0Q2FsbGJhY2tJbmRleCA9IC0xOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY3VycmVudC5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGludm9rZUF0ID0gdGhpcy5jdXJyZW50W2ldOwogICAgICAgIGlmIChpbnZva2VBdCA8PSBub3cpIHsKICAgICAgICAgIGxhc3RDYWxsYmFja0luZGV4ID0gaSArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAobGFzdENhbGxiYWNrSW5kZXggPj0gMCkgewogICAgICAgIGFycmF5U3BsaWNlKHRoaXMuY3VycmVudCwgMCwgbGFzdENhbGxiYWNrSW5kZXggKyAxKTsKICAgICAgfQogICAgICB0aGlzLmV4ZWN1dGluZ0NhbGxiYWNrcyA9IGZhbHNlOwogICAgICBpZiAodGhpcy5kZWZlcnJlZC5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRlZmVycmVkLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgICBjb25zdCBpbnZva2VBdCA9IHRoaXMuZGVmZXJyZWRbaV07CiAgICAgICAgICBjb25zdCBjYWxsYmFjazIgPSB0aGlzLmRlZmVycmVkW2kgKyAxXTsKICAgICAgICAgIHRoaXMuYWRkVG9RdWV1ZSh0aGlzLmN1cnJlbnQsIGludm9rZUF0LCBjYWxsYmFjazIpOwogICAgICAgIH0KICAgICAgICB0aGlzLmRlZmVycmVkLmxlbmd0aCA9IDA7CiAgICAgIH0KICAgICAgdGhpcy5zY2hlZHVsZVRpbWVyKG5nWm9uZSk7CiAgICB9OwogICAgY29uc3QgRlJBTUVfRFVSQVRJT05fTVMgPSAxNjsKICAgIGlmICh0aGlzLmN1cnJlbnQubGVuZ3RoID4gMCkgewogICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpOwogICAgICBjb25zdCBpbnZva2VBdCA9IHRoaXMuY3VycmVudFswXTsKICAgICAgaWYgKHRoaXMudGltZW91dElkID09PSBudWxsIHx8IHRoaXMuaW52b2tlVGltZXJBdCAmJiB0aGlzLmludm9rZVRpbWVyQXQgLSBpbnZva2VBdCA+IEZSQU1FX0RVUkFUSU9OX01TKSB7CiAgICAgICAgdGhpcy5jbGVhclRpbWVvdXQoKTsKICAgICAgICBjb25zdCB0aW1lb3V0MiA9IE1hdGgubWF4KGludm9rZUF0IC0gbm93LCBGUkFNRV9EVVJBVElPTl9NUyk7CiAgICAgICAgdGhpcy5pbnZva2VUaW1lckF0ID0gaW52b2tlQXQ7CiAgICAgICAgdGhpcy50aW1lb3V0SWQgPSBuZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gewogICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoKCkgPT4gbmdab25lLnJ1bihjYWxsYmFjayksIHRpbWVvdXQyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KICBjbGVhclRpbWVvdXQoKSB7CiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElkKTsKICAgICAgdGhpcy50aW1lb3V0SWQgPSBudWxsOwogICAgfQogIH0KICBuZ09uRGVzdHJveSgpIHsKICAgIHRoaXMuY2xlYXJUaW1lb3V0KCk7CiAgICB0aGlzLmN1cnJlbnQubGVuZ3RoID0gMDsKICAgIHRoaXMuZGVmZXJyZWQubGVuZ3RoID0gMDsKICB9CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfVGltZXJTY2hlZHVsZXIsCiAgICBwcm92aWRlZEluOiAicm9vdCIsCiAgICBmYWN0b3J5OiAoKSA9PiBuZXcgX1RpbWVyU2NoZWR1bGVyKCkKICB9KTsKfTsKdmFyIENhY2hlZEluamVjdG9yU2VydmljZSA9IGNsYXNzIF9DYWNoZWRJbmplY3RvclNlcnZpY2UgewogIGNhY2hlZEluamVjdG9ycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgZ2V0T3JDcmVhdGVJbmplY3RvcihrZXksIHBhcmVudEluamVjdG9yLCBwcm92aWRlcnMsIGRlYnVnTmFtZSkgewogICAgaWYgKCF0aGlzLmNhY2hlZEluamVjdG9ycy5oYXMoa2V5KSkgewogICAgICBjb25zdCBpbmplY3RvciA9IHByb3ZpZGVycy5sZW5ndGggPiAwID8gY3JlYXRlRW52aXJvbm1lbnRJbmplY3Rvcihwcm92aWRlcnMsIHBhcmVudEluamVjdG9yLCBkZWJ1Z05hbWUpIDogbnVsbDsKICAgICAgdGhpcy5jYWNoZWRJbmplY3RvcnMuc2V0KGtleSwgaW5qZWN0b3IpOwogICAgfQogICAgcmV0dXJuIHRoaXMuY2FjaGVkSW5qZWN0b3JzLmdldChrZXkpOwogIH0KICBuZ09uRGVzdHJveSgpIHsKICAgIHRyeSB7CiAgICAgIGZvciAoY29uc3QgaW5qZWN0b3Igb2YgdGhpcy5jYWNoZWRJbmplY3RvcnMudmFsdWVzKCkpIHsKICAgICAgICBpZiAoaW5qZWN0b3IgIT09IG51bGwpIHsKICAgICAgICAgIGluamVjdG9yLmRlc3Ryb3koKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHRoaXMuY2FjaGVkSW5qZWN0b3JzLmNsZWFyKCk7CiAgICB9CiAgfQogIHN0YXRpYyDJtXByb3YgPSDJtcm1ZGVmaW5lSW5qZWN0YWJsZSh7CiAgICB0b2tlbjogX0NhY2hlZEluamVjdG9yU2VydmljZSwKICAgIHByb3ZpZGVkSW46ICJlbnZpcm9ubWVudCIsCiAgICBmYWN0b3J5OiAoKSA9PiBuZXcgX0NhY2hlZEluamVjdG9yU2VydmljZSgpCiAgfSk7Cn07CnZhciBERUZFUl9CTE9DS19ERVBFTkRFTkNZX0lOVEVSQ0VQVE9SID0gbmV3IEluamVjdGlvblRva2VuKCJERUZFUl9CTE9DS19ERVBFTkRFTkNZX0lOVEVSQ0VQVE9SIik7CnZhciBERUZFUl9CTE9DS19DT05GSUcgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkRFRkVSX0JMT0NLX0NPTkZJRyIgOiAiIik7CmZ1bmN0aW9uIGdldE9yQ3JlYXRlRW52aXJvbm1lbnRJbmplY3RvcihwYXJlbnRJbmplY3RvciwgdERldGFpbHMsIHByb3ZpZGVycykgewogIHJldHVybiBwYXJlbnRJbmplY3Rvci5nZXQoQ2FjaGVkSW5qZWN0b3JTZXJ2aWNlKS5nZXRPckNyZWF0ZUluamVjdG9yKHREZXRhaWxzLCBwYXJlbnRJbmplY3RvciwgcHJvdmlkZXJzLCBuZ0Rldk1vZGUgPyAiRGVmZXJCbG9jayBJbmplY3RvciIgOiAiIik7Cn0KZnVuY3Rpb24gY3JlYXRlRGVmZXJCbG9ja0luamVjdG9yKHBhcmVudEluamVjdG9yLCB0RGV0YWlscywgcHJvdmlkZXJzKSB7CiAgaWYgKHBhcmVudEluamVjdG9yIGluc3RhbmNlb2YgQ2hhaW5lZEluamVjdG9yKSB7CiAgICBjb25zdCBvcmlnSW5qZWN0b3IgPSBwYXJlbnRJbmplY3Rvci5pbmplY3RvcjsKICAgIGNvbnN0IHBhcmVudEVudkluamVjdG9yMiA9IHBhcmVudEluamVjdG9yLnBhcmVudEluamVjdG9yOwogICAgY29uc3QgZW52SW5qZWN0b3IgPSBnZXRPckNyZWF0ZUVudmlyb25tZW50SW5qZWN0b3IocGFyZW50RW52SW5qZWN0b3IyLCB0RGV0YWlscywgcHJvdmlkZXJzKTsKICAgIHJldHVybiBuZXcgQ2hhaW5lZEluamVjdG9yKG9yaWdJbmplY3RvciwgZW52SW5qZWN0b3IpOwogIH0KICBjb25zdCBwYXJlbnRFbnZJbmplY3RvciA9IHBhcmVudEluamVjdG9yLmdldChFbnZpcm9ubWVudEluamVjdG9yKTsKICBpZiAocGFyZW50RW52SW5qZWN0b3IgIT09IHBhcmVudEluamVjdG9yKSB7CiAgICBjb25zdCBlbnZJbmplY3RvciA9IGdldE9yQ3JlYXRlRW52aXJvbm1lbnRJbmplY3RvcihwYXJlbnRFbnZJbmplY3RvciwgdERldGFpbHMsIHByb3ZpZGVycyk7CiAgICByZXR1cm4gbmV3IENoYWluZWRJbmplY3RvcihwYXJlbnRJbmplY3RvciwgZW52SW5qZWN0b3IpOwogIH0KICByZXR1cm4gZ2V0T3JDcmVhdGVFbnZpcm9ubWVudEluamVjdG9yKHBhcmVudEluamVjdG9yLCB0RGV0YWlscywgcHJvdmlkZXJzKTsKfQpmdW5jdGlvbiByZW5kZXJEZWZlckJsb2NrU3RhdGUobmV3U3RhdGUsIHROb2RlLCBsQ29udGFpbmVyLCBza2lwVGltZXJTY2hlZHVsaW5nID0gZmFsc2UpIHsKICBjb25zdCBob3N0TFZpZXcgPSBsQ29udGFpbmVyW1BBUkVOVF07CiAgY29uc3QgaG9zdFRWaWV3ID0gaG9zdExWaWV3W1RWSUVXXTsKICBpZiAoaXNEZXN0cm95ZWQoaG9zdExWaWV3KSkgcmV0dXJuOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZUZvckxWaWV3KHROb2RlLCBob3N0TFZpZXcpOwogIGNvbnN0IGxEZXRhaWxzID0gZ2V0TERlZmVyQmxvY2tEZXRhaWxzKGhvc3RMVmlldywgdE5vZGUpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGxEZXRhaWxzLCAiRXhwZWN0ZWQgYSBkZWZlciBibG9jayBzdGF0ZSBkZWZpbmVkIik7CiAgY29uc3QgY3VycmVudFN0YXRlID0gbERldGFpbHNbREVGRVJfQkxPQ0tfU1RBVEVdOwogIGNvbnN0IHNzclN0YXRlID0gbERldGFpbHNbU1NSX0JMT0NLX1NUQVRFXTsKICBpZiAoc3NyU3RhdGUgIT09IG51bGwgJiYgbmV3U3RhdGUgPCBzc3JTdGF0ZSkgewogICAgcmV0dXJuOwogIH0KICBpZiAoaXNWYWxpZFN0YXRlQ2hhbmdlKGN1cnJlbnRTdGF0ZSwgbmV3U3RhdGUpICYmIGlzVmFsaWRTdGF0ZUNoYW5nZShsRGV0YWlsc1tORVhUX0RFRkVSX0JMT0NLX1NUQVRFXSA/PyAtMSwgbmV3U3RhdGUpKSB7CiAgICBjb25zdCB0RGV0YWlscyA9IGdldFREZWZlckJsb2NrRGV0YWlscyhob3N0VFZpZXcsIHROb2RlKTsKICAgIGNvbnN0IG5lZWRzU2NoZWR1bGluZyA9ICFza2lwVGltZXJTY2hlZHVsaW5nICYmIHRydWUgJiYgKGdldExvYWRpbmdCbG9ja0FmdGVyKHREZXRhaWxzKSAhPT0gbnVsbCB8fCBnZXRNaW5pbXVtRHVyYXRpb25Gb3JTdGF0ZSh0RGV0YWlscywgRGVmZXJCbG9ja1N0YXRlLkxvYWRpbmcpICE9PSBudWxsIHx8IGdldE1pbmltdW1EdXJhdGlvbkZvclN0YXRlKHREZXRhaWxzLCBEZWZlckJsb2NrU3RhdGUuUGxhY2Vob2xkZXIpKTsKICAgIGlmIChuZ0Rldk1vZGUgJiYgbmVlZHNTY2hlZHVsaW5nKSB7CiAgICAgIGFzc2VydERlZmluZWQoYXBwbHlEZWZlckJsb2NrU3RhdGVXaXRoU2NoZWR1bGluZ0ltcGwsICJFeHBlY3RlZCBzY2hlZHVsaW5nIGZ1bmN0aW9uIHRvIGJlIGRlZmluZWQiKTsKICAgIH0KICAgIGNvbnN0IGFwcGx5U3RhdGVGbiA9IG5lZWRzU2NoZWR1bGluZyA/IGFwcGx5RGVmZXJCbG9ja1N0YXRlV2l0aFNjaGVkdWxpbmdJbXBsIDogYXBwbHlEZWZlckJsb2NrU3RhdGU7CiAgICB0cnkgewogICAgICBhcHBseVN0YXRlRm4obmV3U3RhdGUsIGxEZXRhaWxzLCBsQ29udGFpbmVyLCB0Tm9kZSwgaG9zdExWaWV3KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGhhbmRsZVVuY2F1Z2h0RXJyb3IoaG9zdExWaWV3LCBlcnJvcik7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGZpbmRNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3Rm9yRGVmZXJCbG9jayhsQ29udGFpbmVyLCBsRGV0YWlscykgewogIGNvbnN0IGRlaHlkcmF0ZWRWaWV3SXggPSBsQ29udGFpbmVyW0RFSFlEUkFURURfVklFV1NdPy5maW5kSW5kZXgoKHZpZXcpID0+IHZpZXcuZGF0YVtERUZFUl9CTE9DS19TVEFURSQxXSA9PT0gbERldGFpbHNbREVGRVJfQkxPQ0tfU1RBVEVdKSA/PyAtMTsKICBjb25zdCBkZWh5ZHJhdGVkVmlldyA9IGRlaHlkcmF0ZWRWaWV3SXggPiAtMSA/IGxDb250YWluZXJbREVIWURSQVRFRF9WSUVXU11bZGVoeWRyYXRlZFZpZXdJeF0gOiBudWxsOwogIHJldHVybiB7CiAgICBkZWh5ZHJhdGVkVmlldywKICAgIGRlaHlkcmF0ZWRWaWV3SXgKICB9Owp9CmZ1bmN0aW9uIGFwcGx5RGVmZXJCbG9ja1N0YXRlKG5ld1N0YXRlLCBsRGV0YWlscywgbENvbnRhaW5lciwgdE5vZGUsIGhvc3RMVmlldykgewogIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuRGVmZXJCbG9ja1N0YXRlU3RhcnQpOwogIGNvbnN0IHN0YXRlVG1wbEluZGV4ID0gZ2V0VGVtcGxhdGVJbmRleEZvclN0YXRlKG5ld1N0YXRlLCBob3N0TFZpZXcsIHROb2RlKTsKICBpZiAoc3RhdGVUbXBsSW5kZXggIT09IG51bGwpIHsKICAgIGxEZXRhaWxzW0RFRkVSX0JMT0NLX1NUQVRFXSA9IG5ld1N0YXRlOwogICAgY29uc3QgaG9zdFRWaWV3ID0gaG9zdExWaWV3W1RWSUVXXTsKICAgIGNvbnN0IGFkanVzdGVkSW5kZXggPSBzdGF0ZVRtcGxJbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgICBjb25zdCBhY3RpdmVCbG9ja1ROb2RlID0gZ2V0VE5vZGUoaG9zdFRWaWV3LCBhZGp1c3RlZEluZGV4KTsKICAgIGNvbnN0IHZpZXdJbmRleCA9IDA7CiAgICByZW1vdmVMVmlld0Zyb21MQ29udGFpbmVyKGxDb250YWluZXIsIHZpZXdJbmRleCk7CiAgICBsZXQgaW5qZWN0b3I7CiAgICBpZiAobmV3U3RhdGUgPT09IERlZmVyQmxvY2tTdGF0ZS5Db21wbGV0ZSkgewogICAgICBjb25zdCB0RGV0YWlscyA9IGdldFREZWZlckJsb2NrRGV0YWlscyhob3N0VFZpZXcsIHROb2RlKTsKICAgICAgY29uc3QgcHJvdmlkZXJzID0gdERldGFpbHMucHJvdmlkZXJzOwogICAgICBpZiAocHJvdmlkZXJzICYmIHByb3ZpZGVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgaW5qZWN0b3IgPSBjcmVhdGVEZWZlckJsb2NrSW5qZWN0b3IoaG9zdExWaWV3W0lOSkVDVE9SXSwgdERldGFpbHMsIHByb3ZpZGVycyk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IHsKICAgICAgZGVoeWRyYXRlZFZpZXcsCiAgICAgIGRlaHlkcmF0ZWRWaWV3SXgKICAgIH0gPSBmaW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld0ZvckRlZmVyQmxvY2sobENvbnRhaW5lciwgbERldGFpbHMpOwogICAgY29uc3QgZW1iZWRkZWRMVmlldyA9IGNyZWF0ZUFuZFJlbmRlckVtYmVkZGVkTFZpZXcoaG9zdExWaWV3LCBhY3RpdmVCbG9ja1ROb2RlLCBudWxsLCB7CiAgICAgIGluamVjdG9yLAogICAgICBkZWh5ZHJhdGVkVmlldwogICAgfSk7CiAgICBhZGRMVmlld1RvTENvbnRhaW5lcihsQ29udGFpbmVyLCBlbWJlZGRlZExWaWV3LCB2aWV3SW5kZXgsIHNob3VsZEFkZFZpZXdUb0RvbShhY3RpdmVCbG9ja1ROb2RlLCBkZWh5ZHJhdGVkVmlldykpOwogICAgbWFya1ZpZXdEaXJ0eShlbWJlZGRlZExWaWV3LCAyKTsKICAgIGlmIChkZWh5ZHJhdGVkVmlld0l4ID4gLTEpIHsKICAgICAgbENvbnRhaW5lcltERUhZRFJBVEVEX1ZJRVdTXT8uc3BsaWNlKGRlaHlkcmF0ZWRWaWV3SXgsIDEpOwogICAgfQogICAgaWYgKChuZXdTdGF0ZSA9PT0gRGVmZXJCbG9ja1N0YXRlLkNvbXBsZXRlIHx8IG5ld1N0YXRlID09PSBEZWZlckJsb2NrU3RhdGUuRXJyb3IpICYmIEFycmF5LmlzQXJyYXkobERldGFpbHNbT05fQ09NUExFVEVfRk5TXSkpIHsKICAgICAgZm9yIChjb25zdCBjYWxsYmFjayBvZiBsRGV0YWlsc1tPTl9DT01QTEVURV9GTlNdKSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgICBsRGV0YWlsc1tPTl9DT01QTEVURV9GTlNdID0gbnVsbDsKICAgIH0KICB9CiAgcHJvZmlsZXIoUHJvZmlsZXJFdmVudC5EZWZlckJsb2NrU3RhdGVFbmQpOwp9CmZ1bmN0aW9uIGFwcGx5RGVmZXJCbG9ja1N0YXRlV2l0aFNjaGVkdWxpbmcobmV3U3RhdGUsIGxEZXRhaWxzLCBsQ29udGFpbmVyLCB0Tm9kZSwgaG9zdExWaWV3KSB7CiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKICBjb25zdCBob3N0VFZpZXcgPSBob3N0TFZpZXdbVFZJRVddOwogIGNvbnN0IHREZXRhaWxzID0gZ2V0VERlZmVyQmxvY2tEZXRhaWxzKGhvc3RUVmlldywgdE5vZGUpOwogIGlmIChsRGV0YWlsc1tTVEFURV9JU19GUk9aRU5fVU5USUxdID09PSBudWxsIHx8IGxEZXRhaWxzW1NUQVRFX0lTX0ZST1pFTl9VTlRJTF0gPD0gbm93KSB7CiAgICBsRGV0YWlsc1tTVEFURV9JU19GUk9aRU5fVU5USUxdID0gbnVsbDsKICAgIGNvbnN0IGxvYWRpbmdBZnRlciA9IGdldExvYWRpbmdCbG9ja0FmdGVyKHREZXRhaWxzKTsKICAgIGNvbnN0IGluTG9hZGluZ0FmdGVyUGhhc2UgPSBsRGV0YWlsc1tMT0FESU5HX0FGVEVSX0NMRUFOVVBfRk5dICE9PSBudWxsOwogICAgaWYgKG5ld1N0YXRlID09PSBEZWZlckJsb2NrU3RhdGUuTG9hZGluZyAmJiBsb2FkaW5nQWZ0ZXIgIT09IG51bGwgJiYgIWluTG9hZGluZ0FmdGVyUGhhc2UpIHsKICAgICAgbERldGFpbHNbTkVYVF9ERUZFUl9CTE9DS19TVEFURV0gPSBuZXdTdGF0ZTsKICAgICAgY29uc3QgY2xlYW51cEZuID0gc2NoZWR1bGVEZWZlckJsb2NrVXBkYXRlKGxvYWRpbmdBZnRlciwgbERldGFpbHMsIHROb2RlLCBsQ29udGFpbmVyLCBob3N0TFZpZXcpOwogICAgICBsRGV0YWlsc1tMT0FESU5HX0FGVEVSX0NMRUFOVVBfRk5dID0gY2xlYW51cEZuOwogICAgfSBlbHNlIHsKICAgICAgaWYgKG5ld1N0YXRlID4gRGVmZXJCbG9ja1N0YXRlLkxvYWRpbmcgJiYgaW5Mb2FkaW5nQWZ0ZXJQaGFzZSkgewogICAgICAgIGxEZXRhaWxzW0xPQURJTkdfQUZURVJfQ0xFQU5VUF9GTl0oKTsKICAgICAgICBsRGV0YWlsc1tMT0FESU5HX0FGVEVSX0NMRUFOVVBfRk5dID0gbnVsbDsKICAgICAgICBsRGV0YWlsc1tORVhUX0RFRkVSX0JMT0NLX1NUQVRFXSA9IG51bGw7CiAgICAgIH0KICAgICAgYXBwbHlEZWZlckJsb2NrU3RhdGUobmV3U3RhdGUsIGxEZXRhaWxzLCBsQ29udGFpbmVyLCB0Tm9kZSwgaG9zdExWaWV3KTsKICAgICAgY29uc3QgZHVyYXRpb24gPSBnZXRNaW5pbXVtRHVyYXRpb25Gb3JTdGF0ZSh0RGV0YWlscywgbmV3U3RhdGUpOwogICAgICBpZiAoZHVyYXRpb24gIT09IG51bGwpIHsKICAgICAgICBsRGV0YWlsc1tTVEFURV9JU19GUk9aRU5fVU5USUxdID0gbm93ICsgZHVyYXRpb247CiAgICAgICAgc2NoZWR1bGVEZWZlckJsb2NrVXBkYXRlKGR1cmF0aW9uLCBsRGV0YWlscywgdE5vZGUsIGxDb250YWluZXIsIGhvc3RMVmlldyk7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgewogICAgbERldGFpbHNbTkVYVF9ERUZFUl9CTE9DS19TVEFURV0gPSBuZXdTdGF0ZTsKICB9Cn0KZnVuY3Rpb24gc2NoZWR1bGVEZWZlckJsb2NrVXBkYXRlKHRpbWVvdXQyLCBsRGV0YWlscywgdE5vZGUsIGxDb250YWluZXIsIGhvc3RMVmlldykgewogIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4gewogICAgY29uc3QgbmV4dFN0YXRlID0gbERldGFpbHNbTkVYVF9ERUZFUl9CTE9DS19TVEFURV07CiAgICBsRGV0YWlsc1tTVEFURV9JU19GUk9aRU5fVU5USUxdID0gbnVsbDsKICAgIGxEZXRhaWxzW05FWFRfREVGRVJfQkxPQ0tfU1RBVEVdID0gbnVsbDsKICAgIGlmIChuZXh0U3RhdGUgIT09IG51bGwpIHsKICAgICAgcmVuZGVyRGVmZXJCbG9ja1N0YXRlKG5leHRTdGF0ZSwgdE5vZGUsIGxDb250YWluZXIpOwogICAgfQogIH07CiAgcmV0dXJuIHNjaGVkdWxlVGltZXJUcmlnZ2VyKHRpbWVvdXQyLCBjYWxsYmFjaywgaG9zdExWaWV3W0lOSkVDVE9SXSk7Cn0KZnVuY3Rpb24gaXNWYWxpZFN0YXRlQ2hhbmdlKGN1cnJlbnRTdGF0ZSwgbmV3U3RhdGUpIHsKICByZXR1cm4gY3VycmVudFN0YXRlIDwgbmV3U3RhdGU7Cn0KZnVuY3Rpb24gcmVuZGVyUGxhY2Vob2xkZXIobFZpZXcsIHROb2RlKSB7CiAgY29uc3QgbENvbnRhaW5lciA9IGxWaWV3W3ROb2RlLmluZGV4XTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TENvbnRhaW5lcihsQ29udGFpbmVyKTsKICByZW5kZXJEZWZlckJsb2NrU3RhdGUoRGVmZXJCbG9ja1N0YXRlLlBsYWNlaG9sZGVyLCB0Tm9kZSwgbENvbnRhaW5lcik7Cn0KZnVuY3Rpb24gcmVuZGVyRGVmZXJTdGF0ZUFmdGVyUmVzb3VyY2VMb2FkaW5nKHREZXRhaWxzLCB0Tm9kZSwgbENvbnRhaW5lcikgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHREZXRhaWxzLmxvYWRpbmdQcm9taXNlLCAiRXhwZWN0ZWQgbG9hZGluZyBQcm9taXNlIHRvIGV4aXN0IG9uIHRoaXMgZGVmZXIgYmxvY2siKTsKICB0RGV0YWlscy5sb2FkaW5nUHJvbWlzZS50aGVuKCgpID0+IHsKICAgIGlmICh0RGV0YWlscy5sb2FkaW5nU3RhdGUgPT09IERlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlLkNPTVBMRVRFKSB7CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZlcnJlZERlcGVuZGVuY2llc0xvYWRlZCh0RGV0YWlscyk7CiAgICAgIHJlbmRlckRlZmVyQmxvY2tTdGF0ZShEZWZlckJsb2NrU3RhdGUuQ29tcGxldGUsIHROb2RlLCBsQ29udGFpbmVyKTsKICAgIH0gZWxzZSBpZiAodERldGFpbHMubG9hZGluZ1N0YXRlID09PSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5GQUlMRUQpIHsKICAgICAgcmVuZGVyRGVmZXJCbG9ja1N0YXRlKERlZmVyQmxvY2tTdGF0ZS5FcnJvciwgdE5vZGUsIGxDb250YWluZXIpOwogICAgfQogIH0pOwp9CnZhciBhcHBseURlZmVyQmxvY2tTdGF0ZVdpdGhTY2hlZHVsaW5nSW1wbCA9IG51bGw7CmZ1bmN0aW9uIMm1ybVkZWZlckVuYWJsZVRpbWVyU2NoZWR1bGluZyh0VmlldywgdERldGFpbHMsIHBsYWNlaG9sZGVyQ29uZmlnSW5kZXgsIGxvYWRpbmdDb25maWdJbmRleCkgewogIGNvbnN0IHRWaWV3Q29uc3RzID0gdFZpZXcuY29uc3RzOwogIGlmIChwbGFjZWhvbGRlckNvbmZpZ0luZGV4ICE9IG51bGwpIHsKICAgIHREZXRhaWxzLnBsYWNlaG9sZGVyQmxvY2tDb25maWcgPSBnZXRDb25zdGFudCh0Vmlld0NvbnN0cywgcGxhY2Vob2xkZXJDb25maWdJbmRleCk7CiAgfQogIGlmIChsb2FkaW5nQ29uZmlnSW5kZXggIT0gbnVsbCkgewogICAgdERldGFpbHMubG9hZGluZ0Jsb2NrQ29uZmlnID0gZ2V0Q29uc3RhbnQodFZpZXdDb25zdHMsIGxvYWRpbmdDb25maWdJbmRleCk7CiAgfQogIGlmIChhcHBseURlZmVyQmxvY2tTdGF0ZVdpdGhTY2hlZHVsaW5nSW1wbCA9PT0gbnVsbCkgewogICAgYXBwbHlEZWZlckJsb2NrU3RhdGVXaXRoU2NoZWR1bGluZ0ltcGwgPSBhcHBseURlZmVyQmxvY2tTdGF0ZVdpdGhTY2hlZHVsaW5nOwogIH0KfQp2YXIgQVNZTkNfQ09NUE9ORU5UX01FVEFEQVRBX0ZOID0gIl9fbmdBc3luY0NvbXBvbmVudE1ldGFkYXRhRm5fXyI7CmZ1bmN0aW9uIGdldEFzeW5jQ2xhc3NNZXRhZGF0YUZuKHR5cGUpIHsKICBjb25zdCBjb21wb25lbnRDbGFzcyA9IHR5cGU7CiAgcmV0dXJuIGNvbXBvbmVudENsYXNzW0FTWU5DX0NPTVBPTkVOVF9NRVRBREFUQV9GTl0gPz8gbnVsbDsKfQpmdW5jdGlvbiBzZXRDbGFzc01ldGFkYXRhQXN5bmModHlwZSwgZGVwZW5kZW5jeUxvYWRlckZuLCBtZXRhZGF0YVNldHRlckZuKSB7CiAgY29uc3QgY29tcG9uZW50Q2xhc3MgPSB0eXBlOwogIGNvbXBvbmVudENsYXNzW0FTWU5DX0NPTVBPTkVOVF9NRVRBREFUQV9GTl0gPSAoKSA9PiBQcm9taXNlLmFsbChkZXBlbmRlbmN5TG9hZGVyRm4oKSkudGhlbigoZGVwZW5kZW5jaWVzKSA9PiB7CiAgICBtZXRhZGF0YVNldHRlckZuKC4uLmRlcGVuZGVuY2llcyk7CiAgICBjb21wb25lbnRDbGFzc1tBU1lOQ19DT01QT05FTlRfTUVUQURBVEFfRk5dID0gbnVsbDsKICAgIHJldHVybiBkZXBlbmRlbmNpZXM7CiAgfSk7CiAgcmV0dXJuIGNvbXBvbmVudENsYXNzW0FTWU5DX0NPTVBPTkVOVF9NRVRBREFUQV9GTl07Cn0KZnVuY3Rpb24gc2V0Q2xhc3NNZXRhZGF0YSh0eXBlLCBkZWNvcmF0b3JzLCBjdG9yUGFyYW1ldGVycywgcHJvcERlY29yYXRvcnMpIHsKICByZXR1cm4gbm9TaWRlRWZmZWN0cygoKSA9PiB7CiAgICBjb25zdCBjbGF6eiA9IHR5cGU7CiAgICBpZiAoZGVjb3JhdG9ycyAhPT0gbnVsbCkgewogICAgICBpZiAoY2xhenouaGFzT3duUHJvcGVydHkoImRlY29yYXRvcnMiKSAmJiBjbGF6ei5kZWNvcmF0b3JzICE9PSB2b2lkIDApIHsKICAgICAgICBjbGF6ei5kZWNvcmF0b3JzLnB1c2goLi4uZGVjb3JhdG9ycyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2xhenouZGVjb3JhdG9ycyA9IGRlY29yYXRvcnM7CiAgICAgIH0KICAgIH0KICAgIGlmIChjdG9yUGFyYW1ldGVycyAhPT0gbnVsbCkgewogICAgICBjbGF6ei5jdG9yUGFyYW1ldGVycyA9IGN0b3JQYXJhbWV0ZXJzOwogICAgfQogICAgaWYgKHByb3BEZWNvcmF0b3JzICE9PSBudWxsKSB7CiAgICAgIGlmIChjbGF6ei5oYXNPd25Qcm9wZXJ0eSgicHJvcERlY29yYXRvcnMiKSAmJiBjbGF6ei5wcm9wRGVjb3JhdG9ycyAhPT0gdm9pZCAwKSB7CiAgICAgICAgY2xhenoucHJvcERlY29yYXRvcnMgPSBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgY2xhenoucHJvcERlY29yYXRvcnMpLCBwcm9wRGVjb3JhdG9ycyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2xhenoucHJvcERlY29yYXRvcnMgPSBwcm9wRGVjb3JhdG9yczsKICAgICAgfQogICAgfQogIH0pOwp9CnZhciBDb25zb2xlID0gY2xhc3MgX0NvbnNvbGUgewogIGxvZyhtZXNzYWdlKSB7CiAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTsKICB9CiAgd2FybihtZXNzYWdlKSB7CiAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7CiAgfQogIHN0YXRpYyDJtWZhYyA9IGZ1bmN0aW9uIENvbnNvbGVfRmFjdG9yeShfX25nRmFjdG9yeVR5cGVfXykgewogICAgcmV0dXJuIG5ldyAoX19uZ0ZhY3RvcnlUeXBlX18gfHwgX0NvbnNvbGUpKCk7CiAgfTsKICBzdGF0aWMgybVwcm92ID0gybXJtWRlZmluZUluamVjdGFibGUoewogICAgdG9rZW46IF9Db25zb2xlLAogICAgZmFjdG9yeTogX0NvbnNvbGUuybVmYWMsCiAgICBwcm92aWRlZEluOiAicGxhdGZvcm0iCiAgfSk7Cn07CigoKSA9PiB7CiAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgc2V0Q2xhc3NNZXRhZGF0YShDb25zb2xlLCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJwbGF0Zm9ybSIKICAgIH1dCiAgfV0sIG51bGwsIG51bGwpOwp9KSgpOwp2YXIgRElEZWJ1Z0RhdGEgPSBjbGFzcyB7CiAgcmVzb2x2ZXJUb1Rva2VuVG9EZXBlbmRlbmNpZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICByZXNvbHZlclRvUHJvdmlkZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgcmVzb2x2ZXJUb0VmZmVjdHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICBzdGFuZGFsb25lSW5qZWN0b3JUb0NvbXBvbmVudCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIHJlc2V0KCkgewogICAgdGhpcy5yZXNvbHZlclRvVG9rZW5Ub0RlcGVuZGVuY2llcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogICAgdGhpcy5yZXNvbHZlclRvUHJvdmlkZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgICB0aGlzLnN0YW5kYWxvbmVJbmplY3RvclRvQ29tcG9uZW50ID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgfQp9Owp2YXIgZnJhbWV3b3JrRElEZWJ1Z0RhdGEgPSBuZXcgRElEZWJ1Z0RhdGEoKTsKZnVuY3Rpb24gZ2V0RnJhbWV3b3JrRElEZWJ1Z0RhdGEoKSB7CiAgcmV0dXJuIGZyYW1ld29ya0RJRGVidWdEYXRhOwp9CmZ1bmN0aW9uIHNldHVwRnJhbWV3b3JrSW5qZWN0b3JQcm9maWxlcigpIHsKICBmcmFtZXdvcmtESURlYnVnRGF0YS5yZXNldCgpOwogIHNldEluamVjdG9yUHJvZmlsZXIoaW5qZWN0b3JQcm9maWxlckV2ZW50SGFuZGxlcik7Cn0KZnVuY3Rpb24gaW5qZWN0b3JQcm9maWxlckV2ZW50SGFuZGxlcihpbmplY3RvclByb2ZpbGVyRXZlbnQpIHsKICBjb25zdCB7CiAgICBjb250ZXh0OiBjb250ZXh0MiwKICAgIHR5cGUKICB9ID0gaW5qZWN0b3JQcm9maWxlckV2ZW50OwogIGlmICh0eXBlID09PSAwKSB7CiAgICBoYW5kbGVJbmplY3RFdmVudChjb250ZXh0MiwgaW5qZWN0b3JQcm9maWxlckV2ZW50LnNlcnZpY2UpOwogIH0gZWxzZSBpZiAodHlwZSA9PT0gMSkgewogICAgaGFuZGxlSW5zdGFuY2VDcmVhdGVkQnlJbmplY3RvckV2ZW50KGNvbnRleHQyLCBpbmplY3RvclByb2ZpbGVyRXZlbnQuaW5zdGFuY2UpOwogIH0gZWxzZSBpZiAodHlwZSA9PT0gMikgewogICAgaGFuZGxlUHJvdmlkZXJDb25maWd1cmVkRXZlbnQoY29udGV4dDIsIGluamVjdG9yUHJvZmlsZXJFdmVudC5wcm92aWRlclJlY29yZCk7CiAgfSBlbHNlIGlmICh0eXBlID09PSAzKSB7CiAgICBoYW5kbGVFZmZlY3RDcmVhdGVkRXZlbnQoY29udGV4dDIsIGluamVjdG9yUHJvZmlsZXJFdmVudC5lZmZlY3QpOwogIH0gZWxzZSBpZiAodHlwZSA9PT0gNCkgewogICAgaGFuZGxlRWZmZWN0Q3JlYXRlZEV2ZW50KGNvbnRleHQyLCBpbmplY3RvclByb2ZpbGVyRXZlbnQuZWZmZWN0UGhhc2UpOwogIH0KfQpmdW5jdGlvbiBoYW5kbGVFZmZlY3RDcmVhdGVkRXZlbnQoY29udGV4dDIsIGVmZmVjdDIpIHsKICBjb25zdCBkaVJlc29sdmVyID0gZ2V0RElSZXNvbHZlcihjb250ZXh0Mi5pbmplY3Rvcik7CiAgaWYgKGRpUmVzb2x2ZXIgPT09IG51bGwpIHsKICAgIHRocm93RXJyb3IyKCJBbiBFZmZlY3RDcmVhdGVkIGV2ZW50IG11c3QgYmUgcnVuIHdpdGhpbiBhbiBpbmplY3Rpb24gY29udGV4dC4iKTsKICB9CiAgY29uc3QgewogICAgcmVzb2x2ZXJUb0VmZmVjdHMKICB9ID0gZnJhbWV3b3JrRElEZWJ1Z0RhdGE7CiAgY29uc3QgY2xlYW51cENvbnRhaW5lciA9IGVmZmVjdDIgaW5zdGFuY2VvZiBFZmZlY3RSZWZJbXBsID8gZWZmZWN0MltTSUdOQUxdIDogZWZmZWN0Mi5zZXF1ZW5jZTsKICBsZXQgdHJhY2tlZEVmZmVjdHMgPSByZXNvbHZlclRvRWZmZWN0cy5nZXQoZGlSZXNvbHZlcik7CiAgaWYgKCF0cmFja2VkRWZmZWN0cykgewogICAgdHJhY2tlZEVmZmVjdHMgPSBbXTsKICAgIHJlc29sdmVyVG9FZmZlY3RzLnNldChkaVJlc29sdmVyLCB0cmFja2VkRWZmZWN0cyk7CiAgfQogIHRyYWNrZWRFZmZlY3RzLnB1c2goZWZmZWN0Mik7CiAgY2xlYW51cENvbnRhaW5lci5vbkRlc3Ryb3lGbnMgPz89IFtdOwogIGNsZWFudXBDb250YWluZXIub25EZXN0cm95Rm5zLnB1c2goKCkgPT4gewogICAgY29uc3QgaW5kZXggPSB0cmFja2VkRWZmZWN0cy5pbmRleE9mKGVmZmVjdDIpOwogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgdHJhY2tlZEVmZmVjdHMuc3BsaWNlKGluZGV4LCAxKTsKICAgIH0KICB9KTsKfQpmdW5jdGlvbiBoYW5kbGVJbmplY3RFdmVudChjb250ZXh0MiwgZGF0YSkgewogIGNvbnN0IGRpUmVzb2x2ZXIgPSBnZXRESVJlc29sdmVyKGNvbnRleHQyLmluamVjdG9yKTsKICBpZiAoZGlSZXNvbHZlciA9PT0gbnVsbCkgewogICAgdGhyb3dFcnJvcjIoIkFuIEluamVjdCBldmVudCBtdXN0IGJlIHJ1biB3aXRoaW4gYW4gaW5qZWN0aW9uIGNvbnRleHQuIik7CiAgfQogIGNvbnN0IGRpUmVzb2x2ZXJUb0luc3RhbnRpYXRlZFRva2VuID0gZnJhbWV3b3JrRElEZWJ1Z0RhdGEucmVzb2x2ZXJUb1Rva2VuVG9EZXBlbmRlbmNpZXM7CiAgaWYgKCFkaVJlc29sdmVyVG9JbnN0YW50aWF0ZWRUb2tlbi5oYXMoZGlSZXNvbHZlcikpIHsKICAgIGRpUmVzb2x2ZXJUb0luc3RhbnRpYXRlZFRva2VuLnNldChkaVJlc29sdmVyLCAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKSk7CiAgfQogIGlmICghY2FuQmVIZWxkV2Vha2x5KGNvbnRleHQyLnRva2VuKSkgewogICAgcmV0dXJuOwogIH0KICBjb25zdCBpbnN0YW50aWF0ZWRUb2tlblRvRGVwZW5kZW5jaWVzID0gZGlSZXNvbHZlclRvSW5zdGFudGlhdGVkVG9rZW4uZ2V0KGRpUmVzb2x2ZXIpOwogIGlmICghaW5zdGFudGlhdGVkVG9rZW5Ub0RlcGVuZGVuY2llcy5oYXMoY29udGV4dDIudG9rZW4pKSB7CiAgICBpbnN0YW50aWF0ZWRUb2tlblRvRGVwZW5kZW5jaWVzLnNldChjb250ZXh0Mi50b2tlbiwgW10pOwogIH0KICBjb25zdCB7CiAgICB0b2tlbiwKICAgIHZhbHVlLAogICAgZmxhZ3MKICB9ID0gZGF0YTsKICBhc3NlcnREZWZpbmVkKGNvbnRleHQyLnRva2VuLCAiSW5qZWN0b3IgcHJvZmlsZXIgY29udGV4dCB0b2tlbiBpcyB1bmRlZmluZWQuIik7CiAgY29uc3QgZGVwZW5kZW5jaWVzID0gaW5zdGFudGlhdGVkVG9rZW5Ub0RlcGVuZGVuY2llcy5nZXQoY29udGV4dDIudG9rZW4pOwogIGFzc2VydERlZmluZWQoZGVwZW5kZW5jaWVzLCAiQ291bGQgbm90IHJlc29sdmUgZGVwZW5kZW5jaWVzIGZvciB0b2tlbi4iKTsKICBpZiAoY29udGV4dDIuaW5qZWN0b3IgaW5zdGFuY2VvZiBOb2RlSW5qZWN0b3IpIHsKICAgIGRlcGVuZGVuY2llcy5wdXNoKHsKICAgICAgdG9rZW4sCiAgICAgIHZhbHVlLAogICAgICBmbGFncywKICAgICAgaW5qZWN0ZWRJbjogZ2V0Tm9kZUluamVjdG9yQ29udGV4dChjb250ZXh0Mi5pbmplY3RvcikKICAgIH0pOwogIH0gZWxzZSB7CiAgICBkZXBlbmRlbmNpZXMucHVzaCh7CiAgICAgIHRva2VuLAogICAgICB2YWx1ZSwKICAgICAgZmxhZ3MKICAgIH0pOwogIH0KfQpmdW5jdGlvbiBnZXROb2RlSW5qZWN0b3JDb250ZXh0KGluamVjdG9yKSB7CiAgaWYgKCEoaW5qZWN0b3IgaW5zdGFuY2VvZiBOb2RlSW5qZWN0b3IpKSB7CiAgICB0aHJvd0Vycm9yMigiZ2V0Tm9kZUluamVjdG9yQ29udGV4dCBtdXN0IGJlIGNhbGxlZCB3aXRoIGEgTm9kZUluamVjdG9yIik7CiAgfQogIGNvbnN0IGxWaWV3ID0gZ2V0Tm9kZUluamVjdG9yTFZpZXcoaW5qZWN0b3IpOwogIGNvbnN0IHROb2RlID0gZ2V0Tm9kZUluamVjdG9yVE5vZGUoaW5qZWN0b3IpOwogIGlmICh0Tm9kZSA9PT0gbnVsbCkgewogICAgcmV0dXJuOwogIH0KICBhc3NlcnRUTm9kZUZvckxWaWV3KHROb2RlLCBsVmlldyk7CiAgcmV0dXJuIHsKICAgIGxWaWV3LAogICAgdE5vZGUKICB9Owp9CmZ1bmN0aW9uIGhhbmRsZUluc3RhbmNlQ3JlYXRlZEJ5SW5qZWN0b3JFdmVudChjb250ZXh0MiwgZGF0YSkgewogIGNvbnN0IHsKICAgIHZhbHVlCiAgfSA9IGRhdGE7CiAgaWYgKGRhdGEudmFsdWUgPT0gbnVsbCkgewogICAgcmV0dXJuOwogIH0KICBpZiAoZ2V0RElSZXNvbHZlcihjb250ZXh0Mi5pbmplY3RvcikgPT09IG51bGwpIHsKICAgIHRocm93RXJyb3IyKCJBbiBJbmplY3RvckNyZWF0ZWRJbnN0YW5jZSBldmVudCBtdXN0IGJlIHJ1biB3aXRoaW4gYW4gaW5qZWN0aW9uIGNvbnRleHQuIik7CiAgfQogIGxldCBzdGFuZGFsb25lQ29tcG9uZW50ID0gdm9pZCAwOwogIGlmICh0eXBlb2YgdmFsdWUgPT09ICJvYmplY3QiKSB7CiAgICBzdGFuZGFsb25lQ29tcG9uZW50ID0gdmFsdWU/LmNvbnN0cnVjdG9yOwogIH0KICBpZiAoc3RhbmRhbG9uZUNvbXBvbmVudCA9PSB2b2lkIDAgfHwgIWlzU3RhbmRhbG9uZUNvbXBvbmVudChzdGFuZGFsb25lQ29tcG9uZW50KSkgewogICAgcmV0dXJuOwogIH0KICBjb25zdCBlbnZpcm9ubWVudEluamVjdG9yID0gY29udGV4dDIuaW5qZWN0b3IuZ2V0KEVudmlyb25tZW50SW5qZWN0b3IsIG51bGwsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSk7CiAgaWYgKGVudmlyb25tZW50SW5qZWN0b3IgPT09IG51bGwpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgewogICAgc3RhbmRhbG9uZUluamVjdG9yVG9Db21wb25lbnQKICB9ID0gZnJhbWV3b3JrRElEZWJ1Z0RhdGE7CiAgaWYgKHN0YW5kYWxvbmVJbmplY3RvclRvQ29tcG9uZW50LmhhcyhlbnZpcm9ubWVudEluamVjdG9yKSkgewogICAgcmV0dXJuOwogIH0KICBzdGFuZGFsb25lSW5qZWN0b3JUb0NvbXBvbmVudC5zZXQoZW52aXJvbm1lbnRJbmplY3Rvciwgc3RhbmRhbG9uZUNvbXBvbmVudCk7Cn0KZnVuY3Rpb24gaXNTdGFuZGFsb25lQ29tcG9uZW50KHZhbHVlKSB7CiAgY29uc3QgZGVmID0gZ2V0Q29tcG9uZW50RGVmKHZhbHVlKTsKICByZXR1cm4gISFkZWY/LnN0YW5kYWxvbmU7Cn0KZnVuY3Rpb24gaGFuZGxlUHJvdmlkZXJDb25maWd1cmVkRXZlbnQoY29udGV4dDIsIGRhdGEpIHsKICBjb25zdCB7CiAgICByZXNvbHZlclRvUHJvdmlkZXJzCiAgfSA9IGZyYW1ld29ya0RJRGVidWdEYXRhOwogIGxldCBkaVJlc29sdmVyOwogIGlmIChjb250ZXh0Mj8uaW5qZWN0b3IgaW5zdGFuY2VvZiBOb2RlSW5qZWN0b3IpIHsKICAgIGRpUmVzb2x2ZXIgPSBnZXROb2RlSW5qZWN0b3JUTm9kZShjb250ZXh0Mi5pbmplY3Rvcik7CiAgfSBlbHNlIHsKICAgIGRpUmVzb2x2ZXIgPSBjb250ZXh0Mi5pbmplY3RvcjsKICB9CiAgaWYgKGRpUmVzb2x2ZXIgPT09IG51bGwpIHsKICAgIHRocm93RXJyb3IyKCJBIFByb3ZpZGVyQ29uZmlndXJlZCBldmVudCBtdXN0IGJlIHJ1biB3aXRoaW4gYW4gaW5qZWN0aW9uIGNvbnRleHQuIik7CiAgfQogIGlmICghcmVzb2x2ZXJUb1Byb3ZpZGVycy5oYXMoZGlSZXNvbHZlcikpIHsKICAgIHJlc29sdmVyVG9Qcm92aWRlcnMuc2V0KGRpUmVzb2x2ZXIsIFtdKTsKICB9CiAgcmVzb2x2ZXJUb1Byb3ZpZGVycy5nZXQoZGlSZXNvbHZlcikucHVzaChkYXRhKTsKfQpmdW5jdGlvbiBnZXRESVJlc29sdmVyKGluamVjdG9yKSB7CiAgbGV0IGRpUmVzb2x2ZXIgPSBudWxsOwogIGlmIChpbmplY3RvciA9PT0gdm9pZCAwKSB7CiAgICByZXR1cm4gZGlSZXNvbHZlcjsKICB9CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTm9kZUluamVjdG9yKSB7CiAgICBkaVJlc29sdmVyID0gZ2V0Tm9kZUluamVjdG9yTFZpZXcoaW5qZWN0b3IpOwogIH0gZWxzZSB7CiAgICBkaVJlc29sdmVyID0gaW5qZWN0b3I7CiAgfQogIHJldHVybiBkaVJlc29sdmVyOwp9CmZ1bmN0aW9uIGNhbkJlSGVsZFdlYWtseSh2YWx1ZSkgewogIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiAodHlwZW9mIHZhbHVlID09PSAib2JqZWN0IiB8fCB0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIgfHwgdHlwZW9mIHZhbHVlID09PSAic3ltYm9sIik7Cn0KZnVuY3Rpb24gaXNTaWduYWwyKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gImZ1bmN0aW9uIiAmJiB2YWx1ZVtTSUdOQUxdICE9PSB2b2lkIDA7Cn0KZnVuY3Rpb24gaXNXcml0YWJsZVNpZ25hbCh2YWx1ZSkgewogIHJldHVybiBpc1NpZ25hbDIodmFsdWUpICYmIHR5cGVvZiB2YWx1ZS5zZXQgPT09ICJmdW5jdGlvbiI7Cn0KZnVuY3Rpb24gYXBwbHlDaGFuZ2VzKGNvbXBvbmVudCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGNvbXBvbmVudCwgImNvbXBvbmVudCIpOwogIG1hcmtWaWV3RGlydHkoZ2V0Q29tcG9uZW50Vmlld0J5SW5zdGFuY2UoY29tcG9uZW50KSwgMyk7CiAgZ2V0Um9vdENvbXBvbmVudHMoY29tcG9uZW50KS5mb3JFYWNoKChyb290Q29tcG9uZW50KSA9PiBkZXRlY3RDaGFuZ2VzKHJvb3RDb21wb25lbnQpKTsKfQpmdW5jdGlvbiBkZXRlY3RDaGFuZ2VzKGNvbXBvbmVudCkgewogIGNvbnN0IHZpZXcgPSBnZXRDb21wb25lbnRWaWV3QnlJbnN0YW5jZShjb21wb25lbnQpOwogIHZpZXdbRkxBR1NdIHw9IDEwMjQ7CiAgZGV0ZWN0Q2hhbmdlc0ludGVybmFsKHZpZXcpOwp9CmZ1bmN0aW9uIGdldERlZmVyQmxvY2tzJDEobFZpZXcsIGRlZmVyQmxvY2tzKSB7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgZm9yIChsZXQgaSA9IEhFQURFUl9PRkZTRVQ7IGkgPCB0Vmlldy5iaW5kaW5nU3RhcnRJbmRleDsgaSsrKSB7CiAgICBpZiAoaXNMQ29udGFpbmVyKGxWaWV3W2ldKSkgewogICAgICBjb25zdCBsQ29udGFpbmVyID0gbFZpZXdbaV07CiAgICAgIGNvbnN0IGlzTGFzdCA9IGkgPT09IHRWaWV3LmJpbmRpbmdTdGFydEluZGV4IC0gMTsKICAgICAgaWYgKCFpc0xhc3QpIHsKICAgICAgICBjb25zdCB0Tm9kZSA9IHRWaWV3LmRhdGFbaV07CiAgICAgICAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICAgICAgICBpZiAoaXNURGVmZXJCbG9ja0RldGFpbHModERldGFpbHMpKSB7CiAgICAgICAgICBkZWZlckJsb2Nrcy5wdXNoKHsKICAgICAgICAgICAgbENvbnRhaW5lciwKICAgICAgICAgICAgbFZpZXcsCiAgICAgICAgICAgIHROb2RlLAogICAgICAgICAgICB0RGV0YWlscwogICAgICAgICAgfSk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGlzTFZpZXcobENvbnRhaW5lcltIT1NUXSkpIHsKICAgICAgICBnZXREZWZlckJsb2NrcyQxKGxDb250YWluZXJbSE9TVF0sIGRlZmVyQmxvY2tzKTsKICAgICAgfQogICAgICBmb3IgKGxldCBqID0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQ7IGogPCBsQ29udGFpbmVyLmxlbmd0aDsgaisrKSB7CiAgICAgICAgZ2V0RGVmZXJCbG9ja3MkMShsQ29udGFpbmVyW2pdLCBkZWZlckJsb2Nrcyk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNMVmlldyhsVmlld1tpXSkpIHsKICAgICAgZ2V0RGVmZXJCbG9ja3MkMShsVmlld1tpXSwgZGVmZXJCbG9ja3MpOwogICAgfQogIH0KfQpmdW5jdGlvbiBnZXREZWZlckJsb2Nrcyhub2RlKSB7CiAgY29uc3QgcmVzdWx0cyA9IFtdOwogIGNvbnN0IGxWaWV3ID0gZ2V0TENvbnRleHQobm9kZSk/LmxWaWV3OwogIGlmIChsVmlldykgewogICAgZmluZERlZmVyQmxvY2tzKG5vZGUsIGxWaWV3LCByZXN1bHRzKTsKICB9CiAgcmV0dXJuIHJlc3VsdHM7Cn0KZnVuY3Rpb24gZmluZERlZmVyQmxvY2tzKG5vZGUsIGxWaWV3LCByZXN1bHRzKSB7CiAgY29uc3Qgdmlld0luamVjdG9yID0gbFZpZXdbSU5KRUNUT1JdOwogIGNvbnN0IHJlZ2lzdHJ5ID0gdmlld0luamVjdG9yLmdldChERUhZRFJBVEVEX0JMT0NLX1JFR0lTVFJZLCBudWxsLCB7CiAgICBvcHRpb25hbDogdHJ1ZQogIH0pOwogIGNvbnN0IGJsb2NrcyA9IFtdOwogIGdldERlZmVyQmxvY2tzJDEobFZpZXcsIGJsb2Nrcyk7CiAgY29uc3QgdHJhbnNmZXJTdGF0ZSA9IHZpZXdJbmplY3Rvci5nZXQoVHJhbnNmZXJTdGF0ZSk7CiAgY29uc3QgZGVmZXJCbG9ja1BhcmVudHMgPSB0cmFuc2ZlclN0YXRlLmdldChOR0hfREVGRVJfQkxPQ0tTX0tFWSwge30pOwogIGZvciAoY29uc3QgZGV0YWlscyBvZiBibG9ja3MpIHsKICAgIGNvbnN0IG5hdGl2ZSA9IGdldE5hdGl2ZUJ5VE5vZGUoZGV0YWlscy50Tm9kZSwgZGV0YWlscy5sVmlldyk7CiAgICBjb25zdCBsRGV0YWlscyA9IGdldExEZWZlckJsb2NrRGV0YWlscyhkZXRhaWxzLmxWaWV3LCBkZXRhaWxzLnROb2RlKTsKICAgIGlmICghbm9kZS5jb250YWlucyhuYXRpdmUpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgY29uc3QgdERldGFpbHMgPSBkZXRhaWxzLnREZXRhaWxzOwogICAgY29uc3QgcmVuZGVyZWRMVmlldyA9IGdldFJlbmRlcmVyTFZpZXcoZGV0YWlscyk7CiAgICBjb25zdCByb290Tm9kZXMgPSBbXTsKICAgIGNvbnN0IGh5ZHJhdGlvblN0YXRlID0gaW5mZXJIeWRyYXRpb25TdGF0ZSh0RGV0YWlscywgbERldGFpbHMsIHJlZ2lzdHJ5KTsKICAgIGlmIChyZW5kZXJlZExWaWV3ICE9PSBudWxsKSB7CiAgICAgIGNvbGxlY3ROYXRpdmVOb2RlcyhyZW5kZXJlZExWaWV3W1RWSUVXXSwgcmVuZGVyZWRMVmlldywgcmVuZGVyZWRMVmlld1tUVklFV10uZmlyc3RDaGlsZCwgcm9vdE5vZGVzKTsKICAgIH0gZWxzZSBpZiAoaHlkcmF0aW9uU3RhdGUgPT09ICJkZWh5ZHJhdGVkIikgewogICAgICBjb25zdCBkZWZlcklkID0gbERldGFpbHNbU1NSX1VOSVFVRV9JRF07CiAgICAgIGNvbnN0IGRlZmVyRGF0YSA9IGRlZmVyQmxvY2tQYXJlbnRzW2RlZmVySWRdOwogICAgICBjb25zdCBudW1iZXJPZlJvb3ROb2RlcyA9IGRlZmVyRGF0YVtOVU1fUk9PVF9OT0RFU107CiAgICAgIGxldCBjb2xsZWN0ZWROb2RlQ291bnQgPSAwOwogICAgICBjb25zdCBkZWZlckJsb2NrQ29tbWVudE5vZGUgPSBkZXRhaWxzLmxDb250YWluZXJbTkFUSVZFXTsKICAgICAgbGV0IGN1cnJlbnROb2RlID0gZGVmZXJCbG9ja0NvbW1lbnROb2RlLnByZXZpb3VzU2libGluZzsKICAgICAgd2hpbGUgKGNvbGxlY3RlZE5vZGVDb3VudCA8IG51bWJlck9mUm9vdE5vZGVzICYmIGN1cnJlbnROb2RlKSB7CiAgICAgICAgcm9vdE5vZGVzLnVuc2hpZnQoY3VycmVudE5vZGUpOwogICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUucHJldmlvdXNTaWJsaW5nOwogICAgICAgIGNvbGxlY3RlZE5vZGVDb3VudCsrOwogICAgICB9CiAgICB9CiAgICBjb25zdCBkYXRhID0gewogICAgICBzdGF0ZTogc3RyaW5naWZ5U3RhdGUobERldGFpbHNbREVGRVJfQkxPQ0tfU1RBVEVdKSwKICAgICAgaW5jcmVtZW50YWxIeWRyYXRpb25TdGF0ZTogaHlkcmF0aW9uU3RhdGUsCiAgICAgIGhhc0Vycm9yQmxvY2s6IHREZXRhaWxzLmVycm9yVG1wbEluZGV4ICE9PSBudWxsLAogICAgICBsb2FkaW5nQmxvY2s6IHsKICAgICAgICBleGlzdHM6IHREZXRhaWxzLmxvYWRpbmdUbXBsSW5kZXggIT09IG51bGwsCiAgICAgICAgbWluaW11bVRpbWU6IHREZXRhaWxzLmxvYWRpbmdCbG9ja0NvbmZpZz8uW01JTklNVU1fU0xPVF0gPz8gbnVsbCwKICAgICAgICBhZnRlclRpbWU6IHREZXRhaWxzLmxvYWRpbmdCbG9ja0NvbmZpZz8uW0xPQURJTkdfQUZURVJfU0xPVF0gPz8gbnVsbAogICAgICB9LAogICAgICBwbGFjZWhvbGRlckJsb2NrOiB7CiAgICAgICAgZXhpc3RzOiB0RGV0YWlscy5wbGFjZWhvbGRlclRtcGxJbmRleCAhPT0gbnVsbCwKICAgICAgICBtaW5pbXVtVGltZTogdERldGFpbHMucGxhY2Vob2xkZXJCbG9ja0NvbmZpZz8uW01JTklNVU1fU0xPVF0gPz8gbnVsbAogICAgICB9LAogICAgICB0cmlnZ2VyczogdERldGFpbHMuZGVidWc/LnRyaWdnZXJzID8gQXJyYXkuZnJvbSh0RGV0YWlscy5kZWJ1Zy50cmlnZ2Vycykuc29ydCgpIDogW10sCiAgICAgIHJvb3ROb2RlcwogICAgfTsKICAgIHJlc3VsdHMucHVzaChkYXRhKTsKICAgIGlmIChyZW5kZXJlZExWaWV3ICE9PSBudWxsKSB7CiAgICAgIGZpbmREZWZlckJsb2Nrcyhub2RlLCByZW5kZXJlZExWaWV3LCByZXN1bHRzKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gc3RyaW5naWZ5U3RhdGUoc3RhdGUpIHsKICBzd2l0Y2ggKHN0YXRlKSB7CiAgICBjYXNlIERlZmVyQmxvY2tTdGF0ZS5Db21wbGV0ZToKICAgICAgcmV0dXJuICJjb21wbGV0ZSI7CiAgICBjYXNlIERlZmVyQmxvY2tTdGF0ZS5Mb2FkaW5nOgogICAgICByZXR1cm4gImxvYWRpbmciOwogICAgY2FzZSBEZWZlckJsb2NrU3RhdGUuUGxhY2Vob2xkZXI6CiAgICAgIHJldHVybiAicGxhY2Vob2xkZXIiOwogICAgY2FzZSBEZWZlckJsb2NrU3RhdGUuRXJyb3I6CiAgICAgIHJldHVybiAiZXJyb3IiOwogICAgY2FzZSBEZWZlckJsb2NrSW50ZXJuYWxTdGF0ZS5Jbml0aWFsOgogICAgICByZXR1cm4gImluaXRpYWwiOwogICAgZGVmYXVsdDoKICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnJlY29nbml6ZWQgc3RhdGUgJHtzdGF0ZX1gKTsKICB9Cn0KZnVuY3Rpb24gaW5mZXJIeWRyYXRpb25TdGF0ZSh0RGV0YWlscywgbERldGFpbHMsIHJlZ2lzdHJ5KSB7CiAgaWYgKHJlZ2lzdHJ5ID09PSBudWxsIHx8IGxEZXRhaWxzW1NTUl9VTklRVUVfSURdID09PSBudWxsIHx8IHREZXRhaWxzLmh5ZHJhdGVUcmlnZ2VycyA9PT0gbnVsbCB8fCB0RGV0YWlscy5oeWRyYXRlVHJpZ2dlcnMuaGFzKDcpKSB7CiAgICByZXR1cm4gIm5vdC1jb25maWd1cmVkIjsKICB9CiAgcmV0dXJuIHJlZ2lzdHJ5LmhhcyhsRGV0YWlsc1tTU1JfVU5JUVVFX0lEXSkgPyAiZGVoeWRyYXRlZCIgOiAiaHlkcmF0ZWQiOwp9CmZ1bmN0aW9uIGdldFJlbmRlcmVyTFZpZXcoZGV0YWlscykgewogIGlmIChkZXRhaWxzLmxDb250YWluZXIubGVuZ3RoIDw9IENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgY29uc3QgbFZpZXcgPSBkZXRhaWxzLmxDb250YWluZXJbQ09OVEFJTkVSX0hFQURFUl9PRkZTRVRdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRMVmlldyhsVmlldyk7CiAgcmV0dXJuIGxWaWV3Owp9CmZ1bmN0aW9uIGdldERlcGVuZGVuY2llc0Zyb21JbmplY3RhYmxlKGluamVjdG9yLCB0b2tlbikgewogIGNvbnN0IGluc3RhbmNlID0gaW5qZWN0b3IuZ2V0KHRva2VuLCBudWxsLCB7CiAgICBzZWxmOiB0cnVlLAogICAgb3B0aW9uYWw6IHRydWUKICB9KTsKICBpZiAoaW5zdGFuY2UgPT09IG51bGwpIHsKICAgIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIGRldGVybWluZSBpbnN0YW5jZSBvZiAke3Rva2VufSBpbiBnaXZlbiBpbmplY3RvcmApOwogIH0KICBjb25zdCB1bmZvcm1hdHRlZERlcGVuZGVuY2llcyA9IGdldERlcGVuZGVuY2llc0ZvclRva2VuSW5JbmplY3Rvcih0b2tlbiwgaW5qZWN0b3IpOwogIGNvbnN0IHJlc29sdXRpb25QYXRoID0gZ2V0SW5qZWN0b3JSZXNvbHV0aW9uUGF0aChpbmplY3Rvcik7CiAgY29uc3QgZGVwZW5kZW5jaWVzID0gdW5mb3JtYXR0ZWREZXBlbmRlbmNpZXMubWFwKChkZXApID0+IHsKICAgIGNvbnN0IGZvcm1hdHRlZERlcGVuZGVuY3kgPSB7CiAgICAgIHZhbHVlOiBkZXAudmFsdWUKICAgIH07CiAgICBjb25zdCBmbGFncyA9IGRlcC5mbGFnczsKICAgIGZvcm1hdHRlZERlcGVuZGVuY3kuZmxhZ3MgPSB7CiAgICAgIG9wdGlvbmFsOiAoOCAmIGZsYWdzKSA9PT0gOCwKICAgICAgaG9zdDogKDEgJiBmbGFncykgPT09IDEsCiAgICAgIHNlbGY6ICgyICYgZmxhZ3MpID09PSAyLAogICAgICBza2lwU2VsZjogKDQgJiBmbGFncykgPT09IDQKICAgIH07CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc29sdXRpb25QYXRoLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGluamVjdG9yVG9DaGVjayA9IHJlc29sdXRpb25QYXRoW2ldOwogICAgICBpZiAoaSA9PT0gMCAmJiBmb3JtYXR0ZWREZXBlbmRlbmN5LmZsYWdzLnNraXBTZWxmKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgaWYgKGZvcm1hdHRlZERlcGVuZGVuY3kuZmxhZ3MuaG9zdCAmJiBpbmplY3RvclRvQ2hlY2sgaW5zdGFuY2VvZiBFbnZpcm9ubWVudEluamVjdG9yKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY29uc3QgaW5zdGFuY2UyID0gaW5qZWN0b3JUb0NoZWNrLmdldChkZXAudG9rZW4sIG51bGwsIHsKICAgICAgICBzZWxmOiB0cnVlLAogICAgICAgIG9wdGlvbmFsOiB0cnVlCiAgICAgIH0pOwogICAgICBpZiAoaW5zdGFuY2UyICE9PSBudWxsKSB7CiAgICAgICAgaWYgKGZvcm1hdHRlZERlcGVuZGVuY3kuZmxhZ3MuaG9zdCkgewogICAgICAgICAgY29uc3QgZmlyc3RJbmplY3RvciA9IHJlc29sdXRpb25QYXRoWzBdOwogICAgICAgICAgY29uc3QgbG9va3VwRnJvbUZpcnN0SW5qZWN0b3IgPSBmaXJzdEluamVjdG9yLmdldChkZXAudG9rZW4sIG51bGwsIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGZvcm1hdHRlZERlcGVuZGVuY3kuZmxhZ3MpLCB7CiAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlCiAgICAgICAgICB9KSk7CiAgICAgICAgICBpZiAobG9va3VwRnJvbUZpcnN0SW5qZWN0b3IgIT09IG51bGwpIHsKICAgICAgICAgICAgZm9ybWF0dGVkRGVwZW5kZW5jeS5wcm92aWRlZEluID0gaW5qZWN0b3JUb0NoZWNrOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGZvcm1hdHRlZERlcGVuZGVuY3kucHJvdmlkZWRJbiA9IGluamVjdG9yVG9DaGVjazsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBpZiAoaSA9PT0gMCAmJiBmb3JtYXR0ZWREZXBlbmRlbmN5LmZsYWdzLnNlbGYpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgaWYgKGRlcC50b2tlbikgZm9ybWF0dGVkRGVwZW5kZW5jeS50b2tlbiA9IGRlcC50b2tlbjsKICAgIHJldHVybiBmb3JtYXR0ZWREZXBlbmRlbmN5OwogIH0pOwogIHJldHVybiB7CiAgICBpbnN0YW5jZSwKICAgIGRlcGVuZGVuY2llcwogIH07Cn0KZnVuY3Rpb24gZ2V0RGVwZW5kZW5jaWVzRm9yVG9rZW5JbkluamVjdG9yKHRva2VuLCBpbmplY3RvcikgewogIGNvbnN0IHsKICAgIHJlc29sdmVyVG9Ub2tlblRvRGVwZW5kZW5jaWVzCiAgfSA9IGdldEZyYW1ld29ya0RJRGVidWdEYXRhKCk7CiAgaWYgKCEoaW5qZWN0b3IgaW5zdGFuY2VvZiBOb2RlSW5qZWN0b3IpKSB7CiAgICByZXR1cm4gcmVzb2x2ZXJUb1Rva2VuVG9EZXBlbmRlbmNpZXMuZ2V0KGluamVjdG9yKT8uZ2V0Py4odG9rZW4pID8/IFtdOwogIH0KICBjb25zdCBsVmlldyA9IGdldE5vZGVJbmplY3RvckxWaWV3KGluamVjdG9yKTsKICBjb25zdCB0b2tlbkRlcGVuZGVuY3lNYXAgPSByZXNvbHZlclRvVG9rZW5Ub0RlcGVuZGVuY2llcy5nZXQobFZpZXcpOwogIGNvbnN0IGRlcGVuZGVuY2llcyA9IHRva2VuRGVwZW5kZW5jeU1hcD8uZ2V0KHRva2VuKSA/PyBbXTsKICByZXR1cm4gZGVwZW5kZW5jaWVzLmZpbHRlcigoZGVwZW5kZW5jeSkgPT4gewogICAgY29uc3QgZGVwZW5kZW5jeU5vZGUgPSBkZXBlbmRlbmN5LmluamVjdGVkSW4/LnROb2RlOwogICAgaWYgKGRlcGVuZGVuY3lOb2RlID09PSB2b2lkIDApIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgY29uc3QgaW5zdGFuY2VOb2RlID0gZ2V0Tm9kZUluamVjdG9yVE5vZGUoaW5qZWN0b3IpOwogICAgYXNzZXJ0VE5vZGUoZGVwZW5kZW5jeU5vZGUpOwogICAgYXNzZXJ0VE5vZGUoaW5zdGFuY2VOb2RlKTsKICAgIHJldHVybiBkZXBlbmRlbmN5Tm9kZSA9PT0gaW5zdGFuY2VOb2RlOwogIH0pOwp9CmZ1bmN0aW9uIGdldFByb3ZpZGVySW1wb3J0c0NvbnRhaW5lcihpbmplY3RvcikgewogIGNvbnN0IHsKICAgIHN0YW5kYWxvbmVJbmplY3RvclRvQ29tcG9uZW50CiAgfSA9IGdldEZyYW1ld29ya0RJRGVidWdEYXRhKCk7CiAgaWYgKHN0YW5kYWxvbmVJbmplY3RvclRvQ29tcG9uZW50LmhhcyhpbmplY3RvcikpIHsKICAgIHJldHVybiBzdGFuZGFsb25lSW5qZWN0b3JUb0NvbXBvbmVudC5nZXQoaW5qZWN0b3IpOwogIH0KICBjb25zdCBkZWZUeXBlUmVmID0gaW5qZWN0b3IuZ2V0KE5nTW9kdWxlUmVmJDEsIG51bGwsIHsKICAgIHNlbGY6IHRydWUsCiAgICBvcHRpb25hbDogdHJ1ZQogIH0pOwogIGlmIChkZWZUeXBlUmVmID09PSBudWxsKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgaWYgKGRlZlR5cGVSZWYuaW5zdGFuY2UgPT09IG51bGwpIHsKICAgIHJldHVybiBudWxsOwogIH0KICByZXR1cm4gZGVmVHlwZVJlZi5pbnN0YW5jZS5jb25zdHJ1Y3RvcjsKfQpmdW5jdGlvbiBnZXROb2RlSW5qZWN0b3JQcm92aWRlcnMoaW5qZWN0b3IpIHsKICBjb25zdCBkaVJlc29sdmVyID0gZ2V0Tm9kZUluamVjdG9yVE5vZGUoaW5qZWN0b3IpOwogIGNvbnN0IHsKICAgIHJlc29sdmVyVG9Qcm92aWRlcnMKICB9ID0gZ2V0RnJhbWV3b3JrRElEZWJ1Z0RhdGEoKTsKICByZXR1cm4gcmVzb2x2ZXJUb1Byb3ZpZGVycy5nZXQoZGlSZXNvbHZlcikgPz8gW107Cn0KZnVuY3Rpb24gZ2V0UHJvdmlkZXJJbXBvcnRQYXRocyhwcm92aWRlckltcG9ydHNDb250YWluZXIpIHsKICBjb25zdCBwcm92aWRlclRvUGF0aCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdmlzaXRlZENvbnRhaW5lcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwogIGNvbnN0IHZpc2l0b3IgPSB3YWxrUHJvdmlkZXJUcmVlVG9EaXNjb3ZlckltcG9ydFBhdGhzKHByb3ZpZGVyVG9QYXRoLCB2aXNpdGVkQ29udGFpbmVycyk7CiAgd2Fsa1Byb3ZpZGVyVHJlZShwcm92aWRlckltcG9ydHNDb250YWluZXIsIHZpc2l0b3IsIFtdLCAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpKTsKICByZXR1cm4gcHJvdmlkZXJUb1BhdGg7Cn0KZnVuY3Rpb24gd2Fsa1Byb3ZpZGVyVHJlZVRvRGlzY292ZXJJbXBvcnRQYXRocyhwcm92aWRlclRvUGF0aCwgdmlzaXRlZENvbnRhaW5lcnMpIHsKICByZXR1cm4gKHByb3ZpZGVyLCBjb250YWluZXIpID0+IHsKICAgIGlmICghcHJvdmlkZXJUb1BhdGguaGFzKHByb3ZpZGVyKSkgewogICAgICBwcm92aWRlclRvUGF0aC5zZXQocHJvdmlkZXIsIFtjb250YWluZXJdKTsKICAgIH0KICAgIGlmICghdmlzaXRlZENvbnRhaW5lcnMuaGFzKGNvbnRhaW5lcikpIHsKICAgICAgZm9yIChjb25zdCBwcm92IG9mIHByb3ZpZGVyVG9QYXRoLmtleXMoKSkgewogICAgICAgIGNvbnN0IGV4aXN0aW5nSW1wb3J0UGF0aCA9IHByb3ZpZGVyVG9QYXRoLmdldChwcm92KTsKICAgICAgICBsZXQgY29udGFpbmVyRGVmID0gZ2V0SW5qZWN0b3JEZWYoY29udGFpbmVyKTsKICAgICAgICBpZiAoIWNvbnRhaW5lckRlZikgewogICAgICAgICAgY29uc3QgbmdNb2R1bGUgPSBjb250YWluZXIubmdNb2R1bGU7CiAgICAgICAgICBjb250YWluZXJEZWYgPSBnZXRJbmplY3RvckRlZihuZ01vZHVsZSk7CiAgICAgICAgfQogICAgICAgIGlmICghY29udGFpbmVyRGVmKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGxhc3RDb250YWluZXJBZGRlZFRvUGF0aCA9IGV4aXN0aW5nSW1wb3J0UGF0aFswXTsKICAgICAgICBsZXQgaXNOZXh0U3RlcEluUGF0aCA9IGZhbHNlOwogICAgICAgIGRlZXBGb3JFYWNoKGNvbnRhaW5lckRlZi5pbXBvcnRzLCAobW9kdWxlSW1wb3J0KSA9PiB7CiAgICAgICAgICBpZiAoaXNOZXh0U3RlcEluUGF0aCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBpc05leHRTdGVwSW5QYXRoID0gbW9kdWxlSW1wb3J0Lm5nTW9kdWxlID09PSBsYXN0Q29udGFpbmVyQWRkZWRUb1BhdGggfHwgbW9kdWxlSW1wb3J0ID09PSBsYXN0Q29udGFpbmVyQWRkZWRUb1BhdGg7CiAgICAgICAgICBpZiAoaXNOZXh0U3RlcEluUGF0aCkgewogICAgICAgICAgICBwcm92aWRlclRvUGF0aC5nZXQocHJvdik/LnVuc2hpZnQoY29udGFpbmVyKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgdmlzaXRlZENvbnRhaW5lcnMuYWRkKGNvbnRhaW5lcik7CiAgfTsKfQpmdW5jdGlvbiBnZXRFbnZpcm9ubWVudEluamVjdG9yUHJvdmlkZXJzKGluamVjdG9yKSB7CiAgY29uc3QgcHJvdmlkZXJSZWNvcmRzV2l0aG91dEltcG9ydFBhdGhzID0gZ2V0RnJhbWV3b3JrRElEZWJ1Z0RhdGEoKS5yZXNvbHZlclRvUHJvdmlkZXJzLmdldChpbmplY3RvcikgPz8gW107CiAgaWYgKGlzUGxhdGZvcm1JbmplY3RvcihpbmplY3RvcikpIHsKICAgIHJldHVybiBwcm92aWRlclJlY29yZHNXaXRob3V0SW1wb3J0UGF0aHM7CiAgfQogIGNvbnN0IHByb3ZpZGVySW1wb3J0c0NvbnRhaW5lciA9IGdldFByb3ZpZGVySW1wb3J0c0NvbnRhaW5lcihpbmplY3Rvcik7CiAgaWYgKHByb3ZpZGVySW1wb3J0c0NvbnRhaW5lciA9PT0gbnVsbCkgewogICAgcmV0dXJuIHByb3ZpZGVyUmVjb3Jkc1dpdGhvdXRJbXBvcnRQYXRoczsKICB9CiAgY29uc3QgcHJvdmlkZXJUb1BhdGggPSBnZXRQcm92aWRlckltcG9ydFBhdGhzKHByb3ZpZGVySW1wb3J0c0NvbnRhaW5lcik7CiAgY29uc3QgcHJvdmlkZXJSZWNvcmRzID0gW107CiAgZm9yIChjb25zdCBwcm92aWRlclJlY29yZCBvZiBwcm92aWRlclJlY29yZHNXaXRob3V0SW1wb3J0UGF0aHMpIHsKICAgIGNvbnN0IHByb3ZpZGVyID0gcHJvdmlkZXJSZWNvcmQucHJvdmlkZXI7CiAgICBjb25zdCB0b2tlbiA9IHByb3ZpZGVyLnByb3ZpZGU7CiAgICBpZiAodG9rZW4gPT09IEVOVklST05NRU5UX0lOSVRJQUxJWkVSIHx8IHRva2VuID09PSBJTkpFQ1RPUl9ERUZfVFlQRVMpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBsZXQgaW1wb3J0UGF0aCA9IHByb3ZpZGVyVG9QYXRoLmdldChwcm92aWRlcikgPz8gW107CiAgICBjb25zdCBkZWYgPSBnZXRDb21wb25lbnREZWYocHJvdmlkZXJJbXBvcnRzQ29udGFpbmVyKTsKICAgIGNvbnN0IGlzU3RhbmRhbG9uZUNvbXBvbmVudDIgPSAhIWRlZj8uc3RhbmRhbG9uZTsKICAgIGlmIChpc1N0YW5kYWxvbmVDb21wb25lbnQyKSB7CiAgICAgIGltcG9ydFBhdGggPSBbcHJvdmlkZXJJbXBvcnRzQ29udGFpbmVyLCAuLi5pbXBvcnRQYXRoXTsKICAgIH0KICAgIHByb3ZpZGVyUmVjb3Jkcy5wdXNoKF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIHByb3ZpZGVyUmVjb3JkKSwgewogICAgICBpbXBvcnRQYXRoCiAgICB9KSk7CiAgfQogIHJldHVybiBwcm92aWRlclJlY29yZHM7Cn0KZnVuY3Rpb24gaXNQbGF0Zm9ybUluamVjdG9yKGluamVjdG9yKSB7CiAgcmV0dXJuIGluamVjdG9yIGluc3RhbmNlb2YgUjNJbmplY3RvciAmJiBpbmplY3Rvci5zY29wZXMuaGFzKCJwbGF0Zm9ybSIpOwp9CmZ1bmN0aW9uIGdldEluamVjdG9yUHJvdmlkZXJzKGluamVjdG9yKSB7CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTm9kZUluamVjdG9yKSB7CiAgICByZXR1cm4gZ2V0Tm9kZUluamVjdG9yUHJvdmlkZXJzKGluamVjdG9yKTsKICB9IGVsc2UgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgRW52aXJvbm1lbnRJbmplY3RvcikgewogICAgcmV0dXJuIGdldEVudmlyb25tZW50SW5qZWN0b3JQcm92aWRlcnMoaW5qZWN0b3IpOwogIH0KICB0aHJvd0Vycm9yMigiZ2V0SW5qZWN0b3JQcm92aWRlcnMgb25seSBzdXBwb3J0cyBOb2RlSW5qZWN0b3IgYW5kIEVudmlyb25tZW50SW5qZWN0b3IiKTsKfQpmdW5jdGlvbiBnZXRJbmplY3Rvck1ldGFkYXRhKGluamVjdG9yKSB7CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTm9kZUluamVjdG9yKSB7CiAgICBjb25zdCBsVmlldyA9IGdldE5vZGVJbmplY3RvckxWaWV3KGluamVjdG9yKTsKICAgIGNvbnN0IHROb2RlID0gZ2V0Tm9kZUluamVjdG9yVE5vZGUoaW5qZWN0b3IpOwogICAgYXNzZXJ0VE5vZGVGb3JMVmlldyh0Tm9kZSwgbFZpZXcpOwogICAgcmV0dXJuIHsKICAgICAgdHlwZTogImVsZW1lbnQiLAogICAgICBzb3VyY2U6IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KQogICAgfTsKICB9CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgUjNJbmplY3RvcikgewogICAgcmV0dXJuIHsKICAgICAgdHlwZTogImVudmlyb25tZW50IiwKICAgICAgc291cmNlOiBpbmplY3Rvci5zb3VyY2UgPz8gbnVsbAogICAgfTsKICB9CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTnVsbEluamVjdG9yKSB7CiAgICByZXR1cm4gewogICAgICB0eXBlOiAibnVsbCIsCiAgICAgIHNvdXJjZTogbnVsbAogICAgfTsKICB9CiAgcmV0dXJuIG51bGw7Cn0KZnVuY3Rpb24gZ2V0SW5qZWN0b3JSZXNvbHV0aW9uUGF0aChpbmplY3RvcikgewogIGNvbnN0IHJlc29sdXRpb25QYXRoID0gW2luamVjdG9yXTsKICBnZXRJbmplY3RvclJlc29sdXRpb25QYXRoSGVscGVyKGluamVjdG9yLCByZXNvbHV0aW9uUGF0aCk7CiAgcmV0dXJuIHJlc29sdXRpb25QYXRoOwp9CmZ1bmN0aW9uIGdldEluamVjdG9yUmVzb2x1dGlvblBhdGhIZWxwZXIoaW5qZWN0b3IsIHJlc29sdXRpb25QYXRoKSB7CiAgY29uc3QgcGFyZW50ID0gZ2V0SW5qZWN0b3JQYXJlbnQoaW5qZWN0b3IpOwogIGlmIChwYXJlbnQgPT09IG51bGwpIHsKICAgIGlmIChpbmplY3RvciBpbnN0YW5jZW9mIE5vZGVJbmplY3RvcikgewogICAgICBjb25zdCBmaXJzdEluamVjdG9yID0gcmVzb2x1dGlvblBhdGhbMF07CiAgICAgIGlmIChmaXJzdEluamVjdG9yIGluc3RhbmNlb2YgTm9kZUluamVjdG9yKSB7CiAgICAgICAgY29uc3QgbW9kdWxlSW5qZWN0b3IgPSBnZXRNb2R1bGVJbmplY3Rvck9mTm9kZUluamVjdG9yKGZpcnN0SW5qZWN0b3IpOwogICAgICAgIGlmIChtb2R1bGVJbmplY3RvciA9PT0gbnVsbCkgewogICAgICAgICAgdGhyb3dFcnJvcjIoIk5vZGVJbmplY3RvciBtdXN0IGhhdmUgc29tZSBjb25uZWN0aW9uIHRvIHRoZSBtb2R1bGUgaW5qZWN0b3IgdHJlZSIpOwogICAgICAgIH0KICAgICAgICByZXNvbHV0aW9uUGF0aC5wdXNoKG1vZHVsZUluamVjdG9yKTsKICAgICAgICBnZXRJbmplY3RvclJlc29sdXRpb25QYXRoSGVscGVyKG1vZHVsZUluamVjdG9yLCByZXNvbHV0aW9uUGF0aCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc29sdXRpb25QYXRoOwogICAgfQogIH0gZWxzZSB7CiAgICByZXNvbHV0aW9uUGF0aC5wdXNoKHBhcmVudCk7CiAgICBnZXRJbmplY3RvclJlc29sdXRpb25QYXRoSGVscGVyKHBhcmVudCwgcmVzb2x1dGlvblBhdGgpOwogIH0KICByZXR1cm4gcmVzb2x1dGlvblBhdGg7Cn0KZnVuY3Rpb24gZ2V0SW5qZWN0b3JQYXJlbnQoaW5qZWN0b3IpIHsKICBpZiAoaW5qZWN0b3IgaW5zdGFuY2VvZiBSM0luamVjdG9yKSB7CiAgICByZXR1cm4gaW5qZWN0b3IucGFyZW50OwogIH0KICBsZXQgdE5vZGU7CiAgbGV0IGxWaWV3OwogIGlmIChpbmplY3RvciBpbnN0YW5jZW9mIE5vZGVJbmplY3RvcikgewogICAgdE5vZGUgPSBnZXROb2RlSW5qZWN0b3JUTm9kZShpbmplY3Rvcik7CiAgICBsVmlldyA9IGdldE5vZGVJbmplY3RvckxWaWV3KGluamVjdG9yKTsKICB9IGVsc2UgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTnVsbEluamVjdG9yKSB7CiAgICByZXR1cm4gbnVsbDsKICB9IGVsc2UgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgQ2hhaW5lZEluamVjdG9yKSB7CiAgICByZXR1cm4gaW5qZWN0b3IucGFyZW50SW5qZWN0b3I7CiAgfSBlbHNlIHsKICAgIHRocm93RXJyb3IyKCJnZXRJbmplY3RvclBhcmVudCBvbmx5IHN1cHBvcnQgaW5qZWN0b3JzIG9mIHR5cGUgUjNJbmplY3RvciwgTm9kZUluamVjdG9yLCBOdWxsSW5qZWN0b3IiKTsKICB9CiAgY29uc3QgcGFyZW50TG9jYXRpb24gPSBnZXRQYXJlbnRJbmplY3RvckxvY2F0aW9uKHROb2RlLCBsVmlldyk7CiAgaWYgKGhhc1BhcmVudEluamVjdG9yKHBhcmVudExvY2F0aW9uKSkgewogICAgY29uc3QgcGFyZW50SW5qZWN0b3JJbmRleCA9IGdldFBhcmVudEluamVjdG9ySW5kZXgocGFyZW50TG9jYXRpb24pOwogICAgY29uc3QgcGFyZW50TFZpZXcgPSBnZXRQYXJlbnRJbmplY3RvclZpZXcocGFyZW50TG9jYXRpb24sIGxWaWV3KTsKICAgIGNvbnN0IHBhcmVudFRWaWV3ID0gcGFyZW50TFZpZXdbVFZJRVddOwogICAgY29uc3QgcGFyZW50VE5vZGUgPSBwYXJlbnRUVmlldy5kYXRhW3BhcmVudEluamVjdG9ySW5kZXggKyA4XTsKICAgIHJldHVybiBuZXcgTm9kZUluamVjdG9yKHBhcmVudFROb2RlLCBwYXJlbnRMVmlldyk7CiAgfSBlbHNlIHsKICAgIGNvbnN0IGNoYWluZWRJbmplY3RvciA9IGxWaWV3W0lOSkVDVE9SXTsKICAgIGNvbnN0IGluamVjdG9yUGFyZW50ID0gY2hhaW5lZEluamVjdG9yLmluamVjdG9yPy5wYXJlbnQ7CiAgICBpZiAoaW5qZWN0b3JQYXJlbnQgaW5zdGFuY2VvZiBOb2RlSW5qZWN0b3IpIHsKICAgICAgcmV0dXJuIGluamVjdG9yUGFyZW50OwogICAgfQogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBnZXRNb2R1bGVJbmplY3Rvck9mTm9kZUluamVjdG9yKGluamVjdG9yKSB7CiAgbGV0IGxWaWV3OwogIGlmIChpbmplY3RvciBpbnN0YW5jZW9mIE5vZGVJbmplY3RvcikgewogICAgbFZpZXcgPSBnZXROb2RlSW5qZWN0b3JMVmlldyhpbmplY3Rvcik7CiAgfSBlbHNlIHsKICAgIHRocm93RXJyb3IyKCJnZXRNb2R1bGVJbmplY3Rvck9mTm9kZUluamVjdG9yIG11c3QgYmUgY2FsbGVkIHdpdGggYSBOb2RlSW5qZWN0b3IiKTsKICB9CiAgY29uc3QgaW5qID0gbFZpZXdbSU5KRUNUT1JdOwogIGNvbnN0IG1vZHVsZUluamVjdG9yID0gaW5qIGluc3RhbmNlb2YgQ2hhaW5lZEluamVjdG9yID8gaW5qLnBhcmVudEluamVjdG9yIDogaW5qLnBhcmVudDsKICBpZiAoIW1vZHVsZUluamVjdG9yKSB7CiAgICB0aHJvd0Vycm9yMigiTm9kZUluamVjdG9yIG11c3QgaGF2ZSBzb21lIGNvbm5lY3Rpb24gdG8gdGhlIG1vZHVsZSBpbmplY3RvciB0cmVlIik7CiAgfQogIHJldHVybiBtb2R1bGVJbmplY3RvcjsKfQpmdW5jdGlvbiBpc0NvbXB1dGVkTm9kZShub2RlKSB7CiAgcmV0dXJuIG5vZGUua2luZCA9PT0gImNvbXB1dGVkIjsKfQpmdW5jdGlvbiBpc1RlbXBsYXRlRWZmZWN0Tm9kZShub2RlKSB7CiAgcmV0dXJuIG5vZGUua2luZCA9PT0gInRlbXBsYXRlIjsKfQpmdW5jdGlvbiBpc1NpZ25hbE5vZGUobm9kZSkgewogIHJldHVybiBub2RlLmtpbmQgPT09ICJzaWduYWwiOwp9CmZ1bmN0aW9uIGdldFRlbXBsYXRlQ29uc3VtZXIoaW5qZWN0b3IpIHsKICBjb25zdCB0Tm9kZSA9IGdldE5vZGVJbmplY3RvclROb2RlKGluamVjdG9yKTsKICBhc3NlcnRUTm9kZSh0Tm9kZSk7CiAgY29uc3QgbFZpZXcgPSBnZXROb2RlSW5qZWN0b3JMVmlldyhpbmplY3Rvcik7CiAgYXNzZXJ0TFZpZXcobFZpZXcpOwogIGNvbnN0IHRlbXBsYXRlTFZpZXcgPSBsVmlld1t0Tm9kZS5pbmRleF07CiAgaWYgKGlzTFZpZXcodGVtcGxhdGVMVmlldykpIHsKICAgIHJldHVybiB0ZW1wbGF0ZUxWaWV3W1JFQUNUSVZFX1RFTVBMQVRFX0NPTlNVTUVSXSA/PyBudWxsOwogIH0KICByZXR1cm4gbnVsbDsKfQp2YXIgc2lnbmFsRGVidWdNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKdmFyIGNvdW50ZXIkMSA9IDA7CmZ1bmN0aW9uIGdldE5vZGVzQW5kRWRnZXNGcm9tU2lnbmFsTWFwKHNpZ25hbE1hcCkgewogIGNvbnN0IG5vZGVzID0gQXJyYXkuZnJvbShzaWduYWxNYXAua2V5cygpKTsKICBjb25zdCBkZWJ1Z1NpZ25hbEdyYXBoTm9kZXMgPSBbXTsKICBjb25zdCBlZGdlcyA9IFtdOwogIGZvciAoY29uc3QgW2NvbnN1bWVyLCBwcm9kdWNlcnNdIG9mIHNpZ25hbE1hcC5lbnRyaWVzKCkpIHsKICAgIGNvbnN0IGNvbnN1bWVySW5kZXggPSBub2Rlcy5pbmRleE9mKGNvbnN1bWVyKTsKICAgIGxldCBpZCA9IHNpZ25hbERlYnVnTWFwLmdldChjb25zdW1lcik7CiAgICBpZiAoIWlkKSB7CiAgICAgIGNvdW50ZXIkMSsrOwogICAgICBpZCA9IGNvdW50ZXIkMS50b1N0cmluZygpOwogICAgICBzaWduYWxEZWJ1Z01hcC5zZXQoY29uc3VtZXIsIGlkKTsKICAgIH0KICAgIGlmIChpc0NvbXB1dGVkTm9kZShjb25zdW1lcikpIHsKICAgICAgZGVidWdTaWduYWxHcmFwaE5vZGVzLnB1c2goewogICAgICAgIGxhYmVsOiBjb25zdW1lci5kZWJ1Z05hbWUsCiAgICAgICAgdmFsdWU6IGNvbnN1bWVyLnZhbHVlLAogICAgICAgIGtpbmQ6IGNvbnN1bWVyLmtpbmQsCiAgICAgICAgZXBvY2g6IGNvbnN1bWVyLnZlcnNpb24sCiAgICAgICAgZGVidWdnYWJsZUZuOiBjb25zdW1lci5jb21wdXRhdGlvbiwKICAgICAgICBpZAogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoaXNTaWduYWxOb2RlKGNvbnN1bWVyKSkgewogICAgICBkZWJ1Z1NpZ25hbEdyYXBoTm9kZXMucHVzaCh7CiAgICAgICAgbGFiZWw6IGNvbnN1bWVyLmRlYnVnTmFtZSwKICAgICAgICB2YWx1ZTogY29uc3VtZXIudmFsdWUsCiAgICAgICAga2luZDogY29uc3VtZXIua2luZCwKICAgICAgICBlcG9jaDogY29uc3VtZXIudmVyc2lvbiwKICAgICAgICBpZAogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoaXNUZW1wbGF0ZUVmZmVjdE5vZGUoY29uc3VtZXIpKSB7CiAgICAgIGRlYnVnU2lnbmFsR3JhcGhOb2Rlcy5wdXNoKHsKICAgICAgICBsYWJlbDogY29uc3VtZXIuZGVidWdOYW1lID8/IGNvbnN1bWVyLmxWaWV3Py5bSE9TVF0/LnRhZ05hbWU/LnRvTG93ZXJDYXNlPy4oKSwKICAgICAgICBraW5kOiBjb25zdW1lci5raW5kLAogICAgICAgIGVwb2NoOiBjb25zdW1lci52ZXJzaW9uLAogICAgICAgIGRlYnVnZ2FibGVGbjogY29uc3VtZXIubFZpZXc/LltDT05URVhUXT8uY29uc3RydWN0b3IsCiAgICAgICAgaWQKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBkZWJ1Z1NpZ25hbEdyYXBoTm9kZXMucHVzaCh7CiAgICAgICAgbGFiZWw6IGNvbnN1bWVyLmRlYnVnTmFtZSwKICAgICAgICBraW5kOiBjb25zdW1lci5raW5kLAogICAgICAgIGVwb2NoOiBjb25zdW1lci52ZXJzaW9uLAogICAgICAgIGlkCiAgICAgIH0pOwogICAgfQogICAgZm9yIChjb25zdCBwcm9kdWNlciBvZiBwcm9kdWNlcnMpIHsKICAgICAgZWRnZXMucHVzaCh7CiAgICAgICAgY29uc3VtZXI6IGNvbnN1bWVySW5kZXgsCiAgICAgICAgcHJvZHVjZXI6IG5vZGVzLmluZGV4T2YocHJvZHVjZXIpCiAgICAgIH0pOwogICAgfQogIH0KICByZXR1cm4gewogICAgbm9kZXM6IGRlYnVnU2lnbmFsR3JhcGhOb2RlcywKICAgIGVkZ2VzCiAgfTsKfQpmdW5jdGlvbiBleHRyYWN0RWZmZWN0c0Zyb21JbmplY3RvcihpbmplY3RvcikgewogIGxldCBkaVJlc29sdmVyID0gaW5qZWN0b3I7CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTm9kZUluamVjdG9yKSB7CiAgICBjb25zdCBsVmlldyA9IGdldE5vZGVJbmplY3RvckxWaWV3KGluamVjdG9yKTsKICAgIGRpUmVzb2x2ZXIgPSBsVmlldzsKICB9CiAgY29uc3QgcmVzb2x2ZXJUb0VmZmVjdHMgPSBnZXRGcmFtZXdvcmtESURlYnVnRGF0YSgpLnJlc29sdmVyVG9FZmZlY3RzOwogIGNvbnN0IGVmZmVjdHMgPSByZXNvbHZlclRvRWZmZWN0cy5nZXQoZGlSZXNvbHZlcikgPz8gW107CiAgcmV0dXJuIGVmZmVjdHMubWFwKChlZmZlY3QyKSA9PiB7CiAgICBpZiAoZWZmZWN0MiBpbnN0YW5jZW9mIEVmZmVjdFJlZkltcGwpIHsKICAgICAgcmV0dXJuIGVmZmVjdDJbU0lHTkFMXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBlZmZlY3QyLnNpZ25hbFtTSUdOQUxdOwogICAgfQogIH0pOwp9CmZ1bmN0aW9uIGV4dHJhY3RTaWduYWxOb2Rlc0FuZEVkZ2VzRnJvbVJvb3RzKG5vZGVzLCBzaWduYWxEZXBlbmRlbmNpZXNNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKSB7CiAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7CiAgICBpZiAoc2lnbmFsRGVwZW5kZW5jaWVzTWFwLmhhcyhub2RlKSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGNvbnN0IHByb2R1Y2VyTm9kZXMgPSBbXTsKICAgIGZvciAobGV0IGxpbmsgPSBub2RlLnByb2R1Y2VyczsgbGluayAhPT0gdm9pZCAwOyBsaW5rID0gbGluay5uZXh0UHJvZHVjZXIpIHsKICAgICAgY29uc3QgcHJvZHVjZXIgPSBsaW5rLnByb2R1Y2VyOwogICAgICBwcm9kdWNlck5vZGVzLnB1c2gocHJvZHVjZXIpOwogICAgfQogICAgc2lnbmFsRGVwZW5kZW5jaWVzTWFwLnNldChub2RlLCBwcm9kdWNlck5vZGVzKTsKICAgIGV4dHJhY3RTaWduYWxOb2Rlc0FuZEVkZ2VzRnJvbVJvb3RzKHByb2R1Y2VyTm9kZXMsIHNpZ25hbERlcGVuZGVuY2llc01hcCk7CiAgfQogIHJldHVybiBzaWduYWxEZXBlbmRlbmNpZXNNYXA7Cn0KZnVuY3Rpb24gZ2V0U2lnbmFsR3JhcGgoaW5qZWN0b3IpIHsKICBsZXQgdGVtcGxhdGVDb25zdW1lciA9IG51bGw7CiAgaWYgKCEoaW5qZWN0b3IgaW5zdGFuY2VvZiBOb2RlSW5qZWN0b3IpICYmICEoaW5qZWN0b3IgaW5zdGFuY2VvZiBSM0luamVjdG9yKSkgewogICAgcmV0dXJuIHRocm93RXJyb3IyKCJnZXRTaWduYWxHcmFwaCBtdXN0IGJlIGNhbGxlZCB3aXRoIGEgTm9kZUluamVjdG9yIG9yIFIzSW5qZWN0b3IiKTsKICB9CiAgaWYgKGluamVjdG9yIGluc3RhbmNlb2YgTm9kZUluamVjdG9yKSB7CiAgICB0ZW1wbGF0ZUNvbnN1bWVyID0gZ2V0VGVtcGxhdGVDb25zdW1lcihpbmplY3Rvcik7CiAgfQogIGNvbnN0IG5vblRlbXBsYXRlRWZmZWN0Tm9kZXMgPSBleHRyYWN0RWZmZWN0c0Zyb21JbmplY3RvcihpbmplY3Rvcik7CiAgY29uc3Qgc2lnbmFsTm9kZXMgPSB0ZW1wbGF0ZUNvbnN1bWVyID8gW3RlbXBsYXRlQ29uc3VtZXIsIC4uLm5vblRlbXBsYXRlRWZmZWN0Tm9kZXNdIDogbm9uVGVtcGxhdGVFZmZlY3ROb2RlczsKICBjb25zdCBzaWduYWxEZXBlbmRlbmNpZXNNYXAgPSBleHRyYWN0U2lnbmFsTm9kZXNBbmRFZGdlc0Zyb21Sb290cyhzaWduYWxOb2Rlcyk7CiAgcmV0dXJuIGdldE5vZGVzQW5kRWRnZXNGcm9tU2lnbmFsTWFwKHNpZ25hbERlcGVuZGVuY2llc01hcCk7Cn0KdmFyIGNoYW5nZURldGVjdGlvblJ1bnMgPSAwOwp2YXIgY2hhbmdlRGV0ZWN0aW9uU3luY1J1bnMgPSAwOwp2YXIgY291bnRlciA9IDA7CnZhciBldmVudHNTdGFjayA9IFtdOwpmdW5jdGlvbiBtZWFzdXJlU3RhcnQoc3RhcnRFdmVudCkgewogIGV2ZW50c1N0YWNrLnB1c2goW3N0YXJ0RXZlbnQsIGNvdW50ZXJdKTsKICBjb25zb2xlLnRpbWVTdGFtcCgiRXZlbnRfIiArIHN0YXJ0RXZlbnQgKyAiXyIgKyBjb3VudGVyKyspOwp9CmZ1bmN0aW9uIG1lYXN1cmVFbmQoc3RhcnRFdmVudCwgZW50cnlOYW1lLCBjb2xvcikgewogIGxldCB0b3A7CiAgZG8gewogICAgdG9wID0gZXZlbnRzU3RhY2sucG9wKCk7CiAgICBhc3NlcnREZWZpbmVkKHRvcCwgIlByb2ZpbGluZyBlcnJvcjogY291bGQgbm90IGZpbmQgc3RhcnQgZXZlbnQgZW50cnkgIiArIHN0YXJ0RXZlbnQpOwogIH0gd2hpbGUgKHRvcFswXSAhPT0gc3RhcnRFdmVudCk7CiAgY29uc29sZS50aW1lU3RhbXAoZW50cnlOYW1lLCAiRXZlbnRfIiArIHRvcFswXSArICJfIiArIHRvcFsxXSwgdm9pZCAwLCAi8J+FsO+4jyBBbmd1bGFyIiwgdm9pZCAwLCBjb2xvcik7Cn0KdmFyIGNocm9tZURldlRvb2xzSW5qZWN0b3JQcm9maWxlciA9IChldmVudCkgPT4gewogIGNvbnN0IGV2ZW50VHlwZSA9IGV2ZW50LnR5cGU7CiAgaWYgKGV2ZW50VHlwZSA9PT0gNSkgewogICAgbWVhc3VyZVN0YXJ0KDEwMCk7CiAgfSBlbHNlIGlmIChldmVudFR5cGUgPT09IDEpIHsKICAgIGNvbnN0IHRva2VuID0gZXZlbnQuY29udGV4dC50b2tlbjsKICAgIG1lYXN1cmVFbmQoMTAwLCBnZXRQcm92aWRlclRva2VuTWVhc3VyZU5hbWUodG9rZW4pLCAidGVydGlhcnktZGFyayIpOwogIH0KfTsKdmFyIGRldlRvb2xzUHJvZmlsZXIgPSAoZXZlbnQsIGluc3RhbmNlLCBldmVudEZuKSA9PiB7CiAgc3dpdGNoIChldmVudCkgewogICAgY2FzZSBQcm9maWxlckV2ZW50LkJvb3RzdHJhcEFwcGxpY2F0aW9uU3RhcnQ6CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuQm9vdHN0cmFwQ29tcG9uZW50U3RhcnQ6CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuQ2hhbmdlRGV0ZWN0aW9uU3RhcnQ6CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuQ2hhbmdlRGV0ZWN0aW9uU3luY1N0YXJ0OgogICAgY2FzZSBQcm9maWxlckV2ZW50LkFmdGVyUmVuZGVySG9va3NTdGFydDoKICAgIGNhc2UgUHJvZmlsZXJFdmVudC5Db21wb25lbnRTdGFydDoKICAgIGNhc2UgUHJvZmlsZXJFdmVudC5EZWZlckJsb2NrU3RhdGVTdGFydDoKICAgIGNhc2UgUHJvZmlsZXJFdmVudC5EeW5hbWljQ29tcG9uZW50U3RhcnQ6CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVDcmVhdGVTdGFydDoKICAgIGNhc2UgUHJvZmlsZXJFdmVudC5MaWZlY3ljbGVIb29rU3RhcnQ6CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVVcGRhdGVTdGFydDoKICAgIGNhc2UgUHJvZmlsZXJFdmVudC5Ib3N0QmluZGluZ3NVcGRhdGVTdGFydDoKICAgIGNhc2UgUHJvZmlsZXJFdmVudC5PdXRwdXRTdGFydDogewogICAgICBtZWFzdXJlU3RhcnQoZXZlbnQpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUHJvZmlsZXJFdmVudC5Cb290c3RyYXBBcHBsaWNhdGlvbkVuZDogewogICAgICBtZWFzdXJlRW5kKFByb2ZpbGVyRXZlbnQuQm9vdHN0cmFwQXBwbGljYXRpb25TdGFydCwgIkJvb3RzdHJhcCBhcHBsaWNhdGlvbiIsICJwcmltYXJ5LWRhcmsiKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuQm9vdHN0cmFwQ29tcG9uZW50RW5kOiB7CiAgICAgIG1lYXN1cmVFbmQoUHJvZmlsZXJFdmVudC5Cb290c3RyYXBDb21wb25lbnRTdGFydCwgIkJvb3RzdHJhcCBjb21wb25lbnQiLCAicHJpbWFyeS1kYXJrIik7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBQcm9maWxlckV2ZW50LkNoYW5nZURldGVjdGlvbkVuZDogewogICAgICBjaGFuZ2VEZXRlY3Rpb25TeW5jUnVucyA9IDA7CiAgICAgIG1lYXN1cmVFbmQoUHJvZmlsZXJFdmVudC5DaGFuZ2VEZXRlY3Rpb25TdGFydCwgIkNoYW5nZSBkZXRlY3Rpb24gIiArIGNoYW5nZURldGVjdGlvblJ1bnMrKywgInByaW1hcnktZGFyayIpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUHJvZmlsZXJFdmVudC5DaGFuZ2VEZXRlY3Rpb25TeW5jRW5kOiB7CiAgICAgIG1lYXN1cmVFbmQoUHJvZmlsZXJFdmVudC5DaGFuZ2VEZXRlY3Rpb25TeW5jU3RhcnQsICJTeW5jaHJvbml6YXRpb24gIiArIGNoYW5nZURldGVjdGlvblN5bmNSdW5zKyssICJwcmltYXJ5Iik7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBQcm9maWxlckV2ZW50LkFmdGVyUmVuZGVySG9va3NFbmQ6IHsKICAgICAgbWVhc3VyZUVuZChQcm9maWxlckV2ZW50LkFmdGVyUmVuZGVySG9va3NTdGFydCwgIkFmdGVyIHJlbmRlciBob29rcyIsICJwcmltYXJ5Iik7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBQcm9maWxlckV2ZW50LkNvbXBvbmVudEVuZDogewogICAgICBjb25zdCB0eXBlTmFtZSA9IGdldENvbXBvbmVudE1lYXN1cmVOYW1lKGluc3RhbmNlKTsKICAgICAgbWVhc3VyZUVuZChQcm9maWxlckV2ZW50LkNvbXBvbmVudFN0YXJ0LCB0eXBlTmFtZSwgInByaW1hcnktbGlnaHQiKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuRGVmZXJCbG9ja1N0YXRlRW5kOiB7CiAgICAgIG1lYXN1cmVFbmQoUHJvZmlsZXJFdmVudC5EZWZlckJsb2NrU3RhdGVTdGFydCwgIkRlZmVyIGJsb2NrIiwgInByaW1hcnktZGFyayIpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUHJvZmlsZXJFdmVudC5EeW5hbWljQ29tcG9uZW50RW5kOiB7CiAgICAgIG1lYXN1cmVFbmQoUHJvZmlsZXJFdmVudC5EeW5hbWljQ29tcG9uZW50U3RhcnQsICJEeW5hbWljIGNvbXBvbmVudCBjcmVhdGlvbiIsICJwcmltYXJ5LWRhcmsiKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVVcGRhdGVFbmQ6IHsKICAgICAgbWVhc3VyZUVuZChQcm9maWxlckV2ZW50LlRlbXBsYXRlVXBkYXRlU3RhcnQsIHN0cmluZ2lmeUZvckVycm9yKGV2ZW50Rm4pICsgIiAodXBkYXRlKSIsICJzZWNvbmRhcnktZGFyayIpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUHJvZmlsZXJFdmVudC5UZW1wbGF0ZUNyZWF0ZUVuZDogewogICAgICBtZWFzdXJlRW5kKFByb2ZpbGVyRXZlbnQuVGVtcGxhdGVDcmVhdGVTdGFydCwgc3RyaW5naWZ5Rm9yRXJyb3IoZXZlbnRGbikgKyAiIChjcmVhdGUpIiwgInNlY29uZGFyeSIpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUHJvZmlsZXJFdmVudC5Ib3N0QmluZGluZ3NVcGRhdGVFbmQ6IHsKICAgICAgbWVhc3VyZUVuZChQcm9maWxlckV2ZW50Lkhvc3RCaW5kaW5nc1VwZGF0ZVN0YXJ0LCAiSG9zdEJpbmRpbmdzIiwgInNlY29uZGFyeS1kYXJrIik7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBQcm9maWxlckV2ZW50LkxpZmVjeWNsZUhvb2tFbmQ6IHsKICAgICAgY29uc3QgdHlwZU5hbWUgPSBnZXRDb21wb25lbnRNZWFzdXJlTmFtZShpbnN0YW5jZSk7CiAgICAgIG1lYXN1cmVFbmQoUHJvZmlsZXJFdmVudC5MaWZlY3ljbGVIb29rU3RhcnQsIGAke3R5cGVOYW1lfToke3N0cmluZ2lmeUZvckVycm9yKGV2ZW50Rm4pfWAsICJ0ZXJ0aWFyeSIpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUHJvZmlsZXJFdmVudC5PdXRwdXRFbmQ6IHsKICAgICAgbWVhc3VyZUVuZChQcm9maWxlckV2ZW50Lk91dHB1dFN0YXJ0LCBzdHJpbmdpZnlGb3JFcnJvcihldmVudEZuKSwgInRlcnRpYXJ5LWxpZ2h0Iik7CiAgICAgIGJyZWFrOwogICAgfQogICAgZGVmYXVsdDogewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgcHJvZmlsaW5nIGV2ZW50IHR5cGU6ICIgKyBldmVudCk7CiAgICB9CiAgfQp9OwpmdW5jdGlvbiBnZXRDb21wb25lbnRNZWFzdXJlTmFtZShpbnN0YW5jZSkgewogIHJldHVybiBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5uYW1lOwp9CmZ1bmN0aW9uIGdldFByb3ZpZGVyVG9rZW5NZWFzdXJlTmFtZSh0b2tlbikgewogIGlmIChpc1R5cGVQcm92aWRlcih0b2tlbikpIHsKICAgIHJldHVybiB0b2tlbi5uYW1lOwogIH0gZWxzZSBpZiAodG9rZW4ucHJvdmlkZSAhPSBudWxsKSB7CiAgICByZXR1cm4gZ2V0UHJvdmlkZXJUb2tlbk1lYXN1cmVOYW1lKHRva2VuLnByb3ZpZGUpOwogIH0KICByZXR1cm4gdG9rZW4udG9TdHJpbmcoKTsKfQpmdW5jdGlvbiBlbmFibGVQcm9maWxpbmcoKSB7CiAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiQ2hyb21lIERldlRvb2xzIHByb2ZpbGluZyIpOwogIGlmICh0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUpIHsKICAgIGNvbnN0IHJlbW92ZUluamVjdG9yUHJvZmlsZXIgPSBzZXRJbmplY3RvclByb2ZpbGVyKGNocm9tZURldlRvb2xzSW5qZWN0b3JQcm9maWxlcik7CiAgICBjb25zdCByZW1vdmVQcm9maWxlcjMgPSBzZXRQcm9maWxlcihkZXZUb29sc1Byb2ZpbGVyKTsKICAgIHJldHVybiAoKSA9PiB7CiAgICAgIHJlbW92ZUluamVjdG9yUHJvZmlsZXIoKTsKICAgICAgcmVtb3ZlUHJvZmlsZXIzKCk7CiAgICB9OwogIH0KICByZXR1cm4gKCkgPT4gewogIH07Cn0KZnVuY3Rpb24gZ2V0VHJhbnNmZXJTdGF0ZShpbmplY3RvcikgewogIGNvbnN0IGRvYyA9IGluamVjdG9yLmdldChET0NVTUVOVCk7CiAgY29uc3QgYXBwSWQgPSBpbmplY3Rvci5nZXQoQVBQX0lEKTsKICBjb25zdCB0cmFuc2ZlclN0YXRlID0gcmV0cmlldmVUcmFuc2ZlcnJlZFN0YXRlKGRvYywgYXBwSWQpOwogIGNvbnN0IGZpbHRlcmVkRW50cmllcyA9IHt9OwogIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRyYW5zZmVyU3RhdGUpKSB7CiAgICBpZiAoIWlzSW50ZXJuYWxIeWRyYXRpb25UcmFuc2ZlclN0YXRlS2V5KGtleSkpIHsKICAgICAgZmlsdGVyZWRFbnRyaWVzW2tleV0gPSB2YWx1ZTsKICAgIH0KICB9CiAgcmV0dXJuIGZpbHRlcmVkRW50cmllczsKfQp2YXIgR0xPQkFMX1BVQkxJU0hfRVhQQU5ET19LRVkgPSAibmciOwp2YXIgZ2xvYmFsVXRpbHNGdW5jdGlvbnMgPSB7CiAgIsm1Z2V0RGVwZW5kZW5jaWVzRnJvbUluamVjdGFibGUiOiBnZXREZXBlbmRlbmNpZXNGcm9tSW5qZWN0YWJsZSwKICAiybVnZXRJbmplY3RvclByb3ZpZGVycyI6IGdldEluamVjdG9yUHJvdmlkZXJzLAogICLJtWdldEluamVjdG9yUmVzb2x1dGlvblBhdGgiOiBnZXRJbmplY3RvclJlc29sdXRpb25QYXRoLAogICLJtWdldEluamVjdG9yTWV0YWRhdGEiOiBnZXRJbmplY3Rvck1ldGFkYXRhLAogICLJtXNldFByb2ZpbGVyIjogc2V0UHJvZmlsZXIsCiAgIsm1Z2V0U2lnbmFsR3JhcGgiOiBnZXRTaWduYWxHcmFwaCwKICAiybVnZXREZWZlckJsb2NrcyI6IGdldERlZmVyQmxvY2tzLAogICLJtWdldFRyYW5zZmVyU3RhdGUiOiBnZXRUcmFuc2ZlclN0YXRlLAogICJnZXREaXJlY3RpdmVNZXRhZGF0YSI6IGdldERpcmVjdGl2ZU1ldGFkYXRhJDEsCiAgImdldENvbXBvbmVudCI6IGdldENvbXBvbmVudCwKICAiZ2V0Q29udGV4dCI6IGdldENvbnRleHQsCiAgImdldExpc3RlbmVycyI6IGdldExpc3RlbmVycywKICAiZ2V0T3duaW5nQ29tcG9uZW50IjogZ2V0T3duaW5nQ29tcG9uZW50LAogICJnZXRIb3N0RWxlbWVudCI6IGdldEhvc3RFbGVtZW50LAogICJnZXRJbmplY3RvciI6IGdldEluamVjdG9yLAogICJnZXRSb290Q29tcG9uZW50cyI6IGdldFJvb3RDb21wb25lbnRzLAogICJnZXREaXJlY3RpdmVzIjogZ2V0RGlyZWN0aXZlcywKICAiYXBwbHlDaGFuZ2VzIjogYXBwbHlDaGFuZ2VzLAogICJpc1NpZ25hbCI6IGlzU2lnbmFsMiwKICAiZW5hYmxlUHJvZmlsaW5nIjogZW5hYmxlUHJvZmlsaW5nCn07CnZhciBfcHVibGlzaGVkID0gZmFsc2U7CmZ1bmN0aW9uIHB1Ymxpc2hEZWZhdWx0R2xvYmFsVXRpbHMkMSgpIHsKICBpZiAoIV9wdWJsaXNoZWQpIHsKICAgIF9wdWJsaXNoZWQgPSB0cnVlOwogICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHNldHVwRnJhbWV3b3JrSW5qZWN0b3JQcm9maWxlcigpOwogICAgfQogICAgZm9yIChjb25zdCBbbWV0aG9kTmFtZSwgbWV0aG9kXSBvZiBPYmplY3QuZW50cmllcyhnbG9iYWxVdGlsc0Z1bmN0aW9ucykpIHsKICAgICAgcHVibGlzaEdsb2JhbFV0aWwobWV0aG9kTmFtZSwgbWV0aG9kKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gcHVibGlzaEdsb2JhbFV0aWwobmFtZSwgZm4pIHsKICBwdWJsaXNoVXRpbChuYW1lLCBmbik7Cn0KZnVuY3Rpb24gcHVibGlzaEV4dGVybmFsR2xvYmFsVXRpbChuYW1lLCBmbikgewogIHB1Ymxpc2hVdGlsKG5hbWUsIGZuKTsKfQpmdW5jdGlvbiBwdWJsaXNoVXRpbChuYW1lLCBmbikgewogIGlmICh0eXBlb2YgQ09NUElMRUQgPT09ICJ1bmRlZmluZWQiIHx8ICFDT01QSUxFRCkgewogICAgY29uc3QgdyA9IF9nbG9iYWw7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChmbiwgImZ1bmN0aW9uIG5vdCBkZWZpbmVkIik7CiAgICB3W0dMT0JBTF9QVUJMSVNIX0VYUEFORE9fS0VZXSA/Pz0ge307CiAgICB3W0dMT0JBTF9QVUJMSVNIX0VYUEFORE9fS0VZXVtuYW1lXSA9IGZuOwogIH0KfQp2YXIgVEVTVEFCSUxJVFkgPSBuZXcgSW5qZWN0aW9uVG9rZW4oIiIpOwp2YXIgVEVTVEFCSUxJVFlfR0VUVEVSID0gbmV3IEluamVjdGlvblRva2VuKCIiKTsKdmFyIFRlc3RhYmlsaXR5ID0gY2xhc3MgX1Rlc3RhYmlsaXR5IHsKICBfbmdab25lOwogIHJlZ2lzdHJ5OwogIF9pc1pvbmVTdGFibGUgPSB0cnVlOwogIF9jYWxsYmFja3MgPSBbXTsKICBfdGFza1RyYWNraW5nWm9uZSA9IG51bGw7CiAgX2Rlc3Ryb3lSZWY7CiAgY29uc3RydWN0b3IoX25nWm9uZSwgcmVnaXN0cnksIHRlc3RhYmlsaXR5R2V0dGVyKSB7CiAgICB0aGlzLl9uZ1pvbmUgPSBfbmdab25lOwogICAgdGhpcy5yZWdpc3RyeSA9IHJlZ2lzdHJ5OwogICAgaWYgKGlzSW5JbmplY3Rpb25Db250ZXh0KCkpIHsKICAgICAgdGhpcy5fZGVzdHJveVJlZiA9IGluamVjdDIoRGVzdHJveVJlZiwgewogICAgICAgIG9wdGlvbmFsOiB0cnVlCiAgICAgIH0pID8/IHZvaWQgMDsKICAgIH0KICAgIGlmICghX3Rlc3RhYmlsaXR5R2V0dGVyKSB7CiAgICAgIHNldFRlc3RhYmlsaXR5R2V0dGVyKHRlc3RhYmlsaXR5R2V0dGVyKTsKICAgICAgdGVzdGFiaWxpdHlHZXR0ZXIuYWRkVG9XaW5kb3cocmVnaXN0cnkpOwogICAgfQogICAgdGhpcy5fd2F0Y2hBbmd1bGFyRXZlbnRzKCk7CiAgICBfbmdab25lLnJ1bigoKSA9PiB7CiAgICAgIHRoaXMuX3Rhc2tUcmFja2luZ1pvbmUgPSB0eXBlb2YgWm9uZSA9PSAidW5kZWZpbmVkIiA/IG51bGwgOiBab25lLmN1cnJlbnQuZ2V0KCJUYXNrVHJhY2tpbmdab25lIik7CiAgICB9KTsKICB9CiAgX3dhdGNoQW5ndWxhckV2ZW50cygpIHsKICAgIGNvbnN0IG9uVW5zdGFibGVTdWJzY3JpcHRpb24gPSB0aGlzLl9uZ1pvbmUub25VbnN0YWJsZS5zdWJzY3JpYmUoewogICAgICBuZXh0OiAoKSA9PiB7CiAgICAgICAgdGhpcy5faXNab25lU3RhYmxlID0gZmFsc2U7CiAgICAgIH0KICAgIH0pOwogICAgY29uc3Qgb25TdGFibGVTdWJzY3JpcHRpb24gPSB0aGlzLl9uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5fbmdab25lLm9uU3RhYmxlLnN1YnNjcmliZSh7CiAgICAgIG5leHQ6ICgpID0+IHsKICAgICAgICBOZ1pvbmUuYXNzZXJ0Tm90SW5Bbmd1bGFyWm9uZSgpOwogICAgICAgIHF1ZXVlTWljcm90YXNrKCgpID0+IHsKICAgICAgICAgIHRoaXMuX2lzWm9uZVN0YWJsZSA9IHRydWU7CiAgICAgICAgICB0aGlzLl9ydW5DYWxsYmFja3NJZlJlYWR5KCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pKTsKICAgIHRoaXMuX2Rlc3Ryb3lSZWY/Lm9uRGVzdHJveSgoKSA9PiB7CiAgICAgIG9uVW5zdGFibGVTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTsKICAgICAgb25TdGFibGVTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTsKICAgIH0pOwogIH0KICBpc1N0YWJsZSgpIHsKICAgIHJldHVybiB0aGlzLl9pc1pvbmVTdGFibGUgJiYgIXRoaXMuX25nWm9uZS5oYXNQZW5kaW5nTWFjcm90YXNrczsKICB9CiAgX3J1bkNhbGxiYWNrc0lmUmVhZHkoKSB7CiAgICBpZiAodGhpcy5pc1N0YWJsZSgpKSB7CiAgICAgIHF1ZXVlTWljcm90YXNrKCgpID0+IHsKICAgICAgICB3aGlsZSAodGhpcy5fY2FsbGJhY2tzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgbGV0IGNiID0gdGhpcy5fY2FsbGJhY2tzLnBvcCgpOwogICAgICAgICAgY2xlYXJUaW1lb3V0KGNiLnRpbWVvdXRJZCk7CiAgICAgICAgICBjYi5kb25lQ2IoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgbGV0IHBlbmRpbmcgPSB0aGlzLmdldFBlbmRpbmdUYXNrcygpOwogICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MuZmlsdGVyKChjYikgPT4gewogICAgICAgIGlmIChjYi51cGRhdGVDYiAmJiBjYi51cGRhdGVDYihwZW5kaW5nKSkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KGNiLnRpbWVvdXRJZCk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9KTsKICAgIH0KICB9CiAgZ2V0UGVuZGluZ1Rhc2tzKCkgewogICAgaWYgKCF0aGlzLl90YXNrVHJhY2tpbmdab25lKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIHJldHVybiB0aGlzLl90YXNrVHJhY2tpbmdab25lLm1hY3JvVGFza3MubWFwKCh0KSA9PiB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc291cmNlOiB0LnNvdXJjZSwKICAgICAgICBjcmVhdGlvbkxvY2F0aW9uOiB0LmNyZWF0aW9uTG9jYXRpb24sCiAgICAgICAgZGF0YTogdC5kYXRhCiAgICAgIH07CiAgICB9KTsKICB9CiAgYWRkQ2FsbGJhY2soY2IsIHRpbWVvdXQyLCB1cGRhdGVDYikgewogICAgbGV0IHRpbWVvdXRJZCA9IC0xOwogICAgaWYgKHRpbWVvdXQyICYmIHRpbWVvdXQyID4gMCkgewogICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MuZmlsdGVyKChjYjIpID0+IGNiMi50aW1lb3V0SWQgIT09IHRpbWVvdXRJZCk7CiAgICAgICAgY2IoKTsKICAgICAgfSwgdGltZW91dDIpOwogICAgfQogICAgdGhpcy5fY2FsbGJhY2tzLnB1c2goewogICAgICBkb25lQ2I6IGNiLAogICAgICB0aW1lb3V0SWQsCiAgICAgIHVwZGF0ZUNiCiAgICB9KTsKICB9CiAgd2hlblN0YWJsZShkb25lQ2IsIHRpbWVvdXQyLCB1cGRhdGVDYikgewogICAgaWYgKHVwZGF0ZUNiICYmICF0aGlzLl90YXNrVHJhY2tpbmdab25lKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVGFzayB0cmFja2luZyB6b25lIGlzIHJlcXVpcmVkIHdoZW4gcGFzc2luZyBhbiB1cGRhdGUgY2FsbGJhY2sgdG8gd2hlblN0YWJsZSgpLiBJcyAiem9uZS5qcy9wbHVnaW5zL3Rhc2stdHJhY2tpbmciIGxvYWRlZD8nKTsKICAgIH0KICAgIHRoaXMuYWRkQ2FsbGJhY2soZG9uZUNiLCB0aW1lb3V0MiwgdXBkYXRlQ2IpOwogICAgdGhpcy5fcnVuQ2FsbGJhY2tzSWZSZWFkeSgpOwogIH0KICByZWdpc3RlckFwcGxpY2F0aW9uKHRva2VuKSB7CiAgICB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVyQXBwbGljYXRpb24odG9rZW4sIHRoaXMpOwogIH0KICB1bnJlZ2lzdGVyQXBwbGljYXRpb24odG9rZW4pIHsKICAgIHRoaXMucmVnaXN0cnkudW5yZWdpc3RlckFwcGxpY2F0aW9uKHRva2VuKTsKICB9CiAgZmluZFByb3ZpZGVycyh1c2luZzIsIHByb3ZpZGVyLCBleGFjdE1hdGNoKSB7CiAgICByZXR1cm4gW107CiAgfQogIHN0YXRpYyDJtWZhYyA9IGZ1bmN0aW9uIFRlc3RhYmlsaXR5X0ZhY3RvcnkoX19uZ0ZhY3RvcnlUeXBlX18pIHsKICAgIHJldHVybiBuZXcgKF9fbmdGYWN0b3J5VHlwZV9fIHx8IF9UZXN0YWJpbGl0eSkoybXJtWluamVjdChOZ1pvbmUpLCDJtcm1aW5qZWN0KFRlc3RhYmlsaXR5UmVnaXN0cnkpLCDJtcm1aW5qZWN0KFRFU1RBQklMSVRZX0dFVFRFUikpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfVGVzdGFiaWxpdHksCiAgICBmYWN0b3J5OiBfVGVzdGFiaWxpdHkuybVmYWMKICB9KTsKfTsKKCgpID0+IHsKICAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBzZXRDbGFzc01ldGFkYXRhKFRlc3RhYmlsaXR5LCBbewogICAgdHlwZTogSW5qZWN0YWJsZQogIH1dLCAoKSA9PiBbewogICAgdHlwZTogTmdab25lCiAgfSwgewogICAgdHlwZTogVGVzdGFiaWxpdHlSZWdpc3RyeQogIH0sIHsKICAgIHR5cGU6IHZvaWQgMCwKICAgIGRlY29yYXRvcnM6IFt7CiAgICAgIHR5cGU6IEluamVjdCwKICAgICAgYXJnczogW1RFU1RBQklMSVRZX0dFVFRFUl0KICAgIH1dCiAgfV0sIG51bGwpOwp9KSgpOwp2YXIgVGVzdGFiaWxpdHlSZWdpc3RyeSA9IGNsYXNzIF9UZXN0YWJpbGl0eVJlZ2lzdHJ5IHsKICBfYXBwbGljYXRpb25zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICByZWdpc3RlckFwcGxpY2F0aW9uKHRva2VuLCB0ZXN0YWJpbGl0eSkgewogICAgdGhpcy5fYXBwbGljYXRpb25zLnNldCh0b2tlbiwgdGVzdGFiaWxpdHkpOwogIH0KICB1bnJlZ2lzdGVyQXBwbGljYXRpb24odG9rZW4pIHsKICAgIHRoaXMuX2FwcGxpY2F0aW9ucy5kZWxldGUodG9rZW4pOwogIH0KICB1bnJlZ2lzdGVyQWxsQXBwbGljYXRpb25zKCkgewogICAgdGhpcy5fYXBwbGljYXRpb25zLmNsZWFyKCk7CiAgfQogIGdldFRlc3RhYmlsaXR5KGVsZW0pIHsKICAgIHJldHVybiB0aGlzLl9hcHBsaWNhdGlvbnMuZ2V0KGVsZW0pIHx8IG51bGw7CiAgfQogIGdldEFsbFRlc3RhYmlsaXRpZXMoKSB7CiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9hcHBsaWNhdGlvbnMudmFsdWVzKCkpOwogIH0KICBnZXRBbGxSb290RWxlbWVudHMoKSB7CiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9hcHBsaWNhdGlvbnMua2V5cygpKTsKICB9CiAgZmluZFRlc3RhYmlsaXR5SW5UcmVlKGVsZW0sIGZpbmRJbkFuY2VzdG9ycyA9IHRydWUpIHsKICAgIHJldHVybiBfdGVzdGFiaWxpdHlHZXR0ZXI/LmZpbmRUZXN0YWJpbGl0eUluVHJlZSh0aGlzLCBlbGVtLCBmaW5kSW5BbmNlc3RvcnMpID8/IG51bGw7CiAgfQogIHN0YXRpYyDJtWZhYyA9IGZ1bmN0aW9uIFRlc3RhYmlsaXR5UmVnaXN0cnlfRmFjdG9yeShfX25nRmFjdG9yeVR5cGVfXykgewogICAgcmV0dXJuIG5ldyAoX19uZ0ZhY3RvcnlUeXBlX18gfHwgX1Rlc3RhYmlsaXR5UmVnaXN0cnkpKCk7CiAgfTsKICBzdGF0aWMgybVwcm92ID0gybXJtWRlZmluZUluamVjdGFibGUoewogICAgdG9rZW46IF9UZXN0YWJpbGl0eVJlZ2lzdHJ5LAogICAgZmFjdG9yeTogX1Rlc3RhYmlsaXR5UmVnaXN0cnkuybVmYWMsCiAgICBwcm92aWRlZEluOiAicGxhdGZvcm0iCiAgfSk7Cn07CigoKSA9PiB7CiAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgc2V0Q2xhc3NNZXRhZGF0YShUZXN0YWJpbGl0eVJlZ2lzdHJ5LCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJwbGF0Zm9ybSIKICAgIH1dCiAgfV0sIG51bGwsIG51bGwpOwp9KSgpOwpmdW5jdGlvbiBzZXRUZXN0YWJpbGl0eUdldHRlcihnZXR0ZXIpIHsKICBfdGVzdGFiaWxpdHlHZXR0ZXIgPSBnZXR0ZXI7Cn0KdmFyIF90ZXN0YWJpbGl0eUdldHRlcjsKZnVuY3Rpb24gaXNQcm9taXNlMihvYmopIHsKICByZXR1cm4gISFvYmogJiYgdHlwZW9mIG9iai50aGVuID09PSAiZnVuY3Rpb24iOwp9CmZ1bmN0aW9uIGlzU3Vic2NyaWJhYmxlKG9iaikgewogIHJldHVybiAhIW9iaiAmJiB0eXBlb2Ygb2JqLnN1YnNjcmliZSA9PT0gImZ1bmN0aW9uIjsKfQp2YXIgQVBQX0lOSVRJQUxJWkVSID0gbmV3IEluamVjdGlvblRva2VuKG5nRGV2TW9kZSA/ICJBcHBsaWNhdGlvbiBJbml0aWFsaXplciIgOiAiIik7CmZ1bmN0aW9uIHByb3ZpZGVBcHBJbml0aWFsaXplcihpbml0aWFsaXplckZuKSB7CiAgcmV0dXJuIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhbewogICAgcHJvdmlkZTogQVBQX0lOSVRJQUxJWkVSLAogICAgbXVsdGk6IHRydWUsCiAgICB1c2VWYWx1ZTogaW5pdGlhbGl6ZXJGbgogIH1dKTsKfQp2YXIgQXBwbGljYXRpb25Jbml0U3RhdHVzID0gY2xhc3MgX0FwcGxpY2F0aW9uSW5pdFN0YXR1cyB7CiAgcmVzb2x2ZTsKICByZWplY3Q7CiAgaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICBkb25lID0gZmFsc2U7CiAgZG9uZVByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsKICAgIHRoaXMucmVzb2x2ZSA9IHJlczsKICAgIHRoaXMucmVqZWN0ID0gcmVqOwogIH0pOwogIGFwcEluaXRzID0gaW5qZWN0MihBUFBfSU5JVElBTElaRVIsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSkgPz8gW107CiAgaW5qZWN0b3IgPSBpbmplY3QyKEluamVjdG9yKTsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICgodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiAhQXJyYXkuaXNBcnJheSh0aGlzLmFwcEluaXRzKSkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKC0yMDksIGBVbmV4cGVjdGVkIHR5cGUgb2YgdGhlIFxgQVBQX0lOSVRJQUxJWkVSXGAgdG9rZW4gdmFsdWUgKGV4cGVjdGVkIGFuIGFycmF5LCBidXQgZ290ICR7dHlwZW9mIHRoaXMuYXBwSW5pdHN9KS4gUGxlYXNlIGNoZWNrIHRoYXQgdGhlIFxgQVBQX0lOSVRJQUxJWkVSXGAgdG9rZW4gaXMgY29uZmlndXJlZCBhcyBhIFxgbXVsdGk6IHRydWVcYCBwcm92aWRlci5gKTsKICAgIH0KICB9CiAgcnVuSW5pdGlhbGl6ZXJzKCkgewogICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgYXN5bmNJbml0UHJvbWlzZXMgPSBbXTsKICAgIGZvciAoY29uc3QgYXBwSW5pdHMgb2YgdGhpcy5hcHBJbml0cykgewogICAgICBjb25zdCBpbml0UmVzdWx0ID0gcnVuSW5JbmplY3Rpb25Db250ZXh0KHRoaXMuaW5qZWN0b3IsIGFwcEluaXRzKTsKICAgICAgaWYgKGlzUHJvbWlzZTIoaW5pdFJlc3VsdCkpIHsKICAgICAgICBhc3luY0luaXRQcm9taXNlcy5wdXNoKGluaXRSZXN1bHQpOwogICAgICB9IGVsc2UgaWYgKGlzU3Vic2NyaWJhYmxlKGluaXRSZXN1bHQpKSB7CiAgICAgICAgY29uc3Qgb2JzZXJ2YWJsZUFzUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICAgIGluaXRSZXN1bHQuc3Vic2NyaWJlKHsKICAgICAgICAgICAgY29tcGxldGU6IHJlc29sdmUsCiAgICAgICAgICAgIGVycm9yOiByZWplY3QKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIGFzeW5jSW5pdFByb21pc2VzLnB1c2gob2JzZXJ2YWJsZUFzUHJvbWlzZSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGNvbXBsZXRlID0gKCkgPT4gewogICAgICB0aGlzLmRvbmUgPSB0cnVlOwogICAgICB0aGlzLnJlc29sdmUoKTsKICAgIH07CiAgICBQcm9taXNlLmFsbChhc3luY0luaXRQcm9taXNlcykudGhlbigoKSA9PiB7CiAgICAgIGNvbXBsZXRlKCk7CiAgICB9KS5jYXRjaCgoZSkgPT4gewogICAgICB0aGlzLnJlamVjdChlKTsKICAgIH0pOwogICAgaWYgKGFzeW5jSW5pdFByb21pc2VzLmxlbmd0aCA9PT0gMCkgewogICAgICBjb21wbGV0ZSgpOwogICAgfQogICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7CiAgfQogIHN0YXRpYyDJtWZhYyA9IGZ1bmN0aW9uIEFwcGxpY2F0aW9uSW5pdFN0YXR1c19GYWN0b3J5KF9fbmdGYWN0b3J5VHlwZV9fKSB7CiAgICByZXR1cm4gbmV3IChfX25nRmFjdG9yeVR5cGVfXyB8fCBfQXBwbGljYXRpb25Jbml0U3RhdHVzKSgpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfQXBwbGljYXRpb25Jbml0U3RhdHVzLAogICAgZmFjdG9yeTogX0FwcGxpY2F0aW9uSW5pdFN0YXR1cy7JtWZhYywKICAgIHByb3ZpZGVkSW46ICJyb290IgogIH0pOwp9OwooKCkgPT4gewogICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIHNldENsYXNzTWV0YWRhdGEoQXBwbGljYXRpb25Jbml0U3RhdHVzLCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJyb290IgogICAgfV0KICB9XSwgKCkgPT4gW10sIG51bGwpOwp9KSgpOwp2YXIgQVBQX0JPT1RTVFJBUF9MSVNURU5FUiA9IG5ldyBJbmplY3Rpb25Ub2tlbihuZ0Rldk1vZGUgPyAiYXBwQm9vdHN0cmFwTGlzdGVuZXIiIDogIiIpOwpmdW5jdGlvbiBwdWJsaXNoRGVmYXVsdEdsb2JhbFV0aWxzKCkgewogIG5nRGV2TW9kZSAmJiBwdWJsaXNoRGVmYXVsdEdsb2JhbFV0aWxzJDEoKTsKfQpmdW5jdGlvbiBwdWJsaXNoU2lnbmFsQ29uZmlndXJhdGlvbigpIHsKICBzZXRUaHJvd0ludmFsaWRXcml0ZVRvU2lnbmFsRXJyb3IoKCkgPT4gewogICAgbGV0IGVycm9yTWVzc2FnZSA9ICIiOwogICAgaWYgKG5nRGV2TW9kZSkgewogICAgICBjb25zdCBhY3RpdmVDb25zdW1lcjIgPSBnZXRBY3RpdmVDb25zdW1lcigpOwogICAgICBlcnJvck1lc3NhZ2UgPSBhY3RpdmVDb25zdW1lcjIgJiYgaXNSZWFjdGl2ZUxWaWV3Q29uc3VtZXIoYWN0aXZlQ29uc3VtZXIyKSA/ICJXcml0aW5nIHRvIHNpZ25hbHMgaXMgbm90IGFsbG93ZWQgd2hpbGUgQW5ndWxhciByZW5kZXJzIHRoZSB0ZW1wbGF0ZSAoZWcuIGludGVycG9sYXRpb25zKSIgOiAiV3JpdGluZyB0byBzaWduYWxzIGlzIG5vdCBhbGxvd2VkIGluIGEgYGNvbXB1dGVkYCI7CiAgICB9CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDYwMCwgZXJyb3JNZXNzYWdlKTsKICB9KTsKfQpmdW5jdGlvbiBpc0JvdW5kVG9Nb2R1bGUoY2YpIHsKICByZXR1cm4gY2YuaXNCb3VuZFRvTW9kdWxlOwp9CnZhciBNQVhJTVVNX1JFRlJFU0hfUkVSVU5TID0gMTA7CmZ1bmN0aW9uIG9wdGlvbnNSZWR1Y2VyKGRzdCwgb2JqcykgewogIGlmIChBcnJheS5pc0FycmF5KG9ianMpKSB7CiAgICByZXR1cm4gb2Jqcy5yZWR1Y2Uob3B0aW9uc1JlZHVjZXIsIGRzdCk7CiAgfQogIHJldHVybiBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgZHN0KSwgb2Jqcyk7Cn0KdmFyIEFwcGxpY2F0aW9uUmVmID0gY2xhc3MgX0FwcGxpY2F0aW9uUmVmIHsKICBfcnVubmluZ1RpY2sgPSBmYWxzZTsKICBfZGVzdHJveWVkID0gZmFsc2U7CiAgX2Rlc3Ryb3lMaXN0ZW5lcnMgPSBbXTsKICBfdmlld3MgPSBbXTsKICBpbnRlcm5hbEVycm9ySGFuZGxlciA9IGluamVjdDIoSU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUik7CiAgYWZ0ZXJSZW5kZXJNYW5hZ2VyID0gaW5qZWN0MihBZnRlclJlbmRlck1hbmFnZXIpOwogIHpvbmVsZXNzRW5hYmxlZCA9IGluamVjdDIoWk9ORUxFU1NfRU5BQkxFRCk7CiAgcm9vdEVmZmVjdFNjaGVkdWxlciA9IGluamVjdDIoRWZmZWN0U2NoZWR1bGVyKTsKICBkaXJ0eUZsYWdzID0gMDsKICB0cmFjaW5nU25hcHNob3QgPSBudWxsOwogIGFsbFRlc3RWaWV3cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgYXV0b0RldGVjdFRlc3RWaWV3cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7CiAgaW5jbHVkZUFsbFRlc3RWaWV3cyA9IGZhbHNlOwogIGFmdGVyVGljayA9IG5ldyBTdWJqZWN0KCk7CiAgZ2V0IGFsbFZpZXdzKCkgewogICAgcmV0dXJuIFsuLi4odGhpcy5pbmNsdWRlQWxsVGVzdFZpZXdzID8gdGhpcy5hbGxUZXN0Vmlld3MgOiB0aGlzLmF1dG9EZXRlY3RUZXN0Vmlld3MpLmtleXMoKSwgLi4udGhpcy5fdmlld3NdOwogIH0KICBnZXQgZGVzdHJveWVkKCkgewogICAgcmV0dXJuIHRoaXMuX2Rlc3Ryb3llZDsKICB9CiAgY29tcG9uZW50VHlwZXMgPSBbXTsKICBjb21wb25lbnRzID0gW107CiAgaW50ZXJuYWxQZW5kaW5nVGFzayA9IGluamVjdDIoUGVuZGluZ1Rhc2tzSW50ZXJuYWwpOwogIGdldCBpc1N0YWJsZSgpIHsKICAgIHJldHVybiB0aGlzLmludGVybmFsUGVuZGluZ1Rhc2suaGFzUGVuZGluZ1Rhc2tzT2JzZXJ2YWJsZS5waXBlKG1hcCgocGVuZGluZykgPT4gIXBlbmRpbmcpKTsKICB9CiAgY29uc3RydWN0b3IoKSB7CiAgICBpbmplY3QyKFRyYWNpbmdTZXJ2aWNlLCB7CiAgICAgIG9wdGlvbmFsOiB0cnVlCiAgICB9KTsKICB9CiAgd2hlblN0YWJsZSgpIHsKICAgIGxldCBzdWJzY3JpcHRpb247CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgc3Vic2NyaXB0aW9uID0gdGhpcy5pc1N0YWJsZS5zdWJzY3JpYmUoewogICAgICAgIG5leHQ6IChzdGFibGUpID0+IHsKICAgICAgICAgIGlmIChzdGFibGUpIHsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICB9KTsKICB9CiAgX2luamVjdG9yID0gaW5qZWN0MihFbnZpcm9ubWVudEluamVjdG9yKTsKICBfcmVuZGVyZXJGYWN0b3J5ID0gbnVsbDsKICBnZXQgaW5qZWN0b3IoKSB7CiAgICByZXR1cm4gdGhpcy5faW5qZWN0b3I7CiAgfQogIGJvb3RzdHJhcChjb21wb25lbnRPckZhY3RvcnksIHJvb3RTZWxlY3Rvck9yTm9kZSkgewogICAgcmV0dXJuIHRoaXMuYm9vdHN0cmFwSW1wbChjb21wb25lbnRPckZhY3RvcnksIHJvb3RTZWxlY3Rvck9yTm9kZSk7CiAgfQogIGJvb3RzdHJhcEltcGwoY29tcG9uZW50T3JGYWN0b3J5LCByb290U2VsZWN0b3JPck5vZGUsIGluamVjdG9yID0gSW5qZWN0b3IuTlVMTCkgewogICAgY29uc3Qgbmdab25lID0gdGhpcy5faW5qZWN0b3IuZ2V0KE5nWm9uZSk7CiAgICByZXR1cm4gbmdab25lLnJ1bigoKSA9PiB7CiAgICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQm9vdHN0cmFwQ29tcG9uZW50U3RhcnQpOwogICAgICAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiB3YXJuSWZEZXN0cm95ZWQodGhpcy5fZGVzdHJveWVkKTsKICAgICAgY29uc3QgaXNDb21wb25lbnRGYWN0b3J5ID0gY29tcG9uZW50T3JGYWN0b3J5IGluc3RhbmNlb2YgQ29tcG9uZW50RmFjdG9yeSQxOwogICAgICBjb25zdCBpbml0U3RhdHVzID0gdGhpcy5faW5qZWN0b3IuZ2V0KEFwcGxpY2F0aW9uSW5pdFN0YXR1cyk7CiAgICAgIGlmICghaW5pdFN0YXR1cy5kb25lKSB7CiAgICAgICAgbGV0IGVycm9yTWVzc2FnZSA9ICIiOwogICAgICAgIGlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICAgICAgICAgIGNvbnN0IHN0YW5kYWxvbmUgPSAhaXNDb21wb25lbnRGYWN0b3J5ICYmIGlzU3RhbmRhbG9uZShjb21wb25lbnRPckZhY3RvcnkpOwogICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkNhbm5vdCBib290c3RyYXAgYXMgdGhlcmUgYXJlIHN0aWxsIGFzeW5jaHJvbm91cyBpbml0aWFsaXplcnMgcnVubmluZy4iICsgKHN0YW5kYWxvbmUgPyAiIiA6ICIgQm9vdHN0cmFwIGNvbXBvbmVudHMgaW4gdGhlIGBuZ0RvQm9vdHN0cmFwYCBtZXRob2Qgb2YgdGhlIHJvb3QgbW9kdWxlLiIpOwogICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDQwNSwgZXJyb3JNZXNzYWdlKTsKICAgICAgfQogICAgICBsZXQgY29tcG9uZW50RmFjdG9yeTsKICAgICAgaWYgKGlzQ29tcG9uZW50RmFjdG9yeSkgewogICAgICAgIGNvbXBvbmVudEZhY3RvcnkgPSBjb21wb25lbnRPckZhY3Rvcnk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgcmVzb2x2ZXIgPSB0aGlzLl9pbmplY3Rvci5nZXQoQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyJDEpOwogICAgICAgIGNvbXBvbmVudEZhY3RvcnkgPSByZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShjb21wb25lbnRPckZhY3RvcnkpOwogICAgICB9CiAgICAgIHRoaXMuY29tcG9uZW50VHlwZXMucHVzaChjb21wb25lbnRGYWN0b3J5LmNvbXBvbmVudFR5cGUpOwogICAgICBjb25zdCBuZ01vZHVsZSA9IGlzQm91bmRUb01vZHVsZShjb21wb25lbnRGYWN0b3J5KSA/IHZvaWQgMCA6IHRoaXMuX2luamVjdG9yLmdldChOZ01vZHVsZVJlZiQxKTsKICAgICAgY29uc3Qgc2VsZWN0b3JPck5vZGUgPSByb290U2VsZWN0b3JPck5vZGUgfHwgY29tcG9uZW50RmFjdG9yeS5zZWxlY3RvcjsKICAgICAgY29uc3QgY29tcFJlZiA9IGNvbXBvbmVudEZhY3RvcnkuY3JlYXRlKGluamVjdG9yLCBbXSwgc2VsZWN0b3JPck5vZGUsIG5nTW9kdWxlKTsKICAgICAgY29uc3QgbmF0aXZlRWxlbWVudCA9IGNvbXBSZWYubG9jYXRpb24ubmF0aXZlRWxlbWVudDsKICAgICAgY29uc3QgdGVzdGFiaWxpdHkgPSBjb21wUmVmLmluamVjdG9yLmdldChURVNUQUJJTElUWSwgbnVsbCk7CiAgICAgIHRlc3RhYmlsaXR5Py5yZWdpc3RlckFwcGxpY2F0aW9uKG5hdGl2ZUVsZW1lbnQpOwogICAgICBjb21wUmVmLm9uRGVzdHJveSgoKSA9PiB7CiAgICAgICAgdGhpcy5kZXRhY2hWaWV3KGNvbXBSZWYuaG9zdFZpZXcpOwogICAgICAgIHJlbW92ZSh0aGlzLmNvbXBvbmVudHMsIGNvbXBSZWYpOwogICAgICAgIHRlc3RhYmlsaXR5Py51bnJlZ2lzdGVyQXBwbGljYXRpb24obmF0aXZlRWxlbWVudCk7CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2FkQ29tcG9uZW50KGNvbXBSZWYpOwogICAgICBpZiAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSB7CiAgICAgICAgY29uc3QgX2NvbnNvbGUgPSB0aGlzLl9pbmplY3Rvci5nZXQoQ29uc29sZSk7CiAgICAgICAgX2NvbnNvbGUubG9nKGBBbmd1bGFyIGlzIHJ1bm5pbmcgaW4gZGV2ZWxvcG1lbnQgbW9kZS5gKTsKICAgICAgfQogICAgICBwcm9maWxlcihQcm9maWxlckV2ZW50LkJvb3RzdHJhcENvbXBvbmVudEVuZCwgY29tcFJlZik7CiAgICAgIHJldHVybiBjb21wUmVmOwogICAgfSk7CiAgfQogIHRpY2soKSB7CiAgICBpZiAoIXRoaXMuem9uZWxlc3NFbmFibGVkKSB7CiAgICAgIHRoaXMuZGlydHlGbGFncyB8PSAxOwogICAgfQogICAgdGhpcy5fdGljaygpOwogIH0KICBfdGljaygpIHsKICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQ2hhbmdlRGV0ZWN0aW9uU3RhcnQpOwogICAgaWYgKHRoaXMudHJhY2luZ1NuYXBzaG90ICE9PSBudWxsKSB7CiAgICAgIHRoaXMudHJhY2luZ1NuYXBzaG90LnJ1bihUcmFjaW5nQWN0aW9uLkNIQU5HRV9ERVRFQ1RJT04sIHRoaXMudGlja0ltcGwpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy50aWNrSW1wbCgpOwogICAgfQogIH0KICB0aWNrSW1wbCA9ICgpID0+IHsKICAgICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIHdhcm5JZkRlc3Ryb3llZCh0aGlzLl9kZXN0cm95ZWQpOwogICAgaWYgKHRoaXMuX3J1bm5pbmdUaWNrKSB7CiAgICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQ2hhbmdlRGV0ZWN0aW9uRW5kKTsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigxMDEsIG5nRGV2TW9kZSAmJiAiQXBwbGljYXRpb25SZWYudGljayBpcyBjYWxsZWQgcmVjdXJzaXZlbHkiKTsKICAgIH0KICAgIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogICAgdHJ5IHsKICAgICAgdGhpcy5fcnVubmluZ1RpY2sgPSB0cnVlOwogICAgICB0aGlzLnN5bmNocm9uaXplKCk7CiAgICAgIGlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICAgICAgICBmb3IgKGxldCB2aWV3IG9mIHRoaXMuYWxsVmlld3MpIHsKICAgICAgICAgIHZpZXcuY2hlY2tOb0NoYW5nZXMoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHRoaXMuX3J1bm5pbmdUaWNrID0gZmFsc2U7CiAgICAgIHRoaXMudHJhY2luZ1NuYXBzaG90Py5kaXNwb3NlKCk7CiAgICAgIHRoaXMudHJhY2luZ1NuYXBzaG90ID0gbnVsbDsKICAgICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICAgICAgdGhpcy5hZnRlclRpY2submV4dCgpOwogICAgICBwcm9maWxlcihQcm9maWxlckV2ZW50LkNoYW5nZURldGVjdGlvbkVuZCk7CiAgICB9CiAgfTsKICBzeW5jaHJvbml6ZSgpIHsKICAgIGlmICh0aGlzLl9yZW5kZXJlckZhY3RvcnkgPT09IG51bGwgJiYgIXRoaXMuX2luamVjdG9yLmRlc3Ryb3llZCkgewogICAgICB0aGlzLl9yZW5kZXJlckZhY3RvcnkgPSB0aGlzLl9pbmplY3Rvci5nZXQoUmVuZGVyZXJGYWN0b3J5MiwgbnVsbCwgewogICAgICAgIG9wdGlvbmFsOiB0cnVlCiAgICAgIH0pOwogICAgfQogICAgbGV0IHJ1bnMgPSAwOwogICAgd2hpbGUgKHRoaXMuZGlydHlGbGFncyAhPT0gMCAmJiBydW5zKysgPCBNQVhJTVVNX1JFRlJFU0hfUkVSVU5TKSB7CiAgICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQ2hhbmdlRGV0ZWN0aW9uU3luY1N0YXJ0KTsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLnN5bmNocm9uaXplT25jZSgpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQ2hhbmdlRGV0ZWN0aW9uU3luY0VuZCk7CiAgICAgIH0KICAgIH0KICAgIGlmICgodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBydW5zID49IE1BWElNVU1fUkVGUkVTSF9SRVJVTlMpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigxMDMsIG5nRGV2TW9kZSAmJiAiSW5maW5pdGUgY2hhbmdlIGRldGVjdGlvbiB3aGlsZSByZWZyZXNoaW5nIGFwcGxpY2F0aW9uIHZpZXdzLiBFbnN1cmUgdmlld3MgYXJlIG5vdCBjYWxsaW5nIGBtYXJrRm9yQ2hlY2tgIG9uIGV2ZXJ5IHRlbXBsYXRlIGV4ZWN1dGlvbiBvciB0aGF0IGFmdGVyUmVuZGVyIGhvb2tzIGFsd2F5cyBtYXJrIHZpZXdzIGZvciBjaGVjay4iKTsKICAgIH0KICB9CiAgc3luY2hyb25pemVPbmNlKCkgewogICAgaWYgKHRoaXMuZGlydHlGbGFncyAmIDE2KSB7CiAgICAgIHRoaXMuZGlydHlGbGFncyAmPSB+MTY7CiAgICAgIHRoaXMucm9vdEVmZmVjdFNjaGVkdWxlci5mbHVzaCgpOwogICAgfQogICAgbGV0IHJhbkRldGVjdENoYW5nZXMgPSBmYWxzZTsKICAgIGlmICh0aGlzLmRpcnR5RmxhZ3MgJiA3KSB7CiAgICAgIGNvbnN0IHVzZUdsb2JhbENoZWNrID0gQm9vbGVhbih0aGlzLmRpcnR5RmxhZ3MgJiAxKTsKICAgICAgdGhpcy5kaXJ0eUZsYWdzICY9IH43OwogICAgICB0aGlzLmRpcnR5RmxhZ3MgfD0gODsKICAgICAgZm9yIChsZXQgewogICAgICAgIF9sVmlldwogICAgICB9IG9mIHRoaXMuYWxsVmlld3MpIHsKICAgICAgICBpZiAoIXVzZUdsb2JhbENoZWNrICYmICFyZXF1aXJlc1JlZnJlc2hPclRyYXZlcnNhbChfbFZpZXcpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgY29uc3QgbW9kZSA9IHVzZUdsb2JhbENoZWNrICYmICF0aGlzLnpvbmVsZXNzRW5hYmxlZCA/IDAgOiAxOwogICAgICAgIGRldGVjdENoYW5nZXNJbnRlcm5hbChfbFZpZXcsIG1vZGUpOwogICAgICAgIHJhbkRldGVjdENoYW5nZXMgPSB0cnVlOwogICAgICB9CiAgICAgIHRoaXMuZGlydHlGbGFncyAmPSB+NDsKICAgICAgdGhpcy5zeW5jRGlydHlGbGFnc1dpdGhWaWV3cygpOwogICAgICBpZiAodGhpcy5kaXJ0eUZsYWdzICYgKDcgfCAxNikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICAgIGlmICghcmFuRGV0ZWN0Q2hhbmdlcykgewogICAgICB0aGlzLl9yZW5kZXJlckZhY3Rvcnk/LmJlZ2luPy4oKTsKICAgICAgdGhpcy5fcmVuZGVyZXJGYWN0b3J5Py5lbmQ/LigpOwogICAgfQogICAgaWYgKHRoaXMuZGlydHlGbGFncyAmIDgpIHsKICAgICAgdGhpcy5kaXJ0eUZsYWdzICY9IH44OwogICAgICB0aGlzLmFmdGVyUmVuZGVyTWFuYWdlci5leGVjdXRlKCk7CiAgICB9CiAgICB0aGlzLnN5bmNEaXJ0eUZsYWdzV2l0aFZpZXdzKCk7CiAgfQogIHN5bmNEaXJ0eUZsYWdzV2l0aFZpZXdzKCkgewogICAgaWYgKHRoaXMuYWxsVmlld3Muc29tZSgoewogICAgICBfbFZpZXcKICAgIH0pID0+IHJlcXVpcmVzUmVmcmVzaE9yVHJhdmVyc2FsKF9sVmlldykpKSB7CiAgICAgIHRoaXMuZGlydHlGbGFncyB8PSAyOwogICAgICByZXR1cm47CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRpcnR5RmxhZ3MgJj0gfjc7CiAgICB9CiAgfQogIGF0dGFjaFZpZXcodmlld1JlZikgewogICAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgd2FybklmRGVzdHJveWVkKHRoaXMuX2Rlc3Ryb3llZCk7CiAgICBjb25zdCB2aWV3ID0gdmlld1JlZjsKICAgIHRoaXMuX3ZpZXdzLnB1c2godmlldyk7CiAgICB2aWV3LmF0dGFjaFRvQXBwUmVmKHRoaXMpOwogIH0KICBkZXRhY2hWaWV3KHZpZXdSZWYpIHsKICAgICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIHdhcm5JZkRlc3Ryb3llZCh0aGlzLl9kZXN0cm95ZWQpOwogICAgY29uc3QgdmlldyA9IHZpZXdSZWY7CiAgICByZW1vdmUodGhpcy5fdmlld3MsIHZpZXcpOwogICAgdmlldy5kZXRhY2hGcm9tQXBwUmVmKCk7CiAgfQogIF9sb2FkQ29tcG9uZW50KGNvbXBvbmVudFJlZikgewogICAgdGhpcy5hdHRhY2hWaWV3KGNvbXBvbmVudFJlZi5ob3N0Vmlldyk7CiAgICB0cnkgewogICAgICB0aGlzLnRpY2soKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdGhpcy5pbnRlcm5hbEVycm9ySGFuZGxlcihlKTsKICAgIH0KICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudFJlZik7CiAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9pbmplY3Rvci5nZXQoQVBQX0JPT1RTVFJBUF9MSVNURU5FUiwgW10pOwogICAgaWYgKG5nRGV2TW9kZSAmJiAhQXJyYXkuaXNBcnJheShsaXN0ZW5lcnMpKSB7CiAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTIwOSwgYFVuZXhwZWN0ZWQgdHlwZSBvZiB0aGUgXGBBUFBfQk9PVFNUUkFQX0xJU1RFTkVSXGAgdG9rZW4gdmFsdWUgKGV4cGVjdGVkIGFuIGFycmF5LCBidXQgZ290ICR7dHlwZW9mIGxpc3RlbmVyc30pLiBQbGVhc2UgY2hlY2sgdGhhdCB0aGUgXGBBUFBfQk9PVFNUUkFQX0xJU1RFTkVSXGAgdG9rZW4gaXMgY29uZmlndXJlZCBhcyBhIFxgbXVsdGk6IHRydWVcYCBwcm92aWRlci5gKTsKICAgIH0KICAgIGxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4gbGlzdGVuZXIoY29tcG9uZW50UmVmKSk7CiAgfQogIG5nT25EZXN0cm95KCkgewogICAgaWYgKHRoaXMuX2Rlc3Ryb3llZCkgcmV0dXJuOwogICAgdHJ5IHsKICAgICAgdGhpcy5fZGVzdHJveUxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4gbGlzdGVuZXIoKSk7CiAgICAgIHRoaXMuX3ZpZXdzLnNsaWNlKCkuZm9yRWFjaCgodmlldykgPT4gdmlldy5kZXN0cm95KCkpOwogICAgfSBmaW5hbGx5IHsKICAgICAgdGhpcy5fZGVzdHJveWVkID0gdHJ1ZTsKICAgICAgdGhpcy5fdmlld3MgPSBbXTsKICAgICAgdGhpcy5fZGVzdHJveUxpc3RlbmVycyA9IFtdOwogICAgfQogIH0KICBvbkRlc3Ryb3koY2FsbGJhY2spIHsKICAgICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIHdhcm5JZkRlc3Ryb3llZCh0aGlzLl9kZXN0cm95ZWQpOwogICAgdGhpcy5fZGVzdHJveUxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTsKICAgIHJldHVybiAoKSA9PiByZW1vdmUodGhpcy5fZGVzdHJveUxpc3RlbmVycywgY2FsbGJhY2spOwogIH0KICBkZXN0cm95KCkgewogICAgaWYgKHRoaXMuX2Rlc3Ryb3llZCkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDQwNiwgbmdEZXZNb2RlICYmICJUaGlzIGluc3RhbmNlIG9mIHRoZSBgQXBwbGljYXRpb25SZWZgIGhhcyBhbHJlYWR5IGJlZW4gZGVzdHJveWVkLiIpOwogICAgfQogICAgY29uc3QgaW5qZWN0b3IgPSB0aGlzLl9pbmplY3RvcjsKICAgIGlmIChpbmplY3Rvci5kZXN0cm95ICYmICFpbmplY3Rvci5kZXN0cm95ZWQpIHsKICAgICAgaW5qZWN0b3IuZGVzdHJveSgpOwogICAgfQogIH0KICBnZXQgdmlld0NvdW50KCkgewogICAgcmV0dXJuIHRoaXMuX3ZpZXdzLmxlbmd0aDsKICB9CiAgc3RhdGljIMm1ZmFjID0gZnVuY3Rpb24gQXBwbGljYXRpb25SZWZfRmFjdG9yeShfX25nRmFjdG9yeVR5cGVfXykgewogICAgcmV0dXJuIG5ldyAoX19uZ0ZhY3RvcnlUeXBlX18gfHwgX0FwcGxpY2F0aW9uUmVmKSgpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfQXBwbGljYXRpb25SZWYsCiAgICBmYWN0b3J5OiBfQXBwbGljYXRpb25SZWYuybVmYWMsCiAgICBwcm92aWRlZEluOiAicm9vdCIKICB9KTsKfTsKKCgpID0+IHsKICAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBzZXRDbGFzc01ldGFkYXRhKEFwcGxpY2F0aW9uUmVmLCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJyb290IgogICAgfV0KICB9XSwgKCkgPT4gW10sIG51bGwpOwp9KSgpOwpmdW5jdGlvbiB3YXJuSWZEZXN0cm95ZWQoZGVzdHJveWVkKSB7CiAgaWYgKGRlc3Ryb3llZCkgewogICAgY29uc29sZS53YXJuKGZvcm1hdFJ1bnRpbWVFcnJvcig0MDYsICJUaGlzIGluc3RhbmNlIG9mIHRoZSBgQXBwbGljYXRpb25SZWZgIGhhcyBhbHJlYWR5IGJlZW4gZGVzdHJveWVkLiIpKTsKICB9Cn0KZnVuY3Rpb24gcmVtb3ZlKGxpc3QsIGVsKSB7CiAgY29uc3QgaW5kZXggPSBsaXN0LmluZGV4T2YoZWwpOwogIGlmIChpbmRleCA+IC0xKSB7CiAgICBsaXN0LnNwbGljZShpbmRleCwgMSk7CiAgfQp9CmZ1bmN0aW9uIHByb21pc2VXaXRoUmVzb2x2ZXJzKCkgewogIGxldCByZXNvbHZlOwogIGxldCByZWplY3Q7CiAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4gewogICAgcmVzb2x2ZSA9IHJlczsKICAgIHJlamVjdCA9IHJlajsKICB9KTsKICByZXR1cm4gewogICAgcHJvbWlzZSwKICAgIHJlc29sdmUsCiAgICByZWplY3QKICB9Owp9CmZ1bmN0aW9uIHNjaGVkdWxlRGVsYXllZFRyaWdnZXIoc2NoZWR1bGVGbikgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIHJlbmRlclBsYWNlaG9sZGVyKGxWaWV3LCB0Tm9kZSk7CiAgaWYgKCFzaG91bGRUcmlnZ2VyRGVmZXJCbG9jaygwLCBsVmlldykpIHJldHVybjsKICBjb25zdCBpbmplY3RvciA9IGxWaWV3W0lOSkVDVE9SXTsKICBjb25zdCBsRGV0YWlscyA9IGdldExEZWZlckJsb2NrRGV0YWlscyhsVmlldywgdE5vZGUpOwogIGNvbnN0IGNsZWFudXBGbiA9IHNjaGVkdWxlRm4oKCkgPT4gdHJpZ2dlckRlZmVyQmxvY2soMCwgbFZpZXcsIHROb2RlKSwgaW5qZWN0b3IpOwogIHN0b3JlVHJpZ2dlckNsZWFudXBGbigwLCBsRGV0YWlscywgY2xlYW51cEZuKTsKfQpmdW5jdGlvbiBzY2hlZHVsZURlbGF5ZWRQcmVmZXRjaGluZyhzY2hlZHVsZUZuKSB7CiAgaWYgKGZhbHNlKSByZXR1cm47CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGluamVjdG9yID0gbFZpZXdbSU5KRUNUT1JdOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICBpZiAodERldGFpbHMubG9hZGluZ1N0YXRlID09PSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5OT1RfU1RBUlRFRCkgewogICAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIHROb2RlKTsKICAgIGNvbnN0IHByZWZldGNoID0gKCkgPT4gdHJpZ2dlclByZWZldGNoaW5nKHREZXRhaWxzLCBsVmlldywgdE5vZGUpOwogICAgY29uc3QgY2xlYW51cEZuID0gc2NoZWR1bGVGbihwcmVmZXRjaCwgaW5qZWN0b3IpOwogICAgc3RvcmVUcmlnZ2VyQ2xlYW51cEZuKDEsIGxEZXRhaWxzLCBjbGVhbnVwRm4pOwogIH0KfQpmdW5jdGlvbiBzY2hlZHVsZURlbGF5ZWRIeWRyYXRpbmcoc2NoZWR1bGVGbiwgbFZpZXcsIHROb2RlKSB7CiAgaWYgKGZhbHNlKSByZXR1cm47CiAgY29uc3QgaW5qZWN0b3IgPSBsVmlld1tJTkpFQ1RPUl07CiAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIHROb2RlKTsKICBjb25zdCBzc3JVbmlxdWVJZCA9IGxEZXRhaWxzW1NTUl9VTklRVUVfSURdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRTc3JJZERlZmluZWQoc3NyVW5pcXVlSWQpOwogIGNvbnN0IGNsZWFudXBGbiA9IHNjaGVkdWxlRm4oKCkgPT4gdHJpZ2dlckh5ZHJhdGlvbkZyb21CbG9ja05hbWUoaW5qZWN0b3IsIHNzclVuaXF1ZUlkKSwgaW5qZWN0b3IpOwogIHN0b3JlVHJpZ2dlckNsZWFudXBGbigyLCBsRGV0YWlscywgY2xlYW51cEZuKTsKfQpmdW5jdGlvbiB0cmlnZ2VyUHJlZmV0Y2hpbmcodERldGFpbHMsIGxWaWV3LCB0Tm9kZSkgewogIHRyaWdnZXJSZXNvdXJjZUxvYWRpbmcodERldGFpbHMsIGxWaWV3LCB0Tm9kZSk7Cn0KZnVuY3Rpb24gdHJpZ2dlclJlc291cmNlTG9hZGluZyh0RGV0YWlscywgbFZpZXcsIHROb2RlKSB7CiAgY29uc3QgaW5qZWN0b3IgPSBsVmlld1tJTkpFQ1RPUl07CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgaWYgKHREZXRhaWxzLmxvYWRpbmdTdGF0ZSAhPT0gRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuTk9UX1NUQVJURUQpIHsKICAgIHJldHVybiB0RGV0YWlscy5sb2FkaW5nUHJvbWlzZSA/PyBQcm9taXNlLnJlc29sdmUoKTsKICB9CiAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIHROb2RlKTsKICBjb25zdCBwcmltYXJ5QmxvY2tUTm9kZSA9IGdldFByaW1hcnlCbG9ja1ROb2RlKHRWaWV3LCB0RGV0YWlscyk7CiAgdERldGFpbHMubG9hZGluZ1N0YXRlID0gRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuSU5fUFJPR1JFU1M7CiAgaW52b2tlVHJpZ2dlckNsZWFudXBGbnMoMSwgbERldGFpbHMpOwogIGxldCBkZXBlbmRlbmNpZXNGbiA9IHREZXRhaWxzLmRlcGVuZGVuY3lSZXNvbHZlckZuOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIGNvbnN0IGRlZmVyRGVwZW5kZW5jeUludGVyY2VwdG9yID0gaW5qZWN0b3IuZ2V0KERFRkVSX0JMT0NLX0RFUEVOREVOQ1lfSU5URVJDRVBUT1IsIG51bGwsIHsKICAgICAgb3B0aW9uYWw6IHRydWUKICAgIH0pOwogICAgaWYgKGRlZmVyRGVwZW5kZW5jeUludGVyY2VwdG9yKSB7CiAgICAgIGRlcGVuZGVuY2llc0ZuID0gZGVmZXJEZXBlbmRlbmN5SW50ZXJjZXB0b3IuaW50ZXJjZXB0KGRlcGVuZGVuY2llc0ZuKTsKICAgIH0KICB9CiAgY29uc3QgcmVtb3ZlVGFzayA9IGluamVjdG9yLmdldChQZW5kaW5nVGFza3MpLmFkZCgpOwogIGlmICghZGVwZW5kZW5jaWVzRm4pIHsKICAgIHREZXRhaWxzLmxvYWRpbmdQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7CiAgICAgIHREZXRhaWxzLmxvYWRpbmdQcm9taXNlID0gbnVsbDsKICAgICAgdERldGFpbHMubG9hZGluZ1N0YXRlID0gRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuQ09NUExFVEU7CiAgICAgIHJlbW92ZVRhc2soKTsKICAgIH0pOwogICAgcmV0dXJuIHREZXRhaWxzLmxvYWRpbmdQcm9taXNlOwogIH0KICB0RGV0YWlscy5sb2FkaW5nUHJvbWlzZSA9IFByb21pc2UuYWxsU2V0dGxlZChkZXBlbmRlbmNpZXNGbigpKS50aGVuKChyZXN1bHRzKSA9PiB7CiAgICBsZXQgZmFpbGVkID0gZmFsc2U7CiAgICBjb25zdCBkaXJlY3RpdmVEZWZzID0gW107CiAgICBjb25zdCBwaXBlRGVmcyA9IFtdOwogICAgZm9yIChjb25zdCByZXN1bHQgb2YgcmVzdWx0cykgewogICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gImZ1bGZpbGxlZCIpIHsKICAgICAgICBjb25zdCBkZXBlbmRlbmN5ID0gcmVzdWx0LnZhbHVlOwogICAgICAgIGNvbnN0IGRpcmVjdGl2ZURlZiA9IGdldENvbXBvbmVudERlZihkZXBlbmRlbmN5KSB8fCBnZXREaXJlY3RpdmVEZWYoZGVwZW5kZW5jeSk7CiAgICAgICAgaWYgKGRpcmVjdGl2ZURlZikgewogICAgICAgICAgZGlyZWN0aXZlRGVmcy5wdXNoKGRpcmVjdGl2ZURlZik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHBpcGVEZWYgPSBnZXRQaXBlRGVmKGRlcGVuZGVuY3kpOwogICAgICAgICAgaWYgKHBpcGVEZWYpIHsKICAgICAgICAgICAgcGlwZURlZnMucHVzaChwaXBlRGVmKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmFpbGVkID0gdHJ1ZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgaWYgKGZhaWxlZCkgewogICAgICB0RGV0YWlscy5sb2FkaW5nU3RhdGUgPSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5GQUlMRUQ7CiAgICAgIGlmICh0RGV0YWlscy5lcnJvclRtcGxJbmRleCA9PT0gbnVsbCkgewogICAgICAgIGNvbnN0IHRlbXBsYXRlTG9jYXRpb24gPSBuZ0Rldk1vZGUgPyBnZXRUZW1wbGF0ZUxvY2F0aW9uRGV0YWlscyhsVmlldykgOiAiIjsKICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBSdW50aW1lRXJyb3IoLTc1MCwgbmdEZXZNb2RlICYmIGBMb2FkaW5nIGRlcGVuZGVuY2llcyBmb3IgXGBAZGVmZXJcYCBibG9jayBmYWlsZWQsIGJ1dCBubyBcYEBlcnJvclxgIGJsb2NrIHdhcyBjb25maWd1cmVkJHt0ZW1wbGF0ZUxvY2F0aW9ufS4gQ29uc2lkZXIgdXNpbmcgdGhlIFxgQGVycm9yXGAgYmxvY2sgdG8gcmVuZGVyIGFuIGVycm9yIHN0YXRlLmApOwogICAgICAgIGhhbmRsZVVuY2F1Z2h0RXJyb3IobFZpZXcsIGVycm9yKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdERldGFpbHMubG9hZGluZ1N0YXRlID0gRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuQ09NUExFVEU7CiAgICAgIGNvbnN0IHByaW1hcnlCbG9ja1RWaWV3ID0gcHJpbWFyeUJsb2NrVE5vZGUudFZpZXc7CiAgICAgIGlmIChkaXJlY3RpdmVEZWZzLmxlbmd0aCA+IDApIHsKICAgICAgICBwcmltYXJ5QmxvY2tUVmlldy5kaXJlY3RpdmVSZWdpc3RyeSA9IGFkZERlcHNUb1JlZ2lzdHJ5KHByaW1hcnlCbG9ja1RWaWV3LmRpcmVjdGl2ZVJlZ2lzdHJ5LCBkaXJlY3RpdmVEZWZzKTsKICAgICAgICBjb25zdCBkaXJlY3RpdmVUeXBlcyA9IGRpcmVjdGl2ZURlZnMubWFwKChkZWYpID0+IGRlZi50eXBlKTsKICAgICAgICBjb25zdCBwcm92aWRlcnMgPSBpbnRlcm5hbEltcG9ydFByb3ZpZGVyc0Zyb20oZmFsc2UsIC4uLmRpcmVjdGl2ZVR5cGVzKTsKICAgICAgICB0RGV0YWlscy5wcm92aWRlcnMgPSBwcm92aWRlcnM7CiAgICAgIH0KICAgICAgaWYgKHBpcGVEZWZzLmxlbmd0aCA+IDApIHsKICAgICAgICBwcmltYXJ5QmxvY2tUVmlldy5waXBlUmVnaXN0cnkgPSBhZGREZXBzVG9SZWdpc3RyeShwcmltYXJ5QmxvY2tUVmlldy5waXBlUmVnaXN0cnksIHBpcGVEZWZzKTsKICAgICAgfQogICAgfQogIH0pOwogIHJldHVybiB0RGV0YWlscy5sb2FkaW5nUHJvbWlzZS5maW5hbGx5KCgpID0+IHsKICAgIHREZXRhaWxzLmxvYWRpbmdQcm9taXNlID0gbnVsbDsKICAgIHJlbW92ZVRhc2soKTsKICB9KTsKfQpmdW5jdGlvbiBzaG91bGRUcmlnZ2VyRGVmZXJCbG9jayh0cmlnZ2VyVHlwZSwgbFZpZXcpIHsKICBpZiAodHJpZ2dlclR5cGUgPT09IDAgJiYgdHJ1ZSAmJiBmYWxzZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICBjb25zdCBpbmplY3RvciA9IGxWaWV3W0lOSkVDVE9SXTsKICBjb25zdCBjb25maWcyID0gaW5qZWN0b3IuZ2V0KERFRkVSX0JMT0NLX0NPTkZJRywgbnVsbCwgewogICAgb3B0aW9uYWw6IHRydWUKICB9KTsKICBpZiAoY29uZmlnMj8uYmVoYXZpb3IgPT09IERlZmVyQmxvY2tCZWhhdmlvci5NYW51YWwpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIHRydWU7Cn0KZnVuY3Rpb24gdHJpZ2dlckRlZmVyQmxvY2sodHJpZ2dlclR5cGUsIGxWaWV3LCB0Tm9kZSkgewogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IGxDb250YWluZXIgPSBsVmlld1t0Tm9kZS5pbmRleF07CiAgbmdEZXZNb2RlICYmIGFzc2VydExDb250YWluZXIobENvbnRhaW5lcik7CiAgaWYgKCFzaG91bGRUcmlnZ2VyRGVmZXJCbG9jayh0cmlnZ2VyVHlwZSwgbFZpZXcpKSByZXR1cm47CiAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIHROb2RlKTsKICBjb25zdCB0RGV0YWlscyA9IGdldFREZWZlckJsb2NrRGV0YWlscyh0VmlldywgdE5vZGUpOwogIGludm9rZUFsbFRyaWdnZXJDbGVhbnVwRm5zKGxEZXRhaWxzKTsKICBzd2l0Y2ggKHREZXRhaWxzLmxvYWRpbmdTdGF0ZSkgewogICAgY2FzZSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5OT1RfU1RBUlRFRDoKICAgICAgcmVuZGVyRGVmZXJCbG9ja1N0YXRlKERlZmVyQmxvY2tTdGF0ZS5Mb2FkaW5nLCB0Tm9kZSwgbENvbnRhaW5lcik7CiAgICAgIHRyaWdnZXJSZXNvdXJjZUxvYWRpbmcodERldGFpbHMsIGxWaWV3LCB0Tm9kZSk7CiAgICAgIGlmICh0RGV0YWlscy5sb2FkaW5nU3RhdGUgPT09IERlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlLklOX1BST0dSRVNTKSB7CiAgICAgICAgcmVuZGVyRGVmZXJTdGF0ZUFmdGVyUmVzb3VyY2VMb2FkaW5nKHREZXRhaWxzLCB0Tm9kZSwgbENvbnRhaW5lcik7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlIERlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlLklOX1BST0dSRVNTOgogICAgICByZW5kZXJEZWZlckJsb2NrU3RhdGUoRGVmZXJCbG9ja1N0YXRlLkxvYWRpbmcsIHROb2RlLCBsQ29udGFpbmVyKTsKICAgICAgcmVuZGVyRGVmZXJTdGF0ZUFmdGVyUmVzb3VyY2VMb2FkaW5nKHREZXRhaWxzLCB0Tm9kZSwgbENvbnRhaW5lcik7CiAgICAgIGJyZWFrOwogICAgY2FzZSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5DT01QTEVURToKICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmVycmVkRGVwZW5kZW5jaWVzTG9hZGVkKHREZXRhaWxzKTsKICAgICAgcmVuZGVyRGVmZXJCbG9ja1N0YXRlKERlZmVyQmxvY2tTdGF0ZS5Db21wbGV0ZSwgdE5vZGUsIGxDb250YWluZXIpOwogICAgICBicmVhazsKICAgIGNhc2UgRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuRkFJTEVEOgogICAgICByZW5kZXJEZWZlckJsb2NrU3RhdGUoRGVmZXJCbG9ja1N0YXRlLkVycm9yLCB0Tm9kZSwgbENvbnRhaW5lcik7CiAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgaWYgKG5nRGV2TW9kZSkgewogICAgICAgIHRocm93RXJyb3IyKCJVbmtub3duIGRlZmVyIGJsb2NrIHN0YXRlIik7CiAgICAgIH0KICB9Cn0KYXN5bmMgZnVuY3Rpb24gdHJpZ2dlckh5ZHJhdGlvbkZyb21CbG9ja05hbWUoaW5qZWN0b3IsIGJsb2NrTmFtZSwgcmVwbGF5UXVldWVkRXZlbnRzRm4pIHsKICBjb25zdCBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSA9IGluamVjdG9yLmdldChERUhZRFJBVEVEX0JMT0NLX1JFR0lTVFJZKTsKICBjb25zdCBibG9ja3NCZWluZ0h5ZHJhdGVkID0gZGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkuaHlkcmF0aW5nOwogIGlmIChibG9ja3NCZWluZ0h5ZHJhdGVkLmhhcyhibG9ja05hbWUpKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHsKICAgIHBhcmVudEJsb2NrUHJvbWlzZSwKICAgIGh5ZHJhdGlvblF1ZXVlCiAgfSA9IGdldFBhcmVudEJsb2NrSHlkcmF0aW9uUXVldWUoYmxvY2tOYW1lLCBpbmplY3Rvcik7CiAgaWYgKGh5ZHJhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogIGlmIChwYXJlbnRCbG9ja1Byb21pc2UgIT09IG51bGwpIHsKICAgIGh5ZHJhdGlvblF1ZXVlLnNoaWZ0KCk7CiAgfQogIHBvcHVsYXRlSHlkcmF0aW5nU3RhdGVGb3JRdWV1ZShkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSwgaHlkcmF0aW9uUXVldWUpOwogIGlmIChwYXJlbnRCbG9ja1Byb21pc2UgIT09IG51bGwpIHsKICAgIGF3YWl0IHBhcmVudEJsb2NrUHJvbWlzZTsKICB9CiAgY29uc3QgdG9wbW9zdFBhcmVudEJsb2NrID0gaHlkcmF0aW9uUXVldWVbMF07CiAgaWYgKGRlaHlkcmF0ZWRCbG9ja1JlZ2lzdHJ5Lmhhcyh0b3Btb3N0UGFyZW50QmxvY2spKSB7CiAgICBhd2FpdCB0cmlnZ2VySHlkcmF0aW9uRm9yQmxvY2tRdWV1ZShpbmplY3RvciwgaHlkcmF0aW9uUXVldWUsIHJlcGxheVF1ZXVlZEV2ZW50c0ZuKTsKICB9IGVsc2UgewogICAgZGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkuYXdhaXRQYXJlbnRCbG9jayh0b3Btb3N0UGFyZW50QmxvY2ssIGFzeW5jICgpID0+IGF3YWl0IHRyaWdnZXJIeWRyYXRpb25Gb3JCbG9ja1F1ZXVlKGluamVjdG9yLCBoeWRyYXRpb25RdWV1ZSwgcmVwbGF5UXVldWVkRXZlbnRzRm4pKTsKICB9Cn0KYXN5bmMgZnVuY3Rpb24gdHJpZ2dlckh5ZHJhdGlvbkZvckJsb2NrUXVldWUoaW5qZWN0b3IsIGh5ZHJhdGlvblF1ZXVlLCByZXBsYXlRdWV1ZWRFdmVudHNGbikgewogIGNvbnN0IGRlaHlkcmF0ZWRCbG9ja1JlZ2lzdHJ5ID0gaW5qZWN0b3IuZ2V0KERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlkpOwogIGNvbnN0IGJsb2Nrc0JlaW5nSHlkcmF0ZWQgPSBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeS5oeWRyYXRpbmc7CiAgY29uc3QgcGVuZGluZ1Rhc2tzID0gaW5qZWN0b3IuZ2V0KFBlbmRpbmdUYXNrc0ludGVybmFsKTsKICBjb25zdCB0YXNrSWQgPSBwZW5kaW5nVGFza3MuYWRkKCk7CiAgZm9yIChsZXQgYmxvY2tRdWV1ZUlkeCA9IDA7IGJsb2NrUXVldWVJZHggPCBoeWRyYXRpb25RdWV1ZS5sZW5ndGg7IGJsb2NrUXVldWVJZHgrKykgewogICAgY29uc3QgZGVoeWRyYXRlZEJsb2NrSWQgPSBoeWRyYXRpb25RdWV1ZVtibG9ja1F1ZXVlSWR4XTsKICAgIGNvbnN0IGRlaHlkcmF0ZWREZWZlckJsb2NrID0gZGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkuZ2V0KGRlaHlkcmF0ZWRCbG9ja0lkKTsKICAgIGlmIChkZWh5ZHJhdGVkRGVmZXJCbG9jayAhPSBudWxsKSB7CiAgICAgIGF3YWl0IHRyaWdnZXJSZXNvdXJjZUxvYWRpbmdGb3JIeWRyYXRpb24oZGVoeWRyYXRlZERlZmVyQmxvY2spOwogICAgICBhd2FpdCBuZXh0UmVuZGVyKGluamVjdG9yKTsKICAgICAgaWYgKGRlZmVyQmxvY2tIYXNFcnJvcmVkKGRlaHlkcmF0ZWREZWZlckJsb2NrKSkgewogICAgICAgIHJlbW92ZURlaHlkcmF0ZWRWaWV3TGlzdChkZWh5ZHJhdGVkRGVmZXJCbG9jayk7CiAgICAgICAgY2xlYW51cFJlbWFpbmluZ0h5ZHJhdGlvblF1ZXVlKGh5ZHJhdGlvblF1ZXVlLnNsaWNlKGJsb2NrUXVldWVJZHgpLCBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgYmxvY2tzQmVpbmdIeWRyYXRlZC5nZXQoZGVoeWRyYXRlZEJsb2NrSWQpLnJlc29sdmUoKTsKICAgIH0gZWxzZSB7CiAgICAgIGNsZWFudXBQYXJlbnRDb250YWluZXIoYmxvY2tRdWV1ZUlkeCwgaHlkcmF0aW9uUXVldWUsIGRlaHlkcmF0ZWRCbG9ja1JlZ2lzdHJ5KTsKICAgICAgY2xlYW51cFJlbWFpbmluZ0h5ZHJhdGlvblF1ZXVlKGh5ZHJhdGlvblF1ZXVlLnNsaWNlKGJsb2NrUXVldWVJZHgpLCBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSk7CiAgICAgIGJyZWFrOwogICAgfQogIH0KICBjb25zdCBsYXN0QmxvY2tOYW1lID0gaHlkcmF0aW9uUXVldWVbaHlkcmF0aW9uUXVldWUubGVuZ3RoIC0gMV07CiAgYXdhaXQgYmxvY2tzQmVpbmdIeWRyYXRlZC5nZXQobGFzdEJsb2NrTmFtZSk/LnByb21pc2U7CiAgcGVuZGluZ1Rhc2tzLnJlbW92ZSh0YXNrSWQpOwogIGlmIChyZXBsYXlRdWV1ZWRFdmVudHNGbikgewogICAgcmVwbGF5UXVldWVkRXZlbnRzRm4oaHlkcmF0aW9uUXVldWUpOwogIH0KICBjbGVhbnVwSHlkcmF0ZWREZWZlckJsb2NrcyhkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeS5nZXQobGFzdEJsb2NrTmFtZSksIGh5ZHJhdGlvblF1ZXVlLCBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSwgaW5qZWN0b3IuZ2V0KEFwcGxpY2F0aW9uUmVmKSk7Cn0KZnVuY3Rpb24gZGVmZXJCbG9ja0hhc0Vycm9yZWQoZGVmZXJCbG9jaykgewogIHJldHVybiBnZXRMRGVmZXJCbG9ja0RldGFpbHMoZGVmZXJCbG9jay5sVmlldywgZGVmZXJCbG9jay50Tm9kZSlbREVGRVJfQkxPQ0tfU1RBVEVdID09PSBEZWZlckJsb2NrU3RhdGUuRXJyb3I7Cn0KZnVuY3Rpb24gY2xlYW51cFBhcmVudENvbnRhaW5lcihjdXJyZW50QmxvY2tJZHgsIGh5ZHJhdGlvblF1ZXVlLCBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSkgewogIGNvbnN0IHBhcmVudERlZmVyQmxvY2tJZHggPSBjdXJyZW50QmxvY2tJZHggLSAxOwogIGNvbnN0IHBhcmVudERlZmVyQmxvY2sgPSBwYXJlbnREZWZlckJsb2NrSWR4ID4gLTEgPyBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeS5nZXQoaHlkcmF0aW9uUXVldWVbcGFyZW50RGVmZXJCbG9ja0lkeF0pIDogbnVsbDsKICBpZiAocGFyZW50RGVmZXJCbG9jaykgewogICAgY2xlYW51cExDb250YWluZXIocGFyZW50RGVmZXJCbG9jay5sQ29udGFpbmVyKTsKICB9Cn0KZnVuY3Rpb24gY2xlYW51cFJlbWFpbmluZ0h5ZHJhdGlvblF1ZXVlKGh5ZHJhdGlvblF1ZXVlLCBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeSkgewogIGNvbnN0IGJsb2Nrc0JlaW5nSHlkcmF0ZWQgPSBkZWh5ZHJhdGVkQmxvY2tSZWdpc3RyeS5oeWRyYXRpbmc7CiAgZm9yIChjb25zdCBkZWh5ZHJhdGVkQmxvY2tJZCBpbiBoeWRyYXRpb25RdWV1ZSkgewogICAgYmxvY2tzQmVpbmdIeWRyYXRlZC5nZXQoZGVoeWRyYXRlZEJsb2NrSWQpPy5yZWplY3QoKTsKICB9CiAgZGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkuY2xlYW51cChoeWRyYXRpb25RdWV1ZSk7Cn0KZnVuY3Rpb24gcG9wdWxhdGVIeWRyYXRpbmdTdGF0ZUZvclF1ZXVlKHJlZ2lzdHJ5LCBxdWV1ZTIpIHsKICBmb3IgKGxldCBibG9ja0lkIG9mIHF1ZXVlMikgewogICAgcmVnaXN0cnkuaHlkcmF0aW5nLnNldChibG9ja0lkLCBwcm9taXNlV2l0aFJlc29sdmVycygpKTsKICB9Cn0KZnVuY3Rpb24gbmV4dFJlbmRlcihpbmplY3RvcikgewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZUZuKSA9PiBhZnRlck5leHRSZW5kZXIocmVzb2x2ZUZuLCB7CiAgICBpbmplY3RvcgogIH0pKTsKfQphc3luYyBmdW5jdGlvbiB0cmlnZ2VyUmVzb3VyY2VMb2FkaW5nRm9ySHlkcmF0aW9uKGRlaHlkcmF0ZWRCbG9jaykgewogIGNvbnN0IHsKICAgIHROb2RlLAogICAgbFZpZXcKICB9ID0gZGVoeWRyYXRlZEJsb2NrOwogIGNvbnN0IGxEZXRhaWxzID0gZ2V0TERlZmVyQmxvY2tEZXRhaWxzKGxWaWV3LCB0Tm9kZSk7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICBvbkRlZmVyQmxvY2tDb21wbGV0aW9uKGxEZXRhaWxzLCByZXNvbHZlKTsKICAgIHRyaWdnZXJEZWZlckJsb2NrKDIsIGxWaWV3LCB0Tm9kZSk7CiAgfSk7Cn0KZnVuY3Rpb24gb25EZWZlckJsb2NrQ29tcGxldGlvbihsRGV0YWlscywgY2FsbGJhY2spIHsKICBpZiAoIUFycmF5LmlzQXJyYXkobERldGFpbHNbT05fQ09NUExFVEVfRk5TXSkpIHsKICAgIGxEZXRhaWxzW09OX0NPTVBMRVRFX0ZOU10gPSBbXTsKICB9CiAgbERldGFpbHNbT05fQ09NUExFVEVfRk5TXS5wdXNoKGNhbGxiYWNrKTsKfQpmdW5jdGlvbiBzaG91bGRBdHRhY2hUcmlnZ2VyKHRyaWdnZXJUeXBlLCBsVmlldywgdE5vZGUpIHsKICBpZiAodHJpZ2dlclR5cGUgPT09IDApIHsKICAgIHJldHVybiBzaG91bGRBdHRhY2hSZWd1bGFyVHJpZ2dlcihsVmlldywgdE5vZGUpOwogIH0gZWxzZSBpZiAodHJpZ2dlclR5cGUgPT09IDIpIHsKICAgIHJldHVybiAhc2hvdWxkQXR0YWNoUmVndWxhclRyaWdnZXIobFZpZXcsIHROb2RlKTsKICB9CiAgcmV0dXJuIHRydWU7Cn0KZnVuY3Rpb24gaGFzSHlkcmF0ZVRyaWdnZXJzKGZsYWdzKSB7CiAgcmV0dXJuIGZsYWdzICE9IG51bGwgJiYgKGZsYWdzICYgMSkgPT09IDE7Cn0KZnVuY3Rpb24gc2hvdWxkQXR0YWNoUmVndWxhclRyaWdnZXIobFZpZXcsIHROb2RlKSB7CiAgY29uc3QgaW5qZWN0b3IgPSBsVmlld1tJTkpFQ1RPUl07CiAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHMobFZpZXdbVFZJRVddLCB0Tm9kZSk7CiAgY29uc3QgaW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkID0gaXNJbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWQoaW5qZWN0b3IpOwogIGNvbnN0IF9oYXNIeWRyYXRlVHJpZ2dlcnMgPSBoYXNIeWRyYXRlVHJpZ2dlcnModERldGFpbHMuZmxhZ3MpOwogIGlmIChmYWxzZSkgewogICAgcmV0dXJuICFpbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWQgfHwgIV9oYXNIeWRyYXRlVHJpZ2dlcnM7CiAgfQogIGNvbnN0IGxEZXRhaWxzID0gZ2V0TERlZmVyQmxvY2tEZXRhaWxzKGxWaWV3LCB0Tm9kZSk7CiAgY29uc3Qgd2FzU2VydmVyU2lkZVJlbmRlcmVkID0gbERldGFpbHNbU1NSX1VOSVFVRV9JRF0gIT09IG51bGw7CiAgaWYgKF9oYXNIeWRyYXRlVHJpZ2dlcnMgJiYgd2FzU2VydmVyU2lkZVJlbmRlcmVkICYmIGluY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKfQpmdW5jdGlvbiBnZXRIeWRyYXRlVHJpZ2dlcnModFZpZXcsIHROb2RlKSB7CiAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICByZXR1cm4gdERldGFpbHMuaHlkcmF0ZVRyaWdnZXJzID8/PSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwp9CmZ1bmN0aW9uIHByb2Nlc3NBbmRJbml0VHJpZ2dlcnMoaW5qZWN0b3IsIGJsb2NrRGF0YSwgbm9kZXMpIHsKICBjb25zdCBpZGxlRWxlbWVudHMgPSBbXTsKICBjb25zdCB0aW1lckVsZW1lbnRzID0gW107CiAgY29uc3Qgdmlld3BvcnRFbGVtZW50cyA9IFtdOwogIGNvbnN0IGltbWVkaWF0ZUVsZW1lbnRzID0gW107CiAgZm9yIChsZXQgW2Jsb2NrSWQsIGJsb2NrU3VtbWFyeV0gb2YgYmxvY2tEYXRhKSB7CiAgICBjb25zdCBjb21tZW50Tm9kZSA9IG5vZGVzLmdldChibG9ja0lkKTsKICAgIGlmIChjb21tZW50Tm9kZSAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IG51bVJvb3ROb2RlcyA9IGJsb2NrU3VtbWFyeS5kYXRhW05VTV9ST09UX05PREVTXTsKICAgICAgbGV0IGN1cnJlbnROb2RlID0gY29tbWVudE5vZGU7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUm9vdE5vZGVzOyBpKyspIHsKICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLnByZXZpb3VzU2libGluZzsKICAgICAgICBpZiAoY3VycmVudE5vZGUubm9kZVR5cGUgIT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgY29uc3QgZWxlbWVudFRyaWdnZXIgPSB7CiAgICAgICAgICBlbDogY3VycmVudE5vZGUsCiAgICAgICAgICBibG9ja05hbWU6IGJsb2NrSWQKICAgICAgICB9OwogICAgICAgIGlmIChibG9ja1N1bW1hcnkuaHlkcmF0ZS5pZGxlKSB7CiAgICAgICAgICBpZGxlRWxlbWVudHMucHVzaChlbGVtZW50VHJpZ2dlcik7CiAgICAgICAgfQogICAgICAgIGlmIChibG9ja1N1bW1hcnkuaHlkcmF0ZS5pbW1lZGlhdGUpIHsKICAgICAgICAgIGltbWVkaWF0ZUVsZW1lbnRzLnB1c2goZWxlbWVudFRyaWdnZXIpOwogICAgICAgIH0KICAgICAgICBpZiAoYmxvY2tTdW1tYXJ5Lmh5ZHJhdGUudGltZXIgIT09IG51bGwpIHsKICAgICAgICAgIGVsZW1lbnRUcmlnZ2VyLmRlbGF5ID0gYmxvY2tTdW1tYXJ5Lmh5ZHJhdGUudGltZXI7CiAgICAgICAgICB0aW1lckVsZW1lbnRzLnB1c2goZWxlbWVudFRyaWdnZXIpOwogICAgICAgIH0KICAgICAgICBpZiAoYmxvY2tTdW1tYXJ5Lmh5ZHJhdGUudmlld3BvcnQpIHsKICAgICAgICAgIGlmICh0eXBlb2YgYmxvY2tTdW1tYXJ5Lmh5ZHJhdGUudmlld3BvcnQgIT09ICJib29sZWFuIikgewogICAgICAgICAgICBlbGVtZW50VHJpZ2dlci5pbnRlcnNlY3Rpb25PYnNlcnZlck9wdGlvbnMgPSBibG9ja1N1bW1hcnkuaHlkcmF0ZS52aWV3cG9ydDsKICAgICAgICAgIH0KICAgICAgICAgIHZpZXdwb3J0RWxlbWVudHMucHVzaChlbGVtZW50VHJpZ2dlcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHNldElkbGVUcmlnZ2VycyhpbmplY3RvciwgaWRsZUVsZW1lbnRzKTsKICBzZXRJbW1lZGlhdGVUcmlnZ2VycyhpbmplY3RvciwgaW1tZWRpYXRlRWxlbWVudHMpOwogIHNldFZpZXdwb3J0VHJpZ2dlcnMoaW5qZWN0b3IsIHZpZXdwb3J0RWxlbWVudHMpOwogIHNldFRpbWVyVHJpZ2dlcnMoaW5qZWN0b3IsIHRpbWVyRWxlbWVudHMpOwp9CmZ1bmN0aW9uIHNldElkbGVUcmlnZ2VycyhpbmplY3RvciwgZWxlbWVudFRyaWdnZXJzKSB7CiAgZm9yIChjb25zdCBlbGVtZW50VHJpZ2dlciBvZiBlbGVtZW50VHJpZ2dlcnMpIHsKICAgIGNvbnN0IHJlZ2lzdHJ5ID0gaW5qZWN0b3IuZ2V0KERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlkpOwogICAgY29uc3Qgb25JbnZva2UgPSAoKSA9PiB0cmlnZ2VySHlkcmF0aW9uRnJvbUJsb2NrTmFtZShpbmplY3RvciwgZWxlbWVudFRyaWdnZXIuYmxvY2tOYW1lKTsKICAgIGNvbnN0IGNsZWFudXBGbiA9IG9uSWRsZShvbkludm9rZSwgaW5qZWN0b3IpOwogICAgcmVnaXN0cnkuYWRkQ2xlYW51cEZuKGVsZW1lbnRUcmlnZ2VyLmJsb2NrTmFtZSwgY2xlYW51cEZuKTsKICB9Cn0KZnVuY3Rpb24gc2V0Vmlld3BvcnRUcmlnZ2VycyhpbmplY3RvciwgZWxlbWVudFRyaWdnZXJzKSB7CiAgaWYgKGVsZW1lbnRUcmlnZ2Vycy5sZW5ndGggPiAwKSB7CiAgICBjb25zdCByZWdpc3RyeSA9IGluamVjdG9yLmdldChERUhZRFJBVEVEX0JMT0NLX1JFR0lTVFJZKTsKICAgIGZvciAobGV0IGVsZW1lbnRUcmlnZ2VyIG9mIGVsZW1lbnRUcmlnZ2VycykgewogICAgICBjb25zdCBjbGVhbnVwRm4gPSBvblZpZXdwb3J0V3JhcHBlcihlbGVtZW50VHJpZ2dlci5lbCwgKCkgPT4gdHJpZ2dlckh5ZHJhdGlvbkZyb21CbG9ja05hbWUoaW5qZWN0b3IsIGVsZW1lbnRUcmlnZ2VyLmJsb2NrTmFtZSksIGluamVjdG9yLCBlbGVtZW50VHJpZ2dlci5pbnRlcnNlY3Rpb25PYnNlcnZlck9wdGlvbnMpOwogICAgICByZWdpc3RyeS5hZGRDbGVhbnVwRm4oZWxlbWVudFRyaWdnZXIuYmxvY2tOYW1lLCBjbGVhbnVwRm4pOwogICAgfQogIH0KfQpmdW5jdGlvbiBzZXRUaW1lclRyaWdnZXJzKGluamVjdG9yLCBlbGVtZW50VHJpZ2dlcnMpIHsKICBmb3IgKGNvbnN0IGVsZW1lbnRUcmlnZ2VyIG9mIGVsZW1lbnRUcmlnZ2VycykgewogICAgY29uc3QgcmVnaXN0cnkgPSBpbmplY3Rvci5nZXQoREVIWURSQVRFRF9CTE9DS19SRUdJU1RSWSk7CiAgICBjb25zdCBvbkludm9rZSA9ICgpID0+IHRyaWdnZXJIeWRyYXRpb25Gcm9tQmxvY2tOYW1lKGluamVjdG9yLCBlbGVtZW50VHJpZ2dlci5ibG9ja05hbWUpOwogICAgY29uc3QgdGltZXJGbiA9IG9uVGltZXIoZWxlbWVudFRyaWdnZXIuZGVsYXkpOwogICAgY29uc3QgY2xlYW51cEZuID0gdGltZXJGbihvbkludm9rZSwgaW5qZWN0b3IpOwogICAgcmVnaXN0cnkuYWRkQ2xlYW51cEZuKGVsZW1lbnRUcmlnZ2VyLmJsb2NrTmFtZSwgY2xlYW51cEZuKTsKICB9Cn0KZnVuY3Rpb24gc2V0SW1tZWRpYXRlVHJpZ2dlcnMoaW5qZWN0b3IsIGVsZW1lbnRUcmlnZ2VycykgewogIGZvciAoY29uc3QgZWxlbWVudFRyaWdnZXIgb2YgZWxlbWVudFRyaWdnZXJzKSB7CiAgICB0cmlnZ2VySHlkcmF0aW9uRnJvbUJsb2NrTmFtZShpbmplY3RvciwgZWxlbWVudFRyaWdnZXIuYmxvY2tOYW1lKTsKICB9Cn0KdmFyIF9obXJXYXJuaW5nUHJvZHVjZWQgPSBmYWxzZTsKZnVuY3Rpb24gbG9nSG1yV2FybmluZyhpbmplY3RvcikgewogIGlmICghX2htcldhcm5pbmdQcm9kdWNlZCkgewogICAgX2htcldhcm5pbmdQcm9kdWNlZCA9IHRydWU7CiAgICBjb25zdCBjb25zb2xlMiA9IGluamVjdG9yLmdldChDb25zb2xlKTsKICAgIGNvbnNvbGUyLmxvZyhmb3JtYXRSdW50aW1lRXJyb3IoLTc1MSwgIkFuZ3VsYXIgaGFzIGRldGVjdGVkIHRoYXQgdGhpcyBhcHBsaWNhdGlvbiBjb250YWlucyBgQGRlZmVyYCBibG9ja3MgYW5kIHRoZSBob3QgbW9kdWxlIHJlcGxhY2VtZW50IChITVIpIG1vZGUgaXMgZW5hYmxlZC4gQWxsIGBAZGVmZXJgIGJsb2NrIGRlcGVuZGVuY2llcyB3aWxsIGJlIGxvYWRlZCBlYWdlcmx5LiIpKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVyKGluZGV4LCBwcmltYXJ5VG1wbEluZGV4LCBkZXBlbmRlbmN5UmVzb2x2ZXJGbiwgbG9hZGluZ1RtcGxJbmRleCwgcGxhY2Vob2xkZXJUbXBsSW5kZXgsIGVycm9yVG1wbEluZGV4LCBsb2FkaW5nQ29uZmlnSW5kZXgsIHBsYWNlaG9sZGVyQ29uZmlnSW5kZXgsIGVuYWJsZVRpbWVyU2NoZWR1bGluZywgZmxhZ3MpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBpbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgY29uc3QgdE5vZGUgPSBkZWNsYXJlTm9EaXJlY3RpdmVIb3N0VGVtcGxhdGUobFZpZXcsIHRWaWV3LCBpbmRleCwgbnVsbCwgMCwgMCk7CiAgY29uc3QgaW5qZWN0b3IgPSBsVmlld1tJTkpFQ1RPUl07CiAgY29uc3QgaW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkID0gaXNJbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWQoaW5qZWN0b3IpOwogIGlmICh0Vmlldy5maXJzdENyZWF0ZVBhc3MpIHsKICAgIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUoIk5nRGVmZXIiKTsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgaWYgKHRydWUpIHsKICAgICAgICBsb2dIbXJXYXJuaW5nKGluamVjdG9yKTsKICAgICAgfQogICAgICBpZiAoaGFzSHlkcmF0ZVRyaWdnZXJzKGZsYWdzKSAmJiAhaW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkKSB7CiAgICAgICAgd2FybkluY3JlbWVudGFsSHlkcmF0aW9uTm90Q29uZmlndXJlZCgpOwogICAgICB9CiAgICB9CiAgICBjb25zdCB0RGV0YWlscyA9IHsKICAgICAgcHJpbWFyeVRtcGxJbmRleCwKICAgICAgbG9hZGluZ1RtcGxJbmRleDogbG9hZGluZ1RtcGxJbmRleCA/PyBudWxsLAogICAgICBwbGFjZWhvbGRlclRtcGxJbmRleDogcGxhY2Vob2xkZXJUbXBsSW5kZXggPz8gbnVsbCwKICAgICAgZXJyb3JUbXBsSW5kZXg6IGVycm9yVG1wbEluZGV4ID8/IG51bGwsCiAgICAgIHBsYWNlaG9sZGVyQmxvY2tDb25maWc6IG51bGwsCiAgICAgIGxvYWRpbmdCbG9ja0NvbmZpZzogbnVsbCwKICAgICAgZGVwZW5kZW5jeVJlc29sdmVyRm46IGRlcGVuZGVuY3lSZXNvbHZlckZuID8/IG51bGwsCiAgICAgIGxvYWRpbmdTdGF0ZTogRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuTk9UX1NUQVJURUQsCiAgICAgIGxvYWRpbmdQcm9taXNlOiBudWxsLAogICAgICBwcm92aWRlcnM6IG51bGwsCiAgICAgIGh5ZHJhdGVUcmlnZ2VyczogbnVsbCwKICAgICAgZGVidWc6IG51bGwsCiAgICAgIGZsYWdzOiBmbGFncyA/PyAwCiAgICB9OwogICAgZW5hYmxlVGltZXJTY2hlZHVsaW5nPy4odFZpZXcsIHREZXRhaWxzLCBwbGFjZWhvbGRlckNvbmZpZ0luZGV4LCBsb2FkaW5nQ29uZmlnSW5kZXgpOwogICAgc2V0VERlZmVyQmxvY2tEZXRhaWxzKHRWaWV3LCBhZGp1c3RlZEluZGV4LCB0RGV0YWlscyk7CiAgfQogIGNvbnN0IGxDb250YWluZXIgPSBsVmlld1thZGp1c3RlZEluZGV4XTsKICBwb3B1bGF0ZURlaHlkcmF0ZWRWaWV3c0luTENvbnRhaW5lcihsQ29udGFpbmVyLCB0Tm9kZSwgbFZpZXcpOwogIGxldCBzc3JCbG9ja1N0YXRlID0gbnVsbDsKICBsZXQgc3NyVW5pcXVlSWQgPSBudWxsOwogIGlmIChsQ29udGFpbmVyW0RFSFlEUkFURURfVklFV1NdPy5sZW5ndGggPiAwKSB7CiAgICBjb25zdCBpbmZvID0gbENvbnRhaW5lcltERUhZRFJBVEVEX1ZJRVdTXVswXS5kYXRhOwogICAgc3NyVW5pcXVlSWQgPSBpbmZvW0RFRkVSX0JMT0NLX0lEXSA/PyBudWxsOwogICAgc3NyQmxvY2tTdGF0ZSA9IGluZm9bREVGRVJfQkxPQ0tfU1RBVEUkMV07CiAgfQogIGNvbnN0IGxEZXRhaWxzID0gW251bGwsIERlZmVyQmxvY2tJbnRlcm5hbFN0YXRlLkluaXRpYWwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIHNzclVuaXF1ZUlkLCBzc3JCbG9ja1N0YXRlLCBudWxsLCBudWxsXTsKICBzZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIGFkanVzdGVkSW5kZXgsIGxEZXRhaWxzKTsKICBsZXQgcmVnaXN0cnkgPSBudWxsOwogIGlmIChzc3JVbmlxdWVJZCAhPT0gbnVsbCAmJiBpbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWQpIHsKICAgIHJlZ2lzdHJ5ID0gaW5qZWN0b3IuZ2V0KERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlkpOwogICAgcmVnaXN0cnkuYWRkKHNzclVuaXF1ZUlkLCB7CiAgICAgIGxWaWV3LAogICAgICB0Tm9kZSwKICAgICAgbENvbnRhaW5lcgogICAgfSk7CiAgfQogIGNvbnN0IG9uTFZpZXdEZXN0cm95ID0gKCkgPT4gewogICAgaW52b2tlQWxsVHJpZ2dlckNsZWFudXBGbnMobERldGFpbHMpOwogICAgaWYgKHNzclVuaXF1ZUlkICE9PSBudWxsKSB7CiAgICAgIHJlZ2lzdHJ5Py5jbGVhbnVwKFtzc3JVbmlxdWVJZF0pOwogICAgfQogIH07CiAgc3RvcmVUcmlnZ2VyQ2xlYW51cEZuKDAsIGxEZXRhaWxzLCAoKSA9PiByZW1vdmVMVmlld09uRGVzdHJveShsVmlldywgb25MVmlld0Rlc3Ryb3kpKTsKICBzdG9yZUxWaWV3T25EZXN0cm95KGxWaWV3LCBvbkxWaWV3RGVzdHJveSk7Cn0KZnVuY3Rpb24gybXJtWRlZmVyV2hlbihyYXdWYWx1ZSkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldFNlbGVjdGVkVE5vZGUoKTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICB0cmFja1RyaWdnZXJGb3JEZWJ1Z2dpbmcobFZpZXdbVFZJRVddLCB0Tm9kZSwgIndoZW4gPGV4cHJlc3Npb24+Iik7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigwLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgYmluZGluZ0luZGV4ID0gbmV4dEJpbmRpbmdJbmRleCgpOwogIGlmIChiaW5kaW5nVXBkYXRlZChsVmlldywgYmluZGluZ0luZGV4LCByYXdWYWx1ZSkpIHsKICAgIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogICAgdHJ5IHsKICAgICAgY29uc3QgdmFsdWUgPSBCb29sZWFuKHJhd1ZhbHVlKTsKICAgICAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIHROb2RlKTsKICAgICAgY29uc3QgcmVuZGVyZWRTdGF0ZSA9IGxEZXRhaWxzW0RFRkVSX0JMT0NLX1NUQVRFXTsKICAgICAgaWYgKHZhbHVlID09PSBmYWxzZSAmJiByZW5kZXJlZFN0YXRlID09PSBEZWZlckJsb2NrSW50ZXJuYWxTdGF0ZS5Jbml0aWFsKSB7CiAgICAgICAgcmVuZGVyUGxhY2Vob2xkZXIobFZpZXcsIHROb2RlKTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gdHJ1ZSAmJiAocmVuZGVyZWRTdGF0ZSA9PT0gRGVmZXJCbG9ja0ludGVybmFsU3RhdGUuSW5pdGlhbCB8fCByZW5kZXJlZFN0YXRlID09PSBEZWZlckJsb2NrU3RhdGUuUGxhY2Vob2xkZXIpKSB7CiAgICAgICAgdHJpZ2dlckRlZmVyQmxvY2soMCwgbFZpZXcsIHROb2RlKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVyUHJlZmV0Y2hXaGVuKHJhd1ZhbHVlKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCAicHJlZmV0Y2ggd2hlbiA8ZXhwcmVzc2lvbj4iKTsKICB9CiAgaWYgKCFzaG91bGRBdHRhY2hUcmlnZ2VyKDEsIGxWaWV3LCB0Tm9kZSkpIHJldHVybjsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBuZXh0QmluZGluZ0luZGV4KCk7CiAgaWYgKGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHJhd1ZhbHVlKSkgewogICAgY29uc3QgcHJldkNvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgICB0cnkgewogICAgICBjb25zdCB2YWx1ZSA9IEJvb2xlYW4ocmF3VmFsdWUpOwogICAgICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICAgICAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICAgICAgaWYgKHZhbHVlID09PSB0cnVlICYmIHREZXRhaWxzLmxvYWRpbmdTdGF0ZSA9PT0gRGVmZXJEZXBlbmRlbmNpZXNMb2FkaW5nU3RhdGUuTk9UX1NUQVJURUQpIHsKICAgICAgICB0cmlnZ2VyUHJlZmV0Y2hpbmcodERldGFpbHMsIGxWaWV3LCB0Tm9kZSk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIMm1ybVkZWZlckh5ZHJhdGVXaGVuKHJhd1ZhbHVlKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCAiaHlkcmF0ZSB3aGVuIDxleHByZXNzaW9uPiIpOwogIH0KICBpZiAoIXNob3VsZEF0dGFjaFRyaWdnZXIoMiwgbFZpZXcsIHROb2RlKSkgcmV0dXJuOwogIGNvbnN0IGJpbmRpbmdJbmRleCA9IG5leHRCaW5kaW5nSW5kZXgoKTsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgaHlkcmF0ZVRyaWdnZXJzID0gZ2V0SHlkcmF0ZVRyaWdnZXJzKHRWaWV3LCB0Tm9kZSk7CiAgaHlkcmF0ZVRyaWdnZXJzLnNldCg2LCBudWxsKTsKICBpZiAoYmluZGluZ1VwZGF0ZWQobFZpZXcsIGJpbmRpbmdJbmRleCwgcmF3VmFsdWUpKSB7CiAgICBpZiAoZmFsc2UpIHsKICAgICAgdHJpZ2dlckRlZmVyQmxvY2soMiwgbFZpZXcsIHROb2RlKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGluamVjdG9yID0gbFZpZXdbSU5KRUNUT1JdOwogICAgICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB2YWx1ZSA9IEJvb2xlYW4ocmF3VmFsdWUpOwogICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkgewogICAgICAgICAgY29uc3QgbERldGFpbHMgPSBnZXRMRGVmZXJCbG9ja0RldGFpbHMobFZpZXcsIHROb2RlKTsKICAgICAgICAgIGNvbnN0IHNzclVuaXF1ZUlkID0gbERldGFpbHNbU1NSX1VOSVFVRV9JRF07CiAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0U3NySWREZWZpbmVkKHNzclVuaXF1ZUlkKTsKICAgICAgICAgIHRyaWdnZXJIeWRyYXRpb25Gcm9tQmxvY2tOYW1lKGluamVjdG9yLCBzc3JVbmlxdWVJZCk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVySHlkcmF0ZU5ldmVyKCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCAiaHlkcmF0ZSBuZXZlciIpOwogIH0KICBpZiAoIXNob3VsZEF0dGFjaFRyaWdnZXIoMiwgbFZpZXcsIHROb2RlKSkgcmV0dXJuOwogIGNvbnN0IGh5ZHJhdGVUcmlnZ2VycyA9IGdldEh5ZHJhdGVUcmlnZ2VycyhnZXRUVmlldygpLCB0Tm9kZSk7CiAgaHlkcmF0ZVRyaWdnZXJzLnNldCg3LCBudWxsKTsKICBpZiAoZmFsc2UpIHsKICAgIHRyaWdnZXJEZWZlckJsb2NrKDIsIGxWaWV3LCB0Tm9kZSk7CiAgfQp9CmZ1bmN0aW9uIMm1ybVkZWZlck9uSWRsZSgpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICB0cmFja1RyaWdnZXJGb3JEZWJ1Z2dpbmcobFZpZXdbVFZJRVddLCB0Tm9kZSwgIm9uIGlkbGUiKTsKICB9CiAgaWYgKCFzaG91bGRBdHRhY2hUcmlnZ2VyKDAsIGxWaWV3LCB0Tm9kZSkpIHJldHVybjsKICBzY2hlZHVsZURlbGF5ZWRUcmlnZ2VyKG9uSWRsZSk7Cn0KZnVuY3Rpb24gybXJtWRlZmVyUHJlZmV0Y2hPbklkbGUoKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsICJwcmVmZXRjaCBvbiBpZGxlIik7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigxLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgc2NoZWR1bGVEZWxheWVkUHJlZmV0Y2hpbmcob25JZGxlKTsKfQpmdW5jdGlvbiDJtcm1ZGVmZXJIeWRyYXRlT25JZGxlKCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCAiaHlkcmF0ZSBvbiBpZGxlIik7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigyLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgaHlkcmF0ZVRyaWdnZXJzID0gZ2V0SHlkcmF0ZVRyaWdnZXJzKGdldFRWaWV3KCksIHROb2RlKTsKICBoeWRyYXRlVHJpZ2dlcnMuc2V0KDAsIG51bGwpOwogIGlmIChmYWxzZSkgewogICAgdHJpZ2dlckRlZmVyQmxvY2soMiwgbFZpZXcsIHROb2RlKTsKICB9IGVsc2UgewogICAgc2NoZWR1bGVEZWxheWVkSHlkcmF0aW5nKG9uSWRsZSwgbFZpZXcsIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVyT25JbW1lZGlhdGUoKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsICJvbiBpbW1lZGlhdGUiKTsKICB9CiAgaWYgKCFzaG91bGRBdHRhY2hUcmlnZ2VyKDAsIGxWaWV3LCB0Tm9kZSkpIHJldHVybjsKICBjb25zdCB0RGV0YWlscyA9IGdldFREZWZlckJsb2NrRGV0YWlscyhsVmlld1tUVklFV10sIHROb2RlKTsKICBpZiAodERldGFpbHMubG9hZGluZ1RtcGxJbmRleCA9PT0gbnVsbCkgewogICAgcmVuZGVyUGxhY2Vob2xkZXIobFZpZXcsIHROb2RlKTsKICB9CiAgdHJpZ2dlckRlZmVyQmxvY2soMCwgbFZpZXcsIHROb2RlKTsKfQpmdW5jdGlvbiDJtcm1ZGVmZXJQcmVmZXRjaE9uSW1tZWRpYXRlKCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCAicHJlZmV0Y2ggb24gaW1tZWRpYXRlIik7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigxLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICBpZiAodERldGFpbHMubG9hZGluZ1N0YXRlID09PSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5OT1RfU1RBUlRFRCkgewogICAgdHJpZ2dlclJlc291cmNlTG9hZGluZyh0RGV0YWlscywgbFZpZXcsIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVySHlkcmF0ZU9uSW1tZWRpYXRlKCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCAiaHlkcmF0ZSBvbiBpbW1lZGlhdGUiKTsKICB9CiAgaWYgKCFzaG91bGRBdHRhY2hUcmlnZ2VyKDIsIGxWaWV3LCB0Tm9kZSkpIHJldHVybjsKICBjb25zdCBoeWRyYXRlVHJpZ2dlcnMgPSBnZXRIeWRyYXRlVHJpZ2dlcnMoZ2V0VFZpZXcoKSwgdE5vZGUpOwogIGh5ZHJhdGVUcmlnZ2Vycy5zZXQoMSwgbnVsbCk7CiAgaWYgKGZhbHNlKSB7CiAgICB0cmlnZ2VyRGVmZXJCbG9jaygyLCBsVmlldywgdE5vZGUpOwogIH0gZWxzZSB7CiAgICBjb25zdCBpbmplY3RvciA9IGxWaWV3W0lOSkVDVE9SXTsKICAgIGNvbnN0IGxEZXRhaWxzID0gZ2V0TERlZmVyQmxvY2tEZXRhaWxzKGxWaWV3LCB0Tm9kZSk7CiAgICBjb25zdCBzc3JVbmlxdWVJZCA9IGxEZXRhaWxzW1NTUl9VTklRVUVfSURdOwogICAgbmdEZXZNb2RlICYmIGFzc2VydFNzcklkRGVmaW5lZChzc3JVbmlxdWVJZCk7CiAgICB0cmlnZ2VySHlkcmF0aW9uRnJvbUJsb2NrTmFtZShpbmplY3Rvciwgc3NyVW5pcXVlSWQpOwogIH0KfQpmdW5jdGlvbiDJtcm1ZGVmZXJPblRpbWVyKGRlbGF5MikgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCBgb24gdGltZXIoJHtkZWxheTJ9bXMpYCk7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigwLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgc2NoZWR1bGVEZWxheWVkVHJpZ2dlcihvblRpbWVyKGRlbGF5MikpOwp9CmZ1bmN0aW9uIMm1ybVkZWZlclByZWZldGNoT25UaW1lcihkZWxheTIpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICB0cmFja1RyaWdnZXJGb3JEZWJ1Z2dpbmcobFZpZXdbVFZJRVddLCB0Tm9kZSwgYHByZWZldGNoIG9uIHRpbWVyKCR7ZGVsYXkyfW1zKWApOwogIH0KICBpZiAoIXNob3VsZEF0dGFjaFRyaWdnZXIoMSwgbFZpZXcsIHROb2RlKSkgcmV0dXJuOwogIHNjaGVkdWxlRGVsYXllZFByZWZldGNoaW5nKG9uVGltZXIoZGVsYXkyKSk7Cn0KZnVuY3Rpb24gybXJtWRlZmVySHlkcmF0ZU9uVGltZXIoZGVsYXkyKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsIGBoeWRyYXRlIG9uIHRpbWVyKCR7ZGVsYXkyfW1zKWApOwogIH0KICBpZiAoIXNob3VsZEF0dGFjaFRyaWdnZXIoMiwgbFZpZXcsIHROb2RlKSkgcmV0dXJuOwogIGNvbnN0IGh5ZHJhdGVUcmlnZ2VycyA9IGdldEh5ZHJhdGVUcmlnZ2VycyhnZXRUVmlldygpLCB0Tm9kZSk7CiAgaHlkcmF0ZVRyaWdnZXJzLnNldCg1LCB7CiAgICB0eXBlOiA1LAogICAgZGVsYXk6IGRlbGF5MgogIH0pOwogIGlmIChmYWxzZSkgewogICAgdHJpZ2dlckRlZmVyQmxvY2soMiwgbFZpZXcsIHROb2RlKTsKICB9IGVsc2UgewogICAgc2NoZWR1bGVEZWxheWVkSHlkcmF0aW5nKG9uVGltZXIoZGVsYXkyKSwgbFZpZXcsIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVyT25Ib3Zlcih0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsIGBvbiBob3ZlciR7d2Fsa1VwVGltZXMgPT09IC0xID8gIiIgOiAiKDx0YXJnZXQ+KSJ9YCk7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigwLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgcmVuZGVyUGxhY2Vob2xkZXIobFZpZXcsIHROb2RlKTsKICBpZiAodHJ1ZSkgewogICAgcmVnaXN0ZXJEb21UcmlnZ2VyKGxWaWV3LCB0Tm9kZSwgdHJpZ2dlckluZGV4LCB3YWxrVXBUaW1lcywgb25Ib3ZlciwgKCkgPT4gdHJpZ2dlckRlZmVyQmxvY2soMCwgbFZpZXcsIHROb2RlKSwgMCk7CiAgfQp9CmZ1bmN0aW9uIMm1ybVkZWZlclByZWZldGNoT25Ib3Zlcih0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsIGBwcmVmZXRjaCBvbiBob3ZlciR7d2Fsa1VwVGltZXMgPT09IC0xID8gIiIgOiAiKDx0YXJnZXQ+KSJ9YCk7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigxLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICBpZiAodERldGFpbHMubG9hZGluZ1N0YXRlID09PSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5OT1RfU1RBUlRFRCkgewogICAgcmVnaXN0ZXJEb21UcmlnZ2VyKGxWaWV3LCB0Tm9kZSwgdHJpZ2dlckluZGV4LCB3YWxrVXBUaW1lcywgb25Ib3ZlciwgKCkgPT4gdHJpZ2dlclByZWZldGNoaW5nKHREZXRhaWxzLCBsVmlldywgdE5vZGUpLCAxKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVySHlkcmF0ZU9uSG92ZXIoKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsICJoeWRyYXRlIG9uIGhvdmVyIik7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigyLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgaHlkcmF0ZVRyaWdnZXJzID0gZ2V0SHlkcmF0ZVRyaWdnZXJzKGdldFRWaWV3KCksIHROb2RlKTsKICBoeWRyYXRlVHJpZ2dlcnMuc2V0KDQsIG51bGwpOwogIGlmIChmYWxzZSkgewogICAgdHJpZ2dlckRlZmVyQmxvY2soMiwgbFZpZXcsIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVyT25JbnRlcmFjdGlvbih0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsIGBvbiBpbnRlcmFjdGlvbiR7d2Fsa1VwVGltZXMgPT09IC0xID8gIiIgOiAiKDx0YXJnZXQ+KSJ9YCk7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigwLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgcmVuZGVyUGxhY2Vob2xkZXIobFZpZXcsIHROb2RlKTsKICBpZiAodHJ1ZSkgewogICAgcmVnaXN0ZXJEb21UcmlnZ2VyKGxWaWV3LCB0Tm9kZSwgdHJpZ2dlckluZGV4LCB3YWxrVXBUaW1lcywgb25JbnRlcmFjdGlvbiwgKCkgPT4gdHJpZ2dlckRlZmVyQmxvY2soMCwgbFZpZXcsIHROb2RlKSwgMCk7CiAgfQp9CmZ1bmN0aW9uIMm1ybVkZWZlclByZWZldGNoT25JbnRlcmFjdGlvbih0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsIGBwcmVmZXRjaCBvbiBpbnRlcmFjdGlvbiR7d2Fsa1VwVGltZXMgPT09IC0xID8gIiIgOiAiKDx0YXJnZXQ+KSJ9YCk7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigxLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHModFZpZXcsIHROb2RlKTsKICBpZiAodERldGFpbHMubG9hZGluZ1N0YXRlID09PSBEZWZlckRlcGVuZGVuY2llc0xvYWRpbmdTdGF0ZS5OT1RfU1RBUlRFRCkgewogICAgcmVnaXN0ZXJEb21UcmlnZ2VyKGxWaWV3LCB0Tm9kZSwgdHJpZ2dlckluZGV4LCB3YWxrVXBUaW1lcywgb25JbnRlcmFjdGlvbiwgKCkgPT4gdHJpZ2dlclByZWZldGNoaW5nKHREZXRhaWxzLCBsVmlldywgdE5vZGUpLCAxKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVySHlkcmF0ZU9uSW50ZXJhY3Rpb24oKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdHJhY2tUcmlnZ2VyRm9yRGVidWdnaW5nKGxWaWV3W1RWSUVXXSwgdE5vZGUsICJoeWRyYXRlIG9uIGludGVyYWN0aW9uIik7CiAgfQogIGlmICghc2hvdWxkQXR0YWNoVHJpZ2dlcigyLCBsVmlldywgdE5vZGUpKSByZXR1cm47CiAgY29uc3QgaHlkcmF0ZVRyaWdnZXJzID0gZ2V0SHlkcmF0ZVRyaWdnZXJzKGdldFRWaWV3KCksIHROb2RlKTsKICBoeWRyYXRlVHJpZ2dlcnMuc2V0KDMsIG51bGwpOwogIGlmIChmYWxzZSkgewogICAgdHJpZ2dlckRlZmVyQmxvY2soMiwgbFZpZXcsIHROb2RlKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVyT25WaWV3cG9ydCh0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzLCBvcHRpb25zKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgY29uc3QgYXJncyA9IFtdOwogICAgaWYgKHdhbGtVcFRpbWVzICE9PSB2b2lkIDAgJiYgd2Fsa1VwVGltZXMgIT09IC0xKSB7CiAgICAgIGFyZ3MucHVzaCgiPHRhcmdldD4iKTsKICAgIH0KICAgIGlmIChvcHRpb25zKSB7CiAgICAgIGFyZ3MucHVzaChKU09OLnN0cmluZ2lmeShvcHRpb25zKSk7CiAgICB9CiAgICB0cmFja1RyaWdnZXJGb3JEZWJ1Z2dpbmcobFZpZXdbVFZJRVddLCB0Tm9kZSwgYG9uIHZpZXdwb3J0JHthcmdzLmxlbmd0aCA9PT0gMCA/ICIiIDogYCgke2FyZ3Muam9pbigiLCAiKX0pYH1gKTsKICB9CiAgaWYgKCFzaG91bGRBdHRhY2hUcmlnZ2VyKDAsIGxWaWV3LCB0Tm9kZSkpIHJldHVybjsKICByZW5kZXJQbGFjZWhvbGRlcihsVmlldywgdE5vZGUpOwogIGlmICh0cnVlKSB7CiAgICByZWdpc3RlckRvbVRyaWdnZXIobFZpZXcsIHROb2RlLCB0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzLCBvblZpZXdwb3J0V3JhcHBlciwgKCkgPT4gdHJpZ2dlckRlZmVyQmxvY2soMCwgbFZpZXcsIHROb2RlKSwgMCwgb3B0aW9ucyk7CiAgfQp9CmZ1bmN0aW9uIMm1ybVkZWZlclByZWZldGNoT25WaWV3cG9ydCh0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzLCBvcHRpb25zKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgY29uc3QgYXJncyA9IFtdOwogICAgaWYgKHdhbGtVcFRpbWVzICE9PSB2b2lkIDAgJiYgd2Fsa1VwVGltZXMgIT09IC0xKSB7CiAgICAgIGFyZ3MucHVzaCgiPHRhcmdldD4iKTsKICAgIH0KICAgIGlmIChvcHRpb25zKSB7CiAgICAgIGFyZ3MucHVzaChKU09OLnN0cmluZ2lmeShvcHRpb25zKSk7CiAgICB9CiAgICB0cmFja1RyaWdnZXJGb3JEZWJ1Z2dpbmcobFZpZXdbVFZJRVddLCB0Tm9kZSwgYHByZWZldGNoIG9uIHZpZXdwb3J0JHthcmdzLmxlbmd0aCA9PT0gMCA/ICIiIDogYCgke2FyZ3Muam9pbigiLCAiKX0pYH1gKTsKICB9CiAgaWYgKCFzaG91bGRBdHRhY2hUcmlnZ2VyKDEsIGxWaWV3LCB0Tm9kZSkpIHJldHVybjsKICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICBjb25zdCB0RGV0YWlscyA9IGdldFREZWZlckJsb2NrRGV0YWlscyh0VmlldywgdE5vZGUpOwogIGlmICh0RGV0YWlscy5sb2FkaW5nU3RhdGUgPT09IERlZmVyRGVwZW5kZW5jaWVzTG9hZGluZ1N0YXRlLk5PVF9TVEFSVEVEKSB7CiAgICByZWdpc3RlckRvbVRyaWdnZXIobFZpZXcsIHROb2RlLCB0cmlnZ2VySW5kZXgsIHdhbGtVcFRpbWVzLCBvblZpZXdwb3J0V3JhcHBlciwgKCkgPT4gdHJpZ2dlclByZWZldGNoaW5nKHREZXRhaWxzLCBsVmlldywgdE5vZGUpLCAxLCBvcHRpb25zKTsKICB9Cn0KZnVuY3Rpb24gybXJtWRlZmVySHlkcmF0ZU9uVmlld3BvcnQob3B0aW9ucykgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHRyYWNrVHJpZ2dlckZvckRlYnVnZ2luZyhsVmlld1tUVklFV10sIHROb2RlLCBgaHlkcmF0ZSBvbiB2aWV3cG9ydCR7b3B0aW9ucyA/IGAoJHtKU09OLnN0cmluZ2lmeShvcHRpb25zKX0pYCA6ICIifWApOwogIH0KICBpZiAoIXNob3VsZEF0dGFjaFRyaWdnZXIoMiwgbFZpZXcsIHROb2RlKSkgcmV0dXJuOwogIGNvbnN0IGh5ZHJhdGVUcmlnZ2VycyA9IGdldEh5ZHJhdGVUcmlnZ2VycyhnZXRUVmlldygpLCB0Tm9kZSk7CiAgaHlkcmF0ZVRyaWdnZXJzLnNldCgyLCBvcHRpb25zID8gewogICAgdHlwZTogMiwKICAgIGludGVyc2VjdGlvbk9ic2VydmVyT3B0aW9uczogb3B0aW9ucwogIH0gOiBudWxsKTsKICBpZiAoZmFsc2UpIHsKICAgIHRyaWdnZXJEZWZlckJsb2NrKDIsIGxWaWV3LCB0Tm9kZSk7CiAgfQp9CmZ1bmN0aW9uIMm1ybVhcmlhUHJvcGVydHkobmFtZSwgdmFsdWUpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gbmV4dEJpbmRpbmdJbmRleCgpOwogIGlmIChiaW5kaW5nVXBkYXRlZChsVmlldywgYmluZGluZ0luZGV4LCB2YWx1ZSkpIHsKICAgIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICAgIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogICAgY29uc3QgaGFzU2V0SW5wdXQgPSBzZXRBbGxJbnB1dHNGb3JQcm9wZXJ0eSh0Tm9kZSwgdFZpZXcsIGxWaWV3LCBuYW1lLCB2YWx1ZSk7CiAgICBpZiAoaGFzU2V0SW5wdXQpIHsKICAgICAgaXNDb21wb25lbnRIb3N0KHROb2RlKSAmJiBtYXJrRGlydHlJZk9uUHVzaChsVmlldywgdE5vZGUuaW5kZXgpOwogICAgICBuZ0Rldk1vZGUgJiYgc2V0TmdSZWZsZWN0UHJvcGVydGllcyhsVmlldywgdFZpZXcsIHROb2RlLCBuYW1lLCB2YWx1ZSk7CiAgICB9IGVsc2UgewogICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVUeXBlKHROb2RlLCAyKTsKICAgICAgY29uc3QgZWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICAgICAgc2V0RWxlbWVudEF0dHJpYnV0ZShsVmlld1tSRU5ERVJFUl0sIGVsZW1lbnQsIG51bGwsIHROb2RlLnZhbHVlLCBuYW1lLCB2YWx1ZSwgbnVsbCk7CiAgICB9CiAgICBuZ0Rldk1vZGUgJiYgc3RvcmVQcm9wZXJ0eUJpbmRpbmdNZXRhZGF0YSh0Vmlldy5kYXRhLCB0Tm9kZSwgbmFtZSwgYmluZGluZ0luZGV4KTsKICB9CiAgcmV0dXJuIMm1ybVhcmlhUHJvcGVydHk7Cn0KZnVuY3Rpb24gybXJtWF0dHJpYnV0ZShuYW1lLCB2YWx1ZSwgc2FuaXRpemVyLCBuYW1lc3BhY2UpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gbmV4dEJpbmRpbmdJbmRleCgpOwogIGlmIChiaW5kaW5nVXBkYXRlZChsVmlldywgYmluZGluZ0luZGV4LCB2YWx1ZSkpIHsKICAgIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICAgIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogICAgZWxlbWVudEF0dHJpYnV0ZUludGVybmFsKHROb2RlLCBsVmlldywgbmFtZSwgdmFsdWUsIHNhbml0aXplciwgbmFtZXNwYWNlKTsKICAgIG5nRGV2TW9kZSAmJiBzdG9yZVByb3BlcnR5QmluZGluZ01ldGFkYXRhKHRWaWV3LmRhdGEsIHROb2RlLCAiYXR0ci4iICsgbmFtZSwgYmluZGluZ0luZGV4KTsKICB9CiAgcmV0dXJuIMm1ybVhdHRyaWJ1dGU7Cn0KdmFyIEFOSU1BVElPTlNfRElTQUJMRUQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIkFuaW1hdGlvbnNEaXNhYmxlZCIgOiAiIiwgewogIGZhY3Rvcnk6ICgpID0+IGZhbHNlCn0pOwp2YXIgTUFYX0FOSU1BVElPTl9USU1FT1VUID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJNYXhBbmltYXRpb25UaW1lb3V0IiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gTUFYX0FOSU1BVElPTl9USU1FT1VUX0RFRkFVTFQKfSk7CnZhciBNQVhfQU5JTUFUSU9OX1RJTUVPVVRfREVGQVVMVCA9IDRlMzsKdmFyIERFRkFVTFRfQU5JTUFUSU9OU19ESVNBQkxFRCA9IGZhbHNlOwp2YXIgYXJlQW5pbWF0aW9uU3VwcG9ydGVkID0gdHlwZW9mIGRvY3VtZW50ICE9PSAidW5kZWZpbmVkIiAmJiB0eXBlb2YgZG9jdW1lbnQ/LmRvY3VtZW50RWxlbWVudD8uZ2V0QW5pbWF0aW9ucyA9PT0gImZ1bmN0aW9uIjsKZnVuY3Rpb24gYXJlQW5pbWF0aW9uc0Rpc2FibGVkKGxWaWV3KSB7CiAgY29uc3QgaW5qZWN0b3IgPSBsVmlld1tJTkpFQ1RPUl07CiAgcmV0dXJuIGluamVjdG9yLmdldChBTklNQVRJT05TX0RJU0FCTEVELCBERUZBVUxUX0FOSU1BVElPTlNfRElTQUJMRUQpOwp9CmZ1bmN0aW9uIGFzc2VydEFuaW1hdGlvblR5cGVzKHZhbHVlLCBpbnN0cnVjdGlvbikgewogIGlmICh2YWx1ZSA9PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSAhPT0gInN0cmluZyIgJiYgdHlwZW9mIHZhbHVlICE9PSAiZnVuY3Rpb24iKSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDY1MCwgYCcke2luc3RydWN0aW9ufScgdmFsdWUgbXVzdCBiZSBhIHN0cmluZyBvZiBDU1MgY2xhc3NlcyBvciBhbiBhbmltYXRpb24gZnVuY3Rpb24sIGdvdCAke3N0cmluZ2lmeSh2YWx1ZSl9YCk7CiAgfQp9CmZ1bmN0aW9uIGFzc2VydEVsZW1lbnROb2RlcyhuYXRpdmVFbGVtZW50LCBpbnN0cnVjdGlvbikgewogIGlmIChuYXRpdmVFbGVtZW50Lm5vZGVUeXBlICE9PSBOb2RlLkVMRU1FTlRfTk9ERSkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig2NTAsIGAnJHtpbnN0cnVjdGlvbn0nIGNhbiBvbmx5IGJlIHVzZWQgb24gYW4gZWxlbWVudCBub2RlLCBnb3QgJHtzdHJpbmdpZnkobmF0aXZlRWxlbWVudC5ub2RlVHlwZSl9YCk7CiAgfQp9CmZ1bmN0aW9uIHRyYWNrRW50ZXJDbGFzc2VzKGVsLCBjbGFzc0xpc3QsIGNsZWFudXBGbnMpIHsKICBjb25zdCBlbGVtZW50RGF0YSA9IGVudGVyQ2xhc3NNYXAuZ2V0KGVsKTsKICBpZiAoZWxlbWVudERhdGEpIHsKICAgIGZvciAoY29uc3Qga2xhc3Mgb2YgY2xhc3NMaXN0KSB7CiAgICAgIGVsZW1lbnREYXRhLmNsYXNzTGlzdC5wdXNoKGtsYXNzKTsKICAgIH0KICAgIGZvciAoY29uc3QgZm4gb2YgY2xlYW51cEZucykgewogICAgICBlbGVtZW50RGF0YS5jbGVhbnVwRm5zLnB1c2goZm4pOwogICAgfQogIH0gZWxzZSB7CiAgICBlbnRlckNsYXNzTWFwLnNldChlbCwgewogICAgICBjbGFzc0xpc3QsCiAgICAgIGNsZWFudXBGbnMKICAgIH0pOwogIH0KfQpmdW5jdGlvbiBjbGVhbnVwRW50ZXJDbGFzc0RhdGEoZWxlbWVudCkgewogIGNvbnN0IGVsZW1lbnREYXRhID0gZW50ZXJDbGFzc01hcC5nZXQoZWxlbWVudCk7CiAgaWYgKGVsZW1lbnREYXRhKSB7CiAgICBmb3IgKGNvbnN0IGZuIG9mIGVsZW1lbnREYXRhLmNsZWFudXBGbnMpIHsKICAgICAgZm4oKTsKICAgIH0KICAgIGVudGVyQ2xhc3NNYXAuZGVsZXRlKGVsZW1lbnQpOwogIH0KICBsb25nZXN0QW5pbWF0aW9ucy5kZWxldGUoZWxlbWVudCk7Cn0KdmFyIG5vT3BBbmltYXRpb25Db21wbGV0ZSA9ICgpID0+IHsKfTsKdmFyIGVudGVyQ2xhc3NNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKdmFyIGxvbmdlc3RBbmltYXRpb25zID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CnZhciBsZWF2aW5nTm9kZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKZnVuY3Rpb24gY2xlYXJMZWF2aW5nTm9kZXModE5vZGUsIGVsKSB7CiAgY29uc3Qgbm9kZXMgPSBsZWF2aW5nTm9kZXMuZ2V0KHROb2RlKTsKICBpZiAobm9kZXMgJiYgbm9kZXMubGVuZ3RoID4gMCkgewogICAgY29uc3QgaXggPSBub2Rlcy5maW5kSW5kZXgoKG5vZGUpID0+IG5vZGUgPT09IGVsKTsKICAgIGlmIChpeCA+IC0xKSBub2Rlcy5zcGxpY2UoaXgsIDEpOwogIH0KICBpZiAobm9kZXM/Lmxlbmd0aCA9PT0gMCkgewogICAgbGVhdmluZ05vZGVzLmRlbGV0ZSh0Tm9kZSk7CiAgfQp9CmZ1bmN0aW9uIGNhbmNlbExlYXZpbmdOb2Rlcyh0Tm9kZSwgbFZpZXcpIHsKICBjb25zdCBsZWF2aW5nRWwgPSBsZWF2aW5nTm9kZXMuZ2V0KHROb2RlKT8uc2hpZnQoKTsKICBjb25zdCBsQ29udGFpbmVyID0gbFZpZXdbREVDTEFSQVRJT05fTENPTlRBSU5FUl07CiAgaWYgKGxDb250YWluZXIpIHsKICAgIGNvbnN0IGJlZm9yZU5vZGUgPSBnZXRCZWZvcmVOb2RlRm9yVmlldyh0Tm9kZS5pbmRleCwgbENvbnRhaW5lcik7CiAgICBjb25zdCBwcmV2aW91c05vZGUgPSBiZWZvcmVOb2RlPy5wcmV2aW91c1NpYmxpbmc7CiAgICBpZiAobGVhdmluZ0VsICYmIHByZXZpb3VzTm9kZSAmJiBsZWF2aW5nRWwgPT09IHByZXZpb3VzTm9kZSkgewogICAgICBsZWF2aW5nRWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImFuaW1hdGlvbmVuZCIsIHsKICAgICAgICBkZXRhaWw6IHsKICAgICAgICAgIGNhbmNlbDogdHJ1ZQogICAgICAgIH0KICAgICAgfSkpOwogICAgfQogIH0KfQpmdW5jdGlvbiB0cmFja0xlYXZpbmdOb2Rlcyh0Tm9kZSwgZWwpIHsKICBpZiAobGVhdmluZ05vZGVzLmhhcyh0Tm9kZSkpIHsKICAgIGxlYXZpbmdOb2Rlcy5nZXQodE5vZGUpPy5wdXNoKGVsKTsKICB9IGVsc2UgewogICAgbGVhdmluZ05vZGVzLnNldCh0Tm9kZSwgW2VsXSk7CiAgfQp9CmZ1bmN0aW9uIGdldExWaWV3RW50ZXJBbmltYXRpb25zKGxWaWV3KSB7CiAgY29uc3QgYW5pbWF0aW9uRGF0YSA9IGxWaWV3W0FOSU1BVElPTlNdID8/PSB7fTsKICByZXR1cm4gYW5pbWF0aW9uRGF0YS5lbnRlciA/Pz0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKfQpmdW5jdGlvbiBnZXRMVmlld0xlYXZlQW5pbWF0aW9ucyhsVmlldykgewogIGNvbnN0IGFuaW1hdGlvbkRhdGEgPSBsVmlld1tBTklNQVRJT05TXSA/Pz0ge307CiAgcmV0dXJuIGFuaW1hdGlvbkRhdGEubGVhdmUgPz89IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7Cn0KZnVuY3Rpb24gZ2V0Q2xhc3NMaXN0RnJvbVZhbHVlKHZhbHVlKSB7CiAgY29uc3QgY2xhc3NlcyA9IHR5cGVvZiB2YWx1ZSA9PT0gImZ1bmN0aW9uIiA/IHZhbHVlKCkgOiB2YWx1ZTsKICBsZXQgY2xhc3NMaXN0ID0gQXJyYXkuaXNBcnJheShjbGFzc2VzKSA/IGNsYXNzZXMgOiBudWxsOwogIGlmICh0eXBlb2YgY2xhc3NlcyA9PT0gInN0cmluZyIpIHsKICAgIGNsYXNzTGlzdCA9IGNsYXNzZXMudHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoKGspID0+IGspOwogIH0KICByZXR1cm4gY2xhc3NMaXN0Owp9CmZ1bmN0aW9uIGNhbmNlbEFuaW1hdGlvbnNJZlJ1bm5pbmcoZWxlbWVudCwgcmVuZGVyZXIpIHsKICBpZiAoIWFyZUFuaW1hdGlvblN1cHBvcnRlZCkgcmV0dXJuOwogIGNvbnN0IGVsZW1lbnREYXRhID0gZW50ZXJDbGFzc01hcC5nZXQoZWxlbWVudCk7CiAgaWYgKGVsZW1lbnREYXRhICYmIGVsZW1lbnREYXRhLmNsYXNzTGlzdC5sZW5ndGggPiAwICYmIGVsZW1lbnRIYXNDbGFzc0xpc3QoZWxlbWVudCwgZWxlbWVudERhdGEuY2xhc3NMaXN0KSkgewogICAgZm9yIChjb25zdCBrbGFzcyBvZiBlbGVtZW50RGF0YS5jbGFzc0xpc3QpIHsKICAgICAgcmVuZGVyZXIucmVtb3ZlQ2xhc3MoZWxlbWVudCwga2xhc3MpOwogICAgfQogIH0KICBjbGVhbnVwRW50ZXJDbGFzc0RhdGEoZWxlbWVudCk7Cn0KZnVuY3Rpb24gZWxlbWVudEhhc0NsYXNzTGlzdChlbGVtZW50LCBjbGFzc0xpc3QpIHsKICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBjbGFzc0xpc3QpIHsKICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpKSByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGlzTG9uZ2VzdEFuaW1hdGlvbihldmVudCwgbmF0aXZlRWxlbWVudCkgewogIGNvbnN0IGxvbmdlc3RBbmltYXRpb24gPSBsb25nZXN0QW5pbWF0aW9ucy5nZXQobmF0aXZlRWxlbWVudCk7CiAgaWYgKGxvbmdlc3RBbmltYXRpb24gPT09IHZvaWQgMCkgcmV0dXJuIHRydWU7CiAgcmV0dXJuIG5hdGl2ZUVsZW1lbnQgPT09IGV2ZW50LnRhcmdldCAmJiAobG9uZ2VzdEFuaW1hdGlvbi5hbmltYXRpb25OYW1lICE9PSB2b2lkIDAgJiYgZXZlbnQuYW5pbWF0aW9uTmFtZSA9PT0gbG9uZ2VzdEFuaW1hdGlvbi5hbmltYXRpb25OYW1lIHx8IGxvbmdlc3RBbmltYXRpb24ucHJvcGVydHlOYW1lICE9PSB2b2lkIDAgJiYgZXZlbnQucHJvcGVydHlOYW1lID09PSBsb25nZXN0QW5pbWF0aW9uLnByb3BlcnR5TmFtZSk7Cn0KZnVuY3Rpb24gYWRkQW5pbWF0aW9uVG9MVmlldyhhbmltYXRpb25zLCB0Tm9kZSwgZm4pIHsKICBjb25zdCBub2RlQW5pbWF0aW9ucyA9IGFuaW1hdGlvbnMuZ2V0KHROb2RlLmluZGV4KSA/PyB7CiAgICBhbmltYXRlRm5zOiBbXQogIH07CiAgbm9kZUFuaW1hdGlvbnMuYW5pbWF0ZUZucy5wdXNoKGZuKTsKICBhbmltYXRpb25zLnNldCh0Tm9kZS5pbmRleCwgbm9kZUFuaW1hdGlvbnMpOwp9CmZ1bmN0aW9uIGNsZWFudXBBZnRlckxlYXZlQW5pbWF0aW9ucyhyZXNvbHZlcnMsIGNsZWFudXBGbnMpIHsKICBpZiAocmVzb2x2ZXJzKSB7CiAgICBmb3IgKGNvbnN0IGZuIG9mIHJlc29sdmVycykgewogICAgICBmbigpOwogICAgfQogIH0KICBmb3IgKGNvbnN0IGZuIG9mIGNsZWFudXBGbnMpIHsKICAgIGZuKCk7CiAgfQp9CmZ1bmN0aW9uIGNsZWFyTFZpZXdOb2RlQW5pbWF0aW9uUmVzb2x2ZXJzKGxWaWV3LCB0Tm9kZSkgewogIGNvbnN0IG5vZGVBbmltYXRpb25zID0gZ2V0TFZpZXdMZWF2ZUFuaW1hdGlvbnMobFZpZXcpLmdldCh0Tm9kZS5pbmRleCk7CiAgaWYgKG5vZGVBbmltYXRpb25zKSBub2RlQW5pbWF0aW9ucy5yZXNvbHZlcnMgPSB2b2lkIDA7Cn0KZnVuY3Rpb24gbGVhdmVBbmltYXRpb25GdW5jdGlvbkNsZWFudXAobFZpZXcsIHROb2RlLCBuYXRpdmVFbGVtZW50LCByZXNvbHZlcnMsIGNsZWFudXBGbnMpIHsKICBjbGVhckxlYXZpbmdOb2Rlcyh0Tm9kZSwgbmF0aXZlRWxlbWVudCk7CiAgY2xlYW51cEFmdGVyTGVhdmVBbmltYXRpb25zKHJlc29sdmVycywgY2xlYW51cEZucyk7CiAgY2xlYXJMVmlld05vZGVBbmltYXRpb25SZXNvbHZlcnMobFZpZXcsIHROb2RlKTsKfQpmdW5jdGlvbiDJtcm1YW5pbWF0ZUVudGVyKHZhbHVlKSB7CiAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiTmdBbmltYXRlRW50ZXIiKTsKICBpZiAoIWFyZUFuaW1hdGlvblN1cHBvcnRlZCkgewogICAgcmV0dXJuIMm1ybVhbmltYXRlRW50ZXI7CiAgfQogIG5nRGV2TW9kZSAmJiBhc3NlcnRBbmltYXRpb25UeXBlcyh2YWx1ZSwgImFuaW1hdGUuZW50ZXIiKTsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgaWYgKGFyZUFuaW1hdGlvbnNEaXNhYmxlZChsVmlldykpIHsKICAgIHJldHVybiDJtcm1YW5pbWF0ZUVudGVyOwogIH0KICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGNhbmNlbExlYXZpbmdOb2Rlcyh0Tm9kZSwgbFZpZXcpOwogIGFkZEFuaW1hdGlvblRvTFZpZXcoZ2V0TFZpZXdFbnRlckFuaW1hdGlvbnMobFZpZXcpLCB0Tm9kZSwgKCkgPT4gcnVuRW50ZXJBbmltYXRpb24obFZpZXcsIHROb2RlLCB2YWx1ZSkpOwogIGluaXRpYWxpemVBbmltYXRpb25RdWV1ZVNjaGVkdWxlcihsVmlld1tJTkpFQ1RPUl0pOwogIHF1ZXVlRW50ZXJBbmltYXRpb25zKGxWaWV3W0lOSkVDVE9SXSwgZ2V0TFZpZXdFbnRlckFuaW1hdGlvbnMobFZpZXcpKTsKICByZXR1cm4gybXJtWFuaW1hdGVFbnRlcjsKfQpmdW5jdGlvbiBydW5FbnRlckFuaW1hdGlvbihsVmlldywgdE5vZGUsIHZhbHVlKSB7CiAgY29uc3QgbmF0aXZlRWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RWxlbWVudE5vZGVzKG5hdGl2ZUVsZW1lbnQsICJhbmltYXRlLmVudGVyIik7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgY29uc3Qgbmdab25lID0gbFZpZXdbSU5KRUNUT1JdLmdldChOZ1pvbmUpOwogIGNvbnN0IGFjdGl2ZUNsYXNzZXMgPSBnZXRDbGFzc0xpc3RGcm9tVmFsdWUodmFsdWUpOwogIGNvbnN0IGNsZWFudXBGbnMgPSBbXTsKICBjb25zdCBoYW5kbGVFbnRlckFuaW1hdGlvblN0YXJ0ID0gKGV2ZW50KSA9PiB7CiAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSBuYXRpdmVFbGVtZW50KSByZXR1cm47CiAgICBjb25zdCBldmVudE5hbWUgPSBldmVudCBpbnN0YW5jZW9mIEFuaW1hdGlvbkV2ZW50ID8gImFuaW1hdGlvbmVuZCIgOiAidHJhbnNpdGlvbmVuZCI7CiAgICBuZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gewogICAgICByZW5kZXJlci5saXN0ZW4obmF0aXZlRWxlbWVudCwgZXZlbnROYW1lLCBoYW5kbGVFbnRlckFuaW1hdGlvbkVuZCk7CiAgICB9KTsKICB9OwogIGNvbnN0IGhhbmRsZUVudGVyQW5pbWF0aW9uRW5kID0gKGV2ZW50KSA9PiB7CiAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSBuYXRpdmVFbGVtZW50KSByZXR1cm47CiAgICBlbnRlckFuaW1hdGlvbkVuZChldmVudCwgbmF0aXZlRWxlbWVudCwgcmVuZGVyZXIpOwogIH07CiAgaWYgKGFjdGl2ZUNsYXNzZXMgJiYgYWN0aXZlQ2xhc3Nlcy5sZW5ndGggPiAwKSB7CiAgICBuZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gewogICAgICBjbGVhbnVwRm5zLnB1c2gocmVuZGVyZXIubGlzdGVuKG5hdGl2ZUVsZW1lbnQsICJhbmltYXRpb25zdGFydCIsIGhhbmRsZUVudGVyQW5pbWF0aW9uU3RhcnQpKTsKICAgICAgY2xlYW51cEZucy5wdXNoKHJlbmRlcmVyLmxpc3RlbihuYXRpdmVFbGVtZW50LCAidHJhbnNpdGlvbnN0YXJ0IiwgaGFuZGxlRW50ZXJBbmltYXRpb25TdGFydCkpOwogICAgfSk7CiAgICB0cmFja0VudGVyQ2xhc3NlcyhuYXRpdmVFbGVtZW50LCBhY3RpdmVDbGFzc2VzLCBjbGVhbnVwRm5zKTsKICAgIGZvciAoY29uc3Qga2xhc3Mgb2YgYWN0aXZlQ2xhc3NlcykgewogICAgICByZW5kZXJlci5hZGRDbGFzcyhuYXRpdmVFbGVtZW50LCBrbGFzcyk7CiAgICB9CiAgICBuZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gewogICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICAgIGRldGVybWluZUxvbmdlc3RBbmltYXRpb24obmF0aXZlRWxlbWVudCwgbG9uZ2VzdEFuaW1hdGlvbnMsIGFyZUFuaW1hdGlvblN1cHBvcnRlZCk7CiAgICAgICAgaWYgKCFsb25nZXN0QW5pbWF0aW9ucy5oYXMobmF0aXZlRWxlbWVudCkpIHsKICAgICAgICAgIGZvciAoY29uc3Qga2xhc3Mgb2YgYWN0aXZlQ2xhc3NlcykgewogICAgICAgICAgICByZW5kZXJlci5yZW1vdmVDbGFzcyhuYXRpdmVFbGVtZW50LCBrbGFzcyk7CiAgICAgICAgICB9CiAgICAgICAgICBjbGVhbnVwRW50ZXJDbGFzc0RhdGEobmF0aXZlRWxlbWVudCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogIH0KfQpmdW5jdGlvbiBlbnRlckFuaW1hdGlvbkVuZChldmVudCwgbmF0aXZlRWxlbWVudCwgcmVuZGVyZXIpIHsKICBjb25zdCBlbGVtZW50RGF0YSA9IGVudGVyQ2xhc3NNYXAuZ2V0KG5hdGl2ZUVsZW1lbnQpOwogIGlmIChldmVudC50YXJnZXQgIT09IG5hdGl2ZUVsZW1lbnQgfHwgIWVsZW1lbnREYXRhKSByZXR1cm47CiAgaWYgKGlzTG9uZ2VzdEFuaW1hdGlvbihldmVudCwgbmF0aXZlRWxlbWVudCkpIHsKICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwogICAgZm9yIChjb25zdCBrbGFzcyBvZiBlbGVtZW50RGF0YS5jbGFzc0xpc3QpIHsKICAgICAgcmVuZGVyZXIucmVtb3ZlQ2xhc3MobmF0aXZlRWxlbWVudCwga2xhc3MpOwogICAgfQogICAgY2xlYW51cEVudGVyQ2xhc3NEYXRhKG5hdGl2ZUVsZW1lbnQpOwogIH0KfQpmdW5jdGlvbiDJtcm1YW5pbWF0ZUVudGVyTGlzdGVuZXIodmFsdWUpIHsKICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0FuaW1hdGVFbnRlciIpOwogIGlmICghYXJlQW5pbWF0aW9uU3VwcG9ydGVkKSB7CiAgICByZXR1cm4gybXJtWFuaW1hdGVFbnRlckxpc3RlbmVyOwogIH0KICBuZ0Rldk1vZGUgJiYgYXNzZXJ0QW5pbWF0aW9uVHlwZXModmFsdWUsICJhbmltYXRlLmVudGVyIik7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGlmIChhcmVBbmltYXRpb25zRGlzYWJsZWQobFZpZXcpKSB7CiAgICByZXR1cm4gybXJtWFuaW1hdGVFbnRlckxpc3RlbmVyOwogIH0KICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGNhbmNlbExlYXZpbmdOb2Rlcyh0Tm9kZSwgbFZpZXcpOwogIGFkZEFuaW1hdGlvblRvTFZpZXcoZ2V0TFZpZXdFbnRlckFuaW1hdGlvbnMobFZpZXcpLCB0Tm9kZSwgKCkgPT4gcnVuRW50ZXJBbmltYXRpb25GdW5jdGlvbihsVmlldywgdE5vZGUsIHZhbHVlKSk7CiAgaW5pdGlhbGl6ZUFuaW1hdGlvblF1ZXVlU2NoZWR1bGVyKGxWaWV3W0lOSkVDVE9SXSk7CiAgcXVldWVFbnRlckFuaW1hdGlvbnMobFZpZXdbSU5KRUNUT1JdLCBnZXRMVmlld0VudGVyQW5pbWF0aW9ucyhsVmlldykpOwogIHJldHVybiDJtcm1YW5pbWF0ZUVudGVyTGlzdGVuZXI7Cn0KZnVuY3Rpb24gcnVuRW50ZXJBbmltYXRpb25GdW5jdGlvbihsVmlldywgdE5vZGUsIHZhbHVlKSB7CiAgY29uc3QgbmF0aXZlRWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RWxlbWVudE5vZGVzKG5hdGl2ZUVsZW1lbnQsICJhbmltYXRlLmVudGVyIik7CiAgdmFsdWUuY2FsbChsVmlld1tDT05URVhUXSwgewogICAgdGFyZ2V0OiBuYXRpdmVFbGVtZW50LAogICAgYW5pbWF0aW9uQ29tcGxldGU6IG5vT3BBbmltYXRpb25Db21wbGV0ZQogIH0pOwp9CmZ1bmN0aW9uIMm1ybVhbmltYXRlTGVhdmUodmFsdWUpIHsKICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0FuaW1hdGVMZWF2ZSIpOwogIGlmICghYXJlQW5pbWF0aW9uU3VwcG9ydGVkKSB7CiAgICByZXR1cm4gybXJtWFuaW1hdGVMZWF2ZTsKICB9CiAgbmdEZXZNb2RlICYmIGFzc2VydEFuaW1hdGlvblR5cGVzKHZhbHVlLCAiYW5pbWF0ZS5sZWF2ZSIpOwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBhbmltYXRpb25zRGlzYWJsZWQgPSBhcmVBbmltYXRpb25zRGlzYWJsZWQobFZpZXcpOwogIGlmIChhbmltYXRpb25zRGlzYWJsZWQpIHsKICAgIHJldHVybiDJtcm1YW5pbWF0ZUxlYXZlOwogIH0KICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGNhbmNlbExlYXZpbmdOb2Rlcyh0Tm9kZSwgbFZpZXcpOwogIGFkZEFuaW1hdGlvblRvTFZpZXcoZ2V0TFZpZXdMZWF2ZUFuaW1hdGlvbnMobFZpZXcpLCB0Tm9kZSwgKCkgPT4gcnVuTGVhdmVBbmltYXRpb25zKGxWaWV3LCB0Tm9kZSwgdmFsdWUpKTsKICBpbml0aWFsaXplQW5pbWF0aW9uUXVldWVTY2hlZHVsZXIobFZpZXdbSU5KRUNUT1JdKTsKICByZXR1cm4gybXJtWFuaW1hdGVMZWF2ZTsKfQpmdW5jdGlvbiBydW5MZWF2ZUFuaW1hdGlvbnMobFZpZXcsIHROb2RlLCB2YWx1ZSkgewogIGNvbnN0IHsKICAgIHByb21pc2UsCiAgICByZXNvbHZlCiAgfSA9IHByb21pc2VXaXRoUmVzb2x2ZXJzKCk7CiAgY29uc3QgbmF0aXZlRWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RWxlbWVudE5vZGVzKG5hdGl2ZUVsZW1lbnQsICJhbmltYXRlLmxlYXZlIik7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgY29uc3Qgbmdab25lID0gbFZpZXdbSU5KRUNUT1JdLmdldChOZ1pvbmUpOwogIGFsbExlYXZpbmdBbmltYXRpb25zLmFkZChsVmlld1tJRF0pOwogIChnZXRMVmlld0xlYXZlQW5pbWF0aW9ucyhsVmlldykuZ2V0KHROb2RlLmluZGV4KS5yZXNvbHZlcnMgPz89IFtdKS5wdXNoKHJlc29sdmUpOwogIGNvbnN0IGFjdGl2ZUNsYXNzZXMgPSBnZXRDbGFzc0xpc3RGcm9tVmFsdWUodmFsdWUpOwogIGlmIChhY3RpdmVDbGFzc2VzICYmIGFjdGl2ZUNsYXNzZXMubGVuZ3RoID4gMCkgewogICAgYW5pbWF0ZUxlYXZlQ2xhc3NSdW5uZXIobmF0aXZlRWxlbWVudCwgdE5vZGUsIGxWaWV3LCBhY3RpdmVDbGFzc2VzLCByZW5kZXJlciwgbmdab25lKTsKICB9IGVsc2UgewogICAgcmVzb2x2ZSgpOwogIH0KICByZXR1cm4gewogICAgcHJvbWlzZSwKICAgIHJlc29sdmUKICB9Owp9CmZ1bmN0aW9uIGFuaW1hdGVMZWF2ZUNsYXNzUnVubmVyKGVsLCB0Tm9kZSwgbFZpZXcsIGNsYXNzTGlzdCwgcmVuZGVyZXIsIG5nWm9uZSkgewogIGNhbmNlbEFuaW1hdGlvbnNJZlJ1bm5pbmcoZWwsIHJlbmRlcmVyKTsKICBjb25zdCBjbGVhbnVwRm5zID0gW107CiAgY29uc3QgcmVzb2x2ZXJzID0gZ2V0TFZpZXdMZWF2ZUFuaW1hdGlvbnMobFZpZXcpLmdldCh0Tm9kZS5pbmRleCk/LnJlc29sdmVyczsKICBjb25zdCBoYW5kbGVPdXRBbmltYXRpb25FbmQgPSAoZXZlbnQpID0+IHsKICAgIGlmIChldmVudC50YXJnZXQgIT09IGVsKSByZXR1cm47CiAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBDdXN0b21FdmVudCB8fCBpc0xvbmdlc3RBbmltYXRpb24oZXZlbnQsIGVsKSkgewogICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgICAgbG9uZ2VzdEFuaW1hdGlvbnMuZGVsZXRlKGVsKTsKICAgICAgY2xlYXJMZWF2aW5nTm9kZXModE5vZGUsIGVsKTsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodE5vZGUucHJvamVjdGlvbikpIHsKICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY2xhc3NMaXN0KSB7CiAgICAgICAgICByZW5kZXJlci5yZW1vdmVDbGFzcyhlbCwgaXRlbSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNsZWFudXBBZnRlckxlYXZlQW5pbWF0aW9ucyhyZXNvbHZlcnMsIGNsZWFudXBGbnMpOwogICAgICBjbGVhckxWaWV3Tm9kZUFuaW1hdGlvblJlc29sdmVycyhsVmlldywgdE5vZGUpOwogICAgfQogIH07CiAgbmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHsKICAgIGNsZWFudXBGbnMucHVzaChyZW5kZXJlci5saXN0ZW4oZWwsICJhbmltYXRpb25lbmQiLCBoYW5kbGVPdXRBbmltYXRpb25FbmQpKTsKICAgIGNsZWFudXBGbnMucHVzaChyZW5kZXJlci5saXN0ZW4oZWwsICJ0cmFuc2l0aW9uZW5kIiwgaGFuZGxlT3V0QW5pbWF0aW9uRW5kKSk7CiAgfSk7CiAgdHJhY2tMZWF2aW5nTm9kZXModE5vZGUsIGVsKTsKICBmb3IgKGNvbnN0IGl0ZW0gb2YgY2xhc3NMaXN0KSB7CiAgICByZW5kZXJlci5hZGRDbGFzcyhlbCwgaXRlbSk7CiAgfQogIG5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7CiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICBkZXRlcm1pbmVMb25nZXN0QW5pbWF0aW9uKGVsLCBsb25nZXN0QW5pbWF0aW9ucywgYXJlQW5pbWF0aW9uU3VwcG9ydGVkKTsKICAgICAgaWYgKCFsb25nZXN0QW5pbWF0aW9ucy5oYXMoZWwpKSB7CiAgICAgICAgY2xlYXJMZWF2aW5nTm9kZXModE5vZGUsIGVsKTsKICAgICAgICBjbGVhbnVwQWZ0ZXJMZWF2ZUFuaW1hdGlvbnMocmVzb2x2ZXJzLCBjbGVhbnVwRm5zKTsKICAgICAgICBjbGVhckxWaWV3Tm9kZUFuaW1hdGlvblJlc29sdmVycyhsVmlldywgdE5vZGUpOwogICAgICB9CiAgICB9KTsKICB9KTsKfQpmdW5jdGlvbiDJtcm1YW5pbWF0ZUxlYXZlTGlzdGVuZXIodmFsdWUpIHsKICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0FuaW1hdGVMZWF2ZSIpOwogIGlmICghYXJlQW5pbWF0aW9uU3VwcG9ydGVkKSB7CiAgICByZXR1cm4gybXJtWFuaW1hdGVMZWF2ZUxpc3RlbmVyOwogIH0KICBuZ0Rldk1vZGUgJiYgYXNzZXJ0QW5pbWF0aW9uVHlwZXModmFsdWUsICJhbmltYXRlLmxlYXZlIik7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgY2FuY2VsTGVhdmluZ05vZGVzKHROb2RlLCBsVmlldyk7CiAgYWxsTGVhdmluZ0FuaW1hdGlvbnMuYWRkKGxWaWV3W0lEXSk7CiAgYWRkQW5pbWF0aW9uVG9MVmlldyhnZXRMVmlld0xlYXZlQW5pbWF0aW9ucyhsVmlldyksIHROb2RlLCAoKSA9PiBydW5MZWF2ZUFuaW1hdGlvbkZ1bmN0aW9uKGxWaWV3LCB0Tm9kZSwgdmFsdWUpKTsKICBpbml0aWFsaXplQW5pbWF0aW9uUXVldWVTY2hlZHVsZXIobFZpZXdbSU5KRUNUT1JdKTsKICByZXR1cm4gybXJtWFuaW1hdGVMZWF2ZUxpc3RlbmVyOwp9CmZ1bmN0aW9uIHJ1bkxlYXZlQW5pbWF0aW9uRnVuY3Rpb24obFZpZXcsIHROb2RlLCB2YWx1ZSkgewogIGNvbnN0IHsKICAgIHByb21pc2UsCiAgICByZXNvbHZlCiAgfSA9IHByb21pc2VXaXRoUmVzb2x2ZXJzKCk7CiAgY29uc3QgbmF0aXZlRWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RWxlbWVudE5vZGVzKG5hdGl2ZUVsZW1lbnQsICJhbmltYXRlLmxlYXZlIik7CiAgY29uc3QgY2xlYW51cEZucyA9IFtdOwogIGNvbnN0IHJlbmRlcmVyID0gbFZpZXdbUkVOREVSRVJdOwogIGNvbnN0IGFuaW1hdGlvbnNEaXNhYmxlZCA9IGFyZUFuaW1hdGlvbnNEaXNhYmxlZChsVmlldyk7CiAgY29uc3Qgbmdab25lID0gbFZpZXdbSU5KRUNUT1JdLmdldChOZ1pvbmUpOwogIGNvbnN0IG1heEFuaW1hdGlvblRpbWVvdXQgPSBsVmlld1tJTkpFQ1RPUl0uZ2V0KE1BWF9BTklNQVRJT05fVElNRU9VVCk7CiAgKGdldExWaWV3TGVhdmVBbmltYXRpb25zKGxWaWV3KS5nZXQodE5vZGUuaW5kZXgpLnJlc29sdmVycyA/Pz0gW10pLnB1c2gocmVzb2x2ZSk7CiAgY29uc3QgcmVzb2x2ZXJzID0gZ2V0TFZpZXdMZWF2ZUFuaW1hdGlvbnMobFZpZXcpLmdldCh0Tm9kZS5pbmRleCk/LnJlc29sdmVyczsKICBpZiAoYW5pbWF0aW9uc0Rpc2FibGVkKSB7CiAgICBsZWF2ZUFuaW1hdGlvbkZ1bmN0aW9uQ2xlYW51cChsVmlldywgdE5vZGUsIG5hdGl2ZUVsZW1lbnQsIHJlc29sdmVycywgY2xlYW51cEZucyk7CiAgfSBlbHNlIHsKICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gbGVhdmVBbmltYXRpb25GdW5jdGlvbkNsZWFudXAobFZpZXcsIHROb2RlLCBuYXRpdmVFbGVtZW50LCByZXNvbHZlcnMsIGNsZWFudXBGbnMpLCBtYXhBbmltYXRpb25UaW1lb3V0KTsKICAgIGNvbnN0IGV2ZW50ID0gewogICAgICB0YXJnZXQ6IG5hdGl2ZUVsZW1lbnQsCiAgICAgIGFuaW1hdGlvbkNvbXBsZXRlOiAoKSA9PiB7CiAgICAgICAgbGVhdmVBbmltYXRpb25GdW5jdGlvbkNsZWFudXAobFZpZXcsIHROb2RlLCBuYXRpdmVFbGVtZW50LCByZXNvbHZlcnMsIGNsZWFudXBGbnMpOwogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpOwogICAgICB9CiAgICB9OwogICAgdHJhY2tMZWF2aW5nTm9kZXModE5vZGUsIG5hdGl2ZUVsZW1lbnQpOwogICAgbmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHsKICAgICAgY2xlYW51cEZucy5wdXNoKHJlbmRlcmVyLmxpc3RlbihuYXRpdmVFbGVtZW50LCAiYW5pbWF0aW9uZW5kIiwgKCkgPT4gewogICAgICAgIGxlYXZlQW5pbWF0aW9uRnVuY3Rpb25DbGVhbnVwKGxWaWV3LCB0Tm9kZSwgbmF0aXZlRWxlbWVudCwgcmVzb2x2ZXJzLCBjbGVhbnVwRm5zKTsKICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsKICAgICAgfSwgewogICAgICAgIG9uY2U6IHRydWUKICAgICAgfSkpOwogICAgfSk7CiAgICB2YWx1ZS5jYWxsKGxWaWV3W0NPTlRFWFRdLCBldmVudCk7CiAgfQogIHJldHVybiB7CiAgICBwcm9taXNlLAogICAgcmVzb2x2ZQogIH07Cn0KZnVuY3Rpb24gybXJtWNvbXBvbmVudEluc3RhbmNlKCkgewogIGNvbnN0IGluc3RhbmNlID0gZ2V0TFZpZXcoKVtERUNMQVJBVElPTl9DT01QT05FTlRfVklFV11bQ09OVEVYVF07CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoaW5zdGFuY2UsICJFeHBlY3RlZCBjb21wb25lbnQgaW5zdGFuY2UgdG8gYmUgZGVmaW5lZCIpOwogIHJldHVybiBpbnN0YW5jZTsKfQpmdW5jdGlvbiDJtcm1Y29udHJvbENyZWF0ZSgpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgaWYgKHRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgaW5pdGlhbGl6ZUNvbnRyb2xGaXJzdENyZWF0ZVBhc3ModFZpZXcsIHROb2RlLCBsVmlldyk7CiAgfQogIGNvbnN0IGZpZWxkRGlyZWN0aXZlID0gZ2V0RmllbGREaXJlY3RpdmUodE5vZGUsIGxWaWV3KTsKICBpZiAoIWZpZWxkRGlyZWN0aXZlKSB7CiAgICByZXR1cm47CiAgfQogIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUoIk5nU2lnbmFsRm9ybXMiKTsKICBpZiAodE5vZGUuZmxhZ3MgJiAxMDI0KSB7CiAgICBpbml0aWFsaXplQ3VzdG9tQ29udHJvbChsVmlldywgdE5vZGUsIGZpZWxkRGlyZWN0aXZlLCAidmFsdWUiKTsKICB9IGVsc2UgaWYgKHROb2RlLmZsYWdzICYgMjA0OCkgewogICAgaW5pdGlhbGl6ZUN1c3RvbUNvbnRyb2wobFZpZXcsIHROb2RlLCBmaWVsZERpcmVjdGl2ZSwgImNoZWNrZWQiKTsKICB9IGVsc2UgaWYgKHROb2RlLmZsYWdzICYgNDA5NikgewogICAgaW5pdGlhbGl6ZUludGVyb3BDb250cm9sKGZpZWxkRGlyZWN0aXZlKTsKICB9IGVsc2UgaWYgKHROb2RlLmZsYWdzICYgODE5MikgewogICAgaW5pdGlhbGl6ZU5hdGl2ZUNvbnRyb2wobFZpZXcsIHROb2RlLCBmaWVsZERpcmVjdGl2ZSk7CiAgfQogIGZpZWxkRGlyZWN0aXZlLnJlZ2lzdGVyQXNCaW5kaW5nKGdldEN1c3RvbUNvbnRyb2wodE5vZGUsIGxWaWV3KSk7Cn0KZnVuY3Rpb24gybXJtWNvbnRyb2wodmFsdWUsIG5hbWUsIHNhbml0aXplcikgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldFNlbGVjdGVkVE5vZGUoKTsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBuZXh0QmluZGluZ0luZGV4KCk7CiAgaWYgKGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHZhbHVlKSkgewogICAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogICAgc2V0UHJvcGVydHlBbmRJbnB1dHModE5vZGUsIGxWaWV3LCBuYW1lLCB2YWx1ZSwgbFZpZXdbUkVOREVSRVJdLCBzYW5pdGl6ZXIpOwogICAgbmdEZXZNb2RlICYmIHN0b3JlUHJvcGVydHlCaW5kaW5nTWV0YWRhdGEodFZpZXcuZGF0YSwgdE5vZGUsIG5hbWUsIGJpbmRpbmdJbmRleCk7CiAgfQogIHVwZGF0ZUNvbnRyb2wobFZpZXcsIHROb2RlKTsKfQpmdW5jdGlvbiDJtWNvbnRyb2xVcGRhdGUoKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogIHVwZGF0ZUNvbnRyb2wobFZpZXcsIHROb2RlKTsKfQpmdW5jdGlvbiB1cGRhdGVDb250cm9sKGxWaWV3LCB0Tm9kZSkgewogIGNvbnN0IGZpZWxkRGlyZWN0aXZlID0gZ2V0RmllbGREaXJlY3RpdmUodE5vZGUsIGxWaWV3KTsKICBpZiAoZmllbGREaXJlY3RpdmUpIHsKICAgIHVwZGF0ZUNvbnRyb2xDbGFzc2VzKGxWaWV3LCB0Tm9kZSwgZmllbGREaXJlY3RpdmUpOwogICAgaWYgKHROb2RlLmZsYWdzICYgMTAyNCkgewogICAgICB1cGRhdGVDdXN0b21Db250cm9sKHROb2RlLCBsVmlldywgZmllbGREaXJlY3RpdmUsICJ2YWx1ZSIpOwogICAgfSBlbHNlIGlmICh0Tm9kZS5mbGFncyAmIDIwNDgpIHsKICAgICAgdXBkYXRlQ3VzdG9tQ29udHJvbCh0Tm9kZSwgbFZpZXcsIGZpZWxkRGlyZWN0aXZlLCAiY2hlY2tlZCIpOwogICAgfSBlbHNlIGlmICh0Tm9kZS5mbGFncyAmIDQwOTYpIHsKICAgICAgdXBkYXRlSW50ZXJvcENvbnRyb2wodE5vZGUsIGxWaWV3LCBmaWVsZERpcmVjdGl2ZSk7CiAgICB9IGVsc2UgewogICAgICB1cGRhdGVOYXRpdmVDb250cm9sKHROb2RlLCBsVmlldywgZmllbGREaXJlY3RpdmUpOwogICAgfQogIH0KICBuZXh0QmluZGluZ0luZGV4KCk7Cn0KZnVuY3Rpb24gaW5pdGlhbGl6ZUNvbnRyb2xGaXJzdENyZWF0ZVBhc3ModFZpZXcsIHROb2RlLCBsVmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcpOwogIGNvbnN0IGRpcmVjdGl2ZUluZGljZXMgPSB0Tm9kZS5pbnB1dHM/LlsiZm9ybUZpZWxkIl07CiAgaWYgKCFkaXJlY3RpdmVJbmRpY2VzKSB7CiAgICByZXR1cm47CiAgfQogIGlmIChpc0NvbXBvbmVudEhvc3QodE5vZGUpICYmIGRpcmVjdGl2ZUluZGljZXMuaW5jbHVkZXModE5vZGUuZGlyZWN0aXZlU3RhcnQgKyB0Tm9kZS5jb21wb25lbnRPZmZzZXQpKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IGNvbnRyb2xJbmRleCA9IGRpcmVjdGl2ZUluZGljZXMuZmluZCgoaW5kZXgpID0+IMm1Q09OVFJPTCBpbiBsVmlld1tpbmRleF0pOwogIGlmIChjb250cm9sSW5kZXggPT09IHZvaWQgMCkgewogICAgcmV0dXJuOwogIH0KICB0Tm9kZS5maWVsZEluZGV4ID0gY29udHJvbEluZGV4OwogIGNvbnN0IGZvdW5kQ29udHJvbCA9IGlzSW50ZXJvcENvbnRyb2xGaXJzdENyZWF0ZVBhc3ModE5vZGUsIGxWaWV3KSB8fCBpc0N1c3RvbUNvbnRyb2xGaXJzdENyZWF0ZVBhc3ModFZpZXcsIHROb2RlKTsKICBpZiAoaXNOYXRpdmVDb250cm9sRmlyc3RDcmVhdGVQYXNzKHROb2RlKSB8fCBmb3VuZENvbnRyb2wpIHsKICAgIHJldHVybjsKICB9CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigzMTgsIG5nRGV2TW9kZSAmJiBgJHtkZXNjcmliZUVsZW1lbnQodFZpZXcsIHROb2RlKX0gaXMgYW4gaW52YWxpZCBbZm9ybUZpZWxkXSBkaXJlY3RpdmUgaG9zdC4gVGhlIGhvc3QgbXVzdCBiZSBhIG5hdGl2ZSBmb3JtIGNvbnRyb2wgKHN1Y2ggYXMgPGlucHV0PicsICc8c2VsZWN0PicsIG9yICc8dGV4dGFyZWE+Jykgb3IgYSBjdXN0b20gZm9ybSBjb250cm9sIHdpdGggYSAndmFsdWUnIG9yICdjaGVja2VkJyBtb2RlbC5gKTsKfQpmdW5jdGlvbiBkZXNjcmliZUVsZW1lbnQodFZpZXcsIHROb2RlKSB7CiAgaWYgKG5nRGV2TW9kZSAmJiBpc0NvbXBvbmVudEhvc3QodE5vZGUpKSB7CiAgICBjb25zdCBjb21wb25lbnRJbmRleCA9IHROb2RlLmRpcmVjdGl2ZVN0YXJ0ICsgdE5vZGUuY29tcG9uZW50T2Zmc2V0OwogICAgY29uc3QgY29tcG9uZW50RGVmID0gdFZpZXcuZGF0YVtjb21wb25lbnRJbmRleF07CiAgICByZXR1cm4gYENvbXBvbmVudCAke2RlYnVnU3RyaW5naWZ5VHlwZUZvckVycm9yKGNvbXBvbmVudERlZi50eXBlKX1gOwogIH0KICByZXR1cm4gYDwke3ROb2RlLnZhbHVlfT5gOwp9CmZ1bmN0aW9uIGlzSW50ZXJvcENvbnRyb2xGaXJzdENyZWF0ZVBhc3ModE5vZGUsIGxWaWV3KSB7CiAgY29uc3QgY29udHJvbCA9IGxWaWV3W3ROb2RlLmZpZWxkSW5kZXhdOwogIGlmIChjb250cm9sLsm1aW50ZXJvcENvbnRyb2wpIHsKICAgIHROb2RlLmZsYWdzIHw9IDQwOTY7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGlzQ3VzdG9tQ29udHJvbEZpcnN0Q3JlYXRlUGFzcyh0VmlldywgdE5vZGUpIHsKICBmb3IgKGxldCBpID0gdE5vZGUuZGlyZWN0aXZlU3RhcnQ7IGkgPCB0Tm9kZS5kaXJlY3RpdmVFbmQ7IGkrKykgewogICAgY29uc3QgZGlyZWN0aXZlRGVmID0gdFZpZXcuZGF0YVtpXTsKICAgIGlmIChoYXNNb2RlbElucHV0KGRpcmVjdGl2ZURlZiwgInZhbHVlIikpIHsKICAgICAgdE5vZGUuZmxhZ3MgfD0gMTAyNDsKICAgICAgdE5vZGUuY3VzdG9tQ29udHJvbEluZGV4ID0gaTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBpZiAoaGFzTW9kZWxJbnB1dChkaXJlY3RpdmVEZWYsICJjaGVja2VkIikpIHsKICAgICAgdE5vZGUuZmxhZ3MgfD0gMjA0ODsKICAgICAgdE5vZGUuY3VzdG9tQ29udHJvbEluZGV4ID0gaTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBpc05hdGl2ZUNvbnRyb2xGaXJzdENyZWF0ZVBhc3ModE5vZGUpIHsKICBpZiAoIWlzTmF0aXZlQ29udHJvbCh0Tm9kZSkpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgdE5vZGUuZmxhZ3MgfD0gODE5MjsKICBpZiAoaXNOdW1lcmljSW5wdXQodE5vZGUpKSB7CiAgICB0Tm9kZS5mbGFncyB8PSAxNjM4NDsKICB9CiAgaWYgKGlzVGV4dENvbnRyb2wodE5vZGUpKSB7CiAgICB0Tm9kZS5mbGFncyB8PSAzMjc2ODsKICB9CiAgcmV0dXJuIHRydWU7Cn0KZnVuY3Rpb24gZ2V0RmllbGREaXJlY3RpdmUodE5vZGUsIGxWaWV3KSB7CiAgY29uc3QgaW5kZXggPSB0Tm9kZS5maWVsZEluZGV4OwogIHJldHVybiBpbmRleCA9PT0gLTEgPyB2b2lkIDAgOiBsVmlld1tpbmRleF07Cn0KZnVuY3Rpb24gZ2V0Q3VzdG9tQ29udHJvbCh0Tm9kZSwgbFZpZXcpIHsKICBjb25zdCBpbmRleCA9IHROb2RlLmN1c3RvbUNvbnRyb2xJbmRleDsKICByZXR1cm4gaW5kZXggPT09IC0xID8gdm9pZCAwIDogbFZpZXdbaW5kZXhdOwp9CmZ1bmN0aW9uIGhhc01vZGVsSW5wdXQoZGlyZWN0aXZlRGVmLCBuYW1lKSB7CiAgcmV0dXJuIGhhc0lucHV0KGRpcmVjdGl2ZURlZiwgbmFtZSkgJiYgaGFzT3V0cHV0KGRpcmVjdGl2ZURlZiwgbmFtZSArICJDaGFuZ2UiKTsKfQpmdW5jdGlvbiBoYXNJbnB1dChkaXJlY3RpdmVEZWYsIG5hbWUpIHsKICByZXR1cm4gbmFtZSBpbiBkaXJlY3RpdmVEZWYuaW5wdXRzOwp9CmZ1bmN0aW9uIGhhc091dHB1dChkaXJlY3RpdmVEZWYsIG5hbWUpIHsKICByZXR1cm4gbmFtZSBpbiBkaXJlY3RpdmVEZWYub3V0cHV0czsKfQpmdW5jdGlvbiBpbml0aWFsaXplQ3VzdG9tQ29udHJvbChsVmlldywgdE5vZGUsIGZpZWxkRGlyZWN0aXZlLCBtb2RlbE5hbWUpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgZGlyZWN0aXZlSW5kZXggPSB0Tm9kZS5jdXN0b21Db250cm9sSW5kZXg7CiAgY29uc3Qgb3V0cHV0TmFtZSA9IG1vZGVsTmFtZSArICJDaGFuZ2UiOwogIGxpc3RlblRvT3V0cHV0KHROb2RlLCBsVmlldywgZGlyZWN0aXZlSW5kZXgsIG91dHB1dE5hbWUsIG91dHB1dE5hbWUsIHdyYXBMaXN0ZW5lcih0Tm9kZSwgbFZpZXcsICh2YWx1ZSkgPT4gZmllbGREaXJlY3RpdmUuc3RhdGUoKS5zZXRDb250cm9sVmFsdWUodmFsdWUpKSk7CiAgY29uc3QgZGlyZWN0aXZlRGVmID0gdFZpZXcuZGF0YVtkaXJlY3RpdmVJbmRleF07CiAgY29uc3QgdG91Y2hlZE91dHB1dE5hbWUgPSAidG91Y2hlZENoYW5nZSI7CiAgaWYgKGhhc091dHB1dChkaXJlY3RpdmVEZWYsIHRvdWNoZWRPdXRwdXROYW1lKSkgewogICAgbGlzdGVuVG9PdXRwdXQodE5vZGUsIGxWaWV3LCBkaXJlY3RpdmVJbmRleCwgdG91Y2hlZE91dHB1dE5hbWUsIHRvdWNoZWRPdXRwdXROYW1lLCB3cmFwTGlzdGVuZXIodE5vZGUsIGxWaWV3LCAoKSA9PiBmaWVsZERpcmVjdGl2ZS5zdGF0ZSgpLm1hcmtBc1RvdWNoZWQoKSkpOwogIH0KfQpmdW5jdGlvbiBpbml0aWFsaXplSW50ZXJvcENvbnRyb2woZmllbGREaXJlY3RpdmUpIHsKICBjb25zdCBpbnRlcm9wQ29udHJvbCA9IGZpZWxkRGlyZWN0aXZlLsm1aW50ZXJvcENvbnRyb2w7CiAgaW50ZXJvcENvbnRyb2wucmVnaXN0ZXJPbkNoYW5nZSgodmFsdWUpID0+IGZpZWxkRGlyZWN0aXZlLnN0YXRlKCkuc2V0Q29udHJvbFZhbHVlKHZhbHVlKSk7CiAgaW50ZXJvcENvbnRyb2wucmVnaXN0ZXJPblRvdWNoZWQoKCkgPT4gZmllbGREaXJlY3RpdmUuc3RhdGUoKS5tYXJrQXNUb3VjaGVkKCkpOwp9CmZ1bmN0aW9uIGlzTmF0aXZlQ29udHJvbCh0Tm9kZSkgewogIGlmICh0Tm9kZS50eXBlICE9PSAyKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGNvbnN0IHRhZ05hbWUgPSB0Tm9kZS52YWx1ZTsKICByZXR1cm4gdGFnTmFtZSA9PT0gImlucHV0IiB8fCB0YWdOYW1lID09PSAidGV4dGFyZWEiIHx8IHRhZ05hbWUgPT09ICJzZWxlY3QiOwp9CmZ1bmN0aW9uIGluaXRpYWxpemVOYXRpdmVDb250cm9sKGxWaWV3LCB0Tm9kZSwgZmllbGREaXJlY3RpdmUpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgY29uc3QgZWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBjb25zdCBpbnB1dExpc3RlbmVyID0gKCkgPT4gewogICAgY29uc3Qgc3RhdGUgPSBmaWVsZERpcmVjdGl2ZS5zdGF0ZSgpOwogICAgc3RhdGUuc2V0Q29udHJvbFZhbHVlKGdldE5hdGl2ZUNvbnRyb2xWYWx1ZShlbGVtZW50LCBzdGF0ZS52YWx1ZSkpOwogIH07CiAgbGlzdGVuVG9Eb21FdmVudCh0Tm9kZSwgdFZpZXcsIGxWaWV3LCB2b2lkIDAsIHJlbmRlcmVyLCAiaW5wdXQiLCBpbnB1dExpc3RlbmVyLCB3cmFwTGlzdGVuZXIodE5vZGUsIGxWaWV3LCBpbnB1dExpc3RlbmVyKSk7CiAgY29uc3QgYmx1ckxpc3RlbmVyID0gKCkgPT4gewogICAgZmllbGREaXJlY3RpdmUuc3RhdGUoKS5tYXJrQXNUb3VjaGVkKCk7CiAgfTsKICBsaXN0ZW5Ub0RvbUV2ZW50KHROb2RlLCB0VmlldywgbFZpZXcsIHZvaWQgMCwgcmVuZGVyZXIsICJibHVyIiwgYmx1ckxpc3RlbmVyLCB3cmFwTGlzdGVuZXIodE5vZGUsIGxWaWV3LCBibHVyTGlzdGVuZXIpKTsKICBpZiAodE5vZGUudHlwZSA9PT0gMiAmJiB0Tm9kZS52YWx1ZSA9PT0gInNlbGVjdCIgJiYgdHlwZW9mIE11dGF0aW9uT2JzZXJ2ZXIgPT09ICJmdW5jdGlvbiIpIHsKICAgIGNvbnN0IG9ic2VydmVyID0gb2JzZXJ2ZVNlbGVjdE11dGF0aW9ucyhlbGVtZW50LCBmaWVsZERpcmVjdGl2ZSk7CiAgICBzdG9yZUNsZWFudXBXaXRoQ29udGV4dCh0VmlldywgbFZpZXcsIG9ic2VydmVyLCBvYnNlcnZlci5kaXNjb25uZWN0KTsKICB9Cn0KZnVuY3Rpb24gb2JzZXJ2ZVNlbGVjdE11dGF0aW9ucyhzZWxlY3QsIGNvbnRyb2xEaXJlY3RpdmUpIHsKICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHsKICAgIGlmIChtdXRhdGlvbnMuc29tZSgobSkgPT4gaXNSZWxldmFudFNlbGVjdE11dGF0aW9uKG0pKSkgewogICAgICBzZWxlY3QudmFsdWUgPSBjb250cm9sRGlyZWN0aXZlLnN0YXRlKCkudmFsdWUoKTsKICAgIH0KICB9KTsKICBvYnNlcnZlci5vYnNlcnZlKHNlbGVjdCwgewogICAgYXR0cmlidXRlczogdHJ1ZSwKICAgIGF0dHJpYnV0ZUZpbHRlcjogWyJ2YWx1ZSJdLAogICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwKICAgIGNoaWxkTGlzdDogdHJ1ZSwKICAgIHN1YnRyZWU6IHRydWUKICB9KTsKICByZXR1cm4gb2JzZXJ2ZXI7Cn0KZnVuY3Rpb24gaXNSZWxldmFudFNlbGVjdE11dGF0aW9uKG11dGF0aW9uKSB7CiAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICJjaGlsZExpc3QiIHx8IG11dGF0aW9uLnR5cGUgPT09ICJjaGFyYWN0ZXJEYXRhIikgewogICAgaWYgKG11dGF0aW9uLnRhcmdldCBpbnN0YW5jZW9mIENvbW1lbnQpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgZm9yIChjb25zdCBub2RlIG9mIG11dGF0aW9uLmFkZGVkTm9kZXMpIHsKICAgICAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIENvbW1lbnQpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICAgIGZvciAoY29uc3Qgbm9kZSBvZiBtdXRhdGlvbi5yZW1vdmVkTm9kZXMpIHsKICAgICAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIENvbW1lbnQpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICJhdHRyaWJ1dGVzIiAmJiBtdXRhdGlvbi50YXJnZXQgaW5zdGFuY2VvZiBIVE1MT3B0aW9uRWxlbWVudCkgewogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiB1cGRhdGVDb250cm9sQ2xhc3NlcyhsVmlldywgdE5vZGUsIGNvbnRyb2wpIHsKICBpZiAoY29udHJvbC5jbGFzc2VzKSB7CiAgICBjb25zdCBiaW5kaW5ncyA9IGdldENvbnRyb2xCaW5kaW5ncyhsVmlldyk7CiAgICBiaW5kaW5ncy5jbGFzc2VzID8/PSB7fTsKICAgIGNvbnRyb2wuc3RhdGUoKTsKICAgIGNvbnN0IHJlbmRlcmVyID0gbFZpZXdbUkVOREVSRVJdOwogICAgY29uc3QgZWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICAgIGZvciAoY29uc3QgW2NsYXNzTmFtZSwgZW5hYmxlZF0gb2YgY29udHJvbC5jbGFzc2VzKSB7CiAgICAgIGNvbnN0IGlzRW5hYmxlZCA9IGVuYWJsZWQoKTsKICAgICAgaWYgKGNvbnRyb2xDbGFzc0JpbmRpbmdVcGRhdGVkKGJpbmRpbmdzLmNsYXNzZXMsIGNsYXNzTmFtZSwgaXNFbmFibGVkKSkgewogICAgICAgIGlmIChpc0VuYWJsZWQpIHsKICAgICAgICAgIHJlbmRlcmVyLmFkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlbmRlcmVyLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHVwZGF0ZUN1c3RvbUNvbnRyb2wodE5vZGUsIGxWaWV3LCBjb250cm9sLCBtb2RlbE5hbWUpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgZGlyZWN0aXZlSW5kZXggPSB0Tm9kZS5jdXN0b21Db250cm9sSW5kZXg7CiAgY29uc3QgZGlyZWN0aXZlID0gbFZpZXdbZGlyZWN0aXZlSW5kZXhdOwogIGNvbnN0IGRpcmVjdGl2ZURlZiA9IHRWaWV3LmRhdGFbZGlyZWN0aXZlSW5kZXhdOwogIGNvbnN0IHN0YXRlID0gY29udHJvbC5zdGF0ZSgpOwogIGNvbnN0IGJpbmRpbmdzID0gZ2V0Q29udHJvbEJpbmRpbmdzKGxWaWV3KTsKICBjb25zdCBjb250cm9sVmFsdWUgPSBzdGF0ZS5jb250cm9sVmFsdWUoKTsKICBpZiAoY29udHJvbEJpbmRpbmdVcGRhdGVkKGJpbmRpbmdzLCBDT05UUk9MX1ZBTFVFLCBjb250cm9sVmFsdWUpKSB7CiAgICB3cml0ZVRvRGlyZWN0aXZlSW5wdXQoZGlyZWN0aXZlRGVmLCBkaXJlY3RpdmUsIG1vZGVsTmFtZSwgY29udHJvbFZhbHVlKTsKICB9CiAgY29uc3QgaXNOYXRpdmUgPSAodE5vZGUuZmxhZ3MgJiA4MTkyKSAhPT0gMDsKICBjb25zdCBlbGVtZW50ID0gaXNOYXRpdmUgPyBnZXROYXRpdmVCeVROb2RlKHROb2RlLCBsVmlldykgOiBudWxsOwogIGNvbnN0IHJlbmRlcmVyID0gbFZpZXdbUkVOREVSRVJdOwogIGZvciAoY29uc3Qga2V5IG9mIENPTlRST0xfQklORElOR19LRVlTKSB7CiAgICBjb25zdCB2YWx1ZSA9IHN0YXRlW2tleV0/LigpOwogICAgaWYgKGNvbnRyb2xCaW5kaW5nVXBkYXRlZChiaW5kaW5ncywga2V5LCB2YWx1ZSkpIHsKICAgICAgY29uc3QgaW5wdXROYW1lID0gQ09OVFJPTF9CSU5ESU5HX05BTUVTW2tleV07CiAgICAgIHVwZGF0ZURpcmVjdGl2ZUlucHV0cyh0Tm9kZSwgbFZpZXcsIGlucHV0TmFtZSwgdmFsdWUpOwogICAgICBpZiAoaXNOYXRpdmUgJiYgIShpbnB1dE5hbWUgaW4gZGlyZWN0aXZlRGVmLmlucHV0cykpIHsKICAgICAgICB1cGRhdGVOYXRpdmVQcm9wZXJ0eSh0Tm9kZSwgcmVuZGVyZXIsIGVsZW1lbnQsIGtleSwgdmFsdWUsIGlucHV0TmFtZSk7CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gdXBkYXRlSW50ZXJvcENvbnRyb2wodE5vZGUsIGxWaWV3LCBjb250cm9sKSB7CiAgY29uc3QgaW50ZXJvcENvbnRyb2wgPSBjb250cm9sLsm1aW50ZXJvcENvbnRyb2w7CiAgY29uc3QgYmluZGluZ3MgPSBnZXRDb250cm9sQmluZGluZ3MobFZpZXcpOwogIGNvbnN0IHN0YXRlID0gY29udHJvbC5zdGF0ZSgpOwogIGNvbnN0IGlzTmF0aXZlID0gKHROb2RlLmZsYWdzICYgODE5MikgIT09IDA7CiAgY29uc3QgZWxlbWVudCA9IGlzTmF0aXZlID8gZ2V0TmF0aXZlQnlUTm9kZSh0Tm9kZSwgbFZpZXcpIDogbnVsbDsKICBjb25zdCByZW5kZXJlciA9IGxWaWV3W1JFTkRFUkVSXTsKICBjb25zdCB2YWx1ZSA9IHN0YXRlLnZhbHVlKCk7CiAgaWYgKGNvbnRyb2xCaW5kaW5nVXBkYXRlZChiaW5kaW5ncywgQ09OVFJPTF9WQUxVRSwgdmFsdWUpKSB7CiAgICB1bnRyYWNrZWQyKCgpID0+IGludGVyb3BDb250cm9sLndyaXRlVmFsdWUodmFsdWUpKTsKICB9CiAgZm9yIChjb25zdCBrZXkgb2YgQ09OVFJPTF9CSU5ESU5HX0tFWVMpIHsKICAgIGNvbnN0IHZhbHVlMiA9IHN0YXRlW2tleV0/LigpOwogICAgaWYgKGNvbnRyb2xCaW5kaW5nVXBkYXRlZChiaW5kaW5ncywga2V5LCB2YWx1ZTIpKSB7CiAgICAgIGNvbnN0IGlucHV0TmFtZSA9IENPTlRST0xfQklORElOR19OQU1FU1trZXldOwogICAgICBjb25zdCBkaWRVcGRhdGVJbnB1dCA9IHVwZGF0ZURpcmVjdGl2ZUlucHV0cyh0Tm9kZSwgbFZpZXcsIGlucHV0TmFtZSwgdmFsdWUyKTsKICAgICAgaWYgKGtleSA9PT0gRElTQUJMRUQpIHsKICAgICAgICBpZiAoaW50ZXJvcENvbnRyb2wuc2V0RGlzYWJsZWRTdGF0ZSkgewogICAgICAgICAgdW50cmFja2VkMigoKSA9PiBpbnRlcm9wQ29udHJvbC5zZXREaXNhYmxlZFN0YXRlKHZhbHVlMikpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChpc05hdGl2ZSAmJiAhZGlkVXBkYXRlSW5wdXQpIHsKICAgICAgICB1cGRhdGVOYXRpdmVQcm9wZXJ0eSh0Tm9kZSwgcmVuZGVyZXIsIGVsZW1lbnQsIGtleSwgdmFsdWUyLCBpbnB1dE5hbWUpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHVwZGF0ZU5hdGl2ZUNvbnRyb2wodE5vZGUsIGxWaWV3LCBjb250cm9sKSB7CiAgY29uc3QgZWxlbWVudCA9IGdldE5hdGl2ZUJ5VE5vZGUodE5vZGUsIGxWaWV3KTsKICBjb25zdCByZW5kZXJlciA9IGxWaWV3W1JFTkRFUkVSXTsKICBjb25zdCBzdGF0ZSA9IGNvbnRyb2wuc3RhdGUoKTsKICBjb25zdCBiaW5kaW5ncyA9IGdldENvbnRyb2xCaW5kaW5ncyhsVmlldyk7CiAgY29uc3QgY29udHJvbFZhbHVlID0gc3RhdGUuY29udHJvbFZhbHVlKCk7CiAgaWYgKGNvbnRyb2xCaW5kaW5nVXBkYXRlZChiaW5kaW5ncywgQ09OVFJPTF9WQUxVRSwgY29udHJvbFZhbHVlKSkgewogICAgc2V0TmF0aXZlQ29udHJvbFZhbHVlKGVsZW1lbnQsIGNvbnRyb2xWYWx1ZSk7CiAgfQogIGZvciAoY29uc3Qga2V5IG9mIENPTlRST0xfQklORElOR19LRVlTKSB7CiAgICBjb25zdCB2YWx1ZSA9IHN0YXRlW2tleV0/LigpOwogICAgaWYgKGNvbnRyb2xCaW5kaW5nVXBkYXRlZChiaW5kaW5ncywga2V5LCB2YWx1ZSkpIHsKICAgICAgY29uc3QgaW5wdXROYW1lID0gQ09OVFJPTF9CSU5ESU5HX05BTUVTW2tleV07CiAgICAgIHVwZGF0ZU5hdGl2ZVByb3BlcnR5KHROb2RlLCByZW5kZXJlciwgZWxlbWVudCwga2V5LCB2YWx1ZSwgaW5wdXROYW1lKTsKICAgICAgdXBkYXRlRGlyZWN0aXZlSW5wdXRzKHROb2RlLCBsVmlldywgaW5wdXROYW1lLCB2YWx1ZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHVwZGF0ZURpcmVjdGl2ZUlucHV0cyh0Tm9kZSwgbFZpZXcsIGlucHV0TmFtZSwgdmFsdWUpIHsKICBjb25zdCBkaXJlY3RpdmVJbmRpY2VzID0gdE5vZGUuaW5wdXRzPy5baW5wdXROYW1lXTsKICBpZiAoZGlyZWN0aXZlSW5kaWNlcykgewogICAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogICAgZm9yIChjb25zdCBpbmRleCBvZiBkaXJlY3RpdmVJbmRpY2VzKSB7CiAgICAgIGNvbnN0IGRpcmVjdGl2ZURlZiA9IHRWaWV3LmRhdGFbaW5kZXhdOwogICAgICBjb25zdCBkaXJlY3RpdmUgPSBsVmlld1tpbmRleF07CiAgICAgIHdyaXRlVG9EaXJlY3RpdmVJbnB1dChkaXJlY3RpdmVEZWYsIGRpcmVjdGl2ZSwgaW5wdXROYW1lLCB2YWx1ZSk7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIHVwZGF0ZU5hdGl2ZVByb3BlcnR5KHROb2RlLCByZW5kZXJlciwgZWxlbWVudCwga2V5LCB2YWx1ZSwgbmFtZSkgewogIHN3aXRjaCAoa2V5KSB7CiAgICBjYXNlIE5BTUU6CiAgICAgIHJlbmRlcmVyLnNldEF0dHJpYnV0ZShlbGVtZW50LCBuYW1lLCB2YWx1ZSk7CiAgICAgIGJyZWFrOwogICAgY2FzZSBESVNBQkxFRDoKICAgIGNhc2UgUkVBRE9OTFk6CiAgICBjYXNlIFJFUVVJUkVEOgogICAgICBzZXRCb29sZWFuQXR0cmlidXRlKHJlbmRlcmVyLCBlbGVtZW50LCBuYW1lLCB2YWx1ZSk7CiAgICAgIGJyZWFrOwogICAgY2FzZSBNQVg6CiAgICBjYXNlIE1JTjoKICAgICAgaWYgKHROb2RlLmZsYWdzICYgMTYzODQpIHsKICAgICAgICBzZXRPcHRpb25hbEF0dHJpYnV0ZShyZW5kZXJlciwgZWxlbWVudCwgbmFtZSwgdmFsdWUpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSBNQVhfTEVOR1RIOgogICAgY2FzZSBNSU5fTEVOR1RIOgogICAgICBpZiAodE5vZGUuZmxhZ3MgJiAzMjc2OCkgewogICAgICAgIHNldE9wdGlvbmFsQXR0cmlidXRlKHJlbmRlcmVyLCBlbGVtZW50LCBuYW1lLCB2YWx1ZSk7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgfQp9CmZ1bmN0aW9uIGlzRGF0ZU9yTnVsbCh2YWx1ZSkgewogIHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSBpbnN0YW5jZW9mIERhdGU7Cn0KZnVuY3Rpb24gaXNOdW1lcmljSW5wdXQodE5vZGUpIHsKICBpZiAoIXROb2RlLmF0dHJzIHx8IHROb2RlLnZhbHVlICE9PSAiaW5wdXQiKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGZvciAobGV0IGkgPSAwOyBpIDwgdE5vZGUuYXR0cnMubGVuZ3RoOyBpICs9IDIpIHsKICAgIGNvbnN0IG5hbWUgPSB0Tm9kZS5hdHRyc1tpXTsKICAgIGlmIChpc05hbWVPbmx5QXR0cmlidXRlTWFya2VyKG5hbWUpKSB7CiAgICAgIGJyZWFrOwogICAgfQogICAgaWYgKG5hbWUgPT09ICJ0eXBlIikgewogICAgICBjb25zdCB2YWx1ZSA9IHROb2RlLmF0dHJzW2kgKyAxXTsKICAgICAgcmV0dXJuIHZhbHVlID09PSAiZGF0ZSIgfHwgdmFsdWUgPT09ICJkYXRldGltZS1sb2NhbCIgfHwgdmFsdWUgPT09ICJtb250aCIgfHwgdmFsdWUgPT09ICJudW1iZXIiIHx8IHZhbHVlID09PSAicmFuZ2UiIHx8IHZhbHVlID09PSAidGltZSIgfHwgdmFsdWUgPT09ICJ3ZWVrIjsKICAgIH0KICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGlzVGV4dENvbnRyb2wodE5vZGUpIHsKICByZXR1cm4gdE5vZGUudmFsdWUgIT09ICJzZWxlY3QiOwp9CmZ1bmN0aW9uIGdldE5hdGl2ZUNvbnRyb2xWYWx1ZShlbGVtZW50LCBjdXJyZW50VmFsdWUpIHsKICBzd2l0Y2ggKGVsZW1lbnQudHlwZSkgewogICAgY2FzZSAiY2hlY2tib3giOgogICAgICByZXR1cm4gZWxlbWVudC5jaGVja2VkOwogICAgY2FzZSAibnVtYmVyIjoKICAgIGNhc2UgInJhbmdlIjoKICAgIGNhc2UgImRhdGV0aW1lLWxvY2FsIjoKICAgICAgaWYgKHR5cGVvZiBjdXJyZW50VmFsdWUoKSA9PT0gIm51bWJlciIpIHsKICAgICAgICByZXR1cm4gZWxlbWVudC52YWx1ZUFzTnVtYmVyOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAiZGF0ZSI6CiAgICBjYXNlICJtb250aCI6CiAgICBjYXNlICJ0aW1lIjoKICAgIGNhc2UgIndlZWsiOgogICAgICBjb25zdCB2YWx1ZSA9IGN1cnJlbnRWYWx1ZSgpOwogICAgICBpZiAoaXNEYXRlT3JOdWxsKHZhbHVlKSkgewogICAgICAgIHJldHVybiBlbGVtZW50LnZhbHVlQXNEYXRlOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIpIHsKICAgICAgICByZXR1cm4gZWxlbWVudC52YWx1ZUFzTnVtYmVyOwogICAgICB9CiAgICAgIGJyZWFrOwogIH0KICByZXR1cm4gZWxlbWVudC52YWx1ZTsKfQpmdW5jdGlvbiBzZXROYXRpdmVDb250cm9sVmFsdWUoZWxlbWVudCwgdmFsdWUpIHsKICBzd2l0Y2ggKGVsZW1lbnQudHlwZSkgewogICAgY2FzZSAiY2hlY2tib3giOgogICAgICBlbGVtZW50LmNoZWNrZWQgPSB2YWx1ZTsKICAgICAgcmV0dXJuOwogICAgY2FzZSAicmFkaW8iOgogICAgICBlbGVtZW50LmNoZWNrZWQgPSB2YWx1ZSA9PT0gZWxlbWVudC52YWx1ZTsKICAgICAgcmV0dXJuOwogICAgY2FzZSAibnVtYmVyIjoKICAgIGNhc2UgInJhbmdlIjoKICAgIGNhc2UgImRhdGV0aW1lLWxvY2FsIjoKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIpIHsKICAgICAgICBzZXROYXRpdmVOdW1iZXJDb250cm9sVmFsdWUoZWxlbWVudCwgdmFsdWUpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgImRhdGUiOgogICAgY2FzZSAibW9udGgiOgogICAgY2FzZSAidGltZSI6CiAgICBjYXNlICJ3ZWVrIjoKICAgICAgaWYgKGlzRGF0ZU9yTnVsbCh2YWx1ZSkpIHsKICAgICAgICBlbGVtZW50LnZhbHVlQXNEYXRlID0gdmFsdWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIpIHsKICAgICAgICBzZXROYXRpdmVOdW1iZXJDb250cm9sVmFsdWUoZWxlbWVudCwgdmFsdWUpOwogICAgICAgIHJldHVybjsKICAgICAgfQogIH0KICBlbGVtZW50LnZhbHVlID0gdmFsdWU7Cn0KZnVuY3Rpb24gc2V0TmF0aXZlTnVtYmVyQ29udHJvbFZhbHVlKGVsZW1lbnQsIHZhbHVlKSB7CiAgaWYgKGlzTmFOKHZhbHVlKSkgewogICAgZWxlbWVudC52YWx1ZSA9ICIiOwogIH0gZWxzZSB7CiAgICBlbGVtZW50LnZhbHVlQXNOdW1iZXIgPSB2YWx1ZTsKICB9Cn0KdmFyIERJU0FCTEVEID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgZGlzYWJsZWQ6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBNQVggPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICBtYXg6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBNQVhfTEVOR1RIID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgbWF4TGVuZ3RoOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgTUlOID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgbWluOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgTUlOX0xFTkdUSCA9IGdldENsb3N1cmVTYWZlUHJvcGVydHkoewogIG1pbkxlbmd0aDogZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eQp9KTsKdmFyIE5BTUUgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICBuYW1lOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgUkVBRE9OTFkgPSBnZXRDbG9zdXJlU2FmZVByb3BlcnR5KHsKICByZWFkb25seTogZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eQp9KTsKdmFyIFJFUVVJUkVEID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgcmVxdWlyZWQ6IGdldENsb3N1cmVTYWZlUHJvcGVydHkKfSk7CnZhciBDT05UUk9MX1ZBTFVFID0gZ2V0Q2xvc3VyZVNhZmVQcm9wZXJ0eSh7CiAgY29udHJvbFZhbHVlOiBnZXRDbG9zdXJlU2FmZVByb3BlcnR5Cn0pOwp2YXIgQ09OVFJPTF9CSU5ESU5HX05BTUVTID0gewogIGRpc2FibGVkOiAiZGlzYWJsZWQiLAogIGRpc2FibGVkUmVhc29uczogImRpc2FibGVkUmVhc29ucyIsCiAgZGlydHk6ICJkaXJ0eSIsCiAgZXJyb3JzOiAiZXJyb3JzIiwKICBoaWRkZW46ICJoaWRkZW4iLAogIGludmFsaWQ6ICJpbnZhbGlkIiwKICBtYXg6ICJtYXgiLAogIG1heExlbmd0aDogIm1heExlbmd0aCIsCiAgbWluOiAibWluIiwKICBtaW5MZW5ndGg6ICJtaW5MZW5ndGgiLAogIG5hbWU6ICJuYW1lIiwKICBwYXR0ZXJuOiAicGF0dGVybiIsCiAgcGVuZGluZzogInBlbmRpbmciLAogIHJlYWRvbmx5OiAicmVhZG9ubHkiLAogIHJlcXVpcmVkOiAicmVxdWlyZWQiLAogIHRvdWNoZWQ6ICJ0b3VjaGVkIgp9Owp2YXIgQ09OVFJPTF9CSU5ESU5HX0tFWVMgPSAoKCkgPT4gT2JqZWN0LmtleXMoQ09OVFJPTF9CSU5ESU5HX05BTUVTKSkoKTsKZnVuY3Rpb24gZ2V0Q29udHJvbEJpbmRpbmdzKGxWaWV3KSB7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gZ2V0QmluZGluZ0luZGV4KCk7CiAgbGV0IGJpbmRpbmdzID0gbFZpZXdbYmluZGluZ0luZGV4XTsKICBpZiAoYmluZGluZ3MgPT09IE5PX0NIQU5HRSkgewogICAgYmluZGluZ3MgPSBsVmlld1tiaW5kaW5nSW5kZXhdID0ge307CiAgfQogIHJldHVybiBiaW5kaW5nczsKfQpmdW5jdGlvbiBjb250cm9sQmluZGluZ1VwZGF0ZWQoYmluZGluZ3MsIGtleSwgdmFsdWUpIHsKICBjb25zdCBvbGRWYWx1ZSA9IGJpbmRpbmdzW2tleV07CiAgaWYgKE9iamVjdC5pcyhvbGRWYWx1ZSwgdmFsdWUpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGJpbmRpbmdzW2tleV0gPSB2YWx1ZTsKICByZXR1cm4gdHJ1ZTsKfQpmdW5jdGlvbiBjb250cm9sQ2xhc3NCaW5kaW5nVXBkYXRlZChiaW5kaW5ncywgY2xhc3NOYW1lLCB2YWx1ZSkgewogIGNvbnN0IG9sZFZhbHVlID0gYmluZGluZ3NbY2xhc3NOYW1lXTsKICBpZiAoT2JqZWN0LmlzKG9sZFZhbHVlLCB2YWx1ZSkpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgYmluZGluZ3NbY2xhc3NOYW1lXSA9IHZhbHVlOwogIHJldHVybiB0cnVlOwp9CmZ1bmN0aW9uIHNldEJvb2xlYW5BdHRyaWJ1dGUocmVuZGVyZXIsIGVsZW1lbnQsIG5hbWUsIHZhbHVlKSB7CiAgaWYgKHZhbHVlKSB7CiAgICByZW5kZXJlci5zZXRBdHRyaWJ1dGUoZWxlbWVudCwgbmFtZSwgIiIpOwogIH0gZWxzZSB7CiAgICByZW5kZXJlci5yZW1vdmVBdHRyaWJ1dGUoZWxlbWVudCwgbmFtZSk7CiAgfQp9CmZ1bmN0aW9uIHNldE9wdGlvbmFsQXR0cmlidXRlKHJlbmRlcmVyLCBlbGVtZW50LCBuYW1lLCB2YWx1ZSkgewogIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7CiAgICByZW5kZXJlci5zZXRBdHRyaWJ1dGUoZWxlbWVudCwgbmFtZSwgdmFsdWUudG9TdHJpbmcoKSk7CiAgfSBlbHNlIHsKICAgIHJlbmRlcmVyLnJlbW92ZUF0dHJpYnV0ZShlbGVtZW50LCBuYW1lKTsKICB9Cn0KdmFyIExpdmVDb2xsZWN0aW9uID0gY2xhc3MgewogIGRlc3Ryb3koaXRlbSkgewogIH0KICB1cGRhdGVWYWx1ZShpbmRleCwgdmFsdWUpIHsKICB9CiAgc3dhcChpbmRleDEsIGluZGV4MikgewogICAgY29uc3Qgc3RhcnRJZHggPSBNYXRoLm1pbihpbmRleDEsIGluZGV4Mik7CiAgICBjb25zdCBlbmRJZHggPSBNYXRoLm1heChpbmRleDEsIGluZGV4Mik7CiAgICBjb25zdCBlbmRJdGVtID0gdGhpcy5kZXRhY2goZW5kSWR4KTsKICAgIGlmIChlbmRJZHggLSBzdGFydElkeCA+IDEpIHsKICAgICAgY29uc3Qgc3RhcnRJdGVtID0gdGhpcy5kZXRhY2goc3RhcnRJZHgpOwogICAgICB0aGlzLmF0dGFjaChzdGFydElkeCwgZW5kSXRlbSk7CiAgICAgIHRoaXMuYXR0YWNoKGVuZElkeCwgc3RhcnRJdGVtKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYXR0YWNoKHN0YXJ0SWR4LCBlbmRJdGVtKTsKICAgIH0KICB9CiAgbW92ZShwcmV2SW5kZXgsIG5ld0lkeCkgewogICAgdGhpcy5hdHRhY2gobmV3SWR4LCB0aGlzLmRldGFjaChwcmV2SW5kZXgpKTsKICB9Cn07CmZ1bmN0aW9uIHZhbHVlc01hdGNoaW5nKGxpdmVJZHgsIGxpdmVWYWx1ZSwgbmV3SWR4LCBuZXdWYWx1ZSwgdHJhY2tCeSkgewogIGlmIChsaXZlSWR4ID09PSBuZXdJZHggJiYgT2JqZWN0LmlzKGxpdmVWYWx1ZSwgbmV3VmFsdWUpKSB7CiAgICByZXR1cm4gMTsKICB9IGVsc2UgaWYgKE9iamVjdC5pcyh0cmFja0J5KGxpdmVJZHgsIGxpdmVWYWx1ZSksIHRyYWNrQnkobmV3SWR4LCBuZXdWYWx1ZSkpKSB7CiAgICByZXR1cm4gLTE7CiAgfQogIHJldHVybiAwOwp9CmZ1bmN0aW9uIHJlY29yZER1cGxpY2F0ZUtleXMoa2V5VG9JZHgsIGtleSwgaWR4KSB7CiAgY29uc3QgaWR4U29GYXIgPSBrZXlUb0lkeC5nZXQoa2V5KTsKICBpZiAoaWR4U29GYXIgIT09IHZvaWQgMCkgewogICAgaWR4U29GYXIuYWRkKGlkeCk7CiAgfSBlbHNlIHsKICAgIGtleVRvSWR4LnNldChrZXksIC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFtpZHhdKSk7CiAgfQp9CmZ1bmN0aW9uIHJlY29uY2lsZShsaXZlQ29sbGVjdGlvbiwgbmV3Q29sbGVjdGlvbiwgdHJhY2tCeUZuLCByZWFjdGl2ZUNvbnN1bWVyKSB7CiAgbGV0IGRldGFjaGVkSXRlbXMgPSB2b2lkIDA7CiAgbGV0IGxpdmVLZXlzSW5UaGVGdXR1cmUgPSB2b2lkIDA7CiAgbGV0IGxpdmVTdGFydElkeCA9IDA7CiAgbGV0IGxpdmVFbmRJZHggPSBsaXZlQ29sbGVjdGlvbi5sZW5ndGggLSAxOwogIGNvbnN0IGR1cGxpY2F0ZUtleXMgPSBuZ0Rldk1vZGUgPyAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpIDogdm9pZCAwOwogIGlmIChBcnJheS5pc0FycmF5KG5ld0NvbGxlY3Rpb24pKSB7CiAgICBzZXRBY3RpdmVDb25zdW1lcihyZWFjdGl2ZUNvbnN1bWVyKTsKICAgIGxldCBuZXdFbmRJZHggPSBuZXdDb2xsZWN0aW9uLmxlbmd0aCAtIDE7CiAgICBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgIHdoaWxlIChsaXZlU3RhcnRJZHggPD0gbGl2ZUVuZElkeCAmJiBsaXZlU3RhcnRJZHggPD0gbmV3RW5kSWR4KSB7CiAgICAgIGNvbnN0IGxpdmVTdGFydFZhbHVlID0gbGl2ZUNvbGxlY3Rpb24uYXQobGl2ZVN0YXJ0SWR4KTsKICAgICAgY29uc3QgbmV3U3RhcnRWYWx1ZSA9IG5ld0NvbGxlY3Rpb25bbGl2ZVN0YXJ0SWR4XTsKICAgICAgaWYgKG5nRGV2TW9kZSkgewogICAgICAgIHJlY29yZER1cGxpY2F0ZUtleXMoZHVwbGljYXRlS2V5cywgdHJhY2tCeUZuKGxpdmVTdGFydElkeCwgbmV3U3RhcnRWYWx1ZSksIGxpdmVTdGFydElkeCk7CiAgICAgIH0KICAgICAgY29uc3QgaXNTdGFydE1hdGNoaW5nID0gdmFsdWVzTWF0Y2hpbmcobGl2ZVN0YXJ0SWR4LCBsaXZlU3RhcnRWYWx1ZSwgbGl2ZVN0YXJ0SWR4LCBuZXdTdGFydFZhbHVlLCB0cmFja0J5Rm4pOwogICAgICBpZiAoaXNTdGFydE1hdGNoaW5nICE9PSAwKSB7CiAgICAgICAgaWYgKGlzU3RhcnRNYXRjaGluZyA8IDApIHsKICAgICAgICAgIGxpdmVDb2xsZWN0aW9uLnVwZGF0ZVZhbHVlKGxpdmVTdGFydElkeCwgbmV3U3RhcnRWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIGxpdmVTdGFydElkeCsrOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGNvbnN0IGxpdmVFbmRWYWx1ZSA9IGxpdmVDb2xsZWN0aW9uLmF0KGxpdmVFbmRJZHgpOwogICAgICBjb25zdCBuZXdFbmRWYWx1ZSA9IG5ld0NvbGxlY3Rpb25bbmV3RW5kSWR4XTsKICAgICAgaWYgKG5nRGV2TW9kZSkgewogICAgICAgIHJlY29yZER1cGxpY2F0ZUtleXMoZHVwbGljYXRlS2V5cywgdHJhY2tCeUZuKG5ld0VuZElkeCwgbmV3RW5kVmFsdWUpLCBuZXdFbmRJZHgpOwogICAgICB9CiAgICAgIGNvbnN0IGlzRW5kTWF0Y2hpbmcgPSB2YWx1ZXNNYXRjaGluZyhsaXZlRW5kSWR4LCBsaXZlRW5kVmFsdWUsIG5ld0VuZElkeCwgbmV3RW5kVmFsdWUsIHRyYWNrQnlGbik7CiAgICAgIGlmIChpc0VuZE1hdGNoaW5nICE9PSAwKSB7CiAgICAgICAgaWYgKGlzRW5kTWF0Y2hpbmcgPCAwKSB7CiAgICAgICAgICBsaXZlQ29sbGVjdGlvbi51cGRhdGVWYWx1ZShsaXZlRW5kSWR4LCBuZXdFbmRWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIGxpdmVFbmRJZHgtLTsKICAgICAgICBuZXdFbmRJZHgtLTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBsaXZlU3RhcnRLZXkgPSB0cmFja0J5Rm4obGl2ZVN0YXJ0SWR4LCBsaXZlU3RhcnRWYWx1ZSk7CiAgICAgIGNvbnN0IGxpdmVFbmRLZXkgPSB0cmFja0J5Rm4obGl2ZUVuZElkeCwgbGl2ZUVuZFZhbHVlKTsKICAgICAgY29uc3QgbmV3U3RhcnRLZXkgPSB0cmFja0J5Rm4obGl2ZVN0YXJ0SWR4LCBuZXdTdGFydFZhbHVlKTsKICAgICAgaWYgKE9iamVjdC5pcyhuZXdTdGFydEtleSwgbGl2ZUVuZEtleSkpIHsKICAgICAgICBjb25zdCBuZXdFbmRLZXkgPSB0cmFja0J5Rm4obmV3RW5kSWR4LCBuZXdFbmRWYWx1ZSk7CiAgICAgICAgaWYgKE9iamVjdC5pcyhuZXdFbmRLZXksIGxpdmVTdGFydEtleSkpIHsKICAgICAgICAgIGxpdmVDb2xsZWN0aW9uLnN3YXAobGl2ZVN0YXJ0SWR4LCBsaXZlRW5kSWR4KTsKICAgICAgICAgIGxpdmVDb2xsZWN0aW9uLnVwZGF0ZVZhbHVlKGxpdmVFbmRJZHgsIG5ld0VuZFZhbHVlKTsKICAgICAgICAgIG5ld0VuZElkeC0tOwogICAgICAgICAgbGl2ZUVuZElkeC0tOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsaXZlQ29sbGVjdGlvbi5tb3ZlKGxpdmVFbmRJZHgsIGxpdmVTdGFydElkeCk7CiAgICAgICAgfQogICAgICAgIGxpdmVDb2xsZWN0aW9uLnVwZGF0ZVZhbHVlKGxpdmVTdGFydElkeCwgbmV3U3RhcnRWYWx1ZSk7CiAgICAgICAgbGl2ZVN0YXJ0SWR4Kys7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgZGV0YWNoZWRJdGVtcyA/Pz0gbmV3IFVuaXF1ZVZhbHVlTXVsdGlLZXlNYXAoKTsKICAgICAgbGl2ZUtleXNJblRoZUZ1dHVyZSA/Pz0gaW5pdExpdmVJdGVtc0luVGhlRnV0dXJlKGxpdmVDb2xsZWN0aW9uLCBsaXZlU3RhcnRJZHgsIGxpdmVFbmRJZHgsIHRyYWNrQnlGbik7CiAgICAgIGlmIChhdHRhY2hQcmV2aW91c2x5RGV0YWNoZWQobGl2ZUNvbGxlY3Rpb24sIGRldGFjaGVkSXRlbXMsIGxpdmVTdGFydElkeCwgbmV3U3RhcnRLZXkpKSB7CiAgICAgICAgbGl2ZUNvbGxlY3Rpb24udXBkYXRlVmFsdWUobGl2ZVN0YXJ0SWR4LCBuZXdTdGFydFZhbHVlKTsKICAgICAgICBsaXZlU3RhcnRJZHgrKzsKICAgICAgICBsaXZlRW5kSWR4Kys7CiAgICAgIH0gZWxzZSBpZiAoIWxpdmVLZXlzSW5UaGVGdXR1cmUuaGFzKG5ld1N0YXJ0S2V5KSkgewogICAgICAgIGNvbnN0IG5ld0l0ZW0gPSBsaXZlQ29sbGVjdGlvbi5jcmVhdGUobGl2ZVN0YXJ0SWR4LCBuZXdDb2xsZWN0aW9uW2xpdmVTdGFydElkeF0pOwogICAgICAgIGxpdmVDb2xsZWN0aW9uLmF0dGFjaChsaXZlU3RhcnRJZHgsIG5ld0l0ZW0pOwogICAgICAgIGxpdmVTdGFydElkeCsrOwogICAgICAgIGxpdmVFbmRJZHgrKzsKICAgICAgfSBlbHNlIHsKICAgICAgICBkZXRhY2hlZEl0ZW1zLnNldChsaXZlU3RhcnRLZXksIGxpdmVDb2xsZWN0aW9uLmRldGFjaChsaXZlU3RhcnRJZHgpKTsKICAgICAgICBsaXZlRW5kSWR4LS07CiAgICAgIH0KICAgIH0KICAgIHdoaWxlIChsaXZlU3RhcnRJZHggPD0gbmV3RW5kSWR4KSB7CiAgICAgIGNyZWF0ZU9yQXR0YWNoKGxpdmVDb2xsZWN0aW9uLCBkZXRhY2hlZEl0ZW1zLCB0cmFja0J5Rm4sIGxpdmVTdGFydElkeCwgbmV3Q29sbGVjdGlvbltsaXZlU3RhcnRJZHhdKTsKICAgICAgbGl2ZVN0YXJ0SWR4Kys7CiAgICB9CiAgfSBlbHNlIGlmIChuZXdDb2xsZWN0aW9uICE9IG51bGwpIHsKICAgIHNldEFjdGl2ZUNvbnN1bWVyKHJlYWN0aXZlQ29uc3VtZXIpOwogICAgY29uc3QgbmV3Q29sbGVjdGlvbkl0ZXJhdG9yID0gbmV3Q29sbGVjdGlvbltTeW1ib2wuaXRlcmF0b3JdKCk7CiAgICBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgIGxldCBuZXdJdGVyYXRpb25SZXN1bHQgPSBuZXdDb2xsZWN0aW9uSXRlcmF0b3IubmV4dCgpOwogICAgd2hpbGUgKCFuZXdJdGVyYXRpb25SZXN1bHQuZG9uZSAmJiBsaXZlU3RhcnRJZHggPD0gbGl2ZUVuZElkeCkgewogICAgICBjb25zdCBsaXZlVmFsdWUgPSBsaXZlQ29sbGVjdGlvbi5hdChsaXZlU3RhcnRJZHgpOwogICAgICBjb25zdCBuZXdWYWx1ZSA9IG5ld0l0ZXJhdGlvblJlc3VsdC52YWx1ZTsKICAgICAgaWYgKG5nRGV2TW9kZSkgewogICAgICAgIHJlY29yZER1cGxpY2F0ZUtleXMoZHVwbGljYXRlS2V5cywgdHJhY2tCeUZuKGxpdmVTdGFydElkeCwgbmV3VmFsdWUpLCBsaXZlU3RhcnRJZHgpOwogICAgICB9CiAgICAgIGNvbnN0IGlzU3RhcnRNYXRjaGluZyA9IHZhbHVlc01hdGNoaW5nKGxpdmVTdGFydElkeCwgbGl2ZVZhbHVlLCBsaXZlU3RhcnRJZHgsIG5ld1ZhbHVlLCB0cmFja0J5Rm4pOwogICAgICBpZiAoaXNTdGFydE1hdGNoaW5nICE9PSAwKSB7CiAgICAgICAgaWYgKGlzU3RhcnRNYXRjaGluZyA8IDApIHsKICAgICAgICAgIGxpdmVDb2xsZWN0aW9uLnVwZGF0ZVZhbHVlKGxpdmVTdGFydElkeCwgbmV3VmFsdWUpOwogICAgICAgIH0KICAgICAgICBsaXZlU3RhcnRJZHgrKzsKICAgICAgICBuZXdJdGVyYXRpb25SZXN1bHQgPSBuZXdDb2xsZWN0aW9uSXRlcmF0b3IubmV4dCgpOwogICAgICB9IGVsc2UgewogICAgICAgIGRldGFjaGVkSXRlbXMgPz89IG5ldyBVbmlxdWVWYWx1ZU11bHRpS2V5TWFwKCk7CiAgICAgICAgbGl2ZUtleXNJblRoZUZ1dHVyZSA/Pz0gaW5pdExpdmVJdGVtc0luVGhlRnV0dXJlKGxpdmVDb2xsZWN0aW9uLCBsaXZlU3RhcnRJZHgsIGxpdmVFbmRJZHgsIHRyYWNrQnlGbik7CiAgICAgICAgY29uc3QgbmV3S2V5ID0gdHJhY2tCeUZuKGxpdmVTdGFydElkeCwgbmV3VmFsdWUpOwogICAgICAgIGlmIChhdHRhY2hQcmV2aW91c2x5RGV0YWNoZWQobGl2ZUNvbGxlY3Rpb24sIGRldGFjaGVkSXRlbXMsIGxpdmVTdGFydElkeCwgbmV3S2V5KSkgewogICAgICAgICAgbGl2ZUNvbGxlY3Rpb24udXBkYXRlVmFsdWUobGl2ZVN0YXJ0SWR4LCBuZXdWYWx1ZSk7CiAgICAgICAgICBsaXZlU3RhcnRJZHgrKzsKICAgICAgICAgIGxpdmVFbmRJZHgrKzsKICAgICAgICAgIG5ld0l0ZXJhdGlvblJlc3VsdCA9IG5ld0NvbGxlY3Rpb25JdGVyYXRvci5uZXh0KCk7CiAgICAgICAgfSBlbHNlIGlmICghbGl2ZUtleXNJblRoZUZ1dHVyZS5oYXMobmV3S2V5KSkgewogICAgICAgICAgbGl2ZUNvbGxlY3Rpb24uYXR0YWNoKGxpdmVTdGFydElkeCwgbGl2ZUNvbGxlY3Rpb24uY3JlYXRlKGxpdmVTdGFydElkeCwgbmV3VmFsdWUpKTsKICAgICAgICAgIGxpdmVTdGFydElkeCsrOwogICAgICAgICAgbGl2ZUVuZElkeCsrOwogICAgICAgICAgbmV3SXRlcmF0aW9uUmVzdWx0ID0gbmV3Q29sbGVjdGlvbkl0ZXJhdG9yLm5leHQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgbGl2ZUtleSA9IHRyYWNrQnlGbihsaXZlU3RhcnRJZHgsIGxpdmVWYWx1ZSk7CiAgICAgICAgICBkZXRhY2hlZEl0ZW1zLnNldChsaXZlS2V5LCBsaXZlQ29sbGVjdGlvbi5kZXRhY2gobGl2ZVN0YXJ0SWR4KSk7CiAgICAgICAgICBsaXZlRW5kSWR4LS07CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICB3aGlsZSAoIW5ld0l0ZXJhdGlvblJlc3VsdC5kb25lKSB7CiAgICAgIGNyZWF0ZU9yQXR0YWNoKGxpdmVDb2xsZWN0aW9uLCBkZXRhY2hlZEl0ZW1zLCB0cmFja0J5Rm4sIGxpdmVDb2xsZWN0aW9uLmxlbmd0aCwgbmV3SXRlcmF0aW9uUmVzdWx0LnZhbHVlKTsKICAgICAgbmV3SXRlcmF0aW9uUmVzdWx0ID0gbmV3Q29sbGVjdGlvbkl0ZXJhdG9yLm5leHQoKTsKICAgIH0KICB9CiAgd2hpbGUgKGxpdmVTdGFydElkeCA8PSBsaXZlRW5kSWR4KSB7CiAgICBsaXZlQ29sbGVjdGlvbi5kZXN0cm95KGxpdmVDb2xsZWN0aW9uLmRldGFjaChsaXZlRW5kSWR4LS0pKTsKICB9CiAgZGV0YWNoZWRJdGVtcz8uZm9yRWFjaCgoaXRlbSkgPT4gewogICAgbGl2ZUNvbGxlY3Rpb24uZGVzdHJveShpdGVtKTsKICB9KTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBsZXQgZHVwbGljYXRlZEtleXNNc2cgPSBbXTsKICAgIGZvciAoY29uc3QgW2tleSwgaWR4U2V0XSBvZiBkdXBsaWNhdGVLZXlzKSB7CiAgICAgIGlmIChpZHhTZXQuc2l6ZSA+IDEpIHsKICAgICAgICBjb25zdCBpZHggPSBbLi4uaWR4U2V0XS5zb3J0KChhLCBiKSA9PiBhIC0gYik7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBpZHgubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGR1cGxpY2F0ZWRLZXlzTXNnLnB1c2goYGtleSAiJHtzdHJpbmdpZnlGb3JFcnJvcihrZXkpfSIgYXQgaW5kZXggIiR7aWR4W2kgLSAxXX0iIGFuZCAiJHtpZHhbaV19ImApOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKGR1cGxpY2F0ZWRLZXlzTXNnLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgbWVzc2FnZSA9IGZvcm1hdFJ1bnRpbWVFcnJvcigtOTU1LCAiVGhlIHByb3ZpZGVkIHRyYWNrIGV4cHJlc3Npb24gcmVzdWx0ZWQgaW4gZHVwbGljYXRlZCBrZXlzIGZvciBhIGdpdmVuIGNvbGxlY3Rpb24uIEFkanVzdCB0aGUgdHJhY2tpbmcgZXhwcmVzc2lvbiBzdWNoIHRoYXQgaXQgdW5pcXVlbHkgaWRlbnRpZmllcyBhbGwgdGhlIGl0ZW1zIGluIHRoZSBjb2xsZWN0aW9uLiBEdXBsaWNhdGVkIGtleXMgd2VyZTogXG4iICsgZHVwbGljYXRlZEtleXNNc2cuam9pbigiLCBcbiIpICsgIi4iKTsKICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UpOwogICAgfQogIH0KfQpmdW5jdGlvbiBhdHRhY2hQcmV2aW91c2x5RGV0YWNoZWQocHJldkNvbGxlY3Rpb24sIGRldGFjaGVkSXRlbXMsIGluZGV4LCBrZXkpIHsKICBpZiAoZGV0YWNoZWRJdGVtcyAhPT0gdm9pZCAwICYmIGRldGFjaGVkSXRlbXMuaGFzKGtleSkpIHsKICAgIHByZXZDb2xsZWN0aW9uLmF0dGFjaChpbmRleCwgZGV0YWNoZWRJdGVtcy5nZXQoa2V5KSk7CiAgICBkZXRhY2hlZEl0ZW1zLmRlbGV0ZShrZXkpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBjcmVhdGVPckF0dGFjaChsaXZlQ29sbGVjdGlvbiwgZGV0YWNoZWRJdGVtcywgdHJhY2tCeUZuLCBpbmRleCwgdmFsdWUpIHsKICBpZiAoIWF0dGFjaFByZXZpb3VzbHlEZXRhY2hlZChsaXZlQ29sbGVjdGlvbiwgZGV0YWNoZWRJdGVtcywgaW5kZXgsIHRyYWNrQnlGbihpbmRleCwgdmFsdWUpKSkgewogICAgY29uc3QgbmV3SXRlbSA9IGxpdmVDb2xsZWN0aW9uLmNyZWF0ZShpbmRleCwgdmFsdWUpOwogICAgbGl2ZUNvbGxlY3Rpb24uYXR0YWNoKGluZGV4LCBuZXdJdGVtKTsKICB9IGVsc2UgewogICAgbGl2ZUNvbGxlY3Rpb24udXBkYXRlVmFsdWUoaW5kZXgsIHZhbHVlKTsKICB9Cn0KZnVuY3Rpb24gaW5pdExpdmVJdGVtc0luVGhlRnV0dXJlKGxpdmVDb2xsZWN0aW9uLCBzdGFydCwgZW5kLCB0cmFja0J5Rm4pIHsKICBjb25zdCBrZXlzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPD0gZW5kOyBpKyspIHsKICAgIGtleXMuYWRkKHRyYWNrQnlGbihpLCBsaXZlQ29sbGVjdGlvbi5hdChpKSkpOwogIH0KICByZXR1cm4ga2V5czsKfQp2YXIgVW5pcXVlVmFsdWVNdWx0aUtleU1hcCA9IGNsYXNzIHsKICBrdk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgX3ZNYXAgPSB2b2lkIDA7CiAgaGFzKGtleSkgewogICAgcmV0dXJuIHRoaXMua3ZNYXAuaGFzKGtleSk7CiAgfQogIGRlbGV0ZShrZXkpIHsKICAgIGlmICghdGhpcy5oYXMoa2V5KSkgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgdmFsdWUgPSB0aGlzLmt2TWFwLmdldChrZXkpOwogICAgaWYgKHRoaXMuX3ZNYXAgIT09IHZvaWQgMCAmJiB0aGlzLl92TWFwLmhhcyh2YWx1ZSkpIHsKICAgICAgdGhpcy5rdk1hcC5zZXQoa2V5LCB0aGlzLl92TWFwLmdldCh2YWx1ZSkpOwogICAgICB0aGlzLl92TWFwLmRlbGV0ZSh2YWx1ZSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmt2TWFwLmRlbGV0ZShrZXkpOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQogIGdldChrZXkpIHsKICAgIHJldHVybiB0aGlzLmt2TWFwLmdldChrZXkpOwogIH0KICBzZXQoa2V5LCB2YWx1ZSkgewogICAgaWYgKHRoaXMua3ZNYXAuaGFzKGtleSkpIHsKICAgICAgbGV0IHByZXZWYWx1ZSA9IHRoaXMua3ZNYXAuZ2V0KGtleSk7CiAgICAgIGlmIChuZ0Rldk1vZGUgJiYgcHJldlZhbHVlID09PSB2YWx1ZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgRGV0ZWN0ZWQgYSBkdXBsaWNhdGVkIHZhbHVlICR7dmFsdWV9IGZvciB0aGUga2V5ICR7a2V5fWApOwogICAgICB9CiAgICAgIGlmICh0aGlzLl92TWFwID09PSB2b2lkIDApIHsKICAgICAgICB0aGlzLl92TWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgfQogICAgICBjb25zdCB2TWFwID0gdGhpcy5fdk1hcDsKICAgICAgd2hpbGUgKHZNYXAuaGFzKHByZXZWYWx1ZSkpIHsKICAgICAgICBwcmV2VmFsdWUgPSB2TWFwLmdldChwcmV2VmFsdWUpOwogICAgICB9CiAgICAgIHZNYXAuc2V0KHByZXZWYWx1ZSwgdmFsdWUpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5rdk1hcC5zZXQoa2V5LCB2YWx1ZSk7CiAgICB9CiAgfQogIGZvckVhY2goY2IpIHsKICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiB0aGlzLmt2TWFwKSB7CiAgICAgIGNiKHZhbHVlLCBrZXkpOwogICAgICBpZiAodGhpcy5fdk1hcCAhPT0gdm9pZCAwKSB7CiAgICAgICAgY29uc3Qgdk1hcCA9IHRoaXMuX3ZNYXA7CiAgICAgICAgd2hpbGUgKHZNYXAuaGFzKHZhbHVlKSkgewogICAgICAgICAgdmFsdWUgPSB2TWFwLmdldCh2YWx1ZSk7CiAgICAgICAgICBjYih2YWx1ZSwga2V5KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07CmZ1bmN0aW9uIMm1ybVjb25kaXRpb25hbENyZWF0ZShpbmRleCwgdGVtcGxhdGVGbiwgZGVjbHMsIHZhcnMsIHRhZ05hbWUsIGF0dHJzSW5kZXgsIGxvY2FsUmVmc0luZGV4LCBsb2NhbFJlZkV4dHJhY3RvcikgewogIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUoIk5nQ29udHJvbEZsb3ciKTsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IGF0dHJzID0gZ2V0Q29uc3RhbnQodFZpZXcuY29uc3RzLCBhdHRyc0luZGV4KTsKICBkZWNsYXJlTm9EaXJlY3RpdmVIb3N0VGVtcGxhdGUobFZpZXcsIHRWaWV3LCBpbmRleCwgdGVtcGxhdGVGbiwgZGVjbHMsIHZhcnMsIHRhZ05hbWUsIGF0dHJzLCAyNTYsIGxvY2FsUmVmc0luZGV4LCBsb2NhbFJlZkV4dHJhY3Rvcik7CiAgcmV0dXJuIMm1ybVjb25kaXRpb25hbEJyYW5jaENyZWF0ZTsKfQpmdW5jdGlvbiDJtcm1Y29uZGl0aW9uYWxCcmFuY2hDcmVhdGUoaW5kZXgsIHRlbXBsYXRlRm4sIGRlY2xzLCB2YXJzLCB0YWdOYW1lLCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCwgbG9jYWxSZWZFeHRyYWN0b3IpIHsKICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0NvbnRyb2xGbG93Iik7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBhdHRycyA9IGdldENvbnN0YW50KHRWaWV3LmNvbnN0cywgYXR0cnNJbmRleCk7CiAgZGVjbGFyZU5vRGlyZWN0aXZlSG9zdFRlbXBsYXRlKGxWaWV3LCB0VmlldywgaW5kZXgsIHRlbXBsYXRlRm4sIGRlY2xzLCB2YXJzLCB0YWdOYW1lLCBhdHRycywgNTEyLCBsb2NhbFJlZnNJbmRleCwgbG9jYWxSZWZFeHRyYWN0b3IpOwogIHJldHVybiDJtcm1Y29uZGl0aW9uYWxCcmFuY2hDcmVhdGU7Cn0KZnVuY3Rpb24gybXJtWNvbmRpdGlvbmFsKG1hdGNoaW5nVGVtcGxhdGVJbmRleCwgY29udGV4dFZhbHVlKSB7CiAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiTmdDb250cm9sRmxvdyIpOwogIGNvbnN0IGhvc3RMVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gbmV4dEJpbmRpbmdJbmRleCgpOwogIGNvbnN0IHByZXZNYXRjaGluZ1RlbXBsYXRlSW5kZXggPSBob3N0TFZpZXdbYmluZGluZ0luZGV4XSAhPT0gTk9fQ0hBTkdFID8gaG9zdExWaWV3W2JpbmRpbmdJbmRleF0gOiAtMTsKICBjb25zdCBwcmV2Q29udGFpbmVyID0gcHJldk1hdGNoaW5nVGVtcGxhdGVJbmRleCAhPT0gLTEgPyBnZXRMQ29udGFpbmVyKGhvc3RMVmlldywgSEVBREVSX09GRlNFVCArIHByZXZNYXRjaGluZ1RlbXBsYXRlSW5kZXgpIDogdm9pZCAwOwogIGNvbnN0IHZpZXdJbkNvbnRhaW5lcklkeCA9IDA7CiAgaWYgKGJpbmRpbmdVcGRhdGVkKGhvc3RMVmlldywgYmluZGluZ0luZGV4LCBtYXRjaGluZ1RlbXBsYXRlSW5kZXgpKSB7CiAgICBjb25zdCBwcmV2Q29uc3VtZXIgPSBzZXRBY3RpdmVDb25zdW1lcihudWxsKTsKICAgIHRyeSB7CiAgICAgIGlmIChwcmV2Q29udGFpbmVyICE9PSB2b2lkIDApIHsKICAgICAgICByZW1vdmVMVmlld0Zyb21MQ29udGFpbmVyKHByZXZDb250YWluZXIsIHZpZXdJbkNvbnRhaW5lcklkeCk7CiAgICAgIH0KICAgICAgaWYgKG1hdGNoaW5nVGVtcGxhdGVJbmRleCAhPT0gLTEpIHsKICAgICAgICBjb25zdCBuZXh0TENvbnRhaW5lckluZGV4ID0gSEVBREVSX09GRlNFVCArIG1hdGNoaW5nVGVtcGxhdGVJbmRleDsKICAgICAgICBjb25zdCBuZXh0Q29udGFpbmVyID0gZ2V0TENvbnRhaW5lcihob3N0TFZpZXcsIG5leHRMQ29udGFpbmVySW5kZXgpOwogICAgICAgIGNvbnN0IHRlbXBsYXRlVE5vZGUgPSBnZXRFeGlzdGluZ1ROb2RlKGhvc3RMVmlld1tUVklFV10sIG5leHRMQ29udGFpbmVySW5kZXgpOwogICAgICAgIGNvbnN0IGRlaHlkcmF0ZWRWaWV3ID0gZmluZEFuZFJlY29uY2lsZU1hdGNoaW5nRGVoeWRyYXRlZFZpZXdzKG5leHRDb250YWluZXIsIHRlbXBsYXRlVE5vZGUsIGhvc3RMVmlldyk7CiAgICAgICAgY29uc3QgZW1iZWRkZWRMVmlldyA9IGNyZWF0ZUFuZFJlbmRlckVtYmVkZGVkTFZpZXcoaG9zdExWaWV3LCB0ZW1wbGF0ZVROb2RlLCBjb250ZXh0VmFsdWUsIHsKICAgICAgICAgIGRlaHlkcmF0ZWRWaWV3CiAgICAgICAgfSk7CiAgICAgICAgYWRkTFZpZXdUb0xDb250YWluZXIobmV4dENvbnRhaW5lciwgZW1iZWRkZWRMVmlldywgdmlld0luQ29udGFpbmVySWR4LCBzaG91bGRBZGRWaWV3VG9Eb20odGVtcGxhdGVUTm9kZSwgZGVoeWRyYXRlZFZpZXcpKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgc2V0QWN0aXZlQ29uc3VtZXIocHJldkNvbnN1bWVyKTsKICAgIH0KICB9IGVsc2UgaWYgKHByZXZDb250YWluZXIgIT09IHZvaWQgMCkgewogICAgY29uc3QgbFZpZXcgPSBnZXRMVmlld0Zyb21MQ29udGFpbmVyKHByZXZDb250YWluZXIsIHZpZXdJbkNvbnRhaW5lcklkeCk7CiAgICBpZiAobFZpZXcgIT09IHZvaWQgMCkgewogICAgICBsVmlld1tDT05URVhUXSA9IGNvbnRleHRWYWx1ZTsKICAgIH0KICB9Cn0KdmFyIFJlcGVhdGVyQ29udGV4dCA9IGNsYXNzIHsKICBsQ29udGFpbmVyOwogICRpbXBsaWNpdDsKICAkaW5kZXg7CiAgY29uc3RydWN0b3IobENvbnRhaW5lciwgJGltcGxpY2l0LCAkaW5kZXgpIHsKICAgIHRoaXMubENvbnRhaW5lciA9IGxDb250YWluZXI7CiAgICB0aGlzLiRpbXBsaWNpdCA9ICRpbXBsaWNpdDsKICAgIHRoaXMuJGluZGV4ID0gJGluZGV4OwogIH0KICBnZXQgJGNvdW50KCkgewogICAgcmV0dXJuIHRoaXMubENvbnRhaW5lci5sZW5ndGggLSBDT05UQUlORVJfSEVBREVSX09GRlNFVDsKICB9Cn07CmZ1bmN0aW9uIMm1ybVyZXBlYXRlclRyYWNrQnlJbmRleChpbmRleCkgewogIHJldHVybiBpbmRleDsKfQpmdW5jdGlvbiDJtcm1cmVwZWF0ZXJUcmFja0J5SWRlbnRpdHkoXywgdmFsdWUpIHsKICByZXR1cm4gdmFsdWU7Cn0KdmFyIFJlcGVhdGVyTWV0YWRhdGEgPSBjbGFzcyB7CiAgaGFzRW1wdHlCbG9jazsKICB0cmFja0J5Rm47CiAgbGl2ZUNvbGxlY3Rpb247CiAgY29uc3RydWN0b3IoaGFzRW1wdHlCbG9jaywgdHJhY2tCeUZuLCBsaXZlQ29sbGVjdGlvbikgewogICAgdGhpcy5oYXNFbXB0eUJsb2NrID0gaGFzRW1wdHlCbG9jazsKICAgIHRoaXMudHJhY2tCeUZuID0gdHJhY2tCeUZuOwogICAgdGhpcy5saXZlQ29sbGVjdGlvbiA9IGxpdmVDb2xsZWN0aW9uOwogIH0KfTsKZnVuY3Rpb24gybXJtXJlcGVhdGVyQ3JlYXRlKGluZGV4LCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgdGFnTmFtZSwgYXR0cnNJbmRleCwgdHJhY2tCeUZuLCB0cmFja0J5VXNlc0NvbXBvbmVudEluc3RhbmNlLCBlbXB0eVRlbXBsYXRlRm4sIGVtcHR5RGVjbHMsIGVtcHR5VmFycywgZW1wdHlUYWdOYW1lLCBlbXB0eUF0dHJzSW5kZXgpIHsKICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0NvbnRyb2xGbG93Iik7CiAgbmdEZXZNb2RlICYmIGFzc2VydEZ1bmN0aW9uKHRyYWNrQnlGbiwgYEEgdHJhY2sgZXhwcmVzc2lvbiBtdXN0IGJlIGEgZnVuY3Rpb24sIHdhcyAke3R5cGVvZiB0cmFja0J5Rm59IGluc3RlYWQuYCk7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBoYXNFbXB0eUJsb2NrID0gZW1wdHlUZW1wbGF0ZUZuICE9PSB2b2lkIDA7CiAgY29uc3QgaG9zdExWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBib3VuZFRyYWNrQnkgPSB0cmFja0J5VXNlc0NvbXBvbmVudEluc3RhbmNlID8gdHJhY2tCeUZuLmJpbmQoaG9zdExWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXVtDT05URVhUXSkgOiB0cmFja0J5Rm47CiAgY29uc3QgbWV0YWRhdGEgPSBuZXcgUmVwZWF0ZXJNZXRhZGF0YShoYXNFbXB0eUJsb2NrLCBib3VuZFRyYWNrQnkpOwogIGhvc3RMVmlld1tIRUFERVJfT0ZGU0VUICsgaW5kZXhdID0gbWV0YWRhdGE7CiAgZGVjbGFyZU5vRGlyZWN0aXZlSG9zdFRlbXBsYXRlKGxWaWV3LCB0VmlldywgaW5kZXggKyAxLCB0ZW1wbGF0ZUZuLCBkZWNscywgdmFycywgdGFnTmFtZSwgZ2V0Q29uc3RhbnQodFZpZXcuY29uc3RzLCBhdHRyc0luZGV4KSwgMjU2KTsKICBpZiAoaGFzRW1wdHlCbG9jaykgewogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoZW1wdHlEZWNscywgIk1pc3NpbmcgbnVtYmVyIG9mIGRlY2xhcmF0aW9ucyBmb3IgdGhlIGVtcHR5IHJlcGVhdGVyIGJsb2NrLiIpOwogICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoZW1wdHlWYXJzLCAiTWlzc2luZyBudW1iZXIgb2YgYmluZGluZ3MgZm9yIHRoZSBlbXB0eSByZXBlYXRlciBibG9jay4iKTsKICAgIGRlY2xhcmVOb0RpcmVjdGl2ZUhvc3RUZW1wbGF0ZShsVmlldywgdFZpZXcsIGluZGV4ICsgMiwgZW1wdHlUZW1wbGF0ZUZuLCBlbXB0eURlY2xzLCBlbXB0eVZhcnMsIGVtcHR5VGFnTmFtZSwgZ2V0Q29uc3RhbnQodFZpZXcuY29uc3RzLCBlbXB0eUF0dHJzSW5kZXgpLCA1MTIpOwogIH0KfQpmdW5jdGlvbiBpc1ZpZXdFeHBlbnNpdmVUb1JlY3JlYXRlKGxWaWV3KSB7CiAgcmV0dXJuIGxWaWV3Lmxlbmd0aCAtIEhFQURFUl9PRkZTRVQgPiAyOwp9CnZhciBPcGVyYXRpb25zQ291bnRlciA9IGNsYXNzIHsKICBjcmVhdGVkID0gMDsKICBkZXN0cm95ZWQgPSAwOwogIHJlc2V0KCkgewogICAgdGhpcy5jcmVhdGVkID0gMDsKICAgIHRoaXMuZGVzdHJveWVkID0gMDsKICB9CiAgcmVjb3JkQ3JlYXRlKCkgewogICAgdGhpcy5jcmVhdGVkKys7CiAgfQogIHJlY29yZERlc3Ryb3koKSB7CiAgICB0aGlzLmRlc3Ryb3llZCsrOwogIH0KICB3YXNSZUNyZWF0ZWQoY29sbGVjdGlvbkxlbikgewogICAgcmV0dXJuIGNvbGxlY3Rpb25MZW4gPiAwICYmIHRoaXMuY3JlYXRlZCA9PT0gdGhpcy5kZXN0cm95ZWQgJiYgdGhpcy5jcmVhdGVkID09PSBjb2xsZWN0aW9uTGVuOwogIH0KfTsKdmFyIExpdmVDb2xsZWN0aW9uTENvbnRhaW5lckltcGwgPSBjbGFzcyBleHRlbmRzIExpdmVDb2xsZWN0aW9uIHsKICBsQ29udGFpbmVyOwogIGhvc3RMVmlldzsKICB0ZW1wbGF0ZVROb2RlOwogIG9wZXJhdGlvbnNDb3VudGVyID0gbmdEZXZNb2RlID8gbmV3IE9wZXJhdGlvbnNDb3VudGVyKCkgOiB2b2lkIDA7CiAgbmVlZHNJbmRleFVwZGF0ZSA9IGZhbHNlOwogIGNvbnN0cnVjdG9yKGxDb250YWluZXIsIGhvc3RMVmlldywgdGVtcGxhdGVUTm9kZSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMubENvbnRhaW5lciA9IGxDb250YWluZXI7CiAgICB0aGlzLmhvc3RMVmlldyA9IGhvc3RMVmlldzsKICAgIHRoaXMudGVtcGxhdGVUTm9kZSA9IHRlbXBsYXRlVE5vZGU7CiAgfQogIGdldCBsZW5ndGgoKSB7CiAgICByZXR1cm4gdGhpcy5sQ29udGFpbmVyLmxlbmd0aCAtIENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUOwogIH0KICBhdChpbmRleCkgewogICAgcmV0dXJuIHRoaXMuZ2V0TFZpZXcoaW5kZXgpW0NPTlRFWFRdLiRpbXBsaWNpdDsKICB9CiAgYXR0YWNoKGluZGV4LCBsVmlldykgewogICAgY29uc3QgZGVoeWRyYXRlZFZpZXcgPSBsVmlld1tIWURSQVRJT05dOwogICAgdGhpcy5uZWVkc0luZGV4VXBkYXRlIHx8PSBpbmRleCAhPT0gdGhpcy5sZW5ndGg7CiAgICBhZGRMVmlld1RvTENvbnRhaW5lcih0aGlzLmxDb250YWluZXIsIGxWaWV3LCBpbmRleCwgc2hvdWxkQWRkVmlld1RvRG9tKHRoaXMudGVtcGxhdGVUTm9kZSwgZGVoeWRyYXRlZFZpZXcpKTsKICAgIGNsZWFyRGV0YWNoQW5pbWF0aW9uTGlzdCh0aGlzLmxDb250YWluZXIsIGluZGV4KTsKICB9CiAgZGV0YWNoKGluZGV4KSB7CiAgICB0aGlzLm5lZWRzSW5kZXhVcGRhdGUgfHw9IGluZGV4ICE9PSB0aGlzLmxlbmd0aCAtIDE7CiAgICBtYXliZUluaXREZXRhY2hBbmltYXRpb25MaXN0KHRoaXMubENvbnRhaW5lciwgaW5kZXgpOwogICAgcmV0dXJuIGRldGFjaEV4aXN0aW5nVmlldyh0aGlzLmxDb250YWluZXIsIGluZGV4KTsKICB9CiAgY3JlYXRlKGluZGV4LCB2YWx1ZSkgewogICAgY29uc3QgZGVoeWRyYXRlZFZpZXcgPSBmaW5kTWF0Y2hpbmdEZWh5ZHJhdGVkVmlldyh0aGlzLmxDb250YWluZXIsIHRoaXMudGVtcGxhdGVUTm9kZS50Vmlldy5zc3JJZCk7CiAgICBjb25zdCBlbWJlZGRlZExWaWV3ID0gY3JlYXRlQW5kUmVuZGVyRW1iZWRkZWRMVmlldyh0aGlzLmhvc3RMVmlldywgdGhpcy50ZW1wbGF0ZVROb2RlLCBuZXcgUmVwZWF0ZXJDb250ZXh0KHRoaXMubENvbnRhaW5lciwgdmFsdWUsIGluZGV4KSwgewogICAgICBkZWh5ZHJhdGVkVmlldwogICAgfSk7CiAgICBuZ0Rldk1vZGUgJiYgdGhpcy5vcGVyYXRpb25zQ291bnRlcj8ucmVjb3JkQ3JlYXRlKCk7CiAgICByZXR1cm4gZW1iZWRkZWRMVmlldzsKICB9CiAgZGVzdHJveShsVmlldykgewogICAgZGVzdHJveUxWaWV3KGxWaWV3W1RWSUVXXSwgbFZpZXcpOwogICAgbmdEZXZNb2RlICYmIHRoaXMub3BlcmF0aW9uc0NvdW50ZXI/LnJlY29yZERlc3Ryb3koKTsKICB9CiAgdXBkYXRlVmFsdWUoaW5kZXgsIHZhbHVlKSB7CiAgICB0aGlzLmdldExWaWV3KGluZGV4KVtDT05URVhUXS4kaW1wbGljaXQgPSB2YWx1ZTsKICB9CiAgcmVzZXQoKSB7CiAgICB0aGlzLm5lZWRzSW5kZXhVcGRhdGUgPSBmYWxzZTsKICAgIG5nRGV2TW9kZSAmJiB0aGlzLm9wZXJhdGlvbnNDb3VudGVyPy5yZXNldCgpOwogIH0KICB1cGRhdGVJbmRleGVzKCkgewogICAgaWYgKHRoaXMubmVlZHNJbmRleFVwZGF0ZSkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLmdldExWaWV3KGkpW0NPTlRFWFRdLiRpbmRleCA9IGk7CiAgICAgIH0KICAgIH0KICB9CiAgZ2V0TFZpZXcoaW5kZXgpIHsKICAgIHJldHVybiBnZXRFeGlzdGluZ0xWaWV3RnJvbUxDb250YWluZXIodGhpcy5sQ29udGFpbmVyLCBpbmRleCk7CiAgfQp9OwpmdW5jdGlvbiDJtcm1cmVwZWF0ZXIoY29sbGVjdGlvbikgewogIGNvbnN0IHByZXZDb25zdW1lciA9IHNldEFjdGl2ZUNvbnN1bWVyKG51bGwpOwogIGNvbnN0IG1ldGFkYXRhU2xvdElkeCA9IGdldFNlbGVjdGVkSW5kZXgoKTsKICB0cnkgewogICAgY29uc3QgaG9zdExWaWV3ID0gZ2V0TFZpZXcoKTsKICAgIGNvbnN0IGhvc3RUVmlldyA9IGhvc3RMVmlld1tUVklFV107CiAgICBjb25zdCBtZXRhZGF0YSA9IGhvc3RMVmlld1ttZXRhZGF0YVNsb3RJZHhdOwogICAgY29uc3QgY29udGFpbmVySW5kZXggPSBtZXRhZGF0YVNsb3RJZHggKyAxOwogICAgY29uc3QgbENvbnRhaW5lciA9IGdldExDb250YWluZXIoaG9zdExWaWV3LCBjb250YWluZXJJbmRleCk7CiAgICBpZiAobWV0YWRhdGEubGl2ZUNvbGxlY3Rpb24gPT09IHZvaWQgMCkgewogICAgICBjb25zdCBpdGVtVGVtcGxhdGVUTm9kZSA9IGdldEV4aXN0aW5nVE5vZGUoaG9zdFRWaWV3LCBjb250YWluZXJJbmRleCk7CiAgICAgIG1ldGFkYXRhLmxpdmVDb2xsZWN0aW9uID0gbmV3IExpdmVDb2xsZWN0aW9uTENvbnRhaW5lckltcGwobENvbnRhaW5lciwgaG9zdExWaWV3LCBpdGVtVGVtcGxhdGVUTm9kZSk7CiAgICB9IGVsc2UgewogICAgICBtZXRhZGF0YS5saXZlQ29sbGVjdGlvbi5yZXNldCgpOwogICAgfQogICAgY29uc3QgbGl2ZUNvbGxlY3Rpb24gPSBtZXRhZGF0YS5saXZlQ29sbGVjdGlvbjsKICAgIHJlY29uY2lsZShsaXZlQ29sbGVjdGlvbiwgY29sbGVjdGlvbiwgbWV0YWRhdGEudHJhY2tCeUZuLCBwcmV2Q29uc3VtZXIpOwogICAgaWYgKG5nRGV2TW9kZSAmJiBtZXRhZGF0YS50cmFja0J5Rm4gPT09IMm1ybVyZXBlYXRlclRyYWNrQnlJZGVudGl0eSAmJiBsaXZlQ29sbGVjdGlvbi5vcGVyYXRpb25zQ291bnRlcj8ud2FzUmVDcmVhdGVkKGxpdmVDb2xsZWN0aW9uLmxlbmd0aCkgJiYgaXNWaWV3RXhwZW5zaXZlVG9SZWNyZWF0ZShnZXRFeGlzdGluZ0xWaWV3RnJvbUxDb250YWluZXIobENvbnRhaW5lciwgMCkpKSB7CiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBmb3JtYXRSdW50aW1lRXJyb3IoLTk1NiwgYFRoZSBjb25maWd1cmVkIHRyYWNraW5nIGV4cHJlc3Npb24gKHRyYWNrIGJ5IGlkZW50aXR5KSBjYXVzZWQgcmUtY3JlYXRpb24gb2YgdGhlIGVudGlyZSBjb2xsZWN0aW9uIG9mIHNpemUgJHtsaXZlQ29sbGVjdGlvbi5sZW5ndGh9LiBUaGlzIGlzIGFuIGV4cGVuc2l2ZSBvcGVyYXRpb24gcmVxdWlyaW5nIGRlc3RydWN0aW9uIGFuZCBzdWJzZXF1ZW50IGNyZWF0aW9uIG9mIERPTSBub2RlcywgZGlyZWN0aXZlcywgY29tcG9uZW50cyBldGMuIFBsZWFzZSByZXZpZXcgdGhlICJ0cmFjayBleHByZXNzaW9uIiBhbmQgbWFrZSBzdXJlIHRoYXQgaXQgdW5pcXVlbHkgaWRlbnRpZmllcyBpdGVtcyBpbiBhIGNvbGxlY3Rpb24uYCk7CiAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTsKICAgIH0KICAgIGxpdmVDb2xsZWN0aW9uLnVwZGF0ZUluZGV4ZXMoKTsKICAgIGlmIChtZXRhZGF0YS5oYXNFbXB0eUJsb2NrKSB7CiAgICAgIGNvbnN0IGJpbmRpbmdJbmRleCA9IG5leHRCaW5kaW5nSW5kZXgoKTsKICAgICAgY29uc3QgaXNDb2xsZWN0aW9uRW1wdHkgPSBsaXZlQ29sbGVjdGlvbi5sZW5ndGggPT09IDA7CiAgICAgIGlmIChiaW5kaW5nVXBkYXRlZChob3N0TFZpZXcsIGJpbmRpbmdJbmRleCwgaXNDb2xsZWN0aW9uRW1wdHkpKSB7CiAgICAgICAgY29uc3QgZW1wdHlUZW1wbGF0ZUluZGV4ID0gbWV0YWRhdGFTbG90SWR4ICsgMjsKICAgICAgICBjb25zdCBsQ29udGFpbmVyRm9yRW1wdHkgPSBnZXRMQ29udGFpbmVyKGhvc3RMVmlldywgZW1wdHlUZW1wbGF0ZUluZGV4KTsKICAgICAgICBpZiAoaXNDb2xsZWN0aW9uRW1wdHkpIHsKICAgICAgICAgIGNvbnN0IGVtcHR5VGVtcGxhdGVUTm9kZSA9IGdldEV4aXN0aW5nVE5vZGUoaG9zdFRWaWV3LCBlbXB0eVRlbXBsYXRlSW5kZXgpOwogICAgICAgICAgY29uc3QgZGVoeWRyYXRlZFZpZXcgPSBmaW5kQW5kUmVjb25jaWxlTWF0Y2hpbmdEZWh5ZHJhdGVkVmlld3MobENvbnRhaW5lckZvckVtcHR5LCBlbXB0eVRlbXBsYXRlVE5vZGUsIGhvc3RMVmlldyk7CiAgICAgICAgICBjb25zdCBlbWJlZGRlZExWaWV3ID0gY3JlYXRlQW5kUmVuZGVyRW1iZWRkZWRMVmlldyhob3N0TFZpZXcsIGVtcHR5VGVtcGxhdGVUTm9kZSwgdm9pZCAwLCB7CiAgICAgICAgICAgIGRlaHlkcmF0ZWRWaWV3CiAgICAgICAgICB9KTsKICAgICAgICAgIGFkZExWaWV3VG9MQ29udGFpbmVyKGxDb250YWluZXJGb3JFbXB0eSwgZW1iZWRkZWRMVmlldywgMCwgc2hvdWxkQWRkVmlld1RvRG9tKGVtcHR5VGVtcGxhdGVUTm9kZSwgZGVoeWRyYXRlZFZpZXcpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGhvc3RUVmlldy5maXJzdFVwZGF0ZVBhc3MpIHsKICAgICAgICAgICAgcmVtb3ZlRGVoeWRyYXRlZFZpZXdzKGxDb250YWluZXJGb3JFbXB0eSk7CiAgICAgICAgICB9CiAgICAgICAgICByZW1vdmVMVmlld0Zyb21MQ29udGFpbmVyKGxDb250YWluZXJGb3JFbXB0eSwgMCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSBmaW5hbGx5IHsKICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZDb25zdW1lcik7CiAgfQp9CmZ1bmN0aW9uIGdldExDb250YWluZXIobFZpZXcsIGluZGV4KSB7CiAgY29uc3QgbENvbnRhaW5lciA9IGxWaWV3W2luZGV4XTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TENvbnRhaW5lcihsQ29udGFpbmVyKTsKICByZXR1cm4gbENvbnRhaW5lcjsKfQpmdW5jdGlvbiBjbGVhckRldGFjaEFuaW1hdGlvbkxpc3QobENvbnRhaW5lciwgaW5kZXgpIHsKICBpZiAobENvbnRhaW5lci5sZW5ndGggPD0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQpIHJldHVybjsKICBjb25zdCBpbmRleEluQ29udGFpbmVyID0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQgKyBpbmRleDsKICBjb25zdCB2aWV3VG9EZXRhY2ggPSBsQ29udGFpbmVyW2luZGV4SW5Db250YWluZXJdOwogIGNvbnN0IGFuaW1hdGlvbnMgPSB2aWV3VG9EZXRhY2ggPyB2aWV3VG9EZXRhY2hbQU5JTUFUSU9OU10gOiB2b2lkIDA7CiAgaWYgKHZpZXdUb0RldGFjaCAmJiBhbmltYXRpb25zICYmIGFuaW1hdGlvbnMuZGV0YWNoZWRMZWF2ZUFuaW1hdGlvbkZucyAmJiBhbmltYXRpb25zLmRldGFjaGVkTGVhdmVBbmltYXRpb25GbnMubGVuZ3RoID4gMCkgewogICAgY29uc3QgaW5qZWN0b3IgPSB2aWV3VG9EZXRhY2hbSU5KRUNUT1JdOwogICAgcmVtb3ZlRnJvbUFuaW1hdGlvblF1ZXVlKGluamVjdG9yLCBhbmltYXRpb25zKTsKICAgIGFsbExlYXZpbmdBbmltYXRpb25zLmRlbGV0ZSh2aWV3VG9EZXRhY2hbSURdKTsKICAgIGFuaW1hdGlvbnMuZGV0YWNoZWRMZWF2ZUFuaW1hdGlvbkZucyA9IHZvaWQgMDsKICB9Cn0KZnVuY3Rpb24gbWF5YmVJbml0RGV0YWNoQW5pbWF0aW9uTGlzdChsQ29udGFpbmVyLCBpbmRleCkgewogIGlmIChsQ29udGFpbmVyLmxlbmd0aCA8PSBDT05UQUlORVJfSEVBREVSX09GRlNFVCkgcmV0dXJuOwogIGNvbnN0IGluZGV4SW5Db250YWluZXIgPSBDT05UQUlORVJfSEVBREVSX09GRlNFVCArIGluZGV4OwogIGNvbnN0IHZpZXdUb0RldGFjaCA9IGxDb250YWluZXJbaW5kZXhJbkNvbnRhaW5lcl07CiAgY29uc3QgYW5pbWF0aW9ucyA9IHZpZXdUb0RldGFjaCA/IHZpZXdUb0RldGFjaFtBTklNQVRJT05TXSA6IHZvaWQgMDsKICBpZiAoYW5pbWF0aW9ucyAmJiBhbmltYXRpb25zLmxlYXZlICYmIGFuaW1hdGlvbnMubGVhdmUuc2l6ZSA+IDApIHsKICAgIGFuaW1hdGlvbnMuZGV0YWNoZWRMZWF2ZUFuaW1hdGlvbkZucyA9IFtdOwogIH0KfQpmdW5jdGlvbiBkZXRhY2hFeGlzdGluZ1ZpZXcobENvbnRhaW5lciwgaW5kZXgpIHsKICBjb25zdCBleGlzdGluZ0xWaWV3ID0gZGV0YWNoVmlldyhsQ29udGFpbmVyLCBpbmRleCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydExWaWV3KGV4aXN0aW5nTFZpZXcpOwogIHJldHVybiBleGlzdGluZ0xWaWV3Owp9CmZ1bmN0aW9uIGdldEV4aXN0aW5nTFZpZXdGcm9tTENvbnRhaW5lcihsQ29udGFpbmVyLCBpbmRleCkgewogIGNvbnN0IGV4aXN0aW5nTFZpZXcgPSBnZXRMVmlld0Zyb21MQ29udGFpbmVyKGxDb250YWluZXIsIGluZGV4KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TFZpZXcoZXhpc3RpbmdMVmlldyk7CiAgcmV0dXJuIGV4aXN0aW5nTFZpZXc7Cn0KZnVuY3Rpb24gZ2V0RXhpc3RpbmdUTm9kZSh0VmlldywgaW5kZXgpIHsKICBjb25zdCB0Tm9kZSA9IGdldFROb2RlKHRWaWV3LCBpbmRleCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlKHROb2RlKTsKICByZXR1cm4gdE5vZGU7Cn0KZnVuY3Rpb24gybXJtXByb3BlcnR5KHByb3BOYW1lLCB2YWx1ZSwgc2FuaXRpemVyKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGJpbmRpbmdJbmRleCA9IG5leHRCaW5kaW5nSW5kZXgoKTsKICBpZiAoYmluZGluZ1VwZGF0ZWQobFZpZXcsIGJpbmRpbmdJbmRleCwgdmFsdWUpKSB7CiAgICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgICBjb25zdCB0Tm9kZSA9IGdldFNlbGVjdGVkVE5vZGUoKTsKICAgIHNldFByb3BlcnR5QW5kSW5wdXRzKHROb2RlLCBsVmlldywgcHJvcE5hbWUsIHZhbHVlLCBsVmlld1tSRU5ERVJFUl0sIHNhbml0aXplcik7CiAgICBuZ0Rldk1vZGUgJiYgc3RvcmVQcm9wZXJ0eUJpbmRpbmdNZXRhZGF0YSh0Vmlldy5kYXRhLCB0Tm9kZSwgcHJvcE5hbWUsIGJpbmRpbmdJbmRleCk7CiAgfQogIHJldHVybiDJtcm1cHJvcGVydHk7Cn0KZnVuY3Rpb24gc2V0RGlyZWN0aXZlSW5wdXRzV2hpY2hTaGFkb3dzU3R5bGluZyh0VmlldywgdE5vZGUsIGxWaWV3LCB2YWx1ZSwgaXNDbGFzc0Jhc2VkKSB7CiAgc2V0QWxsSW5wdXRzRm9yUHJvcGVydHkodE5vZGUsIHRWaWV3LCBsVmlldywgaXNDbGFzc0Jhc2VkID8gImNsYXNzIiA6ICJzdHlsZSIsIHZhbHVlKTsKfQpmdW5jdGlvbiDJtcm1ZWxlbWVudFN0YXJ0KGluZGV4LCBuYW1lLCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVDcmVhdGlvbkluZGV4KGxWaWV3LCBpbmRleCk7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgYWRqdXN0ZWRJbmRleCA9IGluZGV4ICsgSEVBREVSX09GRlNFVDsKICBjb25zdCB0Tm9kZSA9IHRWaWV3LmZpcnN0Q3JlYXRlUGFzcyA/IGRpcmVjdGl2ZUhvc3RGaXJzdENyZWF0ZVBhc3MoYWRqdXN0ZWRJbmRleCwgbFZpZXcsIDIsIG5hbWUsIGZpbmREaXJlY3RpdmVEZWZNYXRjaGVzLCBnZXRCaW5kaW5nc0VuYWJsZWQoKSwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIDogdFZpZXcuZGF0YVthZGp1c3RlZEluZGV4XTsKICBlbGVtZW50TGlrZVN0YXJ0U2hhcmVkKHROb2RlLCBsVmlldywgaW5kZXgsIG5hbWUsIF9sb2NhdGVPckNyZWF0ZUVsZW1lbnROb2RlKTsKICBpZiAoaXNEaXJlY3RpdmVIb3N0KHROb2RlKSkgewogICAgY29uc3QgdFZpZXcyID0gbFZpZXdbVFZJRVddOwogICAgY3JlYXRlRGlyZWN0aXZlc0luc3RhbmNlcyh0VmlldzIsIGxWaWV3LCB0Tm9kZSk7CiAgICBleGVjdXRlQ29udGVudFF1ZXJpZXModFZpZXcyLCB0Tm9kZSwgbFZpZXcpOwogIH0KICBpZiAobG9jYWxSZWZzSW5kZXggIT0gbnVsbCkgewogICAgc2F2ZVJlc29sdmVkTG9jYWxzSW5EYXRhKGxWaWV3LCB0Tm9kZSk7CiAgfQogIGlmIChuZ0Rldk1vZGUgJiYgbFZpZXdbVFZJRVddLmZpcnN0Q3JlYXRlUGFzcykgewogICAgdmFsaWRhdGVFbGVtZW50SXNLbm93bihsVmlldywgdE5vZGUpOwogIH0KICByZXR1cm4gybXJtWVsZW1lbnRTdGFydDsKfQpmdW5jdGlvbiDJtcm1ZWxlbWVudEVuZCgpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgaW5pdGlhbFROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoaW5pdGlhbFROb2RlLCAiTm8gcGFyZW50IG5vZGUgdG8gY2xvc2UuIik7CiAgY29uc3QgY3VycmVudFROb2RlID0gZWxlbWVudExpa2VFbmRTaGFyZWQoaW5pdGlhbFROb2RlKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVUeXBlKGN1cnJlbnRUTm9kZSwgMyk7CiAgaWYgKHRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgZGlyZWN0aXZlSG9zdEVuZEZpcnN0Q3JlYXRlUGFzcyh0VmlldywgY3VycmVudFROb2RlKTsKICB9CiAgaWYgKGlzU2tpcEh5ZHJhdGlvblJvb3RUTm9kZShjdXJyZW50VE5vZGUpKSB7CiAgICBsZWF2ZVNraXBIeWRyYXRpb25CbG9jaygpOwogIH0KICBkZWNyZWFzZUVsZW1lbnREZXB0aENvdW50KCk7CiAgaWYgKGN1cnJlbnRUTm9kZS5jbGFzc2VzV2l0aG91dEhvc3QgIT0gbnVsbCAmJiBoYXNDbGFzc0lucHV0KGN1cnJlbnRUTm9kZSkpIHsKICAgIHNldERpcmVjdGl2ZUlucHV0c1doaWNoU2hhZG93c1N0eWxpbmcodFZpZXcsIGN1cnJlbnRUTm9kZSwgZ2V0TFZpZXcoKSwgY3VycmVudFROb2RlLmNsYXNzZXNXaXRob3V0SG9zdCwgdHJ1ZSk7CiAgfQogIGlmIChjdXJyZW50VE5vZGUuc3R5bGVzV2l0aG91dEhvc3QgIT0gbnVsbCAmJiBoYXNTdHlsZUlucHV0KGN1cnJlbnRUTm9kZSkpIHsKICAgIHNldERpcmVjdGl2ZUlucHV0c1doaWNoU2hhZG93c1N0eWxpbmcodFZpZXcsIGN1cnJlbnRUTm9kZSwgZ2V0TFZpZXcoKSwgY3VycmVudFROb2RlLnN0eWxlc1dpdGhvdXRIb3N0LCBmYWxzZSk7CiAgfQogIHJldHVybiDJtcm1ZWxlbWVudEVuZDsKfQpmdW5jdGlvbiDJtcm1ZWxlbWVudChpbmRleCwgbmFtZSwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIHsKICDJtcm1ZWxlbWVudFN0YXJ0KGluZGV4LCBuYW1lLCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCk7CiAgybXJtWVsZW1lbnRFbmQoKTsKICByZXR1cm4gybXJtWVsZW1lbnQ7Cn0KZnVuY3Rpb24gybXJtWRvbUVsZW1lbnRTdGFydChpbmRleCwgbmFtZSwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlQ3JlYXRpb25JbmRleChsVmlldywgaW5kZXgpOwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBpbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgY29uc3QgdE5vZGUgPSB0Vmlldy5maXJzdENyZWF0ZVBhc3MgPyBkb21Pbmx5Rmlyc3RDcmVhdGVQYXNzKGFkanVzdGVkSW5kZXgsIHRWaWV3LCAyLCBuYW1lLCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCkgOiB0Vmlldy5kYXRhW2FkanVzdGVkSW5kZXhdOwogIGVsZW1lbnRMaWtlU3RhcnRTaGFyZWQodE5vZGUsIGxWaWV3LCBpbmRleCwgbmFtZSwgX2xvY2F0ZU9yQ3JlYXRlRWxlbWVudE5vZGUpOwogIGlmIChsb2NhbFJlZnNJbmRleCAhPSBudWxsKSB7CiAgICBzYXZlUmVzb2x2ZWRMb2NhbHNJbkRhdGEobFZpZXcsIHROb2RlKTsKICB9CiAgaWYgKG5nRGV2TW9kZSAmJiBsVmlld1tUVklFV10uZmlyc3RDcmVhdGVQYXNzKSB7CiAgICB2YWxpZGF0ZUVsZW1lbnRJc0tub3duKGxWaWV3LCB0Tm9kZSk7CiAgfQogIHJldHVybiDJtcm1ZG9tRWxlbWVudFN0YXJ0Owp9CmZ1bmN0aW9uIMm1ybVkb21FbGVtZW50RW5kKCkgewogIGNvbnN0IGluaXRpYWxUTm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGluaXRpYWxUTm9kZSwgIk5vIHBhcmVudCBub2RlIHRvIGNsb3NlLiIpOwogIGNvbnN0IGN1cnJlbnRUTm9kZSA9IGVsZW1lbnRMaWtlRW5kU2hhcmVkKGluaXRpYWxUTm9kZSk7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZShjdXJyZW50VE5vZGUsIDMpOwogIGlmIChpc1NraXBIeWRyYXRpb25Sb290VE5vZGUoY3VycmVudFROb2RlKSkgewogICAgbGVhdmVTa2lwSHlkcmF0aW9uQmxvY2soKTsKICB9CiAgZGVjcmVhc2VFbGVtZW50RGVwdGhDb3VudCgpOwogIHJldHVybiDJtcm1ZG9tRWxlbWVudEVuZDsKfQpmdW5jdGlvbiDJtcm1ZG9tRWxlbWVudChpbmRleCwgbmFtZSwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIHsKICDJtcm1ZG9tRWxlbWVudFN0YXJ0KGluZGV4LCBuYW1lLCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCk7CiAgybXJtWRvbUVsZW1lbnRFbmQoKTsKICByZXR1cm4gybXJtWRvbUVsZW1lbnQ7Cn0KdmFyIF9sb2NhdGVPckNyZWF0ZUVsZW1lbnROb2RlID0gKHRWaWV3LCBsVmlldywgdE5vZGUsIG5hbWUsIGluZGV4KSA9PiB7CiAgbGFzdE5vZGVXYXNDcmVhdGVkKHRydWUpOwogIHJldHVybiBjcmVhdGVFbGVtZW50Tm9kZShsVmlld1tSRU5ERVJFUl0sIG5hbWUsIGdldE5hbWVzcGFjZSgpKTsKfTsKZnVuY3Rpb24gbG9jYXRlT3JDcmVhdGVFbGVtZW50Tm9kZUltcGwodFZpZXcsIGxWaWV3LCB0Tm9kZSwgbmFtZSwgaW5kZXgpIHsKICBjb25zdCBpc05vZGVDcmVhdGlvbk1vZGUgPSAhY2FuSHlkcmF0ZU5vZGUobFZpZXcsIHROb2RlKTsKICBsYXN0Tm9kZVdhc0NyZWF0ZWQoaXNOb2RlQ3JlYXRpb25Nb2RlKTsKICBpZiAoaXNOb2RlQ3JlYXRpb25Nb2RlKSB7CiAgICByZXR1cm4gY3JlYXRlRWxlbWVudE5vZGUobFZpZXdbUkVOREVSRVJdLCBuYW1lLCBnZXROYW1lc3BhY2UoKSk7CiAgfQogIGNvbnN0IGh5ZHJhdGlvbkluZm8gPSBsVmlld1tIWURSQVRJT05dOwogIGNvbnN0IG5hdGl2ZSA9IGxvY2F0ZU5leHRSTm9kZShoeWRyYXRpb25JbmZvLCB0VmlldywgbFZpZXcsIHROb2RlKTsKICBuZ0Rldk1vZGUgJiYgdmFsaWRhdGVNYXRjaGluZ05vZGUobmF0aXZlLCBOb2RlLkVMRU1FTlRfTk9ERSwgbmFtZSwgbFZpZXcsIHROb2RlKTsKICBuZ0Rldk1vZGUgJiYgbWFya1JOb2RlQXNDbGFpbWVkQnlIeWRyYXRpb24obmF0aXZlKTsKICBpZiAoZ2V0U2VyaWFsaXplZENvbnRhaW5lclZpZXdzKGh5ZHJhdGlvbkluZm8sIGluZGV4KSkgewogICAgbmdEZXZNb2RlICYmIHZhbGlkYXRlTm9kZUV4aXN0cyhuYXRpdmUubmV4dFNpYmxpbmcsIGxWaWV3LCB0Tm9kZSk7CiAgICBzZXRTZWdtZW50SGVhZChoeWRyYXRpb25JbmZvLCBpbmRleCwgbmF0aXZlLm5leHRTaWJsaW5nKTsKICB9CiAgaWYgKGh5ZHJhdGlvbkluZm8gJiYgKGhhc1NraXBIeWRyYXRpb25BdHRyT25UTm9kZSh0Tm9kZSkgfHwgaGFzU2tpcEh5ZHJhdGlvbkF0dHJPblJFbGVtZW50KG5hdGl2ZSkpKSB7CiAgICBpZiAoaXNDb21wb25lbnRIb3N0KHROb2RlKSkgewogICAgICBlbnRlclNraXBIeWRyYXRpb25CbG9jayh0Tm9kZSk7CiAgICAgIGNsZWFyRWxlbWVudENvbnRlbnRzKG5hdGl2ZSk7CiAgICAgIG5nRGV2TW9kZSAmJiBtYXJrUk5vZGVBc1NraXBwZWRCeUh5ZHJhdGlvbihuYXRpdmUpOwogICAgfSBlbHNlIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgdGhyb3cgaW52YWxpZFNraXBIeWRyYXRpb25Ib3N0KG5hdGl2ZSk7CiAgICB9CiAgfQogIHJldHVybiBuYXRpdmU7Cn0KZnVuY3Rpb24gZW5hYmxlTG9jYXRlT3JDcmVhdGVFbGVtZW50Tm9kZUltcGwoKSB7CiAgX2xvY2F0ZU9yQ3JlYXRlRWxlbWVudE5vZGUgPSBsb2NhdGVPckNyZWF0ZUVsZW1lbnROb2RlSW1wbDsKfQpmdW5jdGlvbiDJtcm1ZWxlbWVudENvbnRhaW5lclN0YXJ0KGluZGV4LCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVDcmVhdGlvbkluZGV4KGxWaWV3LCBpbmRleCk7CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgYWRqdXN0ZWRJbmRleCA9IGluZGV4ICsgSEVBREVSX09GRlNFVDsKICBjb25zdCB0Tm9kZSA9IHRWaWV3LmZpcnN0Q3JlYXRlUGFzcyA/IGRpcmVjdGl2ZUhvc3RGaXJzdENyZWF0ZVBhc3MoYWRqdXN0ZWRJbmRleCwgbFZpZXcsIDgsICJuZy1jb250YWluZXIiLCBmaW5kRGlyZWN0aXZlRGVmTWF0Y2hlcywgZ2V0QmluZGluZ3NFbmFibGVkKCksIGF0dHJzSW5kZXgsIGxvY2FsUmVmc0luZGV4KSA6IHRWaWV3LmRhdGFbYWRqdXN0ZWRJbmRleF07CiAgZWxlbWVudExpa2VTdGFydFNoYXJlZCh0Tm9kZSwgbFZpZXcsIGluZGV4LCAibmctY29udGFpbmVyIiwgX2xvY2F0ZU9yQ3JlYXRlRWxlbWVudENvbnRhaW5lck5vZGUpOwogIGlmIChpc0RpcmVjdGl2ZUhvc3QodE5vZGUpKSB7CiAgICBjb25zdCB0VmlldzIgPSBsVmlld1tUVklFV107CiAgICBjcmVhdGVEaXJlY3RpdmVzSW5zdGFuY2VzKHRWaWV3MiwgbFZpZXcsIHROb2RlKTsKICAgIGV4ZWN1dGVDb250ZW50UXVlcmllcyh0VmlldzIsIHROb2RlLCBsVmlldyk7CiAgfQogIGlmIChsb2NhbFJlZnNJbmRleCAhPSBudWxsKSB7CiAgICBzYXZlUmVzb2x2ZWRMb2NhbHNJbkRhdGEobFZpZXcsIHROb2RlKTsKICB9CiAgcmV0dXJuIMm1ybVlbGVtZW50Q29udGFpbmVyU3RhcnQ7Cn0KZnVuY3Rpb24gybXJtWVsZW1lbnRDb250YWluZXJFbmQoKSB7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IGluaXRpYWxUTm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKGluaXRpYWxUTm9kZSwgIk5vIHBhcmVudCBub2RlIHRvIGNsb3NlLiIpOwogIGNvbnN0IGN1cnJlbnRUTm9kZSA9IGVsZW1lbnRMaWtlRW5kU2hhcmVkKGluaXRpYWxUTm9kZSk7CiAgaWYgKHRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgZGlyZWN0aXZlSG9zdEVuZEZpcnN0Q3JlYXRlUGFzcyh0VmlldywgY3VycmVudFROb2RlKTsKICB9CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZShjdXJyZW50VE5vZGUsIDgpOwogIHJldHVybiDJtcm1ZWxlbWVudENvbnRhaW5lckVuZDsKfQpmdW5jdGlvbiDJtcm1ZWxlbWVudENvbnRhaW5lcihpbmRleCwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIHsKICDJtcm1ZWxlbWVudENvbnRhaW5lclN0YXJ0KGluZGV4LCBhdHRyc0luZGV4LCBsb2NhbFJlZnNJbmRleCk7CiAgybXJtWVsZW1lbnRDb250YWluZXJFbmQoKTsKICByZXR1cm4gybXJtWVsZW1lbnRDb250YWluZXI7Cn0KZnVuY3Rpb24gybXJtWRvbUVsZW1lbnRDb250YWluZXJTdGFydChpbmRleCwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlQ3JlYXRpb25JbmRleChsVmlldywgaW5kZXgpOwogIGNvbnN0IHRWaWV3ID0gbFZpZXdbVFZJRVddOwogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBpbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgY29uc3QgdE5vZGUgPSB0Vmlldy5maXJzdENyZWF0ZVBhc3MgPyBkb21Pbmx5Rmlyc3RDcmVhdGVQYXNzKGFkanVzdGVkSW5kZXgsIHRWaWV3LCA4LCAibmctY29udGFpbmVyIiwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpIDogdFZpZXcuZGF0YVthZGp1c3RlZEluZGV4XTsKICBlbGVtZW50TGlrZVN0YXJ0U2hhcmVkKHROb2RlLCBsVmlldywgaW5kZXgsICJuZy1jb250YWluZXIiLCBfbG9jYXRlT3JDcmVhdGVFbGVtZW50Q29udGFpbmVyTm9kZSk7CiAgaWYgKGxvY2FsUmVmc0luZGV4ICE9IG51bGwpIHsKICAgIHNhdmVSZXNvbHZlZExvY2Fsc0luRGF0YShsVmlldywgdE5vZGUpOwogIH0KICByZXR1cm4gybXJtWRvbUVsZW1lbnRDb250YWluZXJTdGFydDsKfQpmdW5jdGlvbiDJtcm1ZG9tRWxlbWVudENvbnRhaW5lckVuZCgpIHsKICBjb25zdCBpbml0aWFsVE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChpbml0aWFsVE5vZGUsICJObyBwYXJlbnQgbm9kZSB0byBjbG9zZS4iKTsKICBjb25zdCBjdXJyZW50VE5vZGUgPSBlbGVtZW50TGlrZUVuZFNoYXJlZChpbml0aWFsVE5vZGUpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZVR5cGUoY3VycmVudFROb2RlLCA4KTsKICByZXR1cm4gybXJtWVsZW1lbnRDb250YWluZXJFbmQ7Cn0KZnVuY3Rpb24gybXJtWRvbUVsZW1lbnRDb250YWluZXIoaW5kZXgsIGF0dHJzSW5kZXgsIGxvY2FsUmVmc0luZGV4KSB7CiAgybXJtWRvbUVsZW1lbnRDb250YWluZXJTdGFydChpbmRleCwgYXR0cnNJbmRleCwgbG9jYWxSZWZzSW5kZXgpOwogIMm1ybVkb21FbGVtZW50Q29udGFpbmVyRW5kKCk7CiAgcmV0dXJuIMm1ybVkb21FbGVtZW50Q29udGFpbmVyOwp9CnZhciBfbG9jYXRlT3JDcmVhdGVFbGVtZW50Q29udGFpbmVyTm9kZSA9ICh0VmlldywgbFZpZXcsIHROb2RlLCBjb21tZW50VGV4dCwgaW5kZXgpID0+IHsKICBsYXN0Tm9kZVdhc0NyZWF0ZWQodHJ1ZSk7CiAgcmV0dXJuIGNyZWF0ZUNvbW1lbnROb2RlKGxWaWV3W1JFTkRFUkVSXSwgbmdEZXZNb2RlID8gY29tbWVudFRleHQgOiAiIik7Cn07CmZ1bmN0aW9uIGxvY2F0ZU9yQ3JlYXRlRWxlbWVudENvbnRhaW5lck5vZGUodFZpZXcsIGxWaWV3LCB0Tm9kZSwgY29tbWVudFRleHQsIGluZGV4KSB7CiAgbGV0IGNvbW1lbnQ7CiAgY29uc3QgaXNOb2RlQ3JlYXRpb25Nb2RlID0gIWNhbkh5ZHJhdGVOb2RlKGxWaWV3LCB0Tm9kZSk7CiAgbGFzdE5vZGVXYXNDcmVhdGVkKGlzTm9kZUNyZWF0aW9uTW9kZSk7CiAgaWYgKGlzTm9kZUNyZWF0aW9uTW9kZSkgewogICAgcmV0dXJuIGNyZWF0ZUNvbW1lbnROb2RlKGxWaWV3W1JFTkRFUkVSXSwgbmdEZXZNb2RlID8gY29tbWVudFRleHQgOiAiIik7CiAgfQogIGNvbnN0IGh5ZHJhdGlvbkluZm8gPSBsVmlld1tIWURSQVRJT05dOwogIGNvbnN0IGN1cnJlbnRSTm9kZSA9IGxvY2F0ZU5leHRSTm9kZShoeWRyYXRpb25JbmZvLCB0VmlldywgbFZpZXcsIHROb2RlKTsKICBuZ0Rldk1vZGUgJiYgdmFsaWRhdGVOb2RlRXhpc3RzKGN1cnJlbnRSTm9kZSwgbFZpZXcsIHROb2RlKTsKICBjb25zdCBuZ0NvbnRhaW5lclNpemUgPSBnZXROZ0NvbnRhaW5lclNpemUoaHlkcmF0aW9uSW5mbywgaW5kZXgpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIobmdDb250YWluZXJTaXplLCAiVW5leHBlY3RlZCBzdGF0ZTogaHlkcmF0aW5nIGFuIDxuZy1jb250YWluZXI+LCBidXQgbm8gaHlkcmF0aW9uIGluZm8gaXMgYXZhaWxhYmxlLiIpOwogIHNldFNlZ21lbnRIZWFkKGh5ZHJhdGlvbkluZm8sIGluZGV4LCBjdXJyZW50Uk5vZGUpOwogIGNvbW1lbnQgPSBzaWJsaW5nQWZ0ZXIobmdDb250YWluZXJTaXplLCBjdXJyZW50Uk5vZGUpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIHZhbGlkYXRlTWF0Y2hpbmdOb2RlKGNvbW1lbnQsIE5vZGUuQ09NTUVOVF9OT0RFLCBudWxsLCBsVmlldywgdE5vZGUpOwogICAgbWFya1JOb2RlQXNDbGFpbWVkQnlIeWRyYXRpb24oY29tbWVudCk7CiAgfQogIHJldHVybiBjb21tZW50Owp9CmZ1bmN0aW9uIGVuYWJsZUxvY2F0ZU9yQ3JlYXRlRWxlbWVudENvbnRhaW5lck5vZGVJbXBsKCkgewogIF9sb2NhdGVPckNyZWF0ZUVsZW1lbnRDb250YWluZXJOb2RlID0gbG9jYXRlT3JDcmVhdGVFbGVtZW50Q29udGFpbmVyTm9kZTsKfQpmdW5jdGlvbiDJtcm1Z2V0Q3VycmVudFZpZXcoKSB7CiAgcmV0dXJuIGdldExWaWV3KCk7Cn0KZnVuY3Rpb24gybXJtWRvbVByb3BlcnR5KHByb3BOYW1lLCB2YWx1ZSwgc2FuaXRpemVyKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGJpbmRpbmdJbmRleCA9IG5leHRCaW5kaW5nSW5kZXgoKTsKICBpZiAoYmluZGluZ1VwZGF0ZWQobFZpZXcsIGJpbmRpbmdJbmRleCwgdmFsdWUpKSB7CiAgICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgICBjb25zdCB0Tm9kZSA9IGdldFNlbGVjdGVkVE5vZGUoKTsKICAgIHNldERvbVByb3BlcnR5KHROb2RlLCBsVmlldywgcHJvcE5hbWUsIHZhbHVlLCBsVmlld1tSRU5ERVJFUl0sIHNhbml0aXplcik7CiAgICBuZ0Rldk1vZGUgJiYgc3RvcmVQcm9wZXJ0eUJpbmRpbmdNZXRhZGF0YSh0Vmlldy5kYXRhLCB0Tm9kZSwgcHJvcE5hbWUsIGJpbmRpbmdJbmRleCk7CiAgfQogIHJldHVybiDJtcm1ZG9tUHJvcGVydHk7Cn0KZnVuY3Rpb24gybXJtXN5bnRoZXRpY0hvc3RQcm9wZXJ0eShwcm9wTmFtZSwgdmFsdWUsIHNhbml0aXplcikgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBuZXh0QmluZGluZ0luZGV4KCk7CiAgaWYgKGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHZhbHVlKSkgewogICAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogICAgY29uc3QgdE5vZGUgPSBnZXRTZWxlY3RlZFROb2RlKCk7CiAgICBjb25zdCBjdXJyZW50RGVmID0gZ2V0Q3VycmVudERpcmVjdGl2ZURlZih0Vmlldy5kYXRhKTsKICAgIGNvbnN0IHJlbmRlcmVyID0gbG9hZENvbXBvbmVudFJlbmRlcmVyKGN1cnJlbnREZWYsIHROb2RlLCBsVmlldyk7CiAgICBzZXREb21Qcm9wZXJ0eSh0Tm9kZSwgbFZpZXcsIHByb3BOYW1lLCB2YWx1ZSwgcmVuZGVyZXIsIHNhbml0aXplcik7CiAgICBuZ0Rldk1vZGUgJiYgc3RvcmVQcm9wZXJ0eUJpbmRpbmdNZXRhZGF0YSh0Vmlldy5kYXRhLCB0Tm9kZSwgcHJvcE5hbWUsIGJpbmRpbmdJbmRleCk7CiAgfQogIHJldHVybiDJtcm1c3ludGhldGljSG9zdFByb3BlcnR5Owp9CnZhciB1ID0gdm9pZCAwOwpmdW5jdGlvbiBwbHVyYWwodmFsKSB7CiAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5hYnModmFsKSksIHYgPSB2YWwudG9TdHJpbmcoKS5yZXBsYWNlKC9eW14uXSpcLj8vLCAiIikubGVuZ3RoOwogIGlmIChpID09PSAxICYmIHYgPT09IDApIHJldHVybiAxOwogIHJldHVybiA1Owp9CnZhciBsb2NhbGVFbiA9IFsiZW4iLCBbWyJhIiwgInAiXSwgWyJBTSIsICJQTSJdXSwgW1siQU0iLCAiUE0iXV0sIFtbIlMiLCAiTSIsICJUIiwgIlciLCAiVCIsICJGIiwgIlMiXSwgWyJTdW4iLCAiTW9uIiwgIlR1ZSIsICJXZWQiLCAiVGh1IiwgIkZyaSIsICJTYXQiXSwgWyJTdW5kYXkiLCAiTW9uZGF5IiwgIlR1ZXNkYXkiLCAiV2VkbmVzZGF5IiwgIlRodXJzZGF5IiwgIkZyaWRheSIsICJTYXR1cmRheSJdLCBbIlN1IiwgIk1vIiwgIlR1IiwgIldlIiwgIlRoIiwgIkZyIiwgIlNhIl1dLCB1LCBbWyJKIiwgIkYiLCAiTSIsICJBIiwgIk0iLCAiSiIsICJKIiwgIkEiLCAiUyIsICJPIiwgIk4iLCAiRCJdLCBbIkphbiIsICJGZWIiLCAiTWFyIiwgIkFwciIsICJNYXkiLCAiSnVuIiwgIkp1bCIsICJBdWciLCAiU2VwIiwgIk9jdCIsICJOb3YiLCAiRGVjIl0sIFsiSmFudWFyeSIsICJGZWJydWFyeSIsICJNYXJjaCIsICJBcHJpbCIsICJNYXkiLCAiSnVuZSIsICJKdWx5IiwgIkF1Z3VzdCIsICJTZXB0ZW1iZXIiLCAiT2N0b2JlciIsICJOb3ZlbWJlciIsICJEZWNlbWJlciJdXSwgdSwgW1siQiIsICJBIl0sIFsiQkMiLCAiQUQiXSwgWyJCZWZvcmUgQ2hyaXN0IiwgIkFubm8gRG9taW5pIl1dLCAwLCBbNiwgMF0sIFsiTS9kL3l5IiwgIk1NTSBkLCB5IiwgIk1NTU0gZCwgeSIsICJFRUVFLCBNTU1NIGQsIHkiXSwgWyJoOm1t4oCvYSIsICJoOm1tOnNz4oCvYSIsICJoOm1tOnNz4oCvYSB6IiwgImg6bW06c3PigK9hIHp6enoiXSwgWyJ7MX0sIHswfSIsIHUsIHUsIHVdLCBbIi4iLCAiLCIsICI7IiwgIiUiLCAiKyIsICItIiwgIkUiLCAiw5ciLCAi4oCwIiwgIuKIniIsICJOYU4iLCAiOiJdLCBbIiMsIyMwLiMjIyIsICIjLCMjMCUiLCAiwqQjLCMjMC4wMCIsICIjRTAiXSwgIlVTRCIsICIkIiwgIlVTIERvbGxhciIsIHt9LCAibHRyIiwgcGx1cmFsXTsKdmFyIExPQ0FMRV9EQVRBID0ge307CmZ1bmN0aW9uIHJlZ2lzdGVyTG9jYWxlRGF0YShkYXRhLCBsb2NhbGVJZCwgZXh0cmFEYXRhKSB7CiAgaWYgKHR5cGVvZiBsb2NhbGVJZCAhPT0gInN0cmluZyIpIHsKICAgIGV4dHJhRGF0YSA9IGxvY2FsZUlkOwogICAgbG9jYWxlSWQgPSBkYXRhW0xvY2FsZURhdGFJbmRleC5Mb2NhbGVJZF07CiAgfQogIGxvY2FsZUlkID0gbG9jYWxlSWQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fL2csICItIik7CiAgTE9DQUxFX0RBVEFbbG9jYWxlSWRdID0gZGF0YTsKICBpZiAoZXh0cmFEYXRhKSB7CiAgICBMT0NBTEVfREFUQVtsb2NhbGVJZF1bTG9jYWxlRGF0YUluZGV4LkV4dHJhRGF0YV0gPSBleHRyYURhdGE7CiAgfQp9CmZ1bmN0aW9uIGZpbmRMb2NhbGVEYXRhKGxvY2FsZSkgewogIGNvbnN0IG5vcm1hbGl6ZWRMb2NhbGUgPSBub3JtYWxpemVMb2NhbGUobG9jYWxlKTsKICBsZXQgbWF0Y2ggPSBnZXRMb2NhbGVEYXRhKG5vcm1hbGl6ZWRMb2NhbGUpOwogIGlmIChtYXRjaCkgewogICAgcmV0dXJuIG1hdGNoOwogIH0KICBjb25zdCBwYXJlbnRMb2NhbGUgPSBub3JtYWxpemVkTG9jYWxlLnNwbGl0KCItIilbMF07CiAgbWF0Y2ggPSBnZXRMb2NhbGVEYXRhKHBhcmVudExvY2FsZSk7CiAgaWYgKG1hdGNoKSB7CiAgICByZXR1cm4gbWF0Y2g7CiAgfQogIGlmIChwYXJlbnRMb2NhbGUgPT09ICJlbiIpIHsKICAgIHJldHVybiBsb2NhbGVFbjsKICB9CiAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig3MDEsIG5nRGV2TW9kZSAmJiBgTWlzc2luZyBsb2NhbGUgZGF0YSBmb3IgdGhlIGxvY2FsZSAiJHtsb2NhbGV9Ii5gKTsKfQpmdW5jdGlvbiBnZXRMb2NhbGVDdXJyZW5jeUNvZGUobG9jYWxlKSB7CiAgY29uc3QgZGF0YSA9IGZpbmRMb2NhbGVEYXRhKGxvY2FsZSk7CiAgcmV0dXJuIGRhdGFbTG9jYWxlRGF0YUluZGV4LkN1cnJlbmN5Q29kZV0gfHwgbnVsbDsKfQpmdW5jdGlvbiBnZXRMb2NhbGVQbHVyYWxDYXNlKGxvY2FsZSkgewogIGNvbnN0IGRhdGEgPSBmaW5kTG9jYWxlRGF0YShsb2NhbGUpOwogIHJldHVybiBkYXRhW0xvY2FsZURhdGFJbmRleC5QbHVyYWxDYXNlXTsKfQpmdW5jdGlvbiBnZXRMb2NhbGVEYXRhKG5vcm1hbGl6ZWRMb2NhbGUpIHsKICBpZiAoIShub3JtYWxpemVkTG9jYWxlIGluIExPQ0FMRV9EQVRBKSkgewogICAgTE9DQUxFX0RBVEFbbm9ybWFsaXplZExvY2FsZV0gPSBfZ2xvYmFsLm5nICYmIF9nbG9iYWwubmcuY29tbW9uICYmIF9nbG9iYWwubmcuY29tbW9uLmxvY2FsZXMgJiYgX2dsb2JhbC5uZy5jb21tb24ubG9jYWxlc1tub3JtYWxpemVkTG9jYWxlXTsKICB9CiAgcmV0dXJuIExPQ0FMRV9EQVRBW25vcm1hbGl6ZWRMb2NhbGVdOwp9CmZ1bmN0aW9uIHVucmVnaXN0ZXJBbGxMb2NhbGVEYXRhKCkgewogIExPQ0FMRV9EQVRBID0ge307Cn0KdmFyIExvY2FsZURhdGFJbmRleDsKKGZ1bmN0aW9uKExvY2FsZURhdGFJbmRleDIpIHsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkxvY2FsZUlkIl0gPSAwXSA9ICJMb2NhbGVJZCI7CiAgTG9jYWxlRGF0YUluZGV4MltMb2NhbGVEYXRhSW5kZXgyWyJEYXlQZXJpb2RzRm9ybWF0Il0gPSAxXSA9ICJEYXlQZXJpb2RzRm9ybWF0IjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkRheVBlcmlvZHNTdGFuZGFsb25lIl0gPSAyXSA9ICJEYXlQZXJpb2RzU3RhbmRhbG9uZSI7CiAgTG9jYWxlRGF0YUluZGV4MltMb2NhbGVEYXRhSW5kZXgyWyJEYXlzRm9ybWF0Il0gPSAzXSA9ICJEYXlzRm9ybWF0IjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkRheXNTdGFuZGFsb25lIl0gPSA0XSA9ICJEYXlzU3RhbmRhbG9uZSI7CiAgTG9jYWxlRGF0YUluZGV4MltMb2NhbGVEYXRhSW5kZXgyWyJNb250aHNGb3JtYXQiXSA9IDVdID0gIk1vbnRoc0Zvcm1hdCI7CiAgTG9jYWxlRGF0YUluZGV4MltMb2NhbGVEYXRhSW5kZXgyWyJNb250aHNTdGFuZGFsb25lIl0gPSA2XSA9ICJNb250aHNTdGFuZGFsb25lIjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkVyYXMiXSA9IDddID0gIkVyYXMiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiRmlyc3REYXlPZldlZWsiXSA9IDhdID0gIkZpcnN0RGF5T2ZXZWVrIjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIldlZWtlbmRSYW5nZSJdID0gOV0gPSAiV2Vla2VuZFJhbmdlIjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkRhdGVGb3JtYXQiXSA9IDEwXSA9ICJEYXRlRm9ybWF0IjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIlRpbWVGb3JtYXQiXSA9IDExXSA9ICJUaW1lRm9ybWF0IjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkRhdGVUaW1lRm9ybWF0Il0gPSAxMl0gPSAiRGF0ZVRpbWVGb3JtYXQiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiTnVtYmVyU3ltYm9scyJdID0gMTNdID0gIk51bWJlclN5bWJvbHMiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiTnVtYmVyRm9ybWF0cyJdID0gMTRdID0gIk51bWJlckZvcm1hdHMiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiQ3VycmVuY3lDb2RlIl0gPSAxNV0gPSAiQ3VycmVuY3lDb2RlIjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkN1cnJlbmN5U3ltYm9sIl0gPSAxNl0gPSAiQ3VycmVuY3lTeW1ib2wiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiQ3VycmVuY3lOYW1lIl0gPSAxN10gPSAiQ3VycmVuY3lOYW1lIjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkN1cnJlbmNpZXMiXSA9IDE4XSA9ICJDdXJyZW5jaWVzIjsKICBMb2NhbGVEYXRhSW5kZXgyW0xvY2FsZURhdGFJbmRleDJbIkRpcmVjdGlvbmFsaXR5Il0gPSAxOV0gPSAiRGlyZWN0aW9uYWxpdHkiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiUGx1cmFsQ2FzZSJdID0gMjBdID0gIlBsdXJhbENhc2UiOwogIExvY2FsZURhdGFJbmRleDJbTG9jYWxlRGF0YUluZGV4MlsiRXh0cmFEYXRhIl0gPSAyMV0gPSAiRXh0cmFEYXRhIjsKfSkoTG9jYWxlRGF0YUluZGV4IHx8IChMb2NhbGVEYXRhSW5kZXggPSB7fSkpOwpmdW5jdGlvbiBub3JtYWxpemVMb2NhbGUobG9jYWxlKSB7CiAgcmV0dXJuIGxvY2FsZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywgIi0iKTsKfQp2YXIgcGx1cmFsTWFwcGluZyA9IFsiemVybyIsICJvbmUiLCAidHdvIiwgImZldyIsICJtYW55Il07CmZ1bmN0aW9uIGdldFBsdXJhbENhc2UodmFsdWUsIGxvY2FsZSkgewogIGNvbnN0IHBsdXJhbDIgPSBnZXRMb2NhbGVQbHVyYWxDYXNlKGxvY2FsZSkocGFyc2VJbnQodmFsdWUsIDEwKSk7CiAgY29uc3QgcmVzdWx0ID0gcGx1cmFsTWFwcGluZ1twbHVyYWwyXTsKICByZXR1cm4gcmVzdWx0ICE9PSB2b2lkIDAgPyByZXN1bHQgOiAib3RoZXIiOwp9CnZhciBERUZBVUxUX0xPQ0FMRV9JRCA9ICJlbi1VUyI7CnZhciBVU0RfQ1VSUkVOQ1lfQ09ERSA9ICJVU0QiOwp2YXIgRUxFTUVOVF9NQVJLRVIgPSB7CiAgbWFya2VyOiAiZWxlbWVudCIKfTsKdmFyIElDVV9NQVJLRVIgPSB7CiAgbWFya2VyOiAiSUNVIgp9Owp2YXIgSTE4bkNyZWF0ZU9wQ29kZTsKKGZ1bmN0aW9uKEkxOG5DcmVhdGVPcENvZGUyKSB7CiAgSTE4bkNyZWF0ZU9wQ29kZTJbSTE4bkNyZWF0ZU9wQ29kZTJbIlNISUZUIl0gPSAyXSA9ICJTSElGVCI7CiAgSTE4bkNyZWF0ZU9wQ29kZTJbSTE4bkNyZWF0ZU9wQ29kZTJbIkFQUEVORF9FQUdFUkxZIl0gPSAxXSA9ICJBUFBFTkRfRUFHRVJMWSI7CiAgSTE4bkNyZWF0ZU9wQ29kZTJbSTE4bkNyZWF0ZU9wQ29kZTJbIkNPTU1FTlQiXSA9IDJdID0gIkNPTU1FTlQiOwp9KShJMThuQ3JlYXRlT3BDb2RlIHx8IChJMThuQ3JlYXRlT3BDb2RlID0ge30pKTsKdmFyIExPQ0FMRV9JRCQxID0gREVGQVVMVF9MT0NBTEVfSUQ7CmZ1bmN0aW9uIHNldExvY2FsZUlkKGxvY2FsZUlkKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQobG9jYWxlSWQsIGBFeHBlY3RlZCBsb2NhbGVJZCB0byBiZSBkZWZpbmVkYCk7CiAgaWYgKHR5cGVvZiBsb2NhbGVJZCA9PT0gInN0cmluZyIpIHsKICAgIExPQ0FMRV9JRCQxID0gbG9jYWxlSWQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fL2csICItIik7CiAgfQp9CmZ1bmN0aW9uIGdldExvY2FsZUlkKCkgewogIHJldHVybiBMT0NBTEVfSUQkMTsKfQp2YXIgY2hhbmdlTWFzayA9IDA7CnZhciBjaGFuZ2VNYXNrQ291bnRlciA9IDA7CmZ1bmN0aW9uIHNldE1hc2tCaXQoaGFzQ2hhbmdlKSB7CiAgaWYgKGhhc0NoYW5nZSkgewogICAgY2hhbmdlTWFzayA9IGNoYW5nZU1hc2sgfCAxIDw8IE1hdGgubWluKGNoYW5nZU1hc2tDb3VudGVyLCAzMSk7CiAgfQogIGNoYW5nZU1hc2tDb3VudGVyKys7Cn0KZnVuY3Rpb24gYXBwbHlJMThuKHRWaWV3LCBsVmlldywgaW5kZXgpIHsKICBpZiAoY2hhbmdlTWFza0NvdW50ZXIgPiAwKSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZCh0VmlldywgYHRWaWV3IHNob3VsZCBiZSBkZWZpbmVkYCk7CiAgICBjb25zdCB0STE4biA9IHRWaWV3LmRhdGFbaW5kZXhdOwogICAgY29uc3QgdXBkYXRlT3BDb2RlcyA9IEFycmF5LmlzQXJyYXkodEkxOG4pID8gdEkxOG4gOiB0STE4bi51cGRhdGU7CiAgICBjb25zdCBiaW5kaW5nc1N0YXJ0SW5kZXggPSBnZXRCaW5kaW5nSW5kZXgoKSAtIGNoYW5nZU1hc2tDb3VudGVyIC0gMTsKICAgIGFwcGx5VXBkYXRlT3BDb2Rlcyh0VmlldywgbFZpZXcsIHVwZGF0ZU9wQ29kZXMsIGJpbmRpbmdzU3RhcnRJbmRleCwgY2hhbmdlTWFzayk7CiAgfQogIGNoYW5nZU1hc2sgPSAwOwogIGNoYW5nZU1hc2tDb3VudGVyID0gMDsKfQpmdW5jdGlvbiBjcmVhdGVOb2RlV2l0aG91dEh5ZHJhdGlvbihsVmlldywgdGV4dE9yTmFtZSwgbm9kZVR5cGUpIHsKICBjb25zdCByZW5kZXJlciA9IGxWaWV3W1JFTkRFUkVSXTsKICBzd2l0Y2ggKG5vZGVUeXBlKSB7CiAgICBjYXNlIE5vZGUuQ09NTUVOVF9OT0RFOgogICAgICByZXR1cm4gY3JlYXRlQ29tbWVudE5vZGUocmVuZGVyZXIsIHRleHRPck5hbWUpOwogICAgY2FzZSBOb2RlLlRFWFRfTk9ERToKICAgICAgcmV0dXJuIGNyZWF0ZVRleHROb2RlKHJlbmRlcmVyLCB0ZXh0T3JOYW1lKTsKICAgIGNhc2UgTm9kZS5FTEVNRU5UX05PREU6CiAgICAgIHJldHVybiBjcmVhdGVFbGVtZW50Tm9kZShyZW5kZXJlciwgdGV4dE9yTmFtZSwgbnVsbCk7CiAgfQp9CnZhciBfbG9jYXRlT3JDcmVhdGVOb2RlID0gKGxWaWV3LCBpbmRleCwgdGV4dE9yTmFtZSwgbm9kZVR5cGUpID0+IHsKICBsYXN0Tm9kZVdhc0NyZWF0ZWQodHJ1ZSk7CiAgcmV0dXJuIGNyZWF0ZU5vZGVXaXRob3V0SHlkcmF0aW9uKGxWaWV3LCB0ZXh0T3JOYW1lLCBub2RlVHlwZSk7Cn07CmZ1bmN0aW9uIGxvY2F0ZU9yQ3JlYXRlTm9kZUltcGwobFZpZXcsIGluZGV4LCB0ZXh0T3JOYW1lLCBub2RlVHlwZSkgewogIGNvbnN0IGh5ZHJhdGlvbkluZm8gPSBsVmlld1tIWURSQVRJT05dOwogIGNvbnN0IG5vT2Zmc2V0SW5kZXggPSBpbmRleCAtIEhFQURFUl9PRkZTRVQ7CiAgY29uc3QgaXNOb2RlQ3JlYXRpb25Nb2RlID0gIWlzSTE4bkh5ZHJhdGlvblN1cHBvcnRFbmFibGVkKCkgfHwgIWh5ZHJhdGlvbkluZm8gfHwgaXNJblNraXBIeWRyYXRpb25CbG9jaygpIHx8IGlzRGlzY29ubmVjdGVkTm9kZSQxKGh5ZHJhdGlvbkluZm8sIG5vT2Zmc2V0SW5kZXgpOwogIGxhc3ROb2RlV2FzQ3JlYXRlZChpc05vZGVDcmVhdGlvbk1vZGUpOwogIGlmIChpc05vZGVDcmVhdGlvbk1vZGUpIHsKICAgIHJldHVybiBjcmVhdGVOb2RlV2l0aG91dEh5ZHJhdGlvbihsVmlldywgdGV4dE9yTmFtZSwgbm9kZVR5cGUpOwogIH0KICBjb25zdCBuYXRpdmUgPSBsb2NhdGVJMThuUk5vZGVCeUluZGV4KGh5ZHJhdGlvbkluZm8sIG5vT2Zmc2V0SW5kZXgpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKG5hdGl2ZSwgImV4cGVjdGVkIG5hdGl2ZSBlbGVtZW50Iik7CiAgbmdEZXZNb2RlICYmIGFzc2VydEVxdWFsKG5hdGl2ZS5ub2RlVHlwZSwgbm9kZVR5cGUsICJleHBlY3RlZCBtYXRjaGluZyBub2RlVHlwZSIpOwogIG5nRGV2TW9kZSAmJiBub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUgJiYgYXNzZXJ0RXF1YWwobmF0aXZlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSwgdGV4dE9yTmFtZS50b0xvd2VyQ2FzZSgpLCAiZXhwZWN0aW5nIG1hdGNoaW5nIHRhZ05hbWUiKTsKICBuZ0Rldk1vZGUgJiYgbWFya1JOb2RlQXNDbGFpbWVkQnlIeWRyYXRpb24obmF0aXZlKTsKICByZXR1cm4gbmF0aXZlOwp9CmZ1bmN0aW9uIGVuYWJsZUxvY2F0ZU9yQ3JlYXRlSTE4bk5vZGVJbXBsKCkgewogIF9sb2NhdGVPckNyZWF0ZU5vZGUgPSBsb2NhdGVPckNyZWF0ZU5vZGVJbXBsOwp9CmZ1bmN0aW9uIGFwcGx5Q3JlYXRlT3BDb2RlcyhsVmlldywgY3JlYXRlT3BDb2RlcywgcGFyZW50Uk5vZGUsIGluc2VydEluRnJvbnRPZikgewogIGNvbnN0IHJlbmRlcmVyID0gbFZpZXdbUkVOREVSRVJdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgY3JlYXRlT3BDb2Rlcy5sZW5ndGg7IGkrKykgewogICAgY29uc3Qgb3BDb2RlID0gY3JlYXRlT3BDb2Rlc1tpKytdOwogICAgY29uc3QgdGV4dCA9IGNyZWF0ZU9wQ29kZXNbaV07CiAgICBjb25zdCBpc0NvbW1lbnQgPSAob3BDb2RlICYgSTE4bkNyZWF0ZU9wQ29kZS5DT01NRU5UKSA9PT0gSTE4bkNyZWF0ZU9wQ29kZS5DT01NRU5UOwogICAgY29uc3QgYXBwZW5kTm93ID0gKG9wQ29kZSAmIEkxOG5DcmVhdGVPcENvZGUuQVBQRU5EX0VBR0VSTFkpID09PSBJMThuQ3JlYXRlT3BDb2RlLkFQUEVORF9FQUdFUkxZOwogICAgY29uc3QgaW5kZXggPSBvcENvZGUgPj4+IEkxOG5DcmVhdGVPcENvZGUuU0hJRlQ7CiAgICBsZXQgck5vZGUgPSBsVmlld1tpbmRleF07CiAgICBsZXQgbGFzdE5vZGVXYXNDcmVhdGVkMiA9IGZhbHNlOwogICAgaWYgKHJOb2RlID09PSBudWxsKSB7CiAgICAgIHJOb2RlID0gbFZpZXdbaW5kZXhdID0gX2xvY2F0ZU9yQ3JlYXRlTm9kZShsVmlldywgaW5kZXgsIHRleHQsIGlzQ29tbWVudCA/IE5vZGUuQ09NTUVOVF9OT0RFIDogTm9kZS5URVhUX05PREUpOwogICAgICBsYXN0Tm9kZVdhc0NyZWF0ZWQyID0gd2FzTGFzdE5vZGVDcmVhdGVkKCk7CiAgICB9CiAgICBpZiAoYXBwZW5kTm93ICYmIHBhcmVudFJOb2RlICE9PSBudWxsICYmIGxhc3ROb2RlV2FzQ3JlYXRlZDIpIHsKICAgICAgbmF0aXZlSW5zZXJ0QmVmb3JlKHJlbmRlcmVyLCBwYXJlbnRSTm9kZSwgck5vZGUsIGluc2VydEluRnJvbnRPZiwgZmFsc2UpOwogICAgfQogIH0KfQpmdW5jdGlvbiBhcHBseU11dGFibGVPcENvZGVzKHRWaWV3LCBtdXRhYmxlT3BDb2RlcywgbFZpZXcsIGFuY2hvclJOb2RlKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydERvbU5vZGUoYW5jaG9yUk5vZGUpOwogIGNvbnN0IHJlbmRlcmVyID0gbFZpZXdbUkVOREVSRVJdOwogIGxldCByb290SWR4ID0gbnVsbDsKICBsZXQgcm9vdFJOb2RlOwogIGZvciAobGV0IGkgPSAwOyBpIDwgbXV0YWJsZU9wQ29kZXMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IG9wQ29kZSA9IG11dGFibGVPcENvZGVzW2ldOwogICAgaWYgKHR5cGVvZiBvcENvZGUgPT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgdGV4dE5vZGVJbmRleCA9IG11dGFibGVPcENvZGVzWysraV07CiAgICAgIGlmIChsVmlld1t0ZXh0Tm9kZUluZGV4XSA9PT0gbnVsbCkgewogICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluUmFuZ2UobFZpZXcsIHRleHROb2RlSW5kZXgpOwogICAgICAgIGxWaWV3W3RleHROb2RlSW5kZXhdID0gX2xvY2F0ZU9yQ3JlYXRlTm9kZShsVmlldywgdGV4dE5vZGVJbmRleCwgb3BDb2RlLCBOb2RlLlRFWFRfTk9ERSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wQ29kZSA9PSAibnVtYmVyIikgewogICAgICBzd2l0Y2ggKG9wQ29kZSAmIDEpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBjb25zdCBwYXJlbnRJZHggPSBnZXRQYXJlbnRGcm9tSWN1Q3JlYXRlT3BDb2RlKG9wQ29kZSk7CiAgICAgICAgICBpZiAocm9vdElkeCA9PT0gbnVsbCkgewogICAgICAgICAgICByb290SWR4ID0gcGFyZW50SWR4OwogICAgICAgICAgICByb290Uk5vZGUgPSByZW5kZXJlci5wYXJlbnROb2RlKGFuY2hvclJOb2RlKTsKICAgICAgICAgIH0KICAgICAgICAgIGxldCBpbnNlcnRJbkZyb250T2Y7CiAgICAgICAgICBsZXQgcGFyZW50Uk5vZGU7CiAgICAgICAgICBpZiAocGFyZW50SWR4ID09PSByb290SWR4KSB7CiAgICAgICAgICAgIGluc2VydEluRnJvbnRPZiA9IGFuY2hvclJOb2RlOwogICAgICAgICAgICBwYXJlbnRSTm9kZSA9IHJvb3RSTm9kZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGluc2VydEluRnJvbnRPZiA9IG51bGw7CiAgICAgICAgICAgIHBhcmVudFJOb2RlID0gdW53cmFwUk5vZGUobFZpZXdbcGFyZW50SWR4XSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocGFyZW50Uk5vZGUgIT09IG51bGwpIHsKICAgICAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERvbU5vZGUocGFyZW50Uk5vZGUpOwogICAgICAgICAgICBjb25zdCByZWZJZHggPSBnZXRSZWZGcm9tSWN1Q3JlYXRlT3BDb2RlKG9wQ29kZSk7CiAgICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRHcmVhdGVyVGhhbihyZWZJZHgsIEhFQURFUl9PRkZTRVQsICJNaXNzaW5nIHJlZiIpOwogICAgICAgICAgICBjb25zdCBjaGlsZCA9IGxWaWV3W3JlZklkeF07CiAgICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREb21Ob2RlKGNoaWxkKTsKICAgICAgICAgICAgbmF0aXZlSW5zZXJ0QmVmb3JlKHJlbmRlcmVyLCBwYXJlbnRSTm9kZSwgY2hpbGQsIGluc2VydEluRnJvbnRPZiwgZmFsc2UpOwogICAgICAgICAgICBjb25zdCB0SWN1ID0gZ2V0VEljdSh0VmlldywgcmVmSWR4KTsKICAgICAgICAgICAgaWYgKHRJY3UgIT09IG51bGwgJiYgdHlwZW9mIHRJY3UgPT09ICJvYmplY3QiKSB7CiAgICAgICAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydFRJY3UodEljdSk7CiAgICAgICAgICAgICAgY29uc3QgY2FzZUluZGV4ID0gZ2V0Q3VycmVudElDVUNhc2VJbmRleCh0SWN1LCBsVmlldyk7CiAgICAgICAgICAgICAgaWYgKGNhc2VJbmRleCAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgYXBwbHlNdXRhYmxlT3BDb2Rlcyh0VmlldywgdEljdS5jcmVhdGVbY2FzZUluZGV4XSwgbFZpZXcsIGxWaWV3W3RJY3UuYW5jaG9ySWR4XSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjb25zdCBlbGVtZW50Tm9kZUluZGV4ID0gb3BDb2RlID4+PiAxOwogICAgICAgICAgY29uc3QgYXR0ck5hbWUgPSBtdXRhYmxlT3BDb2Rlc1srK2ldOwogICAgICAgICAgY29uc3QgYXR0clZhbHVlID0gbXV0YWJsZU9wQ29kZXNbKytpXTsKICAgICAgICAgIHNldEVsZW1lbnRBdHRyaWJ1dGUocmVuZGVyZXIsIGdldE5hdGl2ZUJ5SW5kZXgoZWxlbWVudE5vZGVJbmRleCwgbFZpZXcpLCBudWxsLCBudWxsLCBhdHRyTmFtZSwgYXR0clZhbHVlLCBudWxsKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoNzAwLCBgVW5hYmxlIHRvIGRldGVybWluZSB0aGUgdHlwZSBvZiBtdXRhdGUgb3BlcmF0aW9uIGZvciAiJHtvcENvZGV9ImApOwogICAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBzd2l0Y2ggKG9wQ29kZSkgewogICAgICAgIGNhc2UgSUNVX01BUktFUjoKICAgICAgICAgIGNvbnN0IGNvbW1lbnRWYWx1ZSA9IG11dGFibGVPcENvZGVzWysraV07CiAgICAgICAgICBjb25zdCBjb21tZW50Tm9kZUluZGV4ID0gbXV0YWJsZU9wQ29kZXNbKytpXTsKICAgICAgICAgIGlmIChsVmlld1tjb21tZW50Tm9kZUluZGV4XSA9PT0gbnVsbCkgewogICAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwodHlwZW9mIGNvbW1lbnRWYWx1ZSwgInN0cmluZyIsIGBFeHBlY3RlZCAiJHtjb21tZW50VmFsdWV9IiB0byBiZSBhIGNvbW1lbnQgbm9kZSB2YWx1ZWApOwogICAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJbkV4cGFuZG9SYW5nZShsVmlldywgY29tbWVudE5vZGVJbmRleCk7CiAgICAgICAgICAgIGNvbnN0IGNvbW1lbnRSTm9kZSA9IGxWaWV3W2NvbW1lbnROb2RlSW5kZXhdID0gX2xvY2F0ZU9yQ3JlYXRlTm9kZShsVmlldywgY29tbWVudE5vZGVJbmRleCwgY29tbWVudFZhbHVlLCBOb2RlLkNPTU1FTlRfTk9ERSk7CiAgICAgICAgICAgIGF0dGFjaFBhdGNoRGF0YShjb21tZW50Uk5vZGUsIGxWaWV3KTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgRUxFTUVOVF9NQVJLRVI6CiAgICAgICAgICBjb25zdCB0YWdOYW1lID0gbXV0YWJsZU9wQ29kZXNbKytpXTsKICAgICAgICAgIGNvbnN0IGVsZW1lbnROb2RlSW5kZXggPSBtdXRhYmxlT3BDb2Rlc1srK2ldOwogICAgICAgICAgaWYgKGxWaWV3W2VsZW1lbnROb2RlSW5kZXhdID09PSBudWxsKSB7CiAgICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbCh0eXBlb2YgdGFnTmFtZSwgInN0cmluZyIsIGBFeHBlY3RlZCAiJHt0YWdOYW1lfSIgdG8gYmUgYW4gZWxlbWVudCBub2RlIHRhZyBuYW1lYCk7CiAgICAgICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRJbmRleEluRXhwYW5kb1JhbmdlKGxWaWV3LCBlbGVtZW50Tm9kZUluZGV4KTsKICAgICAgICAgICAgY29uc3QgZWxlbWVudFJOb2RlID0gbFZpZXdbZWxlbWVudE5vZGVJbmRleF0gPSBfbG9jYXRlT3JDcmVhdGVOb2RlKGxWaWV3LCBlbGVtZW50Tm9kZUluZGV4LCB0YWdOYW1lLCBOb2RlLkVMRU1FTlRfTk9ERSk7CiAgICAgICAgICAgIGF0dGFjaFBhdGNoRGF0YShlbGVtZW50Uk5vZGUsIGxWaWV3KTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBuZ0Rldk1vZGUgJiYgdGhyb3dFcnJvcjIoYFVuYWJsZSB0byBkZXRlcm1pbmUgdGhlIHR5cGUgb2YgbXV0YXRlIG9wZXJhdGlvbiBmb3IgIiR7b3BDb2RlfSJgKTsKICAgICAgfQogICAgfQogIH0KfQpmdW5jdGlvbiBhcHBseVVwZGF0ZU9wQ29kZXModFZpZXcsIGxWaWV3LCB1cGRhdGVPcENvZGVzLCBiaW5kaW5nc1N0YXJ0SW5kZXgsIGNoYW5nZU1hc2syKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB1cGRhdGVPcENvZGVzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBjaGVja0JpdCA9IHVwZGF0ZU9wQ29kZXNbaV07CiAgICBjb25zdCBza2lwQ29kZXMgPSB1cGRhdGVPcENvZGVzWysraV07CiAgICBpZiAoY2hlY2tCaXQgJiBjaGFuZ2VNYXNrMikgewogICAgICBsZXQgdmFsdWUgPSAiIjsKICAgICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDw9IGkgKyBza2lwQ29kZXM7IGorKykgewogICAgICAgIGNvbnN0IG9wQ29kZSA9IHVwZGF0ZU9wQ29kZXNbal07CiAgICAgICAgaWYgKHR5cGVvZiBvcENvZGUgPT0gInN0cmluZyIpIHsKICAgICAgICAgIHZhbHVlICs9IG9wQ29kZTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcENvZGUgPT0gIm51bWJlciIpIHsKICAgICAgICAgIGlmIChvcENvZGUgPCAwKSB7CiAgICAgICAgICAgIHZhbHVlICs9IHJlbmRlclN0cmluZ2lmeShsVmlld1tiaW5kaW5nc1N0YXJ0SW5kZXggLSBvcENvZGVdKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IG5vZGVJbmRleCA9IG9wQ29kZSA+Pj4gMjsKICAgICAgICAgICAgc3dpdGNoIChvcENvZGUgJiAzKSB7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgY29uc3QgcHJvcE5hbWUgPSB1cGRhdGVPcENvZGVzWysral07CiAgICAgICAgICAgICAgICBjb25zdCBzYW5pdGl6ZUZuID0gdXBkYXRlT3BDb2Rlc1srK2pdOwogICAgICAgICAgICAgICAgY29uc3QgdE5vZGVPclRhZ05hbWUgPSB0Vmlldy5kYXRhW25vZGVJbmRleF07CiAgICAgICAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZCh0Tm9kZU9yVGFnTmFtZSwgIkV4cGVydGluZyBUTm9kZSBvciBzdHJpbmciKTsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdE5vZGVPclRhZ05hbWUgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICAgIHNldEVsZW1lbnRBdHRyaWJ1dGUobFZpZXdbUkVOREVSRVJdLCBsVmlld1tub2RlSW5kZXhdLCBudWxsLCB0Tm9kZU9yVGFnTmFtZSwgcHJvcE5hbWUsIHZhbHVlLCBzYW5pdGl6ZUZuKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHNldFByb3BlcnR5QW5kSW5wdXRzKHROb2RlT3JUYWdOYW1lLCBsVmlldywgcHJvcE5hbWUsIHZhbHVlLCBsVmlld1tSRU5ERVJFUl0sIHNhbml0aXplRm4pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29uc3QgclRleHQgPSBsVmlld1tub2RlSW5kZXhdOwogICAgICAgICAgICAgICAgclRleHQgIT09IG51bGwgJiYgdXBkYXRlVGV4dE5vZGUobFZpZXdbUkVOREVSRVJdLCByVGV4dCwgdmFsdWUpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgYXBwbHlJY3VTd2l0Y2hDYXNlKHRWaWV3LCBnZXRUSWN1KHRWaWV3LCBub2RlSW5kZXgpLCBsVmlldywgdmFsdWUpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgYXBwbHlJY3VVcGRhdGVDYXNlKHRWaWV3LCBnZXRUSWN1KHRWaWV3LCBub2RlSW5kZXgpLCBiaW5kaW5nc1N0YXJ0SW5kZXgsIGxWaWV3KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBvcENvZGUgPSB1cGRhdGVPcENvZGVzW2kgKyAxXTsKICAgICAgaWYgKG9wQ29kZSA+IDAgJiYgKG9wQ29kZSAmIDMpID09PSAzKSB7CiAgICAgICAgY29uc3Qgbm9kZUluZGV4ID0gb3BDb2RlID4+PiAyOwogICAgICAgIGNvbnN0IHRJY3UgPSBnZXRUSWN1KHRWaWV3LCBub2RlSW5kZXgpOwogICAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IGxWaWV3W3RJY3UuY3VycmVudENhc2VMVmlld0luZGV4XTsKICAgICAgICBpZiAoY3VycmVudEluZGV4IDwgMCkgewogICAgICAgICAgYXBwbHlJY3VVcGRhdGVDYXNlKHRWaWV3LCB0SWN1LCBiaW5kaW5nc1N0YXJ0SW5kZXgsIGxWaWV3KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGkgKz0gc2tpcENvZGVzOwogIH0KfQpmdW5jdGlvbiBhcHBseUljdVVwZGF0ZUNhc2UodFZpZXcsIHRJY3UsIGJpbmRpbmdzU3RhcnRJbmRleCwgbFZpZXcpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJblJhbmdlKGxWaWV3LCB0SWN1LmN1cnJlbnRDYXNlTFZpZXdJbmRleCk7CiAgbGV0IGFjdGl2ZUNhc2VJbmRleCA9IGxWaWV3W3RJY3UuY3VycmVudENhc2VMVmlld0luZGV4XTsKICBpZiAoYWN0aXZlQ2FzZUluZGV4ICE9PSBudWxsKSB7CiAgICBsZXQgbWFzayA9IGNoYW5nZU1hc2s7CiAgICBpZiAoYWN0aXZlQ2FzZUluZGV4IDwgMCkgewogICAgICBhY3RpdmVDYXNlSW5kZXggPSBsVmlld1t0SWN1LmN1cnJlbnRDYXNlTFZpZXdJbmRleF0gPSB+YWN0aXZlQ2FzZUluZGV4OwogICAgICBtYXNrID0gLTE7CiAgICB9CiAgICBhcHBseVVwZGF0ZU9wQ29kZXModFZpZXcsIGxWaWV3LCB0SWN1LnVwZGF0ZVthY3RpdmVDYXNlSW5kZXhdLCBiaW5kaW5nc1N0YXJ0SW5kZXgsIG1hc2spOwogIH0KfQpmdW5jdGlvbiBhcHBseUljdVN3aXRjaENhc2UodFZpZXcsIHRJY3UsIGxWaWV3LCB2YWx1ZSkgewogIGNvbnN0IGNhc2VJbmRleCA9IGdldENhc2VJbmRleCh0SWN1LCB2YWx1ZSk7CiAgbGV0IGFjdGl2ZUNhc2VJbmRleCA9IGdldEN1cnJlbnRJQ1VDYXNlSW5kZXgodEljdSwgbFZpZXcpOwogIGlmIChhY3RpdmVDYXNlSW5kZXggIT09IGNhc2VJbmRleCkgewogICAgYXBwbHlJY3VTd2l0Y2hDYXNlUmVtb3ZlKHRWaWV3LCB0SWN1LCBsVmlldyk7CiAgICBsVmlld1t0SWN1LmN1cnJlbnRDYXNlTFZpZXdJbmRleF0gPSBjYXNlSW5kZXggPT09IG51bGwgPyBudWxsIDogfmNhc2VJbmRleDsKICAgIGlmIChjYXNlSW5kZXggIT09IG51bGwpIHsKICAgICAgY29uc3QgYW5jaG9yUk5vZGUgPSBsVmlld1t0SWN1LmFuY2hvcklkeF07CiAgICAgIGlmIChhbmNob3JSTm9kZSkgewogICAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREb21Ob2RlKGFuY2hvclJOb2RlKTsKICAgICAgICBhcHBseU11dGFibGVPcENvZGVzKHRWaWV3LCB0SWN1LmNyZWF0ZVtjYXNlSW5kZXhdLCBsVmlldywgYW5jaG9yUk5vZGUpOwogICAgICB9CiAgICAgIGNsYWltRGVoeWRyYXRlZEljdUNhc2UobFZpZXcsIHRJY3UuYW5jaG9ySWR4LCBjYXNlSW5kZXgpOwogICAgfQogIH0KfQpmdW5jdGlvbiBhcHBseUljdVN3aXRjaENhc2VSZW1vdmUodFZpZXcsIHRJY3UsIGxWaWV3KSB7CiAgbGV0IGFjdGl2ZUNhc2VJbmRleCA9IGdldEN1cnJlbnRJQ1VDYXNlSW5kZXgodEljdSwgbFZpZXcpOwogIGlmIChhY3RpdmVDYXNlSW5kZXggIT09IG51bGwpIHsKICAgIGNvbnN0IHJlbW92ZUNvZGVzID0gdEljdS5yZW1vdmVbYWN0aXZlQ2FzZUluZGV4XTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVtb3ZlQ29kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3Qgbm9kZU9ySWN1SW5kZXggPSByZW1vdmVDb2Rlc1tpXTsKICAgICAgaWYgKG5vZGVPckljdUluZGV4ID4gMCkgewogICAgICAgIGNvbnN0IHJOb2RlID0gZ2V0TmF0aXZlQnlJbmRleChub2RlT3JJY3VJbmRleCwgbFZpZXcpOwogICAgICAgIHJOb2RlICE9PSBudWxsICYmIG5hdGl2ZVJlbW92ZU5vZGUobFZpZXdbUkVOREVSRVJdLCByTm9kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXBwbHlJY3VTd2l0Y2hDYXNlUmVtb3ZlKHRWaWV3LCBnZXRUSWN1KHRWaWV3LCB+bm9kZU9ySWN1SW5kZXgpLCBsVmlldyk7CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gZ2V0Q2FzZUluZGV4KGljdUV4cHJlc3Npb24sIGJpbmRpbmdWYWx1ZSkgewogIGxldCBpbmRleCA9IGljdUV4cHJlc3Npb24uY2FzZXMuaW5kZXhPZihiaW5kaW5nVmFsdWUpOwogIGlmIChpbmRleCA9PT0gLTEpIHsKICAgIHN3aXRjaCAoaWN1RXhwcmVzc2lvbi50eXBlKSB7CiAgICAgIGNhc2UgMTogewogICAgICAgIGNvbnN0IHJlc29sdmVkQ2FzZSA9IGdldFBsdXJhbENhc2UoYmluZGluZ1ZhbHVlLCBnZXRMb2NhbGVJZCgpKTsKICAgICAgICBpbmRleCA9IGljdUV4cHJlc3Npb24uY2FzZXMuaW5kZXhPZihyZXNvbHZlZENhc2UpOwogICAgICAgIGlmIChpbmRleCA9PT0gLTEgJiYgcmVzb2x2ZWRDYXNlICE9PSAib3RoZXIiKSB7CiAgICAgICAgICBpbmRleCA9IGljdUV4cHJlc3Npb24uY2FzZXMuaW5kZXhPZigib3RoZXIiKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAwOiB7CiAgICAgICAgaW5kZXggPSBpY3VFeHByZXNzaW9uLmNhc2VzLmluZGV4T2YoIm90aGVyIik7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGluZGV4ID09PSAtMSA/IG51bGwgOiBpbmRleDsKfQpmdW5jdGlvbiBpMThuQ3JlYXRlT3BDb2Rlc1RvU3RyaW5nKG9wY29kZXMpIHsKICBjb25zdCBjcmVhdGVPcENvZGVzID0gb3Bjb2RlcyB8fCAoQXJyYXkuaXNBcnJheSh0aGlzKSA/IHRoaXMgOiBbXSk7CiAgbGV0IGxpbmVzID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjcmVhdGVPcENvZGVzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBvcENvZGUgPSBjcmVhdGVPcENvZGVzW2krK107CiAgICBjb25zdCB0ZXh0ID0gY3JlYXRlT3BDb2Rlc1tpXTsKICAgIGNvbnN0IGlzQ29tbWVudCA9IChvcENvZGUgJiBJMThuQ3JlYXRlT3BDb2RlLkNPTU1FTlQpID09PSBJMThuQ3JlYXRlT3BDb2RlLkNPTU1FTlQ7CiAgICBjb25zdCBhcHBlbmROb3cgPSAob3BDb2RlICYgSTE4bkNyZWF0ZU9wQ29kZS5BUFBFTkRfRUFHRVJMWSkgPT09IEkxOG5DcmVhdGVPcENvZGUuQVBQRU5EX0VBR0VSTFk7CiAgICBjb25zdCBpbmRleCA9IG9wQ29kZSA+Pj4gSTE4bkNyZWF0ZU9wQ29kZS5TSElGVDsKICAgIGxpbmVzLnB1c2goYGxWaWV3WyR7aW5kZXh9XSA9IGRvY3VtZW50LiR7aXNDb21tZW50ID8gImNyZWF0ZUNvbW1lbnQiIDogImNyZWF0ZVRleHQifSgke0pTT04uc3RyaW5naWZ5KHRleHQpfSk7YCk7CiAgICBpZiAoYXBwZW5kTm93KSB7CiAgICAgIGxpbmVzLnB1c2goYHBhcmVudC5hcHBlbmRDaGlsZChsVmlld1ske2luZGV4fV0pO2ApOwogICAgfQogIH0KICByZXR1cm4gbGluZXM7Cn0KZnVuY3Rpb24gaTE4blVwZGF0ZU9wQ29kZXNUb1N0cmluZyhvcGNvZGVzKSB7CiAgY29uc3QgcGFyc2VyID0gbmV3IE9wQ29kZVBhcnNlcihvcGNvZGVzIHx8IChBcnJheS5pc0FycmF5KHRoaXMpID8gdGhpcyA6IFtdKSk7CiAgbGV0IGxpbmVzID0gW107CiAgZnVuY3Rpb24gY29uc3VtZU9wQ29kZSh2YWx1ZSkgewogICAgY29uc3QgcmVmID0gdmFsdWUgPj4+IDI7CiAgICBjb25zdCBvcENvZGUgPSB2YWx1ZSAmIDM7CiAgICBzd2l0Y2ggKG9wQ29kZSkgewogICAgICBjYXNlIDA6CiAgICAgICAgcmV0dXJuIGAobFZpZXdbJHtyZWZ9XSBhcyBUZXh0KS50ZXh0Q29udGVudCA9ICQkJGA7CiAgICAgIGNhc2UgMToKICAgICAgICBjb25zdCBhdHRyTmFtZSA9IHBhcnNlci5jb25zdW1lU3RyaW5nKCk7CiAgICAgICAgY29uc3Qgc2FuaXRpemF0aW9uRm4gPSBwYXJzZXIuY29uc3VtZUZ1bmN0aW9uKCk7CiAgICAgICAgY29uc3QgdmFsdWUyID0gc2FuaXRpemF0aW9uRm4gPyBgKCR7c2FuaXRpemF0aW9uRm59KSgkJCQpYCA6ICIkJCQiOwogICAgICAgIHJldHVybiBgKGxWaWV3WyR7cmVmfV0gYXMgRWxlbWVudCkuc2V0QXR0cmlidXRlKCcke2F0dHJOYW1lfScsICR7dmFsdWUyfSlgOwogICAgICBjYXNlIDI6CiAgICAgICAgcmV0dXJuIGBpY3VTd2l0Y2hDYXNlKCR7cmVmfSwgJCQkKWA7CiAgICAgIGNhc2UgMzoKICAgICAgICByZXR1cm4gYGljdVVwZGF0ZUNhc2UoJHtyZWZ9KWA7CiAgICB9CiAgICB0aHJvdyBuZXcgRXJyb3IoInVuZXhwZWN0ZWQgT3BDb2RlIik7CiAgfQogIHdoaWxlIChwYXJzZXIuaGFzTW9yZSgpKSB7CiAgICBsZXQgbWFzayA9IHBhcnNlci5jb25zdW1lTnVtYmVyKCk7CiAgICBsZXQgc2l6ZSA9IHBhcnNlci5jb25zdW1lTnVtYmVyKCk7CiAgICBjb25zdCBlbmQgPSBwYXJzZXIuaSArIHNpemU7CiAgICBjb25zdCBzdGF0ZW1lbnRzID0gW107CiAgICBsZXQgc3RhdGVtZW50ID0gIiI7CiAgICB3aGlsZSAocGFyc2VyLmkgPCBlbmQpIHsKICAgICAgbGV0IHZhbHVlID0gcGFyc2VyLmNvbnN1bWVOdW1iZXJPclN0cmluZygpOwogICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICAgIHN0YXRlbWVudCArPSB2YWx1ZTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IDApIHsKICAgICAgICBzdGF0ZW1lbnQgKz0gIiR7bFZpZXdbaSIgKyB2YWx1ZSArICJdfSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3Qgb3BDb2RlVGV4dCA9IGNvbnN1bWVPcENvZGUodmFsdWUpOwogICAgICAgIHN0YXRlbWVudHMucHVzaChvcENvZGVUZXh0LnJlcGxhY2UoIiQkJCIsICJgIiArIHN0YXRlbWVudCArICJgIikgKyAiOyIpOwogICAgICAgIHN0YXRlbWVudCA9ICIiOwogICAgICB9CiAgICB9CiAgICBsaW5lcy5wdXNoKGBpZiAobWFzayAmIDBiJHttYXNrLnRvU3RyaW5nKDIpfSkgeyAke3N0YXRlbWVudHMuam9pbigiICIpfSB9YCk7CiAgfQogIHJldHVybiBsaW5lczsKfQpmdW5jdGlvbiBpY3VDcmVhdGVPcENvZGVzVG9TdHJpbmcob3Bjb2RlcykgewogIGNvbnN0IHBhcnNlciA9IG5ldyBPcENvZGVQYXJzZXIob3Bjb2RlcyB8fCAoQXJyYXkuaXNBcnJheSh0aGlzKSA/IHRoaXMgOiBbXSkpOwogIGxldCBsaW5lcyA9IFtdOwogIGZ1bmN0aW9uIGNvbnN1bWVPcENvZGUob3BDb2RlKSB7CiAgICBjb25zdCBwYXJlbnQgPSBnZXRQYXJlbnRGcm9tSWN1Q3JlYXRlT3BDb2RlKG9wQ29kZSk7CiAgICBjb25zdCByZWYgPSBnZXRSZWZGcm9tSWN1Q3JlYXRlT3BDb2RlKG9wQ29kZSk7CiAgICBzd2l0Y2ggKGdldEluc3RydWN0aW9uRnJvbUljdUNyZWF0ZU9wQ29kZShvcENvZGUpKSB7CiAgICAgIGNhc2UgMDoKICAgICAgICByZXR1cm4gYChsVmlld1ske3BhcmVudH1dIGFzIEVsZW1lbnQpLmFwcGVuZENoaWxkKGxWaWV3WyR7bGFzdFJlZn1dKWA7CiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4gYChsVmlld1ske3JlZn1dIGFzIEVsZW1lbnQpLnNldEF0dHJpYnV0ZSgiJHtwYXJzZXIuY29uc3VtZVN0cmluZygpfSIsICIke3BhcnNlci5jb25zdW1lU3RyaW5nKCl9IilgOwogICAgfQogICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIE9wQ29kZTogIiArIGdldEluc3RydWN0aW9uRnJvbUljdUNyZWF0ZU9wQ29kZShvcENvZGUpKTsKICB9CiAgbGV0IGxhc3RSZWYgPSAtMTsKICB3aGlsZSAocGFyc2VyLmhhc01vcmUoKSkgewogICAgbGV0IHZhbHVlID0gcGFyc2VyLmNvbnN1bWVOdW1iZXJTdHJpbmdPck1hcmtlcigpOwogICAgaWYgKHZhbHVlID09PSBJQ1VfTUFSS0VSKSB7CiAgICAgIGNvbnN0IHRleHQgPSBwYXJzZXIuY29uc3VtZVN0cmluZygpOwogICAgICBsYXN0UmVmID0gcGFyc2VyLmNvbnN1bWVOdW1iZXIoKTsKICAgICAgbGluZXMucHVzaChgbFZpZXdbJHtsYXN0UmVmfV0gPSBkb2N1bWVudC5jcmVhdGVDb21tZW50KCIke3RleHR9IilgKTsKICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IEVMRU1FTlRfTUFSS0VSKSB7CiAgICAgIGNvbnN0IHRleHQgPSBwYXJzZXIuY29uc3VtZVN0cmluZygpOwogICAgICBsYXN0UmVmID0gcGFyc2VyLmNvbnN1bWVOdW1iZXIoKTsKICAgICAgbGluZXMucHVzaChgbFZpZXdbJHtsYXN0UmVmfV0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCIke3RleHR9IilgKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICBsYXN0UmVmID0gcGFyc2VyLmNvbnN1bWVOdW1iZXIoKTsKICAgICAgbGluZXMucHVzaChgbFZpZXdbJHtsYXN0UmVmfV0gPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiJHt2YWx1ZX0iKWApOwogICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiKSB7CiAgICAgIGNvbnN0IGxpbmUgPSBjb25zdW1lT3BDb2RlKHZhbHVlKTsKICAgICAgbGluZSAmJiBsaW5lcy5wdXNoKGxpbmUpOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIHZhbHVlIik7CiAgICB9CiAgfQogIHJldHVybiBsaW5lczsKfQpmdW5jdGlvbiBpMThuUmVtb3ZlT3BDb2Rlc1RvU3RyaW5nKG9wY29kZXMpIHsKICBjb25zdCByZW1vdmVDb2RlcyA9IG9wY29kZXMgfHwgKEFycmF5LmlzQXJyYXkodGhpcykgPyB0aGlzIDogW10pOwogIGxldCBsaW5lcyA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgcmVtb3ZlQ29kZXMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IG5vZGVPckljdUluZGV4ID0gcmVtb3ZlQ29kZXNbaV07CiAgICBpZiAobm9kZU9ySWN1SW5kZXggPiAwKSB7CiAgICAgIGxpbmVzLnB1c2goYHJlbW92ZShsVmlld1ske25vZGVPckljdUluZGV4fV0pYCk7CiAgICB9IGVsc2UgewogICAgICBsaW5lcy5wdXNoKGByZW1vdmVOZXN0ZWRJQ1UoJHt+bm9kZU9ySWN1SW5kZXh9KWApOwogICAgfQogIH0KICByZXR1cm4gbGluZXM7Cn0KdmFyIE9wQ29kZVBhcnNlciA9IGNsYXNzIHsKICBpID0gMDsKICBjb2RlczsKICBjb25zdHJ1Y3Rvcihjb2RlcykgewogICAgdGhpcy5jb2RlcyA9IGNvZGVzOwogIH0KICBoYXNNb3JlKCkgewogICAgcmV0dXJuIHRoaXMuaSA8IHRoaXMuY29kZXMubGVuZ3RoOwogIH0KICBjb25zdW1lTnVtYmVyKCkgewogICAgbGV0IHZhbHVlID0gdGhpcy5jb2Rlc1t0aGlzLmkrK107CiAgICBhc3NlcnROdW1iZXIodmFsdWUsICJleHBlY3RpbmcgbnVtYmVyIGluIE9wQ29kZSIpOwogICAgcmV0dXJuIHZhbHVlOwogIH0KICBjb25zdW1lU3RyaW5nKCkgewogICAgbGV0IHZhbHVlID0gdGhpcy5jb2Rlc1t0aGlzLmkrK107CiAgICBhc3NlcnRTdHJpbmcodmFsdWUsICJleHBlY3Rpbmcgc3RyaW5nIGluIE9wQ29kZSIpOwogICAgcmV0dXJuIHZhbHVlOwogIH0KICBjb25zdW1lRnVuY3Rpb24oKSB7CiAgICBsZXQgdmFsdWUgPSB0aGlzLmNvZGVzW3RoaXMuaSsrXTsKICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogICAgdGhyb3cgbmV3IEVycm9yKCJleHBlY3RpbmcgZnVuY3Rpb24gaW4gT3BDb2RlIik7CiAgfQogIGNvbnN1bWVOdW1iZXJPclN0cmluZygpIHsKICAgIGxldCB2YWx1ZSA9IHRoaXMuY29kZXNbdGhpcy5pKytdOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogICAgYXNzZXJ0TnVtYmVyKHZhbHVlLCAiZXhwZWN0aW5nIG51bWJlciBvciBzdHJpbmcgaW4gT3BDb2RlIik7CiAgICByZXR1cm4gdmFsdWU7CiAgfQogIGNvbnN1bWVOdW1iZXJTdHJpbmdPck1hcmtlcigpIHsKICAgIGxldCB2YWx1ZSA9IHRoaXMuY29kZXNbdGhpcy5pKytdOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgfHwgdHlwZW9mIHZhbHVlID09PSAibnVtYmVyIiB8fCB2YWx1ZSA9PSBJQ1VfTUFSS0VSIHx8IHZhbHVlID09IEVMRU1FTlRfTUFSS0VSKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICAgIGFzc2VydE51bWJlcih2YWx1ZSwgImV4cGVjdGluZyBudW1iZXIsIHN0cmluZywgSUNVX01BUktFUiBvciBFTEVNRU5UX01BUktFUiBpbiBPcENvZGUiKTsKICAgIHJldHVybiB2YWx1ZTsKICB9Cn07CnZhciBCSU5ESU5HX1JFR0VYUCA9IC/vv70oXGQrKTo/XGQq77+9L2dpOwp2YXIgSUNVX1JFR0VYUCA9IC8oe1xzKu+/vVxkKzo/XGQq77+9XHMqLFxzKlxTezZ9XHMqLFtcc1xTXSp9KS9naTsKdmFyIE5FU1RFRF9JQ1UgPSAv77+9KFxkKynvv70vOwp2YXIgSUNVX0JMT0NLX1JFR0VYUCA9IC9eXHMqKO+/vVxkKzo/XGQq77+9KVxzKixccyooc2VsZWN0fHBsdXJhbClccyosLzsKdmFyIE1BUktFUiA9IGDvv71gOwp2YXIgU1VCVEVNUExBVEVfUkVHRVhQID0gL++/vVwvP1wqKFxkKzpcZCsp77+9L2dpOwp2YXIgUEhfUkVHRVhQID0gL++/vShcLz9bIypdXGQrKTo/XGQq77+9L2dpOwp2YXIgTkdTUF9VTklDT0RFX1JFR0VYUCA9IC9cdUU1MDAvZzsKZnVuY3Rpb24gcmVwbGFjZU5nc3AodmFsdWUpIHsKICByZXR1cm4gdmFsdWUucmVwbGFjZShOR1NQX1VOSUNPREVfUkVHRVhQLCAiICIpOwp9CmZ1bmN0aW9uIGF0dGFjaERlYnVnR2V0dGVyKG9iaiwgZGVidWdHZXR0ZXIpIHsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCAiZGVidWciLCB7CiAgICAgIGdldDogZGVidWdHZXR0ZXIsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICB9KTsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IEVycm9yKCJUaGlzIG1ldGhvZCBzaG91bGQgYmUgZ3VhcmRlZCB3aXRoIGBuZ0Rldk1vZGVgIHNvIHRoYXQgaXQgY2FuIGJlIHRyZWUgc2hha2VuIGluIHByb2R1Y3Rpb24hIik7CiAgfQp9CmZ1bmN0aW9uIGkxOG5TdGFydEZpcnN0Q3JlYXRlUGFzcyh0VmlldywgcGFyZW50VE5vZGVJbmRleCwgbFZpZXcsIGluZGV4LCBtZXNzYWdlLCBzdWJUZW1wbGF0ZUluZGV4KSB7CiAgY29uc3Qgcm9vdFROb2RlID0gZ2V0Q3VycmVudFBhcmVudFROb2RlKCk7CiAgY29uc3QgY3JlYXRlT3BDb2RlcyA9IFtdOwogIGNvbnN0IHVwZGF0ZU9wQ29kZXMgPSBbXTsKICBjb25zdCBleGlzdGluZ1ROb2RlU3RhY2sgPSBbW11dOwogIGNvbnN0IGFzdFN0YWNrID0gW1tdXTsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBhdHRhY2hEZWJ1Z0dldHRlcihjcmVhdGVPcENvZGVzLCBpMThuQ3JlYXRlT3BDb2Rlc1RvU3RyaW5nKTsKICAgIGF0dGFjaERlYnVnR2V0dGVyKHVwZGF0ZU9wQ29kZXMsIGkxOG5VcGRhdGVPcENvZGVzVG9TdHJpbmcpOwogIH0KICBtZXNzYWdlID0gZ2V0VHJhbnNsYXRpb25Gb3JUZW1wbGF0ZShtZXNzYWdlLCBzdWJUZW1wbGF0ZUluZGV4KTsKICBjb25zdCBtc2dQYXJ0cyA9IHJlcGxhY2VOZ3NwKG1lc3NhZ2UpLnNwbGl0KFBIX1JFR0VYUCk7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtc2dQYXJ0cy5sZW5ndGg7IGkrKykgewogICAgbGV0IHZhbHVlID0gbXNnUGFydHNbaV07CiAgICBpZiAoKGkgJiAxKSA9PT0gMCkgewogICAgICBjb25zdCBwYXJ0cyA9IGkxOG5QYXJzZVRleHRJbnRvUGFydHNBbmRJQ1UodmFsdWUpOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBhcnRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgbGV0IHBhcnQgPSBwYXJ0c1tqXTsKICAgICAgICBpZiAoKGogJiAxKSA9PT0gMCkgewogICAgICAgICAgY29uc3QgdGV4dCA9IHBhcnQ7CiAgICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0U3RyaW5nKHRleHQsICJQYXJzZWQgSUNVIHBhcnQgc2hvdWxkIGJlIHN0cmluZyIpOwogICAgICAgICAgaWYgKHRleHQgIT09ICIiKSB7CiAgICAgICAgICAgIGkxOG5TdGFydEZpcnN0Q3JlYXRlUGFzc1Byb2Nlc3NUZXh0Tm9kZShhc3RTdGFja1swXSwgdFZpZXcsIHJvb3RUTm9kZSwgZXhpc3RpbmdUTm9kZVN0YWNrWzBdLCBjcmVhdGVPcENvZGVzLCB1cGRhdGVPcENvZGVzLCBsVmlldywgdGV4dCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGljdUV4cHJlc3Npb24gPSBwYXJ0OwogICAgICAgICAgaWYgKHR5cGVvZiBpY3VFeHByZXNzaW9uICE9PSAib2JqZWN0IikgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byBwYXJzZSBJQ1UgZXhwcmVzc2lvbiBpbiAiJHttZXNzYWdlfSIgbWVzc2FnZS5gKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGljdUNvbnRhaW5lclROb2RlID0gY3JlYXRlVE5vZGVBbmRBZGRPcENvZGUodFZpZXcsIHJvb3RUTm9kZSwgZXhpc3RpbmdUTm9kZVN0YWNrWzBdLCBsVmlldywgY3JlYXRlT3BDb2RlcywgbmdEZXZNb2RlID8gYElDVSAke2luZGV4fToke2ljdUV4cHJlc3Npb24ubWFpbkJpbmRpbmd9YCA6ICIiLCB0cnVlKTsKICAgICAgICAgIGNvbnN0IGljdU5vZGVJbmRleCA9IGljdUNvbnRhaW5lclROb2RlLmluZGV4OwogICAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydEdyZWF0ZXJUaGFuT3JFcXVhbChpY3VOb2RlSW5kZXgsIEhFQURFUl9PRkZTRVQsICJJbmRleCBtdXN0IGJlIGluIGFic29sdXRlIExWaWV3IG9mZnNldCIpOwogICAgICAgICAgaWN1U3RhcnQoYXN0U3RhY2tbMF0sIHRWaWV3LCBsVmlldywgdXBkYXRlT3BDb2RlcywgcGFyZW50VE5vZGVJbmRleCwgaWN1RXhwcmVzc2lvbiwgaWN1Tm9kZUluZGV4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGlzQ2xvc2luZyA9IHZhbHVlLmNoYXJDb2RlQXQoMCkgPT09IDQ3OwogICAgICBjb25zdCB0eXBlID0gdmFsdWUuY2hhckNvZGVBdChpc0Nsb3NpbmcgPyAxIDogMCk7CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRPbmVPZih0eXBlLCA0MiwgMzUpOwogICAgICBjb25zdCBpbmRleDIgPSBIRUFERVJfT0ZGU0VUICsgTnVtYmVyLnBhcnNlSW50KHZhbHVlLnN1YnN0cmluZyhpc0Nsb3NpbmcgPyAyIDogMSkpOwogICAgICBpZiAoaXNDbG9zaW5nKSB7CiAgICAgICAgZXhpc3RpbmdUTm9kZVN0YWNrLnNoaWZ0KCk7CiAgICAgICAgYXN0U3RhY2suc2hpZnQoKTsKICAgICAgICBzZXRDdXJyZW50VE5vZGUoZ2V0Q3VycmVudFBhcmVudFROb2RlKCksIGZhbHNlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB0Tm9kZSA9IGNyZWF0ZVROb2RlUGxhY2Vob2xkZXIodFZpZXcsIGV4aXN0aW5nVE5vZGVTdGFja1swXSwgaW5kZXgyKTsKICAgICAgICBleGlzdGluZ1ROb2RlU3RhY2sudW5zaGlmdChbXSk7CiAgICAgICAgc2V0Q3VycmVudFROb2RlKHROb2RlLCB0cnVlKTsKICAgICAgICBjb25zdCBwbGFjZWhvbGRlck5vZGUgPSB7CiAgICAgICAgICBraW5kOiAyLAogICAgICAgICAgaW5kZXg6IGluZGV4MiwKICAgICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICAgIHR5cGU6IHR5cGUgPT09IDM1ID8gMCA6IDEKICAgICAgICB9OwogICAgICAgIGFzdFN0YWNrWzBdLnB1c2gocGxhY2Vob2xkZXJOb2RlKTsKICAgICAgICBhc3RTdGFjay51bnNoaWZ0KHBsYWNlaG9sZGVyTm9kZS5jaGlsZHJlbik7CiAgICAgIH0KICAgIH0KICB9CiAgdFZpZXcuZGF0YVtpbmRleF0gPSB7CiAgICBjcmVhdGU6IGNyZWF0ZU9wQ29kZXMsCiAgICB1cGRhdGU6IHVwZGF0ZU9wQ29kZXMsCiAgICBhc3Q6IGFzdFN0YWNrWzBdLAogICAgcGFyZW50VE5vZGVJbmRleAogIH07Cn0KZnVuY3Rpb24gY3JlYXRlVE5vZGVBbmRBZGRPcENvZGUodFZpZXcsIHJvb3RUTm9kZSwgZXhpc3RpbmdUTm9kZXMsIGxWaWV3LCBjcmVhdGVPcENvZGVzLCB0ZXh0LCBpc0lDVSkgewogIGNvbnN0IGkxOG5Ob2RlSWR4ID0gYWxsb2NFeHBhbmRvKHRWaWV3LCBsVmlldywgMSwgbnVsbCk7CiAgbGV0IG9wQ29kZSA9IGkxOG5Ob2RlSWR4IDw8IEkxOG5DcmVhdGVPcENvZGUuU0hJRlQ7CiAgbGV0IHBhcmVudFROb2RlID0gZ2V0Q3VycmVudFBhcmVudFROb2RlKCk7CiAgaWYgKHJvb3RUTm9kZSA9PT0gcGFyZW50VE5vZGUpIHsKICAgIHBhcmVudFROb2RlID0gbnVsbDsKICB9CiAgaWYgKHBhcmVudFROb2RlID09PSBudWxsKSB7CiAgICBvcENvZGUgfD0gSTE4bkNyZWF0ZU9wQ29kZS5BUFBFTkRfRUFHRVJMWTsKICB9CiAgaWYgKGlzSUNVKSB7CiAgICBvcENvZGUgfD0gSTE4bkNyZWF0ZU9wQ29kZS5DT01NRU5UOwogICAgZW5zdXJlSWN1Q29udGFpbmVyVmlzaXRvckxvYWRlZChsb2FkSWN1Q29udGFpbmVyVmlzaXRvcik7CiAgfQogIGNyZWF0ZU9wQ29kZXMucHVzaChvcENvZGUsIHRleHQgPT09IG51bGwgPyAiIiA6IHRleHQpOwogIGNvbnN0IHROb2RlID0gY3JlYXRlVE5vZGVBdEluZGV4KHRWaWV3LCBpMThuTm9kZUlkeCwgaXNJQ1UgPyAzMiA6IDEsIHRleHQgPT09IG51bGwgPyBuZ0Rldk1vZGUgPyAie3s/fX0iIDogIiIgOiB0ZXh0LCBudWxsKTsKICBhZGRUTm9kZUFuZFVwZGF0ZUluc2VydEJlZm9yZUluZGV4KGV4aXN0aW5nVE5vZGVzLCB0Tm9kZSk7CiAgY29uc3QgdE5vZGVJZHggPSB0Tm9kZS5pbmRleDsKICBzZXRDdXJyZW50VE5vZGUodE5vZGUsIGZhbHNlKTsKICBpZiAocGFyZW50VE5vZGUgIT09IG51bGwgJiYgcm9vdFROb2RlICE9PSBwYXJlbnRUTm9kZSkgewogICAgc2V0VE5vZGVJbnNlcnRCZWZvcmVJbmRleChwYXJlbnRUTm9kZSwgdE5vZGVJZHgpOwogIH0KICByZXR1cm4gdE5vZGU7Cn0KZnVuY3Rpb24gaTE4blN0YXJ0Rmlyc3RDcmVhdGVQYXNzUHJvY2Vzc1RleHROb2RlKGFzdCwgdFZpZXcsIHJvb3RUTm9kZSwgZXhpc3RpbmdUTm9kZXMsIGNyZWF0ZU9wQ29kZXMsIHVwZGF0ZU9wQ29kZXMsIGxWaWV3LCB0ZXh0KSB7CiAgY29uc3QgaGFzQmluZGluZyA9IHRleHQubWF0Y2goQklORElOR19SRUdFWFApOwogIGNvbnN0IHROb2RlID0gY3JlYXRlVE5vZGVBbmRBZGRPcENvZGUodFZpZXcsIHJvb3RUTm9kZSwgZXhpc3RpbmdUTm9kZXMsIGxWaWV3LCBjcmVhdGVPcENvZGVzLCBoYXNCaW5kaW5nID8gbnVsbCA6IHRleHQsIGZhbHNlKTsKICBjb25zdCBpbmRleCA9IHROb2RlLmluZGV4OwogIGlmIChoYXNCaW5kaW5nKSB7CiAgICBnZW5lcmF0ZUJpbmRpbmdVcGRhdGVPcENvZGVzKHVwZGF0ZU9wQ29kZXMsIHRleHQsIGluZGV4LCBudWxsLCAwLCBudWxsKTsKICB9CiAgYXN0LnB1c2goewogICAga2luZDogMCwKICAgIGluZGV4CiAgfSk7Cn0KZnVuY3Rpb24gaTE4bkF0dHJpYnV0ZXNGaXJzdFBhc3ModFZpZXcsIGluZGV4LCB2YWx1ZXMpIHsKICBjb25zdCBwcmV2aW91c0VsZW1lbnQgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBjb25zdCBwcmV2aW91c0VsZW1lbnRJbmRleCA9IHByZXZpb3VzRWxlbWVudC5pbmRleDsKICBjb25zdCB1cGRhdGVPcENvZGVzID0gW107CiAgaWYgKG5nRGV2TW9kZSkgewogICAgYXR0YWNoRGVidWdHZXR0ZXIodXBkYXRlT3BDb2RlcywgaTE4blVwZGF0ZU9wQ29kZXNUb1N0cmluZyk7CiAgfQogIGlmICh0Vmlldy5maXJzdENyZWF0ZVBhc3MgJiYgdFZpZXcuZGF0YVtpbmRleF0gPT09IG51bGwpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgIGNvbnN0IGF0dHJOYW1lID0gdmFsdWVzW2ldOwogICAgICBjb25zdCBtZXNzYWdlID0gdmFsdWVzW2kgKyAxXTsKICAgICAgaWYgKG1lc3NhZ2UgIT09ICIiKSB7CiAgICAgICAgaWYgKElDVV9SRUdFWFAudGVzdChtZXNzYWdlKSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJQ1UgZXhwcmVzc2lvbnMgYXJlIG5vdCBzdXBwb3J0ZWQgaW4gYXR0cmlidXRlcy4gTWVzc2FnZTogIiR7bWVzc2FnZX0iLmApOwogICAgICAgIH0KICAgICAgICBnZW5lcmF0ZUJpbmRpbmdVcGRhdGVPcENvZGVzKHVwZGF0ZU9wQ29kZXMsIG1lc3NhZ2UsIHByZXZpb3VzRWxlbWVudEluZGV4LCBhdHRyTmFtZSwgY291bnRCaW5kaW5ncyh1cGRhdGVPcENvZGVzKSwgbnVsbCk7CiAgICAgIH0KICAgIH0KICAgIHRWaWV3LmRhdGFbaW5kZXhdID0gdXBkYXRlT3BDb2RlczsKICB9Cn0KZnVuY3Rpb24gZ2VuZXJhdGVCaW5kaW5nVXBkYXRlT3BDb2Rlcyh1cGRhdGVPcENvZGVzLCBzdHIsIGRlc3RpbmF0aW9uTm9kZSwgYXR0ck5hbWUsIGJpbmRpbmdTdGFydCwgc2FuaXRpemVGbikgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRHcmVhdGVyVGhhbk9yRXF1YWwoZGVzdGluYXRpb25Ob2RlLCBIRUFERVJfT0ZGU0VULCAiSW5kZXggbXVzdCBiZSBpbiBhYnNvbHV0ZSBMVmlldyBvZmZzZXQiKTsKICBjb25zdCBtYXNrSW5kZXggPSB1cGRhdGVPcENvZGVzLmxlbmd0aDsKICBjb25zdCBzaXplSW5kZXggPSBtYXNrSW5kZXggKyAxOwogIHVwZGF0ZU9wQ29kZXMucHVzaChudWxsLCBudWxsKTsKICBjb25zdCBzdGFydEluZGV4ID0gbWFza0luZGV4ICsgMjsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBhdHRhY2hEZWJ1Z0dldHRlcih1cGRhdGVPcENvZGVzLCBpMThuVXBkYXRlT3BDb2Rlc1RvU3RyaW5nKTsKICB9CiAgY29uc3QgdGV4dFBhcnRzID0gc3RyLnNwbGl0KEJJTkRJTkdfUkVHRVhQKTsKICBsZXQgbWFzayA9IDA7CiAgZm9yIChsZXQgaiA9IDA7IGogPCB0ZXh0UGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGNvbnN0IHRleHRWYWx1ZSA9IHRleHRQYXJ0c1tqXTsKICAgIGlmIChqICYgMSkgewogICAgICBjb25zdCBiaW5kaW5nSW5kZXggPSBiaW5kaW5nU3RhcnQgKyBwYXJzZUludCh0ZXh0VmFsdWUsIDEwKTsKICAgICAgdXBkYXRlT3BDb2Rlcy5wdXNoKC0xIC0gYmluZGluZ0luZGV4KTsKICAgICAgbWFzayA9IG1hc2sgfCB0b01hc2tCaXQoYmluZGluZ0luZGV4KTsKICAgIH0gZWxzZSBpZiAodGV4dFZhbHVlICE9PSAiIikgewogICAgICB1cGRhdGVPcENvZGVzLnB1c2godGV4dFZhbHVlKTsKICAgIH0KICB9CiAgdXBkYXRlT3BDb2Rlcy5wdXNoKGRlc3RpbmF0aW9uTm9kZSA8PCAyIHwgKGF0dHJOYW1lID8gMSA6IDApKTsKICBpZiAoYXR0ck5hbWUpIHsKICAgIHVwZGF0ZU9wQ29kZXMucHVzaChhdHRyTmFtZSwgc2FuaXRpemVGbik7CiAgfQogIHVwZGF0ZU9wQ29kZXNbbWFza0luZGV4XSA9IG1hc2s7CiAgdXBkYXRlT3BDb2Rlc1tzaXplSW5kZXhdID0gdXBkYXRlT3BDb2Rlcy5sZW5ndGggLSBzdGFydEluZGV4OwogIHJldHVybiBtYXNrOwp9CmZ1bmN0aW9uIGNvdW50QmluZGluZ3Mob3BDb2RlcykgewogIGxldCBjb3VudDIgPSAwOwogIGZvciAobGV0IGkgPSAwOyBpIDwgb3BDb2Rlcy5sZW5ndGg7IGkrKykgewogICAgY29uc3Qgb3BDb2RlID0gb3BDb2Rlc1tpXTsKICAgIGlmICh0eXBlb2Ygb3BDb2RlID09PSAibnVtYmVyIiAmJiBvcENvZGUgPCAwKSB7CiAgICAgIGNvdW50MisrOwogICAgfQogIH0KICByZXR1cm4gY291bnQyOwp9CmZ1bmN0aW9uIHRvTWFza0JpdChiaW5kaW5nSW5kZXgpIHsKICByZXR1cm4gMSA8PCBNYXRoLm1pbihiaW5kaW5nSW5kZXgsIDMxKTsKfQpmdW5jdGlvbiByZW1vdmVJbm5lclRlbXBsYXRlVHJhbnNsYXRpb24obWVzc2FnZSkgewogIGxldCBtYXRjaDsKICBsZXQgcmVzID0gIiI7CiAgbGV0IGluZGV4ID0gMDsKICBsZXQgaW5UZW1wbGF0ZSA9IGZhbHNlOwogIGxldCB0YWdNYXRjaGVkOwogIHdoaWxlICgobWF0Y2ggPSBTVUJURU1QTEFURV9SRUdFWFAuZXhlYyhtZXNzYWdlKSkgIT09IG51bGwpIHsKICAgIGlmICghaW5UZW1wbGF0ZSkgewogICAgICByZXMgKz0gbWVzc2FnZS5zdWJzdHJpbmcoaW5kZXgsIG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoKTsKICAgICAgdGFnTWF0Y2hlZCA9IG1hdGNoWzFdOwogICAgICBpblRlbXBsYXRlID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChtYXRjaFswXSA9PT0gYCR7TUFSS0VSfS8qJHt0YWdNYXRjaGVkfSR7TUFSS0VSfWApIHsKICAgICAgICBpbmRleCA9IG1hdGNoLmluZGV4OwogICAgICAgIGluVGVtcGxhdGUgPSBmYWxzZTsKICAgICAgfQogICAgfQogIH0KICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwoaW5UZW1wbGF0ZSwgZmFsc2UsIGBUYWcgbWlzbWF0Y2g6IHVuYWJsZSB0byBmaW5kIHRoZSBlbmQgb2YgdGhlIHN1Yi10ZW1wbGF0ZSBpbiB0aGUgdHJhbnNsYXRpb24gIiR7bWVzc2FnZX0iYCk7CiAgcmVzICs9IG1lc3NhZ2Uuc2xpY2UoaW5kZXgpOwogIHJldHVybiByZXM7Cn0KZnVuY3Rpb24gZ2V0VHJhbnNsYXRpb25Gb3JUZW1wbGF0ZShtZXNzYWdlLCBzdWJUZW1wbGF0ZUluZGV4KSB7CiAgaWYgKGlzUm9vdFRlbXBsYXRlTWVzc2FnZShzdWJUZW1wbGF0ZUluZGV4KSkgewogICAgcmV0dXJuIHJlbW92ZUlubmVyVGVtcGxhdGVUcmFuc2xhdGlvbihtZXNzYWdlKTsKICB9IGVsc2UgewogICAgY29uc3Qgc3RhcnQgPSBtZXNzYWdlLmluZGV4T2YoYDoke3N1YlRlbXBsYXRlSW5kZXh9JHtNQVJLRVJ9YCkgKyAyICsgc3ViVGVtcGxhdGVJbmRleC50b1N0cmluZygpLmxlbmd0aDsKICAgIGNvbnN0IGVuZCA9IG1lc3NhZ2Uuc2VhcmNoKG5ldyBSZWdFeHAoYCR7TUFSS0VSfVxcL1xcKlxcZCs6JHtzdWJUZW1wbGF0ZUluZGV4fSR7TUFSS0VSfWApKTsKICAgIHJldHVybiByZW1vdmVJbm5lclRlbXBsYXRlVHJhbnNsYXRpb24obWVzc2FnZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCkpOwogIH0KfQpmdW5jdGlvbiBpY3VTdGFydChhc3QsIHRWaWV3LCBsVmlldywgdXBkYXRlT3BDb2RlcywgcGFyZW50SWR4LCBpY3VFeHByZXNzaW9uLCBhbmNob3JJZHgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChpY3VFeHByZXNzaW9uLCAiSUNVIGV4cHJlc3Npb24gbXVzdCBiZSBkZWZpbmVkIik7CiAgbGV0IGJpbmRpbmdNYXNrID0gMDsKICBjb25zdCB0SWN1ID0gewogICAgdHlwZTogaWN1RXhwcmVzc2lvbi50eXBlLAogICAgY3VycmVudENhc2VMVmlld0luZGV4OiBhbGxvY0V4cGFuZG8odFZpZXcsIGxWaWV3LCAxLCBudWxsKSwKICAgIGFuY2hvcklkeCwKICAgIGNhc2VzOiBbXSwKICAgIGNyZWF0ZTogW10sCiAgICByZW1vdmU6IFtdLAogICAgdXBkYXRlOiBbXQogIH07CiAgYWRkVXBkYXRlSWN1U3dpdGNoKHVwZGF0ZU9wQ29kZXMsIGljdUV4cHJlc3Npb24sIGFuY2hvcklkeCk7CiAgc2V0VEljdSh0VmlldywgYW5jaG9ySWR4LCB0SWN1KTsKICBjb25zdCB2YWx1ZXMgPSBpY3VFeHByZXNzaW9uLnZhbHVlczsKICBjb25zdCBjYXNlcyA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCB2YWx1ZUFyciA9IHZhbHVlc1tpXTsKICAgIGNvbnN0IG5lc3RlZEljdXMgPSBbXTsKICAgIGZvciAobGV0IGogPSAwOyBqIDwgdmFsdWVBcnIubGVuZ3RoOyBqKyspIHsKICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZUFycltqXTsKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gInN0cmluZyIpIHsKICAgICAgICBjb25zdCBpY3VJbmRleCA9IG5lc3RlZEljdXMucHVzaCh2YWx1ZSkgLSAxOwogICAgICAgIHZhbHVlQXJyW2pdID0gYDwhLS3vv70ke2ljdUluZGV4fe+/vS0tPmA7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGNhc2VBc3QgPSBbXTsKICAgIGNhc2VzLnB1c2goY2FzZUFzdCk7CiAgICBiaW5kaW5nTWFzayA9IHBhcnNlSWN1Q2FzZShjYXNlQXN0LCB0VmlldywgdEljdSwgbFZpZXcsIHVwZGF0ZU9wQ29kZXMsIHBhcmVudElkeCwgaWN1RXhwcmVzc2lvbi5jYXNlc1tpXSwgdmFsdWVBcnIuam9pbigiIiksIG5lc3RlZEljdXMpIHwgYmluZGluZ01hc2s7CiAgfQogIGlmIChiaW5kaW5nTWFzaykgewogICAgYWRkVXBkYXRlSWN1VXBkYXRlKHVwZGF0ZU9wQ29kZXMsIGJpbmRpbmdNYXNrLCBhbmNob3JJZHgpOwogIH0KICBhc3QucHVzaCh7CiAgICBraW5kOiAzLAogICAgaW5kZXg6IGFuY2hvcklkeCwKICAgIGNhc2VzLAogICAgY3VycmVudENhc2VMVmlld0luZGV4OiB0SWN1LmN1cnJlbnRDYXNlTFZpZXdJbmRleAogIH0pOwp9CmZ1bmN0aW9uIHBhcnNlSUNVQmxvY2socGF0dGVybikgewogIGNvbnN0IGNhc2VzID0gW107CiAgY29uc3QgdmFsdWVzID0gW107CiAgbGV0IGljdVR5cGUgPSAxOwogIGxldCBtYWluQmluZGluZyA9IDA7CiAgcGF0dGVybiA9IHBhdHRlcm4ucmVwbGFjZShJQ1VfQkxPQ0tfUkVHRVhQLCBmdW5jdGlvbihzdHIsIGJpbmRpbmcsIHR5cGUpIHsKICAgIGlmICh0eXBlID09PSAic2VsZWN0IikgewogICAgICBpY3VUeXBlID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGljdVR5cGUgPSAxOwogICAgfQogICAgbWFpbkJpbmRpbmcgPSBwYXJzZUludChiaW5kaW5nLnNsaWNlKDEpLCAxMCk7CiAgICByZXR1cm4gIiI7CiAgfSk7CiAgY29uc3QgcGFydHMgPSBpMThuUGFyc2VUZXh0SW50b1BhcnRzQW5kSUNVKHBhdHRlcm4pOwogIGZvciAobGV0IHBvcyA9IDA7IHBvcyA8IHBhcnRzLmxlbmd0aDsgKSB7CiAgICBsZXQga2V5ID0gcGFydHNbcG9zKytdLnRyaW0oKTsKICAgIGlmIChpY3VUeXBlID09PSAxKSB7CiAgICAgIGtleSA9IGtleS5yZXBsYWNlKC9ccyooPzo9KT8oXHcrKVxzKi8sICIkMSIpOwogICAgfQogICAgaWYgKGtleS5sZW5ndGgpIHsKICAgICAgY2FzZXMucHVzaChrZXkpOwogICAgfQogICAgY29uc3QgYmxvY2tzID0gaTE4blBhcnNlVGV4dEludG9QYXJ0c0FuZElDVShwYXJ0c1twb3MrK10pOwogICAgaWYgKGNhc2VzLmxlbmd0aCA+IHZhbHVlcy5sZW5ndGgpIHsKICAgICAgdmFsdWVzLnB1c2goYmxvY2tzKTsKICAgIH0KICB9CiAgcmV0dXJuIHsKICAgIHR5cGU6IGljdVR5cGUsCiAgICBtYWluQmluZGluZywKICAgIGNhc2VzLAogICAgdmFsdWVzCiAgfTsKfQpmdW5jdGlvbiBpMThuUGFyc2VUZXh0SW50b1BhcnRzQW5kSUNVKHBhdHRlcm4pIHsKICBpZiAoIXBhdHRlcm4pIHsKICAgIHJldHVybiBbXTsKICB9CiAgbGV0IHByZXZQb3MgPSAwOwogIGNvbnN0IGJyYWNlU3RhY2sgPSBbXTsKICBjb25zdCByZXN1bHRzID0gW107CiAgY29uc3QgYnJhY2VzID0gL1t7fV0vZzsKICBicmFjZXMubGFzdEluZGV4ID0gMDsKICBsZXQgbWF0Y2g7CiAgd2hpbGUgKG1hdGNoID0gYnJhY2VzLmV4ZWMocGF0dGVybikpIHsKICAgIGNvbnN0IHBvcyA9IG1hdGNoLmluZGV4OwogICAgaWYgKG1hdGNoWzBdID09ICJ9IikgewogICAgICBicmFjZVN0YWNrLnBvcCgpOwogICAgICBpZiAoYnJhY2VTdGFjay5sZW5ndGggPT0gMCkgewogICAgICAgIGNvbnN0IGJsb2NrID0gcGF0dGVybi5zdWJzdHJpbmcocHJldlBvcywgcG9zKTsKICAgICAgICBpZiAoSUNVX0JMT0NLX1JFR0VYUC50ZXN0KGJsb2NrKSkgewogICAgICAgICAgcmVzdWx0cy5wdXNoKHBhcnNlSUNVQmxvY2soYmxvY2spKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0cy5wdXNoKGJsb2NrKTsKICAgICAgICB9CiAgICAgICAgcHJldlBvcyA9IHBvcyArIDE7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChicmFjZVN0YWNrLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgY29uc3Qgc3Vic3RyaW5nMiA9IHBhdHRlcm4uc3Vic3RyaW5nKHByZXZQb3MsIHBvcyk7CiAgICAgICAgcmVzdWx0cy5wdXNoKHN1YnN0cmluZzIpOwogICAgICAgIHByZXZQb3MgPSBwb3MgKyAxOwogICAgICB9CiAgICAgIGJyYWNlU3RhY2sucHVzaCgieyIpOwogICAgfQogIH0KICBjb25zdCBzdWJzdHJpbmcgPSBwYXR0ZXJuLnN1YnN0cmluZyhwcmV2UG9zKTsKICByZXN1bHRzLnB1c2goc3Vic3RyaW5nKTsKICByZXR1cm4gcmVzdWx0czsKfQpmdW5jdGlvbiBwYXJzZUljdUNhc2UoYXN0LCB0VmlldywgdEljdSwgbFZpZXcsIHVwZGF0ZU9wQ29kZXMsIHBhcmVudElkeCwgY2FzZU5hbWUsIHVuc2FmZUNhc2VIdG1sLCBuZXN0ZWRJY3VzKSB7CiAgY29uc3QgY3JlYXRlID0gW107CiAgY29uc3QgcmVtb3ZlMiA9IFtdOwogIGNvbnN0IHVwZGF0ZSA9IFtdOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIGF0dGFjaERlYnVnR2V0dGVyKGNyZWF0ZSwgaWN1Q3JlYXRlT3BDb2Rlc1RvU3RyaW5nKTsKICAgIGF0dGFjaERlYnVnR2V0dGVyKHJlbW92ZTIsIGkxOG5SZW1vdmVPcENvZGVzVG9TdHJpbmcpOwogICAgYXR0YWNoRGVidWdHZXR0ZXIodXBkYXRlLCBpMThuVXBkYXRlT3BDb2Rlc1RvU3RyaW5nKTsKICB9CiAgdEljdS5jYXNlcy5wdXNoKGNhc2VOYW1lKTsKICB0SWN1LmNyZWF0ZS5wdXNoKGNyZWF0ZSk7CiAgdEljdS5yZW1vdmUucHVzaChyZW1vdmUyKTsKICB0SWN1LnVwZGF0ZS5wdXNoKHVwZGF0ZSk7CiAgY29uc3QgaW5lcnRCb2R5SGVscGVyMiA9IGdldEluZXJ0Qm9keUhlbHBlcihnZXREb2N1bWVudCgpKTsKICBjb25zdCBpbmVydEJvZHlFbGVtZW50ID0gaW5lcnRCb2R5SGVscGVyMi5nZXRJbmVydEJvZHlFbGVtZW50KHVuc2FmZUNhc2VIdG1sKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChpbmVydEJvZHlFbGVtZW50LCAiVW5hYmxlIHRvIGdlbmVyYXRlIGluZXJ0IGJvZHkgZWxlbWVudCIpOwogIGNvbnN0IGluZXJ0Um9vdE5vZGUgPSBnZXRUZW1wbGF0ZUNvbnRlbnQoaW5lcnRCb2R5RWxlbWVudCkgfHwgaW5lcnRCb2R5RWxlbWVudDsKICBpZiAoaW5lcnRSb290Tm9kZSkgewogICAgcmV0dXJuIHdhbGtJY3VUcmVlKGFzdCwgdFZpZXcsIHRJY3UsIGxWaWV3LCB1cGRhdGVPcENvZGVzLCBjcmVhdGUsIHJlbW92ZTIsIHVwZGF0ZSwgaW5lcnRSb290Tm9kZSwgcGFyZW50SWR4LCBuZXN0ZWRJY3VzLCAwKTsKICB9IGVsc2UgewogICAgcmV0dXJuIDA7CiAgfQp9CmZ1bmN0aW9uIHdhbGtJY3VUcmVlKGFzdCwgdFZpZXcsIHRJY3UsIGxWaWV3LCBzaGFyZWRVcGRhdGVPcENvZGVzLCBjcmVhdGUsIHJlbW92ZTIsIHVwZGF0ZSwgcGFyZW50Tm9kZSwgcGFyZW50SWR4LCBuZXN0ZWRJY3VzLCBkZXB0aCkgewogIGxldCBiaW5kaW5nTWFzayA9IDA7CiAgbGV0IGN1cnJlbnROb2RlID0gcGFyZW50Tm9kZS5maXJzdENoaWxkOwogIHdoaWxlIChjdXJyZW50Tm9kZSkgewogICAgY29uc3QgbmV3SW5kZXggPSBhbGxvY0V4cGFuZG8odFZpZXcsIGxWaWV3LCAxLCBudWxsKTsKICAgIHN3aXRjaCAoY3VycmVudE5vZGUubm9kZVR5cGUpIHsKICAgICAgY2FzZSBOb2RlLkVMRU1FTlRfTk9ERToKICAgICAgICBjb25zdCBlbGVtZW50ID0gY3VycmVudE5vZGU7CiAgICAgICAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGlmIChWQUxJRF9FTEVNRU5UUy5oYXNPd25Qcm9wZXJ0eSh0YWdOYW1lKSkgewogICAgICAgICAgYWRkQ3JlYXRlTm9kZUFuZEFwcGVuZChjcmVhdGUsIEVMRU1FTlRfTUFSS0VSLCB0YWdOYW1lLCBwYXJlbnRJZHgsIG5ld0luZGV4KTsKICAgICAgICAgIHRWaWV3LmRhdGFbbmV3SW5kZXhdID0gdGFnTmFtZTsKICAgICAgICAgIGNvbnN0IGVsQXR0cnMgPSBlbGVtZW50LmF0dHJpYnV0ZXM7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsQXR0cnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgYXR0ciA9IGVsQXR0cnMuaXRlbShpKTsKICAgICAgICAgICAgY29uc3QgbG93ZXJBdHRyTmFtZSA9IGF0dHIubmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICBjb25zdCBoYXNCaW5kaW5nMiA9ICEhYXR0ci52YWx1ZS5tYXRjaChCSU5ESU5HX1JFR0VYUCk7CiAgICAgICAgICAgIGlmIChoYXNCaW5kaW5nMikgewogICAgICAgICAgICAgIGlmIChWQUxJRF9BVFRSUy5oYXNPd25Qcm9wZXJ0eShsb3dlckF0dHJOYW1lKSkgewogICAgICAgICAgICAgICAgaWYgKFVSSV9BVFRSU1tsb3dlckF0dHJOYW1lXSkgewogICAgICAgICAgICAgICAgICBnZW5lcmF0ZUJpbmRpbmdVcGRhdGVPcENvZGVzKHVwZGF0ZSwgYXR0ci52YWx1ZSwgbmV3SW5kZXgsIGF0dHIubmFtZSwgMCwgX3Nhbml0aXplVXJsKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGdlbmVyYXRlQmluZGluZ1VwZGF0ZU9wQ29kZXModXBkYXRlLCBhdHRyLnZhbHVlLCBuZXdJbmRleCwgYXR0ci5uYW1lLCAwLCBudWxsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmdEZXZNb2RlICYmIGNvbnNvbGUud2FybihgV0FSTklORzogaWdub3JpbmcgdW5zYWZlIGF0dHJpYnV0ZSB2YWx1ZSAke2xvd2VyQXR0ck5hbWV9IG9uIGVsZW1lbnQgJHt0YWdOYW1lfSAoc2VlICR7WFNTX1NFQ1VSSVRZX1VSTH0pYCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGFkZENyZWF0ZUF0dHJpYnV0ZShjcmVhdGUsIG5ld0luZGV4LCBhdHRyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc3QgZWxlbWVudE5vZGUgPSB7CiAgICAgICAgICAgIGtpbmQ6IDEsCiAgICAgICAgICAgIGluZGV4OiBuZXdJbmRleCwKICAgICAgICAgICAgY2hpbGRyZW46IFtdCiAgICAgICAgICB9OwogICAgICAgICAgYXN0LnB1c2goZWxlbWVudE5vZGUpOwogICAgICAgICAgYmluZGluZ01hc2sgPSB3YWxrSWN1VHJlZShlbGVtZW50Tm9kZS5jaGlsZHJlbiwgdFZpZXcsIHRJY3UsIGxWaWV3LCBzaGFyZWRVcGRhdGVPcENvZGVzLCBjcmVhdGUsIHJlbW92ZTIsIHVwZGF0ZSwgY3VycmVudE5vZGUsIG5ld0luZGV4LCBuZXN0ZWRJY3VzLCBkZXB0aCArIDEpIHwgYmluZGluZ01hc2s7CiAgICAgICAgICBhZGRSZW1vdmVOb2RlKHJlbW92ZTIsIG5ld0luZGV4LCBkZXB0aCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIE5vZGUuVEVYVF9OT0RFOgogICAgICAgIGNvbnN0IHZhbHVlID0gY3VycmVudE5vZGUudGV4dENvbnRlbnQgfHwgIiI7CiAgICAgICAgY29uc3QgaGFzQmluZGluZyA9IHZhbHVlLm1hdGNoKEJJTkRJTkdfUkVHRVhQKTsKICAgICAgICBhZGRDcmVhdGVOb2RlQW5kQXBwZW5kKGNyZWF0ZSwgbnVsbCwgaGFzQmluZGluZyA/ICIiIDogdmFsdWUsIHBhcmVudElkeCwgbmV3SW5kZXgpOwogICAgICAgIGFkZFJlbW92ZU5vZGUocmVtb3ZlMiwgbmV3SW5kZXgsIGRlcHRoKTsKICAgICAgICBpZiAoaGFzQmluZGluZykgewogICAgICAgICAgYmluZGluZ01hc2sgPSBnZW5lcmF0ZUJpbmRpbmdVcGRhdGVPcENvZGVzKHVwZGF0ZSwgdmFsdWUsIG5ld0luZGV4LCBudWxsLCAwLCBudWxsKSB8IGJpbmRpbmdNYXNrOwogICAgICAgIH0KICAgICAgICBhc3QucHVzaCh7CiAgICAgICAgICBraW5kOiAwLAogICAgICAgICAgaW5kZXg6IG5ld0luZGV4CiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgTm9kZS5DT01NRU5UX05PREU6CiAgICAgICAgY29uc3QgaXNOZXN0ZWRJY3UgPSBORVNURURfSUNVLmV4ZWMoY3VycmVudE5vZGUudGV4dENvbnRlbnQgfHwgIiIpOwogICAgICAgIGlmIChpc05lc3RlZEljdSkgewogICAgICAgICAgY29uc3QgbmVzdGVkSWN1SW5kZXggPSBwYXJzZUludChpc05lc3RlZEljdVsxXSwgMTApOwogICAgICAgICAgY29uc3QgaWN1RXhwcmVzc2lvbiA9IG5lc3RlZEljdXNbbmVzdGVkSWN1SW5kZXhdOwogICAgICAgICAgYWRkQ3JlYXRlTm9kZUFuZEFwcGVuZChjcmVhdGUsIElDVV9NQVJLRVIsIG5nRGV2TW9kZSA/IGBuZXN0ZWQgSUNVICR7bmVzdGVkSWN1SW5kZXh9YCA6ICIiLCBwYXJlbnRJZHgsIG5ld0luZGV4KTsKICAgICAgICAgIGljdVN0YXJ0KGFzdCwgdFZpZXcsIGxWaWV3LCBzaGFyZWRVcGRhdGVPcENvZGVzLCBwYXJlbnRJZHgsIGljdUV4cHJlc3Npb24sIG5ld0luZGV4KTsKICAgICAgICAgIGFkZFJlbW92ZU5lc3RlZEljdShyZW1vdmUyLCBuZXdJbmRleCwgZGVwdGgpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIH0KICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dFNpYmxpbmc7CiAgfQogIHJldHVybiBiaW5kaW5nTWFzazsKfQpmdW5jdGlvbiBhZGRSZW1vdmVOb2RlKHJlbW92ZTIsIGluZGV4LCBkZXB0aCkgewogIGlmIChkZXB0aCA9PT0gMCkgewogICAgcmVtb3ZlMi5wdXNoKGluZGV4KTsKICB9Cn0KZnVuY3Rpb24gYWRkUmVtb3ZlTmVzdGVkSWN1KHJlbW92ZTIsIGluZGV4LCBkZXB0aCkgewogIGlmIChkZXB0aCA9PT0gMCkgewogICAgcmVtb3ZlMi5wdXNoKH5pbmRleCk7CiAgICByZW1vdmUyLnB1c2goaW5kZXgpOwogIH0KfQpmdW5jdGlvbiBhZGRVcGRhdGVJY3VTd2l0Y2godXBkYXRlLCBpY3VFeHByZXNzaW9uLCBpbmRleCkgewogIHVwZGF0ZS5wdXNoKHRvTWFza0JpdChpY3VFeHByZXNzaW9uLm1haW5CaW5kaW5nKSwgMiwgLTEgLSBpY3VFeHByZXNzaW9uLm1haW5CaW5kaW5nLCBpbmRleCA8PCAyIHwgMik7Cn0KZnVuY3Rpb24gYWRkVXBkYXRlSWN1VXBkYXRlKHVwZGF0ZSwgYmluZGluZ01hc2ssIGluZGV4KSB7CiAgdXBkYXRlLnB1c2goYmluZGluZ01hc2ssIDEsIGluZGV4IDw8IDIgfCAzKTsKfQpmdW5jdGlvbiBhZGRDcmVhdGVOb2RlQW5kQXBwZW5kKGNyZWF0ZSwgbWFya2VyLCB0ZXh0LCBhcHBlbmRUb1BhcmVudElkeCwgY3JlYXRlQXRJZHgpIHsKICBpZiAobWFya2VyICE9PSBudWxsKSB7CiAgICBjcmVhdGUucHVzaChtYXJrZXIpOwogIH0KICBjcmVhdGUucHVzaCh0ZXh0LCBjcmVhdGVBdElkeCwgaWN1Q3JlYXRlT3BDb2RlKDAsIGFwcGVuZFRvUGFyZW50SWR4LCBjcmVhdGVBdElkeCkpOwp9CmZ1bmN0aW9uIGFkZENyZWF0ZUF0dHJpYnV0ZShjcmVhdGUsIG5ld0luZGV4LCBhdHRyKSB7CiAgY3JlYXRlLnB1c2gobmV3SW5kZXggPDwgMSB8IDEsIGF0dHIubmFtZSwgYXR0ci52YWx1ZSk7Cn0KdmFyIFJPT1RfVEVNUExBVEVfSUQgPSAwOwp2YXIgUFBfTVVMVElfVkFMVUVfUExBQ0VIT0xERVJTX1JFR0VYUCA9IC9cWyjvv70uKz/vv70/KVxdLzsKdmFyIFBQX1BMQUNFSE9MREVSU19SRUdFWFAgPSAvXFso77+9Lis/77+9PylcXXwo77+9XC8/XCpcZCs6XGQr77+9KS9nOwp2YXIgUFBfSUNVX1ZBUlNfUkVHRVhQID0gLyh7XHMqKShWQVJfKFBMVVJBTHxTRUxFQ1QpKF9cZCspPykoXHMqLCkvZzsKdmFyIFBQX0lDVV9QTEFDRUhPTERFUlNfUkVHRVhQID0gL3soW0EtWjAtOV9dKyl9L2c7CnZhciBQUF9JQ1VTX1JFR0VYUCA9IC/vv71JMThOX0VYUF8oSUNVKF9cZCspPynvv70vZzsKdmFyIFBQX0NMT1NFX1RFTVBMQVRFX1JFR0VYUCA9IC9cL1wqLzsKdmFyIFBQX1RFTVBMQVRFX0lEX1JFR0VYUCA9IC9cZCtcOihcZCspLzsKZnVuY3Rpb24gaTE4blBvc3Rwcm9jZXNzKG1lc3NhZ2UsIHJlcGxhY2VtZW50cyA9IHt9KSB7CiAgbGV0IHJlc3VsdCA9IG1lc3NhZ2U7CiAgaWYgKFBQX01VTFRJX1ZBTFVFX1BMQUNFSE9MREVSU19SRUdFWFAudGVzdChtZXNzYWdlKSkgewogICAgY29uc3QgbWF0Y2hlcyA9IHt9OwogICAgY29uc3QgdGVtcGxhdGVJZHNTdGFjayA9IFtST09UX1RFTVBMQVRFX0lEXTsKICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKFBQX1BMQUNFSE9MREVSU19SRUdFWFAsIChtLCBwaHMsIHRtcGwpID0+IHsKICAgICAgY29uc3QgY29udGVudCA9IHBocyB8fCB0bXBsOwogICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBtYXRjaGVzW2NvbnRlbnRdIHx8IFtdOwogICAgICBpZiAoIXBsYWNlaG9sZGVycy5sZW5ndGgpIHsKICAgICAgICBjb250ZW50LnNwbGl0KCJ8IikuZm9yRWFjaCgocGxhY2Vob2xkZXIyKSA9PiB7CiAgICAgICAgICBjb25zdCBtYXRjaCA9IHBsYWNlaG9sZGVyMi5tYXRjaChQUF9URU1QTEFURV9JRF9SRUdFWFApOwogICAgICAgICAgY29uc3QgdGVtcGxhdGVJZDIgPSBtYXRjaCA/IHBhcnNlSW50KG1hdGNoWzFdLCAxMCkgOiBST09UX1RFTVBMQVRFX0lEOwogICAgICAgICAgY29uc3QgaXNDbG9zZVRlbXBsYXRlVGFnMiA9IFBQX0NMT1NFX1RFTVBMQVRFX1JFR0VYUC50ZXN0KHBsYWNlaG9sZGVyMik7CiAgICAgICAgICBwbGFjZWhvbGRlcnMucHVzaChbdGVtcGxhdGVJZDIsIGlzQ2xvc2VUZW1wbGF0ZVRhZzIsIHBsYWNlaG9sZGVyMl0pOwogICAgICAgIH0pOwogICAgICAgIG1hdGNoZXNbY29udGVudF0gPSBwbGFjZWhvbGRlcnM7CiAgICAgIH0KICAgICAgaWYgKCFwbGFjZWhvbGRlcnMubGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpMThuIHBvc3Rwcm9jZXNzOiB1bm1hdGNoZWQgcGxhY2Vob2xkZXIgLSAke2NvbnRlbnR9YCk7CiAgICAgIH0KICAgICAgY29uc3QgY3VycmVudFRlbXBsYXRlSWQgPSB0ZW1wbGF0ZUlkc1N0YWNrW3RlbXBsYXRlSWRzU3RhY2subGVuZ3RoIC0gMV07CiAgICAgIGxldCBpZHggPSAwOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBsYWNlaG9sZGVycy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChwbGFjZWhvbGRlcnNbaV1bMF0gPT09IGN1cnJlbnRUZW1wbGF0ZUlkKSB7CiAgICAgICAgICBpZHggPSBpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IFt0ZW1wbGF0ZUlkLCBpc0Nsb3NlVGVtcGxhdGVUYWcsIHBsYWNlaG9sZGVyXSA9IHBsYWNlaG9sZGVyc1tpZHhdOwogICAgICBpZiAoaXNDbG9zZVRlbXBsYXRlVGFnKSB7CiAgICAgICAgdGVtcGxhdGVJZHNTdGFjay5wb3AoKTsKICAgICAgfSBlbHNlIGlmIChjdXJyZW50VGVtcGxhdGVJZCAhPT0gdGVtcGxhdGVJZCkgewogICAgICAgIHRlbXBsYXRlSWRzU3RhY2sucHVzaCh0ZW1wbGF0ZUlkKTsKICAgICAgfQogICAgICBwbGFjZWhvbGRlcnMuc3BsaWNlKGlkeCwgMSk7CiAgICAgIHJldHVybiBwbGFjZWhvbGRlcjsKICAgIH0pOwogIH0KICBpZiAoIU9iamVjdC5rZXlzKHJlcGxhY2VtZW50cykubGVuZ3RoKSB7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShQUF9JQ1VfVkFSU19SRUdFWFAsIChtYXRjaCwgc3RhcnQsIGtleSwgX3R5cGUsIF9pZHgsIGVuZCkgPT4gewogICAgcmV0dXJuIHJlcGxhY2VtZW50cy5oYXNPd25Qcm9wZXJ0eShrZXkpID8gYCR7c3RhcnR9JHtyZXBsYWNlbWVudHNba2V5XX0ke2VuZH1gIDogbWF0Y2g7CiAgfSk7CiAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoUFBfSUNVX1BMQUNFSE9MREVSU19SRUdFWFAsIChtYXRjaCwga2V5KSA9PiB7CiAgICByZXR1cm4gcmVwbGFjZW1lbnRzLmhhc093blByb3BlcnR5KGtleSkgPyByZXBsYWNlbWVudHNba2V5XSA6IG1hdGNoOwogIH0pOwogIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKFBQX0lDVVNfUkVHRVhQLCAobWF0Y2gsIGtleSkgPT4gewogICAgaWYgKHJlcGxhY2VtZW50cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgIGNvbnN0IGxpc3QgPSByZXBsYWNlbWVudHNba2V5XTsKICAgICAgaWYgKCFsaXN0Lmxlbmd0aCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgaTE4biBwb3N0cHJvY2VzczogdW5tYXRjaGVkIElDVSAtICR7bWF0Y2h9IHdpdGgga2V5OiAke2tleX1gKTsKICAgICAgfQogICAgICByZXR1cm4gbGlzdC5zaGlmdCgpOwogICAgfQogICAgcmV0dXJuIG1hdGNoOwogIH0pOwogIHJldHVybiByZXN1bHQ7Cn0KZnVuY3Rpb24gybXJtWkxOG5TdGFydChpbmRleCwgbWVzc2FnZUluZGV4LCBzdWJUZW1wbGF0ZUluZGV4ID0gLTEpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBIRUFERVJfT0ZGU0VUICsgaW5kZXg7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQodFZpZXcsIGB0VmlldyBzaG91bGQgYmUgZGVmaW5lZGApOwogIGNvbnN0IG1lc3NhZ2UgPSBnZXRDb25zdGFudCh0Vmlldy5jb25zdHMsIG1lc3NhZ2VJbmRleCk7CiAgY29uc3QgcGFyZW50VE5vZGUgPSBnZXRDdXJyZW50UGFyZW50VE5vZGUoKTsKICBpZiAodFZpZXcuZmlyc3RDcmVhdGVQYXNzKSB7CiAgICBpMThuU3RhcnRGaXJzdENyZWF0ZVBhc3ModFZpZXcsIHBhcmVudFROb2RlID09PSBudWxsID8gMCA6IHBhcmVudFROb2RlLmluZGV4LCBsVmlldywgYWRqdXN0ZWRJbmRleCwgbWVzc2FnZSwgc3ViVGVtcGxhdGVJbmRleCk7CiAgfQogIGlmICh0Vmlldy50eXBlID09PSAyKSB7CiAgICBjb25zdCBjb21wb25lbnRMVmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICAgIGNvbXBvbmVudExWaWV3W0ZMQUdTXSB8PSAzMjsKICB9IGVsc2UgewogICAgbFZpZXdbRkxBR1NdIHw9IDMyOwogIH0KICBjb25zdCB0STE4biA9IHRWaWV3LmRhdGFbYWRqdXN0ZWRJbmRleF07CiAgY29uc3Qgc2FtZVZpZXdQYXJlbnRUTm9kZSA9IHBhcmVudFROb2RlID09PSBsVmlld1tUX0hPU1RdID8gbnVsbCA6IHBhcmVudFROb2RlOwogIGNvbnN0IHBhcmVudFJOb2RlID0gZ2V0Q2xvc2VzdFJFbGVtZW50KHRWaWV3LCBzYW1lVmlld1BhcmVudFROb2RlLCBsVmlldyk7CiAgY29uc3QgaW5zZXJ0SW5Gcm9udE9mID0gcGFyZW50VE5vZGUgJiYgcGFyZW50VE5vZGUudHlwZSAmIDggPyBsVmlld1twYXJlbnRUTm9kZS5pbmRleF0gOiBudWxsOwogIHByZXBhcmVJMThuQmxvY2tGb3JIeWRyYXRpb24obFZpZXcsIGFkanVzdGVkSW5kZXgsIHBhcmVudFROb2RlLCBzdWJUZW1wbGF0ZUluZGV4KTsKICBhcHBseUNyZWF0ZU9wQ29kZXMobFZpZXcsIHRJMThuLmNyZWF0ZSwgcGFyZW50Uk5vZGUsIGluc2VydEluRnJvbnRPZik7CiAgc2V0SW5JMThuQmxvY2sodHJ1ZSk7Cn0KZnVuY3Rpb24gybXJtWkxOG5FbmQoKSB7CiAgc2V0SW5JMThuQmxvY2soZmFsc2UpOwp9CmZ1bmN0aW9uIMm1ybVpMThuKGluZGV4LCBtZXNzYWdlSW5kZXgsIHN1YlRlbXBsYXRlSW5kZXgpIHsKICDJtcm1aTE4blN0YXJ0KGluZGV4LCBtZXNzYWdlSW5kZXgsIHN1YlRlbXBsYXRlSW5kZXgpOwogIMm1ybVpMThuRW5kKCk7Cn0KZnVuY3Rpb24gybXJtWkxOG5BdHRyaWJ1dGVzKGluZGV4LCBhdHRyc0luZGV4KSB7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKHRWaWV3LCBgdFZpZXcgc2hvdWxkIGJlIGRlZmluZWRgKTsKICBjb25zdCBhdHRycyA9IGdldENvbnN0YW50KHRWaWV3LmNvbnN0cywgYXR0cnNJbmRleCk7CiAgaTE4bkF0dHJpYnV0ZXNGaXJzdFBhc3ModFZpZXcsIGluZGV4ICsgSEVBREVSX09GRlNFVCwgYXR0cnMpOwp9CmZ1bmN0aW9uIMm1ybVpMThuRXhwKHZhbHVlKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIHNldE1hc2tCaXQoYmluZGluZ1VwZGF0ZWQobFZpZXcsIG5leHRCaW5kaW5nSW5kZXgoKSwgdmFsdWUpKTsKICByZXR1cm4gybXJtWkxOG5FeHA7Cn0KZnVuY3Rpb24gybXJtWkxOG5BcHBseShpbmRleCkgewogIGFwcGx5STE4bihnZXRUVmlldygpLCBnZXRMVmlldygpLCBpbmRleCArIEhFQURFUl9PRkZTRVQpOwp9CmZ1bmN0aW9uIMm1ybVpMThuUG9zdHByb2Nlc3MobWVzc2FnZSwgcmVwbGFjZW1lbnRzID0ge30pIHsKICByZXR1cm4gaTE4blBvc3Rwcm9jZXNzKG1lc3NhZ2UsIHJlcGxhY2VtZW50cyk7Cn0KZnVuY3Rpb24gybXJtWxpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXJGbiwgZXZlbnRUYXJnZXRSZXNvbHZlcikgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgdE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBsaXN0ZW5lckludGVybmFsKHRWaWV3LCBsVmlldywgbFZpZXdbUkVOREVSRVJdLCB0Tm9kZSwgZXZlbnROYW1lLCBsaXN0ZW5lckZuLCBldmVudFRhcmdldFJlc29sdmVyKTsKICByZXR1cm4gybXJtWxpc3RlbmVyOwp9CmZ1bmN0aW9uIMm1ybVzeW50aGV0aWNIb3N0TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lckZuKSB7CiAgY29uc3QgdE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IGN1cnJlbnREZWYgPSBnZXRDdXJyZW50RGlyZWN0aXZlRGVmKHRWaWV3LmRhdGEpOwogIGNvbnN0IHJlbmRlcmVyID0gbG9hZENvbXBvbmVudFJlbmRlcmVyKGN1cnJlbnREZWYsIHROb2RlLCBsVmlldyk7CiAgbGlzdGVuZXJJbnRlcm5hbCh0VmlldywgbFZpZXcsIHJlbmRlcmVyLCB0Tm9kZSwgZXZlbnROYW1lLCBsaXN0ZW5lckZuKTsKICByZXR1cm4gybXJtXN5bnRoZXRpY0hvc3RMaXN0ZW5lcjsKfQpmdW5jdGlvbiDJtcm1ZG9tTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lckZuLCBldmVudFRhcmdldFJlc29sdmVyKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogIGlmICh0Tm9kZS50eXBlICYgMyB8fCBldmVudFRhcmdldFJlc29sdmVyKSB7CiAgICBsaXN0ZW5Ub0RvbUV2ZW50KHROb2RlLCB0VmlldywgbFZpZXcsIGV2ZW50VGFyZ2V0UmVzb2x2ZXIsIGxWaWV3W1JFTkRFUkVSXSwgZXZlbnROYW1lLCBsaXN0ZW5lckZuLCB3cmFwTGlzdGVuZXIodE5vZGUsIGxWaWV3LCBsaXN0ZW5lckZuKSk7CiAgfQogIHJldHVybiDJtcm1ZG9tTGlzdGVuZXI7Cn0KZnVuY3Rpb24gbGlzdGVuZXJJbnRlcm5hbCh0VmlldywgbFZpZXcsIHJlbmRlcmVyLCB0Tm9kZSwgZXZlbnROYW1lLCBsaXN0ZW5lckZuLCBldmVudFRhcmdldFJlc29sdmVyKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZSh0Tm9kZSwgMyB8IDEyKTsKICBsZXQgcHJvY2Vzc091dHB1dHMgPSB0cnVlOwogIGxldCB3cmFwcGVkTGlzdGVuZXIgPSBudWxsOwogIGlmICh0Tm9kZS50eXBlICYgMyB8fCBldmVudFRhcmdldFJlc29sdmVyKSB7CiAgICB3cmFwcGVkTGlzdGVuZXIgPz89IHdyYXBMaXN0ZW5lcih0Tm9kZSwgbFZpZXcsIGxpc3RlbmVyRm4pOwogICAgY29uc3QgaGFzQ29hbGVzY2VkRG9tRXZlbnQgPSBsaXN0ZW5Ub0RvbUV2ZW50KHROb2RlLCB0VmlldywgbFZpZXcsIGV2ZW50VGFyZ2V0UmVzb2x2ZXIsIHJlbmRlcmVyLCBldmVudE5hbWUsIGxpc3RlbmVyRm4sIHdyYXBwZWRMaXN0ZW5lcik7CiAgICBpZiAoaGFzQ29hbGVzY2VkRG9tRXZlbnQpIHsKICAgICAgcHJvY2Vzc091dHB1dHMgPSBmYWxzZTsKICAgIH0KICB9CiAgaWYgKHByb2Nlc3NPdXRwdXRzKSB7CiAgICBjb25zdCBvdXRwdXRDb25maWcgPSB0Tm9kZS5vdXRwdXRzPy5bZXZlbnROYW1lXTsKICAgIGNvbnN0IGhvc3REaXJlY3RpdmVPdXRwdXRDb25maWcgPSB0Tm9kZS5ob3N0RGlyZWN0aXZlT3V0cHV0cz8uW2V2ZW50TmFtZV07CiAgICBpZiAoaG9zdERpcmVjdGl2ZU91dHB1dENvbmZpZyAmJiBob3N0RGlyZWN0aXZlT3V0cHV0Q29uZmlnLmxlbmd0aCkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhvc3REaXJlY3RpdmVPdXRwdXRDb25maWcubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICBjb25zdCBpbmRleCA9IGhvc3REaXJlY3RpdmVPdXRwdXRDb25maWdbaV07CiAgICAgICAgY29uc3QgbG9va3VwTmFtZSA9IGhvc3REaXJlY3RpdmVPdXRwdXRDb25maWdbaSArIDFdOwogICAgICAgIHdyYXBwZWRMaXN0ZW5lciA/Pz0gd3JhcExpc3RlbmVyKHROb2RlLCBsVmlldywgbGlzdGVuZXJGbik7CiAgICAgICAgbGlzdGVuVG9PdXRwdXQodE5vZGUsIGxWaWV3LCBpbmRleCwgbG9va3VwTmFtZSwgZXZlbnROYW1lLCB3cmFwcGVkTGlzdGVuZXIpOwogICAgICB9CiAgICB9CiAgICBpZiAob3V0cHV0Q29uZmlnICYmIG91dHB1dENvbmZpZy5sZW5ndGgpIHsKICAgICAgZm9yIChjb25zdCBpbmRleCBvZiBvdXRwdXRDb25maWcpIHsKICAgICAgICB3cmFwcGVkTGlzdGVuZXIgPz89IHdyYXBMaXN0ZW5lcih0Tm9kZSwgbFZpZXcsIGxpc3RlbmVyRm4pOwogICAgICAgIGxpc3RlblRvT3V0cHV0KHROb2RlLCBsVmlldywgaW5kZXgsIGV2ZW50TmFtZSwgZXZlbnROYW1lLCB3cmFwcGVkTGlzdGVuZXIpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIMm1ybVuZXh0Q29udGV4dChsZXZlbCA9IDEpIHsKICByZXR1cm4gbmV4dENvbnRleHRJbXBsKGxldmVsKTsKfQpmdW5jdGlvbiBtYXRjaGluZ1Byb2plY3Rpb25TbG90SW5kZXgodE5vZGUsIHByb2plY3Rpb25TbG90cykgewogIGxldCB3aWxkY2FyZE5nQ29udGVudEluZGV4ID0gbnVsbDsKICBjb25zdCBuZ1Byb2plY3RBc0F0dHJWYWwgPSBnZXRQcm9qZWN0QXNBdHRyVmFsdWUodE5vZGUpOwogIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvamVjdGlvblNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBzbG90VmFsdWUgPSBwcm9qZWN0aW9uU2xvdHNbaV07CiAgICBpZiAoc2xvdFZhbHVlID09PSAiKiIpIHsKICAgICAgd2lsZGNhcmROZ0NvbnRlbnRJbmRleCA9IGk7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKG5nUHJvamVjdEFzQXR0clZhbCA9PT0gbnVsbCA/IGlzTm9kZU1hdGNoaW5nU2VsZWN0b3JMaXN0KHROb2RlLCBzbG90VmFsdWUsIHRydWUpIDogaXNTZWxlY3RvckluU2VsZWN0b3JMaXN0KG5nUHJvamVjdEFzQXR0clZhbCwgc2xvdFZhbHVlKSkgewogICAgICByZXR1cm4gaTsKICAgIH0KICB9CiAgcmV0dXJuIHdpbGRjYXJkTmdDb250ZW50SW5kZXg7Cn0KZnVuY3Rpb24gybXJtXByb2plY3Rpb25EZWYocHJvamVjdGlvblNsb3RzKSB7CiAgY29uc3QgY29tcG9uZW50Tm9kZSA9IGdldExWaWV3KClbREVDTEFSQVRJT05fQ09NUE9ORU5UX1ZJRVddW1RfSE9TVF07CiAgaWYgKCFjb21wb25lbnROb2RlLnByb2plY3Rpb24pIHsKICAgIGNvbnN0IG51bVByb2plY3Rpb25TbG90cyA9IHByb2plY3Rpb25TbG90cyA/IHByb2plY3Rpb25TbG90cy5sZW5ndGggOiAxOwogICAgY29uc3QgcHJvamVjdGlvbkhlYWRzID0gY29tcG9uZW50Tm9kZS5wcm9qZWN0aW9uID0gbmV3QXJyYXkobnVtUHJvamVjdGlvblNsb3RzLCBudWxsKTsKICAgIGNvbnN0IHRhaWxzID0gcHJvamVjdGlvbkhlYWRzLnNsaWNlKCk7CiAgICBsZXQgY29tcG9uZW50Q2hpbGQgPSBjb21wb25lbnROb2RlLmNoaWxkOwogICAgd2hpbGUgKGNvbXBvbmVudENoaWxkICE9PSBudWxsKSB7CiAgICAgIGlmIChjb21wb25lbnRDaGlsZC50eXBlICE9PSAxMjgpIHsKICAgICAgICBjb25zdCBzbG90SW5kZXggPSBwcm9qZWN0aW9uU2xvdHMgPyBtYXRjaGluZ1Byb2plY3Rpb25TbG90SW5kZXgoY29tcG9uZW50Q2hpbGQsIHByb2plY3Rpb25TbG90cykgOiAwOwogICAgICAgIGlmIChzbG90SW5kZXggIT09IG51bGwpIHsKICAgICAgICAgIGlmICh0YWlsc1tzbG90SW5kZXhdKSB7CiAgICAgICAgICAgIHRhaWxzW3Nsb3RJbmRleF0ucHJvamVjdGlvbk5leHQgPSBjb21wb25lbnRDaGlsZDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByb2plY3Rpb25IZWFkc1tzbG90SW5kZXhdID0gY29tcG9uZW50Q2hpbGQ7CiAgICAgICAgICB9CiAgICAgICAgICB0YWlsc1tzbG90SW5kZXhdID0gY29tcG9uZW50Q2hpbGQ7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbXBvbmVudENoaWxkID0gY29tcG9uZW50Q2hpbGQubmV4dDsKICAgIH0KICB9Cn0KZnVuY3Rpb24gybXJtXByb2plY3Rpb24obm9kZUluZGV4LCBzZWxlY3RvckluZGV4ID0gMCwgYXR0cnMsIGZhbGxiYWNrVGVtcGxhdGVGbiwgZmFsbGJhY2tEZWNscywgZmFsbGJhY2tWYXJzKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBmYWxsYmFja0luZGV4ID0gZmFsbGJhY2tUZW1wbGF0ZUZuID8gbm9kZUluZGV4ICsgMSA6IG51bGw7CiAgaWYgKGZhbGxiYWNrSW5kZXggIT09IG51bGwpIHsKICAgIGRlY2xhcmVOb0RpcmVjdGl2ZUhvc3RUZW1wbGF0ZShsVmlldywgdFZpZXcsIGZhbGxiYWNrSW5kZXgsIGZhbGxiYWNrVGVtcGxhdGVGbiwgZmFsbGJhY2tEZWNscywgZmFsbGJhY2tWYXJzLCBudWxsLCBhdHRycyk7CiAgfQogIGNvbnN0IHRQcm9qZWN0aW9uTm9kZSA9IGdldE9yQ3JlYXRlVE5vZGUodFZpZXcsIEhFQURFUl9PRkZTRVQgKyBub2RlSW5kZXgsIDE2LCBudWxsLCBhdHRycyB8fCBudWxsKTsKICBpZiAodFByb2plY3Rpb25Ob2RlLnByb2plY3Rpb24gPT09IG51bGwpIHsKICAgIHRQcm9qZWN0aW9uTm9kZS5wcm9qZWN0aW9uID0gc2VsZWN0b3JJbmRleDsKICB9CiAgc2V0Q3VycmVudFROb2RlQXNOb3RQYXJlbnQoKTsKICBjb25zdCBoeWRyYXRpb25JbmZvID0gbFZpZXdbSFlEUkFUSU9OXTsKICBjb25zdCBpc05vZGVDcmVhdGlvbk1vZGUgPSAhaHlkcmF0aW9uSW5mbyB8fCBpc0luU2tpcEh5ZHJhdGlvbkJsb2NrKCk7CiAgY29uc3QgY29tcG9uZW50SG9zdE5vZGUgPSBsVmlld1tERUNMQVJBVElPTl9DT01QT05FTlRfVklFV11bVF9IT1NUXTsKICBjb25zdCBpc0VtcHR5MiA9IGNvbXBvbmVudEhvc3ROb2RlLnByb2plY3Rpb25bdFByb2plY3Rpb25Ob2RlLnByb2plY3Rpb25dID09PSBudWxsOwogIGlmIChpc0VtcHR5MiAmJiBmYWxsYmFja0luZGV4ICE9PSBudWxsKSB7CiAgICBpbnNlcnRGYWxsYmFja0NvbnRlbnQobFZpZXcsIHRWaWV3LCBmYWxsYmFja0luZGV4KTsKICB9IGVsc2UgaWYgKGlzTm9kZUNyZWF0aW9uTW9kZSAmJiAhaXNEZXRhY2hlZEJ5STE4bih0UHJvamVjdGlvbk5vZGUpKSB7CiAgICBhcHBseVByb2plY3Rpb24odFZpZXcsIGxWaWV3LCB0UHJvamVjdGlvbk5vZGUpOwogIH0KfQpmdW5jdGlvbiBpbnNlcnRGYWxsYmFja0NvbnRlbnQobFZpZXcsIHRWaWV3LCBmYWxsYmFja0luZGV4KSB7CiAgY29uc3QgYWRqdXN0ZWRJbmRleCA9IEhFQURFUl9PRkZTRVQgKyBmYWxsYmFja0luZGV4OwogIGNvbnN0IGZhbGxiYWNrVE5vZGUgPSB0Vmlldy5kYXRhW2FkanVzdGVkSW5kZXhdOwogIGNvbnN0IGZhbGxiYWNrTENvbnRhaW5lciA9IGxWaWV3W2FkanVzdGVkSW5kZXhdOwogIG5nRGV2TW9kZSAmJiBhc3NlcnRUTm9kZShmYWxsYmFja1ROb2RlKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TENvbnRhaW5lcihmYWxsYmFja0xDb250YWluZXIpOwogIGNvbnN0IGRlaHlkcmF0ZWRWaWV3ID0gZmluZE1hdGNoaW5nRGVoeWRyYXRlZFZpZXcoZmFsbGJhY2tMQ29udGFpbmVyLCBmYWxsYmFja1ROb2RlLnRWaWV3LnNzcklkKTsKICBjb25zdCBmYWxsYmFja0xWaWV3ID0gY3JlYXRlQW5kUmVuZGVyRW1iZWRkZWRMVmlldyhsVmlldywgZmFsbGJhY2tUTm9kZSwgdm9pZCAwLCB7CiAgICBkZWh5ZHJhdGVkVmlldwogIH0pOwogIGFkZExWaWV3VG9MQ29udGFpbmVyKGZhbGxiYWNrTENvbnRhaW5lciwgZmFsbGJhY2tMVmlldywgMCwgc2hvdWxkQWRkVmlld1RvRG9tKGZhbGxiYWNrVE5vZGUsIGRlaHlkcmF0ZWRWaWV3KSk7Cn0KZnVuY3Rpb24gybXJtWNvbnRlbnRRdWVyeShkaXJlY3RpdmVJbmRleCwgcHJlZGljYXRlLCBmbGFncywgcmVhZCkgewogIGNyZWF0ZUNvbnRlbnRRdWVyeShkaXJlY3RpdmVJbmRleCwgcHJlZGljYXRlLCBmbGFncywgcmVhZCk7CiAgcmV0dXJuIMm1ybVjb250ZW50UXVlcnk7Cn0KZnVuY3Rpb24gybXJtXZpZXdRdWVyeShwcmVkaWNhdGUsIGZsYWdzLCByZWFkKSB7CiAgY3JlYXRlVmlld1F1ZXJ5KHByZWRpY2F0ZSwgZmxhZ3MsIHJlYWQpOwogIHJldHVybiDJtcm1dmlld1F1ZXJ5Owp9CmZ1bmN0aW9uIMm1ybVxdWVyeVJlZnJlc2gocXVlcnlMaXN0KSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBxdWVyeUluZGV4ID0gZ2V0Q3VycmVudFF1ZXJ5SW5kZXgoKTsKICBzZXRDdXJyZW50UXVlcnlJbmRleChxdWVyeUluZGV4ICsgMSk7CiAgY29uc3QgdFF1ZXJ5ID0gZ2V0VFF1ZXJ5KHRWaWV3LCBxdWVyeUluZGV4KTsKICBpZiAocXVlcnlMaXN0LmRpcnR5ICYmIGlzQ3JlYXRpb25Nb2RlKGxWaWV3KSA9PT0gKCh0UXVlcnkubWV0YWRhdGEuZmxhZ3MgJiAyKSA9PT0gMikpIHsKICAgIGlmICh0UXVlcnkubWF0Y2hlcyA9PT0gbnVsbCkgewogICAgICBxdWVyeUxpc3QucmVzZXQoW10pOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgcmVzdWx0ID0gZ2V0UXVlcnlSZXN1bHRzKGxWaWV3LCBxdWVyeUluZGV4KTsKICAgICAgcXVlcnlMaXN0LnJlc2V0KHJlc3VsdCwgdW53cmFwRWxlbWVudFJlZik7CiAgICAgIHF1ZXJ5TGlzdC5ub3RpZnlPbkNoYW5nZXMoKTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gybXJtWxvYWRRdWVyeSgpIHsKICByZXR1cm4gbG9hZFF1ZXJ5SW50ZXJuYWwoZ2V0TFZpZXcoKSwgZ2V0Q3VycmVudFF1ZXJ5SW5kZXgoKSk7Cn0KZnVuY3Rpb24gybXJtWNvbnRlbnRRdWVyeVNpZ25hbChkaXJlY3RpdmVJbmRleCwgdGFyZ2V0LCBwcmVkaWNhdGUsIGZsYWdzLCByZWFkKSB7CiAgYmluZFF1ZXJ5VG9TaWduYWwodGFyZ2V0LCBjcmVhdGVDb250ZW50UXVlcnkoZGlyZWN0aXZlSW5kZXgsIHByZWRpY2F0ZSwgZmxhZ3MsIHJlYWQpKTsKICByZXR1cm4gybXJtWNvbnRlbnRRdWVyeVNpZ25hbDsKfQpmdW5jdGlvbiDJtcm1dmlld1F1ZXJ5U2lnbmFsKHRhcmdldCwgcHJlZGljYXRlLCBmbGFncywgcmVhZCkgewogIGJpbmRRdWVyeVRvU2lnbmFsKHRhcmdldCwgY3JlYXRlVmlld1F1ZXJ5KHByZWRpY2F0ZSwgZmxhZ3MsIHJlYWQpKTsKICByZXR1cm4gybXJtXZpZXdRdWVyeVNpZ25hbDsKfQpmdW5jdGlvbiDJtcm1cXVlcnlBZHZhbmNlKGluZGV4T2Zmc2V0ID0gMSkgewogIHNldEN1cnJlbnRRdWVyeUluZGV4KGdldEN1cnJlbnRRdWVyeUluZGV4KCkgKyBpbmRleE9mZnNldCk7Cn0KZnVuY3Rpb24gybXJtXJlZmVyZW5jZShpbmRleCkgewogIGNvbnN0IGNvbnRleHRMVmlldyA9IGdldENvbnRleHRMVmlldygpOwogIHJldHVybiBsb2FkKGNvbnRleHRMVmlldywgSEVBREVSX09GRlNFVCArIGluZGV4KTsKfQpmdW5jdGlvbiB0b1RTdHlsaW5nUmFuZ2UocHJldiwgbmV4dCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXJJblJhbmdlKHByZXYsIDAsIDMyNzY3KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVySW5SYW5nZShuZXh0LCAwLCAzMjc2Nyk7CiAgcmV0dXJuIHByZXYgPDwgMTcgfCBuZXh0IDw8IDI7Cn0KZnVuY3Rpb24gZ2V0VFN0eWxpbmdSYW5nZVByZXYodFN0eWxpbmdSYW5nZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIodFN0eWxpbmdSYW5nZSwgImV4cGVjdGVkIG51bWJlciIpOwogIHJldHVybiB0U3R5bGluZ1JhbmdlID4+IDE3ICYgMzI3Njc7Cn0KZnVuY3Rpb24gZ2V0VFN0eWxpbmdSYW5nZVByZXZEdXBsaWNhdGUodFN0eWxpbmdSYW5nZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIodFN0eWxpbmdSYW5nZSwgImV4cGVjdGVkIG51bWJlciIpOwogIHJldHVybiAodFN0eWxpbmdSYW5nZSAmIDIpID09IDI7Cn0KZnVuY3Rpb24gc2V0VFN0eWxpbmdSYW5nZVByZXYodFN0eWxpbmdSYW5nZSwgcHJldmlvdXMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVyKHRTdHlsaW5nUmFuZ2UsICJleHBlY3RlZCBudW1iZXIiKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVySW5SYW5nZShwcmV2aW91cywgMCwgMzI3NjcpOwogIHJldHVybiB0U3R5bGluZ1JhbmdlICYgfjQyOTQ4MzYyMjQgfCBwcmV2aW91cyA8PCAxNzsKfQpmdW5jdGlvbiBzZXRUU3R5bGluZ1JhbmdlUHJldkR1cGxpY2F0ZSh0U3R5bGluZ1JhbmdlKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE51bWJlcih0U3R5bGluZ1JhbmdlLCAiZXhwZWN0ZWQgbnVtYmVyIik7CiAgcmV0dXJuIHRTdHlsaW5nUmFuZ2UgfCAyOwp9CmZ1bmN0aW9uIGdldFRTdHlsaW5nUmFuZ2VOZXh0KHRTdHlsaW5nUmFuZ2UpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVyKHRTdHlsaW5nUmFuZ2UsICJleHBlY3RlZCBudW1iZXIiKTsKICByZXR1cm4gKHRTdHlsaW5nUmFuZ2UgJiAxMzEwNjgpID4+IDI7Cn0KZnVuY3Rpb24gc2V0VFN0eWxpbmdSYW5nZU5leHQodFN0eWxpbmdSYW5nZSwgbmV4dCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIodFN0eWxpbmdSYW5nZSwgImV4cGVjdGVkIG51bWJlciIpOwogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXJJblJhbmdlKG5leHQsIDAsIDMyNzY3KTsKICByZXR1cm4gdFN0eWxpbmdSYW5nZSAmIH4xMzEwNjggfCBuZXh0IDw8IDI7Cn0KZnVuY3Rpb24gZ2V0VFN0eWxpbmdSYW5nZU5leHREdXBsaWNhdGUodFN0eWxpbmdSYW5nZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROdW1iZXIodFN0eWxpbmdSYW5nZSwgImV4cGVjdGVkIG51bWJlciIpOwogIHJldHVybiAodFN0eWxpbmdSYW5nZSAmIDEpID09PSAxOwp9CmZ1bmN0aW9uIHNldFRTdHlsaW5nUmFuZ2VOZXh0RHVwbGljYXRlKHRTdHlsaW5nUmFuZ2UpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TnVtYmVyKHRTdHlsaW5nUmFuZ2UsICJleHBlY3RlZCBudW1iZXIiKTsKICByZXR1cm4gdFN0eWxpbmdSYW5nZSB8IDE7Cn0KZnVuY3Rpb24gaW5zZXJ0VFN0eWxpbmdCaW5kaW5nKHREYXRhLCB0Tm9kZSwgdFN0eWxpbmdLZXlXaXRoU3RhdGljLCBpbmRleCwgaXNIb3N0QmluZGluZywgaXNDbGFzc0JpbmRpbmcpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Rmlyc3RVcGRhdGVQYXNzKGdldFRWaWV3KCkpOwogIGxldCB0QmluZGluZ3MgPSBpc0NsYXNzQmluZGluZyA/IHROb2RlLmNsYXNzQmluZGluZ3MgOiB0Tm9kZS5zdHlsZUJpbmRpbmdzOwogIGxldCB0bXBsSGVhZCA9IGdldFRTdHlsaW5nUmFuZ2VQcmV2KHRCaW5kaW5ncyk7CiAgbGV0IHRtcGxUYWlsID0gZ2V0VFN0eWxpbmdSYW5nZU5leHQodEJpbmRpbmdzKTsKICB0RGF0YVtpbmRleF0gPSB0U3R5bGluZ0tleVdpdGhTdGF0aWM7CiAgbGV0IGlzS2V5RHVwbGljYXRlT2ZTdGF0aWMgPSBmYWxzZTsKICBsZXQgdFN0eWxpbmdLZXk7CiAgaWYgKEFycmF5LmlzQXJyYXkodFN0eWxpbmdLZXlXaXRoU3RhdGljKSkgewogICAgY29uc3Qgc3RhdGljS2V5VmFsdWVBcnJheSA9IHRTdHlsaW5nS2V5V2l0aFN0YXRpYzsKICAgIHRTdHlsaW5nS2V5ID0gc3RhdGljS2V5VmFsdWVBcnJheVsxXTsKICAgIGlmICh0U3R5bGluZ0tleSA9PT0gbnVsbCB8fCBrZXlWYWx1ZUFycmF5SW5kZXhPZihzdGF0aWNLZXlWYWx1ZUFycmF5LCB0U3R5bGluZ0tleSkgPiAwKSB7CiAgICAgIGlzS2V5RHVwbGljYXRlT2ZTdGF0aWMgPSB0cnVlOwogICAgfQogIH0gZWxzZSB7CiAgICB0U3R5bGluZ0tleSA9IHRTdHlsaW5nS2V5V2l0aFN0YXRpYzsKICB9CiAgaWYgKGlzSG9zdEJpbmRpbmcpIHsKICAgIGNvbnN0IGhhc1RlbXBsYXRlQmluZGluZ3MgPSB0bXBsVGFpbCAhPT0gMDsKICAgIGlmIChoYXNUZW1wbGF0ZUJpbmRpbmdzKSB7CiAgICAgIGNvbnN0IHByZXZpb3VzTm9kZSA9IGdldFRTdHlsaW5nUmFuZ2VQcmV2KHREYXRhW3RtcGxIZWFkICsgMV0pOwogICAgICB0RGF0YVtpbmRleCArIDFdID0gdG9UU3R5bGluZ1JhbmdlKHByZXZpb3VzTm9kZSwgdG1wbEhlYWQpOwogICAgICBpZiAocHJldmlvdXNOb2RlICE9PSAwKSB7CiAgICAgICAgdERhdGFbcHJldmlvdXNOb2RlICsgMV0gPSBzZXRUU3R5bGluZ1JhbmdlTmV4dCh0RGF0YVtwcmV2aW91c05vZGUgKyAxXSwgaW5kZXgpOwogICAgICB9CiAgICAgIHREYXRhW3RtcGxIZWFkICsgMV0gPSBzZXRUU3R5bGluZ1JhbmdlUHJldih0RGF0YVt0bXBsSGVhZCArIDFdLCBpbmRleCk7CiAgICB9IGVsc2UgewogICAgICB0RGF0YVtpbmRleCArIDFdID0gdG9UU3R5bGluZ1JhbmdlKHRtcGxIZWFkLCAwKTsKICAgICAgaWYgKHRtcGxIZWFkICE9PSAwKSB7CiAgICAgICAgdERhdGFbdG1wbEhlYWQgKyAxXSA9IHNldFRTdHlsaW5nUmFuZ2VOZXh0KHREYXRhW3RtcGxIZWFkICsgMV0sIGluZGV4KTsKICAgICAgfQogICAgICB0bXBsSGVhZCA9IGluZGV4OwogICAgfQogIH0gZWxzZSB7CiAgICB0RGF0YVtpbmRleCArIDFdID0gdG9UU3R5bGluZ1JhbmdlKHRtcGxUYWlsLCAwKTsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbCh0bXBsSGVhZCAhPT0gMCAmJiB0bXBsVGFpbCA9PT0gMCwgZmFsc2UsICJBZGRpbmcgdGVtcGxhdGUgYmluZGluZ3MgYWZ0ZXIgaG9zdEJpbmRpbmdzIGlzIG5vdCBhbGxvd2VkLiIpOwogICAgaWYgKHRtcGxIZWFkID09PSAwKSB7CiAgICAgIHRtcGxIZWFkID0gaW5kZXg7CiAgICB9IGVsc2UgewogICAgICB0RGF0YVt0bXBsVGFpbCArIDFdID0gc2V0VFN0eWxpbmdSYW5nZU5leHQodERhdGFbdG1wbFRhaWwgKyAxXSwgaW5kZXgpOwogICAgfQogICAgdG1wbFRhaWwgPSBpbmRleDsKICB9CiAgaWYgKGlzS2V5RHVwbGljYXRlT2ZTdGF0aWMpIHsKICAgIHREYXRhW2luZGV4ICsgMV0gPSBzZXRUU3R5bGluZ1JhbmdlUHJldkR1cGxpY2F0ZSh0RGF0YVtpbmRleCArIDFdKTsKICB9CiAgbWFya0R1cGxpY2F0ZXModERhdGEsIHRTdHlsaW5nS2V5LCBpbmRleCwgdHJ1ZSk7CiAgbWFya0R1cGxpY2F0ZXModERhdGEsIHRTdHlsaW5nS2V5LCBpbmRleCwgZmFsc2UpOwogIG1hcmtEdXBsaWNhdGVPZlJlc2lkdWFsU3R5bGluZyh0Tm9kZSwgdFN0eWxpbmdLZXksIHREYXRhLCBpbmRleCwgaXNDbGFzc0JpbmRpbmcpOwogIHRCaW5kaW5ncyA9IHRvVFN0eWxpbmdSYW5nZSh0bXBsSGVhZCwgdG1wbFRhaWwpOwogIGlmIChpc0NsYXNzQmluZGluZykgewogICAgdE5vZGUuY2xhc3NCaW5kaW5ncyA9IHRCaW5kaW5nczsKICB9IGVsc2UgewogICAgdE5vZGUuc3R5bGVCaW5kaW5ncyA9IHRCaW5kaW5nczsKICB9Cn0KZnVuY3Rpb24gbWFya0R1cGxpY2F0ZU9mUmVzaWR1YWxTdHlsaW5nKHROb2RlLCB0U3R5bGluZ0tleSwgdERhdGEsIGluZGV4LCBpc0NsYXNzQmluZGluZykgewogIGNvbnN0IHJlc2lkdWFsID0gaXNDbGFzc0JpbmRpbmcgPyB0Tm9kZS5yZXNpZHVhbENsYXNzZXMgOiB0Tm9kZS5yZXNpZHVhbFN0eWxlczsKICBpZiAocmVzaWR1YWwgIT0gbnVsbCAmJiB0eXBlb2YgdFN0eWxpbmdLZXkgPT0gInN0cmluZyIgJiYga2V5VmFsdWVBcnJheUluZGV4T2YocmVzaWR1YWwsIHRTdHlsaW5nS2V5KSA+PSAwKSB7CiAgICB0RGF0YVtpbmRleCArIDFdID0gc2V0VFN0eWxpbmdSYW5nZU5leHREdXBsaWNhdGUodERhdGFbaW5kZXggKyAxXSk7CiAgfQp9CmZ1bmN0aW9uIG1hcmtEdXBsaWNhdGVzKHREYXRhLCB0U3R5bGluZ0tleSwgaW5kZXgsIGlzUHJldkRpcikgewogIGNvbnN0IHRTdHlsaW5nQXRJbmRleCA9IHREYXRhW2luZGV4ICsgMV07CiAgY29uc3QgaXNNYXAgPSB0U3R5bGluZ0tleSA9PT0gbnVsbDsKICBsZXQgY3Vyc29yID0gaXNQcmV2RGlyID8gZ2V0VFN0eWxpbmdSYW5nZVByZXYodFN0eWxpbmdBdEluZGV4KSA6IGdldFRTdHlsaW5nUmFuZ2VOZXh0KHRTdHlsaW5nQXRJbmRleCk7CiAgbGV0IGZvdW5kRHVwbGljYXRlID0gZmFsc2U7CiAgd2hpbGUgKGN1cnNvciAhPT0gMCAmJiAoZm91bmREdXBsaWNhdGUgPT09IGZhbHNlIHx8IGlzTWFwKSkgewogICAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZSh0RGF0YSwgY3Vyc29yKTsKICAgIGNvbnN0IHRTdHlsaW5nVmFsdWVBdEN1cnNvciA9IHREYXRhW2N1cnNvcl07CiAgICBjb25zdCB0U3R5bGVSYW5nZUF0Q3Vyc29yID0gdERhdGFbY3Vyc29yICsgMV07CiAgICBpZiAoaXNTdHlsaW5nTWF0Y2godFN0eWxpbmdWYWx1ZUF0Q3Vyc29yLCB0U3R5bGluZ0tleSkpIHsKICAgICAgZm91bmREdXBsaWNhdGUgPSB0cnVlOwogICAgICB0RGF0YVtjdXJzb3IgKyAxXSA9IGlzUHJldkRpciA/IHNldFRTdHlsaW5nUmFuZ2VOZXh0RHVwbGljYXRlKHRTdHlsZVJhbmdlQXRDdXJzb3IpIDogc2V0VFN0eWxpbmdSYW5nZVByZXZEdXBsaWNhdGUodFN0eWxlUmFuZ2VBdEN1cnNvcik7CiAgICB9CiAgICBjdXJzb3IgPSBpc1ByZXZEaXIgPyBnZXRUU3R5bGluZ1JhbmdlUHJldih0U3R5bGVSYW5nZUF0Q3Vyc29yKSA6IGdldFRTdHlsaW5nUmFuZ2VOZXh0KHRTdHlsZVJhbmdlQXRDdXJzb3IpOwogIH0KICBpZiAoZm91bmREdXBsaWNhdGUpIHsKICAgIHREYXRhW2luZGV4ICsgMV0gPSBpc1ByZXZEaXIgPyBzZXRUU3R5bGluZ1JhbmdlUHJldkR1cGxpY2F0ZSh0U3R5bGluZ0F0SW5kZXgpIDogc2V0VFN0eWxpbmdSYW5nZU5leHREdXBsaWNhdGUodFN0eWxpbmdBdEluZGV4KTsKICB9Cn0KZnVuY3Rpb24gaXNTdHlsaW5nTWF0Y2godFN0eWxpbmdLZXlDdXJzb3IsIHRTdHlsaW5nS2V5KSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdEVxdWFsKEFycmF5LmlzQXJyYXkodFN0eWxpbmdLZXkpLCB0cnVlLCAiRXhwZWN0ZWQgdGhhdCAndFN0eWxpbmdLZXknIGhhcyBiZWVuIHVud3JhcHBlZCIpOwogIGlmICh0U3R5bGluZ0tleUN1cnNvciA9PT0gbnVsbCB8fCB0U3R5bGluZ0tleSA9PSBudWxsIHx8IChBcnJheS5pc0FycmF5KHRTdHlsaW5nS2V5Q3Vyc29yKSA/IHRTdHlsaW5nS2V5Q3Vyc29yWzFdIDogdFN0eWxpbmdLZXlDdXJzb3IpID09PSB0U3R5bGluZ0tleSkgewogICAgcmV0dXJuIHRydWU7CiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRTdHlsaW5nS2V5Q3Vyc29yKSAmJiB0eXBlb2YgdFN0eWxpbmdLZXkgPT09ICJzdHJpbmciKSB7CiAgICByZXR1cm4ga2V5VmFsdWVBcnJheUluZGV4T2YodFN0eWxpbmdLZXlDdXJzb3IsIHRTdHlsaW5nS2V5KSA+PSAwOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KdmFyIHBhcnNlclN0YXRlID0gewogIHRleHRFbmQ6IDAsCiAga2V5OiAwLAogIGtleUVuZDogMCwKICB2YWx1ZTogMCwKICB2YWx1ZUVuZDogMAp9OwpmdW5jdGlvbiBnZXRMYXN0UGFyc2VkS2V5KHRleHQpIHsKICByZXR1cm4gdGV4dC5zdWJzdHJpbmcocGFyc2VyU3RhdGUua2V5LCBwYXJzZXJTdGF0ZS5rZXlFbmQpOwp9CmZ1bmN0aW9uIGdldExhc3RQYXJzZWRWYWx1ZSh0ZXh0KSB7CiAgcmV0dXJuIHRleHQuc3Vic3RyaW5nKHBhcnNlclN0YXRlLnZhbHVlLCBwYXJzZXJTdGF0ZS52YWx1ZUVuZCk7Cn0KZnVuY3Rpb24gcGFyc2VDbGFzc05hbWUodGV4dCkgewogIHJlc2V0UGFyc2VyU3RhdGUodGV4dCk7CiAgcmV0dXJuIHBhcnNlQ2xhc3NOYW1lTmV4dCh0ZXh0LCBjb25zdW1lV2hpdGVzcGFjZSh0ZXh0LCAwLCBwYXJzZXJTdGF0ZS50ZXh0RW5kKSk7Cn0KZnVuY3Rpb24gcGFyc2VDbGFzc05hbWVOZXh0KHRleHQsIGluZGV4KSB7CiAgY29uc3QgZW5kID0gcGFyc2VyU3RhdGUudGV4dEVuZDsKICBpZiAoZW5kID09PSBpbmRleCkgewogICAgcmV0dXJuIC0xOwogIH0KICBpbmRleCA9IHBhcnNlclN0YXRlLmtleUVuZCA9IGNvbnN1bWVDbGFzc1Rva2VuKHRleHQsIHBhcnNlclN0YXRlLmtleSA9IGluZGV4LCBlbmQpOwogIHJldHVybiBjb25zdW1lV2hpdGVzcGFjZSh0ZXh0LCBpbmRleCwgZW5kKTsKfQpmdW5jdGlvbiBwYXJzZVN0eWxlKHRleHQpIHsKICByZXNldFBhcnNlclN0YXRlKHRleHQpOwogIHJldHVybiBwYXJzZVN0eWxlTmV4dCh0ZXh0LCBjb25zdW1lV2hpdGVzcGFjZSh0ZXh0LCAwLCBwYXJzZXJTdGF0ZS50ZXh0RW5kKSk7Cn0KZnVuY3Rpb24gcGFyc2VTdHlsZU5leHQodGV4dCwgc3RhcnRJbmRleCkgewogIGNvbnN0IGVuZCA9IHBhcnNlclN0YXRlLnRleHRFbmQ7CiAgbGV0IGluZGV4ID0gcGFyc2VyU3RhdGUua2V5ID0gY29uc3VtZVdoaXRlc3BhY2UodGV4dCwgc3RhcnRJbmRleCwgZW5kKTsKICBpZiAoZW5kID09PSBpbmRleCkgewogICAgcmV0dXJuIC0xOwogIH0KICBpbmRleCA9IHBhcnNlclN0YXRlLmtleUVuZCA9IGNvbnN1bWVTdHlsZUtleSh0ZXh0LCBpbmRleCwgZW5kKTsKICBpbmRleCA9IGNvbnN1bWVTZXBhcmF0b3IodGV4dCwgaW5kZXgsIGVuZCwgNTgpOwogIGluZGV4ID0gcGFyc2VyU3RhdGUudmFsdWUgPSBjb25zdW1lV2hpdGVzcGFjZSh0ZXh0LCBpbmRleCwgZW5kKTsKICBpbmRleCA9IHBhcnNlclN0YXRlLnZhbHVlRW5kID0gY29uc3VtZVN0eWxlVmFsdWUodGV4dCwgaW5kZXgsIGVuZCk7CiAgcmV0dXJuIGNvbnN1bWVTZXBhcmF0b3IodGV4dCwgaW5kZXgsIGVuZCwgNTkpOwp9CmZ1bmN0aW9uIHJlc2V0UGFyc2VyU3RhdGUodGV4dCkgewogIHBhcnNlclN0YXRlLmtleSA9IDA7CiAgcGFyc2VyU3RhdGUua2V5RW5kID0gMDsKICBwYXJzZXJTdGF0ZS52YWx1ZSA9IDA7CiAgcGFyc2VyU3RhdGUudmFsdWVFbmQgPSAwOwogIHBhcnNlclN0YXRlLnRleHRFbmQgPSB0ZXh0Lmxlbmd0aDsKfQpmdW5jdGlvbiBjb25zdW1lV2hpdGVzcGFjZSh0ZXh0LCBzdGFydEluZGV4LCBlbmRJbmRleCkgewogIHdoaWxlIChzdGFydEluZGV4IDwgZW5kSW5kZXggJiYgdGV4dC5jaGFyQ29kZUF0KHN0YXJ0SW5kZXgpIDw9IDMyKSB7CiAgICBzdGFydEluZGV4Kys7CiAgfQogIHJldHVybiBzdGFydEluZGV4Owp9CmZ1bmN0aW9uIGNvbnN1bWVDbGFzc1Rva2VuKHRleHQsIHN0YXJ0SW5kZXgsIGVuZEluZGV4KSB7CiAgd2hpbGUgKHN0YXJ0SW5kZXggPCBlbmRJbmRleCAmJiB0ZXh0LmNoYXJDb2RlQXQoc3RhcnRJbmRleCkgPiAzMikgewogICAgc3RhcnRJbmRleCsrOwogIH0KICByZXR1cm4gc3RhcnRJbmRleDsKfQpmdW5jdGlvbiBjb25zdW1lU3R5bGVLZXkodGV4dCwgc3RhcnRJbmRleCwgZW5kSW5kZXgpIHsKICBsZXQgY2g7CiAgd2hpbGUgKHN0YXJ0SW5kZXggPCBlbmRJbmRleCAmJiAoKGNoID0gdGV4dC5jaGFyQ29kZUF0KHN0YXJ0SW5kZXgpKSA9PT0gNDUgfHwgY2ggPT09IDk1IHx8IChjaCAmIC0zMykgPj0gNjUgJiYgKGNoICYgLTMzKSA8PSA5MCB8fCBjaCA+PSA0OCAmJiBjaCA8PSA1NykpIHsKICAgIHN0YXJ0SW5kZXgrKzsKICB9CiAgcmV0dXJuIHN0YXJ0SW5kZXg7Cn0KZnVuY3Rpb24gY29uc3VtZVNlcGFyYXRvcih0ZXh0LCBzdGFydEluZGV4LCBlbmRJbmRleCwgc2VwYXJhdG9yKSB7CiAgc3RhcnRJbmRleCA9IGNvbnN1bWVXaGl0ZXNwYWNlKHRleHQsIHN0YXJ0SW5kZXgsIGVuZEluZGV4KTsKICBpZiAoc3RhcnRJbmRleCA8IGVuZEluZGV4KSB7CiAgICBpZiAobmdEZXZNb2RlICYmIHRleHQuY2hhckNvZGVBdChzdGFydEluZGV4KSAhPT0gc2VwYXJhdG9yKSB7CiAgICAgIG1hbGZvcm1lZFN0eWxlRXJyb3IodGV4dCwgU3RyaW5nLmZyb21DaGFyQ29kZShzZXBhcmF0b3IpLCBzdGFydEluZGV4KTsKICAgIH0KICAgIHN0YXJ0SW5kZXgrKzsKICB9CiAgcmV0dXJuIHN0YXJ0SW5kZXg7Cn0KZnVuY3Rpb24gY29uc3VtZVN0eWxlVmFsdWUodGV4dCwgc3RhcnRJbmRleCwgZW5kSW5kZXgpIHsKICBsZXQgY2gxID0gLTE7CiAgbGV0IGNoMiA9IC0xOwogIGxldCBjaDMgPSAtMTsKICBsZXQgaSA9IHN0YXJ0SW5kZXg7CiAgbGV0IGxhc3RDaEluZGV4ID0gaTsKICB3aGlsZSAoaSA8IGVuZEluZGV4KSB7CiAgICBjb25zdCBjaCA9IHRleHQuY2hhckNvZGVBdChpKyspOwogICAgaWYgKGNoID09PSA1OSkgewogICAgICByZXR1cm4gbGFzdENoSW5kZXg7CiAgICB9IGVsc2UgaWYgKGNoID09PSAzNCB8fCBjaCA9PT0gMzkpIHsKICAgICAgbGFzdENoSW5kZXggPSBpID0gY29uc3VtZVF1b3RlZFRleHQodGV4dCwgY2gsIGksIGVuZEluZGV4KTsKICAgIH0gZWxzZSBpZiAoc3RhcnRJbmRleCA9PT0gaSAtIDQgJiYgY2gzID09PSA4NSAmJiBjaDIgPT09IDgyICYmIGNoMSA9PT0gNzYgJiYgY2ggPT09IDQwKSB7CiAgICAgIGxhc3RDaEluZGV4ID0gaSA9IGNvbnN1bWVRdW90ZWRUZXh0KHRleHQsIDQxLCBpLCBlbmRJbmRleCk7CiAgICB9IGVsc2UgaWYgKGNoID4gMzIpIHsKICAgICAgbGFzdENoSW5kZXggPSBpOwogICAgfQogICAgY2gzID0gY2gyOwogICAgY2gyID0gY2gxOwogICAgY2gxID0gY2ggJiAtMzM7CiAgfQogIHJldHVybiBsYXN0Q2hJbmRleDsKfQpmdW5jdGlvbiBjb25zdW1lUXVvdGVkVGV4dCh0ZXh0LCBxdW90ZUNoYXJDb2RlLCBzdGFydEluZGV4LCBlbmRJbmRleCkgewogIGxldCBjaDEgPSAtMTsKICBsZXQgaW5kZXggPSBzdGFydEluZGV4OwogIHdoaWxlIChpbmRleCA8IGVuZEluZGV4KSB7CiAgICBjb25zdCBjaCA9IHRleHQuY2hhckNvZGVBdChpbmRleCsrKTsKICAgIGlmIChjaCA9PSBxdW90ZUNoYXJDb2RlICYmIGNoMSAhPT0gOTIpIHsKICAgICAgcmV0dXJuIGluZGV4OwogICAgfQogICAgaWYgKGNoID09IDkyICYmIGNoMSA9PT0gOTIpIHsKICAgICAgY2gxID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGNoMSA9IGNoOwogICAgfQogIH0KICB0aHJvdyBuZ0Rldk1vZGUgPyBtYWxmb3JtZWRTdHlsZUVycm9yKHRleHQsIFN0cmluZy5mcm9tQ2hhckNvZGUocXVvdGVDaGFyQ29kZSksIGVuZEluZGV4KSA6IG5ldyBFcnJvcigpOwp9CmZ1bmN0aW9uIG1hbGZvcm1lZFN0eWxlRXJyb3IodGV4dCwgZXhwZWN0aW5nLCBpbmRleCkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRFcXVhbCh0eXBlb2YgdGV4dCA9PT0gInN0cmluZyIsIHRydWUsICJTdHJpbmcgZXhwZWN0ZWQgaGVyZSIpOwogIHRocm93IHRocm93RXJyb3IyKGBNYWxmb3JtZWQgc3R5bGUgYXQgbG9jYXRpb24gJHtpbmRleH0gaW4gc3RyaW5nICdgICsgdGV4dC5zdWJzdHJpbmcoMCwgaW5kZXgpICsgIls+PiIgKyB0ZXh0LnN1YnN0cmluZyhpbmRleCwgaW5kZXggKyAxKSArICI8PF0iICsgdGV4dC5zbGljZShpbmRleCArIDEpICsgYCcuIEV4cGVjdGluZyAnJHtleHBlY3Rpbmd9Jy5gKTsKfQpmdW5jdGlvbiDJtcm1c3R5bGVQcm9wKHByb3AsIHZhbHVlLCBzdWZmaXgpIHsKICBjaGVja1N0eWxpbmdQcm9wZXJ0eShwcm9wLCB2YWx1ZSwgc3VmZml4LCBmYWxzZSk7CiAgcmV0dXJuIMm1ybVzdHlsZVByb3A7Cn0KZnVuY3Rpb24gybXJtWNsYXNzUHJvcChjbGFzc05hbWUsIHZhbHVlKSB7CiAgY2hlY2tTdHlsaW5nUHJvcGVydHkoY2xhc3NOYW1lLCB2YWx1ZSwgbnVsbCwgdHJ1ZSk7CiAgcmV0dXJuIMm1ybVjbGFzc1Byb3A7Cn0KZnVuY3Rpb24gybXJtXN0eWxlTWFwKHN0eWxlcykgewogIGNoZWNrU3R5bGluZ01hcChzdHlsZUtleVZhbHVlQXJyYXlTZXQsIHN0eWxlU3RyaW5nUGFyc2VyLCBzdHlsZXMsIGZhbHNlKTsKfQpmdW5jdGlvbiBzdHlsZVN0cmluZ1BhcnNlcihrZXlWYWx1ZUFycmF5LCB0ZXh0KSB7CiAgZm9yIChsZXQgaSA9IHBhcnNlU3R5bGUodGV4dCk7IGkgPj0gMDsgaSA9IHBhcnNlU3R5bGVOZXh0KHRleHQsIGkpKSB7CiAgICBzdHlsZUtleVZhbHVlQXJyYXlTZXQoa2V5VmFsdWVBcnJheSwgZ2V0TGFzdFBhcnNlZEtleSh0ZXh0KSwgZ2V0TGFzdFBhcnNlZFZhbHVlKHRleHQpKTsKICB9Cn0KZnVuY3Rpb24gybXJtWNsYXNzTWFwKGNsYXNzZXMpIHsKICBjaGVja1N0eWxpbmdNYXAoY2xhc3NLZXlWYWx1ZUFycmF5U2V0LCBjbGFzc1N0cmluZ1BhcnNlciwgY2xhc3NlcywgdHJ1ZSk7Cn0KZnVuY3Rpb24gY2xhc3NTdHJpbmdQYXJzZXIoa2V5VmFsdWVBcnJheSwgdGV4dCkgewogIGZvciAobGV0IGkgPSBwYXJzZUNsYXNzTmFtZSh0ZXh0KTsgaSA+PSAwOyBpID0gcGFyc2VDbGFzc05hbWVOZXh0KHRleHQsIGkpKSB7CiAgICBrZXlWYWx1ZUFycmF5U2V0KGtleVZhbHVlQXJyYXksIGdldExhc3RQYXJzZWRLZXkodGV4dCksIHRydWUpOwogIH0KfQpmdW5jdGlvbiBjaGVja1N0eWxpbmdQcm9wZXJ0eShwcm9wLCB2YWx1ZSwgc3VmZml4LCBpc0NsYXNzQmFzZWQpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IGJpbmRpbmdJbmRleCA9IGluY3JlbWVudEJpbmRpbmdJbmRleCgyKTsKICBpZiAodFZpZXcuZmlyc3RVcGRhdGVQYXNzKSB7CiAgICBzdHlsaW5nRmlyc3RVcGRhdGVQYXNzKHRWaWV3LCBwcm9wLCBiaW5kaW5nSW5kZXgsIGlzQ2xhc3NCYXNlZCk7CiAgfQogIGlmICh2YWx1ZSAhPT0gTk9fQ0hBTkdFICYmIGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHZhbHVlKSkgewogICAgY29uc3QgdE5vZGUgPSB0Vmlldy5kYXRhW2dldFNlbGVjdGVkSW5kZXgoKV07CiAgICB1cGRhdGVTdHlsaW5nKHRWaWV3LCB0Tm9kZSwgbFZpZXcsIGxWaWV3W1JFTkRFUkVSXSwgcHJvcCwgbFZpZXdbYmluZGluZ0luZGV4ICsgMV0gPSBub3JtYWxpemVTdWZmaXgodmFsdWUsIHN1ZmZpeCksIGlzQ2xhc3NCYXNlZCwgYmluZGluZ0luZGV4KTsKICB9Cn0KZnVuY3Rpb24gY2hlY2tTdHlsaW5nTWFwKGtleVZhbHVlQXJyYXlTZXQyLCBzdHJpbmdQYXJzZXIsIHZhbHVlLCBpc0NsYXNzQmFzZWQpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gaW5jcmVtZW50QmluZGluZ0luZGV4KDIpOwogIGlmICh0Vmlldy5maXJzdFVwZGF0ZVBhc3MpIHsKICAgIHN0eWxpbmdGaXJzdFVwZGF0ZVBhc3ModFZpZXcsIG51bGwsIGJpbmRpbmdJbmRleCwgaXNDbGFzc0Jhc2VkKTsKICB9CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGlmICh2YWx1ZSAhPT0gTk9fQ0hBTkdFICYmIGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHZhbHVlKSkgewogICAgY29uc3QgdE5vZGUgPSB0Vmlldy5kYXRhW2dldFNlbGVjdGVkSW5kZXgoKV07CiAgICBpZiAoaGFzU3R5bGluZ0lucHV0U2hhZG93KHROb2RlLCBpc0NsYXNzQmFzZWQpICYmICFpc0luSG9zdEJpbmRpbmdzKHRWaWV3LCBiaW5kaW5nSW5kZXgpKSB7CiAgICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgICBjb25zdCB0U3R5bGluZ0tleSA9IHRWaWV3LmRhdGFbYmluZGluZ0luZGV4XTsKICAgICAgICBhc3NlcnRFcXVhbChBcnJheS5pc0FycmF5KHRTdHlsaW5nS2V5KSA/IHRTdHlsaW5nS2V5WzFdIDogdFN0eWxpbmdLZXksIGZhbHNlLCAiU3R5bGluZyBsaW5rZWQgbGlzdCBzaGFkb3cgaW5wdXQgc2hvdWxkIGJlIG1hcmtlZCBhcyAnZmFsc2UnIik7CiAgICAgIH0KICAgICAgbGV0IHN0YXRpY1ByZWZpeCA9IGlzQ2xhc3NCYXNlZCA/IHROb2RlLmNsYXNzZXNXaXRob3V0SG9zdCA6IHROb2RlLnN0eWxlc1dpdGhvdXRIb3N0OwogICAgICBuZ0Rldk1vZGUgJiYgaXNDbGFzc0Jhc2VkID09PSBmYWxzZSAmJiBzdGF0aWNQcmVmaXggIT09IG51bGwgJiYgYXNzZXJ0RXF1YWwoc3RhdGljUHJlZml4LmVuZHNXaXRoKCI7IiksIHRydWUsICJFeHBlY3Rpbmcgc3RhdGljIHBvcnRpb24gdG8gZW5kIHdpdGggJzsnIik7CiAgICAgIGlmIChzdGF0aWNQcmVmaXggIT09IG51bGwpIHsKICAgICAgICB2YWx1ZSA9IGNvbmNhdFN0cmluZ3NXaXRoU3BhY2Uoc3RhdGljUHJlZml4LCB2YWx1ZSA/IHZhbHVlIDogIiIpOwogICAgICB9CiAgICAgIHNldERpcmVjdGl2ZUlucHV0c1doaWNoU2hhZG93c1N0eWxpbmcodFZpZXcsIHROb2RlLCBsVmlldywgdmFsdWUsIGlzQ2xhc3NCYXNlZCk7CiAgICB9IGVsc2UgewogICAgICB1cGRhdGVTdHlsaW5nTWFwKHRWaWV3LCB0Tm9kZSwgbFZpZXcsIGxWaWV3W1JFTkRFUkVSXSwgbFZpZXdbYmluZGluZ0luZGV4ICsgMV0sIGxWaWV3W2JpbmRpbmdJbmRleCArIDFdID0gdG9TdHlsaW5nS2V5VmFsdWVBcnJheShrZXlWYWx1ZUFycmF5U2V0Miwgc3RyaW5nUGFyc2VyLCB2YWx1ZSksIGlzQ2xhc3NCYXNlZCwgYmluZGluZ0luZGV4KTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gaXNJbkhvc3RCaW5kaW5ncyh0VmlldywgYmluZGluZ0luZGV4KSB7CiAgcmV0dXJuIGJpbmRpbmdJbmRleCA+PSB0Vmlldy5leHBhbmRvU3RhcnRJbmRleDsKfQpmdW5jdGlvbiBzdHlsaW5nRmlyc3RVcGRhdGVQYXNzKHRWaWV3LCB0U3R5bGluZ0tleSwgYmluZGluZ0luZGV4LCBpc0NsYXNzQmFzZWQpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Rmlyc3RVcGRhdGVQYXNzKHRWaWV3KTsKICBjb25zdCB0RGF0YSA9IHRWaWV3LmRhdGE7CiAgaWYgKHREYXRhW2JpbmRpbmdJbmRleCArIDFdID09PSBudWxsKSB7CiAgICBjb25zdCB0Tm9kZSA9IHREYXRhW2dldFNlbGVjdGVkSW5kZXgoKV07CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZCh0Tm9kZSwgIlROb2RlIGV4cGVjdGVkIik7CiAgICBjb25zdCBpc0hvc3RCaW5kaW5ncyA9IGlzSW5Ib3N0QmluZGluZ3ModFZpZXcsIGJpbmRpbmdJbmRleCk7CiAgICBpZiAoaGFzU3R5bGluZ0lucHV0U2hhZG93KHROb2RlLCBpc0NsYXNzQmFzZWQpICYmIHRTdHlsaW5nS2V5ID09PSBudWxsICYmICFpc0hvc3RCaW5kaW5ncykgewogICAgICB0U3R5bGluZ0tleSA9IGZhbHNlOwogICAgfQogICAgdFN0eWxpbmdLZXkgPSB3cmFwSW5TdGF0aWNTdHlsaW5nS2V5KHREYXRhLCB0Tm9kZSwgdFN0eWxpbmdLZXksIGlzQ2xhc3NCYXNlZCk7CiAgICBpbnNlcnRUU3R5bGluZ0JpbmRpbmcodERhdGEsIHROb2RlLCB0U3R5bGluZ0tleSwgYmluZGluZ0luZGV4LCBpc0hvc3RCaW5kaW5ncywgaXNDbGFzc0Jhc2VkKTsKICB9Cn0KZnVuY3Rpb24gd3JhcEluU3RhdGljU3R5bGluZ0tleSh0RGF0YSwgdE5vZGUsIHN0eWxpbmdLZXksIGlzQ2xhc3NCYXNlZCkgewogIGNvbnN0IGhvc3REaXJlY3RpdmVEZWYgPSBnZXRDdXJyZW50RGlyZWN0aXZlRGVmKHREYXRhKTsKICBsZXQgcmVzaWR1YWwgPSBpc0NsYXNzQmFzZWQgPyB0Tm9kZS5yZXNpZHVhbENsYXNzZXMgOiB0Tm9kZS5yZXNpZHVhbFN0eWxlczsKICBpZiAoaG9zdERpcmVjdGl2ZURlZiA9PT0gbnVsbCkgewogICAgY29uc3QgaXNGaXJzdFN0eWxpbmdJbnN0cnVjdGlvbkluVGVtcGxhdGUgPSAoaXNDbGFzc0Jhc2VkID8gdE5vZGUuY2xhc3NCaW5kaW5ncyA6IHROb2RlLnN0eWxlQmluZGluZ3MpID09PSAwOwogICAgaWYgKGlzRmlyc3RTdHlsaW5nSW5zdHJ1Y3Rpb25JblRlbXBsYXRlKSB7CiAgICAgIHN0eWxpbmdLZXkgPSBjb2xsZWN0U3R5bGluZ0Zyb21EaXJlY3RpdmVzKG51bGwsIHREYXRhLCB0Tm9kZSwgc3R5bGluZ0tleSwgaXNDbGFzc0Jhc2VkKTsKICAgICAgc3R5bGluZ0tleSA9IGNvbGxlY3RTdHlsaW5nRnJvbVRBdHRycyhzdHlsaW5nS2V5LCB0Tm9kZS5hdHRycywgaXNDbGFzc0Jhc2VkKTsKICAgICAgcmVzaWR1YWwgPSBudWxsOwogICAgfQogIH0gZWxzZSB7CiAgICBjb25zdCBkaXJlY3RpdmVTdHlsaW5nTGFzdCA9IHROb2RlLmRpcmVjdGl2ZVN0eWxpbmdMYXN0OwogICAgY29uc3QgaXNGaXJzdFN0eWxpbmdJbnN0cnVjdGlvbkluSG9zdEJpbmRpbmcgPSBkaXJlY3RpdmVTdHlsaW5nTGFzdCA9PT0gLTEgfHwgdERhdGFbZGlyZWN0aXZlU3R5bGluZ0xhc3RdICE9PSBob3N0RGlyZWN0aXZlRGVmOwogICAgaWYgKGlzRmlyc3RTdHlsaW5nSW5zdHJ1Y3Rpb25Jbkhvc3RCaW5kaW5nKSB7CiAgICAgIHN0eWxpbmdLZXkgPSBjb2xsZWN0U3R5bGluZ0Zyb21EaXJlY3RpdmVzKGhvc3REaXJlY3RpdmVEZWYsIHREYXRhLCB0Tm9kZSwgc3R5bGluZ0tleSwgaXNDbGFzc0Jhc2VkKTsKICAgICAgaWYgKHJlc2lkdWFsID09PSBudWxsKSB7CiAgICAgICAgbGV0IHRlbXBsYXRlU3R5bGluZ0tleSA9IGdldFRlbXBsYXRlSGVhZFRTdHlsaW5nS2V5KHREYXRhLCB0Tm9kZSwgaXNDbGFzc0Jhc2VkKTsKICAgICAgICBpZiAodGVtcGxhdGVTdHlsaW5nS2V5ICE9PSB2b2lkIDAgJiYgQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZVN0eWxpbmdLZXkpKSB7CiAgICAgICAgICB0ZW1wbGF0ZVN0eWxpbmdLZXkgPSBjb2xsZWN0U3R5bGluZ0Zyb21EaXJlY3RpdmVzKG51bGwsIHREYXRhLCB0Tm9kZSwgdGVtcGxhdGVTdHlsaW5nS2V5WzFdLCBpc0NsYXNzQmFzZWQpOwogICAgICAgICAgdGVtcGxhdGVTdHlsaW5nS2V5ID0gY29sbGVjdFN0eWxpbmdGcm9tVEF0dHJzKHRlbXBsYXRlU3R5bGluZ0tleSwgdE5vZGUuYXR0cnMsIGlzQ2xhc3NCYXNlZCk7CiAgICAgICAgICBzZXRUZW1wbGF0ZUhlYWRUU3R5bGluZ0tleSh0RGF0YSwgdE5vZGUsIGlzQ2xhc3NCYXNlZCwgdGVtcGxhdGVTdHlsaW5nS2V5KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzaWR1YWwgPSBjb2xsZWN0UmVzaWR1YWwodERhdGEsIHROb2RlLCBpc0NsYXNzQmFzZWQpOwogICAgICB9CiAgICB9CiAgfQogIGlmIChyZXNpZHVhbCAhPT0gdm9pZCAwKSB7CiAgICBpc0NsYXNzQmFzZWQgPyB0Tm9kZS5yZXNpZHVhbENsYXNzZXMgPSByZXNpZHVhbCA6IHROb2RlLnJlc2lkdWFsU3R5bGVzID0gcmVzaWR1YWw7CiAgfQogIHJldHVybiBzdHlsaW5nS2V5Owp9CmZ1bmN0aW9uIGdldFRlbXBsYXRlSGVhZFRTdHlsaW5nS2V5KHREYXRhLCB0Tm9kZSwgaXNDbGFzc0Jhc2VkKSB7CiAgY29uc3QgYmluZGluZ3MgPSBpc0NsYXNzQmFzZWQgPyB0Tm9kZS5jbGFzc0JpbmRpbmdzIDogdE5vZGUuc3R5bGVCaW5kaW5nczsKICBpZiAoZ2V0VFN0eWxpbmdSYW5nZU5leHQoYmluZGluZ3MpID09PSAwKSB7CiAgICByZXR1cm4gdm9pZCAwOwogIH0KICByZXR1cm4gdERhdGFbZ2V0VFN0eWxpbmdSYW5nZVByZXYoYmluZGluZ3MpXTsKfQpmdW5jdGlvbiBzZXRUZW1wbGF0ZUhlYWRUU3R5bGluZ0tleSh0RGF0YSwgdE5vZGUsIGlzQ2xhc3NCYXNlZCwgdFN0eWxpbmdLZXkpIHsKICBjb25zdCBiaW5kaW5ncyA9IGlzQ2xhc3NCYXNlZCA/IHROb2RlLmNsYXNzQmluZGluZ3MgOiB0Tm9kZS5zdHlsZUJpbmRpbmdzOwogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3RFcXVhbChnZXRUU3R5bGluZ1JhbmdlTmV4dChiaW5kaW5ncyksIDAsICJFeHBlY3RpbmcgdG8gaGF2ZSBhdCBsZWFzdCBvbmUgdGVtcGxhdGUgc3R5bGluZyBiaW5kaW5nLiIpOwogIHREYXRhW2dldFRTdHlsaW5nUmFuZ2VQcmV2KGJpbmRpbmdzKV0gPSB0U3R5bGluZ0tleTsKfQpmdW5jdGlvbiBjb2xsZWN0UmVzaWR1YWwodERhdGEsIHROb2RlLCBpc0NsYXNzQmFzZWQpIHsKICBsZXQgcmVzaWR1YWwgPSB2b2lkIDA7CiAgY29uc3QgZGlyZWN0aXZlRW5kID0gdE5vZGUuZGlyZWN0aXZlRW5kOwogIG5nRGV2TW9kZSAmJiBhc3NlcnROb3RFcXVhbCh0Tm9kZS5kaXJlY3RpdmVTdHlsaW5nTGFzdCwgLTEsICJCeSB0aGUgdGltZSB0aGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGF0IGxlYXN0IG9uZSBob3N0QmluZGluZ3Mtbm9kZSBzdHlsaW5nIGluc3RydWN0aW9uIG11c3QgaGF2ZSBleGVjdXRlZC4iKTsKICBmb3IgKGxldCBpID0gMSArIHROb2RlLmRpcmVjdGl2ZVN0eWxpbmdMYXN0OyBpIDwgZGlyZWN0aXZlRW5kOyBpKyspIHsKICAgIGNvbnN0IGF0dHJzID0gdERhdGFbaV0uaG9zdEF0dHJzOwogICAgcmVzaWR1YWwgPSBjb2xsZWN0U3R5bGluZ0Zyb21UQXR0cnMocmVzaWR1YWwsIGF0dHJzLCBpc0NsYXNzQmFzZWQpOwogIH0KICByZXR1cm4gY29sbGVjdFN0eWxpbmdGcm9tVEF0dHJzKHJlc2lkdWFsLCB0Tm9kZS5hdHRycywgaXNDbGFzc0Jhc2VkKTsKfQpmdW5jdGlvbiBjb2xsZWN0U3R5bGluZ0Zyb21EaXJlY3RpdmVzKGhvc3REaXJlY3RpdmVEZWYsIHREYXRhLCB0Tm9kZSwgc3R5bGluZ0tleSwgaXNDbGFzc0Jhc2VkKSB7CiAgbGV0IGN1cnJlbnREaXJlY3RpdmUgPSBudWxsOwogIGNvbnN0IGRpcmVjdGl2ZUVuZCA9IHROb2RlLmRpcmVjdGl2ZUVuZDsKICBsZXQgZGlyZWN0aXZlU3R5bGluZ0xhc3QgPSB0Tm9kZS5kaXJlY3RpdmVTdHlsaW5nTGFzdDsKICBpZiAoZGlyZWN0aXZlU3R5bGluZ0xhc3QgPT09IC0xKSB7CiAgICBkaXJlY3RpdmVTdHlsaW5nTGFzdCA9IHROb2RlLmRpcmVjdGl2ZVN0YXJ0OwogIH0gZWxzZSB7CiAgICBkaXJlY3RpdmVTdHlsaW5nTGFzdCsrOwogIH0KICB3aGlsZSAoZGlyZWN0aXZlU3R5bGluZ0xhc3QgPCBkaXJlY3RpdmVFbmQpIHsKICAgIGN1cnJlbnREaXJlY3RpdmUgPSB0RGF0YVtkaXJlY3RpdmVTdHlsaW5nTGFzdF07CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RGVmaW5lZChjdXJyZW50RGlyZWN0aXZlLCAiZXhwZWN0ZWQgdG8gYmUgZGVmaW5lZCIpOwogICAgc3R5bGluZ0tleSA9IGNvbGxlY3RTdHlsaW5nRnJvbVRBdHRycyhzdHlsaW5nS2V5LCBjdXJyZW50RGlyZWN0aXZlLmhvc3RBdHRycywgaXNDbGFzc0Jhc2VkKTsKICAgIGlmIChjdXJyZW50RGlyZWN0aXZlID09PSBob3N0RGlyZWN0aXZlRGVmKSBicmVhazsKICAgIGRpcmVjdGl2ZVN0eWxpbmdMYXN0Kys7CiAgfQogIGlmIChob3N0RGlyZWN0aXZlRGVmICE9PSBudWxsKSB7CiAgICB0Tm9kZS5kaXJlY3RpdmVTdHlsaW5nTGFzdCA9IGRpcmVjdGl2ZVN0eWxpbmdMYXN0OwogIH0KICByZXR1cm4gc3R5bGluZ0tleTsKfQpmdW5jdGlvbiBjb2xsZWN0U3R5bGluZ0Zyb21UQXR0cnMoc3R5bGluZ0tleSwgYXR0cnMsIGlzQ2xhc3NCYXNlZCkgewogIGNvbnN0IGRlc2lyZWRNYXJrZXIgPSBpc0NsYXNzQmFzZWQgPyAxIDogMjsKICBsZXQgY3VycmVudE1hcmtlciA9IC0xOwogIGlmIChhdHRycyAhPT0gbnVsbCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRycy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBpdGVtID0gYXR0cnNbaV07CiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gIm51bWJlciIpIHsKICAgICAgICBjdXJyZW50TWFya2VyID0gaXRlbTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoY3VycmVudE1hcmtlciA9PT0gZGVzaXJlZE1hcmtlcikgewogICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN0eWxpbmdLZXkpKSB7CiAgICAgICAgICAgIHN0eWxpbmdLZXkgPSBzdHlsaW5nS2V5ID09PSB2b2lkIDAgPyBbXSA6IFsiIiwgc3R5bGluZ0tleV07CiAgICAgICAgICB9CiAgICAgICAgICBrZXlWYWx1ZUFycmF5U2V0KHN0eWxpbmdLZXksIGl0ZW0sIGlzQ2xhc3NCYXNlZCA/IHRydWUgOiBhdHRyc1srK2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHN0eWxpbmdLZXkgPT09IHZvaWQgMCA/IG51bGwgOiBzdHlsaW5nS2V5Owp9CmZ1bmN0aW9uIHRvU3R5bGluZ0tleVZhbHVlQXJyYXkoa2V5VmFsdWVBcnJheVNldDIsIHN0cmluZ1BhcnNlciwgdmFsdWUpIHsKICBpZiAodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gIiIpIHJldHVybiBFTVBUWV9BUlJBWTsKICBjb25zdCBzdHlsZUtleVZhbHVlQXJyYXkgPSBbXTsKICBjb25zdCB1bndyYXBwZWRWYWx1ZSA9IHVud3JhcFNhZmVWYWx1ZSh2YWx1ZSk7CiAgaWYgKEFycmF5LmlzQXJyYXkodW53cmFwcGVkVmFsdWUpKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVud3JhcHBlZFZhbHVlLmxlbmd0aDsgaSsrKSB7CiAgICAgIGtleVZhbHVlQXJyYXlTZXQyKHN0eWxlS2V5VmFsdWVBcnJheSwgdW53cmFwcGVkVmFsdWVbaV0sIHRydWUpOwogICAgfQogIH0gZWxzZSBpZiAodW53cmFwcGVkVmFsdWUgaW5zdGFuY2VvZiBTZXQpIHsKICAgIGZvciAoY29uc3QgY3VycmVudCBvZiB1bndyYXBwZWRWYWx1ZSkgewogICAgICBrZXlWYWx1ZUFycmF5U2V0MihzdHlsZUtleVZhbHVlQXJyYXksIGN1cnJlbnQsIHRydWUpOwogICAgfQogIH0gZWxzZSBpZiAodHlwZW9mIHVud3JhcHBlZFZhbHVlID09PSAib2JqZWN0IikgewogICAgZm9yIChjb25zdCBrZXkgaW4gdW53cmFwcGVkVmFsdWUpIHsKICAgICAgaWYgKHVud3JhcHBlZFZhbHVlLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICBrZXlWYWx1ZUFycmF5U2V0MihzdHlsZUtleVZhbHVlQXJyYXksIGtleSwgdW53cmFwcGVkVmFsdWVba2V5XSk7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKHR5cGVvZiB1bndyYXBwZWRWYWx1ZSA9PT0gInN0cmluZyIpIHsKICAgIHN0cmluZ1BhcnNlcihzdHlsZUtleVZhbHVlQXJyYXksIHVud3JhcHBlZFZhbHVlKTsKICB9IGVsc2UgewogICAgbmdEZXZNb2RlICYmIHRocm93RXJyb3IyKCJVbnN1cHBvcnRlZCBzdHlsaW5nIHR5cGU6ICIgKyB0eXBlb2YgdW53cmFwcGVkVmFsdWUgKyAiICgiICsgdW53cmFwcGVkVmFsdWUgKyAiKSIpOwogIH0KICByZXR1cm4gc3R5bGVLZXlWYWx1ZUFycmF5Owp9CmZ1bmN0aW9uIHN0eWxlS2V5VmFsdWVBcnJheVNldChrZXlWYWx1ZUFycmF5LCBrZXksIHZhbHVlKSB7CiAga2V5VmFsdWVBcnJheVNldChrZXlWYWx1ZUFycmF5LCBrZXksIHVud3JhcFNhZmVWYWx1ZSh2YWx1ZSkpOwp9CmZ1bmN0aW9uIGNsYXNzS2V5VmFsdWVBcnJheVNldChrZXlWYWx1ZUFycmF5LCBrZXksIHZhbHVlKSB7CiAgY29uc3Qgc3RyaW5nS2V5ID0gU3RyaW5nKGtleSk7CiAgaWYgKHN0cmluZ0tleSAhPT0gIiIgJiYgIXN0cmluZ0tleS5pbmNsdWRlcygiICIpKSB7CiAgICBrZXlWYWx1ZUFycmF5U2V0KGtleVZhbHVlQXJyYXksIHN0cmluZ0tleSwgdmFsdWUpOwogIH0KfQpmdW5jdGlvbiB1cGRhdGVTdHlsaW5nTWFwKHRWaWV3LCB0Tm9kZSwgbFZpZXcsIHJlbmRlcmVyLCBvbGRLZXlWYWx1ZUFycmF5LCBuZXdLZXlWYWx1ZUFycmF5LCBpc0NsYXNzQmFzZWQsIGJpbmRpbmdJbmRleCkgewogIGlmIChvbGRLZXlWYWx1ZUFycmF5ID09PSBOT19DSEFOR0UpIHsKICAgIG9sZEtleVZhbHVlQXJyYXkgPSBFTVBUWV9BUlJBWTsKICB9CiAgbGV0IG9sZEluZGV4ID0gMDsKICBsZXQgbmV3SW5kZXggPSAwOwogIGxldCBvbGRLZXkgPSAwIDwgb2xkS2V5VmFsdWVBcnJheS5sZW5ndGggPyBvbGRLZXlWYWx1ZUFycmF5WzBdIDogbnVsbDsKICBsZXQgbmV3S2V5ID0gMCA8IG5ld0tleVZhbHVlQXJyYXkubGVuZ3RoID8gbmV3S2V5VmFsdWVBcnJheVswXSA6IG51bGw7CiAgd2hpbGUgKG9sZEtleSAhPT0gbnVsbCB8fCBuZXdLZXkgIT09IG51bGwpIHsKICAgIG5nRGV2TW9kZSAmJiBhc3NlcnRMZXNzVGhhbihvbGRJbmRleCwgOTk5LCAiQXJlIHdlIHN0dWNrIGluIGluZmluaXRlIGxvb3A/Iik7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TGVzc1RoYW4obmV3SW5kZXgsIDk5OSwgIkFyZSB3ZSBzdHVjayBpbiBpbmZpbml0ZSBsb29wPyIpOwogICAgY29uc3Qgb2xkVmFsdWUgPSBvbGRJbmRleCA8IG9sZEtleVZhbHVlQXJyYXkubGVuZ3RoID8gb2xkS2V5VmFsdWVBcnJheVtvbGRJbmRleCArIDFdIDogdm9pZCAwOwogICAgY29uc3QgbmV3VmFsdWUgPSBuZXdJbmRleCA8IG5ld0tleVZhbHVlQXJyYXkubGVuZ3RoID8gbmV3S2V5VmFsdWVBcnJheVtuZXdJbmRleCArIDFdIDogdm9pZCAwOwogICAgbGV0IHNldEtleSA9IG51bGw7CiAgICBsZXQgc2V0VmFsdWUgPSB2b2lkIDA7CiAgICBpZiAob2xkS2V5ID09PSBuZXdLZXkpIHsKICAgICAgb2xkSW5kZXggKz0gMjsKICAgICAgbmV3SW5kZXggKz0gMjsKICAgICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkgewogICAgICAgIHNldEtleSA9IG5ld0tleTsKICAgICAgICBzZXRWYWx1ZSA9IG5ld1ZhbHVlOwogICAgICB9CiAgICB9IGVsc2UgaWYgKG5ld0tleSA9PT0gbnVsbCB8fCBvbGRLZXkgIT09IG51bGwgJiYgb2xkS2V5IDwgbmV3S2V5KSB7CiAgICAgIG9sZEluZGV4ICs9IDI7CiAgICAgIHNldEtleSA9IG9sZEtleTsKICAgIH0gZWxzZSB7CiAgICAgIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKG5ld0tleSwgIkV4cGVjdGluZyB0byBoYXZlIGEgdmFsaWQga2V5Iik7CiAgICAgIG5ld0luZGV4ICs9IDI7CiAgICAgIHNldEtleSA9IG5ld0tleTsKICAgICAgc2V0VmFsdWUgPSBuZXdWYWx1ZTsKICAgIH0KICAgIGlmIChzZXRLZXkgIT09IG51bGwpIHsKICAgICAgdXBkYXRlU3R5bGluZyh0VmlldywgdE5vZGUsIGxWaWV3LCByZW5kZXJlciwgc2V0S2V5LCBzZXRWYWx1ZSwgaXNDbGFzc0Jhc2VkLCBiaW5kaW5nSW5kZXgpOwogICAgfQogICAgb2xkS2V5ID0gb2xkSW5kZXggPCBvbGRLZXlWYWx1ZUFycmF5Lmxlbmd0aCA/IG9sZEtleVZhbHVlQXJyYXlbb2xkSW5kZXhdIDogbnVsbDsKICAgIG5ld0tleSA9IG5ld0luZGV4IDwgbmV3S2V5VmFsdWVBcnJheS5sZW5ndGggPyBuZXdLZXlWYWx1ZUFycmF5W25ld0luZGV4XSA6IG51bGw7CiAgfQp9CmZ1bmN0aW9uIHVwZGF0ZVN0eWxpbmcodFZpZXcsIHROb2RlLCBsVmlldywgcmVuZGVyZXIsIHByb3AsIHZhbHVlLCBpc0NsYXNzQmFzZWQsIGJpbmRpbmdJbmRleCkgewogIGlmICghKHROb2RlLnR5cGUgJiAzKSkgewogICAgcmV0dXJuOwogIH0KICBjb25zdCB0RGF0YSA9IHRWaWV3LmRhdGE7CiAgY29uc3QgdFJhbmdlID0gdERhdGFbYmluZGluZ0luZGV4ICsgMV07CiAgY29uc3QgaGlnaGVyUHJpb3JpdHlWYWx1ZSA9IGdldFRTdHlsaW5nUmFuZ2VOZXh0RHVwbGljYXRlKHRSYW5nZSkgPyBmaW5kU3R5bGluZ1ZhbHVlKHREYXRhLCB0Tm9kZSwgbFZpZXcsIHByb3AsIGdldFRTdHlsaW5nUmFuZ2VOZXh0KHRSYW5nZSksIGlzQ2xhc3NCYXNlZCkgOiB2b2lkIDA7CiAgaWYgKCFpc1N0eWxpbmdWYWx1ZVByZXNlbnQoaGlnaGVyUHJpb3JpdHlWYWx1ZSkpIHsKICAgIGlmICghaXNTdHlsaW5nVmFsdWVQcmVzZW50KHZhbHVlKSkgewogICAgICBpZiAoZ2V0VFN0eWxpbmdSYW5nZVByZXZEdXBsaWNhdGUodFJhbmdlKSkgewogICAgICAgIHZhbHVlID0gZmluZFN0eWxpbmdWYWx1ZSh0RGF0YSwgbnVsbCwgbFZpZXcsIHByb3AsIGJpbmRpbmdJbmRleCwgaXNDbGFzc0Jhc2VkKTsKICAgICAgfQogICAgfQogICAgY29uc3Qgck5vZGUgPSBnZXROYXRpdmVCeUluZGV4KGdldFNlbGVjdGVkSW5kZXgoKSwgbFZpZXcpOwogICAgYXBwbHlTdHlsaW5nKHJlbmRlcmVyLCBpc0NsYXNzQmFzZWQsIHJOb2RlLCBwcm9wLCB2YWx1ZSk7CiAgfQp9CmZ1bmN0aW9uIGZpbmRTdHlsaW5nVmFsdWUodERhdGEsIHROb2RlLCBsVmlldywgcHJvcCwgaW5kZXgsIGlzQ2xhc3NCYXNlZCkgewogIGNvbnN0IGlzUHJldkRpcmVjdGlvbiA9IHROb2RlID09PSBudWxsOwogIGxldCB2YWx1ZSA9IHZvaWQgMDsKICB3aGlsZSAoaW5kZXggPiAwKSB7CiAgICBjb25zdCByYXdLZXkgPSB0RGF0YVtpbmRleF07CiAgICBjb25zdCBjb250YWluc1N0YXRpY3MgPSBBcnJheS5pc0FycmF5KHJhd0tleSk7CiAgICBjb25zdCBrZXkgPSBjb250YWluc1N0YXRpY3MgPyByYXdLZXlbMV0gOiByYXdLZXk7CiAgICBjb25zdCBpc1N0eWxpbmdNYXAgPSBrZXkgPT09IG51bGw7CiAgICBsZXQgdmFsdWVBdExWaWV3SW5kZXggPSBsVmlld1tpbmRleCArIDFdOwogICAgaWYgKHZhbHVlQXRMVmlld0luZGV4ID09PSBOT19DSEFOR0UpIHsKICAgICAgdmFsdWVBdExWaWV3SW5kZXggPSBpc1N0eWxpbmdNYXAgPyBFTVBUWV9BUlJBWSA6IHZvaWQgMDsKICAgIH0KICAgIGxldCBjdXJyZW50VmFsdWUgPSBpc1N0eWxpbmdNYXAgPyBrZXlWYWx1ZUFycmF5R2V0KHZhbHVlQXRMVmlld0luZGV4LCBwcm9wKSA6IGtleSA9PT0gcHJvcCA/IHZhbHVlQXRMVmlld0luZGV4IDogdm9pZCAwOwogICAgaWYgKGNvbnRhaW5zU3RhdGljcyAmJiAhaXNTdHlsaW5nVmFsdWVQcmVzZW50KGN1cnJlbnRWYWx1ZSkpIHsKICAgICAgY3VycmVudFZhbHVlID0ga2V5VmFsdWVBcnJheUdldChyYXdLZXksIHByb3ApOwogICAgfQogICAgaWYgKGlzU3R5bGluZ1ZhbHVlUHJlc2VudChjdXJyZW50VmFsdWUpKSB7CiAgICAgIHZhbHVlID0gY3VycmVudFZhbHVlOwogICAgICBpZiAoaXNQcmV2RGlyZWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICB9CiAgICB9CiAgICBjb25zdCB0UmFuZ2UgPSB0RGF0YVtpbmRleCArIDFdOwogICAgaW5kZXggPSBpc1ByZXZEaXJlY3Rpb24gPyBnZXRUU3R5bGluZ1JhbmdlUHJldih0UmFuZ2UpIDogZ2V0VFN0eWxpbmdSYW5nZU5leHQodFJhbmdlKTsKICB9CiAgaWYgKHROb2RlICE9PSBudWxsKSB7CiAgICBsZXQgcmVzaWR1YWwgPSBpc0NsYXNzQmFzZWQgPyB0Tm9kZS5yZXNpZHVhbENsYXNzZXMgOiB0Tm9kZS5yZXNpZHVhbFN0eWxlczsKICAgIGlmIChyZXNpZHVhbCAhPSBudWxsKSB7CiAgICAgIHZhbHVlID0ga2V5VmFsdWVBcnJheUdldChyZXNpZHVhbCwgcHJvcCk7CiAgICB9CiAgfQogIHJldHVybiB2YWx1ZTsKfQpmdW5jdGlvbiBpc1N0eWxpbmdWYWx1ZVByZXNlbnQodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgIT09IHZvaWQgMDsKfQpmdW5jdGlvbiBub3JtYWxpemVTdWZmaXgodmFsdWUsIHN1ZmZpeCkgewogIGlmICh2YWx1ZSA9PSBudWxsIHx8IHZhbHVlID09PSAiIikgOwogIGVsc2UgaWYgKHR5cGVvZiBzdWZmaXggPT09ICJzdHJpbmciKSB7CiAgICB2YWx1ZSA9IHZhbHVlICsgc3VmZml4OwogIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAib2JqZWN0IikgewogICAgdmFsdWUgPSBzdHJpbmdpZnkodW53cmFwU2FmZVZhbHVlKHZhbHVlKSk7CiAgfQogIHJldHVybiB2YWx1ZTsKfQpmdW5jdGlvbiBoYXNTdHlsaW5nSW5wdXRTaGFkb3codE5vZGUsIGlzQ2xhc3NCYXNlZCkgewogIHJldHVybiAodE5vZGUuZmxhZ3MgJiAoaXNDbGFzc0Jhc2VkID8gOCA6IDE2KSkgIT09IDA7Cn0KZnVuY3Rpb24gybXJtXRleHQoaW5kZXgsIHZhbHVlID0gIiIpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBpbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlQ3JlYXRpb25JbmRleChsVmlldywgaW5kZXgpOwogIGNvbnN0IHROb2RlID0gdFZpZXcuZmlyc3RDcmVhdGVQYXNzID8gZ2V0T3JDcmVhdGVUTm9kZSh0VmlldywgYWRqdXN0ZWRJbmRleCwgMSwgdmFsdWUsIG51bGwpIDogdFZpZXcuZGF0YVthZGp1c3RlZEluZGV4XTsKICBjb25zdCB0ZXh0TmF0aXZlID0gX2xvY2F0ZU9yQ3JlYXRlVGV4dE5vZGUodFZpZXcsIGxWaWV3LCB0Tm9kZSwgdmFsdWUpOwogIGxWaWV3W2FkanVzdGVkSW5kZXhdID0gdGV4dE5hdGl2ZTsKICBpZiAod2FzTGFzdE5vZGVDcmVhdGVkKCkpIHsKICAgIGFwcGVuZENoaWxkKHRWaWV3LCBsVmlldywgdGV4dE5hdGl2ZSwgdE5vZGUpOwogIH0KICBzZXRDdXJyZW50VE5vZGUodE5vZGUsIGZhbHNlKTsKfQp2YXIgX2xvY2F0ZU9yQ3JlYXRlVGV4dE5vZGUgPSAodFZpZXcsIGxWaWV3LCB0Tm9kZSwgdmFsdWUpID0+IHsKICBsYXN0Tm9kZVdhc0NyZWF0ZWQodHJ1ZSk7CiAgcmV0dXJuIGNyZWF0ZVRleHROb2RlKGxWaWV3W1JFTkRFUkVSXSwgdmFsdWUpOwp9OwpmdW5jdGlvbiBsb2NhdGVPckNyZWF0ZVRleHROb2RlSW1wbCh0VmlldywgbFZpZXcsIHROb2RlLCB2YWx1ZSkgewogIGNvbnN0IGlzTm9kZUNyZWF0aW9uTW9kZSA9ICFjYW5IeWRyYXRlTm9kZShsVmlldywgdE5vZGUpOwogIGxhc3ROb2RlV2FzQ3JlYXRlZChpc05vZGVDcmVhdGlvbk1vZGUpOwogIGlmIChpc05vZGVDcmVhdGlvbk1vZGUpIHsKICAgIHJldHVybiBjcmVhdGVUZXh0Tm9kZShsVmlld1tSRU5ERVJFUl0sIHZhbHVlKTsKICB9CiAgY29uc3QgaHlkcmF0aW9uSW5mbyA9IGxWaWV3W0hZRFJBVElPTl07CiAgY29uc3QgdGV4dE5hdGl2ZSA9IGxvY2F0ZU5leHRSTm9kZShoeWRyYXRpb25JbmZvLCB0VmlldywgbFZpZXcsIHROb2RlKTsKICBuZ0Rldk1vZGUgJiYgdmFsaWRhdGVNYXRjaGluZ05vZGUodGV4dE5hdGl2ZSwgTm9kZS5URVhUX05PREUsIG51bGwsIGxWaWV3LCB0Tm9kZSk7CiAgbmdEZXZNb2RlICYmIG1hcmtSTm9kZUFzQ2xhaW1lZEJ5SHlkcmF0aW9uKHRleHROYXRpdmUpOwogIHJldHVybiB0ZXh0TmF0aXZlOwp9CmZ1bmN0aW9uIGVuYWJsZUxvY2F0ZU9yQ3JlYXRlVGV4dE5vZGVJbXBsKCkgewogIF9sb2NhdGVPckNyZWF0ZVRleHROb2RlID0gbG9jYXRlT3JDcmVhdGVUZXh0Tm9kZUltcGw7Cn0KZnVuY3Rpb24gaW50ZXJwb2xhdGlvblYobFZpZXcsIHZhbHVlcykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRMZXNzVGhhbigyLCB2YWx1ZXMubGVuZ3RoLCAic2hvdWxkIGhhdmUgYXQgbGVhc3QgMyB2YWx1ZXMiKTsKICBsZXQgaXNCaW5kaW5nVXBkYXRlZCA9IGZhbHNlOwogIGxldCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nSW5kZXgoKTsKICBmb3IgKGxldCBpID0gMTsgaSA8IHZhbHVlcy5sZW5ndGg7IGkgKz0gMikgewogICAgaXNCaW5kaW5nVXBkYXRlZCA9IGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgrKywgdmFsdWVzW2ldKSB8fCBpc0JpbmRpbmdVcGRhdGVkOwogIH0KICBzZXRCaW5kaW5nSW5kZXgoYmluZGluZ0luZGV4KTsKICBpZiAoIWlzQmluZGluZ1VwZGF0ZWQpIHsKICAgIHJldHVybiBOT19DSEFOR0U7CiAgfQogIGxldCBjb250ZW50ID0gdmFsdWVzWzBdOwogIGZvciAobGV0IGkgPSAxOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSArPSAyKSB7CiAgICBjb250ZW50ICs9IHJlbmRlclN0cmluZ2lmeSh2YWx1ZXNbaV0pICsgKGkgKyAxICE9PSB2YWx1ZXMubGVuZ3RoID8gdmFsdWVzW2kgKyAxXSA6ICIiKTsKICB9CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KZnVuY3Rpb24gaW50ZXJwb2xhdGlvbjEobFZpZXcsIHByZWZpeCwgdjAsIHN1ZmZpeCA9ICIiKSB7CiAgY29uc3QgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQobFZpZXcsIG5leHRCaW5kaW5nSW5kZXgoKSwgdjApOwogIHJldHVybiBkaWZmZXJlbnQgPyBwcmVmaXggKyByZW5kZXJTdHJpbmdpZnkodjApICsgc3VmZml4IDogTk9fQ0hBTkdFOwp9CmZ1bmN0aW9uIGludGVycG9sYXRpb24yKGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIHN1ZmZpeCA9ICIiKSB7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gZ2V0QmluZGluZ0luZGV4KCk7CiAgY29uc3QgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQyKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHYwLCB2MSk7CiAgaW5jcmVtZW50QmluZGluZ0luZGV4KDIpOwogIHJldHVybiBkaWZmZXJlbnQgPyBwcmVmaXggKyByZW5kZXJTdHJpbmdpZnkodjApICsgaTAgKyByZW5kZXJTdHJpbmdpZnkodjEpICsgc3VmZml4IDogTk9fQ0hBTkdFOwp9CmZ1bmN0aW9uIGludGVycG9sYXRpb24zKGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2Miwgc3VmZml4ID0gIiIpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nSW5kZXgoKTsKICBjb25zdCBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDMobFZpZXcsIGJpbmRpbmdJbmRleCwgdjAsIHYxLCB2Mik7CiAgaW5jcmVtZW50QmluZGluZ0luZGV4KDMpOwogIHJldHVybiBkaWZmZXJlbnQgPyBwcmVmaXggKyByZW5kZXJTdHJpbmdpZnkodjApICsgaTAgKyByZW5kZXJTdHJpbmdpZnkodjEpICsgaTEgKyByZW5kZXJTdHJpbmdpZnkodjIpICsgc3VmZml4IDogTk9fQ0hBTkdFOwp9CmZ1bmN0aW9uIGludGVycG9sYXRpb240KGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBzdWZmaXggPSAiIikgewogIGNvbnN0IGJpbmRpbmdJbmRleCA9IGdldEJpbmRpbmdJbmRleCgpOwogIGNvbnN0IGRpZmZlcmVudCA9IGJpbmRpbmdVcGRhdGVkNChsVmlldywgYmluZGluZ0luZGV4LCB2MCwgdjEsIHYyLCB2Myk7CiAgaW5jcmVtZW50QmluZGluZ0luZGV4KDQpOwogIHJldHVybiBkaWZmZXJlbnQgPyBwcmVmaXggKyByZW5kZXJTdHJpbmdpZnkodjApICsgaTAgKyByZW5kZXJTdHJpbmdpZnkodjEpICsgaTEgKyByZW5kZXJTdHJpbmdpZnkodjIpICsgaTIgKyByZW5kZXJTdHJpbmdpZnkodjMpICsgc3VmZml4IDogTk9fQ0hBTkdFOwp9CmZ1bmN0aW9uIGludGVycG9sYXRpb241KGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIHN1ZmZpeCA9ICIiKSB7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gZ2V0QmluZGluZ0luZGV4KCk7CiAgbGV0IGRpZmZlcmVudCA9IGJpbmRpbmdVcGRhdGVkNChsVmlldywgYmluZGluZ0luZGV4LCB2MCwgdjEsIHYyLCB2Myk7CiAgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQobFZpZXcsIGJpbmRpbmdJbmRleCArIDQsIHY0KSB8fCBkaWZmZXJlbnQ7CiAgaW5jcmVtZW50QmluZGluZ0luZGV4KDUpOwogIHJldHVybiBkaWZmZXJlbnQgPyBwcmVmaXggKyByZW5kZXJTdHJpbmdpZnkodjApICsgaTAgKyByZW5kZXJTdHJpbmdpZnkodjEpICsgaTEgKyByZW5kZXJTdHJpbmdpZnkodjIpICsgaTIgKyByZW5kZXJTdHJpbmdpZnkodjMpICsgaTMgKyByZW5kZXJTdHJpbmdpZnkodjQpICsgc3VmZml4IDogTk9fQ0hBTkdFOwp9CmZ1bmN0aW9uIGludGVycG9sYXRpb242KGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIGk0LCB2NSwgc3VmZml4ID0gIiIpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nSW5kZXgoKTsKICBsZXQgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIHYwLCB2MSwgdjIsIHYzKTsKICBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDIobFZpZXcsIGJpbmRpbmdJbmRleCArIDQsIHY0LCB2NSkgfHwgZGlmZmVyZW50OwogIGluY3JlbWVudEJpbmRpbmdJbmRleCg2KTsKICByZXR1cm4gZGlmZmVyZW50ID8gcHJlZml4ICsgcmVuZGVyU3RyaW5naWZ5KHYwKSArIGkwICsgcmVuZGVyU3RyaW5naWZ5KHYxKSArIGkxICsgcmVuZGVyU3RyaW5naWZ5KHYyKSArIGkyICsgcmVuZGVyU3RyaW5naWZ5KHYzKSArIGkzICsgcmVuZGVyU3RyaW5naWZ5KHY0KSArIGk0ICsgcmVuZGVyU3RyaW5naWZ5KHY1KSArIHN1ZmZpeCA6IE5PX0NIQU5HRTsKfQpmdW5jdGlvbiBpbnRlcnBvbGF0aW9uNyhsVmlldywgcHJlZml4LCB2MCwgaTAsIHYxLCBpMSwgdjIsIGkyLCB2MywgaTMsIHY0LCBpNCwgdjUsIGk1LCB2Niwgc3VmZml4ID0gIiIpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nSW5kZXgoKTsKICBsZXQgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIHYwLCB2MSwgdjIsIHYzKTsKICBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDMobFZpZXcsIGJpbmRpbmdJbmRleCArIDQsIHY0LCB2NSwgdjYpIHx8IGRpZmZlcmVudDsKICBpbmNyZW1lbnRCaW5kaW5nSW5kZXgoNyk7CiAgcmV0dXJuIGRpZmZlcmVudCA/IHByZWZpeCArIHJlbmRlclN0cmluZ2lmeSh2MCkgKyBpMCArIHJlbmRlclN0cmluZ2lmeSh2MSkgKyBpMSArIHJlbmRlclN0cmluZ2lmeSh2MikgKyBpMiArIHJlbmRlclN0cmluZ2lmeSh2MykgKyBpMyArIHJlbmRlclN0cmluZ2lmeSh2NCkgKyBpNCArIHJlbmRlclN0cmluZ2lmeSh2NSkgKyBpNSArIHJlbmRlclN0cmluZ2lmeSh2NikgKyBzdWZmaXggOiBOT19DSEFOR0U7Cn0KZnVuY3Rpb24gaW50ZXJwb2xhdGlvbjgobFZpZXcsIHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBpNSwgdjYsIGk2LCB2Nywgc3VmZml4ID0gIiIpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nSW5kZXgoKTsKICBsZXQgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIHYwLCB2MSwgdjIsIHYzKTsKICBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDQobFZpZXcsIGJpbmRpbmdJbmRleCArIDQsIHY0LCB2NSwgdjYsIHY3KSB8fCBkaWZmZXJlbnQ7CiAgaW5jcmVtZW50QmluZGluZ0luZGV4KDgpOwogIHJldHVybiBkaWZmZXJlbnQgPyBwcmVmaXggKyByZW5kZXJTdHJpbmdpZnkodjApICsgaTAgKyByZW5kZXJTdHJpbmdpZnkodjEpICsgaTEgKyByZW5kZXJTdHJpbmdpZnkodjIpICsgaTIgKyByZW5kZXJTdHJpbmdpZnkodjMpICsgaTMgKyByZW5kZXJTdHJpbmdpZnkodjQpICsgaTQgKyByZW5kZXJTdHJpbmdpZnkodjUpICsgaTUgKyByZW5kZXJTdHJpbmdpZnkodjYpICsgaTYgKyByZW5kZXJTdHJpbmdpZnkodjcpICsgc3VmZml4IDogTk9fQ0hBTkdFOwp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGUodjApIHsKICDJtcm1dGV4dEludGVycG9sYXRlMSgiIiwgdjApOwogIHJldHVybiDJtcm1dGV4dEludGVycG9sYXRlOwp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGUxKHByZWZpeCwgdjAsIHN1ZmZpeCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBpbnRlcnBvbGF0ZWQgPSBpbnRlcnBvbGF0aW9uMShsVmlldywgcHJlZml4LCB2MCwgc3VmZml4KTsKICBpZiAoaW50ZXJwb2xhdGVkICE9PSBOT19DSEFOR0UpIHsKICAgIHRleHRCaW5kaW5nSW50ZXJuYWwobFZpZXcsIGdldFNlbGVjdGVkSW5kZXgoKSwgaW50ZXJwb2xhdGVkKTsKICB9CiAgcmV0dXJuIMm1ybV0ZXh0SW50ZXJwb2xhdGUxOwp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGUyKHByZWZpeCwgdjAsIGkwLCB2MSwgc3VmZml4KSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGludGVycG9sYXRlZCA9IGludGVycG9sYXRpb24yKGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIHN1ZmZpeCk7CiAgaWYgKGludGVycG9sYXRlZCAhPT0gTk9fQ0hBTkdFKSB7CiAgICB0ZXh0QmluZGluZ0ludGVybmFsKGxWaWV3LCBnZXRTZWxlY3RlZEluZGV4KCksIGludGVycG9sYXRlZCk7CiAgfQogIHJldHVybiDJtcm1dGV4dEludGVycG9sYXRlMjsKfQpmdW5jdGlvbiDJtcm1dGV4dEludGVycG9sYXRlMyhwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2Miwgc3VmZml4KSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGludGVycG9sYXRlZCA9IGludGVycG9sYXRpb24zKGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2Miwgc3VmZml4KTsKICBpZiAoaW50ZXJwb2xhdGVkICE9PSBOT19DSEFOR0UpIHsKICAgIHRleHRCaW5kaW5nSW50ZXJuYWwobFZpZXcsIGdldFNlbGVjdGVkSW5kZXgoKSwgaW50ZXJwb2xhdGVkKTsKICB9CiAgcmV0dXJuIMm1ybV0ZXh0SW50ZXJwb2xhdGUzOwp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGU0KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIHN1ZmZpeCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBpbnRlcnBvbGF0ZWQgPSBpbnRlcnBvbGF0aW9uNChsVmlldywgcHJlZml4LCB2MCwgaTAsIHYxLCBpMSwgdjIsIGkyLCB2Mywgc3VmZml4KTsKICBpZiAoaW50ZXJwb2xhdGVkICE9PSBOT19DSEFOR0UpIHsKICAgIHRleHRCaW5kaW5nSW50ZXJuYWwobFZpZXcsIGdldFNlbGVjdGVkSW5kZXgoKSwgaW50ZXJwb2xhdGVkKTsKICB9CiAgcmV0dXJuIMm1ybV0ZXh0SW50ZXJwb2xhdGU0Owp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGU1KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgc3VmZml4KSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGludGVycG9sYXRlZCA9IGludGVycG9sYXRpb241KGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIHN1ZmZpeCk7CiAgaWYgKGludGVycG9sYXRlZCAhPT0gTk9fQ0hBTkdFKSB7CiAgICB0ZXh0QmluZGluZ0ludGVybmFsKGxWaWV3LCBnZXRTZWxlY3RlZEluZGV4KCksIGludGVycG9sYXRlZCk7CiAgfQogIHJldHVybiDJtcm1dGV4dEludGVycG9sYXRlNTsKfQpmdW5jdGlvbiDJtcm1dGV4dEludGVycG9sYXRlNihwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIGk0LCB2NSwgc3VmZml4KSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGludGVycG9sYXRlZCA9IGludGVycG9sYXRpb242KGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIGk0LCB2NSwgc3VmZml4KTsKICBpZiAoaW50ZXJwb2xhdGVkICE9PSBOT19DSEFOR0UpIHsKICAgIHRleHRCaW5kaW5nSW50ZXJuYWwobFZpZXcsIGdldFNlbGVjdGVkSW5kZXgoKSwgaW50ZXJwb2xhdGVkKTsKICB9CiAgcmV0dXJuIMm1ybV0ZXh0SW50ZXJwb2xhdGU2Owp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGU3KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBpNSwgdjYsIHN1ZmZpeCkgewogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBpbnRlcnBvbGF0ZWQgPSBpbnRlcnBvbGF0aW9uNyhsVmlldywgcHJlZml4LCB2MCwgaTAsIHYxLCBpMSwgdjIsIGkyLCB2MywgaTMsIHY0LCBpNCwgdjUsIGk1LCB2Niwgc3VmZml4KTsKICBpZiAoaW50ZXJwb2xhdGVkICE9PSBOT19DSEFOR0UpIHsKICAgIHRleHRCaW5kaW5nSW50ZXJuYWwobFZpZXcsIGdldFNlbGVjdGVkSW5kZXgoKSwgaW50ZXJwb2xhdGVkKTsKICB9CiAgcmV0dXJuIMm1ybV0ZXh0SW50ZXJwb2xhdGU3Owp9CmZ1bmN0aW9uIMm1ybV0ZXh0SW50ZXJwb2xhdGU4KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBpNSwgdjYsIGk2LCB2Nywgc3VmZml4KSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGludGVycG9sYXRlZCA9IGludGVycG9sYXRpb244KGxWaWV3LCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIGk0LCB2NSwgaTUsIHY2LCBpNiwgdjcsIHN1ZmZpeCk7CiAgaWYgKGludGVycG9sYXRlZCAhPT0gTk9fQ0hBTkdFKSB7CiAgICB0ZXh0QmluZGluZ0ludGVybmFsKGxWaWV3LCBnZXRTZWxlY3RlZEluZGV4KCksIGludGVycG9sYXRlZCk7CiAgfQogIHJldHVybiDJtcm1dGV4dEludGVycG9sYXRlODsKfQpmdW5jdGlvbiDJtcm1dGV4dEludGVycG9sYXRlVih2YWx1ZXMpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgaW50ZXJwb2xhdGVkID0gaW50ZXJwb2xhdGlvblYobFZpZXcsIHZhbHVlcyk7CiAgaWYgKGludGVycG9sYXRlZCAhPT0gTk9fQ0hBTkdFKSB7CiAgICB0ZXh0QmluZGluZ0ludGVybmFsKGxWaWV3LCBnZXRTZWxlY3RlZEluZGV4KCksIGludGVycG9sYXRlZCk7CiAgfQogIHJldHVybiDJtcm1dGV4dEludGVycG9sYXRlVjsKfQpmdW5jdGlvbiB0ZXh0QmluZGluZ0ludGVybmFsKGxWaWV3LCBpbmRleCwgdmFsdWUpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0U3RyaW5nKHZhbHVlLCAiVmFsdWUgc2hvdWxkIGJlIGEgc3RyaW5nIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydE5vdFNhbWUodmFsdWUsIE5PX0NIQU5HRSwgInZhbHVlIHNob3VsZCBub3QgYmUgTk9fQ0hBTkdFIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydEluZGV4SW5SYW5nZShsVmlldywgaW5kZXgpOwogIGNvbnN0IGVsZW1lbnQgPSBnZXROYXRpdmVCeUluZGV4KGluZGV4LCBsVmlldyk7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoZWxlbWVudCwgIm5hdGl2ZSBlbGVtZW50IHNob3VsZCBleGlzdCIpOwogIHVwZGF0ZVRleHROb2RlKGxWaWV3W1JFTkRFUkVSXSwgZWxlbWVudCwgdmFsdWUpOwp9CmZ1bmN0aW9uIMm1ybV0d29XYXlQcm9wZXJ0eShwcm9wTmFtZSwgdmFsdWUsIHNhbml0aXplcikgewogIGlmIChpc1dyaXRhYmxlU2lnbmFsKHZhbHVlKSkgewogICAgdmFsdWUgPSB2YWx1ZSgpOwogIH0KICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gbmV4dEJpbmRpbmdJbmRleCgpOwogIGlmIChiaW5kaW5nVXBkYXRlZChsVmlldywgYmluZGluZ0luZGV4LCB2YWx1ZSkpIHsKICAgIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICAgIGNvbnN0IHROb2RlID0gZ2V0U2VsZWN0ZWRUTm9kZSgpOwogICAgc2V0UHJvcGVydHlBbmRJbnB1dHModE5vZGUsIGxWaWV3LCBwcm9wTmFtZSwgdmFsdWUsIGxWaWV3W1JFTkRFUkVSXSwgc2FuaXRpemVyKTsKICAgIG5nRGV2TW9kZSAmJiBzdG9yZVByb3BlcnR5QmluZGluZ01ldGFkYXRhKHRWaWV3LmRhdGEsIHROb2RlLCBwcm9wTmFtZSwgYmluZGluZ0luZGV4KTsKICB9CiAgcmV0dXJuIMm1ybV0d29XYXlQcm9wZXJ0eTsKfQpmdW5jdGlvbiDJtcm1dHdvV2F5QmluZGluZ1NldCh0YXJnZXQsIHZhbHVlKSB7CiAgY29uc3QgY2FuV3JpdGUgPSBpc1dyaXRhYmxlU2lnbmFsKHRhcmdldCk7CiAgY2FuV3JpdGUgJiYgdGFyZ2V0LnNldCh2YWx1ZSk7CiAgcmV0dXJuIGNhbldyaXRlOwp9CmZ1bmN0aW9uIMm1ybV0d29XYXlMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyRm4pIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGNvbnN0IHROb2RlID0gZ2V0Q3VycmVudFROb2RlKCk7CiAgbGlzdGVuZXJJbnRlcm5hbCh0VmlldywgbFZpZXcsIGxWaWV3W1JFTkRFUkVSXSwgdE5vZGUsIGV2ZW50TmFtZSwgbGlzdGVuZXJGbik7CiAgcmV0dXJuIMm1ybV0d29XYXlMaXN0ZW5lcjsKfQp2YXIgVU5JTklUSUFMSVpFRF9MRVQgPSB7fTsKZnVuY3Rpb24gybXJtWRlY2xhcmVMZXQoaW5kZXgpIHsKICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0xldCIpOwogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgYWRqdXN0ZWRJbmRleCA9IGluZGV4ICsgSEVBREVSX09GRlNFVDsKICBjb25zdCB0Tm9kZSA9IGdldE9yQ3JlYXRlVE5vZGUodFZpZXcsIGFkanVzdGVkSW5kZXgsIDEyOCwgbnVsbCwgbnVsbCk7CiAgc2V0Q3VycmVudFROb2RlKHROb2RlLCBmYWxzZSk7CiAgc3RvcmUodFZpZXcsIGxWaWV3LCBhZGp1c3RlZEluZGV4LCBVTklOSVRJQUxJWkVEX0xFVCk7CiAgcmV0dXJuIMm1ybVkZWNsYXJlTGV0Owp9CmZ1bmN0aW9uIMm1ybVzdG9yZUxldCh2YWx1ZSkgewogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgaW5kZXggPSBnZXRTZWxlY3RlZEluZGV4KCk7CiAgc3RvcmUodFZpZXcsIGxWaWV3LCBpbmRleCwgdmFsdWUpOwogIHJldHVybiB2YWx1ZTsKfQpmdW5jdGlvbiDJtcm1cmVhZENvbnRleHRMZXQoaW5kZXgpIHsKICBjb25zdCBjb250ZXh0TFZpZXcgPSBnZXRDb250ZXh0TFZpZXcoKTsKICBjb25zdCB2YWx1ZSA9IGxvYWQoY29udGV4dExWaWV3LCBIRUFERVJfT0ZGU0VUICsgaW5kZXgpOwogIGlmICh2YWx1ZSA9PT0gVU5JTklUSUFMSVpFRF9MRVQpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMzE0LCBuZ0Rldk1vZGUgJiYgIkF0dGVtcHRpbmcgdG8gYWNjZXNzIGEgQGxldCBkZWNsYXJhdGlvbiB3aG9zZSB2YWx1ZSBpcyBub3QgYXZhaWxhYmxlIHlldCIpOwogIH0KICByZXR1cm4gdmFsdWU7Cn0KZnVuY3Rpb24gybXJtWF0dGFjaFNvdXJjZUxvY2F0aW9ucyh0ZW1wbGF0ZVBhdGgsIGxvY2F0aW9ucykgewogIGNvbnN0IHRWaWV3ID0gZ2V0VFZpZXcoKTsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgY29uc3QgYXR0cmlidXRlTmFtZTIgPSAiZGF0YS1uZy1zb3VyY2UtbG9jYXRpb24iOwogIGZvciAoY29uc3QgW2luZGV4LCBvZmZzZXQsIGxpbmUsIGNvbHVtbl0gb2YgbG9jYXRpb25zKSB7CiAgICBjb25zdCB0Tm9kZSA9IGdldFROb2RlKHRWaWV3LCBpbmRleCArIEhFQURFUl9PRkZTRVQpOwogICAgbmdEZXZNb2RlICYmIGFzc2VydFROb2RlVHlwZSh0Tm9kZSwgMik7CiAgICBjb25zdCBub2RlID0gZ2V0TmF0aXZlQnlJbmRleChpbmRleCArIEhFQURFUl9PRkZTRVQsIGxWaWV3KTsKICAgIGlmICghbm9kZS5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZTIpKSB7CiAgICAgIGNvbnN0IGF0dHJpYnV0ZVZhbHVlID0gYCR7dGVtcGxhdGVQYXRofUBvOiR7b2Zmc2V0fSxsOiR7bGluZX0sYzoke2NvbHVtbn1gOwogICAgICByZW5kZXJlci5zZXRBdHRyaWJ1dGUobm9kZSwgYXR0cmlidXRlTmFtZTIsIGF0dHJpYnV0ZVZhbHVlKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gybXJtWludGVycG9sYXRlKHYwKSB7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkKGdldExWaWV3KCksIG5leHRCaW5kaW5nSW5kZXgoKSwgdjApID8gcmVuZGVyU3RyaW5naWZ5KHYwKSA6IE5PX0NIQU5HRTsKfQpmdW5jdGlvbiDJtcm1aW50ZXJwb2xhdGUxKHByZWZpeCwgdjAsIHN1ZmZpeCA9ICIiKSB7CiAgcmV0dXJuIGludGVycG9sYXRpb24xKGdldExWaWV3KCksIHByZWZpeCwgdjAsIHN1ZmZpeCk7Cn0KZnVuY3Rpb24gybXJtWludGVycG9sYXRlMihwcmVmaXgsIHYwLCBpMCwgdjEsIHN1ZmZpeCA9ICIiKSB7CiAgcmV0dXJuIGludGVycG9sYXRpb24yKGdldExWaWV3KCksIHByZWZpeCwgdjAsIGkwLCB2MSwgc3VmZml4KTsKfQpmdW5jdGlvbiDJtcm1aW50ZXJwb2xhdGUzKHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBzdWZmaXggPSAiIikgewogIHJldHVybiBpbnRlcnBvbGF0aW9uMyhnZXRMVmlldygpLCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2Miwgc3VmZml4KTsKfQpmdW5jdGlvbiDJtcm1aW50ZXJwb2xhdGU0KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIHN1ZmZpeCA9ICIiKSB7CiAgcmV0dXJuIGludGVycG9sYXRpb240KGdldExWaWV3KCksIHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIHN1ZmZpeCk7Cn0KZnVuY3Rpb24gybXJtWludGVycG9sYXRlNShwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIHN1ZmZpeCA9ICIiKSB7CiAgcmV0dXJuIGludGVycG9sYXRpb241KGdldExWaWV3KCksIHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgc3VmZml4KTsKfQpmdW5jdGlvbiDJtcm1aW50ZXJwb2xhdGU2KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBzdWZmaXggPSAiIikgewogIHJldHVybiBpbnRlcnBvbGF0aW9uNihnZXRMVmlldygpLCBwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIGk0LCB2NSwgc3VmZml4KTsKfQpmdW5jdGlvbiDJtcm1aW50ZXJwb2xhdGU3KHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBpNSwgdjYsIHN1ZmZpeCA9ICIiKSB7CiAgcmV0dXJuIGludGVycG9sYXRpb243KGdldExWaWV3KCksIHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBpNSwgdjYsIHN1ZmZpeCk7Cn0KZnVuY3Rpb24gybXJtWludGVycG9sYXRlOChwcmVmaXgsIHYwLCBpMCwgdjEsIGkxLCB2MiwgaTIsIHYzLCBpMywgdjQsIGk0LCB2NSwgaTUsIHY2LCBpNiwgdjcsIHN1ZmZpeCA9ICIiKSB7CiAgcmV0dXJuIGludGVycG9sYXRpb244KGdldExWaWV3KCksIHByZWZpeCwgdjAsIGkwLCB2MSwgaTEsIHYyLCBpMiwgdjMsIGkzLCB2NCwgaTQsIHY1LCBpNSwgdjYsIGk2LCB2Nywgc3VmZml4KTsKfQpmdW5jdGlvbiDJtcm1aW50ZXJwb2xhdGVWKHZhbHVlcykgewogIHJldHVybiBpbnRlcnBvbGF0aW9uVihnZXRMVmlldygpLCB2YWx1ZXMpOwp9CmZ1bmN0aW9uIHByb3ZpZGVyc1Jlc29sdmVyKGRlZiwgcHJvdmlkZXJzLCBpc1ZpZXdQcm92aWRlcnMpIHsKICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgaWYgKHRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgcmVzb2x2ZVByb3ZpZGVyKHByb3ZpZGVycywgdFZpZXcuZGF0YSwgdFZpZXcuYmx1ZXByaW50LCBpc0NvbXBvbmVudERlZihkZWYpLCBpc1ZpZXdQcm92aWRlcnMpOwogIH0KfQpmdW5jdGlvbiByZXNvbHZlUHJvdmlkZXIocHJvdmlkZXIsIHRJbmplY3RhYmxlcywgbEluamVjdGFibGVzQmx1ZXByaW50LCBpc0NvbXBvbmVudDIsIGlzVmlld1Byb3ZpZGVyKSB7CiAgcHJvdmlkZXIgPSByZXNvbHZlRm9yd2FyZFJlZihwcm92aWRlcik7CiAgaWYgKEFycmF5LmlzQXJyYXkocHJvdmlkZXIpKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3ZpZGVyLmxlbmd0aDsgaSsrKSB7CiAgICAgIHJlc29sdmVQcm92aWRlcihwcm92aWRlcltpXSwgdEluamVjdGFibGVzLCBsSW5qZWN0YWJsZXNCbHVlcHJpbnQsIGlzQ29tcG9uZW50MiwgaXNWaWV3UHJvdmlkZXIpOwogICAgfQogIH0gZWxzZSB7CiAgICBjb25zdCB0VmlldyA9IGdldFRWaWV3KCk7CiAgICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgICBjb25zdCB0Tm9kZSA9IGdldEN1cnJlbnRUTm9kZSgpOwogICAgbGV0IHRva2VuID0gaXNUeXBlUHJvdmlkZXIocHJvdmlkZXIpID8gcHJvdmlkZXIgOiByZXNvbHZlRm9yd2FyZFJlZihwcm92aWRlci5wcm92aWRlKTsKICAgIGNvbnN0IHByb3ZpZGVyRmFjdG9yeSA9IHByb3ZpZGVyVG9GYWN0b3J5KHByb3ZpZGVyKTsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgY29uc3QgaW5qZWN0b3IgPSBuZXcgTm9kZUluamVjdG9yKHROb2RlLCBsVmlldyk7CiAgICAgIHJ1bkluSW5qZWN0b3JQcm9maWxlckNvbnRleHQoaW5qZWN0b3IsIHRva2VuLCAoKSA9PiB7CiAgICAgICAgZW1pdFByb3ZpZGVyQ29uZmlndXJlZEV2ZW50KHByb3ZpZGVyLCBpc1ZpZXdQcm92aWRlcik7CiAgICAgIH0pOwogICAgfQogICAgY29uc3QgYmVnaW5JbmRleCA9IHROb2RlLnByb3ZpZGVySW5kZXhlcyAmIDEwNDg1NzU7CiAgICBjb25zdCBlbmRJbmRleCA9IHROb2RlLmRpcmVjdGl2ZVN0YXJ0OwogICAgY29uc3QgY3B0Vmlld1Byb3ZpZGVyc0NvdW50ID0gdE5vZGUucHJvdmlkZXJJbmRleGVzID4+IDIwOwogICAgaWYgKGlzVHlwZVByb3ZpZGVyKHByb3ZpZGVyKSB8fCAhcHJvdmlkZXIubXVsdGkpIHsKICAgICAgY29uc3QgZmFjdG9yeSA9IG5ldyBOb2RlSW5qZWN0b3JGYWN0b3J5KHByb3ZpZGVyRmFjdG9yeSwgaXNWaWV3UHJvdmlkZXIsIMm1ybVkaXJlY3RpdmVJbmplY3QsIG5nRGV2TW9kZSA/IHByb3ZpZGVyTmFtZShwcm92aWRlcikgOiBudWxsKTsKICAgICAgY29uc3QgZXhpc3RpbmdGYWN0b3J5SW5kZXggPSBpbmRleE9mKHRva2VuLCB0SW5qZWN0YWJsZXMsIGlzVmlld1Byb3ZpZGVyID8gYmVnaW5JbmRleCA6IGJlZ2luSW5kZXggKyBjcHRWaWV3UHJvdmlkZXJzQ291bnQsIGVuZEluZGV4KTsKICAgICAgaWYgKGV4aXN0aW5nRmFjdG9yeUluZGV4ID09PSAtMSkgewogICAgICAgIGRpUHVibGljSW5JbmplY3RvcihnZXRPckNyZWF0ZU5vZGVJbmplY3RvckZvck5vZGUodE5vZGUsIGxWaWV3KSwgdFZpZXcsIHRva2VuKTsKICAgICAgICByZWdpc3RlckRlc3Ryb3lIb29rc0lmU3VwcG9ydGVkKHRWaWV3LCBwcm92aWRlciwgdEluamVjdGFibGVzLmxlbmd0aCk7CiAgICAgICAgdEluamVjdGFibGVzLnB1c2godG9rZW4pOwogICAgICAgIHROb2RlLmRpcmVjdGl2ZVN0YXJ0Kys7CiAgICAgICAgdE5vZGUuZGlyZWN0aXZlRW5kKys7CiAgICAgICAgaWYgKGlzVmlld1Byb3ZpZGVyKSB7CiAgICAgICAgICB0Tm9kZS5wcm92aWRlckluZGV4ZXMgKz0gMTA0ODU3NjsKICAgICAgICB9CiAgICAgICAgbEluamVjdGFibGVzQmx1ZXByaW50LnB1c2goZmFjdG9yeSk7CiAgICAgICAgbFZpZXcucHVzaChmYWN0b3J5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsSW5qZWN0YWJsZXNCbHVlcHJpbnRbZXhpc3RpbmdGYWN0b3J5SW5kZXhdID0gZmFjdG9yeTsKICAgICAgICBsVmlld1tleGlzdGluZ0ZhY3RvcnlJbmRleF0gPSBmYWN0b3J5OwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBleGlzdGluZ1Byb3ZpZGVyc0ZhY3RvcnlJbmRleCA9IGluZGV4T2YodG9rZW4sIHRJbmplY3RhYmxlcywgYmVnaW5JbmRleCArIGNwdFZpZXdQcm92aWRlcnNDb3VudCwgZW5kSW5kZXgpOwogICAgICBjb25zdCBleGlzdGluZ1ZpZXdQcm92aWRlcnNGYWN0b3J5SW5kZXggPSBpbmRleE9mKHRva2VuLCB0SW5qZWN0YWJsZXMsIGJlZ2luSW5kZXgsIGJlZ2luSW5kZXggKyBjcHRWaWV3UHJvdmlkZXJzQ291bnQpOwogICAgICBjb25zdCBkb2VzUHJvdmlkZXJzRmFjdG9yeUV4aXN0ID0gZXhpc3RpbmdQcm92aWRlcnNGYWN0b3J5SW5kZXggPj0gMCAmJiBsSW5qZWN0YWJsZXNCbHVlcHJpbnRbZXhpc3RpbmdQcm92aWRlcnNGYWN0b3J5SW5kZXhdOwogICAgICBjb25zdCBkb2VzVmlld1Byb3ZpZGVyc0ZhY3RvcnlFeGlzdCA9IGV4aXN0aW5nVmlld1Byb3ZpZGVyc0ZhY3RvcnlJbmRleCA+PSAwICYmIGxJbmplY3RhYmxlc0JsdWVwcmludFtleGlzdGluZ1ZpZXdQcm92aWRlcnNGYWN0b3J5SW5kZXhdOwogICAgICBpZiAoaXNWaWV3UHJvdmlkZXIgJiYgIWRvZXNWaWV3UHJvdmlkZXJzRmFjdG9yeUV4aXN0IHx8ICFpc1ZpZXdQcm92aWRlciAmJiAhZG9lc1Byb3ZpZGVyc0ZhY3RvcnlFeGlzdCkgewogICAgICAgIGRpUHVibGljSW5JbmplY3RvcihnZXRPckNyZWF0ZU5vZGVJbmplY3RvckZvck5vZGUodE5vZGUsIGxWaWV3KSwgdFZpZXcsIHRva2VuKTsKICAgICAgICBjb25zdCBmYWN0b3J5ID0gbXVsdGlGYWN0b3J5KGlzVmlld1Byb3ZpZGVyID8gbXVsdGlWaWV3UHJvdmlkZXJzRmFjdG9yeVJlc29sdmVyIDogbXVsdGlQcm92aWRlcnNGYWN0b3J5UmVzb2x2ZXIsIGxJbmplY3RhYmxlc0JsdWVwcmludC5sZW5ndGgsIGlzVmlld1Byb3ZpZGVyLCBpc0NvbXBvbmVudDIsIHByb3ZpZGVyRmFjdG9yeSwgcHJvdmlkZXIpOwogICAgICAgIGlmICghaXNWaWV3UHJvdmlkZXIgJiYgZG9lc1ZpZXdQcm92aWRlcnNGYWN0b3J5RXhpc3QpIHsKICAgICAgICAgIGxJbmplY3RhYmxlc0JsdWVwcmludFtleGlzdGluZ1ZpZXdQcm92aWRlcnNGYWN0b3J5SW5kZXhdLnByb3ZpZGVyRmFjdG9yeSA9IGZhY3Rvcnk7CiAgICAgICAgfQogICAgICAgIHJlZ2lzdGVyRGVzdHJveUhvb2tzSWZTdXBwb3J0ZWQodFZpZXcsIHByb3ZpZGVyLCB0SW5qZWN0YWJsZXMubGVuZ3RoLCAwKTsKICAgICAgICB0SW5qZWN0YWJsZXMucHVzaCh0b2tlbik7CiAgICAgICAgdE5vZGUuZGlyZWN0aXZlU3RhcnQrKzsKICAgICAgICB0Tm9kZS5kaXJlY3RpdmVFbmQrKzsKICAgICAgICBpZiAoaXNWaWV3UHJvdmlkZXIpIHsKICAgICAgICAgIHROb2RlLnByb3ZpZGVySW5kZXhlcyArPSAxMDQ4NTc2OwogICAgICAgIH0KICAgICAgICBsSW5qZWN0YWJsZXNCbHVlcHJpbnQucHVzaChmYWN0b3J5KTsKICAgICAgICBsVmlldy5wdXNoKGZhY3RvcnkpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGluZGV4SW5GYWN0b3J5ID0gbXVsdGlGYWN0b3J5QWRkKGxJbmplY3RhYmxlc0JsdWVwcmludFtpc1ZpZXdQcm92aWRlciA/IGV4aXN0aW5nVmlld1Byb3ZpZGVyc0ZhY3RvcnlJbmRleCA6IGV4aXN0aW5nUHJvdmlkZXJzRmFjdG9yeUluZGV4XSwgcHJvdmlkZXJGYWN0b3J5LCAhaXNWaWV3UHJvdmlkZXIgJiYgaXNDb21wb25lbnQyKTsKICAgICAgICByZWdpc3RlckRlc3Ryb3lIb29rc0lmU3VwcG9ydGVkKHRWaWV3LCBwcm92aWRlciwgZXhpc3RpbmdQcm92aWRlcnNGYWN0b3J5SW5kZXggPiAtMSA/IGV4aXN0aW5nUHJvdmlkZXJzRmFjdG9yeUluZGV4IDogZXhpc3RpbmdWaWV3UHJvdmlkZXJzRmFjdG9yeUluZGV4LCBpbmRleEluRmFjdG9yeSk7CiAgICAgIH0KICAgICAgaWYgKCFpc1ZpZXdQcm92aWRlciAmJiBpc0NvbXBvbmVudDIgJiYgZG9lc1ZpZXdQcm92aWRlcnNGYWN0b3J5RXhpc3QpIHsKICAgICAgICBsSW5qZWN0YWJsZXNCbHVlcHJpbnRbZXhpc3RpbmdWaWV3UHJvdmlkZXJzRmFjdG9yeUluZGV4XS5jb21wb25lbnRQcm92aWRlcnMrKzsKICAgICAgfQogICAgfQogIH0KfQpmdW5jdGlvbiByZWdpc3RlckRlc3Ryb3lIb29rc0lmU3VwcG9ydGVkKHRWaWV3LCBwcm92aWRlciwgY29udGV4dEluZGV4LCBpbmRleEluRmFjdG9yeSkgewogIGNvbnN0IHByb3ZpZGVySXNUeXBlUHJvdmlkZXIgPSBpc1R5cGVQcm92aWRlcihwcm92aWRlcik7CiAgY29uc3QgcHJvdmlkZXJJc0NsYXNzUHJvdmlkZXIgPSBpc0NsYXNzUHJvdmlkZXIocHJvdmlkZXIpOwogIGlmIChwcm92aWRlcklzVHlwZVByb3ZpZGVyIHx8IHByb3ZpZGVySXNDbGFzc1Byb3ZpZGVyKSB7CiAgICBjb25zdCBjbGFzc1Rva2VuID0gcHJvdmlkZXJJc0NsYXNzUHJvdmlkZXIgPyByZXNvbHZlRm9yd2FyZFJlZihwcm92aWRlci51c2VDbGFzcykgOiBwcm92aWRlcjsKICAgIGNvbnN0IHByb3RvdHlwZSA9IGNsYXNzVG9rZW4ucHJvdG90eXBlOwogICAgY29uc3QgbmdPbkRlc3Ryb3kgPSBwcm90b3R5cGUubmdPbkRlc3Ryb3k7CiAgICBpZiAobmdPbkRlc3Ryb3kpIHsKICAgICAgY29uc3QgaG9va3MgPSB0Vmlldy5kZXN0cm95SG9va3MgfHwgKHRWaWV3LmRlc3Ryb3lIb29rcyA9IFtdKTsKICAgICAgaWYgKCFwcm92aWRlcklzVHlwZVByb3ZpZGVyICYmIHByb3ZpZGVyLm11bHRpKSB7CiAgICAgICAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQoaW5kZXhJbkZhY3RvcnksICJpbmRleEluRmFjdG9yeSB3aGVuIHJlZ2lzdGVyaW5nIG11bHRpIGZhY3RvcnkgZGVzdHJveSBob29rIik7CiAgICAgICAgY29uc3QgZXhpc3RpbmdDYWxsYmFja3NJbmRleCA9IGhvb2tzLmluZGV4T2YoY29udGV4dEluZGV4KTsKICAgICAgICBpZiAoZXhpc3RpbmdDYWxsYmFja3NJbmRleCA9PT0gLTEpIHsKICAgICAgICAgIGhvb2tzLnB1c2goY29udGV4dEluZGV4LCBbaW5kZXhJbkZhY3RvcnksIG5nT25EZXN0cm95XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhvb2tzW2V4aXN0aW5nQ2FsbGJhY2tzSW5kZXggKyAxXS5wdXNoKGluZGV4SW5GYWN0b3J5LCBuZ09uRGVzdHJveSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGhvb2tzLnB1c2goY29udGV4dEluZGV4LCBuZ09uRGVzdHJveSk7CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gbXVsdGlGYWN0b3J5QWRkKG11bHRpRmFjdG9yeTIsIGZhY3RvcnksIGlzQ29tcG9uZW50UHJvdmlkZXIpIHsKICBpZiAoaXNDb21wb25lbnRQcm92aWRlcikgewogICAgbXVsdGlGYWN0b3J5Mi5jb21wb25lbnRQcm92aWRlcnMrKzsKICB9CiAgcmV0dXJuIG11bHRpRmFjdG9yeTIubXVsdGkucHVzaChmYWN0b3J5KSAtIDE7Cn0KZnVuY3Rpb24gaW5kZXhPZihpdGVtLCBhcnIsIGJlZ2luLCBlbmQpIHsKICBmb3IgKGxldCBpID0gYmVnaW47IGkgPCBlbmQ7IGkrKykgewogICAgaWYgKGFycltpXSA9PT0gaXRlbSkgcmV0dXJuIGk7CiAgfQogIHJldHVybiAtMTsKfQpmdW5jdGlvbiBtdWx0aVByb3ZpZGVyc0ZhY3RvcnlSZXNvbHZlcihfLCBmbGFncywgdERhdGEsIGxEYXRhLCB0Tm9kZSkgewogIHJldHVybiBtdWx0aVJlc29sdmUodGhpcy5tdWx0aSwgW10pOwp9CmZ1bmN0aW9uIG11bHRpVmlld1Byb3ZpZGVyc0ZhY3RvcnlSZXNvbHZlcihfLCBfZmxhZ3MsIF90RGF0YSwgbFZpZXcsIHROb2RlKSB7CiAgY29uc3QgZmFjdG9yaWVzID0gdGhpcy5tdWx0aTsKICBsZXQgcmVzdWx0OwogIGlmICh0aGlzLnByb3ZpZGVyRmFjdG9yeSkgewogICAgY29uc3QgY29tcG9uZW50Q291bnQgPSB0aGlzLnByb3ZpZGVyRmFjdG9yeS5jb21wb25lbnRQcm92aWRlcnM7CiAgICBjb25zdCBtdWx0aVByb3ZpZGVycyA9IGdldE5vZGVJbmplY3RhYmxlKGxWaWV3LCBsVmlld1tUVklFV10sIHRoaXMucHJvdmlkZXJGYWN0b3J5LmluZGV4LCB0Tm9kZSk7CiAgICByZXN1bHQgPSBtdWx0aVByb3ZpZGVycy5zbGljZSgwLCBjb21wb25lbnRDb3VudCk7CiAgICBtdWx0aVJlc29sdmUoZmFjdG9yaWVzLCByZXN1bHQpOwogICAgZm9yIChsZXQgaSA9IGNvbXBvbmVudENvdW50OyBpIDwgbXVsdGlQcm92aWRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgcmVzdWx0LnB1c2gobXVsdGlQcm92aWRlcnNbaV0pOwogICAgfQogIH0gZWxzZSB7CiAgICByZXN1bHQgPSBbXTsKICAgIG11bHRpUmVzb2x2ZShmYWN0b3JpZXMsIHJlc3VsdCk7CiAgfQogIHJldHVybiByZXN1bHQ7Cn0KZnVuY3Rpb24gbXVsdGlSZXNvbHZlKGZhY3RvcmllcywgcmVzdWx0KSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBmYWN0b3JpZXMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGZhY3RvcnkgPSBmYWN0b3JpZXNbaV07CiAgICByZXN1bHQucHVzaChmYWN0b3J5KCkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9CmZ1bmN0aW9uIG11bHRpRmFjdG9yeShmYWN0b3J5Rm4sIGluZGV4LCBpc1ZpZXdQcm92aWRlciwgaXNDb21wb25lbnQyLCBmLCBwcm92aWRlcikgewogIGNvbnN0IGZhY3RvcnkgPSBuZXcgTm9kZUluamVjdG9yRmFjdG9yeShmYWN0b3J5Rm4sIGlzVmlld1Byb3ZpZGVyLCDJtcm1ZGlyZWN0aXZlSW5qZWN0LCBuZ0Rldk1vZGUgPyBwcm92aWRlck5hbWUocHJvdmlkZXIpIDogbnVsbCk7CiAgZmFjdG9yeS5tdWx0aSA9IFtdOwogIGZhY3RvcnkuaW5kZXggPSBpbmRleDsKICBmYWN0b3J5LmNvbXBvbmVudFByb3ZpZGVycyA9IDA7CiAgbXVsdGlGYWN0b3J5QWRkKGZhY3RvcnksIGYsIGlzQ29tcG9uZW50MiAmJiAhaXNWaWV3UHJvdmlkZXIpOwogIHJldHVybiBmYWN0b3J5Owp9CmZ1bmN0aW9uIHByb3ZpZGVyTmFtZShwcm92aWRlcikgewogIGlmIChBcnJheS5pc0FycmF5KHByb3ZpZGVyKSkgewogICAgcmV0dXJuIG51bGw7CiAgfQogIGlmIChpc1R5cGVQcm92aWRlcihwcm92aWRlcikpIHsKICAgIHJldHVybiBwcm92aWRlci5uYW1lOwogIH0gZWxzZSBpZiAoaXNDbGFzc1Byb3ZpZGVyKHByb3ZpZGVyKSkgewogICAgaWYgKHByb3ZpZGVyLnByb3ZpZGUgaW5zdGFuY2VvZiBJbmplY3Rpb25Ub2tlbikgewogICAgICByZXR1cm4gYCgnJHtwcm92aWRlci5wcm92aWRlLnRvU3RyaW5nKCl9Jzoke3Byb3ZpZGVyLnVzZUNsYXNzLm5hbWV9KWA7CiAgICB9CiAgICByZXR1cm4gcHJvdmlkZXIudXNlQ2xhc3MubmFtZTsKICB9IGVsc2UgaWYgKHByb3ZpZGVyLnByb3ZpZGUgaW5zdGFuY2VvZiBJbmplY3Rpb25Ub2tlbikgewogICAgcmV0dXJuIHByb3ZpZGVyLnByb3ZpZGUudG9TdHJpbmcoKTsKICB9IGVsc2UgaWYgKHR5cGVvZiBwcm92aWRlci5wcm92aWRlID09PSAic3RyaW5nIikgewogICAgcmV0dXJuIHByb3ZpZGVyLnByb3ZpZGU7CiAgfSBlbHNlIHsKICAgIHJldHVybiBudWxsOwogIH0KfQpmdW5jdGlvbiDJtcm1UHJvdmlkZXJzRmVhdHVyZShwcm92aWRlcnMsIHZpZXdQcm92aWRlcnMpIHsKICByZXR1cm4gKGRlZmluaXRpb24pID0+IHsKICAgIGRlZmluaXRpb24ucHJvdmlkZXJzUmVzb2x2ZXIgPSAoZGVmLCBwcm9jZXNzUHJvdmlkZXJzRm4pID0+IHByb3ZpZGVyc1Jlc29sdmVyKGRlZiwgcHJvY2Vzc1Byb3ZpZGVyc0ZuID8gcHJvY2Vzc1Byb3ZpZGVyc0ZuKHByb3ZpZGVycykgOiBwcm92aWRlcnMsIGZhbHNlKTsKICAgIGlmICh2aWV3UHJvdmlkZXJzKSB7CiAgICAgIGRlZmluaXRpb24udmlld1Byb3ZpZGVyc1Jlc29sdmVyID0gKGRlZiwgcHJvY2Vzc1Byb3ZpZGVyc0ZuKSA9PiBwcm92aWRlcnNSZXNvbHZlcihkZWYsIHByb2Nlc3NQcm92aWRlcnNGbiA/IHByb2Nlc3NQcm92aWRlcnNGbih2aWV3UHJvdmlkZXJzKSA6IHZpZXdQcm92aWRlcnMsIHRydWUpOwogICAgfQogIH07Cn0KZnVuY3Rpb24gybXJtUV4dGVybmFsU3R5bGVzRmVhdHVyZShzdHlsZVVybHMpIHsKICByZXR1cm4gKGRlZmluaXRpb24pID0+IHsKICAgIGlmIChzdHlsZVVybHMubGVuZ3RoIDwgMSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBkZWZpbml0aW9uLmdldEV4dGVybmFsU3R5bGVzID0gKGVuY2Fwc3VsYXRpb25JZCkgPT4gewogICAgICBjb25zdCB1cmxzID0gc3R5bGVVcmxzLm1hcCgodmFsdWUpID0+IHZhbHVlICsgIj9uZ2NvbXAiICsgKGVuY2Fwc3VsYXRpb25JZCA/ICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChlbmNhcHN1bGF0aW9uSWQpIDogIiIpICsgIiZlPSIgKyBkZWZpbml0aW9uLmVuY2Fwc3VsYXRpb24pOwogICAgICByZXR1cm4gdXJsczsKICAgIH07CiAgfTsKfQpmdW5jdGlvbiDJtcm1c2V0Q29tcG9uZW50U2NvcGUodHlwZSwgZGlyZWN0aXZlcywgcGlwZXMpIHsKICBjb25zdCBkZWYgPSB0eXBlLsm1Y21wOwogIGRlZi5kaXJlY3RpdmVEZWZzID0gZXh0cmFjdERlZkxpc3RPckZhY3RvcnkoZGlyZWN0aXZlcywgZXh0cmFjdERpcmVjdGl2ZURlZik7CiAgZGVmLnBpcGVEZWZzID0gZXh0cmFjdERlZkxpc3RPckZhY3RvcnkocGlwZXMsIGdldFBpcGVEZWYpOwp9CmZ1bmN0aW9uIMm1ybVzZXROZ01vZHVsZVNjb3BlKHR5cGUsIHNjb3BlKSB7CiAgcmV0dXJuIG5vU2lkZUVmZmVjdHMoKCkgPT4gewogICAgY29uc3QgbmdNb2R1bGVEZWYgPSBnZXROZ01vZHVsZURlZk9yVGhyb3codHlwZSk7CiAgICBuZ01vZHVsZURlZi5kZWNsYXJhdGlvbnMgPSBjb252ZXJ0VG9UeXBlQXJyYXkoc2NvcGUuZGVjbGFyYXRpb25zIHx8IEVNUFRZX0FSUkFZKTsKICAgIG5nTW9kdWxlRGVmLmltcG9ydHMgPSBjb252ZXJ0VG9UeXBlQXJyYXkoc2NvcGUuaW1wb3J0cyB8fCBFTVBUWV9BUlJBWSk7CiAgICBuZ01vZHVsZURlZi5leHBvcnRzID0gY29udmVydFRvVHlwZUFycmF5KHNjb3BlLmV4cG9ydHMgfHwgRU1QVFlfQVJSQVkpOwogICAgaWYgKHNjb3BlLmJvb3RzdHJhcCkgewogICAgICBuZ01vZHVsZURlZi5ib290c3RyYXAgPSBjb252ZXJ0VG9UeXBlQXJyYXkoc2NvcGUuYm9vdHN0cmFwKTsKICAgIH0KICAgIGRlcHNUcmFja2VyLnJlZ2lzdGVyTmdNb2R1bGUodHlwZSwgc2NvcGUpOwogIH0pOwp9CmZ1bmN0aW9uIGNvbnZlcnRUb1R5cGVBcnJheSh2YWx1ZXMpIHsKICBpZiAodHlwZW9mIHZhbHVlcyA9PT0gImZ1bmN0aW9uIikgewogICAgcmV0dXJuIHZhbHVlczsKICB9CiAgY29uc3QgZmxhdHRlblZhbHVlcyA9IGZsYXR0ZW4odmFsdWVzKTsKICBpZiAoZmxhdHRlblZhbHVlcy5zb21lKGlzRm9yd2FyZFJlZikpIHsKICAgIHJldHVybiAoKSA9PiBmbGF0dGVuVmFsdWVzLm1hcChyZXNvbHZlRm9yd2FyZFJlZikubWFwKG1heWJlVW53cmFwTW9kdWxlV2l0aFByb3ZpZGVycyk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBmbGF0dGVuVmFsdWVzLm1hcChtYXliZVVud3JhcE1vZHVsZVdpdGhQcm92aWRlcnMpOwogIH0KfQpmdW5jdGlvbiBtYXliZVVud3JhcE1vZHVsZVdpdGhQcm92aWRlcnModmFsdWUpIHsKICByZXR1cm4gaXNNb2R1bGVXaXRoUHJvdmlkZXJzKHZhbHVlKSA/IHZhbHVlLm5nTW9kdWxlIDogdmFsdWU7Cn0KZnVuY3Rpb24gybXJtXB1cmVGdW5jdGlvbjAoc2xvdE9mZnNldCwgcHVyZUZuKSB7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gZ2V0QmluZGluZ1Jvb3QoKSArIHNsb3RPZmZzZXQ7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIHJldHVybiBsVmlld1tiaW5kaW5nSW5kZXhdID09PSBOT19DSEFOR0UgPyB1cGRhdGVCaW5kaW5nKGxWaWV3LCBiaW5kaW5nSW5kZXgsIHB1cmVGbigpKSA6IGdldEJpbmRpbmcobFZpZXcsIGJpbmRpbmdJbmRleCk7Cn0KZnVuY3Rpb24gybXJtXB1cmVGdW5jdGlvbjEoc2xvdE9mZnNldCwgcHVyZUZuLCBleHApIHsKICByZXR1cm4gcHVyZUZ1bmN0aW9uMUludGVybmFsKGdldExWaWV3KCksIGdldEJpbmRpbmdSb290KCksIHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwKTsKfQpmdW5jdGlvbiDJtcm1cHVyZUZ1bmN0aW9uMihzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cDEsIGV4cDIpIHsKICByZXR1cm4gcHVyZUZ1bmN0aW9uMkludGVybmFsKGdldExWaWV3KCksIGdldEJpbmRpbmdSb290KCksIHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwMSwgZXhwMik7Cn0KZnVuY3Rpb24gybXJtXB1cmVGdW5jdGlvbjMoc2xvdE9mZnNldCwgcHVyZUZuLCBleHAxLCBleHAyLCBleHAzKSB7CiAgcmV0dXJuIHB1cmVGdW5jdGlvbjNJbnRlcm5hbChnZXRMVmlldygpLCBnZXRCaW5kaW5nUm9vdCgpLCBzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cDEsIGV4cDIsIGV4cDMpOwp9CmZ1bmN0aW9uIMm1ybVwdXJlRnVuY3Rpb240KHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwMSwgZXhwMiwgZXhwMywgZXhwNCwgdGhpc0FyZykgewogIHJldHVybiBwdXJlRnVuY3Rpb240SW50ZXJuYWwoZ2V0TFZpZXcoKSwgZ2V0QmluZGluZ1Jvb3QoKSwgc2xvdE9mZnNldCwgcHVyZUZuLCBleHAxLCBleHAyLCBleHAzLCBleHA0KTsKfQpmdW5jdGlvbiDJtcm1cHVyZUZ1bmN0aW9uNShzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQsIGV4cDUpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nUm9vdCgpICsgc2xvdE9mZnNldDsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpOwogIHJldHVybiBiaW5kaW5nVXBkYXRlZChsVmlldywgYmluZGluZ0luZGV4ICsgNCwgZXhwNSkgfHwgZGlmZmVyZW50ID8gdXBkYXRlQmluZGluZyhsVmlldywgYmluZGluZ0luZGV4ICsgNSwgcHVyZUZuKGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQsIGV4cDUpKSA6IGdldEJpbmRpbmcobFZpZXcsIGJpbmRpbmdJbmRleCArIDUpOwp9CmZ1bmN0aW9uIMm1ybVwdXJlRnVuY3Rpb242KHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwMSwgZXhwMiwgZXhwMywgZXhwNCwgZXhwNSwgZXhwNikgewogIGNvbnN0IGJpbmRpbmdJbmRleCA9IGdldEJpbmRpbmdSb290KCkgKyBzbG90T2Zmc2V0OwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBkaWZmZXJlbnQgPSBiaW5kaW5nVXBkYXRlZDQobFZpZXcsIGJpbmRpbmdJbmRleCwgZXhwMSwgZXhwMiwgZXhwMywgZXhwNCk7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkMihsVmlldywgYmluZGluZ0luZGV4ICsgNCwgZXhwNSwgZXhwNikgfHwgZGlmZmVyZW50ID8gdXBkYXRlQmluZGluZyhsVmlldywgYmluZGluZ0luZGV4ICsgNiwgcHVyZUZuKGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQsIGV4cDUsIGV4cDYpKSA6IGdldEJpbmRpbmcobFZpZXcsIGJpbmRpbmdJbmRleCArIDYpOwp9CmZ1bmN0aW9uIMm1ybVwdXJlRnVuY3Rpb243KHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwMSwgZXhwMiwgZXhwMywgZXhwNCwgZXhwNSwgZXhwNiwgZXhwNykgewogIGNvbnN0IGJpbmRpbmdJbmRleCA9IGdldEJpbmRpbmdSb290KCkgKyBzbG90T2Zmc2V0OwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBsZXQgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpOwogIHJldHVybiBiaW5kaW5nVXBkYXRlZDMobFZpZXcsIGJpbmRpbmdJbmRleCArIDQsIGV4cDUsIGV4cDYsIGV4cDcpIHx8IGRpZmZlcmVudCA/IHVwZGF0ZUJpbmRpbmcobFZpZXcsIGJpbmRpbmdJbmRleCArIDcsIHB1cmVGbihleHAxLCBleHAyLCBleHAzLCBleHA0LCBleHA1LCBleHA2LCBleHA3KSkgOiBnZXRCaW5kaW5nKGxWaWV3LCBiaW5kaW5nSW5kZXggKyA3KTsKfQpmdW5jdGlvbiDJtcm1cHVyZUZ1bmN0aW9uOChzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQsIGV4cDUsIGV4cDYsIGV4cDcsIGV4cDgpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBnZXRCaW5kaW5nUm9vdCgpICsgc2xvdE9mZnNldDsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgZGlmZmVyZW50ID0gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpOwogIHJldHVybiBiaW5kaW5nVXBkYXRlZDQobFZpZXcsIGJpbmRpbmdJbmRleCArIDQsIGV4cDUsIGV4cDYsIGV4cDcsIGV4cDgpIHx8IGRpZmZlcmVudCA/IHVwZGF0ZUJpbmRpbmcobFZpZXcsIGJpbmRpbmdJbmRleCArIDgsIHB1cmVGbihleHAxLCBleHAyLCBleHAzLCBleHA0LCBleHA1LCBleHA2LCBleHA3LCBleHA4KSkgOiBnZXRCaW5kaW5nKGxWaWV3LCBiaW5kaW5nSW5kZXggKyA4KTsKfQpmdW5jdGlvbiDJtcm1cHVyZUZ1bmN0aW9uVihzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cHMpIHsKICByZXR1cm4gcHVyZUZ1bmN0aW9uVkludGVybmFsKGdldExWaWV3KCksIGdldEJpbmRpbmdSb290KCksIHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwcyk7Cn0KZnVuY3Rpb24gZ2V0UHVyZUZ1bmN0aW9uUmV0dXJuVmFsdWUobFZpZXcsIHJldHVyblZhbHVlSW5kZXgpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5kZXhJblJhbmdlKGxWaWV3LCByZXR1cm5WYWx1ZUluZGV4KTsKICBjb25zdCBsYXN0UmV0dXJuVmFsdWUgPSBsVmlld1tyZXR1cm5WYWx1ZUluZGV4XTsKICByZXR1cm4gbGFzdFJldHVyblZhbHVlID09PSBOT19DSEFOR0UgPyB2b2lkIDAgOiBsYXN0UmV0dXJuVmFsdWU7Cn0KZnVuY3Rpb24gcHVyZUZ1bmN0aW9uMUludGVybmFsKGxWaWV3LCBiaW5kaW5nUm9vdCwgc2xvdE9mZnNldCwgcHVyZUZuLCBleHAsIHRoaXNBcmcpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBiaW5kaW5nUm9vdCArIHNsb3RPZmZzZXQ7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cCkgPyB1cGRhdGVCaW5kaW5nKGxWaWV3LCBiaW5kaW5nSW5kZXggKyAxLCB0aGlzQXJnID8gcHVyZUZuLmNhbGwodGhpc0FyZywgZXhwKSA6IHB1cmVGbihleHApKSA6IGdldFB1cmVGdW5jdGlvblJldHVyblZhbHVlKGxWaWV3LCBiaW5kaW5nSW5kZXggKyAxKTsKfQpmdW5jdGlvbiBwdXJlRnVuY3Rpb24ySW50ZXJuYWwobFZpZXcsIGJpbmRpbmdSb290LCBzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cDEsIGV4cDIsIHRoaXNBcmcpIHsKICBjb25zdCBiaW5kaW5nSW5kZXggPSBiaW5kaW5nUm9vdCArIHNsb3RPZmZzZXQ7CiAgcmV0dXJuIGJpbmRpbmdVcGRhdGVkMihsVmlldywgYmluZGluZ0luZGV4LCBleHAxLCBleHAyKSA/IHVwZGF0ZUJpbmRpbmcobFZpZXcsIGJpbmRpbmdJbmRleCArIDIsIHRoaXNBcmcgPyBwdXJlRm4uY2FsbCh0aGlzQXJnLCBleHAxLCBleHAyKSA6IHB1cmVGbihleHAxLCBleHAyKSkgOiBnZXRQdXJlRnVuY3Rpb25SZXR1cm5WYWx1ZShsVmlldywgYmluZGluZ0luZGV4ICsgMik7Cn0KZnVuY3Rpb24gcHVyZUZ1bmN0aW9uM0ludGVybmFsKGxWaWV3LCBiaW5kaW5nUm9vdCwgc2xvdE9mZnNldCwgcHVyZUZuLCBleHAxLCBleHAyLCBleHAzLCB0aGlzQXJnKSB7CiAgY29uc3QgYmluZGluZ0luZGV4ID0gYmluZGluZ1Jvb3QgKyBzbG90T2Zmc2V0OwogIHJldHVybiBiaW5kaW5nVXBkYXRlZDMobFZpZXcsIGJpbmRpbmdJbmRleCwgZXhwMSwgZXhwMiwgZXhwMykgPyB1cGRhdGVCaW5kaW5nKGxWaWV3LCBiaW5kaW5nSW5kZXggKyAzLCB0aGlzQXJnID8gcHVyZUZuLmNhbGwodGhpc0FyZywgZXhwMSwgZXhwMiwgZXhwMykgOiBwdXJlRm4oZXhwMSwgZXhwMiwgZXhwMykpIDogZ2V0UHVyZUZ1bmN0aW9uUmV0dXJuVmFsdWUobFZpZXcsIGJpbmRpbmdJbmRleCArIDMpOwp9CmZ1bmN0aW9uIHB1cmVGdW5jdGlvbjRJbnRlcm5hbChsVmlldywgYmluZGluZ1Jvb3QsIHNsb3RPZmZzZXQsIHB1cmVGbiwgZXhwMSwgZXhwMiwgZXhwMywgZXhwNCwgdGhpc0FyZykgewogIGNvbnN0IGJpbmRpbmdJbmRleCA9IGJpbmRpbmdSb290ICsgc2xvdE9mZnNldDsKICByZXR1cm4gYmluZGluZ1VwZGF0ZWQ0KGxWaWV3LCBiaW5kaW5nSW5kZXgsIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpID8gdXBkYXRlQmluZGluZyhsVmlldywgYmluZGluZ0luZGV4ICsgNCwgdGhpc0FyZyA/IHB1cmVGbi5jYWxsKHRoaXNBcmcsIGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpIDogcHVyZUZuKGV4cDEsIGV4cDIsIGV4cDMsIGV4cDQpKSA6IGdldFB1cmVGdW5jdGlvblJldHVyblZhbHVlKGxWaWV3LCBiaW5kaW5nSW5kZXggKyA0KTsKfQpmdW5jdGlvbiBwdXJlRnVuY3Rpb25WSW50ZXJuYWwobFZpZXcsIGJpbmRpbmdSb290LCBzbG90T2Zmc2V0LCBwdXJlRm4sIGV4cHMsIHRoaXNBcmcpIHsKICBsZXQgYmluZGluZ0luZGV4ID0gYmluZGluZ1Jvb3QgKyBzbG90T2Zmc2V0OwogIGxldCBkaWZmZXJlbnQgPSBmYWxzZTsKICBmb3IgKGxldCBpID0gMDsgaSA8IGV4cHMubGVuZ3RoOyBpKyspIHsKICAgIGJpbmRpbmdVcGRhdGVkKGxWaWV3LCBiaW5kaW5nSW5kZXgrKywgZXhwc1tpXSkgJiYgKGRpZmZlcmVudCA9IHRydWUpOwogIH0KICByZXR1cm4gZGlmZmVyZW50ID8gdXBkYXRlQmluZGluZyhsVmlldywgYmluZGluZ0luZGV4LCBwdXJlRm4uYXBwbHkodGhpc0FyZywgZXhwcykpIDogZ2V0UHVyZUZ1bmN0aW9uUmV0dXJuVmFsdWUobFZpZXcsIGJpbmRpbmdJbmRleCk7Cn0KZnVuY3Rpb24gybXJtXBpcGUoaW5kZXgsIHBpcGVOYW1lKSB7CiAgY29uc3QgdFZpZXcgPSBnZXRUVmlldygpOwogIGxldCBwaXBlRGVmOwogIGNvbnN0IGFkanVzdGVkSW5kZXggPSBpbmRleCArIEhFQURFUl9PRkZTRVQ7CiAgaWYgKHRWaWV3LmZpcnN0Q3JlYXRlUGFzcykgewogICAgcGlwZURlZiA9IGdldFBpcGVEZWYyKHBpcGVOYW1lLCB0Vmlldy5waXBlUmVnaXN0cnkpOwogICAgdFZpZXcuZGF0YVthZGp1c3RlZEluZGV4XSA9IHBpcGVEZWY7CiAgICBpZiAocGlwZURlZi5vbkRlc3Ryb3kpIHsKICAgICAgKHRWaWV3LmRlc3Ryb3lIb29rcyA/Pz0gW10pLnB1c2goYWRqdXN0ZWRJbmRleCwgcGlwZURlZi5vbkRlc3Ryb3kpOwogICAgfQogIH0gZWxzZSB7CiAgICBwaXBlRGVmID0gdFZpZXcuZGF0YVthZGp1c3RlZEluZGV4XTsKICB9CiAgY29uc3QgcGlwZUZhY3RvcnkgPSBwaXBlRGVmLmZhY3RvcnkgfHwgKHBpcGVEZWYuZmFjdG9yeSA9IGdldEZhY3RvcnlEZWYocGlwZURlZi50eXBlLCB0cnVlKSk7CiAgbGV0IHByZXZpb3VzSW5qZWN0b3JQcm9maWxlckNvbnRleHQ7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgcHJldmlvdXNJbmplY3RvclByb2ZpbGVyQ29udGV4dCA9IHNldEluamVjdG9yUHJvZmlsZXJDb250ZXh0KHsKICAgICAgaW5qZWN0b3I6IG5ldyBOb2RlSW5qZWN0b3IoZ2V0Q3VycmVudFROb2RlKCksIGdldExWaWV3KCkpLAogICAgICB0b2tlbjogcGlwZURlZi50eXBlCiAgICB9KTsKICB9CiAgY29uc3QgcHJldmlvdXNJbmplY3RJbXBsZW1lbnRhdGlvbiA9IHNldEluamVjdEltcGxlbWVudGF0aW9uKMm1ybVkaXJlY3RpdmVJbmplY3QpOwogIHRyeSB7CiAgICBjb25zdCBwcmV2aW91c0luY2x1ZGVWaWV3UHJvdmlkZXJzID0gc2V0SW5jbHVkZVZpZXdQcm92aWRlcnMoZmFsc2UpOwogICAgY29uc3QgcGlwZUluc3RhbmNlID0gcGlwZUZhY3RvcnkoKTsKICAgIHNldEluY2x1ZGVWaWV3UHJvdmlkZXJzKHByZXZpb3VzSW5jbHVkZVZpZXdQcm92aWRlcnMpOwogICAgc3RvcmUodFZpZXcsIGdldExWaWV3KCksIGFkanVzdGVkSW5kZXgsIHBpcGVJbnN0YW5jZSk7CiAgICByZXR1cm4gcGlwZUluc3RhbmNlOwogIH0gZmluYWxseSB7CiAgICBzZXRJbmplY3RJbXBsZW1lbnRhdGlvbihwcmV2aW91c0luamVjdEltcGxlbWVudGF0aW9uKTsKICAgIG5nRGV2TW9kZSAmJiBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dChwcmV2aW91c0luamVjdG9yUHJvZmlsZXJDb250ZXh0KTsKICB9Cn0KZnVuY3Rpb24gZ2V0UGlwZURlZjIobmFtZSwgcmVnaXN0cnkpIHsKICBpZiAocmVnaXN0cnkpIHsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgY29uc3QgcGlwZXMgPSByZWdpc3RyeS5maWx0ZXIoKHBpcGUyKSA9PiBwaXBlMi5uYW1lID09PSBuYW1lKTsKICAgICAgaWYgKHBpcGVzLmxlbmd0aCA+IDEpIHsKICAgICAgICBjb25zb2xlLndhcm4oZm9ybWF0UnVudGltZUVycm9yKDMxMywgZ2V0TXVsdGlwbGVNYXRjaGluZ1BpcGVzTWVzc2FnZShuYW1lKSkpOwogICAgICB9CiAgICB9CiAgICBmb3IgKGxldCBpID0gcmVnaXN0cnkubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgY29uc3QgcGlwZURlZiA9IHJlZ2lzdHJ5W2ldOwogICAgICBpZiAobmFtZSA9PT0gcGlwZURlZi5uYW1lKSB7CiAgICAgICAgcmV0dXJuIHBpcGVEZWY7CiAgICAgIH0KICAgIH0KICB9CiAgaWYgKG5nRGV2TW9kZSkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtMzAyLCBnZXRQaXBlTm90Rm91bmRFcnJvck1lc3NhZ2UobmFtZSkpOwogIH0KICByZXR1cm47Cn0KZnVuY3Rpb24gZ2V0TXVsdGlwbGVNYXRjaGluZ1BpcGVzTWVzc2FnZShuYW1lKSB7CiAgY29uc3QgbFZpZXcgPSBnZXRMVmlldygpOwogIGNvbnN0IGRlY2xhcmF0aW9uTFZpZXcgPSBsVmlld1tERUNMQVJBVElPTl9DT01QT05FTlRfVklFV107CiAgY29uc3QgY29udGV4dDIgPSBkZWNsYXJhdGlvbkxWaWV3W0NPTlRFWFRdOwogIGNvbnN0IGhvc3RJc1N0YW5kYWxvbmUgPSBpc0hvc3RDb21wb25lbnRTdGFuZGFsb25lKGxWaWV3KTsKICBjb25zdCBjb21wb25lbnRJbmZvTWVzc2FnZSA9IGNvbnRleHQyID8gYCBpbiB0aGUgJyR7Y29udGV4dDIuY29uc3RydWN0b3IubmFtZX0nIGNvbXBvbmVudGAgOiAiIjsKICBjb25zdCB2ZXJpZnlNZXNzYWdlID0gYGNoZWNrICR7aG9zdElzU3RhbmRhbG9uZSA/ICInQENvbXBvbmVudC5pbXBvcnRzJyBvZiB0aGlzIGNvbXBvbmVudCIgOiAidGhlIGltcG9ydHMgb2YgdGhpcyBtb2R1bGUifWA7CiAgY29uc3QgZXJyb3JNZXNzYWdlID0gYE11bHRpcGxlIHBpcGVzIG1hdGNoIHRoZSBuYW1lIFxgJHtuYW1lfVxgJHtjb21wb25lbnRJbmZvTWVzc2FnZX0uICR7dmVyaWZ5TWVzc2FnZX1gOwogIHJldHVybiBlcnJvck1lc3NhZ2U7Cn0KZnVuY3Rpb24gZ2V0UGlwZU5vdEZvdW5kRXJyb3JNZXNzYWdlKG5hbWUpIHsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgZGVjbGFyYXRpb25MVmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICBjb25zdCBjb250ZXh0MiA9IGRlY2xhcmF0aW9uTFZpZXdbQ09OVEVYVF07CiAgY29uc3QgaG9zdElzU3RhbmRhbG9uZSA9IGlzSG9zdENvbXBvbmVudFN0YW5kYWxvbmUobFZpZXcpOwogIGNvbnN0IGNvbXBvbmVudEluZm9NZXNzYWdlID0gY29udGV4dDIgPyBgIGluIHRoZSAnJHtjb250ZXh0Mi5jb25zdHJ1Y3Rvci5uYW1lfScgY29tcG9uZW50YCA6ICIiOwogIGNvbnN0IHZlcmlmeU1lc3NhZ2UgPSBgVmVyaWZ5IHRoYXQgaXQgaXMgJHtob3N0SXNTdGFuZGFsb25lID8gImluY2x1ZGVkIGluIHRoZSAnQENvbXBvbmVudC5pbXBvcnRzJyBvZiB0aGlzIGNvbXBvbmVudCIgOiAiZGVjbGFyZWQgb3IgaW1wb3J0ZWQgaW4gdGhpcyBtb2R1bGUifWA7CiAgY29uc3QgZXJyb3JNZXNzYWdlID0gYFRoZSBwaXBlICcke25hbWV9JyBjb3VsZCBub3QgYmUgZm91bmQke2NvbXBvbmVudEluZm9NZXNzYWdlfS4gJHt2ZXJpZnlNZXNzYWdlfWA7CiAgcmV0dXJuIGVycm9yTWVzc2FnZTsKfQpmdW5jdGlvbiDJtcm1cGlwZUJpbmQxKGluZGV4LCBvZmZzZXQsIHYxKSB7CiAgY29uc3QgYWRqdXN0ZWRJbmRleCA9IGluZGV4ICsgSEVBREVSX09GRlNFVDsKICBjb25zdCBsVmlldyA9IGdldExWaWV3KCk7CiAgY29uc3QgcGlwZUluc3RhbmNlID0gbG9hZChsVmlldywgYWRqdXN0ZWRJbmRleCk7CiAgcmV0dXJuIGlzUHVyZShsVmlldywgYWRqdXN0ZWRJbmRleCkgPyBwdXJlRnVuY3Rpb24xSW50ZXJuYWwobFZpZXcsIGdldEJpbmRpbmdSb290KCksIG9mZnNldCwgcGlwZUluc3RhbmNlLnRyYW5zZm9ybSwgdjEsIHBpcGVJbnN0YW5jZSkgOiBwaXBlSW5zdGFuY2UudHJhbnNmb3JtKHYxKTsKfQpmdW5jdGlvbiDJtcm1cGlwZUJpbmQyKGluZGV4LCBzbG90T2Zmc2V0LCB2MSwgdjIpIHsKICBjb25zdCBhZGp1c3RlZEluZGV4ID0gaW5kZXggKyBIRUFERVJfT0ZGU0VUOwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBwaXBlSW5zdGFuY2UgPSBsb2FkKGxWaWV3LCBhZGp1c3RlZEluZGV4KTsKICByZXR1cm4gaXNQdXJlKGxWaWV3LCBhZGp1c3RlZEluZGV4KSA/IHB1cmVGdW5jdGlvbjJJbnRlcm5hbChsVmlldywgZ2V0QmluZGluZ1Jvb3QoKSwgc2xvdE9mZnNldCwgcGlwZUluc3RhbmNlLnRyYW5zZm9ybSwgdjEsIHYyLCBwaXBlSW5zdGFuY2UpIDogcGlwZUluc3RhbmNlLnRyYW5zZm9ybSh2MSwgdjIpOwp9CmZ1bmN0aW9uIMm1ybVwaXBlQmluZDMoaW5kZXgsIHNsb3RPZmZzZXQsIHYxLCB2MiwgdjMpIHsKICBjb25zdCBhZGp1c3RlZEluZGV4ID0gaW5kZXggKyBIRUFERVJfT0ZGU0VUOwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBwaXBlSW5zdGFuY2UgPSBsb2FkKGxWaWV3LCBhZGp1c3RlZEluZGV4KTsKICByZXR1cm4gaXNQdXJlKGxWaWV3LCBhZGp1c3RlZEluZGV4KSA/IHB1cmVGdW5jdGlvbjNJbnRlcm5hbChsVmlldywgZ2V0QmluZGluZ1Jvb3QoKSwgc2xvdE9mZnNldCwgcGlwZUluc3RhbmNlLnRyYW5zZm9ybSwgdjEsIHYyLCB2MywgcGlwZUluc3RhbmNlKSA6IHBpcGVJbnN0YW5jZS50cmFuc2Zvcm0odjEsIHYyLCB2Myk7Cn0KZnVuY3Rpb24gybXJtXBpcGVCaW5kNChpbmRleCwgc2xvdE9mZnNldCwgdjEsIHYyLCB2MywgdjQpIHsKICBjb25zdCBhZGp1c3RlZEluZGV4ID0gaW5kZXggKyBIRUFERVJfT0ZGU0VUOwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBwaXBlSW5zdGFuY2UgPSBsb2FkKGxWaWV3LCBhZGp1c3RlZEluZGV4KTsKICByZXR1cm4gaXNQdXJlKGxWaWV3LCBhZGp1c3RlZEluZGV4KSA/IHB1cmVGdW5jdGlvbjRJbnRlcm5hbChsVmlldywgZ2V0QmluZGluZ1Jvb3QoKSwgc2xvdE9mZnNldCwgcGlwZUluc3RhbmNlLnRyYW5zZm9ybSwgdjEsIHYyLCB2MywgdjQsIHBpcGVJbnN0YW5jZSkgOiBwaXBlSW5zdGFuY2UudHJhbnNmb3JtKHYxLCB2MiwgdjMsIHY0KTsKfQpmdW5jdGlvbiDJtcm1cGlwZUJpbmRWKGluZGV4LCBzbG90T2Zmc2V0LCB2YWx1ZXMpIHsKICBjb25zdCBhZGp1c3RlZEluZGV4ID0gaW5kZXggKyBIRUFERVJfT0ZGU0VUOwogIGNvbnN0IGxWaWV3ID0gZ2V0TFZpZXcoKTsKICBjb25zdCBwaXBlSW5zdGFuY2UgPSBsb2FkKGxWaWV3LCBhZGp1c3RlZEluZGV4KTsKICByZXR1cm4gaXNQdXJlKGxWaWV3LCBhZGp1c3RlZEluZGV4KSA/IHB1cmVGdW5jdGlvblZJbnRlcm5hbChsVmlldywgZ2V0QmluZGluZ1Jvb3QoKSwgc2xvdE9mZnNldCwgcGlwZUluc3RhbmNlLnRyYW5zZm9ybSwgdmFsdWVzLCBwaXBlSW5zdGFuY2UpIDogcGlwZUluc3RhbmNlLnRyYW5zZm9ybS5hcHBseShwaXBlSW5zdGFuY2UsIHZhbHVlcyk7Cn0KZnVuY3Rpb24gaXNQdXJlKGxWaWV3LCBpbmRleCkgewogIHJldHVybiBsVmlld1tUVklFV10uZGF0YVtpbmRleF0ucHVyZTsKfQpmdW5jdGlvbiDJtcm1dGVtcGxhdGVSZWZFeHRyYWN0b3IodE5vZGUsIGxWaWV3KSB7CiAgcmV0dXJuIGNyZWF0ZVRlbXBsYXRlUmVmKHROb2RlLCBsVmlldyk7Cn0KZnVuY3Rpb24gybXJtWdldENvbXBvbmVudERlcHNGYWN0b3J5KHR5cGUsIHJhd0ltcG9ydHMpIHsKICByZXR1cm4gKCkgPT4gewogICAgdHJ5IHsKICAgICAgcmV0dXJuIGRlcHNUcmFja2VyLmdldENvbXBvbmVudERlcGVuZGVuY2llcyh0eXBlLCByYXdJbXBvcnRzKS5kZXBlbmRlbmNpZXM7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoYENvbXB1dGluZyBkZXBlbmRlbmNpZXMgaW4gbG9jYWwgY29tcGlsYXRpb24gbW9kZSBmb3IgdGhlIGNvbXBvbmVudCAiJHt0eXBlLm5hbWV9IiBmYWlsZWQgd2l0aCB0aGUgZXhjZXB0aW9uOmAsIGUpOwogICAgICB0aHJvdyBlOwogICAgfQogIH07Cn0KZnVuY3Rpb24gybVzZXRDbGFzc0RlYnVnSW5mbyh0eXBlLCBkZWJ1Z0luZm8pIHsKICBjb25zdCBkZWYgPSBnZXRDb21wb25lbnREZWYodHlwZSk7CiAgaWYgKGRlZiAhPT0gbnVsbCkgewogICAgZGVmLmRlYnVnSW5mbyA9IGRlYnVnSW5mbzsKICB9Cn0KZnVuY3Rpb24gybXJtWdldFJlcGxhY2VNZXRhZGF0YVVSTChpZCwgdGltZXN0YW1wMiwgYmFzZSkgewogIGNvbnN0IHVybCA9IGAuL0BuZy9jb21wb25lbnQ/Yz0ke2lkfSZ0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRpbWVzdGFtcDIpfWA7CiAgcmV0dXJuIG5ldyBVUkwodXJsLCBiYXNlKS5ocmVmOwp9CmZ1bmN0aW9uIMm1ybVyZXBsYWNlTWV0YWRhdGEodHlwZSwgYXBwbHlNZXRhZGF0YSwgbmFtZXNwYWNlcywgbG9jYWxzLCBpbXBvcnRNZXRhID0gbnVsbCwgaWQgPSBudWxsKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydENvbXBvbmVudERlZih0eXBlKTsKICBjb25zdCBjdXJyZW50RGVmID0gZ2V0Q29tcG9uZW50RGVmKHR5cGUpOwogIGFwcGx5TWV0YWRhdGEuYXBwbHkobnVsbCwgW3R5cGUsIG5hbWVzcGFjZXMsIC4uLmxvY2Fsc10pOwogIGNvbnN0IHsKICAgIG5ld0RlZiwKICAgIG9sZERlZgogIH0gPSBtZXJnZVdpdGhFeGlzdGluZ0RlZmluaXRpb24oY3VycmVudERlZiwgZ2V0Q29tcG9uZW50RGVmKHR5cGUpKTsKICB0eXBlW05HX0NPTVBfREVGXSA9IG5ld0RlZjsKICBpZiAob2xkRGVmLnRWaWV3KSB7CiAgICBjb25zdCB0cmFja2VkVmlld3MgPSBnZXRUcmFja2VkTFZpZXdzKCkudmFsdWVzKCk7CiAgICBmb3IgKGNvbnN0IHJvb3Qgb2YgdHJhY2tlZFZpZXdzKSB7CiAgICAgIGlmIChpc1Jvb3RWaWV3KHJvb3QpICYmIHJvb3RbUEFSRU5UXSA9PT0gbnVsbCkgewogICAgICAgIHJlY3JlYXRlTWF0Y2hpbmdMVmlld3MoaW1wb3J0TWV0YSwgaWQsIG5ld0RlZiwgb2xkRGVmLCByb290KTsKICAgICAgfQogICAgfQogIH0KfQpmdW5jdGlvbiBtZXJnZVdpdGhFeGlzdGluZ0RlZmluaXRpb24oY3VycmVudERlZiwgbmV3RGVmKSB7CiAgY29uc3QgY2xvbmUgPSBfX3NwcmVhZFZhbHVlcyh7fSwgY3VycmVudERlZik7CiAgY29uc3QgcmVwbGFjZW1lbnQgPSBPYmplY3QuYXNzaWduKGN1cnJlbnREZWYsIG5ld0RlZiwgewogICAgZGlyZWN0aXZlRGVmczogY2xvbmUuZGlyZWN0aXZlRGVmcywKICAgIHBpcGVEZWZzOiBjbG9uZS5waXBlRGVmcywKICAgIHNldElucHV0OiBjbG9uZS5zZXRJbnB1dCwKICAgIHR5cGU6IGNsb25lLnR5cGUKICB9KTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RXF1YWwocmVwbGFjZW1lbnQsIGN1cnJlbnREZWYsICJFeHBlY3RlZCBkZWZpbml0aW9uIHRvIGJlIG1lcmdlZCBpbiBwbGFjZSIpOwogIHJldHVybiB7CiAgICBuZXdEZWY6IHJlcGxhY2VtZW50LAogICAgb2xkRGVmOiBjbG9uZQogIH07Cn0KZnVuY3Rpb24gcmVjcmVhdGVNYXRjaGluZ0xWaWV3cyhpbXBvcnRNZXRhLCBpZCwgbmV3RGVmLCBvbGREZWYsIHJvb3RMVmlldykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKG9sZERlZi50VmlldywgIkV4cGVjdGVkIGEgY29tcG9uZW50IGRlZmluaXRpb24gdGhhdCBoYXMgYmVlbiBpbnN0YW50aWF0ZWQgYXQgbGVhc3Qgb25jZSIpOwogIGNvbnN0IHRWaWV3ID0gcm9vdExWaWV3W1RWSUVXXTsKICBpZiAodFZpZXcgPT09IG9sZERlZi50VmlldykgewogICAgbmdEZXZNb2RlICYmIGFzc2VydENvbXBvbmVudERlZihvbGREZWYudHlwZSk7CiAgICByZWNyZWF0ZUxWaWV3KGltcG9ydE1ldGEsIGlkLCBuZXdEZWYsIG9sZERlZiwgcm9vdExWaWV3KTsKICAgIHJldHVybjsKICB9CiAgZm9yIChsZXQgaSA9IEhFQURFUl9PRkZTRVQ7IGkgPCB0Vmlldy5iaW5kaW5nU3RhcnRJbmRleDsgaSsrKSB7CiAgICBjb25zdCBjdXJyZW50ID0gcm9vdExWaWV3W2ldOwogICAgaWYgKGlzTENvbnRhaW5lcihjdXJyZW50KSkgewogICAgICBpZiAoaXNMVmlldyhjdXJyZW50W0hPU1RdKSkgewogICAgICAgIHJlY3JlYXRlTWF0Y2hpbmdMVmlld3MoaW1wb3J0TWV0YSwgaWQsIG5ld0RlZiwgb2xkRGVmLCBjdXJyZW50W0hPU1RdKTsKICAgICAgfQogICAgICBmb3IgKGxldCBqID0gQ09OVEFJTkVSX0hFQURFUl9PRkZTRVQ7IGogPCBjdXJyZW50Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgcmVjcmVhdGVNYXRjaGluZ0xWaWV3cyhpbXBvcnRNZXRhLCBpZCwgbmV3RGVmLCBvbGREZWYsIGN1cnJlbnRbal0pOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGlzTFZpZXcoY3VycmVudCkpIHsKICAgICAgcmVjcmVhdGVNYXRjaGluZ0xWaWV3cyhpbXBvcnRNZXRhLCBpZCwgbmV3RGVmLCBvbGREZWYsIGN1cnJlbnQpOwogICAgfQogIH0KfQpmdW5jdGlvbiBjbGVhclJlbmRlcmVyQ2FjaGUoZmFjdG9yeSwgZGVmKSB7CiAgZmFjdG9yeS5jb21wb25lbnRSZXBsYWNlZD8uKGRlZi5pZCk7Cn0KZnVuY3Rpb24gcmVjcmVhdGVMVmlldyhpbXBvcnRNZXRhLCBpZCwgbmV3RGVmLCBvbGREZWYsIGxWaWV3KSB7CiAgY29uc3QgaW5zdGFuY2UgPSBsVmlld1tDT05URVhUXTsKICBsZXQgaG9zdCA9IGxWaWV3W0hPU1RdOwogIGNvbnN0IHBhcmVudExWaWV3ID0gbFZpZXdbUEFSRU5UXTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0TFZpZXcocGFyZW50TFZpZXcpOwogIGNvbnN0IHROb2RlID0gbFZpZXdbVF9IT1NUXTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVUeXBlKHROb2RlLCAyKTsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90RXF1YWwobmV3RGVmLCBvbGREZWYsICJFeHBlY3RlZCBkaWZmZXJlbnQgY29tcG9uZW50IGRlZmluaXRpb24iKTsKICBjb25zdCB6b25lID0gbFZpZXdbSU5KRUNUT1JdLmdldChOZ1pvbmUsIG51bGwpOwogIGNvbnN0IHJlY3JlYXRlID0gKCkgPT4gewogICAgaWYgKG9sZERlZi5lbmNhcHN1bGF0aW9uID09PSBWaWV3RW5jYXBzdWxhdGlvbi5TaGFkb3dEb20gfHwgb2xkRGVmLmVuY2Fwc3VsYXRpb24gPT09IFZpZXdFbmNhcHN1bGF0aW9uLkV4cGVyaW1lbnRhbElzb2xhdGVkU2hhZG93RG9tKSB7CiAgICAgIGNvbnN0IG5ld0hvc3QgPSBob3N0LmNsb25lTm9kZShmYWxzZSk7CiAgICAgIGhvc3QucmVwbGFjZVdpdGgobmV3SG9zdCk7CiAgICAgIGhvc3QgPSBuZXdIb3N0OwogICAgfQogICAgY29uc3QgbmV3VFZpZXcgPSBnZXRPckNyZWF0ZUNvbXBvbmVudFRWaWV3KG5ld0RlZik7CiAgICBjb25zdCBuZXdMVmlldyA9IGNyZWF0ZUxWaWV3KHBhcmVudExWaWV3LCBuZXdUVmlldywgaW5zdGFuY2UsIGdldEluaXRpYWxMVmlld0ZsYWdzRnJvbURlZihuZXdEZWYpLCBob3N0LCB0Tm9kZSwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCk7CiAgICByZXBsYWNlTFZpZXdJblRyZWUocGFyZW50TFZpZXcsIGxWaWV3LCBuZXdMVmlldywgdE5vZGUuaW5kZXgpOwogICAgZGVzdHJveUxWaWV3KGxWaWV3W1RWSUVXXSwgbFZpZXcpOwogICAgY29uc3QgcmVuZGVyZXJGYWN0b3J5ID0gbFZpZXdbRU5WSVJPTk1FTlRdLnJlbmRlcmVyRmFjdG9yeTsKICAgIGNsZWFyUmVuZGVyZXJDYWNoZShyZW5kZXJlckZhY3RvcnksIG9sZERlZik7CiAgICBuZXdMVmlld1tSRU5ERVJFUl0gPSByZW5kZXJlckZhY3RvcnkuY3JlYXRlUmVuZGVyZXIoaG9zdCwgbmV3RGVmKTsKICAgIHJlbW92ZVZpZXdGcm9tRE9NKGxWaWV3W1RWSUVXXSwgbFZpZXcpOwogICAgcmVzZXRQcm9qZWN0aW9uU3RhdGUodE5vZGUpOwogICAgcmVuZGVyVmlldyhuZXdUVmlldywgbmV3TFZpZXcsIGluc3RhbmNlKTsKICAgIHJlZnJlc2hWaWV3KG5ld1RWaWV3LCBuZXdMVmlldywgbmV3VFZpZXcudGVtcGxhdGUsIGluc3RhbmNlKTsKICB9OwogIGlmICh6b25lID09PSBudWxsKSB7CiAgICBleGVjdXRlV2l0aEludmFsaWRhdGVGYWxsYmFjayhpbXBvcnRNZXRhLCBpZCwgcmVjcmVhdGUpOwogIH0gZWxzZSB7CiAgICB6b25lLnJ1bigoKSA9PiBleGVjdXRlV2l0aEludmFsaWRhdGVGYWxsYmFjayhpbXBvcnRNZXRhLCBpZCwgcmVjcmVhdGUpKTsKICB9Cn0KZnVuY3Rpb24gZXhlY3V0ZVdpdGhJbnZhbGlkYXRlRmFsbGJhY2soaW1wb3J0TWV0YSwgaWQsIGNhbGxiYWNrKSB7CiAgdHJ5IHsKICAgIGNhbGxiYWNrKCk7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc3QgZXJyb3IgPSBlOwogICAgaWYgKGlkICE9PSBudWxsICYmIGVycm9yLm1lc3NhZ2UpIHsKICAgICAgY29uc3QgdG9Mb2cgPSBlcnJvci5tZXNzYWdlICsgKGVycm9yLnN0YWNrID8gIlxuIiArIGVycm9yLnN0YWNrIDogIiIpOwogICAgICBpbXBvcnRNZXRhPy5ob3Q/LnNlbmQ/LigiYW5ndWxhcjppbnZhbGlkYXRlIiwgewogICAgICAgIGlkLAogICAgICAgIG1lc3NhZ2U6IHRvTG9nLAogICAgICAgIGVycm9yOiB0cnVlCiAgICAgIH0pOwogICAgfQogICAgdGhyb3cgZTsKICB9Cn0KZnVuY3Rpb24gcmVwbGFjZUxWaWV3SW5UcmVlKHBhcmVudExWaWV3LCBvbGRMVmlldywgbmV3TFZpZXcsIGluZGV4KSB7CiAgZm9yIChsZXQgaSA9IEhFQURFUl9PRkZTRVQ7IGkgPCBwYXJlbnRMVmlld1tUVklFV10uYmluZGluZ1N0YXJ0SW5kZXg7IGkrKykgewogICAgY29uc3QgY3VycmVudCA9IHBhcmVudExWaWV3W2ldOwogICAgaWYgKChpc0xWaWV3KGN1cnJlbnQpIHx8IGlzTENvbnRhaW5lcihjdXJyZW50KSkgJiYgY3VycmVudFtORVhUXSA9PT0gb2xkTFZpZXcpIHsKICAgICAgY3VycmVudFtORVhUXSA9IG5ld0xWaWV3OwogICAgICBicmVhazsKICAgIH0KICB9CiAgaWYgKHBhcmVudExWaWV3W0NISUxEX0hFQURdID09PSBvbGRMVmlldykgewogICAgcGFyZW50TFZpZXdbQ0hJTERfSEVBRF0gPSBuZXdMVmlldzsKICB9CiAgaWYgKHBhcmVudExWaWV3W0NISUxEX1RBSUxdID09PSBvbGRMVmlldykgewogICAgcGFyZW50TFZpZXdbQ0hJTERfVEFJTF0gPSBuZXdMVmlldzsKICB9CiAgbmV3TFZpZXdbTkVYVF0gPSBvbGRMVmlld1tORVhUXTsKICBvbGRMVmlld1tORVhUXSA9IG51bGw7CiAgcGFyZW50TFZpZXdbaW5kZXhdID0gbmV3TFZpZXc7Cn0KZnVuY3Rpb24gcmVzZXRQcm9qZWN0aW9uU3RhdGUodE5vZGUpIHsKICBpZiAodE5vZGUucHJvamVjdGlvbiAhPT0gbnVsbCkgewogICAgZm9yIChjb25zdCBjdXJyZW50IG9mIHROb2RlLnByb2plY3Rpb24pIHsKICAgICAgaWYgKGlzVE5vZGVTaGFwZShjdXJyZW50KSkgewogICAgICAgIGN1cnJlbnQucHJvamVjdGlvbk5leHQgPSBudWxsOwogICAgICAgIGN1cnJlbnQuZmxhZ3MgJj0gfjI7CiAgICAgIH0KICAgIH0KICAgIHROb2RlLnByb2plY3Rpb24gPSBudWxsOwogIH0KfQp2YXIgYW5ndWxhckNvcmVFbnYgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+ICh7CiAgIsm1ybVhbmltYXRlRW50ZXIiOiDJtcm1YW5pbWF0ZUVudGVyLAogICLJtcm1YW5pbWF0ZUVudGVyTGlzdGVuZXIiOiDJtcm1YW5pbWF0ZUVudGVyTGlzdGVuZXIsCiAgIsm1ybVhbmltYXRlTGVhdmUiOiDJtcm1YW5pbWF0ZUxlYXZlLAogICLJtcm1YW5pbWF0ZUxlYXZlTGlzdGVuZXIiOiDJtcm1YW5pbWF0ZUxlYXZlTGlzdGVuZXIsCiAgIsm1ybVhdHRyaWJ1dGUiOiDJtcm1YXR0cmlidXRlLAogICLJtcm1ZGVmaW5lQ29tcG9uZW50IjogybXJtWRlZmluZUNvbXBvbmVudCwKICAiybXJtWRlZmluZURpcmVjdGl2ZSI6IMm1ybVkZWZpbmVEaXJlY3RpdmUsCiAgIsm1ybVkZWZpbmVJbmplY3RhYmxlIjogybXJtWRlZmluZUluamVjdGFibGUsCiAgIsm1ybVkZWZpbmVJbmplY3RvciI6IMm1ybVkZWZpbmVJbmplY3RvciwKICAiybXJtWRlZmluZU5nTW9kdWxlIjogybXJtWRlZmluZU5nTW9kdWxlLAogICLJtcm1ZGVmaW5lUGlwZSI6IMm1ybVkZWZpbmVQaXBlLAogICLJtcm1ZGlyZWN0aXZlSW5qZWN0IjogybXJtWRpcmVjdGl2ZUluamVjdCwKICAiybXJtWdldEluaGVyaXRlZEZhY3RvcnkiOiDJtcm1Z2V0SW5oZXJpdGVkRmFjdG9yeSwKICAiybXJtWluamVjdCI6IMm1ybVpbmplY3QsCiAgIsm1ybVpbmplY3RBdHRyaWJ1dGUiOiDJtcm1aW5qZWN0QXR0cmlidXRlLAogICLJtcm1aW52YWxpZEZhY3RvcnkiOiDJtcm1aW52YWxpZEZhY3RvcnksCiAgIsm1ybVpbnZhbGlkRmFjdG9yeURlcCI6IMm1ybVpbnZhbGlkRmFjdG9yeURlcCwKICAiybXJtXRlbXBsYXRlUmVmRXh0cmFjdG9yIjogybXJtXRlbXBsYXRlUmVmRXh0cmFjdG9yLAogICLJtcm1cmVzZXRWaWV3IjogybXJtXJlc2V0VmlldywKICAiybXJtUhvc3REaXJlY3RpdmVzRmVhdHVyZSI6IMm1ybVIb3N0RGlyZWN0aXZlc0ZlYXR1cmUsCiAgIsm1ybVOZ09uQ2hhbmdlc0ZlYXR1cmUiOiDJtcm1TmdPbkNoYW5nZXNGZWF0dXJlLAogICLJtcm1UHJvdmlkZXJzRmVhdHVyZSI6IMm1ybVQcm92aWRlcnNGZWF0dXJlLAogICLJtcm1SW5oZXJpdERlZmluaXRpb25GZWF0dXJlIjogybXJtUluaGVyaXREZWZpbml0aW9uRmVhdHVyZSwKICAiybXJtUV4dGVybmFsU3R5bGVzRmVhdHVyZSI6IMm1ybVFeHRlcm5hbFN0eWxlc0ZlYXR1cmUsCiAgIsm1ybVuZXh0Q29udGV4dCI6IMm1ybVuZXh0Q29udGV4dCwKICAiybXJtW5hbWVzcGFjZUhUTUwiOiDJtcm1bmFtZXNwYWNlSFRNTCwKICAiybXJtW5hbWVzcGFjZU1hdGhNTCI6IMm1ybVuYW1lc3BhY2VNYXRoTUwsCiAgIsm1ybVuYW1lc3BhY2VTVkciOiDJtcm1bmFtZXNwYWNlU1ZHLAogICLJtcm1ZW5hYmxlQmluZGluZ3MiOiDJtcm1ZW5hYmxlQmluZGluZ3MsCiAgIsm1ybVkaXNhYmxlQmluZGluZ3MiOiDJtcm1ZGlzYWJsZUJpbmRpbmdzLAogICLJtcm1ZWxlbWVudFN0YXJ0IjogybXJtWVsZW1lbnRTdGFydCwKICAiybXJtWVsZW1lbnRFbmQiOiDJtcm1ZWxlbWVudEVuZCwKICAiybXJtWVsZW1lbnQiOiDJtcm1ZWxlbWVudCwKICAiybXJtWVsZW1lbnRDb250YWluZXJTdGFydCI6IMm1ybVlbGVtZW50Q29udGFpbmVyU3RhcnQsCiAgIsm1ybVlbGVtZW50Q29udGFpbmVyRW5kIjogybXJtWVsZW1lbnRDb250YWluZXJFbmQsCiAgIsm1ybVkb21FbGVtZW50IjogybXJtWRvbUVsZW1lbnQsCiAgIsm1ybVkb21FbGVtZW50U3RhcnQiOiDJtcm1ZG9tRWxlbWVudFN0YXJ0LAogICLJtcm1ZG9tRWxlbWVudEVuZCI6IMm1ybVkb21FbGVtZW50RW5kLAogICLJtcm1ZG9tRWxlbWVudENvbnRhaW5lciI6IMm1ybVkb21FbGVtZW50Q29udGFpbmVyLAogICLJtcm1ZG9tRWxlbWVudENvbnRhaW5lclN0YXJ0IjogybXJtWRvbUVsZW1lbnRDb250YWluZXJTdGFydCwKICAiybXJtWRvbUVsZW1lbnRDb250YWluZXJFbmQiOiDJtcm1ZG9tRWxlbWVudENvbnRhaW5lckVuZCwKICAiybXJtWRvbVRlbXBsYXRlIjogybXJtWRvbVRlbXBsYXRlLAogICLJtcm1ZG9tTGlzdGVuZXIiOiDJtcm1ZG9tTGlzdGVuZXIsCiAgIsm1ybVlbGVtZW50Q29udGFpbmVyIjogybXJtWVsZW1lbnRDb250YWluZXIsCiAgIsm1ybVwdXJlRnVuY3Rpb24wIjogybXJtXB1cmVGdW5jdGlvbjAsCiAgIsm1ybVwdXJlRnVuY3Rpb24xIjogybXJtXB1cmVGdW5jdGlvbjEsCiAgIsm1ybVwdXJlRnVuY3Rpb24yIjogybXJtXB1cmVGdW5jdGlvbjIsCiAgIsm1ybVwdXJlRnVuY3Rpb24zIjogybXJtXB1cmVGdW5jdGlvbjMsCiAgIsm1ybVwdXJlRnVuY3Rpb240IjogybXJtXB1cmVGdW5jdGlvbjQsCiAgIsm1ybVwdXJlRnVuY3Rpb241IjogybXJtXB1cmVGdW5jdGlvbjUsCiAgIsm1ybVwdXJlRnVuY3Rpb242IjogybXJtXB1cmVGdW5jdGlvbjYsCiAgIsm1ybVwdXJlRnVuY3Rpb243IjogybXJtXB1cmVGdW5jdGlvbjcsCiAgIsm1ybVwdXJlRnVuY3Rpb244IjogybXJtXB1cmVGdW5jdGlvbjgsCiAgIsm1ybVwdXJlRnVuY3Rpb25WIjogybXJtXB1cmVGdW5jdGlvblYsCiAgIsm1ybVnZXRDdXJyZW50VmlldyI6IMm1ybVnZXRDdXJyZW50VmlldywKICAiybXJtXJlc3RvcmVWaWV3IjogybXJtXJlc3RvcmVWaWV3LAogICLJtcm1bGlzdGVuZXIiOiDJtcm1bGlzdGVuZXIsCiAgIsm1ybVwcm9qZWN0aW9uIjogybXJtXByb2plY3Rpb24sCiAgIsm1ybVzeW50aGV0aWNIb3N0UHJvcGVydHkiOiDJtcm1c3ludGhldGljSG9zdFByb3BlcnR5LAogICLJtcm1c3ludGhldGljSG9zdExpc3RlbmVyIjogybXJtXN5bnRoZXRpY0hvc3RMaXN0ZW5lciwKICAiybXJtXBpcGVCaW5kMSI6IMm1ybVwaXBlQmluZDEsCiAgIsm1ybVwaXBlQmluZDIiOiDJtcm1cGlwZUJpbmQyLAogICLJtcm1cGlwZUJpbmQzIjogybXJtXBpcGVCaW5kMywKICAiybXJtXBpcGVCaW5kNCI6IMm1ybVwaXBlQmluZDQsCiAgIsm1ybVwaXBlQmluZFYiOiDJtcm1cGlwZUJpbmRWLAogICLJtcm1cHJvamVjdGlvbkRlZiI6IMm1ybVwcm9qZWN0aW9uRGVmLAogICLJtcm1ZG9tUHJvcGVydHkiOiDJtcm1ZG9tUHJvcGVydHksCiAgIsm1ybVhcmlhUHJvcGVydHkiOiDJtcm1YXJpYVByb3BlcnR5LAogICLJtcm1cHJvcGVydHkiOiDJtcm1cHJvcGVydHksCiAgIsm1ybVjb250cm9sIjogybXJtWNvbnRyb2wsCiAgIsm1ybVjb250cm9sQ3JlYXRlIjogybXJtWNvbnRyb2xDcmVhdGUsCiAgIsm1ybVwaXBlIjogybXJtXBpcGUsCiAgIsm1ybVxdWVyeVJlZnJlc2giOiDJtcm1cXVlcnlSZWZyZXNoLAogICLJtcm1cXVlcnlBZHZhbmNlIjogybXJtXF1ZXJ5QWR2YW5jZSwKICAiybXJtXZpZXdRdWVyeSI6IMm1ybV2aWV3UXVlcnksCiAgIsm1ybV2aWV3UXVlcnlTaWduYWwiOiDJtcm1dmlld1F1ZXJ5U2lnbmFsLAogICLJtcm1bG9hZFF1ZXJ5IjogybXJtWxvYWRRdWVyeSwKICAiybXJtWNvbnRlbnRRdWVyeSI6IMm1ybVjb250ZW50UXVlcnksCiAgIsm1ybVjb250ZW50UXVlcnlTaWduYWwiOiDJtcm1Y29udGVudFF1ZXJ5U2lnbmFsLAogICLJtcm1cmVmZXJlbmNlIjogybXJtXJlZmVyZW5jZSwKICAiybXJtWNsYXNzTWFwIjogybXJtWNsYXNzTWFwLAogICLJtcm1c3R5bGVNYXAiOiDJtcm1c3R5bGVNYXAsCiAgIsm1ybVzdHlsZVByb3AiOiDJtcm1c3R5bGVQcm9wLAogICLJtcm1Y2xhc3NQcm9wIjogybXJtWNsYXNzUHJvcCwKICAiybXJtWFkdmFuY2UiOiDJtcm1YWR2YW5jZSwKICAiybXJtXRlbXBsYXRlIjogybXJtXRlbXBsYXRlLAogICLJtcm1Y29uZGl0aW9uYWwiOiDJtcm1Y29uZGl0aW9uYWwsCiAgIsm1ybVjb25kaXRpb25hbENyZWF0ZSI6IMm1ybVjb25kaXRpb25hbENyZWF0ZSwKICAiybXJtWNvbmRpdGlvbmFsQnJhbmNoQ3JlYXRlIjogybXJtWNvbmRpdGlvbmFsQnJhbmNoQ3JlYXRlLAogICLJtcm1ZGVmZXIiOiDJtcm1ZGVmZXIsCiAgIsm1ybVkZWZlcldoZW4iOiDJtcm1ZGVmZXJXaGVuLAogICLJtcm1ZGVmZXJPbklkbGUiOiDJtcm1ZGVmZXJPbklkbGUsCiAgIsm1ybVkZWZlck9uSW1tZWRpYXRlIjogybXJtWRlZmVyT25JbW1lZGlhdGUsCiAgIsm1ybVkZWZlck9uVGltZXIiOiDJtcm1ZGVmZXJPblRpbWVyLAogICLJtcm1ZGVmZXJPbkhvdmVyIjogybXJtWRlZmVyT25Ib3ZlciwKICAiybXJtWRlZmVyT25JbnRlcmFjdGlvbiI6IMm1ybVkZWZlck9uSW50ZXJhY3Rpb24sCiAgIsm1ybVkZWZlck9uVmlld3BvcnQiOiDJtcm1ZGVmZXJPblZpZXdwb3J0LAogICLJtcm1ZGVmZXJQcmVmZXRjaFdoZW4iOiDJtcm1ZGVmZXJQcmVmZXRjaFdoZW4sCiAgIsm1ybVkZWZlclByZWZldGNoT25JZGxlIjogybXJtWRlZmVyUHJlZmV0Y2hPbklkbGUsCiAgIsm1ybVkZWZlclByZWZldGNoT25JbW1lZGlhdGUiOiDJtcm1ZGVmZXJQcmVmZXRjaE9uSW1tZWRpYXRlLAogICLJtcm1ZGVmZXJQcmVmZXRjaE9uVGltZXIiOiDJtcm1ZGVmZXJQcmVmZXRjaE9uVGltZXIsCiAgIsm1ybVkZWZlclByZWZldGNoT25Ib3ZlciI6IMm1ybVkZWZlclByZWZldGNoT25Ib3ZlciwKICAiybXJtWRlZmVyUHJlZmV0Y2hPbkludGVyYWN0aW9uIjogybXJtWRlZmVyUHJlZmV0Y2hPbkludGVyYWN0aW9uLAogICLJtcm1ZGVmZXJQcmVmZXRjaE9uVmlld3BvcnQiOiDJtcm1ZGVmZXJQcmVmZXRjaE9uVmlld3BvcnQsCiAgIsm1ybVkZWZlckh5ZHJhdGVXaGVuIjogybXJtWRlZmVySHlkcmF0ZVdoZW4sCiAgIsm1ybVkZWZlckh5ZHJhdGVOZXZlciI6IMm1ybVkZWZlckh5ZHJhdGVOZXZlciwKICAiybXJtWRlZmVySHlkcmF0ZU9uSWRsZSI6IMm1ybVkZWZlckh5ZHJhdGVPbklkbGUsCiAgIsm1ybVkZWZlckh5ZHJhdGVPbkltbWVkaWF0ZSI6IMm1ybVkZWZlckh5ZHJhdGVPbkltbWVkaWF0ZSwKICAiybXJtWRlZmVySHlkcmF0ZU9uVGltZXIiOiDJtcm1ZGVmZXJIeWRyYXRlT25UaW1lciwKICAiybXJtWRlZmVySHlkcmF0ZU9uSG92ZXIiOiDJtcm1ZGVmZXJIeWRyYXRlT25Ib3ZlciwKICAiybXJtWRlZmVySHlkcmF0ZU9uSW50ZXJhY3Rpb24iOiDJtcm1ZGVmZXJIeWRyYXRlT25JbnRlcmFjdGlvbiwKICAiybXJtWRlZmVySHlkcmF0ZU9uVmlld3BvcnQiOiDJtcm1ZGVmZXJIeWRyYXRlT25WaWV3cG9ydCwKICAiybXJtWRlZmVyRW5hYmxlVGltZXJTY2hlZHVsaW5nIjogybXJtWRlZmVyRW5hYmxlVGltZXJTY2hlZHVsaW5nLAogICLJtcm1cmVwZWF0ZXIiOiDJtcm1cmVwZWF0ZXIsCiAgIsm1ybVyZXBlYXRlckNyZWF0ZSI6IMm1ybVyZXBlYXRlckNyZWF0ZSwKICAiybXJtXJlcGVhdGVyVHJhY2tCeUluZGV4IjogybXJtXJlcGVhdGVyVHJhY2tCeUluZGV4LAogICLJtcm1cmVwZWF0ZXJUcmFja0J5SWRlbnRpdHkiOiDJtcm1cmVwZWF0ZXJUcmFja0J5SWRlbnRpdHksCiAgIsm1ybVjb21wb25lbnRJbnN0YW5jZSI6IMm1ybVjb21wb25lbnRJbnN0YW5jZSwKICAiybXJtXRleHQiOiDJtcm1dGV4dCwKICAiybXJtXRleHRJbnRlcnBvbGF0ZSI6IMm1ybV0ZXh0SW50ZXJwb2xhdGUsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGUxIjogybXJtXRleHRJbnRlcnBvbGF0ZTEsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGUyIjogybXJtXRleHRJbnRlcnBvbGF0ZTIsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGUzIjogybXJtXRleHRJbnRlcnBvbGF0ZTMsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGU0IjogybXJtXRleHRJbnRlcnBvbGF0ZTQsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGU1IjogybXJtXRleHRJbnRlcnBvbGF0ZTUsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGU2IjogybXJtXRleHRJbnRlcnBvbGF0ZTYsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGU3IjogybXJtXRleHRJbnRlcnBvbGF0ZTcsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGU4IjogybXJtXRleHRJbnRlcnBvbGF0ZTgsCiAgIsm1ybV0ZXh0SW50ZXJwb2xhdGVWIjogybXJtXRleHRJbnRlcnBvbGF0ZVYsCiAgIsm1ybVpMThuIjogybXJtWkxOG4sCiAgIsm1ybVpMThuQXR0cmlidXRlcyI6IMm1ybVpMThuQXR0cmlidXRlcywKICAiybXJtWkxOG5FeHAiOiDJtcm1aTE4bkV4cCwKICAiybXJtWkxOG5TdGFydCI6IMm1ybVpMThuU3RhcnQsCiAgIsm1ybVpMThuRW5kIjogybXJtWkxOG5FbmQsCiAgIsm1ybVpMThuQXBwbHkiOiDJtcm1aTE4bkFwcGx5LAogICLJtcm1aTE4blBvc3Rwcm9jZXNzIjogybXJtWkxOG5Qb3N0cHJvY2VzcywKICAiybXJtXJlc29sdmVXaW5kb3ciOiDJtcm1cmVzb2x2ZVdpbmRvdywKICAiybXJtXJlc29sdmVEb2N1bWVudCI6IMm1ybVyZXNvbHZlRG9jdW1lbnQsCiAgIsm1ybVyZXNvbHZlQm9keSI6IMm1ybVyZXNvbHZlQm9keSwKICAiybXJtXNldENvbXBvbmVudFNjb3BlIjogybXJtXNldENvbXBvbmVudFNjb3BlLAogICLJtcm1c2V0TmdNb2R1bGVTY29wZSI6IMm1ybVzZXROZ01vZHVsZVNjb3BlLAogICLJtcm1cmVnaXN0ZXJOZ01vZHVsZVR5cGUiOiByZWdpc3Rlck5nTW9kdWxlVHlwZSwKICAiybXJtWdldENvbXBvbmVudERlcHNGYWN0b3J5IjogybXJtWdldENvbXBvbmVudERlcHNGYWN0b3J5LAogICLJtXNldENsYXNzRGVidWdJbmZvIjogybVzZXRDbGFzc0RlYnVnSW5mbywKICAiybXJtWRlY2xhcmVMZXQiOiDJtcm1ZGVjbGFyZUxldCwKICAiybXJtXN0b3JlTGV0IjogybXJtXN0b3JlTGV0LAogICLJtcm1cmVhZENvbnRleHRMZXQiOiDJtcm1cmVhZENvbnRleHRMZXQsCiAgIsm1ybVhdHRhY2hTb3VyY2VMb2NhdGlvbnMiOiDJtcm1YXR0YWNoU291cmNlTG9jYXRpb25zLAogICLJtcm1aW50ZXJwb2xhdGUiOiDJtcm1aW50ZXJwb2xhdGUsCiAgIsm1ybVpbnRlcnBvbGF0ZTEiOiDJtcm1aW50ZXJwb2xhdGUxLAogICLJtcm1aW50ZXJwb2xhdGUyIjogybXJtWludGVycG9sYXRlMiwKICAiybXJtWludGVycG9sYXRlMyI6IMm1ybVpbnRlcnBvbGF0ZTMsCiAgIsm1ybVpbnRlcnBvbGF0ZTQiOiDJtcm1aW50ZXJwb2xhdGU0LAogICLJtcm1aW50ZXJwb2xhdGU1IjogybXJtWludGVycG9sYXRlNSwKICAiybXJtWludGVycG9sYXRlNiI6IMm1ybVpbnRlcnBvbGF0ZTYsCiAgIsm1ybVpbnRlcnBvbGF0ZTciOiDJtcm1aW50ZXJwb2xhdGU3LAogICLJtcm1aW50ZXJwb2xhdGU4IjogybXJtWludGVycG9sYXRlOCwKICAiybXJtWludGVycG9sYXRlViI6IMm1ybVpbnRlcnBvbGF0ZVYsCiAgIsm1ybVzYW5pdGl6ZUh0bWwiOiDJtcm1c2FuaXRpemVIdG1sLAogICLJtcm1c2FuaXRpemVTdHlsZSI6IMm1ybVzYW5pdGl6ZVN0eWxlLAogICLJtcm1c2FuaXRpemVSZXNvdXJjZVVybCI6IMm1ybVzYW5pdGl6ZVJlc291cmNlVXJsLAogICLJtcm1c2FuaXRpemVTY3JpcHQiOiDJtcm1c2FuaXRpemVTY3JpcHQsCiAgIsm1ybV2YWxpZGF0ZUF0dHJpYnV0ZSI6IMm1ybV2YWxpZGF0ZUF0dHJpYnV0ZSwKICAiybXJtXNhbml0aXplVXJsIjogybXJtXNhbml0aXplVXJsLAogICLJtcm1c2FuaXRpemVVcmxPclJlc291cmNlVXJsIjogybXJtXNhbml0aXplVXJsT3JSZXNvdXJjZVVybCwKICAiybXJtXRydXN0Q29uc3RhbnRIdG1sIjogybXJtXRydXN0Q29uc3RhbnRIdG1sLAogICLJtcm1dHJ1c3RDb25zdGFudFJlc291cmNlVXJsIjogybXJtXRydXN0Q29uc3RhbnRSZXNvdXJjZVVybCwKICAiZm9yd2FyZFJlZiI6IGZvcndhcmRSZWYsCiAgInJlc29sdmVGb3J3YXJkUmVmIjogcmVzb2x2ZUZvcndhcmRSZWYsCiAgIsm1ybV0d29XYXlQcm9wZXJ0eSI6IMm1ybV0d29XYXlQcm9wZXJ0eSwKICAiybXJtXR3b1dheUJpbmRpbmdTZXQiOiDJtcm1dHdvV2F5QmluZGluZ1NldCwKICAiybXJtXR3b1dheUxpc3RlbmVyIjogybXJtXR3b1dheUxpc3RlbmVyLAogICLJtcm1cmVwbGFjZU1ldGFkYXRhIjogybXJtXJlcGxhY2VNZXRhZGF0YSwKICAiybXJtWdldFJlcGxhY2VNZXRhZGF0YVVSTCI6IMm1ybVnZXRSZXBsYWNlTWV0YWRhdGFVUkwKfSkpKCk7CnZhciBqaXRPcHRpb25zID0gbnVsbDsKZnVuY3Rpb24gc2V0Sml0T3B0aW9ucyhvcHRpb25zKSB7CiAgaWYgKGppdE9wdGlvbnMgIT09IG51bGwpIHsKICAgIGlmIChvcHRpb25zLmRlZmF1bHRFbmNhcHN1bGF0aW9uICE9PSBqaXRPcHRpb25zLmRlZmF1bHRFbmNhcHN1bGF0aW9uKSB7CiAgICAgIG5nRGV2TW9kZSAmJiBjb25zb2xlLmVycm9yKCJQcm92aWRlZCB2YWx1ZSBmb3IgYGRlZmF1bHRFbmNhcHN1bGF0aW9uYCBjYW4gbm90IGJlIGNoYW5nZWQgb25jZSBpdCBoYXMgYmVlbiBzZXQuIik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChvcHRpb25zLnByZXNlcnZlV2hpdGVzcGFjZXMgIT09IGppdE9wdGlvbnMucHJlc2VydmVXaGl0ZXNwYWNlcykgewogICAgICBuZ0Rldk1vZGUgJiYgY29uc29sZS5lcnJvcigiUHJvdmlkZWQgdmFsdWUgZm9yIGBwcmVzZXJ2ZVdoaXRlc3BhY2VzYCBjYW4gbm90IGJlIGNoYW5nZWQgb25jZSBpdCBoYXMgYmVlbiBzZXQuIik7CiAgICAgIHJldHVybjsKICAgIH0KICB9CiAgaml0T3B0aW9ucyA9IG9wdGlvbnM7Cn0KZnVuY3Rpb24gZ2V0Sml0T3B0aW9ucygpIHsKICByZXR1cm4gaml0T3B0aW9uczsKfQpmdW5jdGlvbiByZXNldEppdE9wdGlvbnMoKSB7CiAgaml0T3B0aW9ucyA9IG51bGw7Cn0KdmFyIG1vZHVsZVF1ZXVlID0gW107CmZ1bmN0aW9uIGVucXVldWVNb2R1bGVGb3JEZWxheWVkU2NvcGluZyhtb2R1bGVUeXBlLCBuZ01vZHVsZSkgewogIG1vZHVsZVF1ZXVlLnB1c2goewogICAgbW9kdWxlVHlwZSwKICAgIG5nTW9kdWxlCiAgfSk7Cn0KdmFyIGZsdXNoaW5nTW9kdWxlUXVldWUgPSBmYWxzZTsKZnVuY3Rpb24gZmx1c2hNb2R1bGVTY29waW5nUXVldWVBc011Y2hBc1Bvc3NpYmxlKCkgewogIGlmICghZmx1c2hpbmdNb2R1bGVRdWV1ZSkgewogICAgZmx1c2hpbmdNb2R1bGVRdWV1ZSA9IHRydWU7CiAgICB0cnkgewogICAgICBmb3IgKGxldCBpID0gbW9kdWxlUXVldWUubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBtb2R1bGVUeXBlLAogICAgICAgICAgbmdNb2R1bGUKICAgICAgICB9ID0gbW9kdWxlUXVldWVbaV07CiAgICAgICAgaWYgKG5nTW9kdWxlLmRlY2xhcmF0aW9ucyAmJiBuZ01vZHVsZS5kZWNsYXJhdGlvbnMuZXZlcnkoaXNSZXNvbHZlZERlY2xhcmF0aW9uKSkgewogICAgICAgICAgbW9kdWxlUXVldWUuc3BsaWNlKGksIDEpOwogICAgICAgICAgc2V0U2NvcGVPbkRlY2xhcmVkQ29tcG9uZW50cyhtb2R1bGVUeXBlLCBuZ01vZHVsZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICBmbHVzaGluZ01vZHVsZVF1ZXVlID0gZmFsc2U7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGlzUmVzb2x2ZWREZWNsYXJhdGlvbihkZWNsYXJhdGlvbikgewogIGlmIChBcnJheS5pc0FycmF5KGRlY2xhcmF0aW9uKSkgewogICAgcmV0dXJuIGRlY2xhcmF0aW9uLmV2ZXJ5KGlzUmVzb2x2ZWREZWNsYXJhdGlvbik7CiAgfQogIHJldHVybiAhIXJlc29sdmVGb3J3YXJkUmVmKGRlY2xhcmF0aW9uKTsKfQpmdW5jdGlvbiBjb21waWxlTmdNb2R1bGUobW9kdWxlVHlwZSwgbmdNb2R1bGUgPSB7fSkgewogIGNvbXBpbGVOZ01vZHVsZURlZnMobW9kdWxlVHlwZSwgbmdNb2R1bGUpOwogIGlmIChuZ01vZHVsZS5pZCAhPT0gdm9pZCAwKSB7CiAgICByZWdpc3Rlck5nTW9kdWxlVHlwZShtb2R1bGVUeXBlLCBuZ01vZHVsZS5pZCk7CiAgfQogIGVucXVldWVNb2R1bGVGb3JEZWxheWVkU2NvcGluZyhtb2R1bGVUeXBlLCBuZ01vZHVsZSk7Cn0KZnVuY3Rpb24gY29tcGlsZU5nTW9kdWxlRGVmcyhtb2R1bGVUeXBlLCBuZ01vZHVsZSwgYWxsb3dEdXBsaWNhdGVEZWNsYXJhdGlvbnNJblJvb3QgPSBmYWxzZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnREZWZpbmVkKG1vZHVsZVR5cGUsICJSZXF1aXJlZCB2YWx1ZSBtb2R1bGVUeXBlIik7CiAgbmdEZXZNb2RlICYmIGFzc2VydERlZmluZWQobmdNb2R1bGUsICJSZXF1aXJlZCB2YWx1ZSBuZ01vZHVsZSIpOwogIGNvbnN0IGRlY2xhcmF0aW9ucyA9IGZsYXR0ZW4obmdNb2R1bGUuZGVjbGFyYXRpb25zIHx8IEVNUFRZX0FSUkFZKTsKICBsZXQgbmdNb2R1bGVEZWYgPSBudWxsOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGVUeXBlLCBOR19NT0RfREVGLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6ICgpID0+IHsKICAgICAgaWYgKG5nTW9kdWxlRGVmID09PSBudWxsKSB7CiAgICAgICAgaWYgKG5nRGV2TW9kZSAmJiBuZ01vZHVsZS5pbXBvcnRzICYmIG5nTW9kdWxlLmltcG9ydHMuaW5kZXhPZihtb2R1bGVUeXBlKSA+IC0xKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke3N0cmluZ2lmeUZvckVycm9yKG1vZHVsZVR5cGUpfScgbW9kdWxlIGNhbid0IGltcG9ydCBpdHNlbGZgKTsKICAgICAgICB9CiAgICAgICAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICAgICAgICB1c2FnZTogMCwKICAgICAgICAgIGtpbmQ6ICJOZ01vZHVsZSIsCiAgICAgICAgICB0eXBlOiBtb2R1bGVUeXBlCiAgICAgICAgfSk7CiAgICAgICAgbmdNb2R1bGVEZWYgPSBjb21waWxlci5jb21waWxlTmdNb2R1bGUoYW5ndWxhckNvcmVFbnYsIGBuZzovLy8ke21vZHVsZVR5cGUubmFtZX0vybVtb2QuanNgLCB7CiAgICAgICAgICB0eXBlOiBtb2R1bGVUeXBlLAogICAgICAgICAgYm9vdHN0cmFwOiBmbGF0dGVuKG5nTW9kdWxlLmJvb3RzdHJhcCB8fCBFTVBUWV9BUlJBWSkubWFwKHJlc29sdmVGb3J3YXJkUmVmKSwKICAgICAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zLm1hcChyZXNvbHZlRm9yd2FyZFJlZiksCiAgICAgICAgICBpbXBvcnRzOiBmbGF0dGVuKG5nTW9kdWxlLmltcG9ydHMgfHwgRU1QVFlfQVJSQVkpLm1hcChyZXNvbHZlRm9yd2FyZFJlZikubWFwKGV4cGFuZE1vZHVsZVdpdGhQcm92aWRlcnMpLAogICAgICAgICAgZXhwb3J0czogZmxhdHRlbihuZ01vZHVsZS5leHBvcnRzIHx8IEVNUFRZX0FSUkFZKS5tYXAocmVzb2x2ZUZvcndhcmRSZWYpLm1hcChleHBhbmRNb2R1bGVXaXRoUHJvdmlkZXJzKSwKICAgICAgICAgIHNjaGVtYXM6IG5nTW9kdWxlLnNjaGVtYXMgPyBmbGF0dGVuKG5nTW9kdWxlLnNjaGVtYXMpIDogbnVsbCwKICAgICAgICAgIGlkOiBuZ01vZHVsZS5pZCB8fCBudWxsCiAgICAgICAgfSk7CiAgICAgICAgaWYgKCFuZ01vZHVsZURlZi5zY2hlbWFzKSB7CiAgICAgICAgICBuZ01vZHVsZURlZi5zY2hlbWFzID0gW107CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBuZ01vZHVsZURlZjsKICAgIH0KICB9KTsKICBsZXQgbmdGYWN0b3J5RGVmID0gbnVsbDsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlVHlwZSwgTkdfRkFDVE9SWV9ERUYsIHsKICAgIGdldDogKCkgPT4gewogICAgICBpZiAobmdGYWN0b3J5RGVmID09PSBudWxsKSB7CiAgICAgICAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICAgICAgICB1c2FnZTogMCwKICAgICAgICAgIGtpbmQ6ICJOZ01vZHVsZSIsCiAgICAgICAgICB0eXBlOiBtb2R1bGVUeXBlCiAgICAgICAgfSk7CiAgICAgICAgbmdGYWN0b3J5RGVmID0gY29tcGlsZXIuY29tcGlsZUZhY3RvcnkoYW5ndWxhckNvcmVFbnYsIGBuZzovLy8ke21vZHVsZVR5cGUubmFtZX0vybVmYWMuanNgLCB7CiAgICAgICAgICBuYW1lOiBtb2R1bGVUeXBlLm5hbWUsCiAgICAgICAgICB0eXBlOiBtb2R1bGVUeXBlLAogICAgICAgICAgZGVwczogcmVmbGVjdERlcGVuZGVuY2llcyhtb2R1bGVUeXBlKSwKICAgICAgICAgIHRhcmdldDogY29tcGlsZXIuRmFjdG9yeVRhcmdldC5OZ01vZHVsZSwKICAgICAgICAgIHR5cGVBcmd1bWVudENvdW50OiAwCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5nRmFjdG9yeURlZjsKICAgIH0sCiAgICBjb25maWd1cmFibGU6ICEhbmdEZXZNb2RlCiAgfSk7CiAgbGV0IG5nSW5qZWN0b3JEZWYgPSBudWxsOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGVUeXBlLCBOR19JTkpfREVGLCB7CiAgICBnZXQ6ICgpID0+IHsKICAgICAgaWYgKG5nSW5qZWN0b3JEZWYgPT09IG51bGwpIHsKICAgICAgICBuZ0Rldk1vZGUgJiYgdmVyaWZ5U2VtYW50aWNzT2ZOZ01vZHVsZURlZihtb2R1bGVUeXBlLCBhbGxvd0R1cGxpY2F0ZURlY2xhcmF0aW9uc0luUm9vdCk7CiAgICAgICAgY29uc3QgbWV0YSA9IHsKICAgICAgICAgIG5hbWU6IG1vZHVsZVR5cGUubmFtZSwKICAgICAgICAgIHR5cGU6IG1vZHVsZVR5cGUsCiAgICAgICAgICBwcm92aWRlcnM6IG5nTW9kdWxlLnByb3ZpZGVycyB8fCBFTVBUWV9BUlJBWSwKICAgICAgICAgIGltcG9ydHM6IFsobmdNb2R1bGUuaW1wb3J0cyB8fCBFTVBUWV9BUlJBWSkubWFwKHJlc29sdmVGb3J3YXJkUmVmKSwgKG5nTW9kdWxlLmV4cG9ydHMgfHwgRU1QVFlfQVJSQVkpLm1hcChyZXNvbHZlRm9yd2FyZFJlZildCiAgICAgICAgfTsKICAgICAgICBjb25zdCBjb21waWxlciA9IGdldENvbXBpbGVyRmFjYWRlKHsKICAgICAgICAgIHVzYWdlOiAwLAogICAgICAgICAga2luZDogIk5nTW9kdWxlIiwKICAgICAgICAgIHR5cGU6IG1vZHVsZVR5cGUKICAgICAgICB9KTsKICAgICAgICBuZ0luamVjdG9yRGVmID0gY29tcGlsZXIuY29tcGlsZUluamVjdG9yKGFuZ3VsYXJDb3JlRW52LCBgbmc6Ly8vJHttb2R1bGVUeXBlLm5hbWV9L8m1aW5qLmpzYCwgbWV0YSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5nSW5qZWN0b3JEZWY7CiAgICB9LAogICAgY29uZmlndXJhYmxlOiAhIW5nRGV2TW9kZQogIH0pOwp9CmZ1bmN0aW9uIGdlbmVyYXRlU3RhbmRhbG9uZUluRGVjbGFyYXRpb25zRXJyb3IodHlwZSwgbG9jYXRpb24yKSB7CiAgY29uc3QgcHJlZml4ID0gYFVuZXhwZWN0ZWQgIiR7c3RyaW5naWZ5Rm9yRXJyb3IodHlwZSl9IiBmb3VuZCBpbiB0aGUgImRlY2xhcmF0aW9ucyIgYXJyYXkgb2YgdGhlYDsKICBjb25zdCBzdWZmaXggPSBgIiR7c3RyaW5naWZ5Rm9yRXJyb3IodHlwZSl9IiBpcyBtYXJrZWQgYXMgc3RhbmRhbG9uZSBhbmQgY2FuJ3QgYmUgZGVjbGFyZWQgaW4gYW55IE5nTW9kdWxlIC0gZGlkIHlvdSBpbnRlbmQgdG8gaW1wb3J0IGl0IGluc3RlYWQgKGJ5IGFkZGluZyBpdCB0byB0aGUgImltcG9ydHMiIGFycmF5KT9gOwogIHJldHVybiBgJHtwcmVmaXh9ICR7bG9jYXRpb24yfSwgJHtzdWZmaXh9YDsKfQpmdW5jdGlvbiB2ZXJpZnlTZW1hbnRpY3NPZk5nTW9kdWxlRGVmKG1vZHVsZVR5cGUsIGFsbG93RHVwbGljYXRlRGVjbGFyYXRpb25zSW5Sb290LCBpbXBvcnRpbmdNb2R1bGUpIHsKICBpZiAodmVyaWZpZWROZ01vZHVsZS5nZXQobW9kdWxlVHlwZSkpIHJldHVybjsKICBpZiAoaXNTdGFuZGFsb25lKG1vZHVsZVR5cGUpKSByZXR1cm47CiAgdmVyaWZpZWROZ01vZHVsZS5zZXQobW9kdWxlVHlwZSwgdHJ1ZSk7CiAgbW9kdWxlVHlwZSA9IHJlc29sdmVGb3J3YXJkUmVmKG1vZHVsZVR5cGUpOwogIGxldCBuZ01vZHVsZURlZjsKICBpZiAoaW1wb3J0aW5nTW9kdWxlKSB7CiAgICBuZ01vZHVsZURlZiA9IGdldE5nTW9kdWxlRGVmKG1vZHVsZVR5cGUpOwogICAgaWYgKCFuZ01vZHVsZURlZikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgdmFsdWUgJyR7bW9kdWxlVHlwZS5uYW1lfScgaW1wb3J0ZWQgYnkgdGhlIG1vZHVsZSAnJHtpbXBvcnRpbmdNb2R1bGUubmFtZX0nLiBQbGVhc2UgYWRkIGFuIEBOZ01vZHVsZSBhbm5vdGF0aW9uLmApOwogICAgfQogIH0gZWxzZSB7CiAgICBuZ01vZHVsZURlZiA9IGdldE5nTW9kdWxlRGVmT3JUaHJvdyhtb2R1bGVUeXBlKTsKICB9CiAgY29uc3QgZXJyb3JzID0gW107CiAgY29uc3QgZGVjbGFyYXRpb25zID0gbWF5YmVVbndyYXBGbihuZ01vZHVsZURlZi5kZWNsYXJhdGlvbnMpOwogIGNvbnN0IGltcG9ydHMgPSBtYXliZVVud3JhcEZuKG5nTW9kdWxlRGVmLmltcG9ydHMpOwogIGZsYXR0ZW4oaW1wb3J0cykubWFwKHVud3JhcE1vZHVsZVdpdGhQcm92aWRlcnNJbXBvcnRzKS5mb3JFYWNoKChtb2RPclN0YW5kYWxvbmVDbXB0KSA9PiB7CiAgICB2ZXJpZnlTZW1hbnRpY3NPZk5nTW9kdWxlSW1wb3J0KG1vZE9yU3RhbmRhbG9uZUNtcHQsIG1vZHVsZVR5cGUpOwogICAgdmVyaWZ5U2VtYW50aWNzT2ZOZ01vZHVsZURlZihtb2RPclN0YW5kYWxvbmVDbXB0LCBmYWxzZSwgbW9kdWxlVHlwZSk7CiAgfSk7CiAgY29uc3QgZXhwb3J0cyA9IG1heWJlVW53cmFwRm4obmdNb2R1bGVEZWYuZXhwb3J0cyk7CiAgZGVjbGFyYXRpb25zLmZvckVhY2godmVyaWZ5RGVjbGFyYXRpb25zSGF2ZURlZmluaXRpb25zKTsKICBkZWNsYXJhdGlvbnMuZm9yRWFjaCh2ZXJpZnlEaXJlY3RpdmVzSGF2ZVNlbGVjdG9yKTsKICBkZWNsYXJhdGlvbnMuZm9yRWFjaCgoZGVjbGFyYXRpb25UeXBlKSA9PiB2ZXJpZnlOb3RTdGFuZGFsb25lKGRlY2xhcmF0aW9uVHlwZSwgbW9kdWxlVHlwZSkpOwogIGNvbnN0IGNvbWJpbmVkRGVjbGFyYXRpb25zID0gWy4uLmRlY2xhcmF0aW9ucy5tYXAocmVzb2x2ZUZvcndhcmRSZWYpLCAuLi5mbGF0dGVuKGltcG9ydHMubWFwKGNvbXB1dGVDb21iaW5lZEV4cG9ydHMpKS5tYXAocmVzb2x2ZUZvcndhcmRSZWYpXTsKICBleHBvcnRzLmZvckVhY2godmVyaWZ5RXhwb3J0c0FyZURlY2xhcmVkT3JSZUV4cG9ydGVkKTsKICBkZWNsYXJhdGlvbnMuZm9yRWFjaCgoZGVjbCkgPT4gdmVyaWZ5RGVjbGFyYXRpb25Jc1VuaXF1ZShkZWNsLCBhbGxvd0R1cGxpY2F0ZURlY2xhcmF0aW9uc0luUm9vdCkpOwogIGNvbnN0IG5nTW9kdWxlID0gZ2V0QW5ub3RhdGlvbihtb2R1bGVUeXBlLCAiTmdNb2R1bGUiKTsKICBpZiAobmdNb2R1bGUpIHsKICAgIG5nTW9kdWxlLmltcG9ydHMgJiYgZmxhdHRlbihuZ01vZHVsZS5pbXBvcnRzKS5tYXAodW53cmFwTW9kdWxlV2l0aFByb3ZpZGVyc0ltcG9ydHMpLmZvckVhY2goKG1vZCkgPT4gewogICAgICB2ZXJpZnlTZW1hbnRpY3NPZk5nTW9kdWxlSW1wb3J0KG1vZCwgbW9kdWxlVHlwZSk7CiAgICAgIHZlcmlmeVNlbWFudGljc09mTmdNb2R1bGVEZWYobW9kLCBmYWxzZSwgbW9kdWxlVHlwZSk7CiAgICB9KTsKICAgIG5nTW9kdWxlLmJvb3RzdHJhcCAmJiBkZWVwRm9yRWFjaChuZ01vZHVsZS5ib290c3RyYXAsIHZlcmlmeUNvcnJlY3RCb290c3RyYXBUeXBlKTsKICAgIG5nTW9kdWxlLmJvb3RzdHJhcCAmJiBkZWVwRm9yRWFjaChuZ01vZHVsZS5ib290c3RyYXAsIHZlcmlmeUNvbXBvbmVudElzUGFydE9mTmdNb2R1bGUpOwogIH0KICBpZiAoZXJyb3JzLmxlbmd0aCkgewogICAgdGhyb3cgbmV3IEVycm9yKGVycm9ycy5qb2luKCJcbiIpKTsKICB9CiAgZnVuY3Rpb24gdmVyaWZ5RGVjbGFyYXRpb25zSGF2ZURlZmluaXRpb25zKHR5cGUpIHsKICAgIHR5cGUgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlKTsKICAgIGNvbnN0IGRlZiA9IGdldENvbXBvbmVudERlZih0eXBlKSB8fCBnZXREaXJlY3RpdmVEZWYodHlwZSkgfHwgZ2V0UGlwZURlZih0eXBlKTsKICAgIGlmICghZGVmKSB7CiAgICAgIGVycm9ycy5wdXNoKGBVbmV4cGVjdGVkIHZhbHVlICcke3N0cmluZ2lmeUZvckVycm9yKHR5cGUpfScgZGVjbGFyZWQgYnkgdGhlIG1vZHVsZSAnJHtzdHJpbmdpZnlGb3JFcnJvcihtb2R1bGVUeXBlKX0nLiBQbGVhc2UgYWRkIGEgQFBpcGUvQERpcmVjdGl2ZS9AQ29tcG9uZW50IGFubm90YXRpb24uYCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHZlcmlmeURpcmVjdGl2ZXNIYXZlU2VsZWN0b3IodHlwZSkgewogICAgdHlwZSA9IHJlc29sdmVGb3J3YXJkUmVmKHR5cGUpOwogICAgY29uc3QgZGVmID0gZ2V0RGlyZWN0aXZlRGVmKHR5cGUpOwogICAgaWYgKCFnZXRDb21wb25lbnREZWYodHlwZSkgJiYgZGVmICYmIGRlZi5zZWxlY3RvcnMubGVuZ3RoID09IDApIHsKICAgICAgZXJyb3JzLnB1c2goYERpcmVjdGl2ZSAke3N0cmluZ2lmeUZvckVycm9yKHR5cGUpfSBoYXMgbm8gc2VsZWN0b3IsIHBsZWFzZSBhZGQgaXQhYCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHZlcmlmeU5vdFN0YW5kYWxvbmUodHlwZSwgbW9kdWxlVHlwZTIpIHsKICAgIHR5cGUgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlKTsKICAgIGNvbnN0IGRlZiA9IGdldENvbXBvbmVudERlZih0eXBlKSB8fCBnZXREaXJlY3RpdmVEZWYodHlwZSkgfHwgZ2V0UGlwZURlZih0eXBlKTsKICAgIGlmIChkZWY/LnN0YW5kYWxvbmUpIHsKICAgICAgY29uc3QgbG9jYXRpb24yID0gYCIke3N0cmluZ2lmeUZvckVycm9yKG1vZHVsZVR5cGUyKX0iIE5nTW9kdWxlYDsKICAgICAgZXJyb3JzLnB1c2goZ2VuZXJhdGVTdGFuZGFsb25lSW5EZWNsYXJhdGlvbnNFcnJvcih0eXBlLCBsb2NhdGlvbjIpKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gdmVyaWZ5RXhwb3J0c0FyZURlY2xhcmVkT3JSZUV4cG9ydGVkKHR5cGUpIHsKICAgIHR5cGUgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlKTsKICAgIGNvbnN0IGtpbmQgPSBnZXRDb21wb25lbnREZWYodHlwZSkgJiYgImNvbXBvbmVudCIgfHwgZ2V0RGlyZWN0aXZlRGVmKHR5cGUpICYmICJkaXJlY3RpdmUiIHx8IGdldFBpcGVEZWYodHlwZSkgJiYgInBpcGUiOwogICAgaWYgKGtpbmQpIHsKICAgICAgaWYgKGNvbWJpbmVkRGVjbGFyYXRpb25zLmxhc3RJbmRleE9mKHR5cGUpID09PSAtMSkgewogICAgICAgIGVycm9ycy5wdXNoKGBDYW4ndCBleHBvcnQgJHtraW5kfSAke3N0cmluZ2lmeUZvckVycm9yKHR5cGUpfSBmcm9tICR7c3RyaW5naWZ5Rm9yRXJyb3IobW9kdWxlVHlwZSl9IGFzIGl0IHdhcyBuZWl0aGVyIGRlY2xhcmVkIG5vciBpbXBvcnRlZCFgKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiB2ZXJpZnlEZWNsYXJhdGlvbklzVW5pcXVlKHR5cGUsIHN1cHByZXNzRXJyb3JzKSB7CiAgICB0eXBlID0gcmVzb2x2ZUZvcndhcmRSZWYodHlwZSk7CiAgICBjb25zdCBleGlzdGluZ01vZHVsZSA9IG93bmVyTmdNb2R1bGUuZ2V0KHR5cGUpOwogICAgaWYgKGV4aXN0aW5nTW9kdWxlICYmIGV4aXN0aW5nTW9kdWxlICE9PSBtb2R1bGVUeXBlKSB7CiAgICAgIGlmICghc3VwcHJlc3NFcnJvcnMpIHsKICAgICAgICBjb25zdCBtb2R1bGVzMiA9IFtleGlzdGluZ01vZHVsZSwgbW9kdWxlVHlwZV0ubWFwKHN0cmluZ2lmeUZvckVycm9yKS5zb3J0KCk7CiAgICAgICAgZXJyb3JzLnB1c2goYFR5cGUgJHtzdHJpbmdpZnlGb3JFcnJvcih0eXBlKX0gaXMgcGFydCBvZiB0aGUgZGVjbGFyYXRpb25zIG9mIDIgbW9kdWxlczogJHttb2R1bGVzMlswXX0gYW5kICR7bW9kdWxlczJbMV19ISBQbGVhc2UgY29uc2lkZXIgbW92aW5nICR7c3RyaW5naWZ5Rm9yRXJyb3IodHlwZSl9IHRvIGEgaGlnaGVyIG1vZHVsZSB0aGF0IGltcG9ydHMgJHttb2R1bGVzMlswXX0gYW5kICR7bW9kdWxlczJbMV19LiBZb3UgY2FuIGFsc28gY3JlYXRlIGEgbmV3IE5nTW9kdWxlIHRoYXQgZXhwb3J0cyBhbmQgaW5jbHVkZXMgJHtzdHJpbmdpZnlGb3JFcnJvcih0eXBlKX0gdGhlbiBpbXBvcnQgdGhhdCBOZ01vZHVsZSBpbiAke21vZHVsZXMyWzBdfSBhbmQgJHttb2R1bGVzMlsxXX0uYCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIG93bmVyTmdNb2R1bGUuc2V0KHR5cGUsIG1vZHVsZVR5cGUpOwogICAgfQogIH0KICBmdW5jdGlvbiB2ZXJpZnlDb21wb25lbnRJc1BhcnRPZk5nTW9kdWxlKHR5cGUpIHsKICAgIHR5cGUgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlKTsKICAgIGNvbnN0IGV4aXN0aW5nTW9kdWxlID0gb3duZXJOZ01vZHVsZS5nZXQodHlwZSk7CiAgICBpZiAoIWV4aXN0aW5nTW9kdWxlICYmICFpc1N0YW5kYWxvbmUodHlwZSkpIHsKICAgICAgZXJyb3JzLnB1c2goYENvbXBvbmVudCAke3N0cmluZ2lmeUZvckVycm9yKHR5cGUpfSBpcyBub3QgcGFydCBvZiBhbnkgTmdNb2R1bGUgb3IgdGhlIG1vZHVsZSBoYXMgbm90IGJlZW4gaW1wb3J0ZWQgaW50byB5b3VyIG1vZHVsZS5gKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gdmVyaWZ5Q29ycmVjdEJvb3RzdHJhcFR5cGUodHlwZSkgewogICAgdHlwZSA9IHJlc29sdmVGb3J3YXJkUmVmKHR5cGUpOwogICAgaWYgKCFnZXRDb21wb25lbnREZWYodHlwZSkpIHsKICAgICAgZXJyb3JzLnB1c2goYCR7c3RyaW5naWZ5Rm9yRXJyb3IodHlwZSl9IGNhbm5vdCBiZSB1c2VkIGFzIGFuIGVudHJ5IGNvbXBvbmVudC5gKTsKICAgIH0KICAgIGlmIChpc1N0YW5kYWxvbmUodHlwZSkpIHsKICAgICAgZXJyb3JzLnB1c2goYFRoZSBcYCR7c3RyaW5naWZ5Rm9yRXJyb3IodHlwZSl9XGAgY2xhc3MgaXMgYSBzdGFuZGFsb25lIGNvbXBvbmVudCwgd2hpY2ggY2FuIG5vdCBiZSB1c2VkIGluIHRoZSBcYEBOZ01vZHVsZS5ib290c3RyYXBcYCBhcnJheS4gVXNlIHRoZSBcYGJvb3RzdHJhcEFwcGxpY2F0aW9uXGAgZnVuY3Rpb24gZm9yIGJvb3RzdHJhcCBpbnN0ZWFkLmApOwogICAgfQogIH0KICBmdW5jdGlvbiB2ZXJpZnlTZW1hbnRpY3NPZk5nTW9kdWxlSW1wb3J0KHR5cGUsIGltcG9ydGluZ01vZHVsZTIpIHsKICAgIHR5cGUgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlKTsKICAgIGNvbnN0IGRpcmVjdGl2ZURlZiA9IGdldENvbXBvbmVudERlZih0eXBlKSB8fCBnZXREaXJlY3RpdmVEZWYodHlwZSk7CiAgICBpZiAoZGlyZWN0aXZlRGVmICE9PSBudWxsICYmICFkaXJlY3RpdmVEZWYuc3RhbmRhbG9uZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgZGlyZWN0aXZlICcke3R5cGUubmFtZX0nIGltcG9ydGVkIGJ5IHRoZSBtb2R1bGUgJyR7aW1wb3J0aW5nTW9kdWxlMi5uYW1lfScuIFBsZWFzZSBhZGQgYW4gQE5nTW9kdWxlIGFubm90YXRpb24uYCk7CiAgICB9CiAgICBjb25zdCBwaXBlRGVmID0gZ2V0UGlwZURlZih0eXBlKTsKICAgIGlmIChwaXBlRGVmICE9PSBudWxsICYmICFwaXBlRGVmLnN0YW5kYWxvbmUpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHBpcGUgJyR7dHlwZS5uYW1lfScgaW1wb3J0ZWQgYnkgdGhlIG1vZHVsZSAnJHtpbXBvcnRpbmdNb2R1bGUyLm5hbWV9Jy4gUGxlYXNlIGFkZCBhbiBATmdNb2R1bGUgYW5ub3RhdGlvbi5gKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gdW53cmFwTW9kdWxlV2l0aFByb3ZpZGVyc0ltcG9ydHModHlwZU9yV2l0aFByb3ZpZGVycykgewogIHR5cGVPcldpdGhQcm92aWRlcnMgPSByZXNvbHZlRm9yd2FyZFJlZih0eXBlT3JXaXRoUHJvdmlkZXJzKTsKICByZXR1cm4gdHlwZU9yV2l0aFByb3ZpZGVycy5uZ01vZHVsZSB8fCB0eXBlT3JXaXRoUHJvdmlkZXJzOwp9CmZ1bmN0aW9uIGdldEFubm90YXRpb24odHlwZSwgbmFtZSkgewogIGxldCBhbm5vdGF0aW9uID0gbnVsbDsKICBjb2xsZWN0KHR5cGUuX19hbm5vdGF0aW9uc19fKTsKICBjb2xsZWN0KHR5cGUuZGVjb3JhdG9ycyk7CiAgcmV0dXJuIGFubm90YXRpb247CiAgZnVuY3Rpb24gY29sbGVjdChhbm5vdGF0aW9ucykgewogICAgaWYgKGFubm90YXRpb25zKSB7CiAgICAgIGFubm90YXRpb25zLmZvckVhY2gocmVhZEFubm90YXRpb24pOwogICAgfQogIH0KICBmdW5jdGlvbiByZWFkQW5ub3RhdGlvbihkZWNvcmF0b3IpIHsKICAgIGlmICghYW5ub3RhdGlvbikgewogICAgICBjb25zdCBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihkZWNvcmF0b3IpOwogICAgICBpZiAocHJvdG8ubmdNZXRhZGF0YU5hbWUgPT0gbmFtZSkgewogICAgICAgIGFubm90YXRpb24gPSBkZWNvcmF0b3I7CiAgICAgIH0gZWxzZSBpZiAoZGVjb3JhdG9yLnR5cGUpIHsKICAgICAgICBjb25zdCBwcm90bzIgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoZGVjb3JhdG9yLnR5cGUpOwogICAgICAgIGlmIChwcm90bzIubmdNZXRhZGF0YU5hbWUgPT0gbmFtZSkgewogICAgICAgICAgYW5ub3RhdGlvbiA9IGRlY29yYXRvci5hcmdzWzBdOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQp2YXIgb3duZXJOZ01vZHVsZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwp2YXIgdmVyaWZpZWROZ01vZHVsZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwpmdW5jdGlvbiByZXNldENvbXBpbGVkQ29tcG9uZW50cygpIHsKICBvd25lck5nTW9kdWxlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgdmVyaWZpZWROZ01vZHVsZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIG1vZHVsZVF1ZXVlLmxlbmd0aCA9IDA7CiAgR0VORVJBVEVEX0NPTVBfSURTLmNsZWFyKCk7Cn0KZnVuY3Rpb24gY29tcHV0ZUNvbWJpbmVkRXhwb3J0cyh0eXBlKSB7CiAgdHlwZSA9IHJlc29sdmVGb3J3YXJkUmVmKHR5cGUpOwogIGNvbnN0IG5nTW9kdWxlRGVmID0gZ2V0TmdNb2R1bGVEZWYodHlwZSk7CiAgaWYgKG5nTW9kdWxlRGVmID09PSBudWxsKSB7CiAgICByZXR1cm4gW3R5cGVdOwogIH0KICByZXR1cm4gZmxhdHRlbihtYXliZVVud3JhcEZuKG5nTW9kdWxlRGVmLmV4cG9ydHMpLm1hcCgodHlwZTIpID0+IHsKICAgIGNvbnN0IG5nTW9kdWxlRGVmMiA9IGdldE5nTW9kdWxlRGVmKHR5cGUyKTsKICAgIGlmIChuZ01vZHVsZURlZjIpIHsKICAgICAgdmVyaWZ5U2VtYW50aWNzT2ZOZ01vZHVsZURlZih0eXBlMiwgZmFsc2UpOwogICAgICByZXR1cm4gY29tcHV0ZUNvbWJpbmVkRXhwb3J0cyh0eXBlMik7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdHlwZTI7CiAgICB9CiAgfSkpOwp9CmZ1bmN0aW9uIHNldFNjb3BlT25EZWNsYXJlZENvbXBvbmVudHMobW9kdWxlVHlwZSwgbmdNb2R1bGUpIHsKICBjb25zdCBkZWNsYXJhdGlvbnMgPSBmbGF0dGVuKG5nTW9kdWxlLmRlY2xhcmF0aW9ucyB8fCBFTVBUWV9BUlJBWSk7CiAgY29uc3QgdHJhbnNpdGl2ZVNjb3BlcyA9IHRyYW5zaXRpdmVTY29wZXNGb3IobW9kdWxlVHlwZSk7CiAgZGVjbGFyYXRpb25zLmZvckVhY2goKGRlY2xhcmF0aW9uKSA9PiB7CiAgICBkZWNsYXJhdGlvbiA9IHJlc29sdmVGb3J3YXJkUmVmKGRlY2xhcmF0aW9uKTsKICAgIGlmIChkZWNsYXJhdGlvbi5oYXNPd25Qcm9wZXJ0eShOR19DT01QX0RFRikpIHsKICAgICAgY29uc3QgY29tcG9uZW50ID0gZGVjbGFyYXRpb247CiAgICAgIGNvbnN0IGNvbXBvbmVudERlZiA9IGdldENvbXBvbmVudERlZihjb21wb25lbnQpOwogICAgICBwYXRjaENvbXBvbmVudERlZldpdGhTY29wZShjb21wb25lbnREZWYsIHRyYW5zaXRpdmVTY29wZXMpOwogICAgfSBlbHNlIGlmICghZGVjbGFyYXRpb24uaGFzT3duUHJvcGVydHkoTkdfRElSX0RFRikgJiYgIWRlY2xhcmF0aW9uLmhhc093blByb3BlcnR5KE5HX1BJUEVfREVGKSkgewogICAgICBkZWNsYXJhdGlvbi5uZ1NlbGVjdG9yU2NvcGUgPSBtb2R1bGVUeXBlOwogICAgfQogIH0pOwp9CmZ1bmN0aW9uIHBhdGNoQ29tcG9uZW50RGVmV2l0aFNjb3BlKGNvbXBvbmVudERlZiwgdHJhbnNpdGl2ZVNjb3BlcykgewogIGNvbXBvbmVudERlZi5kaXJlY3RpdmVEZWZzID0gKCkgPT4gQXJyYXkuZnJvbSh0cmFuc2l0aXZlU2NvcGVzLmNvbXBpbGF0aW9uLmRpcmVjdGl2ZXMpLm1hcCgoZGlyKSA9PiBkaXIuaGFzT3duUHJvcGVydHkoTkdfQ09NUF9ERUYpID8gZ2V0Q29tcG9uZW50RGVmKGRpcikgOiBnZXREaXJlY3RpdmVEZWYoZGlyKSkuZmlsdGVyKChkZWYpID0+ICEhZGVmKTsKICBjb21wb25lbnREZWYucGlwZURlZnMgPSAoKSA9PiBBcnJheS5mcm9tKHRyYW5zaXRpdmVTY29wZXMuY29tcGlsYXRpb24ucGlwZXMpLm1hcCgocGlwZTIpID0+IGdldFBpcGVEZWYocGlwZTIpKTsKICBjb21wb25lbnREZWYuc2NoZW1hcyA9IHRyYW5zaXRpdmVTY29wZXMuc2NoZW1hczsKICBjb21wb25lbnREZWYudFZpZXcgPSBudWxsOwp9CmZ1bmN0aW9uIHRyYW5zaXRpdmVTY29wZXNGb3IodHlwZSkgewogIGlmIChpc05nTW9kdWxlKHR5cGUpKSB7CiAgICBjb25zdCBzY29wZSA9IGRlcHNUcmFja2VyLmdldE5nTW9kdWxlU2NvcGUodHlwZSk7CiAgICBjb25zdCBkZWYgPSBnZXROZ01vZHVsZURlZk9yVGhyb3codHlwZSk7CiAgICByZXR1cm4gX19zcHJlYWRWYWx1ZXMoewogICAgICBzY2hlbWFzOiBkZWYuc2NoZW1hcyB8fCBudWxsCiAgICB9LCBzY29wZSk7CiAgfSBlbHNlIGlmIChpc1N0YW5kYWxvbmUodHlwZSkpIHsKICAgIGNvbnN0IGRpcmVjdGl2ZURlZiA9IGdldENvbXBvbmVudERlZih0eXBlKSB8fCBnZXREaXJlY3RpdmVEZWYodHlwZSk7CiAgICBpZiAoZGlyZWN0aXZlRGVmICE9PSBudWxsKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc2NoZW1hczogbnVsbCwKICAgICAgICBjb21waWxhdGlvbjogewogICAgICAgICAgZGlyZWN0aXZlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSwKICAgICAgICAgIHBpcGVzOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpCiAgICAgICAgfSwKICAgICAgICBleHBvcnRlZDogewogICAgICAgICAgZGlyZWN0aXZlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW3R5cGVdKSwKICAgICAgICAgIHBpcGVzOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpCiAgICAgICAgfQogICAgICB9OwogICAgfQogICAgY29uc3QgcGlwZURlZiA9IGdldFBpcGVEZWYodHlwZSk7CiAgICBpZiAocGlwZURlZiAhPT0gbnVsbCkgewogICAgICByZXR1cm4gewogICAgICAgIHNjaGVtYXM6IG51bGwsCiAgICAgICAgY29tcGlsYXRpb246IHsKICAgICAgICAgIGRpcmVjdGl2ZXM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksCiAgICAgICAgICBwaXBlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKQogICAgICAgIH0sCiAgICAgICAgZXhwb3J0ZWQ6IHsKICAgICAgICAgIGRpcmVjdGl2ZXM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksCiAgICAgICAgICBwaXBlczogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW3R5cGVdKQogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9CiAgdGhyb3cgbmV3IEVycm9yKGAke3R5cGUubmFtZX0gZG9lcyBub3QgaGF2ZSBhIG1vZHVsZSBkZWYgKMm1bW9kIHByb3BlcnR5KWApOwp9CmZ1bmN0aW9uIGV4cGFuZE1vZHVsZVdpdGhQcm92aWRlcnModmFsdWUpIHsKICBpZiAoaXNNb2R1bGVXaXRoUHJvdmlkZXJzKHZhbHVlKSkgewogICAgcmV0dXJuIHZhbHVlLm5nTW9kdWxlOwogIH0KICByZXR1cm4gdmFsdWU7Cn0KdmFyIGNvbXBpbGF0aW9uRGVwdGggPSAwOwpmdW5jdGlvbiBjb21waWxlQ29tcG9uZW50KHR5cGUsIG1ldGFkYXRhKSB7CiAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgaW5pdE5nRGV2TW9kZSgpOwogIGxldCBuZ0NvbXBvbmVudERlZiA9IG51bGw7CiAgbWF5YmVRdWV1ZVJlc29sdXRpb25PZkNvbXBvbmVudFJlc291cmNlcyh0eXBlLCBtZXRhZGF0YSk7CiAgYWRkRGlyZWN0aXZlRmFjdG9yeURlZih0eXBlLCBtZXRhZGF0YSk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHR5cGUsIE5HX0NPTVBfREVGLCB7CiAgICBnZXQ6ICgpID0+IHsKICAgICAgaWYgKG5nQ29tcG9uZW50RGVmID09PSBudWxsKSB7CiAgICAgICAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICAgICAgICB1c2FnZTogMCwKICAgICAgICAgIGtpbmQ6ICJjb21wb25lbnQiLAogICAgICAgICAgdHlwZQogICAgICAgIH0pOwogICAgICAgIGlmIChjb21wb25lbnROZWVkc1Jlc29sdXRpb24obWV0YWRhdGEpKSB7CiAgICAgICAgICBjb25zdCBlcnJvciA9IFtgQ29tcG9uZW50ICcke3R5cGUubmFtZX0nIGlzIG5vdCByZXNvbHZlZDpgXTsKICAgICAgICAgIGlmIChtZXRhZGF0YS50ZW1wbGF0ZVVybCkgewogICAgICAgICAgICBlcnJvci5wdXNoKGAgLSB0ZW1wbGF0ZVVybDogJHttZXRhZGF0YS50ZW1wbGF0ZVVybH1gKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZXRhZGF0YS5zdHlsZVVybHMgJiYgbWV0YWRhdGEuc3R5bGVVcmxzLmxlbmd0aCkgewogICAgICAgICAgICBlcnJvci5wdXNoKGAgLSBzdHlsZVVybHM6ICR7SlNPTi5zdHJpbmdpZnkobWV0YWRhdGEuc3R5bGVVcmxzKX1gKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZXRhZGF0YS5zdHlsZVVybCkgewogICAgICAgICAgICBlcnJvci5wdXNoKGAgLSBzdHlsZVVybDogJHttZXRhZGF0YS5zdHlsZVVybH1gKTsKICAgICAgICAgIH0KICAgICAgICAgIGVycm9yLnB1c2goYERpZCB5b3UgcnVuIGFuZCB3YWl0IGZvciAncmVzb2x2ZUNvbXBvbmVudFJlc291cmNlcygpJz9gKTsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvci5qb2luKCJcbiIpKTsKICAgICAgICB9CiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGdldEppdE9wdGlvbnMoKTsKICAgICAgICBsZXQgcHJlc2VydmVXaGl0ZXNwYWNlcyA9IG1ldGFkYXRhLnByZXNlcnZlV2hpdGVzcGFjZXM7CiAgICAgICAgaWYgKHByZXNlcnZlV2hpdGVzcGFjZXMgPT09IHZvaWQgMCkgewogICAgICAgICAgaWYgKG9wdGlvbnMgIT09IG51bGwgJiYgb3B0aW9ucy5wcmVzZXJ2ZVdoaXRlc3BhY2VzICE9PSB2b2lkIDApIHsKICAgICAgICAgICAgcHJlc2VydmVXaGl0ZXNwYWNlcyA9IG9wdGlvbnMucHJlc2VydmVXaGl0ZXNwYWNlczsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByZXNlcnZlV2hpdGVzcGFjZXMgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbGV0IGVuY2Fwc3VsYXRpb24gPSBtZXRhZGF0YS5lbmNhcHN1bGF0aW9uOwogICAgICAgIGlmIChlbmNhcHN1bGF0aW9uID09PSB2b2lkIDApIHsKICAgICAgICAgIGlmIChvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMuZGVmYXVsdEVuY2Fwc3VsYXRpb24gIT09IHZvaWQgMCkgewogICAgICAgICAgICBlbmNhcHN1bGF0aW9uID0gb3B0aW9ucy5kZWZhdWx0RW5jYXBzdWxhdGlvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuY2Fwc3VsYXRpb24gPSBWaWV3RW5jYXBzdWxhdGlvbi5FbXVsYXRlZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29uc3QgdGVtcGxhdGVVcmwgPSBtZXRhZGF0YS50ZW1wbGF0ZVVybCB8fCBgbmc6Ly8vJHt0eXBlLm5hbWV9L3RlbXBsYXRlLmh0bWxgOwogICAgICAgIGNvbnN0IGJhc2VNZXRhID0gZGlyZWN0aXZlTWV0YWRhdGEodHlwZSwgbWV0YWRhdGEpOwogICAgICAgIGNvbnN0IG1ldGEgPSBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBiYXNlTWV0YSksIHsKICAgICAgICAgIHR5cGVTb3VyY2VTcGFuOiBjb21waWxlci5jcmVhdGVQYXJzZVNvdXJjZVNwYW4oIkNvbXBvbmVudCIsIHR5cGUubmFtZSwgdGVtcGxhdGVVcmwpLAogICAgICAgICAgdGVtcGxhdGU6IG1ldGFkYXRhLnRlbXBsYXRlIHx8ICIiLAogICAgICAgICAgcHJlc2VydmVXaGl0ZXNwYWNlcywKICAgICAgICAgIHN0eWxlczogdHlwZW9mIG1ldGFkYXRhLnN0eWxlcyA9PT0gInN0cmluZyIgPyBbbWV0YWRhdGEuc3R5bGVzXSA6IG1ldGFkYXRhLnN0eWxlcyB8fCBFTVBUWV9BUlJBWSwKICAgICAgICAgIGFuaW1hdGlvbnM6IG1ldGFkYXRhLmFuaW1hdGlvbnMsCiAgICAgICAgICBkZWNsYXJhdGlvbnM6IFtdLAogICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBtZXRhZGF0YS5jaGFuZ2VEZXRlY3Rpb24sCiAgICAgICAgICBlbmNhcHN1bGF0aW9uLAogICAgICAgICAgdmlld1Byb3ZpZGVyczogbWV0YWRhdGEudmlld1Byb3ZpZGVycyB8fCBudWxsLAogICAgICAgICAgaGFzRGlyZWN0aXZlRGVwZW5kZW5jaWVzOiAhYmFzZU1ldGEuaXNTdGFuZGFsb25lIHx8IG1ldGFkYXRhLmltcG9ydHMgIT0gbnVsbCAmJiBtZXRhZGF0YS5pbXBvcnRzLmxlbmd0aCA+IDAKICAgICAgICB9KTsKICAgICAgICBjb21waWxhdGlvbkRlcHRoKys7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmIChtZXRhLnVzZXNJbmhlcml0YW5jZSkgewogICAgICAgICAgICBhZGREaXJlY3RpdmVEZWZUb1VuZGVjb3JhdGVkUGFyZW50cyh0eXBlKTsKICAgICAgICAgIH0KICAgICAgICAgIG5nQ29tcG9uZW50RGVmID0gY29tcGlsZXIuY29tcGlsZUNvbXBvbmVudChhbmd1bGFyQ29yZUVudiwgdGVtcGxhdGVVcmwsIG1ldGEpOwogICAgICAgICAgaWYgKG1ldGEuaXNTdGFuZGFsb25lKSB7CiAgICAgICAgICAgIGNvbnN0IGltcG9ydHMgPSBmbGF0dGVuKG1ldGFkYXRhLmltcG9ydHMgfHwgRU1QVFlfQVJSQVkpOwogICAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgICAgZGlyZWN0aXZlRGVmcywKICAgICAgICAgICAgICBwaXBlRGVmcwogICAgICAgICAgICB9ID0gZ2V0U3RhbmRhbG9uZURlZkZ1bmN0aW9ucyh0eXBlLCBpbXBvcnRzKTsKICAgICAgICAgICAgbmdDb21wb25lbnREZWYuZGlyZWN0aXZlRGVmcyA9IGRpcmVjdGl2ZURlZnM7CiAgICAgICAgICAgIG5nQ29tcG9uZW50RGVmLnBpcGVEZWZzID0gcGlwZURlZnM7CiAgICAgICAgICAgIG5nQ29tcG9uZW50RGVmLmRlcGVuZGVuY2llcyA9ICgpID0+IGltcG9ydHMubWFwKHJlc29sdmVGb3J3YXJkUmVmKTsKICAgICAgICAgIH0KICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgY29tcGlsYXRpb25EZXB0aC0tOwogICAgICAgIH0KICAgICAgICBpZiAoY29tcGlsYXRpb25EZXB0aCA9PT0gMCkgewogICAgICAgICAgZmx1c2hNb2R1bGVTY29waW5nUXVldWVBc011Y2hBc1Bvc3NpYmxlKCk7CiAgICAgICAgfQogICAgICAgIGlmIChoYXNTZWxlY3RvclNjb3BlKHR5cGUpKSB7CiAgICAgICAgICBjb25zdCBzY29wZXMgPSB0cmFuc2l0aXZlU2NvcGVzRm9yKHR5cGUubmdTZWxlY3RvclNjb3BlKTsKICAgICAgICAgIHBhdGNoQ29tcG9uZW50RGVmV2l0aFNjb3BlKG5nQ29tcG9uZW50RGVmLCBzY29wZXMpOwogICAgICAgIH0KICAgICAgICBpZiAobWV0YWRhdGEuc2NoZW1hcykgewogICAgICAgICAgaWYgKG1ldGEuaXNTdGFuZGFsb25lKSB7CiAgICAgICAgICAgIG5nQ29tcG9uZW50RGVmLnNjaGVtYXMgPSBtZXRhZGF0YS5zY2hlbWFzOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJ3NjaGVtYXMnIHdhcyBzcGVjaWZpZWQgZm9yIHRoZSAke3N0cmluZ2lmeUZvckVycm9yKHR5cGUpfSBidXQgaXMgb25seSB2YWxpZCBvbiBhIGNvbXBvbmVudCB0aGF0IGlzIHN0YW5kYWxvbmUuYCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChtZXRhLmlzU3RhbmRhbG9uZSkgewogICAgICAgICAgbmdDb21wb25lbnREZWYuc2NoZW1hcyA9IFtdOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmdDb21wb25lbnREZWY7CiAgICB9LAogICAgc2V0OiAoZGVmKSA9PiB7CiAgICAgIG5nQ29tcG9uZW50RGVmID0gZGVmOwogICAgfSwKICAgIGNvbmZpZ3VyYWJsZTogISFuZ0Rldk1vZGUKICB9KTsKfQpmdW5jdGlvbiBnZXRTdGFuZGFsb25lRGVmRnVuY3Rpb25zKHR5cGUsIGltcG9ydHMpIHsKICBjb25zdCBkaXJlY3RpdmVEZWZzID0gKCkgPT4gewogICAgaWYgKG5nRGV2TW9kZSkgewogICAgICBmb3IgKGNvbnN0IHJhd0RlcCBvZiBpbXBvcnRzKSB7CiAgICAgICAgdmVyaWZ5U3RhbmRhbG9uZUltcG9ydChyYXdEZXAsIHR5cGUpOwogICAgICB9CiAgICB9CiAgICBpZiAoIWlzQ29tcG9uZW50KHR5cGUpKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIGNvbnN0IHNjb3BlID0gZGVwc1RyYWNrZXIuZ2V0U3RhbmRhbG9uZUNvbXBvbmVudFNjb3BlKHR5cGUsIGltcG9ydHMpOwogICAgcmV0dXJuIFsuLi5zY29wZS5jb21waWxhdGlvbi5kaXJlY3RpdmVzXS5tYXAoKHApID0+IGdldENvbXBvbmVudERlZihwKSB8fCBnZXREaXJlY3RpdmVEZWYocCkpLmZpbHRlcigoZCkgPT4gZCAhPT0gbnVsbCk7CiAgfTsKICBjb25zdCBwaXBlRGVmcyA9ICgpID0+IHsKICAgIGlmIChuZ0Rldk1vZGUpIHsKICAgICAgZm9yIChjb25zdCByYXdEZXAgb2YgaW1wb3J0cykgewogICAgICAgIHZlcmlmeVN0YW5kYWxvbmVJbXBvcnQocmF3RGVwLCB0eXBlKTsKICAgICAgfQogICAgfQogICAgaWYgKCFpc0NvbXBvbmVudCh0eXBlKSkgewogICAgICByZXR1cm4gW107CiAgICB9CiAgICBjb25zdCBzY29wZSA9IGRlcHNUcmFja2VyLmdldFN0YW5kYWxvbmVDb21wb25lbnRTY29wZSh0eXBlLCBpbXBvcnRzKTsKICAgIHJldHVybiBbLi4uc2NvcGUuY29tcGlsYXRpb24ucGlwZXNdLm1hcCgocCkgPT4gZ2V0UGlwZURlZihwKSkuZmlsdGVyKChkKSA9PiBkICE9PSBudWxsKTsKICB9OwogIHJldHVybiB7CiAgICBkaXJlY3RpdmVEZWZzLAogICAgcGlwZURlZnMKICB9Owp9CmZ1bmN0aW9uIGhhc1NlbGVjdG9yU2NvcGUoY29tcG9uZW50KSB7CiAgcmV0dXJuIGNvbXBvbmVudC5uZ1NlbGVjdG9yU2NvcGUgIT09IHZvaWQgMDsKfQpmdW5jdGlvbiBjb21waWxlRGlyZWN0aXZlKHR5cGUsIGRpcmVjdGl2ZSkgewogIGxldCBuZ0RpcmVjdGl2ZURlZiA9IG51bGw7CiAgYWRkRGlyZWN0aXZlRmFjdG9yeURlZih0eXBlLCBkaXJlY3RpdmUgfHwge30pOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0eXBlLCBOR19ESVJfREVGLCB7CiAgICBnZXQ6ICgpID0+IHsKICAgICAgaWYgKG5nRGlyZWN0aXZlRGVmID09PSBudWxsKSB7CiAgICAgICAgY29uc3QgbWV0YSA9IGdldERpcmVjdGl2ZU1ldGFkYXRhKHR5cGUsIGRpcmVjdGl2ZSB8fCB7fSk7CiAgICAgICAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICAgICAgICB1c2FnZTogMCwKICAgICAgICAgIGtpbmQ6ICJkaXJlY3RpdmUiLAogICAgICAgICAgdHlwZQogICAgICAgIH0pOwogICAgICAgIG5nRGlyZWN0aXZlRGVmID0gY29tcGlsZXIuY29tcGlsZURpcmVjdGl2ZShhbmd1bGFyQ29yZUVudiwgbWV0YS5zb3VyY2VNYXBVcmwsIG1ldGEubWV0YWRhdGEpOwogICAgICB9CiAgICAgIHJldHVybiBuZ0RpcmVjdGl2ZURlZjsKICAgIH0sCiAgICBjb25maWd1cmFibGU6ICEhbmdEZXZNb2RlCiAgfSk7Cn0KZnVuY3Rpb24gZ2V0RGlyZWN0aXZlTWV0YWRhdGEodHlwZSwgbWV0YWRhdGEpIHsKICBjb25zdCBuYW1lID0gdHlwZSAmJiB0eXBlLm5hbWU7CiAgY29uc3Qgc291cmNlTWFwVXJsID0gYG5nOi8vLyR7bmFtZX0vybVkaXIuanNgOwogIGNvbnN0IGNvbXBpbGVyID0gZ2V0Q29tcGlsZXJGYWNhZGUoewogICAgdXNhZ2U6IDAsCiAgICBraW5kOiAiZGlyZWN0aXZlIiwKICAgIHR5cGUKICB9KTsKICBjb25zdCBmYWNhZGUgPSBkaXJlY3RpdmVNZXRhZGF0YSh0eXBlLCBtZXRhZGF0YSk7CiAgZmFjYWRlLnR5cGVTb3VyY2VTcGFuID0gY29tcGlsZXIuY3JlYXRlUGFyc2VTb3VyY2VTcGFuKCJEaXJlY3RpdmUiLCBuYW1lLCBzb3VyY2VNYXBVcmwpOwogIGlmIChmYWNhZGUudXNlc0luaGVyaXRhbmNlKSB7CiAgICBhZGREaXJlY3RpdmVEZWZUb1VuZGVjb3JhdGVkUGFyZW50cyh0eXBlKTsKICB9CiAgcmV0dXJuIHsKICAgIG1ldGFkYXRhOiBmYWNhZGUsCiAgICBzb3VyY2VNYXBVcmwKICB9Owp9CmZ1bmN0aW9uIGFkZERpcmVjdGl2ZUZhY3RvcnlEZWYodHlwZSwgbWV0YWRhdGEpIHsKICBsZXQgbmdGYWN0b3J5RGVmID0gbnVsbDsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkodHlwZSwgTkdfRkFDVE9SWV9ERUYsIHsKICAgIGdldDogKCkgPT4gewogICAgICBpZiAobmdGYWN0b3J5RGVmID09PSBudWxsKSB7CiAgICAgICAgY29uc3QgbWV0YSA9IGdldERpcmVjdGl2ZU1ldGFkYXRhKHR5cGUsIG1ldGFkYXRhKTsKICAgICAgICBjb25zdCBjb21waWxlciA9IGdldENvbXBpbGVyRmFjYWRlKHsKICAgICAgICAgIHVzYWdlOiAwLAogICAgICAgICAga2luZDogImRpcmVjdGl2ZSIsCiAgICAgICAgICB0eXBlCiAgICAgICAgfSk7CiAgICAgICAgbmdGYWN0b3J5RGVmID0gY29tcGlsZXIuY29tcGlsZUZhY3RvcnkoYW5ndWxhckNvcmVFbnYsIGBuZzovLy8ke3R5cGUubmFtZX0vybVmYWMuanNgLCB7CiAgICAgICAgICBuYW1lOiBtZXRhLm1ldGFkYXRhLm5hbWUsCiAgICAgICAgICB0eXBlOiBtZXRhLm1ldGFkYXRhLnR5cGUsCiAgICAgICAgICB0eXBlQXJndW1lbnRDb3VudDogMCwKICAgICAgICAgIGRlcHM6IHJlZmxlY3REZXBlbmRlbmNpZXModHlwZSksCiAgICAgICAgICB0YXJnZXQ6IGNvbXBpbGVyLkZhY3RvcnlUYXJnZXQuRGlyZWN0aXZlCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5nRmFjdG9yeURlZjsKICAgIH0sCiAgICBjb25maWd1cmFibGU6ICEhbmdEZXZNb2RlCiAgfSk7Cn0KZnVuY3Rpb24gZXh0ZW5kc0RpcmVjdGx5RnJvbU9iamVjdCh0eXBlKSB7CiAgcmV0dXJuIE9iamVjdC5nZXRQcm90b3R5cGVPZih0eXBlLnByb3RvdHlwZSkgPT09IE9iamVjdC5wcm90b3R5cGU7Cn0KZnVuY3Rpb24gZGlyZWN0aXZlTWV0YWRhdGEodHlwZSwgbWV0YWRhdGEpIHsKICBjb25zdCByZWZsZWN0ID0gZ2V0UmVmbGVjdCgpOwogIGNvbnN0IHByb3BNZXRhZGF0YSA9IHJlZmxlY3Qub3duUHJvcE1ldGFkYXRhKHR5cGUpOwogIHJldHVybiB7CiAgICBuYW1lOiB0eXBlLm5hbWUsCiAgICB0eXBlLAogICAgc2VsZWN0b3I6IG1ldGFkYXRhLnNlbGVjdG9yICE9PSB2b2lkIDAgPyBtZXRhZGF0YS5zZWxlY3RvciA6IG51bGwsCiAgICBob3N0OiBtZXRhZGF0YS5ob3N0IHx8IEVNUFRZX09CSiwKICAgIHByb3BNZXRhZGF0YSwKICAgIGlucHV0czogbWV0YWRhdGEuaW5wdXRzIHx8IEVNUFRZX0FSUkFZLAogICAgb3V0cHV0czogbWV0YWRhdGEub3V0cHV0cyB8fCBFTVBUWV9BUlJBWSwKICAgIHF1ZXJpZXM6IGV4dHJhY3RRdWVyaWVzTWV0YWRhdGEodHlwZSwgcHJvcE1ldGFkYXRhLCBpc0NvbnRlbnRRdWVyeSksCiAgICBsaWZlY3ljbGU6IHsKICAgICAgdXNlc09uQ2hhbmdlczogcmVmbGVjdC5oYXNMaWZlY3ljbGVIb29rKHR5cGUsICJuZ09uQ2hhbmdlcyIpCiAgICB9LAogICAgdHlwZVNvdXJjZVNwYW46IG51bGwsCiAgICB1c2VzSW5oZXJpdGFuY2U6ICFleHRlbmRzRGlyZWN0bHlGcm9tT2JqZWN0KHR5cGUpLAogICAgZXhwb3J0QXM6IGV4dHJhY3RFeHBvcnRBcyhtZXRhZGF0YS5leHBvcnRBcyksCiAgICBwcm92aWRlcnM6IG1ldGFkYXRhLnByb3ZpZGVycyB8fCBudWxsLAogICAgdmlld1F1ZXJpZXM6IGV4dHJhY3RRdWVyaWVzTWV0YWRhdGEodHlwZSwgcHJvcE1ldGFkYXRhLCBpc1ZpZXdRdWVyeSksCiAgICBpc1N0YW5kYWxvbmU6IG1ldGFkYXRhLnN0YW5kYWxvbmUgPT09IHZvaWQgMCA/IHRydWUgOiAhIW1ldGFkYXRhLnN0YW5kYWxvbmUsCiAgICBpc1NpZ25hbDogISFtZXRhZGF0YS5zaWduYWxzLAogICAgaG9zdERpcmVjdGl2ZXM6IG1ldGFkYXRhLmhvc3REaXJlY3RpdmVzPy5tYXAoKGRpcmVjdGl2ZSkgPT4gdHlwZW9mIGRpcmVjdGl2ZSA9PT0gImZ1bmN0aW9uIiA/IHsKICAgICAgZGlyZWN0aXZlCiAgICB9IDogZGlyZWN0aXZlKSB8fCBudWxsCiAgfTsKfQpmdW5jdGlvbiBhZGREaXJlY3RpdmVEZWZUb1VuZGVjb3JhdGVkUGFyZW50cyh0eXBlKSB7CiAgY29uc3Qgb2JqUHJvdG90eXBlID0gT2JqZWN0LnByb3RvdHlwZTsKICBsZXQgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHR5cGUucHJvdG90eXBlKS5jb25zdHJ1Y3RvcjsKICB3aGlsZSAocGFyZW50ICYmIHBhcmVudCAhPT0gb2JqUHJvdG90eXBlKSB7CiAgICBpZiAoIWdldERpcmVjdGl2ZURlZihwYXJlbnQpICYmICFnZXRDb21wb25lbnREZWYocGFyZW50KSAmJiBzaG91bGRBZGRBYnN0cmFjdERpcmVjdGl2ZShwYXJlbnQpKSB7CiAgICAgIGNvbXBpbGVEaXJlY3RpdmUocGFyZW50LCBudWxsKTsKICAgIH0KICAgIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihwYXJlbnQpOwogIH0KfQpmdW5jdGlvbiBjb252ZXJ0VG9SM1F1ZXJ5UHJlZGljYXRlKHNlbGVjdG9yKSB7CiAgcmV0dXJuIHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgPyBzcGxpdEJ5Q29tbWEoc2VsZWN0b3IpIDogcmVzb2x2ZUZvcndhcmRSZWYoc2VsZWN0b3IpOwp9CmZ1bmN0aW9uIGNvbnZlcnRUb1IzUXVlcnlNZXRhZGF0YShwcm9wZXJ0eU5hbWUsIGFubikgewogIHJldHVybiB7CiAgICBwcm9wZXJ0eU5hbWUsCiAgICBwcmVkaWNhdGU6IGNvbnZlcnRUb1IzUXVlcnlQcmVkaWNhdGUoYW5uLnNlbGVjdG9yKSwKICAgIGRlc2NlbmRhbnRzOiBhbm4uZGVzY2VuZGFudHMsCiAgICBmaXJzdDogYW5uLmZpcnN0LAogICAgcmVhZDogYW5uLnJlYWQgPyBhbm4ucmVhZCA6IG51bGwsCiAgICBzdGF0aWM6ICEhYW5uLnN0YXRpYywKICAgIGVtaXREaXN0aW5jdENoYW5nZXNPbmx5OiAhIWFubi5lbWl0RGlzdGluY3RDaGFuZ2VzT25seSwKICAgIGlzU2lnbmFsOiAhIWFubi5pc1NpZ25hbAogIH07Cn0KZnVuY3Rpb24gZXh0cmFjdFF1ZXJpZXNNZXRhZGF0YSh0eXBlLCBwcm9wTWV0YWRhdGEsIGlzUXVlcnlBbm4pIHsKICBjb25zdCBxdWVyaWVzTWV0YSA9IFtdOwogIGZvciAoY29uc3QgZmllbGQgaW4gcHJvcE1ldGFkYXRhKSB7CiAgICBpZiAocHJvcE1ldGFkYXRhLmhhc093blByb3BlcnR5KGZpZWxkKSkgewogICAgICBjb25zdCBhbm5vdGF0aW9ucyA9IHByb3BNZXRhZGF0YVtmaWVsZF07CiAgICAgIGFubm90YXRpb25zLmZvckVhY2goKGFubikgPT4gewogICAgICAgIGlmIChpc1F1ZXJ5QW5uKGFubikpIHsKICAgICAgICAgIGlmICghYW5uLnNlbGVjdG9yKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2FuJ3QgY29uc3RydWN0IGEgcXVlcnkgZm9yIHRoZSBwcm9wZXJ0eSAiJHtmaWVsZH0iIG9mICIke3N0cmluZ2lmeUZvckVycm9yKHR5cGUpfSIgc2luY2UgdGhlIHF1ZXJ5IHNlbGVjdG9yIHdhc24ndCBkZWZpbmVkLmApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFubm90YXRpb25zLnNvbWUoaXNJbnB1dEFubm90YXRpb24pKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNvbWJpbmUgQElucHV0IGRlY29yYXRvcnMgd2l0aCBxdWVyeSBkZWNvcmF0b3JzYCk7CiAgICAgICAgICB9CiAgICAgICAgICBxdWVyaWVzTWV0YS5wdXNoKGNvbnZlcnRUb1IzUXVlcnlNZXRhZGF0YShmaWVsZCwgYW5uKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9CiAgcmV0dXJuIHF1ZXJpZXNNZXRhOwp9CmZ1bmN0aW9uIGV4dHJhY3RFeHBvcnRBcyhleHBvcnRBcykgewogIHJldHVybiBleHBvcnRBcyA9PT0gdm9pZCAwID8gbnVsbCA6IHNwbGl0QnlDb21tYShleHBvcnRBcyk7Cn0KZnVuY3Rpb24gaXNDb250ZW50UXVlcnkodmFsdWUpIHsKICBjb25zdCBuYW1lID0gdmFsdWUubmdNZXRhZGF0YU5hbWU7CiAgcmV0dXJuIG5hbWUgPT09ICJDb250ZW50Q2hpbGQiIHx8IG5hbWUgPT09ICJDb250ZW50Q2hpbGRyZW4iOwp9CmZ1bmN0aW9uIGlzVmlld1F1ZXJ5KHZhbHVlKSB7CiAgY29uc3QgbmFtZSA9IHZhbHVlLm5nTWV0YWRhdGFOYW1lOwogIHJldHVybiBuYW1lID09PSAiVmlld0NoaWxkIiB8fCBuYW1lID09PSAiVmlld0NoaWxkcmVuIjsKfQpmdW5jdGlvbiBpc0lucHV0QW5ub3RhdGlvbih2YWx1ZSkgewogIHJldHVybiB2YWx1ZS5uZ01ldGFkYXRhTmFtZSA9PT0gIklucHV0IjsKfQpmdW5jdGlvbiBzcGxpdEJ5Q29tbWEodmFsdWUpIHsKICByZXR1cm4gdmFsdWUuc3BsaXQoIiwiKS5tYXAoKHBpZWNlKSA9PiBwaWVjZS50cmltKCkpOwp9CnZhciBMSUZFQ1lDTEVfSE9PS1MgPSBbIm5nT25DaGFuZ2VzIiwgIm5nT25Jbml0IiwgIm5nT25EZXN0cm95IiwgIm5nRG9DaGVjayIsICJuZ0FmdGVyVmlld0luaXQiLCAibmdBZnRlclZpZXdDaGVja2VkIiwgIm5nQWZ0ZXJDb250ZW50SW5pdCIsICJuZ0FmdGVyQ29udGVudENoZWNrZWQiXTsKZnVuY3Rpb24gc2hvdWxkQWRkQWJzdHJhY3REaXJlY3RpdmUodHlwZSkgewogIGNvbnN0IHJlZmxlY3QgPSBnZXRSZWZsZWN0KCk7CiAgaWYgKExJRkVDWUNMRV9IT09LUy5zb21lKChob29rTmFtZSkgPT4gcmVmbGVjdC5oYXNMaWZlY3ljbGVIb29rKHR5cGUsIGhvb2tOYW1lKSkpIHsKICAgIHJldHVybiB0cnVlOwogIH0KICBjb25zdCBwcm9wTWV0YWRhdGEgPSByZWZsZWN0LnByb3BNZXRhZGF0YSh0eXBlKTsKICBmb3IgKGNvbnN0IGZpZWxkIGluIHByb3BNZXRhZGF0YSkgewogICAgY29uc3QgYW5ub3RhdGlvbnMgPSBwcm9wTWV0YWRhdGFbZmllbGRdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbm5vdGF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjdXJyZW50ID0gYW5ub3RhdGlvbnNbaV07CiAgICAgIGNvbnN0IG1ldGFkYXRhTmFtZSA9IGN1cnJlbnQubmdNZXRhZGF0YU5hbWU7CiAgICAgIGlmIChpc0lucHV0QW5ub3RhdGlvbihjdXJyZW50KSB8fCBpc0NvbnRlbnRRdWVyeShjdXJyZW50KSB8fCBpc1ZpZXdRdWVyeShjdXJyZW50KSB8fCBtZXRhZGF0YU5hbWUgPT09ICJPdXRwdXQiIHx8IG1ldGFkYXRhTmFtZSA9PT0gIkhvc3RCaW5kaW5nIiB8fCBtZXRhZGF0YU5hbWUgPT09ICJIb3N0TGlzdGVuZXIiKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGNvbXBpbGVQaXBlKHR5cGUsIG1ldGEpIHsKICBsZXQgbmdQaXBlRGVmID0gbnVsbDsKICBsZXQgbmdGYWN0b3J5RGVmID0gbnVsbDsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkodHlwZSwgTkdfRkFDVE9SWV9ERUYsIHsKICAgIGdldDogKCkgPT4gewogICAgICBpZiAobmdGYWN0b3J5RGVmID09PSBudWxsKSB7CiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBnZXRQaXBlTWV0YWRhdGEodHlwZSwgbWV0YSk7CiAgICAgICAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICAgICAgICB1c2FnZTogMCwKICAgICAgICAgIGtpbmQ6ICJwaXBlIiwKICAgICAgICAgIHR5cGU6IG1ldGFkYXRhLnR5cGUKICAgICAgICB9KTsKICAgICAgICBuZ0ZhY3RvcnlEZWYgPSBjb21waWxlci5jb21waWxlRmFjdG9yeShhbmd1bGFyQ29yZUVudiwgYG5nOi8vLyR7bWV0YWRhdGEubmFtZX0vybVmYWMuanNgLCB7CiAgICAgICAgICBuYW1lOiBtZXRhZGF0YS5uYW1lLAogICAgICAgICAgdHlwZTogbWV0YWRhdGEudHlwZSwKICAgICAgICAgIHR5cGVBcmd1bWVudENvdW50OiAwLAogICAgICAgICAgZGVwczogcmVmbGVjdERlcGVuZGVuY2llcyh0eXBlKSwKICAgICAgICAgIHRhcmdldDogY29tcGlsZXIuRmFjdG9yeVRhcmdldC5QaXBlCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5nRmFjdG9yeURlZjsKICAgIH0sCiAgICBjb25maWd1cmFibGU6ICEhbmdEZXZNb2RlCiAgfSk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHR5cGUsIE5HX1BJUEVfREVGLCB7CiAgICBnZXQ6ICgpID0+IHsKICAgICAgaWYgKG5nUGlwZURlZiA9PT0gbnVsbCkgewogICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZ2V0UGlwZU1ldGFkYXRhKHR5cGUsIG1ldGEpOwogICAgICAgIGNvbnN0IGNvbXBpbGVyID0gZ2V0Q29tcGlsZXJGYWNhZGUoewogICAgICAgICAgdXNhZ2U6IDAsCiAgICAgICAgICBraW5kOiAicGlwZSIsCiAgICAgICAgICB0eXBlOiBtZXRhZGF0YS50eXBlCiAgICAgICAgfSk7CiAgICAgICAgbmdQaXBlRGVmID0gY29tcGlsZXIuY29tcGlsZVBpcGUoYW5ndWxhckNvcmVFbnYsIGBuZzovLy8ke21ldGFkYXRhLm5hbWV9L8m1cGlwZS5qc2AsIG1ldGFkYXRhKTsKICAgICAgfQogICAgICByZXR1cm4gbmdQaXBlRGVmOwogICAgfSwKICAgIGNvbmZpZ3VyYWJsZTogISFuZ0Rldk1vZGUKICB9KTsKfQpmdW5jdGlvbiBnZXRQaXBlTWV0YWRhdGEodHlwZSwgbWV0YSkgewogIHJldHVybiB7CiAgICB0eXBlLAogICAgbmFtZTogdHlwZS5uYW1lLAogICAgcGlwZU5hbWU6IG1ldGEubmFtZSwKICAgIHB1cmU6IG1ldGEucHVyZSAhPT0gdm9pZCAwID8gbWV0YS5wdXJlIDogdHJ1ZSwKICAgIGlzU3RhbmRhbG9uZTogbWV0YS5zdGFuZGFsb25lID09PSB2b2lkIDAgPyB0cnVlIDogISFtZXRhLnN0YW5kYWxvbmUKICB9Owp9CnZhciBEaXJlY3RpdmUgPSBtYWtlRGVjb3JhdG9yKCJEaXJlY3RpdmUiLCAoZGlyID0ge30pID0+IGRpciwgdm9pZCAwLCB2b2lkIDAsICh0eXBlLCBtZXRhKSA9PiBjb21waWxlRGlyZWN0aXZlKHR5cGUsIG1ldGEpKTsKdmFyIENvbXBvbmVudCA9IG1ha2VEZWNvcmF0b3IoIkNvbXBvbmVudCIsIChjID0ge30pID0+IF9fc3ByZWFkVmFsdWVzKHsKICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LkRlZmF1bHQKfSwgYyksIERpcmVjdGl2ZSwgdm9pZCAwLCAodHlwZSwgbWV0YSkgPT4gY29tcGlsZUNvbXBvbmVudCh0eXBlLCBtZXRhKSk7CnZhciBQaXBlID0gbWFrZURlY29yYXRvcigiUGlwZSIsIChwKSA9PiBfX3NwcmVhZFZhbHVlcyh7CiAgcHVyZTogdHJ1ZQp9LCBwKSwgdm9pZCAwLCB2b2lkIDAsICh0eXBlLCBtZXRhKSA9PiBjb21waWxlUGlwZSh0eXBlLCBtZXRhKSk7CnZhciBJbnB1dCA9IG1ha2VQcm9wRGVjb3JhdG9yKCJJbnB1dCIsIChhcmcpID0+IHsKICBpZiAoIWFyZykgewogICAgcmV0dXJuIHt9OwogIH0KICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gInN0cmluZyIgPyB7CiAgICBhbGlhczogYXJnCiAgfSA6IGFyZzsKfSk7CnZhciBPdXRwdXQgPSBtYWtlUHJvcERlY29yYXRvcigiT3V0cHV0IiwgKGFsaWFzKSA9PiAoewogIGFsaWFzCn0pKTsKdmFyIEhvc3RCaW5kaW5nID0gbWFrZVByb3BEZWNvcmF0b3IoIkhvc3RCaW5kaW5nIiwgKGhvc3RQcm9wZXJ0eU5hbWUpID0+ICh7CiAgaG9zdFByb3BlcnR5TmFtZQp9KSk7CnZhciBIb3N0TGlzdGVuZXIgPSBtYWtlUHJvcERlY29yYXRvcigiSG9zdExpc3RlbmVyIiwgKGV2ZW50TmFtZSwgYXJncykgPT4gKHsKICBldmVudE5hbWUsCiAgYXJncwp9KSk7CnZhciBOZ01vZHVsZSA9IG1ha2VEZWNvcmF0b3IoIk5nTW9kdWxlIiwgKG5nTW9kdWxlKSA9PiBuZ01vZHVsZSwgdm9pZCAwLCB2b2lkIDAsICh0eXBlLCBtZXRhKSA9PiBjb21waWxlTmdNb2R1bGUodHlwZSwgbWV0YSkpOwp2YXIgTW9kdWxlV2l0aENvbXBvbmVudEZhY3RvcmllcyA9IGNsYXNzIHsKICBuZ01vZHVsZUZhY3Rvcnk7CiAgY29tcG9uZW50RmFjdG9yaWVzOwogIGNvbnN0cnVjdG9yKG5nTW9kdWxlRmFjdG9yeSwgY29tcG9uZW50RmFjdG9yaWVzKSB7CiAgICB0aGlzLm5nTW9kdWxlRmFjdG9yeSA9IG5nTW9kdWxlRmFjdG9yeTsKICAgIHRoaXMuY29tcG9uZW50RmFjdG9yaWVzID0gY29tcG9uZW50RmFjdG9yaWVzOwogIH0KfTsKdmFyIENvbXBpbGVyID0gY2xhc3MgX0NvbXBpbGVyIHsKICBjb21waWxlTW9kdWxlU3luYyhtb2R1bGVUeXBlKSB7CiAgICByZXR1cm4gbmV3IE5nTW9kdWxlRmFjdG9yeTIobW9kdWxlVHlwZSk7CiAgfQogIGNvbXBpbGVNb2R1bGVBc3luYyhtb2R1bGVUeXBlKSB7CiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuY29tcGlsZU1vZHVsZVN5bmMobW9kdWxlVHlwZSkpOwogIH0KICBjb21waWxlTW9kdWxlQW5kQWxsQ29tcG9uZW50c1N5bmMobW9kdWxlVHlwZSkgewogICAgY29uc3QgbmdNb2R1bGVGYWN0b3J5ID0gdGhpcy5jb21waWxlTW9kdWxlU3luYyhtb2R1bGVUeXBlKTsKICAgIGNvbnN0IG1vZHVsZURlZiA9IGdldE5nTW9kdWxlRGVmKG1vZHVsZVR5cGUpOwogICAgY29uc3QgY29tcG9uZW50RmFjdG9yaWVzID0gbWF5YmVVbndyYXBGbihtb2R1bGVEZWYuZGVjbGFyYXRpb25zKS5yZWR1Y2UoKGZhY3RvcmllcywgZGVjbGFyYXRpb24pID0+IHsKICAgICAgY29uc3QgY29tcG9uZW50RGVmID0gZ2V0Q29tcG9uZW50RGVmKGRlY2xhcmF0aW9uKTsKICAgICAgY29tcG9uZW50RGVmICYmIGZhY3Rvcmllcy5wdXNoKG5ldyBDb21wb25lbnRGYWN0b3J5Mihjb21wb25lbnREZWYpKTsKICAgICAgcmV0dXJuIGZhY3RvcmllczsKICAgIH0sIFtdKTsKICAgIHJldHVybiBuZXcgTW9kdWxlV2l0aENvbXBvbmVudEZhY3RvcmllcyhuZ01vZHVsZUZhY3RvcnksIGNvbXBvbmVudEZhY3Rvcmllcyk7CiAgfQogIGNvbXBpbGVNb2R1bGVBbmRBbGxDb21wb25lbnRzQXN5bmMobW9kdWxlVHlwZSkgewogICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLmNvbXBpbGVNb2R1bGVBbmRBbGxDb21wb25lbnRzU3luYyhtb2R1bGVUeXBlKSk7CiAgfQogIGNsZWFyQ2FjaGUoKSB7CiAgfQogIGNsZWFyQ2FjaGVGb3IodHlwZSkgewogIH0KICBnZXRNb2R1bGVJZChtb2R1bGVUeXBlKSB7CiAgICByZXR1cm4gdm9pZCAwOwogIH0KICBzdGF0aWMgybVmYWMgPSBmdW5jdGlvbiBDb21waWxlcl9GYWN0b3J5KF9fbmdGYWN0b3J5VHlwZV9fKSB7CiAgICByZXR1cm4gbmV3IChfX25nRmFjdG9yeVR5cGVfXyB8fCBfQ29tcGlsZXIpKCk7CiAgfTsKICBzdGF0aWMgybVwcm92ID0gybXJtWRlZmluZUluamVjdGFibGUoewogICAgdG9rZW46IF9Db21waWxlciwKICAgIGZhY3Rvcnk6IF9Db21waWxlci7JtWZhYywKICAgIHByb3ZpZGVkSW46ICJyb290IgogIH0pOwp9OwooKCkgPT4gewogICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIHNldENsYXNzTWV0YWRhdGEoQ29tcGlsZXIsIFt7CiAgICB0eXBlOiBJbmplY3RhYmxlLAogICAgYXJnczogW3sKICAgICAgcHJvdmlkZWRJbjogInJvb3QiCiAgICB9XQogIH1dLCBudWxsLCBudWxsKTsKfSkoKTsKdmFyIENPTVBJTEVSX09QVElPTlMgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gImNvbXBpbGVyT3B0aW9ucyIgOiAiIik7CnZhciBDb21waWxlckZhY3RvcnkgPSBjbGFzcyB7Cn07CnZhciBDT05TRUNVVElWRV9NSUNST1RBU0tfTk9USUZJQ0FUSU9OX0xJTUlUID0gMTAwOwp2YXIgY29uc2VjdXRpdmVNaWNyb3Rhc2tOb3RpZmljYXRpb25zID0gMDsKdmFyIHN0YWNrRnJvbUxhc3RGZXdOb3RpZmljYXRpb25zID0gW107CmZ1bmN0aW9uIHRyYWNrTWljcm90YXNrTm90aWZpY2F0aW9uRm9yRGVidWdnaW5nKCkgewogIGNvbnNlY3V0aXZlTWljcm90YXNrTm90aWZpY2F0aW9ucysrOwogIGlmIChDT05TRUNVVElWRV9NSUNST1RBU0tfTk9USUZJQ0FUSU9OX0xJTUlUIC0gY29uc2VjdXRpdmVNaWNyb3Rhc2tOb3RpZmljYXRpb25zIDwgNSkgewogICAgY29uc3Qgc3RhY2sgPSBuZXcgRXJyb3IoKS5zdGFjazsKICAgIGlmIChzdGFjaykgewogICAgICBzdGFja0Zyb21MYXN0RmV3Tm90aWZpY2F0aW9ucy5wdXNoKHN0YWNrKTsKICAgIH0KICB9CiAgaWYgKGNvbnNlY3V0aXZlTWljcm90YXNrTm90aWZpY2F0aW9ucyA9PT0gQ09OU0VDVVRJVkVfTUlDUk9UQVNLX05PVElGSUNBVElPTl9MSU1JVCkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigxMDMsICJBbmd1bGFyIGNvdWxkIG5vdCBzdGFiaWxpemUgYmVjYXVzZSB0aGVyZSB3ZXJlIGVuZGxlc3MgY2hhbmdlIG5vdGlmaWNhdGlvbnMgd2l0aGluIHRoZSBicm93c2VyIGV2ZW50IGxvb3AuIFRoZSBzdGFjayBmcm9tIHRoZSBsYXN0IHNldmVyYWwgbm90aWZpY2F0aW9uczogXG4iICsgc3RhY2tGcm9tTGFzdEZld05vdGlmaWNhdGlvbnMuam9pbigiXG4iKSk7CiAgfQp9CnZhciBDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXJJbXBsID0gY2xhc3MgX0NoYW5nZURldGVjdGlvblNjaGVkdWxlckltcGwgewogIGFwcGxpY2F0aW9uRXJyb3JIYW5kbGVyID0gaW5qZWN0MihJTlRFUk5BTF9BUFBMSUNBVElPTl9FUlJPUl9IQU5ETEVSKTsKICBhcHBSZWYgPSBpbmplY3QyKEFwcGxpY2F0aW9uUmVmKTsKICB0YXNrU2VydmljZSA9IGluamVjdDIoUGVuZGluZ1Rhc2tzSW50ZXJuYWwpOwogIG5nWm9uZSA9IGluamVjdDIoTmdab25lKTsKICB6b25lbGVzc0VuYWJsZWQgPSBpbmplY3QyKFpPTkVMRVNTX0VOQUJMRUQpOwogIHRyYWNpbmcgPSBpbmplY3QyKFRyYWNpbmdTZXJ2aWNlLCB7CiAgICBvcHRpb25hbDogdHJ1ZQogIH0pOwogIHpvbmVJc0RlZmluZWQgPSB0eXBlb2YgWm9uZSAhPT0gInVuZGVmaW5lZCIgJiYgISFab25lLnJvb3QucnVuOwogIHNjaGVkdWxlclRpY2tBcHBseUFyZ3MgPSBbewogICAgZGF0YTogewogICAgICAiX19zY2hlZHVsZXJfdGlja19fIjogdHJ1ZQogICAgfQogIH1dOwogIHN1YnNjcmlwdGlvbnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7CiAgYW5ndWxhclpvbmVJZCA9IHRoaXMuem9uZUlzRGVmaW5lZCA/IHRoaXMubmdab25lLl9pbm5lcj8uZ2V0KGFuZ3VsYXJab25lSW5zdGFuY2VJZFByb3BlcnR5KSA6IG51bGw7CiAgc2NoZWR1bGVJblJvb3Rab25lID0gIXRoaXMuem9uZWxlc3NFbmFibGVkICYmIHRoaXMuem9uZUlzRGVmaW5lZCAmJiAoaW5qZWN0MihTQ0hFRFVMRV9JTl9ST09UX1pPTkUsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSkgPz8gZmFsc2UpOwogIGNhbmNlbFNjaGVkdWxlZENhbGxiYWNrID0gbnVsbDsKICB1c2VNaWNyb3Rhc2tTY2hlZHVsZXIgPSBmYWxzZTsKICBydW5uaW5nVGljayA9IGZhbHNlOwogIHBlbmRpbmdSZW5kZXJUYXNrSWQgPSBudWxsOwogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZCh0aGlzLmFwcFJlZi5hZnRlclRpY2suc3Vic2NyaWJlKCgpID0+IHsKICAgICAgY29uc3QgdGFzayA9IHRoaXMudGFza1NlcnZpY2UuYWRkKCk7CiAgICAgIGlmICghdGhpcy5ydW5uaW5nVGljaykgewogICAgICAgIHRoaXMuY2xlYW51cCgpOwogICAgICAgIGlmICghdGhpcy56b25lbGVzc0VuYWJsZWQgfHwgdGhpcy5hcHBSZWYuaW5jbHVkZUFsbFRlc3RWaWV3cykgewogICAgICAgICAgdGhpcy50YXNrU2VydmljZS5yZW1vdmUodGFzayk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuc3dpdGNoVG9NaWNyb3Rhc2tTY2hlZHVsZXIoKTsKICAgICAgdGhpcy50YXNrU2VydmljZS5yZW1vdmUodGFzayk7CiAgICB9KSk7CiAgICB0aGlzLnN1YnNjcmlwdGlvbnMuYWRkKHRoaXMubmdab25lLm9uVW5zdGFibGUuc3Vic2NyaWJlKCgpID0+IHsKICAgICAgaWYgKCF0aGlzLnJ1bm5pbmdUaWNrKSB7CiAgICAgICAgdGhpcy5jbGVhbnVwKCk7CiAgICAgIH0KICAgIH0pKTsKICB9CiAgc3dpdGNoVG9NaWNyb3Rhc2tTY2hlZHVsZXIoKSB7CiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7CiAgICAgIGNvbnN0IHRhc2sgPSB0aGlzLnRhc2tTZXJ2aWNlLmFkZCgpOwogICAgICB0aGlzLnVzZU1pY3JvdGFza1NjaGVkdWxlciA9IHRydWU7CiAgICAgIHF1ZXVlTWljcm90YXNrKCgpID0+IHsKICAgICAgICB0aGlzLnVzZU1pY3JvdGFza1NjaGVkdWxlciA9IGZhbHNlOwogICAgICAgIHRoaXMudGFza1NlcnZpY2UucmVtb3ZlKHRhc2spOwogICAgICB9KTsKICAgIH0pOwogIH0KICBub3RpZnkoc291cmNlKSB7CiAgICBpZiAoIXRoaXMuem9uZWxlc3NFbmFibGVkICYmIHNvdXJjZSA9PT0gNSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBzd2l0Y2ggKHNvdXJjZSkgewogICAgICBjYXNlIDA6IHsKICAgICAgICB0aGlzLmFwcFJlZi5kaXJ0eUZsYWdzIHw9IDI7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAzOgogICAgICBjYXNlIDI6CiAgICAgIGNhc2UgNDoKICAgICAgY2FzZSA1OgogICAgICBjYXNlIDE6IHsKICAgICAgICB0aGlzLmFwcFJlZi5kaXJ0eUZsYWdzIHw9IDQ7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSA2OiB7CiAgICAgICAgdGhpcy5hcHBSZWYuZGlydHlGbGFncyB8PSAyOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMTI6IHsKICAgICAgICB0aGlzLmFwcFJlZi5kaXJ0eUZsYWdzIHw9IDE2OwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMTM6IHsKICAgICAgICB0aGlzLmFwcFJlZi5kaXJ0eUZsYWdzIHw9IDI7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAxMTogewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgOToKICAgICAgY2FzZSA4OgogICAgICBjYXNlIDc6CiAgICAgIGNhc2UgMTA6CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICB0aGlzLmFwcFJlZi5kaXJ0eUZsYWdzIHw9IDg7CiAgICAgIH0KICAgIH0KICAgIHRoaXMuYXBwUmVmLnRyYWNpbmdTbmFwc2hvdCA9IHRoaXMudHJhY2luZz8uc25hcHNob3QodGhpcy5hcHBSZWYudHJhY2luZ1NuYXBzaG90KSA/PyBudWxsOwogICAgaWYgKCF0aGlzLnNob3VsZFNjaGVkdWxlVGljaygpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICAgICAgaWYgKHRoaXMudXNlTWljcm90YXNrU2NoZWR1bGVyKSB7CiAgICAgICAgdHJhY2tNaWNyb3Rhc2tOb3RpZmljYXRpb25Gb3JEZWJ1Z2dpbmcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zZWN1dGl2ZU1pY3JvdGFza05vdGlmaWNhdGlvbnMgPSAwOwogICAgICAgIHN0YWNrRnJvbUxhc3RGZXdOb3RpZmljYXRpb25zLmxlbmd0aCA9IDA7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IHNjaGVkdWxlQ2FsbGJhY2sgPSB0aGlzLnVzZU1pY3JvdGFza1NjaGVkdWxlciA/IHNjaGVkdWxlQ2FsbGJhY2tXaXRoTWljcm90YXNrIDogc2NoZWR1bGVDYWxsYmFja1dpdGhSYWZSYWNlOwogICAgdGhpcy5wZW5kaW5nUmVuZGVyVGFza0lkID0gdGhpcy50YXNrU2VydmljZS5hZGQoKTsKICAgIGlmICh0aGlzLnNjaGVkdWxlSW5Sb290Wm9uZSkgewogICAgICB0aGlzLmNhbmNlbFNjaGVkdWxlZENhbGxiYWNrID0gWm9uZS5yb290LnJ1bigoKSA9PiBzY2hlZHVsZUNhbGxiYWNrKCgpID0+IHRoaXMudGljaygpKSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNhbmNlbFNjaGVkdWxlZENhbGxiYWNrID0gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gc2NoZWR1bGVDYWxsYmFjaygoKSA9PiB0aGlzLnRpY2soKSkpOwogICAgfQogIH0KICBzaG91bGRTY2hlZHVsZVRpY2soKSB7CiAgICBpZiAodGhpcy5hcHBSZWYuZGVzdHJveWVkKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGlmICh0aGlzLnBlbmRpbmdSZW5kZXJUYXNrSWQgIT09IG51bGwgfHwgdGhpcy5ydW5uaW5nVGljayB8fCB0aGlzLmFwcFJlZi5fcnVubmluZ1RpY2spIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgaWYgKCF0aGlzLnpvbmVsZXNzRW5hYmxlZCAmJiB0aGlzLnpvbmVJc0RlZmluZWQgJiYgWm9uZS5jdXJyZW50LmdldChhbmd1bGFyWm9uZUluc3RhbmNlSWRQcm9wZXJ0eSArIHRoaXMuYW5ndWxhclpvbmVJZCkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQogIHRpY2soKSB7CiAgICBpZiAodGhpcy5ydW5uaW5nVGljayB8fCB0aGlzLmFwcFJlZi5kZXN0cm95ZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKHRoaXMuYXBwUmVmLmRpcnR5RmxhZ3MgPT09IDApIHsKICAgICAgdGhpcy5jbGVhbnVwKCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghdGhpcy56b25lbGVzc0VuYWJsZWQgJiYgdGhpcy5hcHBSZWYuZGlydHlGbGFncyAmIDcpIHsKICAgICAgdGhpcy5hcHBSZWYuZGlydHlGbGFncyB8PSAxOwogICAgfQogICAgY29uc3QgdGFzayA9IHRoaXMudGFza1NlcnZpY2UuYWRkKCk7CiAgICB0cnkgewogICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gewogICAgICAgIHRoaXMucnVubmluZ1RpY2sgPSB0cnVlOwogICAgICAgIHRoaXMuYXBwUmVmLl90aWNrKCk7CiAgICAgIH0sIHZvaWQgMCwgdGhpcy5zY2hlZHVsZXJUaWNrQXBwbHlBcmdzKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdGhpcy5hcHBsaWNhdGlvbkVycm9ySGFuZGxlcihlKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHRoaXMudGFza1NlcnZpY2UucmVtb3ZlKHRhc2spOwogICAgICB0aGlzLmNsZWFudXAoKTsKICAgIH0KICB9CiAgbmdPbkRlc3Ryb3koKSB7CiAgICB0aGlzLnN1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKTsKICAgIHRoaXMuY2xlYW51cCgpOwogIH0KICBjbGVhbnVwKCkgewogICAgdGhpcy5ydW5uaW5nVGljayA9IGZhbHNlOwogICAgdGhpcy5jYW5jZWxTY2hlZHVsZWRDYWxsYmFjaz8uKCk7CiAgICB0aGlzLmNhbmNlbFNjaGVkdWxlZENhbGxiYWNrID0gbnVsbDsKICAgIGlmICh0aGlzLnBlbmRpbmdSZW5kZXJUYXNrSWQgIT09IG51bGwpIHsKICAgICAgY29uc3QgdGFza0lkID0gdGhpcy5wZW5kaW5nUmVuZGVyVGFza0lkOwogICAgICB0aGlzLnBlbmRpbmdSZW5kZXJUYXNrSWQgPSBudWxsOwogICAgICB0aGlzLnRhc2tTZXJ2aWNlLnJlbW92ZSh0YXNrSWQpOwogICAgfQogIH0KICBzdGF0aWMgybVmYWMgPSBmdW5jdGlvbiBDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXJJbXBsX0ZhY3RvcnkoX19uZ0ZhY3RvcnlUeXBlX18pIHsKICAgIHJldHVybiBuZXcgKF9fbmdGYWN0b3J5VHlwZV9fIHx8IF9DaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXJJbXBsKSgpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVySW1wbCwKICAgIGZhY3Rvcnk6IF9DaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXJJbXBsLsm1ZmFjLAogICAgcHJvdmlkZWRJbjogInJvb3QiCiAgfSk7Cn07CigoKSA9PiB7CiAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgc2V0Q2xhc3NNZXRhZGF0YShDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXJJbXBsLCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJyb290IgogICAgfV0KICB9XSwgKCkgPT4gW10sIG51bGwpOwp9KSgpOwpmdW5jdGlvbiBwcm92aWRlWm9uZWxlc3NDaGFuZ2VEZXRlY3Rpb24oKSB7CiAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiTmdab25lbGVzcyIpOwogIGlmICgodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiB0eXBlb2YgWm9uZSAhPT0gInVuZGVmaW5lZCIgJiYgWm9uZSkgewogICAgY29uc3QgbWVzc2FnZSA9IGZvcm1hdFJ1bnRpbWVFcnJvcig5MTQsIGBUaGUgYXBwbGljYXRpb24gaXMgdXNpbmcgem9uZWxlc3MgY2hhbmdlIGRldGVjdGlvbiwgYnV0IGlzIHN0aWxsIGxvYWRpbmcgWm9uZS5qcy4gQ29uc2lkZXIgcmVtb3ZpbmcgWm9uZS5qcyB0byBnZXQgdGhlIGZ1bGwgYmVuZWZpdHMgb2Ygem9uZWxlc3MuIEluIGFwcGxpY2F0aW9ucyB1c2luZyB0aGUgQW5ndWxhciBDTEksIFpvbmUuanMgaXMgdHlwaWNhbGx5IGluY2x1ZGVkIGluIHRoZSAicG9seWZpbGxzIiBzZWN0aW9uIG9mIHRoZSBhbmd1bGFyLmpzb24gZmlsZS5gKTsKICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTsKICB9CiAgcmV0dXJuIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhbLi4ucHJvdmlkZVpvbmVsZXNzQ2hhbmdlRGV0ZWN0aW9uSW50ZXJuYWwoKSwgdHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gW3sKICAgIHByb3ZpZGU6IFBST1ZJREVEX1pPTkVMRVNTLAogICAgdXNlVmFsdWU6IHRydWUKICB9XSA6IFtdXSk7Cn0KZnVuY3Rpb24gcHJvdmlkZVpvbmVsZXNzQ2hhbmdlRGV0ZWN0aW9uSW50ZXJuYWwoKSB7CiAgcmV0dXJuIFt7CiAgICBwcm92aWRlOiBDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIsCiAgICB1c2VFeGlzdGluZzogQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVySW1wbAogIH0sIHsKICAgIHByb3ZpZGU6IE5nWm9uZSwKICAgIHVzZUNsYXNzOiBOb29wTmdab25lCiAgfSwgewogICAgcHJvdmlkZTogWk9ORUxFU1NfRU5BQkxFRCwKICAgIHVzZVZhbHVlOiB0cnVlCiAgfV07Cn0KZnVuY3Rpb24gZ2V0R2xvYmFsTG9jYWxlKCkgewogIGlmICh0eXBlb2YgbmdJMThuQ2xvc3VyZU1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nSTE4bkNsb3N1cmVNb2RlICYmIHR5cGVvZiBnb29nICE9PSAidW5kZWZpbmVkIiAmJiBnb29nLkxPQ0FMRSAhPT0gImVuIikgewogICAgcmV0dXJuIGdvb2cuTE9DQUxFOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHlwZW9mICRsb2NhbGl6ZSAhPT0gInVuZGVmaW5lZCIgJiYgJGxvY2FsaXplLmxvY2FsZSB8fCBERUZBVUxUX0xPQ0FMRV9JRDsKICB9Cn0KdmFyIExPQ0FMRV9JRCA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiTG9jYWxlSWQiIDogIiIsIHsKICBmYWN0b3J5OiAoKSA9PiBpbmplY3QyKExPQ0FMRV9JRCwgewogICAgb3B0aW9uYWw6IHRydWUsCiAgICBza2lwU2VsZjogdHJ1ZQogIH0pIHx8IGdldEdsb2JhbExvY2FsZSgpCn0pOwp2YXIgREVGQVVMVF9DVVJSRU5DWV9DT0RFID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJEZWZhdWx0Q3VycmVuY3lDb2RlIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gVVNEX0NVUlJFTkNZX0NPREUKfSk7CnZhciBUUkFOU0xBVElPTlMgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlID8gIlRyYW5zbGF0aW9ucyIgOiAiIik7CnZhciBUUkFOU0xBVElPTlNfRk9STUFUID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJUcmFuc2xhdGlvbnNGb3JtYXQiIDogIiIpOwp2YXIgTWlzc2luZ1RyYW5zbGF0aW9uU3RyYXRlZ3k7CihmdW5jdGlvbihNaXNzaW5nVHJhbnNsYXRpb25TdHJhdGVneTIpIHsKICBNaXNzaW5nVHJhbnNsYXRpb25TdHJhdGVneTJbTWlzc2luZ1RyYW5zbGF0aW9uU3RyYXRlZ3kyWyJFcnJvciJdID0gMF0gPSAiRXJyb3IiOwogIE1pc3NpbmdUcmFuc2xhdGlvblN0cmF0ZWd5MltNaXNzaW5nVHJhbnNsYXRpb25TdHJhdGVneTJbIldhcm5pbmciXSA9IDFdID0gIldhcm5pbmciOwogIE1pc3NpbmdUcmFuc2xhdGlvblN0cmF0ZWd5MltNaXNzaW5nVHJhbnNsYXRpb25TdHJhdGVneTJbIklnbm9yZSJdID0gMl0gPSAiSWdub3JlIjsKfSkoTWlzc2luZ1RyYW5zbGF0aW9uU3RyYXRlZ3kgfHwgKE1pc3NpbmdUcmFuc2xhdGlvblN0cmF0ZWd5ID0ge30pKTsKdmFyIERlYnVnRXZlbnRMaXN0ZW5lciA9IGNsYXNzIHsKICBuYW1lOwogIGNhbGxiYWNrOwogIGNvbnN0cnVjdG9yKG5hbWUsIGNhbGxiYWNrKSB7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrOwogIH0KfTsKZnVuY3Rpb24gYXNOYXRpdmVFbGVtZW50cyhkZWJ1Z0VscykgewogIHJldHVybiBkZWJ1Z0Vscy5tYXAoKGVsKSA9PiBlbC5uYXRpdmVFbGVtZW50KTsKfQp2YXIgRGVidWdOb2RlID0gY2xhc3MgewogIG5hdGl2ZU5vZGU7CiAgY29uc3RydWN0b3IobmF0aXZlTm9kZSkgewogICAgdGhpcy5uYXRpdmVOb2RlID0gbmF0aXZlTm9kZTsKICB9CiAgZ2V0IHBhcmVudCgpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXMubmF0aXZlTm9kZS5wYXJlbnROb2RlOwogICAgcmV0dXJuIHBhcmVudCA/IG5ldyBEZWJ1Z0VsZW1lbnQocGFyZW50KSA6IG51bGw7CiAgfQogIGdldCBpbmplY3RvcigpIHsKICAgIHJldHVybiBnZXRJbmplY3Rvcih0aGlzLm5hdGl2ZU5vZGUpOwogIH0KICBnZXQgY29tcG9uZW50SW5zdGFuY2UoKSB7CiAgICBjb25zdCBuYXRpdmVFbGVtZW50ID0gdGhpcy5uYXRpdmVOb2RlOwogICAgcmV0dXJuIG5hdGl2ZUVsZW1lbnQgJiYgKGdldENvbXBvbmVudChuYXRpdmVFbGVtZW50KSB8fCBnZXRPd25pbmdDb21wb25lbnQobmF0aXZlRWxlbWVudCkpOwogIH0KICBnZXQgY29udGV4dCgpIHsKICAgIHJldHVybiBnZXRDb21wb25lbnQodGhpcy5uYXRpdmVOb2RlKSB8fCBnZXRDb250ZXh0KHRoaXMubmF0aXZlTm9kZSk7CiAgfQogIGdldCBsaXN0ZW5lcnMoKSB7CiAgICByZXR1cm4gZ2V0TGlzdGVuZXJzKHRoaXMubmF0aXZlTm9kZSkuZmlsdGVyKChsaXN0ZW5lcikgPT4gbGlzdGVuZXIudHlwZSA9PT0gImRvbSIpOwogIH0KICBnZXQgcmVmZXJlbmNlcygpIHsKICAgIHJldHVybiBnZXRMb2NhbFJlZnModGhpcy5uYXRpdmVOb2RlKTsKICB9CiAgZ2V0IHByb3ZpZGVyVG9rZW5zKCkgewogICAgcmV0dXJuIGdldEluamVjdGlvblRva2Vucyh0aGlzLm5hdGl2ZU5vZGUpOwogIH0KfTsKdmFyIERlYnVnRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgRGVidWdOb2RlIHsKICBjb25zdHJ1Y3RvcihuYXRpdmVOb2RlKSB7CiAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0RG9tTm9kZShuYXRpdmVOb2RlKTsKICAgIHN1cGVyKG5hdGl2ZU5vZGUpOwogIH0KICBnZXQgbmF0aXZlRWxlbWVudCgpIHsKICAgIHJldHVybiB0aGlzLm5hdGl2ZU5vZGUubm9kZVR5cGUgPT0gTm9kZS5FTEVNRU5UX05PREUgPyB0aGlzLm5hdGl2ZU5vZGUgOiBudWxsOwogIH0KICBnZXQgbmFtZSgpIHsKICAgIGNvbnN0IGNvbnRleHQyID0gZ2V0TENvbnRleHQodGhpcy5uYXRpdmVOb2RlKTsKICAgIGNvbnN0IGxWaWV3ID0gY29udGV4dDIgPyBjb250ZXh0Mi5sVmlldyA6IG51bGw7CiAgICBpZiAobFZpZXcgIT09IG51bGwpIHsKICAgICAgY29uc3QgdERhdGEgPSBsVmlld1tUVklFV10uZGF0YTsKICAgICAgY29uc3QgdE5vZGUgPSB0RGF0YVtjb250ZXh0Mi5ub2RlSW5kZXhdOwogICAgICByZXR1cm4gdE5vZGUudmFsdWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdGhpcy5uYXRpdmVOb2RlLm5vZGVOYW1lOwogICAgfQogIH0KICBnZXQgcHJvcGVydGllcygpIHsKICAgIGNvbnN0IGNvbnRleHQyID0gZ2V0TENvbnRleHQodGhpcy5uYXRpdmVOb2RlKTsKICAgIGNvbnN0IGxWaWV3ID0gY29udGV4dDIgPyBjb250ZXh0Mi5sVmlldyA6IG51bGw7CiAgICBpZiAobFZpZXcgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfQogICAgY29uc3QgdERhdGEgPSBsVmlld1tUVklFV10uZGF0YTsKICAgIGNvbnN0IHROb2RlID0gdERhdGFbY29udGV4dDIubm9kZUluZGV4XTsKICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKICAgIGNvcHlEb21Qcm9wZXJ0aWVzKHRoaXMubmF0aXZlRWxlbWVudCwgcHJvcGVydGllcyk7CiAgICBjb2xsZWN0UHJvcGVydHlCaW5kaW5ncyhwcm9wZXJ0aWVzLCB0Tm9kZSwgbFZpZXcsIHREYXRhKTsKICAgIHJldHVybiBwcm9wZXJ0aWVzOwogIH0KICBnZXQgYXR0cmlidXRlcygpIHsKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTsKICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLm5hdGl2ZUVsZW1lbnQ7CiAgICBpZiAoIWVsZW1lbnQpIHsKICAgICAgcmV0dXJuIGF0dHJpYnV0ZXM7CiAgICB9CiAgICBjb25zdCBjb250ZXh0MiA9IGdldExDb250ZXh0KGVsZW1lbnQpOwogICAgY29uc3QgbFZpZXcgPSBjb250ZXh0MiA/IGNvbnRleHQyLmxWaWV3IDogbnVsbDsKICAgIGlmIChsVmlldyA9PT0gbnVsbCkgewogICAgICByZXR1cm4ge307CiAgICB9CiAgICBjb25zdCB0Tm9kZUF0dHJzID0gbFZpZXdbVFZJRVddLmRhdGFbY29udGV4dDIubm9kZUluZGV4XS5hdHRyczsKICAgIGNvbnN0IGxvd2VyY2FzZVROb2RlQXR0cnMgPSBbXTsKICAgIGlmICh0Tm9kZUF0dHJzKSB7CiAgICAgIGxldCBpID0gMDsKICAgICAgd2hpbGUgKGkgPCB0Tm9kZUF0dHJzLmxlbmd0aCkgewogICAgICAgIGNvbnN0IGF0dHJOYW1lID0gdE5vZGVBdHRyc1tpXTsKICAgICAgICBpZiAodHlwZW9mIGF0dHJOYW1lICE9PSAic3RyaW5nIikgYnJlYWs7CiAgICAgICAgY29uc3QgYXR0clZhbHVlID0gdE5vZGVBdHRyc1tpICsgMV07CiAgICAgICAgYXR0cmlidXRlc1thdHRyTmFtZV0gPSBhdHRyVmFsdWU7CiAgICAgICAgbG93ZXJjYXNlVE5vZGVBdHRycy5wdXNoKGF0dHJOYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgICAgIGkgKz0gMjsKICAgICAgfQogICAgfQogICAgZm9yIChjb25zdCBhdHRyIG9mIGVsZW1lbnQuYXR0cmlidXRlcykgewogICAgICBpZiAoIWxvd2VyY2FzZVROb2RlQXR0cnMuaW5jbHVkZXMoYXR0ci5uYW1lKSkgewogICAgICAgIGF0dHJpYnV0ZXNbYXR0ci5uYW1lXSA9IGF0dHIudmFsdWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBhdHRyaWJ1dGVzOwogIH0KICBnZXQgc3R5bGVzKCkgewogICAgY29uc3QgZWxlbWVudCA9IHRoaXMubmF0aXZlRWxlbWVudDsKICAgIHJldHVybiBlbGVtZW50Py5zdHlsZSA/PyB7fTsKICB9CiAgZ2V0IGNsYXNzZXMoKSB7CiAgICBjb25zdCByZXN1bHQgPSB7fTsKICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLm5hdGl2ZUVsZW1lbnQ7CiAgICBjb25zdCBjbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZTsKICAgIGNvbnN0IGNsYXNzZXMgPSB0eXBlb2YgY2xhc3NOYW1lICE9PSAic3RyaW5nIiA/IGNsYXNzTmFtZS5iYXNlVmFsLnNwbGl0KCIgIikgOiBjbGFzc05hbWUuc3BsaXQoIiAiKTsKICAgIGNsYXNzZXMuZm9yRWFjaCgodmFsdWUpID0+IHJlc3VsdFt2YWx1ZV0gPSB0cnVlKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGdldCBjaGlsZE5vZGVzKCkgewogICAgY29uc3QgY2hpbGROb2RlcyA9IHRoaXMubmF0aXZlTm9kZS5jaGlsZE5vZGVzOwogICAgY29uc3QgY2hpbGRyZW4gPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBlbGVtZW50ID0gY2hpbGROb2Rlc1tpXTsKICAgICAgY2hpbGRyZW4ucHVzaChnZXREZWJ1Z05vZGUoZWxlbWVudCkpOwogICAgfQogICAgcmV0dXJuIGNoaWxkcmVuOwogIH0KICBnZXQgY2hpbGRyZW4oKSB7CiAgICBjb25zdCBuYXRpdmVFbGVtZW50ID0gdGhpcy5uYXRpdmVFbGVtZW50OwogICAgaWYgKCFuYXRpdmVFbGVtZW50KSByZXR1cm4gW107CiAgICBjb25zdCBjaGlsZE5vZGVzID0gbmF0aXZlRWxlbWVudC5jaGlsZHJlbjsKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgZWxlbWVudCA9IGNoaWxkTm9kZXNbaV07CiAgICAgIGNoaWxkcmVuLnB1c2goZ2V0RGVidWdOb2RlKGVsZW1lbnQpKTsKICAgIH0KICAgIHJldHVybiBjaGlsZHJlbjsKICB9CiAgcXVlcnkocHJlZGljYXRlKSB7CiAgICBjb25zdCByZXN1bHRzID0gdGhpcy5xdWVyeUFsbChwcmVkaWNhdGUpOwogICAgcmV0dXJuIHJlc3VsdHNbMF0gfHwgbnVsbDsKICB9CiAgcXVlcnlBbGwocHJlZGljYXRlKSB7CiAgICBjb25zdCBtYXRjaGVzID0gW107CiAgICBfcXVlcnlBbGwodGhpcywgcHJlZGljYXRlLCBtYXRjaGVzLCB0cnVlKTsKICAgIHJldHVybiBtYXRjaGVzOwogIH0KICBxdWVyeUFsbE5vZGVzKHByZWRpY2F0ZSkgewogICAgY29uc3QgbWF0Y2hlcyA9IFtdOwogICAgX3F1ZXJ5QWxsKHRoaXMsIHByZWRpY2F0ZSwgbWF0Y2hlcywgZmFsc2UpOwogICAgcmV0dXJuIG1hdGNoZXM7CiAgfQogIHRyaWdnZXJFdmVudEhhbmRsZXIoZXZlbnROYW1lLCBldmVudE9iaikgewogICAgY29uc3Qgbm9kZSA9IHRoaXMubmF0aXZlTm9kZTsKICAgIGNvbnN0IGludm9rZWRMaXN0ZW5lcnMgPSBbXTsKICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgIGlmIChsaXN0ZW5lci5uYW1lID09PSBldmVudE5hbWUpIHsKICAgICAgICBjb25zdCBjYWxsYmFjayA9IGxpc3RlbmVyLmNhbGxiYWNrOwogICAgICAgIGNhbGxiYWNrLmNhbGwobm9kZSwgZXZlbnRPYmopOwogICAgICAgIGludm9rZWRMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7CiAgICAgIH0KICAgIH0pOwogICAgaWYgKHR5cGVvZiBub2RlLmV2ZW50TGlzdGVuZXJzID09PSAiZnVuY3Rpb24iKSB7CiAgICAgIG5vZGUuZXZlbnRMaXN0ZW5lcnMoZXZlbnROYW1lKS5mb3JFYWNoKChsaXN0ZW5lcikgPT4gewogICAgICAgIGlmIChsaXN0ZW5lci50b1N0cmluZygpLmluZGV4T2YoIl9fbmdVbndyYXBfXyIpICE9PSAtMSkgewogICAgICAgICAgY29uc3QgdW53cmFwcGVkTGlzdGVuZXIgPSBsaXN0ZW5lcigiX19uZ1Vud3JhcF9fIik7CiAgICAgICAgICByZXR1cm4gaW52b2tlZExpc3RlbmVycy5pbmRleE9mKHVud3JhcHBlZExpc3RlbmVyKSA9PT0gLTEgJiYgdW53cmFwcGVkTGlzdGVuZXIuY2FsbChub2RlLCBldmVudE9iaik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07CmZ1bmN0aW9uIGNvcHlEb21Qcm9wZXJ0aWVzKGVsZW1lbnQsIHByb3BlcnRpZXMpIHsKICBpZiAoZWxlbWVudCkgewogICAgbGV0IG9iaiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihlbGVtZW50KTsKICAgIGNvbnN0IE5vZGVQcm90b3R5cGUgPSBOb2RlLnByb3RvdHlwZTsKICAgIHdoaWxlIChvYmogIT09IG51bGwgJiYgb2JqICE9PSBOb2RlUHJvdG90eXBlKSB7CiAgICAgIGNvbnN0IGRlc2NyaXB0b3JzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMob2JqKTsKICAgICAgZm9yIChsZXQga2V5IGluIGRlc2NyaXB0b3JzKSB7CiAgICAgICAgaWYgKCFrZXkuc3RhcnRzV2l0aCgiX18iKSAmJiAha2V5LnN0YXJ0c1dpdGgoIm9uIikpIHsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gZWxlbWVudFtrZXldOwogICAgICAgICAgaWYgKGlzUHJpbWl0aXZlVmFsdWUodmFsdWUpKSB7CiAgICAgICAgICAgIHByb3BlcnRpZXNba2V5XSA9IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBvYmogPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gaXNQcmltaXRpdmVWYWx1ZSh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciIHx8IHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iIHx8IHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIgfHwgdmFsdWUgPT09IG51bGw7Cn0KZnVuY3Rpb24gX3F1ZXJ5QWxsKHBhcmVudEVsZW1lbnQsIHByZWRpY2F0ZSwgbWF0Y2hlcywgZWxlbWVudHNPbmx5KSB7CiAgY29uc3QgY29udGV4dDIgPSBnZXRMQ29udGV4dChwYXJlbnRFbGVtZW50Lm5hdGl2ZU5vZGUpOwogIGNvbnN0IGxWaWV3ID0gY29udGV4dDIgPyBjb250ZXh0Mi5sVmlldyA6IG51bGw7CiAgaWYgKGxWaWV3ICE9PSBudWxsKSB7CiAgICBjb25zdCBwYXJlbnRUTm9kZSA9IGxWaWV3W1RWSUVXXS5kYXRhW2NvbnRleHQyLm5vZGVJbmRleF07CiAgICBfcXVlcnlOb2RlQ2hpbGRyZW4ocGFyZW50VE5vZGUsIGxWaWV3LCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSwgcGFyZW50RWxlbWVudC5uYXRpdmVOb2RlKTsKICB9IGVsc2UgewogICAgX3F1ZXJ5TmF0aXZlTm9kZURlc2NlbmRhbnRzKHBhcmVudEVsZW1lbnQubmF0aXZlTm9kZSwgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHkpOwogIH0KfQpmdW5jdGlvbiBfcXVlcnlOb2RlQ2hpbGRyZW4odE5vZGUsIGxWaWV3LCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSwgcm9vdE5hdGl2ZU5vZGUpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGVGb3JMVmlldyh0Tm9kZSwgbFZpZXcpOwogIGNvbnN0IG5hdGl2ZU5vZGUgPSBnZXROYXRpdmVCeVROb2RlT3JOdWxsKHROb2RlLCBsVmlldyk7CiAgaWYgKHROb2RlLnR5cGUgJiAoMyB8IDgpKSB7CiAgICBfYWRkUXVlcnlNYXRjaChuYXRpdmVOb2RlLCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSwgcm9vdE5hdGl2ZU5vZGUpOwogICAgaWYgKGlzQ29tcG9uZW50SG9zdCh0Tm9kZSkpIHsKICAgICAgY29uc3QgY29tcG9uZW50VmlldyA9IGdldENvbXBvbmVudExWaWV3QnlJbmRleCh0Tm9kZS5pbmRleCwgbFZpZXcpOwogICAgICBpZiAoY29tcG9uZW50VmlldyAmJiBjb21wb25lbnRWaWV3W1RWSUVXXS5maXJzdENoaWxkKSB7CiAgICAgICAgX3F1ZXJ5Tm9kZUNoaWxkcmVuKGNvbXBvbmVudFZpZXdbVFZJRVddLmZpcnN0Q2hpbGQsIGNvbXBvbmVudFZpZXcsIHByZWRpY2F0ZSwgbWF0Y2hlcywgZWxlbWVudHNPbmx5LCByb290TmF0aXZlTm9kZSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmICh0Tm9kZS5jaGlsZCkgewogICAgICAgIF9xdWVyeU5vZGVDaGlsZHJlbih0Tm9kZS5jaGlsZCwgbFZpZXcsIHByZWRpY2F0ZSwgbWF0Y2hlcywgZWxlbWVudHNPbmx5LCByb290TmF0aXZlTm9kZSk7CiAgICAgIH0KICAgICAgbmF0aXZlTm9kZSAmJiBfcXVlcnlOYXRpdmVOb2RlRGVzY2VuZGFudHMobmF0aXZlTm9kZSwgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHkpOwogICAgfQogICAgY29uc3Qgbm9kZU9yQ29udGFpbmVyID0gbFZpZXdbdE5vZGUuaW5kZXhdOwogICAgaWYgKGlzTENvbnRhaW5lcihub2RlT3JDb250YWluZXIpKSB7CiAgICAgIF9xdWVyeU5vZGVDaGlsZHJlbkluQ29udGFpbmVyKG5vZGVPckNvbnRhaW5lciwgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHksIHJvb3ROYXRpdmVOb2RlKTsKICAgIH0KICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiA0KSB7CiAgICBjb25zdCBsQ29udGFpbmVyID0gbFZpZXdbdE5vZGUuaW5kZXhdOwogICAgX2FkZFF1ZXJ5TWF0Y2gobENvbnRhaW5lcltOQVRJVkVdLCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSwgcm9vdE5hdGl2ZU5vZGUpOwogICAgX3F1ZXJ5Tm9kZUNoaWxkcmVuSW5Db250YWluZXIobENvbnRhaW5lciwgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHksIHJvb3ROYXRpdmVOb2RlKTsKICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiAxNikgewogICAgY29uc3QgY29tcG9uZW50VmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICAgIGNvbnN0IGNvbXBvbmVudEhvc3QgPSBjb21wb25lbnRWaWV3W1RfSE9TVF07CiAgICBjb25zdCBoZWFkID0gY29tcG9uZW50SG9zdC5wcm9qZWN0aW9uW3ROb2RlLnByb2plY3Rpb25dOwogICAgaWYgKEFycmF5LmlzQXJyYXkoaGVhZCkpIHsKICAgICAgZm9yIChsZXQgbmF0aXZlTm9kZTIgb2YgaGVhZCkgewogICAgICAgIF9hZGRRdWVyeU1hdGNoKG5hdGl2ZU5vZGUyLCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSwgcm9vdE5hdGl2ZU5vZGUpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGhlYWQpIHsKICAgICAgY29uc3QgbmV4dExWaWV3ID0gY29tcG9uZW50Vmlld1tQQVJFTlRdOwogICAgICBjb25zdCBuZXh0VE5vZGUgPSBuZXh0TFZpZXdbVFZJRVddLmRhdGFbaGVhZC5pbmRleF07CiAgICAgIF9xdWVyeU5vZGVDaGlsZHJlbihuZXh0VE5vZGUsIG5leHRMVmlldywgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHksIHJvb3ROYXRpdmVOb2RlKTsKICAgIH0KICB9IGVsc2UgaWYgKHROb2RlLmNoaWxkKSB7CiAgICBfcXVlcnlOb2RlQ2hpbGRyZW4odE5vZGUuY2hpbGQsIGxWaWV3LCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSwgcm9vdE5hdGl2ZU5vZGUpOwogIH0KICBpZiAocm9vdE5hdGl2ZU5vZGUgIT09IG5hdGl2ZU5vZGUpIHsKICAgIGNvbnN0IG5leHRUTm9kZSA9IHROb2RlLmZsYWdzICYgMiA/IHROb2RlLnByb2plY3Rpb25OZXh0IDogdE5vZGUubmV4dDsKICAgIGlmIChuZXh0VE5vZGUpIHsKICAgICAgX3F1ZXJ5Tm9kZUNoaWxkcmVuKG5leHRUTm9kZSwgbFZpZXcsIHByZWRpY2F0ZSwgbWF0Y2hlcywgZWxlbWVudHNPbmx5LCByb290TmF0aXZlTm9kZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIF9xdWVyeU5vZGVDaGlsZHJlbkluQ29udGFpbmVyKGxDb250YWluZXIsIHByZWRpY2F0ZSwgbWF0Y2hlcywgZWxlbWVudHNPbmx5LCByb290TmF0aXZlTm9kZSkgewogIGZvciAobGV0IGkgPSBDT05UQUlORVJfSEVBREVSX09GRlNFVDsgaSA8IGxDb250YWluZXIubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGNoaWxkVmlldyA9IGxDb250YWluZXJbaV07CiAgICBjb25zdCBmaXJzdENoaWxkID0gY2hpbGRWaWV3W1RWSUVXXS5maXJzdENoaWxkOwogICAgaWYgKGZpcnN0Q2hpbGQpIHsKICAgICAgX3F1ZXJ5Tm9kZUNoaWxkcmVuKGZpcnN0Q2hpbGQsIGNoaWxkVmlldywgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHksIHJvb3ROYXRpdmVOb2RlKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gX2FkZFF1ZXJ5TWF0Y2gobmF0aXZlTm9kZSwgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHksIHJvb3ROYXRpdmVOb2RlKSB7CiAgaWYgKHJvb3ROYXRpdmVOb2RlICE9PSBuYXRpdmVOb2RlKSB7CiAgICBjb25zdCBkZWJ1Z05vZGUgPSBnZXREZWJ1Z05vZGUobmF0aXZlTm9kZSk7CiAgICBpZiAoIWRlYnVnTm9kZSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoZWxlbWVudHNPbmx5ICYmIGRlYnVnTm9kZSBpbnN0YW5jZW9mIERlYnVnRWxlbWVudCAmJiBwcmVkaWNhdGUoZGVidWdOb2RlKSAmJiBtYXRjaGVzLmluZGV4T2YoZGVidWdOb2RlKSA9PT0gLTEpIHsKICAgICAgbWF0Y2hlcy5wdXNoKGRlYnVnTm9kZSk7CiAgICB9IGVsc2UgaWYgKCFlbGVtZW50c09ubHkgJiYgcHJlZGljYXRlKGRlYnVnTm9kZSkgJiYgbWF0Y2hlcy5pbmRleE9mKGRlYnVnTm9kZSkgPT09IC0xKSB7CiAgICAgIG1hdGNoZXMucHVzaChkZWJ1Z05vZGUpOwogICAgfQogIH0KfQpmdW5jdGlvbiBfcXVlcnlOYXRpdmVOb2RlRGVzY2VuZGFudHMocGFyZW50Tm9kZSwgcHJlZGljYXRlLCBtYXRjaGVzLCBlbGVtZW50c09ubHkpIHsKICBjb25zdCBub2RlcyA9IHBhcmVudE5vZGUuY2hpbGROb2RlczsKICBjb25zdCBsZW5ndGggPSBub2Rlcy5sZW5ndGg7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwogICAgY29uc3QgZGVidWdOb2RlID0gZ2V0RGVidWdOb2RlKG5vZGUpOwogICAgaWYgKGRlYnVnTm9kZSkgewogICAgICBpZiAoZWxlbWVudHNPbmx5ICYmIGRlYnVnTm9kZSBpbnN0YW5jZW9mIERlYnVnRWxlbWVudCAmJiBwcmVkaWNhdGUoZGVidWdOb2RlKSAmJiBtYXRjaGVzLmluZGV4T2YoZGVidWdOb2RlKSA9PT0gLTEpIHsKICAgICAgICBtYXRjaGVzLnB1c2goZGVidWdOb2RlKTsKICAgICAgfSBlbHNlIGlmICghZWxlbWVudHNPbmx5ICYmIHByZWRpY2F0ZShkZWJ1Z05vZGUpICYmIG1hdGNoZXMuaW5kZXhPZihkZWJ1Z05vZGUpID09PSAtMSkgewogICAgICAgIG1hdGNoZXMucHVzaChkZWJ1Z05vZGUpOwogICAgICB9CiAgICAgIF9xdWVyeU5hdGl2ZU5vZGVEZXNjZW5kYW50cyhub2RlLCBwcmVkaWNhdGUsIG1hdGNoZXMsIGVsZW1lbnRzT25seSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGNvbGxlY3RQcm9wZXJ0eUJpbmRpbmdzKHByb3BlcnRpZXMsIHROb2RlLCBsVmlldywgdERhdGEpIHsKICBsZXQgYmluZGluZ0luZGV4ZXMgPSB0Tm9kZS5wcm9wZXJ0eUJpbmRpbmdzOwogIGlmIChiaW5kaW5nSW5kZXhlcyAhPT0gbnVsbCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5kaW5nSW5kZXhlcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBiaW5kaW5nSW5kZXggPSBiaW5kaW5nSW5kZXhlc1tpXTsKICAgICAgY29uc3QgcHJvcE1ldGFkYXRhID0gdERhdGFbYmluZGluZ0luZGV4XTsKICAgICAgY29uc3QgbWV0YWRhdGFQYXJ0cyA9IHByb3BNZXRhZGF0YS5zcGxpdChJTlRFUlBPTEFUSU9OX0RFTElNSVRFUik7CiAgICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IG1ldGFkYXRhUGFydHNbMF07CiAgICAgIGlmIChtZXRhZGF0YVBhcnRzLmxlbmd0aCA+IDEpIHsKICAgICAgICBsZXQgdmFsdWUgPSBtZXRhZGF0YVBhcnRzWzFdOwogICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgbWV0YWRhdGFQYXJ0cy5sZW5ndGggLSAxOyBqKyspIHsKICAgICAgICAgIHZhbHVlICs9IHJlbmRlclN0cmluZ2lmeShsVmlld1tiaW5kaW5nSW5kZXggKyBqIC0gMV0pICsgbWV0YWRhdGFQYXJ0c1tqICsgMV07CiAgICAgICAgfQogICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHlOYW1lXSA9IHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHlOYW1lXSA9IGxWaWV3W2JpbmRpbmdJbmRleF07CiAgICAgIH0KICAgIH0KICB9Cn0KdmFyIE5HX0RFQlVHX1BST1BFUlRZID0gIl9fbmdfZGVidWdfXyI7CmZ1bmN0aW9uIGdldERlYnVnTm9kZShuYXRpdmVOb2RlKSB7CiAgaWYgKG5hdGl2ZU5vZGUgaW5zdGFuY2VvZiBOb2RlKSB7CiAgICBpZiAoIW5hdGl2ZU5vZGUuaGFzT3duUHJvcGVydHkoTkdfREVCVUdfUFJPUEVSVFkpKSB7CiAgICAgIG5hdGl2ZU5vZGVbTkdfREVCVUdfUFJPUEVSVFldID0gbmF0aXZlTm9kZS5ub2RlVHlwZSA9PSBOb2RlLkVMRU1FTlRfTk9ERSA/IG5ldyBEZWJ1Z0VsZW1lbnQobmF0aXZlTm9kZSkgOiBuZXcgRGVidWdOb2RlKG5hdGl2ZU5vZGUpOwogICAgfQogICAgcmV0dXJuIG5hdGl2ZU5vZGVbTkdfREVCVUdfUFJPUEVSVFldOwogIH0KICByZXR1cm4gbnVsbDsKfQoKLy8gbm9kZV9tb2R1bGVzL0Bhbmd1bGFyL2NvcmUvZmVzbTIwMjIvX3Jlc291cmNlLWNodW5rLm1qcwp2YXIgT3V0cHV0RW1pdHRlclJlZiA9IGNsYXNzIHsKICBkZXN0cm95ZWQgPSBmYWxzZTsKICBsaXN0ZW5lcnMgPSBudWxsOwogIGVycm9ySGFuZGxlciA9IGluamVjdDIoRXJyb3JIYW5kbGVyLCB7CiAgICBvcHRpb25hbDogdHJ1ZQogIH0pOwogIGRlc3Ryb3lSZWYgPSBpbmplY3QyKERlc3Ryb3lSZWYpOwogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5kZXN0cm95UmVmLm9uRGVzdHJveSgoKSA9PiB7CiAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTsKICAgICAgdGhpcy5saXN0ZW5lcnMgPSBudWxsOwogICAgfSk7CiAgfQogIHN1YnNjcmliZShjYWxsYmFjaykgewogICAgaWYgKHRoaXMuZGVzdHJveWVkKSB7CiAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTUzLCBuZ0Rldk1vZGUgJiYgIlVuZXhwZWN0ZWQgc3Vic2NyaXB0aW9uIHRvIGRlc3Ryb3llZCBgT3V0cHV0UmVmYC4gVGhlIG93bmluZyBkaXJlY3RpdmUvY29tcG9uZW50IGlzIGRlc3Ryb3llZC4iKTsKICAgIH0KICAgICh0aGlzLmxpc3RlbmVycyA/Pz0gW10pLnB1c2goY2FsbGJhY2spOwogICAgcmV0dXJuIHsKICAgICAgdW5zdWJzY3JpYmU6ICgpID0+IHsKICAgICAgICBjb25zdCBpZHggPSB0aGlzLmxpc3RlbmVycz8uaW5kZXhPZihjYWxsYmFjayk7CiAgICAgICAgaWYgKGlkeCAhPT0gdm9pZCAwICYmIGlkeCAhPT0gLTEpIHsKICAgICAgICAgIHRoaXMubGlzdGVuZXJzPy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQogIGVtaXQodmFsdWUpIHsKICAgIGlmICh0aGlzLmRlc3Ryb3llZCkgewogICAgICBjb25zb2xlLndhcm4oZm9ybWF0UnVudGltZUVycm9yKDk1MywgbmdEZXZNb2RlICYmICJVbmV4cGVjdGVkIGVtaXQgZm9yIGRlc3Ryb3llZCBgT3V0cHV0UmVmYC4gVGhlIG93bmluZyBkaXJlY3RpdmUvY29tcG9uZW50IGlzIGRlc3Ryb3llZC4iKSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0aGlzLmxpc3RlbmVycyA9PT0gbnVsbCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCBwcmV2aW91c0NvbnN1bWVyID0gc2V0QWN0aXZlQ29uc3VtZXIobnVsbCk7CiAgICB0cnkgewogICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHsKICAgICAgICB0cnkgewogICAgICAgICAgbGlzdGVuZXJGbih2YWx1ZSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICB0aGlzLmVycm9ySGFuZGxlcj8uaGFuZGxlRXJyb3IoZXJyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEFjdGl2ZUNvbnN1bWVyKHByZXZpb3VzQ29uc3VtZXIpOwogICAgfQogIH0KfTsKZnVuY3Rpb24gZ2V0T3V0cHV0RGVzdHJveVJlZihyZWYpIHsKICByZXR1cm4gcmVmLmRlc3Ryb3lSZWY7Cn0KZnVuY3Rpb24gY29tcHV0ZWQoY29tcHV0YXRpb24sIG9wdGlvbnMpIHsKICBjb25zdCBnZXR0ZXIgPSBjcmVhdGVDb21wdXRlZChjb21wdXRhdGlvbiwgb3B0aW9ucz8uZXF1YWwpOwogIGlmIChuZ0Rldk1vZGUpIHsKICAgIGdldHRlci50b1N0cmluZyA9ICgpID0+IGBbQ29tcHV0ZWQ6ICR7Z2V0dGVyKCl9XWA7CiAgICBnZXR0ZXJbU0lHTkFMXS5kZWJ1Z05hbWUgPSBvcHRpb25zPy5kZWJ1Z05hbWU7CiAgfQogIHJldHVybiBnZXR0ZXI7Cn0KdmFyIGlkZW50aXR5Rm4gPSAodikgPT4gdjsKZnVuY3Rpb24gbGlua2VkU2lnbmFsKG9wdGlvbnNPckNvbXB1dGF0aW9uLCBvcHRpb25zKSB7CiAgaWYgKHR5cGVvZiBvcHRpb25zT3JDb21wdXRhdGlvbiA9PT0gImZ1bmN0aW9uIikgewogICAgY29uc3QgZ2V0dGVyID0gY3JlYXRlTGlua2VkU2lnbmFsKG9wdGlvbnNPckNvbXB1dGF0aW9uLCBpZGVudGl0eUZuLCBvcHRpb25zPy5lcXVhbCk7CiAgICByZXR1cm4gdXBncmFkZUxpbmtlZFNpZ25hbEdldHRlcihnZXR0ZXIsIG9wdGlvbnM/LmRlYnVnTmFtZSk7CiAgfSBlbHNlIHsKICAgIGNvbnN0IGdldHRlciA9IGNyZWF0ZUxpbmtlZFNpZ25hbChvcHRpb25zT3JDb21wdXRhdGlvbi5zb3VyY2UsIG9wdGlvbnNPckNvbXB1dGF0aW9uLmNvbXB1dGF0aW9uLCBvcHRpb25zT3JDb21wdXRhdGlvbi5lcXVhbCk7CiAgICByZXR1cm4gdXBncmFkZUxpbmtlZFNpZ25hbEdldHRlcihnZXR0ZXIsIG9wdGlvbnNPckNvbXB1dGF0aW9uLmRlYnVnTmFtZSk7CiAgfQp9CmZ1bmN0aW9uIHVwZ3JhZGVMaW5rZWRTaWduYWxHZXR0ZXIoZ2V0dGVyLCBkZWJ1Z05hbWUpIHsKICBpZiAobmdEZXZNb2RlKSB7CiAgICBnZXR0ZXIudG9TdHJpbmcgPSAoKSA9PiBgW0xpbmtlZFNpZ25hbDogJHtnZXR0ZXIoKX1dYDsKICAgIGdldHRlcltTSUdOQUxdLmRlYnVnTmFtZSA9IGRlYnVnTmFtZTsKICB9CiAgY29uc3Qgbm9kZSA9IGdldHRlcltTSUdOQUxdOwogIGNvbnN0IHVwZ3JhZGVkR2V0dGVyID0gZ2V0dGVyOwogIHVwZ3JhZGVkR2V0dGVyLnNldCA9IChuZXdWYWx1ZSkgPT4gbGlua2VkU2lnbmFsU2V0Rm4obm9kZSwgbmV3VmFsdWUpOwogIHVwZ3JhZGVkR2V0dGVyLnVwZGF0ZSA9ICh1cGRhdGVGbikgPT4gbGlua2VkU2lnbmFsVXBkYXRlRm4obm9kZSwgdXBkYXRlRm4pOwogIHVwZ3JhZGVkR2V0dGVyLmFzUmVhZG9ubHkgPSBzaWduYWxBc1JlYWRvbmx5Rm4uYmluZChnZXR0ZXIpOwogIHJldHVybiB1cGdyYWRlZEdldHRlcjsKfQpmdW5jdGlvbiByZXNvdXJjZShvcHRpb25zKSB7CiAgaWYgKG5nRGV2TW9kZSAmJiAhb3B0aW9ucz8uaW5qZWN0b3IpIHsKICAgIGFzc2VydEluSW5qZWN0aW9uQ29udGV4dChyZXNvdXJjZSk7CiAgfQogIGNvbnN0IG9sZE5hbWVGb3JQYXJhbXMgPSBvcHRpb25zLnJlcXVlc3Q7CiAgY29uc3QgcGFyYW1zID0gb3B0aW9ucy5wYXJhbXMgPz8gb2xkTmFtZUZvclBhcmFtcyA/PyAoKCkgPT4gbnVsbCk7CiAgcmV0dXJuIG5ldyBSZXNvdXJjZUltcGwocGFyYW1zLCBnZXRMb2FkZXIob3B0aW9ucyksIG9wdGlvbnMuZGVmYXVsdFZhbHVlLCBvcHRpb25zLmVxdWFsID8gd3JhcEVxdWFsaXR5Rm4ob3B0aW9ucy5lcXVhbCkgOiB2b2lkIDAsIG9wdGlvbnMuZGVidWdOYW1lLCBvcHRpb25zLmluamVjdG9yID8/IGluamVjdDIoSW5qZWN0b3IpKTsKfQp2YXIgQmFzZVdyaXRhYmxlUmVzb3VyY2UgPSBjbGFzcyB7CiAgdmFsdWU7CiAgaXNMb2FkaW5nOwogIGNvbnN0cnVjdG9yKHZhbHVlLCBkZWJ1Z05hbWUpIHsKICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgIHRoaXMudmFsdWUuc2V0ID0gdGhpcy5zZXQuYmluZCh0aGlzKTsKICAgIHRoaXMudmFsdWUudXBkYXRlID0gdGhpcy51cGRhdGUuYmluZCh0aGlzKTsKICAgIHRoaXMudmFsdWUuYXNSZWFkb25seSA9IHNpZ25hbEFzUmVhZG9ubHlGbjsKICAgIHRoaXMuaXNMb2FkaW5nID0gY29tcHV0ZWQoKCkgPT4gdGhpcy5zdGF0dXMoKSA9PT0gImxvYWRpbmciIHx8IHRoaXMuc3RhdHVzKCkgPT09ICJyZWxvYWRpbmciLCBuZ0Rldk1vZGUgPyBjcmVhdGVEZWJ1Z05hbWVPYmplY3QoZGVidWdOYW1lLCAiaXNMb2FkaW5nIikgOiB2b2lkIDApOwogIH0KICBpc0Vycm9yID0gY29tcHV0ZWQoKCkgPT4gdGhpcy5zdGF0dXMoKSA9PT0gImVycm9yIik7CiAgdXBkYXRlKHVwZGF0ZUZuKSB7CiAgICB0aGlzLnNldCh1cGRhdGVGbih1bnRyYWNrZWQyKHRoaXMudmFsdWUpKSk7CiAgfQogIGlzVmFsdWVEZWZpbmVkID0gY29tcHV0ZWQoKCkgPT4gewogICAgaWYgKHRoaXMuaXNFcnJvcigpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0aGlzLnZhbHVlKCkgIT09IHZvaWQgMDsKICB9KTsKICBoYXNWYWx1ZSgpIHsKICAgIHJldHVybiB0aGlzLmlzVmFsdWVEZWZpbmVkKCk7CiAgfQogIGFzUmVhZG9ubHkoKSB7CiAgICByZXR1cm4gdGhpczsKICB9Cn07CnZhciBSZXNvdXJjZUltcGwgPSBjbGFzcyBleHRlbmRzIEJhc2VXcml0YWJsZVJlc291cmNlIHsKICBsb2FkZXJGbjsKICBlcXVhbDsKICBkZWJ1Z05hbWU7CiAgcGVuZGluZ1Rhc2tzOwogIHN0YXRlOwogIGV4dFJlcXVlc3Q7CiAgZWZmZWN0UmVmOwogIHBlbmRpbmdDb250cm9sbGVyOwogIHJlc29sdmVQZW5kaW5nVGFzayA9IHZvaWQgMDsKICBkZXN0cm95ZWQgPSBmYWxzZTsKICB1bnJlZ2lzdGVyT25EZXN0cm95OwogIHN0YXR1czsKICBlcnJvcjsKICBjb25zdHJ1Y3RvcihyZXF1ZXN0LCBsb2FkZXJGbiwgZGVmYXVsdFZhbHVlLCBlcXVhbCwgZGVidWdOYW1lLCBpbmplY3RvcikgewogICAgc3VwZXIoY29tcHV0ZWQoKCkgPT4gewogICAgICBjb25zdCBzdHJlYW1WYWx1ZSA9IHRoaXMuc3RhdGUoKS5zdHJlYW0/LigpOwogICAgICBpZiAoIXN0cmVhbVZhbHVlKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTsKICAgICAgfQogICAgICBpZiAodGhpcy5zdGF0ZSgpLnN0YXR1cyA9PT0gImxvYWRpbmciICYmIHRoaXMuZXJyb3IoKSkgewogICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7CiAgICAgIH0KICAgICAgaWYgKCFpc1Jlc29sdmVkKHN0cmVhbVZhbHVlKSkgewogICAgICAgIHRocm93IG5ldyBSZXNvdXJjZVZhbHVlRXJyb3IodGhpcy5lcnJvcigpKTsKICAgICAgfQogICAgICByZXR1cm4gc3RyZWFtVmFsdWUudmFsdWU7CiAgICB9LCBfX3NwcmVhZFZhbHVlcyh7CiAgICAgIGVxdWFsCiAgICB9LCBuZ0Rldk1vZGUgPyBjcmVhdGVEZWJ1Z05hbWVPYmplY3QoZGVidWdOYW1lLCAidmFsdWUiKSA6IHZvaWQgMCkpLCBkZWJ1Z05hbWUpOwogICAgdGhpcy5sb2FkZXJGbiA9IGxvYWRlckZuOwogICAgdGhpcy5lcXVhbCA9IGVxdWFsOwogICAgdGhpcy5kZWJ1Z05hbWUgPSBkZWJ1Z05hbWU7CiAgICB0aGlzLmV4dFJlcXVlc3QgPSBsaW5rZWRTaWduYWwoX19zcHJlYWRWYWx1ZXMoewogICAgICBzb3VyY2U6IHJlcXVlc3QsCiAgICAgIGNvbXB1dGF0aW9uOiAocmVxdWVzdDIpID0+ICh7CiAgICAgICAgcmVxdWVzdDogcmVxdWVzdDIsCiAgICAgICAgcmVsb2FkOiAwCiAgICAgIH0pCiAgICB9LCBuZ0Rldk1vZGUgPyBjcmVhdGVEZWJ1Z05hbWVPYmplY3QoZGVidWdOYW1lLCAiZXh0UmVxdWVzdCIpIDogdm9pZCAwKSk7CiAgICB0aGlzLnN0YXRlID0gbGlua2VkU2lnbmFsKF9fc3ByZWFkVmFsdWVzKHsKICAgICAgc291cmNlOiB0aGlzLmV4dFJlcXVlc3QsCiAgICAgIGNvbXB1dGF0aW9uOiAoZXh0UmVxdWVzdCwgcHJldmlvdXMpID0+IHsKICAgICAgICBjb25zdCBzdGF0dXMgPSBleHRSZXF1ZXN0LnJlcXVlc3QgPT09IHZvaWQgMCA/ICJpZGxlIiA6ICJsb2FkaW5nIjsKICAgICAgICBpZiAoIXByZXZpb3VzKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBleHRSZXF1ZXN0LAogICAgICAgICAgICBzdGF0dXMsCiAgICAgICAgICAgIHByZXZpb3VzU3RhdHVzOiAiaWRsZSIsCiAgICAgICAgICAgIHN0cmVhbTogdm9pZCAwCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBleHRSZXF1ZXN0LAogICAgICAgICAgICBzdGF0dXMsCiAgICAgICAgICAgIHByZXZpb3VzU3RhdHVzOiBwcm9qZWN0U3RhdHVzT2ZTdGF0ZShwcmV2aW91cy52YWx1ZSksCiAgICAgICAgICAgIHN0cmVhbTogcHJldmlvdXMudmFsdWUuZXh0UmVxdWVzdC5yZXF1ZXN0ID09PSBleHRSZXF1ZXN0LnJlcXVlc3QgPyBwcmV2aW91cy52YWx1ZS5zdHJlYW0gOiB2b2lkIDAKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CiAgICB9LCBuZ0Rldk1vZGUgPyBjcmVhdGVEZWJ1Z05hbWVPYmplY3QoZGVidWdOYW1lLCAic3RhdGUiKSA6IHZvaWQgMCkpOwogICAgdGhpcy5lZmZlY3RSZWYgPSBlZmZlY3QodGhpcy5sb2FkRWZmZWN0LmJpbmQodGhpcyksIF9fc3ByZWFkVmFsdWVzKHsKICAgICAgaW5qZWN0b3IsCiAgICAgIG1hbnVhbENsZWFudXA6IHRydWUKICAgIH0sIG5nRGV2TW9kZSA/IGNyZWF0ZURlYnVnTmFtZU9iamVjdChkZWJ1Z05hbWUsICJsb2FkRWZmZWN0IikgOiB2b2lkIDApKTsKICAgIHRoaXMucGVuZGluZ1Rhc2tzID0gaW5qZWN0b3IuZ2V0KFBlbmRpbmdUYXNrcyk7CiAgICB0aGlzLnVucmVnaXN0ZXJPbkRlc3Ryb3kgPSBpbmplY3Rvci5nZXQoRGVzdHJveVJlZikub25EZXN0cm95KCgpID0+IHRoaXMuZGVzdHJveSgpKTsKICAgIHRoaXMuc3RhdHVzID0gY29tcHV0ZWQoKCkgPT4gcHJvamVjdFN0YXR1c09mU3RhdGUodGhpcy5zdGF0ZSgpKSwgbmdEZXZNb2RlID8gY3JlYXRlRGVidWdOYW1lT2JqZWN0KGRlYnVnTmFtZSwgInN0YXR1cyIpIDogdm9pZCAwKTsKICAgIHRoaXMuZXJyb3IgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RhdGUoKS5zdHJlYW0/LigpOwogICAgICByZXR1cm4gc3RyZWFtICYmICFpc1Jlc29sdmVkKHN0cmVhbSkgPyBzdHJlYW0uZXJyb3IgOiB2b2lkIDA7CiAgICB9LCBuZ0Rldk1vZGUgPyBjcmVhdGVEZWJ1Z05hbWVPYmplY3QoZGVidWdOYW1lLCAiZXJyb3IiKSA6IHZvaWQgMCk7CiAgfQogIHNldCh2YWx1ZSkgewogICAgaWYgKHRoaXMuZGVzdHJveWVkKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IGVycm9yID0gdW50cmFja2VkMih0aGlzLmVycm9yKTsKICAgIGNvbnN0IHN0YXRlID0gdW50cmFja2VkMih0aGlzLnN0YXRlKTsKICAgIGlmICghZXJyb3IpIHsKICAgICAgY29uc3QgY3VycmVudCA9IHVudHJhY2tlZDIodGhpcy52YWx1ZSk7CiAgICAgIGlmIChzdGF0ZS5zdGF0dXMgPT09ICJsb2NhbCIgJiYgKHRoaXMuZXF1YWwgPyB0aGlzLmVxdWFsKGN1cnJlbnQsIHZhbHVlKSA6IGN1cnJlbnQgPT09IHZhbHVlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogICAgdGhpcy5zdGF0ZS5zZXQoewogICAgICBleHRSZXF1ZXN0OiBzdGF0ZS5leHRSZXF1ZXN0LAogICAgICBzdGF0dXM6ICJsb2NhbCIsCiAgICAgIHByZXZpb3VzU3RhdHVzOiAibG9jYWwiLAogICAgICBzdHJlYW06IHNpZ25hbCh7CiAgICAgICAgdmFsdWUKICAgICAgfSwgbmdEZXZNb2RlID8gY3JlYXRlRGVidWdOYW1lT2JqZWN0KHRoaXMuZGVidWdOYW1lLCAic3RyZWFtIikgOiB2b2lkIDApCiAgICB9KTsKICAgIHRoaXMuYWJvcnRJblByb2dyZXNzTG9hZCgpOwogIH0KICByZWxvYWQoKSB7CiAgICBjb25zdCB7CiAgICAgIHN0YXR1cwogICAgfSA9IHVudHJhY2tlZDIodGhpcy5zdGF0ZSk7CiAgICBpZiAoc3RhdHVzID09PSAiaWRsZSIgfHwgc3RhdHVzID09PSAibG9hZGluZyIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdGhpcy5leHRSZXF1ZXN0LnVwZGF0ZSgoewogICAgICByZXF1ZXN0LAogICAgICByZWxvYWQKICAgIH0pID0+ICh7CiAgICAgIHJlcXVlc3QsCiAgICAgIHJlbG9hZDogcmVsb2FkICsgMQogICAgfSkpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGRlc3Ryb3koKSB7CiAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7CiAgICB0aGlzLnVucmVnaXN0ZXJPbkRlc3Ryb3koKTsKICAgIHRoaXMuZWZmZWN0UmVmLmRlc3Ryb3koKTsKICAgIHRoaXMuYWJvcnRJblByb2dyZXNzTG9hZCgpOwogICAgdGhpcy5zdGF0ZS5zZXQoewogICAgICBleHRSZXF1ZXN0OiB7CiAgICAgICAgcmVxdWVzdDogdm9pZCAwLAogICAgICAgIHJlbG9hZDogMAogICAgICB9LAogICAgICBzdGF0dXM6ICJpZGxlIiwKICAgICAgcHJldmlvdXNTdGF0dXM6ICJpZGxlIiwKICAgICAgc3RyZWFtOiB2b2lkIDAKICAgIH0pOwogIH0KICBhc3luYyBsb2FkRWZmZWN0KCkgewogICAgY29uc3QgZXh0UmVxdWVzdCA9IHRoaXMuZXh0UmVxdWVzdCgpOwogICAgY29uc3QgewogICAgICBzdGF0dXM6IGN1cnJlbnRTdGF0dXMsCiAgICAgIHByZXZpb3VzU3RhdHVzCiAgICB9ID0gdW50cmFja2VkMih0aGlzLnN0YXRlKTsKICAgIGlmIChleHRSZXF1ZXN0LnJlcXVlc3QgPT09IHZvaWQgMCkgewogICAgICByZXR1cm47CiAgICB9IGVsc2UgaWYgKGN1cnJlbnRTdGF0dXMgIT09ICJsb2FkaW5nIikgewogICAgICByZXR1cm47CiAgICB9CiAgICB0aGlzLmFib3J0SW5Qcm9ncmVzc0xvYWQoKTsKICAgIGxldCByZXNvbHZlUGVuZGluZ1Rhc2sgPSB0aGlzLnJlc29sdmVQZW5kaW5nVGFzayA9IHRoaXMucGVuZGluZ1Rhc2tzLmFkZCgpOwogICAgY29uc3QgewogICAgICBzaWduYWw6IGFib3J0U2lnbmFsCiAgICB9ID0gdGhpcy5wZW5kaW5nQ29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IHVudHJhY2tlZDIoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLmxvYWRlckZuKHsKICAgICAgICAgIHBhcmFtczogZXh0UmVxdWVzdC5yZXF1ZXN0LAogICAgICAgICAgcmVxdWVzdDogZXh0UmVxdWVzdC5yZXF1ZXN0LAogICAgICAgICAgYWJvcnRTaWduYWwsCiAgICAgICAgICBwcmV2aW91czogewogICAgICAgICAgICBzdGF0dXM6IHByZXZpb3VzU3RhdHVzCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBpZiAoYWJvcnRTaWduYWwuYWJvcnRlZCB8fCB1bnRyYWNrZWQyKHRoaXMuZXh0UmVxdWVzdCkgIT09IGV4dFJlcXVlc3QpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5zdGF0ZS5zZXQoewogICAgICAgIGV4dFJlcXVlc3QsCiAgICAgICAgc3RhdHVzOiAicmVzb2x2ZWQiLAogICAgICAgIHByZXZpb3VzU3RhdHVzOiAicmVzb2x2ZWQiLAogICAgICAgIHN0cmVhbQogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoYWJvcnRTaWduYWwuYWJvcnRlZCB8fCB1bnRyYWNrZWQyKHRoaXMuZXh0UmVxdWVzdCkgIT09IGV4dFJlcXVlc3QpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5zdGF0ZS5zZXQoewogICAgICAgIGV4dFJlcXVlc3QsCiAgICAgICAgc3RhdHVzOiAicmVzb2x2ZWQiLAogICAgICAgIHByZXZpb3VzU3RhdHVzOiAiZXJyb3IiLAogICAgICAgIHN0cmVhbTogc2lnbmFsKHsKICAgICAgICAgIGVycm9yOiBlbmNhcHN1bGF0ZVJlc291cmNlRXJyb3IoZXJyKQogICAgICAgIH0sIG5nRGV2TW9kZSA/IGNyZWF0ZURlYnVnTmFtZU9iamVjdCh0aGlzLmRlYnVnTmFtZSwgInN0cmVhbSIpIDogdm9pZCAwKQogICAgICB9KTsKICAgIH0gZmluYWxseSB7CiAgICAgIHJlc29sdmVQZW5kaW5nVGFzaz8uKCk7CiAgICAgIHJlc29sdmVQZW5kaW5nVGFzayA9IHZvaWQgMDsKICAgIH0KICB9CiAgYWJvcnRJblByb2dyZXNzTG9hZCgpIHsKICAgIHVudHJhY2tlZDIoKCkgPT4gdGhpcy5wZW5kaW5nQ29udHJvbGxlcj8uYWJvcnQoKSk7CiAgICB0aGlzLnBlbmRpbmdDb250cm9sbGVyID0gdm9pZCAwOwogICAgdGhpcy5yZXNvbHZlUGVuZGluZ1Rhc2s/LigpOwogICAgdGhpcy5yZXNvbHZlUGVuZGluZ1Rhc2sgPSB2b2lkIDA7CiAgfQp9OwpmdW5jdGlvbiB3cmFwRXF1YWxpdHlGbihlcXVhbCkgewogIHJldHVybiAoYSwgYikgPT4gYSA9PT0gdm9pZCAwIHx8IGIgPT09IHZvaWQgMCA/IGEgPT09IGIgOiBlcXVhbChhLCBiKTsKfQpmdW5jdGlvbiBnZXRMb2FkZXIob3B0aW9ucykgewogIGlmIChpc1N0cmVhbWluZ1Jlc291cmNlT3B0aW9ucyhvcHRpb25zKSkgewogICAgcmV0dXJuIG9wdGlvbnMuc3RyZWFtOwogIH0KICByZXR1cm4gYXN5bmMgKHBhcmFtcykgPT4gewogICAgdHJ5IHsKICAgICAgcmV0dXJuIHNpZ25hbCh7CiAgICAgICAgdmFsdWU6IGF3YWl0IG9wdGlvbnMubG9hZGVyKHBhcmFtcykKICAgICAgfSwgbmdEZXZNb2RlID8gY3JlYXRlRGVidWdOYW1lT2JqZWN0KG9wdGlvbnMuZGVidWdOYW1lLCAic3RyZWFtIikgOiB2b2lkIDApOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHJldHVybiBzaWduYWwoewogICAgICAgIGVycm9yOiBlbmNhcHN1bGF0ZVJlc291cmNlRXJyb3IoZXJyKQogICAgICB9LCBuZ0Rldk1vZGUgPyBjcmVhdGVEZWJ1Z05hbWVPYmplY3Qob3B0aW9ucy5kZWJ1Z05hbWUsICJzdHJlYW0iKSA6IHZvaWQgMCk7CiAgICB9CiAgfTsKfQpmdW5jdGlvbiBpc1N0cmVhbWluZ1Jlc291cmNlT3B0aW9ucyhvcHRpb25zKSB7CiAgcmV0dXJuICEhb3B0aW9ucy5zdHJlYW07Cn0KZnVuY3Rpb24gcHJvamVjdFN0YXR1c09mU3RhdGUoc3RhdGUpIHsKICBzd2l0Y2ggKHN0YXRlLnN0YXR1cykgewogICAgY2FzZSAibG9hZGluZyI6CiAgICAgIHJldHVybiBzdGF0ZS5leHRSZXF1ZXN0LnJlbG9hZCA9PT0gMCA/ICJsb2FkaW5nIiA6ICJyZWxvYWRpbmciOwogICAgY2FzZSAicmVzb2x2ZWQiOgogICAgICByZXR1cm4gaXNSZXNvbHZlZChzdGF0ZS5zdHJlYW0oKSkgPyAicmVzb2x2ZWQiIDogImVycm9yIjsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBzdGF0ZS5zdGF0dXM7CiAgfQp9CmZ1bmN0aW9uIGlzUmVzb2x2ZWQoc3RhdGUpIHsKICByZXR1cm4gc3RhdGUuZXJyb3IgPT09IHZvaWQgMDsKfQpmdW5jdGlvbiBjcmVhdGVEZWJ1Z05hbWVPYmplY3QocmVzb3VyY2VEZWJ1Z05hbWUsIGludGVybmFsU2lnbmFsRGVidWdOYW1lKSB7CiAgcmV0dXJuIHsKICAgIGRlYnVnTmFtZTogYFJlc291cmNlJHtyZXNvdXJjZURlYnVnTmFtZSA/ICIjIiArIHJlc291cmNlRGVidWdOYW1lIDogIiJ9LiR7aW50ZXJuYWxTaWduYWxEZWJ1Z05hbWV9YAogIH07Cn0KZnVuY3Rpb24gZW5jYXBzdWxhdGVSZXNvdXJjZUVycm9yKGVycm9yKSB7CiAgaWYgKGlzRXJyb3JMaWtlKGVycm9yKSkgewogICAgcmV0dXJuIGVycm9yOwogIH0KICByZXR1cm4gbmV3IFJlc291cmNlV3JhcHBlZEVycm9yKGVycm9yKTsKfQpmdW5jdGlvbiBpc0Vycm9yTGlrZShlcnJvcikgewogIHJldHVybiBlcnJvciBpbnN0YW5jZW9mIEVycm9yIHx8IHR5cGVvZiBlcnJvciA9PT0gIm9iamVjdCIgJiYgdHlwZW9mIGVycm9yLm5hbWUgPT09ICJzdHJpbmciICYmIHR5cGVvZiBlcnJvci5tZXNzYWdlID09PSAic3RyaW5nIjsKfQp2YXIgUmVzb3VyY2VWYWx1ZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBFcnJvciB7CiAgY29uc3RydWN0b3IoZXJyb3IpIHsKICAgIHN1cGVyKG5nRGV2TW9kZSA/IGBSZXNvdXJjZSBpcyBjdXJyZW50bHkgaW4gYW4gZXJyb3Igc3RhdGUgKHNlZSBFcnJvci5jYXVzZSBmb3IgZGV0YWlscyk6ICR7ZXJyb3IubWVzc2FnZX1gIDogZXJyb3IubWVzc2FnZSwgewogICAgICBjYXVzZTogZXJyb3IKICAgIH0pOwogIH0KfTsKdmFyIFJlc291cmNlV3JhcHBlZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBFcnJvciB7CiAgY29uc3RydWN0b3IoZXJyb3IpIHsKICAgIHN1cGVyKG5nRGV2TW9kZSA/IGBSZXNvdXJjZSByZXR1cm5lZCBhbiBlcnJvciB0aGF0J3Mgbm90IGFuIEVycm9yIGluc3RhbmNlOiAke1N0cmluZyhlcnJvcil9LiBDaGVjayB0aGlzIGVycm9yJ3MgLmNhdXNlIGZvciB0aGUgYWN0dWFsIGVycm9yLmAgOiBTdHJpbmcoZXJyb3IpLCB7CiAgICAgIGNhdXNlOiBlcnJvcgogICAgfSk7CiAgfQp9OwoKLy8gbm9kZV9tb2R1bGVzL0Bhbmd1bGFyL2NvcmUvZmVzbTIwMjIvcHJpbWl0aXZlcy1ldmVudC1kaXNwYXRjaC5tanMKdmFyIFByb3BlcnR5ID0gewogIEpTQUNUSU9OOiAiX19qc2FjdGlvbiIsCiAgT1dORVI6ICJfX293bmVyIgp9Owp2YXIgcGFyc2VDYWNoZSA9IHt9OwpmdW5jdGlvbiBnZXQoZWxlbWVudCkgewogIHJldHVybiBlbGVtZW50W1Byb3BlcnR5LkpTQUNUSU9OXTsKfQpmdW5jdGlvbiBzZXQoZWxlbWVudCwgYWN0aW9uTWFwKSB7CiAgZWxlbWVudFtQcm9wZXJ0eS5KU0FDVElPTl0gPSBhY3Rpb25NYXA7Cn0KZnVuY3Rpb24gZ2V0UGFyc2VkKHRleHQpIHsKICByZXR1cm4gcGFyc2VDYWNoZVt0ZXh0XTsKfQpmdW5jdGlvbiBzZXRQYXJzZWQodGV4dCwgcGFyc2VkKSB7CiAgcGFyc2VDYWNoZVt0ZXh0XSA9IHBhcnNlZDsKfQp2YXIgRXZlbnRUeXBlID0gewogIEFVWENMSUNLOiAiYXV4Y2xpY2siLAogIENIQU5HRTogImNoYW5nZSIsCiAgQ0xJQ0s6ICJjbGljayIsCiAgQ0xJQ0tNT0Q6ICJjbGlja21vZCIsCiAgQ0xJQ0tPTkxZOiAiY2xpY2tvbmx5IiwKICBEQkxDTElDSzogImRibGNsaWNrIiwKICBGT0NVUzogImZvY3VzIiwKICBGT0NVU0lOOiAiZm9jdXNpbiIsCiAgQkxVUjogImJsdXIiLAogIEZPQ1VTT1VUOiAiZm9jdXNvdXQiLAogIFNVQk1JVDogInN1Ym1pdCIsCiAgS0VZRE9XTjogImtleWRvd24iLAogIEtFWVBSRVNTOiAia2V5cHJlc3MiLAogIEtFWVVQOiAia2V5dXAiLAogIE1PVVNFVVA6ICJtb3VzZXVwIiwKICBNT1VTRURPV046ICJtb3VzZWRvd24iLAogIE1PVVNFT1ZFUjogIm1vdXNlb3ZlciIsCiAgTU9VU0VPVVQ6ICJtb3VzZW91dCIsCiAgTU9VU0VFTlRFUjogIm1vdXNlZW50ZXIiLAogIE1PVVNFTEVBVkU6ICJtb3VzZWxlYXZlIiwKICBNT1VTRU1PVkU6ICJtb3VzZW1vdmUiLAogIFBPSU5URVJVUDogInBvaW50ZXJ1cCIsCiAgUE9JTlRFUkRPV046ICJwb2ludGVyZG93biIsCiAgUE9JTlRFUk9WRVI6ICJwb2ludGVyb3ZlciIsCiAgUE9JTlRFUk9VVDogInBvaW50ZXJvdXQiLAogIFBPSU5URVJFTlRFUjogInBvaW50ZXJlbnRlciIsCiAgUE9JTlRFUkxFQVZFOiAicG9pbnRlcmxlYXZlIiwKICBQT0lOVEVSTU9WRTogInBvaW50ZXJtb3ZlIiwKICBQT0lOVEVSQ0FOQ0VMOiAicG9pbnRlcmNhbmNlbCIsCiAgR09UUE9JTlRFUkNBUFRVUkU6ICJnb3Rwb2ludGVyY2FwdHVyZSIsCiAgTE9TVFBPSU5URVJDQVBUVVJFOiAibG9zdHBvaW50ZXJjYXB0dXJlIiwKICBFUlJPUjogImVycm9yIiwKICBMT0FEOiAibG9hZCIsCiAgVU5MT0FEOiAidW5sb2FkIiwKICBUT1VDSFNUQVJUOiAidG91Y2hzdGFydCIsCiAgVE9VQ0hFTkQ6ICJ0b3VjaGVuZCIsCiAgVE9VQ0hNT1ZFOiAidG91Y2htb3ZlIiwKICBJTlBVVDogImlucHV0IiwKICBTQ1JPTEw6ICJzY3JvbGwiLAogIFRPR0dMRTogInRvZ2dsZSIsCiAgQ1VTVE9NOiAiX2N1c3RvbSIKfTsKdmFyIE1PVVNFX1NQRUNJQUxfRVZFTlRfVFlQRVMgPSBbRXZlbnRUeXBlLk1PVVNFRU5URVIsIEV2ZW50VHlwZS5NT1VTRUxFQVZFLCAicG9pbnRlcmVudGVyIiwgInBvaW50ZXJsZWF2ZSJdOwp2YXIgQlVCQkxFX0VWRU5UX1RZUEVTID0gW0V2ZW50VHlwZS5DTElDSywgRXZlbnRUeXBlLkRCTENMSUNLLCBFdmVudFR5cGUuRk9DVVNJTiwgRXZlbnRUeXBlLkZPQ1VTT1VULCBFdmVudFR5cGUuS0VZRE9XTiwgRXZlbnRUeXBlLktFWVVQLCBFdmVudFR5cGUuS0VZUFJFU1MsIEV2ZW50VHlwZS5NT1VTRU9WRVIsIEV2ZW50VHlwZS5NT1VTRU9VVCwgRXZlbnRUeXBlLlNVQk1JVCwgRXZlbnRUeXBlLlRPVUNIU1RBUlQsIEV2ZW50VHlwZS5UT1VDSEVORCwgRXZlbnRUeXBlLlRPVUNITU9WRSwgInRvdWNoY2FuY2VsIiwgImF1eGNsaWNrIiwgImNoYW5nZSIsICJjb21wb3NpdGlvbnN0YXJ0IiwgImNvbXBvc2l0aW9udXBkYXRlIiwgImNvbXBvc2l0aW9uZW5kIiwgImJlZm9yZWlucHV0IiwgImlucHV0IiwgInNlbGVjdCIsICJjb3B5IiwgImN1dCIsICJwYXN0ZSIsICJtb3VzZWRvd24iLCAibW91c2V1cCIsICJ3aGVlbCIsICJjb250ZXh0bWVudSIsICJkcmFnb3ZlciIsICJkcmFnZW50ZXIiLCAiZHJhZ2xlYXZlIiwgImRyb3AiLCAiZHJhZ3N0YXJ0IiwgImRyYWdlbmQiLCAicG9pbnRlcmRvd24iLCAicG9pbnRlcm1vdmUiLCAicG9pbnRlcnVwIiwgInBvaW50ZXJjYW5jZWwiLCAicG9pbnRlcm92ZXIiLCAicG9pbnRlcm91dCIsICJnb3Rwb2ludGVyY2FwdHVyZSIsICJsb3N0cG9pbnRlcmNhcHR1cmUiLCAiZW5kZWQiLCAibG9hZGVkbWV0YWRhdGEiLCAicGFnZWhpZGUiLCAicGFnZXNob3ciLCAidmlzaWJpbGl0eWNoYW5nZSIsICJiZWZvcmVtYXRjaCJdOwp2YXIgQ0FQVFVSRV9FVkVOVF9UWVBFUyA9IFtFdmVudFR5cGUuRk9DVVMsIEV2ZW50VHlwZS5CTFVSLCBFdmVudFR5cGUuRVJST1IsIEV2ZW50VHlwZS5MT0FELCBFdmVudFR5cGUuVE9HR0xFXTsKdmFyIGlzQ2FwdHVyZUV2ZW50VHlwZSA9IChldmVudFR5cGUpID0+IENBUFRVUkVfRVZFTlRfVFlQRVMuaW5kZXhPZihldmVudFR5cGUpID49IDA7CnZhciBFQVJMWV9FVkVOVF9UWVBFUyA9IEJVQkJMRV9FVkVOVF9UWVBFUy5jb25jYXQoQ0FQVFVSRV9FVkVOVF9UWVBFUyk7CnZhciBpc0Vhcmx5RXZlbnRUeXBlID0gKGV2ZW50VHlwZSkgPT4gRUFSTFlfRVZFTlRfVFlQRVMuaW5kZXhPZihldmVudFR5cGUpID49IDA7CmZ1bmN0aW9uIGdldEJyb3dzZXJFdmVudFR5cGUoZXZlbnRUeXBlKSB7CiAgaWYgKGV2ZW50VHlwZSA9PT0gRXZlbnRUeXBlLk1PVVNFRU5URVIpIHsKICAgIHJldHVybiBFdmVudFR5cGUuTU9VU0VPVkVSOwogIH0gZWxzZSBpZiAoZXZlbnRUeXBlID09PSBFdmVudFR5cGUuTU9VU0VMRUFWRSkgewogICAgcmV0dXJuIEV2ZW50VHlwZS5NT1VTRU9VVDsKICB9IGVsc2UgaWYgKGV2ZW50VHlwZSA9PT0gRXZlbnRUeXBlLlBPSU5URVJFTlRFUikgewogICAgcmV0dXJuIEV2ZW50VHlwZS5QT0lOVEVST1ZFUjsKICB9IGVsc2UgaWYgKGV2ZW50VHlwZSA9PT0gRXZlbnRUeXBlLlBPSU5URVJMRUFWRSkgewogICAgcmV0dXJuIEV2ZW50VHlwZS5QT0lOVEVST1VUOwogIH0KICByZXR1cm4gZXZlbnRUeXBlOwp9CmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoZWxlbWVudCwgZXZlbnRUeXBlLCBoYW5kbGVyLCBwYXNzaXZlKSB7CiAgbGV0IGNhcHR1cmUgPSBmYWxzZTsKICBpZiAoaXNDYXB0dXJlRXZlbnRUeXBlKGV2ZW50VHlwZSkpIHsKICAgIGNhcHR1cmUgPSB0cnVlOwogIH0KICBjb25zdCBvcHRpb25zID0gdHlwZW9mIHBhc3NpdmUgPT09ICJib29sZWFuIiA/IHsKICAgIGNhcHR1cmUsCiAgICBwYXNzaXZlCiAgfSA6IGNhcHR1cmU7CiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgaGFuZGxlciwgb3B0aW9ucyk7CiAgcmV0dXJuIHsKICAgIGV2ZW50VHlwZSwKICAgIGhhbmRsZXIsCiAgICBjYXB0dXJlLAogICAgcGFzc2l2ZQogIH07Cn0KZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihlbGVtZW50LCBpbmZvKSB7CiAgaWYgKGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcikgewogICAgY29uc3Qgb3B0aW9ucyA9IHR5cGVvZiBpbmZvLnBhc3NpdmUgPT09ICJib29sZWFuIiA/IHsKICAgICAgY2FwdHVyZTogaW5mby5jYXB0dXJlCiAgICB9IDogaW5mby5jYXB0dXJlOwogICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGluZm8uZXZlbnRUeXBlLCBpbmZvLmhhbmRsZXIsIG9wdGlvbnMpOwogIH0gZWxzZSBpZiAoZWxlbWVudC5kZXRhY2hFdmVudCkgewogICAgZWxlbWVudC5kZXRhY2hFdmVudChgb24ke2luZm8uZXZlbnRUeXBlfWAsIGluZm8uaGFuZGxlcik7CiAgfQp9CmZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KGUpIHsKICBlLnByZXZlbnREZWZhdWx0ID8gZS5wcmV2ZW50RGVmYXVsdCgpIDogZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwp9CnZhciBpc01hYyA9IHR5cGVvZiBuYXZpZ2F0b3IgIT09ICJ1bmRlZmluZWQiICYmIC9NYWNpbnRvc2gvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7CmZ1bmN0aW9uIGlzTWlkZGxlQ2xpY2soZSkgewogIHJldHVybiBlLndoaWNoID09PSAyIHx8IGUud2hpY2ggPT0gbnVsbCAmJiBlLmJ1dHRvbiA9PT0gNDsKfQpmdW5jdGlvbiBpc01vZGlmaWVkQ2xpY2tFdmVudChlKSB7CiAgcmV0dXJuIGlzTWFjICYmIGUubWV0YUtleSB8fCAhaXNNYWMgJiYgZS5jdHJsS2V5IHx8IGlzTWlkZGxlQ2xpY2soZSkgfHwgZS5zaGlmdEtleTsKfQpmdW5jdGlvbiBpc01vdXNlU3BlY2lhbEV2ZW50KGUsIHR5cGUsIGVsZW1lbnQpIHsKICBjb25zdCByZWxhdGVkID0gZS5yZWxhdGVkVGFyZ2V0OwogIHJldHVybiAoZS50eXBlID09PSBFdmVudFR5cGUuTU9VU0VPVkVSICYmIHR5cGUgPT09IEV2ZW50VHlwZS5NT1VTRUVOVEVSIHx8IGUudHlwZSA9PT0gRXZlbnRUeXBlLk1PVVNFT1VUICYmIHR5cGUgPT09IEV2ZW50VHlwZS5NT1VTRUxFQVZFIHx8IGUudHlwZSA9PT0gRXZlbnRUeXBlLlBPSU5URVJPVkVSICYmIHR5cGUgPT09IEV2ZW50VHlwZS5QT0lOVEVSRU5URVIgfHwgZS50eXBlID09PSBFdmVudFR5cGUuUE9JTlRFUk9VVCAmJiB0eXBlID09PSBFdmVudFR5cGUuUE9JTlRFUkxFQVZFKSAmJiAoIXJlbGF0ZWQgfHwgcmVsYXRlZCAhPT0gZWxlbWVudCAmJiAhZWxlbWVudC5jb250YWlucyhyZWxhdGVkKSk7Cn0KZnVuY3Rpb24gY3JlYXRlTW91c2VTcGVjaWFsRXZlbnQoZSwgdGFyZ2V0KSB7CiAgY29uc3QgY29weSA9IHt9OwogIGZvciAoY29uc3QgcHJvcGVydHkgaW4gZSkgewogICAgaWYgKHByb3BlcnR5ID09PSAic3JjRWxlbWVudCIgfHwgcHJvcGVydHkgPT09ICJ0YXJnZXQiKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgY29uc3Qga2V5ID0gcHJvcGVydHk7CiAgICBjb25zdCB2YWx1ZSA9IGVba2V5XTsKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBjb3B5W2tleV0gPSB2YWx1ZTsKICB9CiAgaWYgKGUudHlwZSA9PT0gRXZlbnRUeXBlLk1PVVNFT1ZFUikgewogICAgY29weVsidHlwZSJdID0gRXZlbnRUeXBlLk1PVVNFRU5URVI7CiAgfSBlbHNlIGlmIChlLnR5cGUgPT09IEV2ZW50VHlwZS5NT1VTRU9VVCkgewogICAgY29weVsidHlwZSJdID0gRXZlbnRUeXBlLk1PVVNFTEVBVkU7CiAgfSBlbHNlIGlmIChlLnR5cGUgPT09IEV2ZW50VHlwZS5QT0lOVEVST1ZFUikgewogICAgY29weVsidHlwZSJdID0gRXZlbnRUeXBlLlBPSU5URVJFTlRFUjsKICB9IGVsc2UgewogICAgY29weVsidHlwZSJdID0gRXZlbnRUeXBlLlBPSU5URVJMRUFWRTsKICB9CiAgY29weVsidGFyZ2V0Il0gPSBjb3B5WyJzcmNFbGVtZW50Il0gPSB0YXJnZXQ7CiAgY29weVsiYnViYmxlcyJdID0gZmFsc2U7CiAgY29weVsiX29yaWdpbmFsRXZlbnQiXSA9IGU7CiAgcmV0dXJuIGNvcHk7Cn0KdmFyIGlzSW9zID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gInVuZGVmaW5lZCIgJiYgL2lQaG9uZXxpUGFkfGlQb2QvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7CnZhciBFdmVudENvbnRyYWN0Q29udGFpbmVyID0gY2xhc3MgewogIGVsZW1lbnQ7CiAgaGFuZGxlckluZm9zID0gW107CiAgY29uc3RydWN0b3IoZWxlbWVudCkgewogICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDsKICB9CiAgYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGdldEhhbmRsZXIsIHBhc3NpdmUpIHsKICAgIGlmIChpc0lvcykgewogICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuY3Vyc29yID0gInBvaW50ZXIiOwogICAgfQogICAgdGhpcy5oYW5kbGVySW5mb3MucHVzaChhZGRFdmVudExpc3RlbmVyKHRoaXMuZWxlbWVudCwgZXZlbnRUeXBlLCBnZXRIYW5kbGVyKHRoaXMuZWxlbWVudCksIHBhc3NpdmUpKTsKICB9CiAgY2xlYW5VcCgpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5oYW5kbGVySW5mb3MubGVuZ3RoOyBpKyspIHsKICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLmVsZW1lbnQsIHRoaXMuaGFuZGxlckluZm9zW2ldKTsKICAgIH0KICAgIHRoaXMuaGFuZGxlckluZm9zID0gW107CiAgfQp9Owp2YXIgQ2hhciA9IHsKICBOQU1FU1BBQ0VfQUNUSU9OX1NFUEFSQVRPUjogIi4iLAogIEVWRU5UX0FDVElPTl9TRVBBUkFUT1I6ICI6Igp9OwpmdW5jdGlvbiBnZXRFdmVudFR5cGUoZXZlbnRJbmZvKSB7CiAgcmV0dXJuIGV2ZW50SW5mby5ldmVudFR5cGU7Cn0KZnVuY3Rpb24gc2V0RXZlbnRUeXBlKGV2ZW50SW5mbywgZXZlbnRUeXBlKSB7CiAgZXZlbnRJbmZvLmV2ZW50VHlwZSA9IGV2ZW50VHlwZTsKfQpmdW5jdGlvbiBnZXRFdmVudChldmVudEluZm8pIHsKICByZXR1cm4gZXZlbnRJbmZvLmV2ZW50Owp9CmZ1bmN0aW9uIHNldEV2ZW50KGV2ZW50SW5mbywgZXZlbnQpIHsKICBldmVudEluZm8uZXZlbnQgPSBldmVudDsKfQpmdW5jdGlvbiBnZXRUYXJnZXRFbGVtZW50KGV2ZW50SW5mbykgewogIHJldHVybiBldmVudEluZm8udGFyZ2V0RWxlbWVudDsKfQpmdW5jdGlvbiBzZXRUYXJnZXRFbGVtZW50KGV2ZW50SW5mbywgdGFyZ2V0RWxlbWVudCkgewogIGV2ZW50SW5mby50YXJnZXRFbGVtZW50ID0gdGFyZ2V0RWxlbWVudDsKfQpmdW5jdGlvbiBnZXRDb250YWluZXIoZXZlbnRJbmZvKSB7CiAgcmV0dXJuIGV2ZW50SW5mby5laWM7Cn0KZnVuY3Rpb24gc2V0Q29udGFpbmVyKGV2ZW50SW5mbywgY29udGFpbmVyKSB7CiAgZXZlbnRJbmZvLmVpYyA9IGNvbnRhaW5lcjsKfQpmdW5jdGlvbiBnZXRUaW1lc3RhbXAoZXZlbnRJbmZvKSB7CiAgcmV0dXJuIGV2ZW50SW5mby50aW1lU3RhbXA7Cn0KZnVuY3Rpb24gc2V0VGltZXN0YW1wKGV2ZW50SW5mbywgdGltZXN0YW1wMikgewogIGV2ZW50SW5mby50aW1lU3RhbXAgPSB0aW1lc3RhbXAyOwp9CmZ1bmN0aW9uIGdldEFjdGlvbihldmVudEluZm8pIHsKICByZXR1cm4gZXZlbnRJbmZvLmVpYTsKfQpmdW5jdGlvbiBzZXRBY3Rpb24oZXZlbnRJbmZvLCBhY3Rpb25OYW1lLCBhY3Rpb25FbGVtZW50KSB7CiAgZXZlbnRJbmZvLmVpYSA9IFthY3Rpb25OYW1lLCBhY3Rpb25FbGVtZW50XTsKfQpmdW5jdGlvbiB1bnNldEFjdGlvbihldmVudEluZm8pIHsKICBldmVudEluZm8uZWlhID0gdm9pZCAwOwp9CmZ1bmN0aW9uIGdldEFjdGlvbkVsZW1lbnQoYWN0aW9uSW5mbykgewogIHJldHVybiBhY3Rpb25JbmZvWzFdOwp9CmZ1bmN0aW9uIGdldElzUmVwbGF5KGV2ZW50SW5mbykgewogIHJldHVybiBldmVudEluZm8uZWlycDsKfQpmdW5jdGlvbiBzZXRJc1JlcGxheShldmVudEluZm8sIHJlcGxheSkgewogIGV2ZW50SW5mby5laXJwID0gcmVwbGF5Owp9CmZ1bmN0aW9uIGdldFJlc29sdmVkKGV2ZW50SW5mbykgewogIHJldHVybiBldmVudEluZm8uZWlyOwp9CmZ1bmN0aW9uIHNldFJlc29sdmVkKGV2ZW50SW5mbywgcmVzb2x2ZWQyKSB7CiAgZXZlbnRJbmZvLmVpciA9IHJlc29sdmVkMjsKfQpmdW5jdGlvbiBjbG9uZUV2ZW50SW5mbyhldmVudEluZm8pIHsKICByZXR1cm4gewogICAgZXZlbnRUeXBlOiBldmVudEluZm8uZXZlbnRUeXBlLAogICAgZXZlbnQ6IGV2ZW50SW5mby5ldmVudCwKICAgIHRhcmdldEVsZW1lbnQ6IGV2ZW50SW5mby50YXJnZXRFbGVtZW50LAogICAgZWljOiBldmVudEluZm8uZWljLAogICAgZWlhOiBldmVudEluZm8uZWlhLAogICAgdGltZVN0YW1wOiBldmVudEluZm8udGltZVN0YW1wLAogICAgZWlycDogZXZlbnRJbmZvLmVpcnAsCiAgICBlaWFjazogZXZlbnRJbmZvLmVpYWNrLAogICAgZWlyOiBldmVudEluZm8uZWlyCiAgfTsKfQpmdW5jdGlvbiBjcmVhdGVFdmVudEluZm9Gcm9tUGFyYW1ldGVycyhldmVudFR5cGUsIGV2ZW50LCB0YXJnZXRFbGVtZW50LCBjb250YWluZXIsIHRpbWVzdGFtcDIsIGFjdGlvbiwgaXNSZXBsYXksIGExMXlDbGlja0tleSkgewogIHJldHVybiB7CiAgICBldmVudFR5cGUsCiAgICBldmVudCwKICAgIHRhcmdldEVsZW1lbnQsCiAgICBlaWM6IGNvbnRhaW5lciwKICAgIHRpbWVTdGFtcDogdGltZXN0YW1wMiwKICAgIGVpYTogYWN0aW9uLAogICAgZWlycDogaXNSZXBsYXksCiAgICBlaWFjazogYTExeUNsaWNrS2V5CiAgfTsKfQp2YXIgRXZlbnRJbmZvV3JhcHBlciA9IGNsYXNzIF9FdmVudEluZm9XcmFwcGVyIHsKICBldmVudEluZm87CiAgY29uc3RydWN0b3IoZXZlbnRJbmZvKSB7CiAgICB0aGlzLmV2ZW50SW5mbyA9IGV2ZW50SW5mbzsKICB9CiAgZ2V0RXZlbnRUeXBlKCkgewogICAgcmV0dXJuIGdldEV2ZW50VHlwZSh0aGlzLmV2ZW50SW5mbyk7CiAgfQogIHNldEV2ZW50VHlwZShldmVudFR5cGUpIHsKICAgIHNldEV2ZW50VHlwZSh0aGlzLmV2ZW50SW5mbywgZXZlbnRUeXBlKTsKICB9CiAgZ2V0RXZlbnQoKSB7CiAgICByZXR1cm4gZ2V0RXZlbnQodGhpcy5ldmVudEluZm8pOwogIH0KICBzZXRFdmVudChldmVudCkgewogICAgc2V0RXZlbnQodGhpcy5ldmVudEluZm8sIGV2ZW50KTsKICB9CiAgZ2V0VGFyZ2V0RWxlbWVudCgpIHsKICAgIHJldHVybiBnZXRUYXJnZXRFbGVtZW50KHRoaXMuZXZlbnRJbmZvKTsKICB9CiAgc2V0VGFyZ2V0RWxlbWVudCh0YXJnZXRFbGVtZW50KSB7CiAgICBzZXRUYXJnZXRFbGVtZW50KHRoaXMuZXZlbnRJbmZvLCB0YXJnZXRFbGVtZW50KTsKICB9CiAgZ2V0Q29udGFpbmVyKCkgewogICAgcmV0dXJuIGdldENvbnRhaW5lcih0aGlzLmV2ZW50SW5mbyk7CiAgfQogIHNldENvbnRhaW5lcihjb250YWluZXIpIHsKICAgIHNldENvbnRhaW5lcih0aGlzLmV2ZW50SW5mbywgY29udGFpbmVyKTsKICB9CiAgZ2V0VGltZXN0YW1wKCkgewogICAgcmV0dXJuIGdldFRpbWVzdGFtcCh0aGlzLmV2ZW50SW5mbyk7CiAgfQogIHNldFRpbWVzdGFtcCh0aW1lc3RhbXAyKSB7CiAgICBzZXRUaW1lc3RhbXAodGhpcy5ldmVudEluZm8sIHRpbWVzdGFtcDIpOwogIH0KICBnZXRBY3Rpb24oKSB7CiAgICBjb25zdCBhY3Rpb24gPSBnZXRBY3Rpb24odGhpcy5ldmVudEluZm8pOwogICAgaWYgKCFhY3Rpb24pIHJldHVybiB2b2lkIDA7CiAgICByZXR1cm4gewogICAgICBuYW1lOiBhY3Rpb25bMF0sCiAgICAgIGVsZW1lbnQ6IGFjdGlvblsxXQogICAgfTsKICB9CiAgc2V0QWN0aW9uKGFjdGlvbikgewogICAgaWYgKCFhY3Rpb24pIHsKICAgICAgdW5zZXRBY3Rpb24odGhpcy5ldmVudEluZm8pOwogICAgICByZXR1cm47CiAgICB9CiAgICBzZXRBY3Rpb24odGhpcy5ldmVudEluZm8sIGFjdGlvbi5uYW1lLCBhY3Rpb24uZWxlbWVudCk7CiAgfQogIGdldElzUmVwbGF5KCkgewogICAgcmV0dXJuIGdldElzUmVwbGF5KHRoaXMuZXZlbnRJbmZvKTsKICB9CiAgc2V0SXNSZXBsYXkocmVwbGF5KSB7CiAgICBzZXRJc1JlcGxheSh0aGlzLmV2ZW50SW5mbywgcmVwbGF5KTsKICB9CiAgZ2V0UmVzb2x2ZWQoKSB7CiAgICByZXR1cm4gZ2V0UmVzb2x2ZWQodGhpcy5ldmVudEluZm8pOwogIH0KICBzZXRSZXNvbHZlZChyZXNvbHZlZDIpIHsKICAgIHNldFJlc29sdmVkKHRoaXMuZXZlbnRJbmZvLCByZXNvbHZlZDIpOwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgX0V2ZW50SW5mb1dyYXBwZXIoY2xvbmVFdmVudEluZm8odGhpcy5ldmVudEluZm8pKTsKICB9Cn07CnZhciBFTVBUWV9BQ1RJT05fTUFQID0ge307CnZhciBSRUdFWFBfU0VNSUNPTE9OID0gL1xzKjtccyovOwp2YXIgREVGQVVMVF9FVkVOVF9UWVBFID0gRXZlbnRUeXBlLkNMSUNLOwp2YXIgQWN0aW9uUmVzb2x2ZXIgPSBjbGFzcyB7CiAgYTExeUNsaWNrU3VwcG9ydCA9IGZhbHNlOwogIGNsaWNrTW9kU3VwcG9ydCA9IHRydWU7CiAgc3ludGhldGljTW91c2VFdmVudFN1cHBvcnQ7CiAgdXBkYXRlRXZlbnRJbmZvRm9yQTExeUNsaWNrID0gdm9pZCAwOwogIHByZXZlbnREZWZhdWx0Rm9yQTExeUNsaWNrID0gdm9pZCAwOwogIHBvcHVsYXRlQ2xpY2tPbmx5QWN0aW9uID0gdm9pZCAwOwogIGNvbnN0cnVjdG9yKHsKICAgIHN5bnRoZXRpY01vdXNlRXZlbnRTdXBwb3J0ID0gZmFsc2UsCiAgICBjbGlja01vZFN1cHBvcnQgPSB0cnVlCiAgfSA9IHt9KSB7CiAgICB0aGlzLnN5bnRoZXRpY01vdXNlRXZlbnRTdXBwb3J0ID0gc3ludGhldGljTW91c2VFdmVudFN1cHBvcnQ7CiAgICB0aGlzLmNsaWNrTW9kU3VwcG9ydCA9IGNsaWNrTW9kU3VwcG9ydDsKICB9CiAgcmVzb2x2ZUV2ZW50VHlwZShldmVudEluZm8pIHsKICAgIGlmICh0aGlzLmNsaWNrTW9kU3VwcG9ydCAmJiBnZXRFdmVudFR5cGUoZXZlbnRJbmZvKSA9PT0gRXZlbnRUeXBlLkNMSUNLICYmIGlzTW9kaWZpZWRDbGlja0V2ZW50KGdldEV2ZW50KGV2ZW50SW5mbykpKSB7CiAgICAgIHNldEV2ZW50VHlwZShldmVudEluZm8sIEV2ZW50VHlwZS5DTElDS01PRCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuYTExeUNsaWNrU3VwcG9ydCkgewogICAgICB0aGlzLnVwZGF0ZUV2ZW50SW5mb0ZvckExMXlDbGljayhldmVudEluZm8pOwogICAgfQogIH0KICByZXNvbHZlQWN0aW9uKGV2ZW50SW5mbykgewogICAgaWYgKGdldFJlc29sdmVkKGV2ZW50SW5mbykpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5wb3B1bGF0ZUFjdGlvbihldmVudEluZm8sIGdldFRhcmdldEVsZW1lbnQoZXZlbnRJbmZvKSk7CiAgICBzZXRSZXNvbHZlZChldmVudEluZm8sIHRydWUpOwogIH0KICByZXNvbHZlUGFyZW50QWN0aW9uKGV2ZW50SW5mbykgewogICAgY29uc3QgYWN0aW9uID0gZ2V0QWN0aW9uKGV2ZW50SW5mbyk7CiAgICBjb25zdCBhY3Rpb25FbGVtZW50ID0gYWN0aW9uICYmIGdldEFjdGlvbkVsZW1lbnQoYWN0aW9uKTsKICAgIHVuc2V0QWN0aW9uKGV2ZW50SW5mbyk7CiAgICBjb25zdCBwYXJlbnROb2RlID0gYWN0aW9uRWxlbWVudCAmJiB0aGlzLmdldFBhcmVudE5vZGUoYWN0aW9uRWxlbWVudCk7CiAgICBpZiAoIXBhcmVudE5vZGUpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5wb3B1bGF0ZUFjdGlvbihldmVudEluZm8sIHBhcmVudE5vZGUpOwogIH0KICBwb3B1bGF0ZUFjdGlvbihldmVudEluZm8sIGN1cnJlbnRUYXJnZXQpIHsKICAgIGxldCBhY3Rpb25FbGVtZW50ID0gY3VycmVudFRhcmdldDsKICAgIHdoaWxlIChhY3Rpb25FbGVtZW50ICYmIGFjdGlvbkVsZW1lbnQgIT09IGdldENvbnRhaW5lcihldmVudEluZm8pKSB7CiAgICAgIGlmIChhY3Rpb25FbGVtZW50Lm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkgewogICAgICAgIHRoaXMucG9wdWxhdGVBY3Rpb25PbkVsZW1lbnQoYWN0aW9uRWxlbWVudCwgZXZlbnRJbmZvKTsKICAgICAgfQogICAgICBpZiAoZ2V0QWN0aW9uKGV2ZW50SW5mbykpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBhY3Rpb25FbGVtZW50ID0gdGhpcy5nZXRQYXJlbnROb2RlKGFjdGlvbkVsZW1lbnQpOwogICAgfQogICAgY29uc3QgYWN0aW9uID0gZ2V0QWN0aW9uKGV2ZW50SW5mbyk7CiAgICBpZiAoIWFjdGlvbikgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAodGhpcy5hMTF5Q2xpY2tTdXBwb3J0KSB7CiAgICAgIHRoaXMucHJldmVudERlZmF1bHRGb3JBMTF5Q2xpY2soZXZlbnRJbmZvKTsKICAgIH0KICAgIGlmICh0aGlzLnN5bnRoZXRpY01vdXNlRXZlbnRTdXBwb3J0KSB7CiAgICAgIGlmIChnZXRFdmVudFR5cGUoZXZlbnRJbmZvKSA9PT0gRXZlbnRUeXBlLk1PVVNFRU5URVIgfHwgZ2V0RXZlbnRUeXBlKGV2ZW50SW5mbykgPT09IEV2ZW50VHlwZS5NT1VTRUxFQVZFIHx8IGdldEV2ZW50VHlwZShldmVudEluZm8pID09PSBFdmVudFR5cGUuUE9JTlRFUkVOVEVSIHx8IGdldEV2ZW50VHlwZShldmVudEluZm8pID09PSBFdmVudFR5cGUuUE9JTlRFUkxFQVZFKSB7CiAgICAgICAgaWYgKGlzTW91c2VTcGVjaWFsRXZlbnQoZ2V0RXZlbnQoZXZlbnRJbmZvKSwgZ2V0RXZlbnRUeXBlKGV2ZW50SW5mbyksIGdldEFjdGlvbkVsZW1lbnQoYWN0aW9uKSkpIHsKICAgICAgICAgIGNvbnN0IGNvcGllZEV2ZW50ID0gY3JlYXRlTW91c2VTcGVjaWFsRXZlbnQoZ2V0RXZlbnQoZXZlbnRJbmZvKSwgZ2V0QWN0aW9uRWxlbWVudChhY3Rpb24pKTsKICAgICAgICAgIHNldEV2ZW50KGV2ZW50SW5mbywgY29waWVkRXZlbnQpOwogICAgICAgICAgc2V0VGFyZ2V0RWxlbWVudChldmVudEluZm8sIGdldEFjdGlvbkVsZW1lbnQoYWN0aW9uKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHVuc2V0QWN0aW9uKGV2ZW50SW5mbyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGdldFBhcmVudE5vZGUoZWxlbWVudCkgewogICAgY29uc3Qgb3duZXIgPSBlbGVtZW50W1Byb3BlcnR5Lk9XTkVSXTsKICAgIGlmIChvd25lcikgewogICAgICByZXR1cm4gb3duZXI7CiAgICB9CiAgICBjb25zdCBwYXJlbnROb2RlID0gZWxlbWVudC5wYXJlbnROb2RlOwogICAgaWYgKHBhcmVudE5vZGU/Lm5vZGVOYW1lID09PSAiI2RvY3VtZW50LWZyYWdtZW50IikgewogICAgICByZXR1cm4gcGFyZW50Tm9kZT8uaG9zdCA/PyBudWxsOwogICAgfQogICAgcmV0dXJuIHBhcmVudE5vZGU7CiAgfQogIHBvcHVsYXRlQWN0aW9uT25FbGVtZW50KGFjdGlvbkVsZW1lbnQsIGV2ZW50SW5mbykgewogICAgY29uc3QgYWN0aW9uTWFwID0gdGhpcy5wYXJzZUFjdGlvbnMoYWN0aW9uRWxlbWVudCk7CiAgICBjb25zdCBhY3Rpb25OYW1lID0gYWN0aW9uTWFwW2dldEV2ZW50VHlwZShldmVudEluZm8pXTsKICAgIGlmIChhY3Rpb25OYW1lICE9PSB2b2lkIDApIHsKICAgICAgc2V0QWN0aW9uKGV2ZW50SW5mbywgYWN0aW9uTmFtZSwgYWN0aW9uRWxlbWVudCk7CiAgICB9CiAgICBpZiAodGhpcy5hMTF5Q2xpY2tTdXBwb3J0KSB7CiAgICAgIHRoaXMucG9wdWxhdGVDbGlja09ubHlBY3Rpb24oYWN0aW9uRWxlbWVudCwgZXZlbnRJbmZvLCBhY3Rpb25NYXApOwogICAgfQogIH0KICBwYXJzZUFjdGlvbnMoYWN0aW9uRWxlbWVudCkgewogICAgbGV0IGFjdGlvbk1hcCA9IGdldChhY3Rpb25FbGVtZW50KTsKICAgIGlmICghYWN0aW9uTWFwKSB7CiAgICAgIGNvbnN0IGpzYWN0aW9uQXR0cmlidXRlID0gYWN0aW9uRWxlbWVudC5nZXRBdHRyaWJ1dGUoQXR0cmlidXRlLkpTQUNUSU9OKTsKICAgICAgaWYgKCFqc2FjdGlvbkF0dHJpYnV0ZSkgewogICAgICAgIGFjdGlvbk1hcCA9IEVNUFRZX0FDVElPTl9NQVA7CiAgICAgICAgc2V0KGFjdGlvbkVsZW1lbnQsIGFjdGlvbk1hcCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aW9uTWFwID0gZ2V0UGFyc2VkKGpzYWN0aW9uQXR0cmlidXRlKTsKICAgICAgICBpZiAoIWFjdGlvbk1hcCkgewogICAgICAgICAgYWN0aW9uTWFwID0ge307CiAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBqc2FjdGlvbkF0dHJpYnV0ZS5zcGxpdChSRUdFWFBfU0VNSUNPTE9OKTsKICAgICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IHZhbHVlcy5sZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdmFsdWVzW2lkeF07CiAgICAgICAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBjb2xvbiA9IHZhbHVlLmluZGV4T2YoQ2hhci5FVkVOVF9BQ1RJT05fU0VQQVJBVE9SKTsKICAgICAgICAgICAgY29uc3QgaGFzQ29sb24gPSBjb2xvbiAhPT0gLTE7CiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBoYXNDb2xvbiA/IHZhbHVlLnN1YnN0cigwLCBjb2xvbikudHJpbSgpIDogREVGQVVMVF9FVkVOVF9UWVBFOwogICAgICAgICAgICBjb25zdCBhY3Rpb24gPSBoYXNDb2xvbiA/IHZhbHVlLnN1YnN0cihjb2xvbiArIDEpLnRyaW0oKSA6IHZhbHVlOwogICAgICAgICAgICBhY3Rpb25NYXBbdHlwZV0gPSBhY3Rpb247CiAgICAgICAgICB9CiAgICAgICAgICBzZXRQYXJzZWQoanNhY3Rpb25BdHRyaWJ1dGUsIGFjdGlvbk1hcCk7CiAgICAgICAgfQogICAgICAgIHNldChhY3Rpb25FbGVtZW50LCBhY3Rpb25NYXApOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gYWN0aW9uTWFwOwogIH0KICBhZGRBMTF5Q2xpY2tTdXBwb3J0KHVwZGF0ZUV2ZW50SW5mb0ZvckExMXlDbGljaywgcHJldmVudERlZmF1bHRGb3JBMTF5Q2xpY2ssIHBvcHVsYXRlQ2xpY2tPbmx5QWN0aW9uKSB7CiAgICB0aGlzLmExMXlDbGlja1N1cHBvcnQgPSB0cnVlOwogICAgdGhpcy51cGRhdGVFdmVudEluZm9Gb3JBMTF5Q2xpY2sgPSB1cGRhdGVFdmVudEluZm9Gb3JBMTF5Q2xpY2s7CiAgICB0aGlzLnByZXZlbnREZWZhdWx0Rm9yQTExeUNsaWNrID0gcHJldmVudERlZmF1bHRGb3JBMTF5Q2xpY2s7CiAgICB0aGlzLnBvcHVsYXRlQ2xpY2tPbmx5QWN0aW9uID0gcG9wdWxhdGVDbGlja09ubHlBY3Rpb247CiAgfQp9Owp2YXIgUmVzdHJpY3Rpb247CihmdW5jdGlvbihSZXN0cmljdGlvbjIpIHsKICBSZXN0cmljdGlvbjJbUmVzdHJpY3Rpb24yWyJJX0FNX1RIRV9KU0FDVElPTl9GUkFNRVdPUksiXSA9IDBdID0gIklfQU1fVEhFX0pTQUNUSU9OX0ZSQU1FV09SSyI7Cn0pKFJlc3RyaWN0aW9uIHx8IChSZXN0cmljdGlvbiA9IHt9KSk7CnZhciBEaXNwYXRjaGVyID0gY2xhc3MgewogIGRpc3BhdGNoRGVsZWdhdGU7CiAgYWN0aW9uUmVzb2x2ZXI7CiAgZXZlbnRSZXBsYXllcjsKICBldmVudFJlcGxheVNjaGVkdWxlZCA9IGZhbHNlOwogIHJlcGxheUV2ZW50SW5mb1dyYXBwZXJzID0gW107CiAgY29uc3RydWN0b3IoZGlzcGF0Y2hEZWxlZ2F0ZSwgewogICAgYWN0aW9uUmVzb2x2ZXIsCiAgICBldmVudFJlcGxheWVyCiAgfSA9IHt9KSB7CiAgICB0aGlzLmRpc3BhdGNoRGVsZWdhdGUgPSBkaXNwYXRjaERlbGVnYXRlOwogICAgdGhpcy5hY3Rpb25SZXNvbHZlciA9IGFjdGlvblJlc29sdmVyOwogICAgdGhpcy5ldmVudFJlcGxheWVyID0gZXZlbnRSZXBsYXllcjsKICB9CiAgZGlzcGF0Y2goZXZlbnRJbmZvKSB7CiAgICBjb25zdCBldmVudEluZm9XcmFwcGVyID0gbmV3IEV2ZW50SW5mb1dyYXBwZXIoZXZlbnRJbmZvKTsKICAgIHRoaXMuYWN0aW9uUmVzb2x2ZXI/LnJlc29sdmVFdmVudFR5cGUoZXZlbnRJbmZvKTsKICAgIHRoaXMuYWN0aW9uUmVzb2x2ZXI/LnJlc29sdmVBY3Rpb24oZXZlbnRJbmZvKTsKICAgIGNvbnN0IGFjdGlvbiA9IGV2ZW50SW5mb1dyYXBwZXIuZ2V0QWN0aW9uKCk7CiAgICBpZiAoYWN0aW9uICYmIHNob3VsZFByZXZlbnREZWZhdWx0QmVmb3JlRGlzcGF0Y2hpbmcoYWN0aW9uLmVsZW1lbnQsIGV2ZW50SW5mb1dyYXBwZXIpKSB7CiAgICAgIHByZXZlbnREZWZhdWx0KGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnQoKSk7CiAgICB9CiAgICBpZiAodGhpcy5ldmVudFJlcGxheWVyICYmIGV2ZW50SW5mb1dyYXBwZXIuZ2V0SXNSZXBsYXkoKSkgewogICAgICB0aGlzLnNjaGVkdWxlRXZlbnRJbmZvV3JhcHBlclJlcGxheShldmVudEluZm9XcmFwcGVyKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5kaXNwYXRjaERlbGVnYXRlKGV2ZW50SW5mb1dyYXBwZXIpOwogIH0KICBzY2hlZHVsZUV2ZW50SW5mb1dyYXBwZXJSZXBsYXkoZXZlbnRJbmZvV3JhcHBlcikgewogICAgdGhpcy5yZXBsYXlFdmVudEluZm9XcmFwcGVycy5wdXNoKGV2ZW50SW5mb1dyYXBwZXIpOwogICAgaWYgKHRoaXMuZXZlbnRSZXBsYXlTY2hlZHVsZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5ldmVudFJlcGxheVNjaGVkdWxlZCA9IHRydWU7CiAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IHsKICAgICAgdGhpcy5ldmVudFJlcGxheVNjaGVkdWxlZCA9IGZhbHNlOwogICAgICB0aGlzLmV2ZW50UmVwbGF5ZXIodGhpcy5yZXBsYXlFdmVudEluZm9XcmFwcGVycyk7CiAgICB9KTsKICB9Cn07CmZ1bmN0aW9uIHNob3VsZFByZXZlbnREZWZhdWx0QmVmb3JlRGlzcGF0Y2hpbmcoYWN0aW9uRWxlbWVudCwgZXZlbnRJbmZvV3JhcHBlcikgewogIHJldHVybiBhY3Rpb25FbGVtZW50LnRhZ05hbWUgPT09ICJBIiAmJiAoZXZlbnRJbmZvV3JhcHBlci5nZXRFdmVudFR5cGUoKSA9PT0gRXZlbnRUeXBlLkNMSUNLIHx8IGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnRUeXBlKCkgPT09IEV2ZW50VHlwZS5DTElDS01PRCk7Cn0KdmFyIFBST1BBR0FUSU9OX1NUT1BQRURfU1lNQk9MID0gLyogQF9fUFVSRV9fICovIFN5bWJvbC5mb3IoInByb3BhZ2F0aW9uU3RvcHBlZCIpOwp2YXIgRXZlbnRQaGFzZSA9IHsKICBSRVBMQVk6IDEwMQp9Owp2YXIgUFJFVkVOVF9ERUZBVUxUX0VSUk9SX01FU1NBR0VfREVUQUlMUyA9ICIgQmVjYXVzZSBldmVudCByZXBsYXkgb2NjdXJzIGFmdGVyIGJyb3dzZXIgZGlzcGF0Y2gsIGBwcmV2ZW50RGVmYXVsdGAgd291bGQgaGF2ZSBubyBlZmZlY3QuIFlvdSBjYW4gY2hlY2sgd2hldGhlciBhbiBldmVudCBpcyBiZWluZyByZXBsYXllZCBieSBhY2Nlc3NpbmcgdGhlIGV2ZW50IHBoYXNlOiBgZXZlbnQuZXZlbnRQaGFzZSA9PT0gRXZlbnRQaGFzZS5SRVBMQVlgLiI7CnZhciBQUkVWRU5UX0RFRkFVTFRfRVJST1JfTUVTU0FHRSA9IGBcYHByZXZlbnREZWZhdWx0XGAgY2FsbGVkIGR1cmluZyBldmVudCByZXBsYXkuYDsKdmFyIENPTVBPU0VEX1BBVEhfRVJST1JfTUVTU0FHRV9ERVRBSUxTID0gIiBCZWNhdXNlIGV2ZW50IHJlcGxheSBvY2N1cnMgYWZ0ZXIgYnJvd3NlciBkaXNwYXRjaCwgYGNvbXBvc2VkUGF0aCgpYCB3aWxsIGJlIGVtcHR5LiBJdGVyYXRlIHBhcmVudCBub2RlcyBmcm9tIGBldmVudC50YXJnZXRgIG9yIGBldmVudC5jdXJyZW50VGFyZ2V0YCBpZiB5b3UgbmVlZCB0byBjaGVjayBlbGVtZW50cyBpbiB0aGUgZXZlbnQgcGF0aC4iOwp2YXIgQ09NUE9TRURfUEFUSF9FUlJPUl9NRVNTQUdFID0gYFxgY29tcG9zZWRQYXRoXGAgY2FsbGVkIGR1cmluZyBldmVudCByZXBsYXkuYDsKdmFyIEV2ZW50RGlzcGF0Y2hlciA9IGNsYXNzIHsKICBkaXNwYXRjaERlbGVnYXRlOwogIGNsaWNrTW9kU3VwcG9ydDsKICBhY3Rpb25SZXNvbHZlcjsKICBkaXNwYXRjaGVyOwogIGNvbnN0cnVjdG9yKGRpc3BhdGNoRGVsZWdhdGUsIGNsaWNrTW9kU3VwcG9ydCA9IHRydWUpIHsKICAgIHRoaXMuZGlzcGF0Y2hEZWxlZ2F0ZSA9IGRpc3BhdGNoRGVsZWdhdGU7CiAgICB0aGlzLmNsaWNrTW9kU3VwcG9ydCA9IGNsaWNrTW9kU3VwcG9ydDsKICAgIHRoaXMuYWN0aW9uUmVzb2x2ZXIgPSBuZXcgQWN0aW9uUmVzb2x2ZXIoewogICAgICBjbGlja01vZFN1cHBvcnQKICAgIH0pOwogICAgdGhpcy5kaXNwYXRjaGVyID0gbmV3IERpc3BhdGNoZXIoKGV2ZW50SW5mb1dyYXBwZXIpID0+IHsKICAgICAgdGhpcy5kaXNwYXRjaFRvRGVsZWdhdGUoZXZlbnRJbmZvV3JhcHBlcik7CiAgICB9LCB7CiAgICAgIGFjdGlvblJlc29sdmVyOiB0aGlzLmFjdGlvblJlc29sdmVyCiAgICB9KTsKICB9CiAgZGlzcGF0Y2goZXZlbnRJbmZvKSB7CiAgICB0aGlzLmRpc3BhdGNoZXIuZGlzcGF0Y2goZXZlbnRJbmZvKTsKICB9CiAgZGlzcGF0Y2hUb0RlbGVnYXRlKGV2ZW50SW5mb1dyYXBwZXIpIHsKICAgIGlmIChldmVudEluZm9XcmFwcGVyLmdldElzUmVwbGF5KCkpIHsKICAgICAgcHJlcGFyZUV2ZW50Rm9yUmVwbGF5KGV2ZW50SW5mb1dyYXBwZXIpOwogICAgfQogICAgcHJlcGFyZUV2ZW50Rm9yQnViYmxpbmcoZXZlbnRJbmZvV3JhcHBlcik7CiAgICB3aGlsZSAoZXZlbnRJbmZvV3JhcHBlci5nZXRBY3Rpb24oKSkgewogICAgICBwcmVwYXJlRXZlbnRGb3JEaXNwYXRjaChldmVudEluZm9XcmFwcGVyKTsKICAgICAgaWYgKGlzQ2FwdHVyZUV2ZW50VHlwZShldmVudEluZm9XcmFwcGVyLmdldEV2ZW50VHlwZSgpKSAmJiBldmVudEluZm9XcmFwcGVyLmdldEFjdGlvbigpLmVsZW1lbnQgIT09IGV2ZW50SW5mb1dyYXBwZXIuZ2V0VGFyZ2V0RWxlbWVudCgpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuZGlzcGF0Y2hEZWxlZ2F0ZShldmVudEluZm9XcmFwcGVyLmdldEV2ZW50KCksIGV2ZW50SW5mb1dyYXBwZXIuZ2V0QWN0aW9uKCkubmFtZSk7CiAgICAgIGlmIChwcm9wYWdhdGlvblN0b3BwZWQoZXZlbnRJbmZvV3JhcHBlcikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5hY3Rpb25SZXNvbHZlci5yZXNvbHZlUGFyZW50QWN0aW9uKGV2ZW50SW5mb1dyYXBwZXIuZXZlbnRJbmZvKTsKICAgIH0KICB9Cn07CmZ1bmN0aW9uIHByZXBhcmVFdmVudEZvckJ1YmJsaW5nKGV2ZW50SW5mb1dyYXBwZXIpIHsKICBjb25zdCBldmVudCA9IGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnQoKTsKICBjb25zdCBvcmlnaW5hbFN0b3BQcm9wYWdhdGlvbiA9IGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnQoKS5zdG9wUHJvcGFnYXRpb24uYmluZChldmVudCk7CiAgY29uc3Qgc3RvcFByb3BhZ2F0aW9uID0gKCkgPT4gewogICAgZXZlbnRbUFJPUEFHQVRJT05fU1RPUFBFRF9TWU1CT0xdID0gdHJ1ZTsKICAgIG9yaWdpbmFsU3RvcFByb3BhZ2F0aW9uKCk7CiAgfTsKICBwYXRjaEV2ZW50SW5zdGFuY2UoZXZlbnQsICJzdG9wUHJvcGFnYXRpb24iLCBzdG9wUHJvcGFnYXRpb24pOwogIHBhdGNoRXZlbnRJbnN0YW5jZShldmVudCwgInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsIHN0b3BQcm9wYWdhdGlvbik7Cn0KZnVuY3Rpb24gcHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50SW5mb1dyYXBwZXIpIHsKICBjb25zdCBldmVudCA9IGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnQoKTsKICByZXR1cm4gISFldmVudFtQUk9QQUdBVElPTl9TVE9QUEVEX1NZTUJPTF07Cn0KZnVuY3Rpb24gcHJlcGFyZUV2ZW50Rm9yUmVwbGF5KGV2ZW50SW5mb1dyYXBwZXIpIHsKICBjb25zdCBldmVudCA9IGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnQoKTsKICBjb25zdCB0YXJnZXQgPSBldmVudEluZm9XcmFwcGVyLmdldFRhcmdldEVsZW1lbnQoKTsKICBjb25zdCBvcmlnaW5hbFByZXZlbnREZWZhdWx0ID0gZXZlbnQucHJldmVudERlZmF1bHQuYmluZChldmVudCk7CiAgcGF0Y2hFdmVudEluc3RhbmNlKGV2ZW50LCAidGFyZ2V0IiwgdGFyZ2V0KTsKICBwYXRjaEV2ZW50SW5zdGFuY2UoZXZlbnQsICJldmVudFBoYXNlIiwgRXZlbnRQaGFzZS5SRVBMQVkpOwogIHBhdGNoRXZlbnRJbnN0YW5jZShldmVudCwgInByZXZlbnREZWZhdWx0IiwgKCkgPT4gewogICAgb3JpZ2luYWxQcmV2ZW50RGVmYXVsdCgpOwogICAgdGhyb3cgbmV3IEVycm9yKFBSRVZFTlRfREVGQVVMVF9FUlJPUl9NRVNTQUdFICsgKG5nRGV2TW9kZSA/IFBSRVZFTlRfREVGQVVMVF9FUlJPUl9NRVNTQUdFX0RFVEFJTFMgOiAiIikpOwogIH0pOwogIHBhdGNoRXZlbnRJbnN0YW5jZShldmVudCwgImNvbXBvc2VkUGF0aCIsICgpID0+IHsKICAgIHRocm93IG5ldyBFcnJvcihDT01QT1NFRF9QQVRIX0VSUk9SX01FU1NBR0UgKyAobmdEZXZNb2RlID8gQ09NUE9TRURfUEFUSF9FUlJPUl9NRVNTQUdFX0RFVEFJTFMgOiAiIikpOwogIH0pOwp9CmZ1bmN0aW9uIHByZXBhcmVFdmVudEZvckRpc3BhdGNoKGV2ZW50SW5mb1dyYXBwZXIpIHsKICBjb25zdCBldmVudCA9IGV2ZW50SW5mb1dyYXBwZXIuZ2V0RXZlbnQoKTsKICBjb25zdCBjdXJyZW50VGFyZ2V0ID0gZXZlbnRJbmZvV3JhcHBlci5nZXRBY3Rpb24oKT8uZWxlbWVudDsKICBpZiAoY3VycmVudFRhcmdldCkgewogICAgcGF0Y2hFdmVudEluc3RhbmNlKGV2ZW50LCAiY3VycmVudFRhcmdldCIsIGN1cnJlbnRUYXJnZXQsIHsKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9KTsKICB9Cn0KZnVuY3Rpb24gcGF0Y2hFdmVudEluc3RhbmNlKGV2ZW50LCBwcm9wZXJ0eSwgdmFsdWUsIHsKICBjb25maWd1cmFibGUgPSBmYWxzZQp9ID0ge30pIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnQsIHByb3BlcnR5LCB7CiAgICB2YWx1ZSwKICAgIGNvbmZpZ3VyYWJsZQogIH0pOwp9CmZ1bmN0aW9uIHJlZ2lzdGVyRGlzcGF0Y2hlciQxKGV2ZW50Q29udHJhY3QsIGRpc3BhdGNoZXIpIHsKICBldmVudENvbnRyYWN0LmVjcmQoKGV2ZW50SW5mbykgPT4gewogICAgZGlzcGF0Y2hlci5kaXNwYXRjaChldmVudEluZm8pOwogIH0sIFJlc3RyaWN0aW9uLklfQU1fVEhFX0pTQUNUSU9OX0ZSQU1FV09SSyk7Cn0KZnVuY3Rpb24gZ2V0UXVldWVkRXZlbnRJbmZvcyhlYXJseUpzYWN0aW9uRGF0YSkgewogIHJldHVybiBlYXJseUpzYWN0aW9uRGF0YT8ucSA/PyBbXTsKfQpmdW5jdGlvbiByZW1vdmVBbGxFdmVudExpc3RlbmVycyhlYXJseUpzYWN0aW9uRGF0YSkgewogIGlmICghZWFybHlKc2FjdGlvbkRhdGEpIHsKICAgIHJldHVybjsKICB9CiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoZWFybHlKc2FjdGlvbkRhdGEuYywgZWFybHlKc2FjdGlvbkRhdGEuZXQsIGVhcmx5SnNhY3Rpb25EYXRhLmgpOwogIHJlbW92ZUV2ZW50TGlzdGVuZXJzKGVhcmx5SnNhY3Rpb25EYXRhLmMsIGVhcmx5SnNhY3Rpb25EYXRhLmV0YywgZWFybHlKc2FjdGlvbkRhdGEuaCwgdHJ1ZSk7Cn0KZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoY29udGFpbmVyLCBldmVudFR5cGVzLCBlYXJseUV2ZW50SGFuZGxlciwgY2FwdHVyZSkgewogIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRUeXBlcy5sZW5ndGg7IGkrKykgewogICAgY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlc1tpXSwgZWFybHlFdmVudEhhbmRsZXIsIGNhcHR1cmUpOwogIH0KfQp2YXIgTU9VU0VfU1BFQ0lBTF9TVVBQT1JUID0gZmFsc2U7CnZhciBFdmVudENvbnRyYWN0ID0gY2xhc3MgX0V2ZW50Q29udHJhY3QgewogIHN0YXRpYyBNT1VTRV9TUEVDSUFMX1NVUFBPUlQgPSBNT1VTRV9TUEVDSUFMX1NVUFBPUlQ7CiAgY29udGFpbmVyTWFuYWdlcjsKICBldmVudEhhbmRsZXJzID0ge307CiAgYnJvd3NlckV2ZW50VHlwZVRvRXh0cmFFdmVudFR5cGVzID0ge307CiAgZGlzcGF0Y2hlciA9IG51bGw7CiAgcXVldWVkRXZlbnRJbmZvcyA9IFtdOwogIGNvbnN0cnVjdG9yKGNvbnRhaW5lck1hbmFnZXIpIHsKICAgIHRoaXMuY29udGFpbmVyTWFuYWdlciA9IGNvbnRhaW5lck1hbmFnZXI7CiAgfQogIGhhbmRsZUV2ZW50KGV2ZW50VHlwZSwgZXZlbnQsIGNvbnRhaW5lcikgewogICAgY29uc3QgZXZlbnRJbmZvID0gY3JlYXRlRXZlbnRJbmZvRnJvbVBhcmFtZXRlcnMoZXZlbnRUeXBlLCBldmVudCwgZXZlbnQudGFyZ2V0LCBjb250YWluZXIsIERhdGUubm93KCkpOwogICAgdGhpcy5oYW5kbGVFdmVudEluZm8oZXZlbnRJbmZvKTsKICB9CiAgaGFuZGxlRXZlbnRJbmZvKGV2ZW50SW5mbykgewogICAgaWYgKCF0aGlzLmRpc3BhdGNoZXIpIHsKICAgICAgc2V0SXNSZXBsYXkoZXZlbnRJbmZvLCB0cnVlKTsKICAgICAgdGhpcy5xdWV1ZWRFdmVudEluZm9zPy5wdXNoKGV2ZW50SW5mbyk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHRoaXMuZGlzcGF0Y2hlcihldmVudEluZm8pOwogIH0KICBhZGRFdmVudChldmVudFR5cGUsIHByZWZpeGVkRXZlbnRUeXBlLCBwYXNzaXZlKSB7CiAgICBpZiAoZXZlbnRUeXBlIGluIHRoaXMuZXZlbnRIYW5kbGVycyB8fCAhdGhpcy5jb250YWluZXJNYW5hZ2VyKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghX0V2ZW50Q29udHJhY3QuTU9VU0VfU1BFQ0lBTF9TVVBQT1JUICYmIE1PVVNFX1NQRUNJQUxfRVZFTlRfVFlQRVMuaW5kZXhPZihldmVudFR5cGUpID49IDApIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgZXZlbnRIYW5kbGVyID0gKGV2ZW50VHlwZTIsIGV2ZW50LCBjb250YWluZXIpID0+IHsKICAgICAgdGhpcy5oYW5kbGVFdmVudChldmVudFR5cGUyLCBldmVudCwgY29udGFpbmVyKTsKICAgIH07CiAgICB0aGlzLmV2ZW50SGFuZGxlcnNbZXZlbnRUeXBlXSA9IGV2ZW50SGFuZGxlcjsKICAgIGNvbnN0IGJyb3dzZXJFdmVudFR5cGUgPSBnZXRCcm93c2VyRXZlbnRUeXBlKHByZWZpeGVkRXZlbnRUeXBlIHx8IGV2ZW50VHlwZSk7CiAgICBpZiAoYnJvd3NlckV2ZW50VHlwZSAhPT0gZXZlbnRUeXBlKSB7CiAgICAgIGNvbnN0IGV2ZW50VHlwZXMgPSB0aGlzLmJyb3dzZXJFdmVudFR5cGVUb0V4dHJhRXZlbnRUeXBlc1ticm93c2VyRXZlbnRUeXBlXSB8fCBbXTsKICAgICAgZXZlbnRUeXBlcy5wdXNoKGV2ZW50VHlwZSk7CiAgICAgIHRoaXMuYnJvd3NlckV2ZW50VHlwZVRvRXh0cmFFdmVudFR5cGVzW2Jyb3dzZXJFdmVudFR5cGVdID0gZXZlbnRUeXBlczsKICAgIH0KICAgIHRoaXMuY29udGFpbmVyTWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGJyb3dzZXJFdmVudFR5cGUsIChlbGVtZW50KSA9PiB7CiAgICAgIHJldHVybiAoZXZlbnQpID0+IHsKICAgICAgICBldmVudEhhbmRsZXIoZXZlbnRUeXBlLCBldmVudCwgZWxlbWVudCk7CiAgICAgIH07CiAgICB9LCBwYXNzaXZlKTsKICB9CiAgcmVwbGF5RWFybHlFdmVudHMoZWFybHlKc2FjdGlvbkRhdGEgPSB3aW5kb3cuX2Vqc2EpIHsKICAgIGlmICghZWFybHlKc2FjdGlvbkRhdGEpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5yZXBsYXlFYXJseUV2ZW50SW5mb3MoZWFybHlKc2FjdGlvbkRhdGEucSk7CiAgICByZW1vdmVBbGxFdmVudExpc3RlbmVycyhlYXJseUpzYWN0aW9uRGF0YSk7CiAgICBkZWxldGUgd2luZG93Ll9lanNhOwogIH0KICByZXBsYXlFYXJseUV2ZW50SW5mb3MoZWFybHlFdmVudEluZm9zKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVhcmx5RXZlbnRJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBlYXJseUV2ZW50SW5mbyA9IGVhcmx5RXZlbnRJbmZvc1tpXTsKICAgICAgY29uc3QgZXZlbnRUeXBlcyA9IHRoaXMuZ2V0RXZlbnRUeXBlc0ZvckJyb3dzZXJFdmVudFR5cGUoZWFybHlFdmVudEluZm8uZXZlbnRUeXBlKTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBldmVudFR5cGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgY29uc3QgZXZlbnRJbmZvID0gY2xvbmVFdmVudEluZm8oZWFybHlFdmVudEluZm8pOwogICAgICAgIHNldEV2ZW50VHlwZShldmVudEluZm8sIGV2ZW50VHlwZXNbal0pOwogICAgICAgIHRoaXMuaGFuZGxlRXZlbnRJbmZvKGV2ZW50SW5mbyk7CiAgICAgIH0KICAgIH0KICB9CiAgZ2V0RXZlbnRUeXBlc0ZvckJyb3dzZXJFdmVudFR5cGUoYnJvd3NlckV2ZW50VHlwZSkgewogICAgY29uc3QgZXZlbnRUeXBlcyA9IFtdOwogICAgaWYgKHRoaXMuZXZlbnRIYW5kbGVyc1ticm93c2VyRXZlbnRUeXBlXSkgewogICAgICBldmVudFR5cGVzLnB1c2goYnJvd3NlckV2ZW50VHlwZSk7CiAgICB9CiAgICBpZiAodGhpcy5icm93c2VyRXZlbnRUeXBlVG9FeHRyYUV2ZW50VHlwZXNbYnJvd3NlckV2ZW50VHlwZV0pIHsKICAgICAgZXZlbnRUeXBlcy5wdXNoKC4uLnRoaXMuYnJvd3NlckV2ZW50VHlwZVRvRXh0cmFFdmVudFR5cGVzW2Jyb3dzZXJFdmVudFR5cGVdKTsKICAgIH0KICAgIHJldHVybiBldmVudFR5cGVzOwogIH0KICBoYW5kbGVyKGV2ZW50VHlwZSkgewogICAgcmV0dXJuIHRoaXMuZXZlbnRIYW5kbGVyc1tldmVudFR5cGVdOwogIH0KICBjbGVhblVwKCkgewogICAgdGhpcy5jb250YWluZXJNYW5hZ2VyPy5jbGVhblVwKCk7CiAgICB0aGlzLmNvbnRhaW5lck1hbmFnZXIgPSBudWxsOwogICAgdGhpcy5ldmVudEhhbmRsZXJzID0ge307CiAgICB0aGlzLmJyb3dzZXJFdmVudFR5cGVUb0V4dHJhRXZlbnRUeXBlcyA9IHt9OwogICAgdGhpcy5kaXNwYXRjaGVyID0gbnVsbDsKICAgIHRoaXMucXVldWVkRXZlbnRJbmZvcyA9IFtdOwogIH0KICByZWdpc3RlckRpc3BhdGNoZXIoZGlzcGF0Y2hlciwgcmVzdHJpY3Rpb24pIHsKICAgIHRoaXMuZWNyZChkaXNwYXRjaGVyLCByZXN0cmljdGlvbik7CiAgfQogIGVjcmQoZGlzcGF0Y2hlciwgcmVzdHJpY3Rpb24pIHsKICAgIHRoaXMuZGlzcGF0Y2hlciA9IGRpc3BhdGNoZXI7CiAgICBpZiAodGhpcy5xdWV1ZWRFdmVudEluZm9zPy5sZW5ndGgpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnF1ZXVlZEV2ZW50SW5mb3MubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLmhhbmRsZUV2ZW50SW5mbyh0aGlzLnF1ZXVlZEV2ZW50SW5mb3NbaV0pOwogICAgICB9CiAgICAgIHRoaXMucXVldWVkRXZlbnRJbmZvcyA9IG51bGw7CiAgICB9CiAgfQp9OwpmdW5jdGlvbiBnZXRBcHBTY29wZWRRdWV1ZWRFdmVudEluZm9zKGFwcElkLCBkYXRhQ29udGFpbmVyID0gd2luZG93KSB7CiAgcmV0dXJuIGdldFF1ZXVlZEV2ZW50SW5mb3MoZGF0YUNvbnRhaW5lci5fZWpzYXM/LlthcHBJZF0pOwp9CmZ1bmN0aW9uIGNsZWFyQXBwU2NvcGVkRWFybHlFdmVudENvbnRyYWN0KGFwcElkLCBkYXRhQ29udGFpbmVyID0gd2luZG93KSB7CiAgaWYgKCFkYXRhQ29udGFpbmVyLl9lanNhcykgewogICAgcmV0dXJuOwogIH0KICBkYXRhQ29udGFpbmVyLl9lanNhc1thcHBJZF0gPSB2b2lkIDA7Cn0KCi8vIG5vZGVfbW9kdWxlcy9AYW5ndWxhci9jb3JlL2Zlc20yMDIyL2NvcmUubWpzCnZhciBSRVFVSVJFRF9VTlNFVF9WQUxVRSA9IC8qIEBfX1BVUkVfXyAqLyBTeW1ib2woIklucHV0U2lnbmFsTm9kZSNVTlNFVCIpOwp2YXIgSU5QVVRfU0lHTkFMX05PREUgPSAoKCkgPT4gewogIHJldHVybiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBTSUdOQUxfTk9ERSksIHsKICAgIHRyYW5zZm9ybUZuOiB2b2lkIDAsCiAgICBhcHBseVZhbHVlVG9JbnB1dFNpZ25hbChub2RlLCB2YWx1ZSkgewogICAgICBzaWduYWxTZXRGbihub2RlLCB2YWx1ZSk7CiAgICB9CiAgfSk7Cn0pKCk7CnZhciDJtUlOUFVUX1NJR05BTF9CUkFORF9XUklURV9UWVBFID0gLyogQF9fUFVSRV9fICovIFN5bWJvbCgpOwpmdW5jdGlvbiBjcmVhdGVJbnB1dFNpZ25hbChpbml0aWFsVmFsdWUsIG9wdGlvbnMpIHsKICBjb25zdCBub2RlID0gT2JqZWN0LmNyZWF0ZShJTlBVVF9TSUdOQUxfTk9ERSk7CiAgbm9kZS52YWx1ZSA9IGluaXRpYWxWYWx1ZTsKICBub2RlLnRyYW5zZm9ybUZuID0gb3B0aW9ucz8udHJhbnNmb3JtOwogIGZ1bmN0aW9uIGlucHV0VmFsdWVGbigpIHsKICAgIHByb2R1Y2VyQWNjZXNzZWQobm9kZSk7CiAgICBpZiAobm9kZS52YWx1ZSA9PT0gUkVRVUlSRURfVU5TRVRfVkFMVUUpIHsKICAgICAgbGV0IG1lc3NhZ2UgPSBudWxsOwogICAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgICAgY29uc3QgbmFtZSA9IG9wdGlvbnM/LmRlYnVnTmFtZSA/PyBvcHRpb25zPy5hbGlhczsKICAgICAgICBtZXNzYWdlID0gYElucHV0JHtuYW1lID8gYCAiJHtuYW1lfSJgIDogIiJ9IGlzIHJlcXVpcmVkIGJ1dCBubyB2YWx1ZSBpcyBhdmFpbGFibGUgeWV0LmA7CiAgICAgIH0KICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtOTUwLCBtZXNzYWdlKTsKICAgIH0KICAgIHJldHVybiBub2RlLnZhbHVlOwogIH0KICBpbnB1dFZhbHVlRm5bU0lHTkFMXSA9IG5vZGU7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgaW5wdXRWYWx1ZUZuLnRvU3RyaW5nID0gKCkgPT4gYFtJbnB1dCBTaWduYWw6ICR7aW5wdXRWYWx1ZUZuKCl9XWA7CiAgICBub2RlLmRlYnVnTmFtZSA9IG9wdGlvbnM/LmRlYnVnTmFtZTsKICB9CiAgcmV0dXJuIGlucHV0VmFsdWVGbjsKfQp2YXIgRmFjdG9yeVRhcmdldDsKKGZ1bmN0aW9uKEZhY3RvcnlUYXJnZXQyKSB7CiAgRmFjdG9yeVRhcmdldDJbRmFjdG9yeVRhcmdldDJbIkRpcmVjdGl2ZSJdID0gMF0gPSAiRGlyZWN0aXZlIjsKICBGYWN0b3J5VGFyZ2V0MltGYWN0b3J5VGFyZ2V0MlsiQ29tcG9uZW50Il0gPSAxXSA9ICJDb21wb25lbnQiOwogIEZhY3RvcnlUYXJnZXQyW0ZhY3RvcnlUYXJnZXQyWyJJbmplY3RhYmxlIl0gPSAyXSA9ICJJbmplY3RhYmxlIjsKICBGYWN0b3J5VGFyZ2V0MltGYWN0b3J5VGFyZ2V0MlsiUGlwZSJdID0gM10gPSAiUGlwZSI7CiAgRmFjdG9yeVRhcmdldDJbRmFjdG9yeVRhcmdldDJbIk5nTW9kdWxlIl0gPSA0XSA9ICJOZ01vZHVsZSI7Cn0pKEZhY3RvcnlUYXJnZXQgfHwgKEZhY3RvcnlUYXJnZXQgPSB7fSkpOwp2YXIgUjNUZW1wbGF0ZURlcGVuZGVuY3lLaW5kOwooZnVuY3Rpb24oUjNUZW1wbGF0ZURlcGVuZGVuY3lLaW5kMikgewogIFIzVGVtcGxhdGVEZXBlbmRlbmN5S2luZDJbUjNUZW1wbGF0ZURlcGVuZGVuY3lLaW5kMlsiRGlyZWN0aXZlIl0gPSAwXSA9ICJEaXJlY3RpdmUiOwogIFIzVGVtcGxhdGVEZXBlbmRlbmN5S2luZDJbUjNUZW1wbGF0ZURlcGVuZGVuY3lLaW5kMlsiUGlwZSJdID0gMV0gPSAiUGlwZSI7CiAgUjNUZW1wbGF0ZURlcGVuZGVuY3lLaW5kMltSM1RlbXBsYXRlRGVwZW5kZW5jeUtpbmQyWyJOZ01vZHVsZSJdID0gMl0gPSAiTmdNb2R1bGUiOwp9KShSM1RlbXBsYXRlRGVwZW5kZW5jeUtpbmQgfHwgKFIzVGVtcGxhdGVEZXBlbmRlbmN5S2luZCA9IHt9KSk7CnZhciBWaWV3RW5jYXBzdWxhdGlvbjI7CihmdW5jdGlvbihWaWV3RW5jYXBzdWxhdGlvbjMpIHsKICBWaWV3RW5jYXBzdWxhdGlvbjNbVmlld0VuY2Fwc3VsYXRpb24zWyJFbXVsYXRlZCJdID0gMF0gPSAiRW11bGF0ZWQiOwogIFZpZXdFbmNhcHN1bGF0aW9uM1tWaWV3RW5jYXBzdWxhdGlvbjNbIk5vbmUiXSA9IDJdID0gIk5vbmUiOwogIFZpZXdFbmNhcHN1bGF0aW9uM1tWaWV3RW5jYXBzdWxhdGlvbjNbIlNoYWRvd0RvbSJdID0gM10gPSAiU2hhZG93RG9tIjsKICBWaWV3RW5jYXBzdWxhdGlvbjNbVmlld0VuY2Fwc3VsYXRpb24zWyJFeHBlcmltZW50YWxJc29sYXRlZFNoYWRvd0RvbSJdID0gNF0gPSAiRXhwZXJpbWVudGFsSXNvbGF0ZWRTaGFkb3dEb20iOwp9KShWaWV3RW5jYXBzdWxhdGlvbjIgfHwgKFZpZXdFbmNhcHN1bGF0aW9uMiA9IHt9KSk7CnZhciBGcmFtZXdvcms7CihmdW5jdGlvbihGcmFtZXdvcmsyKSB7CiAgRnJhbWV3b3JrMlsiQW5ndWxhciJdID0gImFuZ3VsYXIiOwogIEZyYW1ld29yazJbIkFDWCJdID0gImFjeCI7CiAgRnJhbWV3b3JrMlsiV2l6Il0gPSAid2l6IjsKfSkoRnJhbWV3b3JrIHx8IChGcmFtZXdvcmsgPSB7fSkpOwp2YXIgSG9zdEF0dHJpYnV0ZVRva2VuID0gY2xhc3MgewogIGF0dHJpYnV0ZU5hbWU7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlTmFtZTIpIHsKICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWUyOwogIH0KICBfX05HX0VMRU1FTlRfSURfXyA9ICgpID0+IMm1ybVpbmplY3RBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVOYW1lKTsKICB0b1N0cmluZygpIHsKICAgIHJldHVybiBgSG9zdEF0dHJpYnV0ZVRva2VuICR7dGhpcy5hdHRyaWJ1dGVOYW1lfWA7CiAgfQp9Owp2YXIgSE9TVF9UQUdfTkFNRSA9ICgoKSA9PiB7CiAgY29uc3QgSE9TVF9UQUdfTkFNRV9UT0tFTiA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiSE9TVF9UQUdfTkFNRSIgOiAiIik7CiAgSE9TVF9UQUdfTkFNRV9UT0tFTi5fX05HX0VMRU1FTlRfSURfXyA9IChmbGFncykgPT4gewogICAgY29uc3QgdE5vZGUgPSBnZXRDdXJyZW50VE5vZGUoKTsKICAgIGlmICh0Tm9kZSA9PT0gbnVsbCkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDIwNCwgbmdEZXZNb2RlICYmICJIT1NUX1RBR19OQU1FIGNhbiBvbmx5IGJlIGluamVjdGVkIGluIGRpcmVjdGl2ZXMgYW5kIGNvbXBvbmVudHMgZHVyaW5nIGNvbnN0cnVjdGlvbiB0aW1lIChpbiBhIGNsYXNzIGNvbnN0cnVjdG9yIG9yIGFzIGEgY2xhc3MgZmllbGQgaW5pdGlhbGl6ZXIpIik7CiAgICB9CiAgICBpZiAodE5vZGUudHlwZSAmIDIpIHsKICAgICAgcmV0dXJuIHROb2RlLnZhbHVlOwogICAgfQogICAgaWYgKGZsYWdzICYgOCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoMjA0LCBuZ0Rldk1vZGUgJiYgYEhPU1RfVEFHX05BTUUgd2FzIHVzZWQgb24gJHtnZXREZXZNb2RlTm9kZU5hbWUodE5vZGUpfSB3aGljaCBkb2Vzbid0IGhhdmUgYW4gdW5kZXJseWluZyBlbGVtZW50IGluIHRoZSBET00uIFRoaXMgaXMgaW52YWxpZCwgYW5kIHNvIHRoZSBkZXBlbmRlbmN5IHNob3VsZCBiZSBtYXJrZWQgYXMgb3B0aW9uYWwuYCk7CiAgfTsKICByZXR1cm4gSE9TVF9UQUdfTkFNRV9UT0tFTjsKfSkoKTsKZnVuY3Rpb24gZ2V0RGV2TW9kZU5vZGVOYW1lKHROb2RlKSB7CiAgaWYgKHROb2RlLnR5cGUgJiA4KSB7CiAgICByZXR1cm4gImFuIDxuZy1jb250YWluZXI+IjsKICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiA0KSB7CiAgICByZXR1cm4gImFuIDxuZy10ZW1wbGF0ZT4iOwogIH0gZWxzZSBpZiAodE5vZGUudHlwZSAmIDEyOCkgewogICAgcmV0dXJuICJhbiBAbGV0IGRlY2xhcmF0aW9uIjsKICB9IGVsc2UgewogICAgcmV0dXJuICJhIG5vZGUiOwogIH0KfQpmdW5jdGlvbiBvdXRwdXQob3B0cykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbkluamVjdGlvbkNvbnRleHQob3V0cHV0KTsKICByZXR1cm4gbmV3IE91dHB1dEVtaXR0ZXJSZWYoKTsKfQpmdW5jdGlvbiBpbnB1dEZ1bmN0aW9uKGluaXRpYWxWYWx1ZSwgb3B0cykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbkluamVjdGlvbkNvbnRleHQoaW5wdXQpOwogIHJldHVybiBjcmVhdGVJbnB1dFNpZ25hbChpbml0aWFsVmFsdWUsIG9wdHMpOwp9CmZ1bmN0aW9uIGlucHV0UmVxdWlyZWRGdW5jdGlvbihvcHRzKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEluSW5qZWN0aW9uQ29udGV4dChpbnB1dCk7CiAgcmV0dXJuIGNyZWF0ZUlucHV0U2lnbmFsKFJFUVVJUkVEX1VOU0VUX1ZBTFVFLCBvcHRzKTsKfQp2YXIgaW5wdXQgPSAoKCkgPT4gewogIGlucHV0RnVuY3Rpb24ucmVxdWlyZWQgPSBpbnB1dFJlcXVpcmVkRnVuY3Rpb247CiAgcmV0dXJuIGlucHV0RnVuY3Rpb247Cn0pKCk7CmZ1bmN0aW9uIHZpZXdDaGlsZEZuKGxvY2F0b3IsIG9wdHMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0KHZpZXdDaGlsZCk7CiAgcmV0dXJuIGNyZWF0ZVNpbmdsZVJlc3VsdE9wdGlvbmFsUXVlcnlTaWduYWxGbihvcHRzKTsKfQpmdW5jdGlvbiB2aWV3Q2hpbGRSZXF1aXJlZEZuKGxvY2F0b3IsIG9wdHMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0KHZpZXdDaGlsZCk7CiAgcmV0dXJuIGNyZWF0ZVNpbmdsZVJlc3VsdFJlcXVpcmVkUXVlcnlTaWduYWxGbihvcHRzKTsKfQp2YXIgdmlld0NoaWxkID0gKCgpID0+IHsKICB2aWV3Q2hpbGRGbi5yZXF1aXJlZCA9IHZpZXdDaGlsZFJlcXVpcmVkRm47CiAgcmV0dXJuIHZpZXdDaGlsZEZuOwp9KSgpOwpmdW5jdGlvbiB2aWV3Q2hpbGRyZW4obG9jYXRvciwgb3B0cykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbkluamVjdGlvbkNvbnRleHQodmlld0NoaWxkcmVuKTsKICByZXR1cm4gY3JlYXRlTXVsdGlSZXN1bHRRdWVyeVNpZ25hbEZuKG9wdHMpOwp9CmZ1bmN0aW9uIGNvbnRlbnRDaGlsZEZuKGxvY2F0b3IsIG9wdHMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0KGNvbnRlbnRDaGlsZCk7CiAgcmV0dXJuIGNyZWF0ZVNpbmdsZVJlc3VsdE9wdGlvbmFsUXVlcnlTaWduYWxGbihvcHRzKTsKfQpmdW5jdGlvbiBjb250ZW50Q2hpbGRSZXF1aXJlZEZuKGxvY2F0b3IsIG9wdHMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0SW5JbmplY3Rpb25Db250ZXh0KGNvbnRlbnRDaGlsZHJlbik7CiAgcmV0dXJuIGNyZWF0ZVNpbmdsZVJlc3VsdFJlcXVpcmVkUXVlcnlTaWduYWxGbihvcHRzKTsKfQp2YXIgY29udGVudENoaWxkID0gKCgpID0+IHsKICBjb250ZW50Q2hpbGRGbi5yZXF1aXJlZCA9IGNvbnRlbnRDaGlsZFJlcXVpcmVkRm47CiAgcmV0dXJuIGNvbnRlbnRDaGlsZEZuOwp9KSgpOwpmdW5jdGlvbiBjb250ZW50Q2hpbGRyZW4obG9jYXRvciwgb3B0cykgewogIHJldHVybiBjcmVhdGVNdWx0aVJlc3VsdFF1ZXJ5U2lnbmFsRm4ob3B0cyk7Cn0KZnVuY3Rpb24gY3JlYXRlTW9kZWxTaWduYWwoaW5pdGlhbFZhbHVlLCBvcHRzKSB7CiAgY29uc3Qgbm9kZSA9IE9iamVjdC5jcmVhdGUoSU5QVVRfU0lHTkFMX05PREUpOwogIGNvbnN0IGVtaXR0ZXJSZWYgPSBuZXcgT3V0cHV0RW1pdHRlclJlZigpOwogIG5vZGUudmFsdWUgPSBpbml0aWFsVmFsdWU7CiAgZnVuY3Rpb24gZ2V0dGVyKCkgewogICAgcHJvZHVjZXJBY2Nlc3NlZChub2RlKTsKICAgIGFzc2VydE1vZGVsU2V0KG5vZGUudmFsdWUpOwogICAgcmV0dXJuIG5vZGUudmFsdWU7CiAgfQogIGdldHRlcltTSUdOQUxdID0gbm9kZTsKICBnZXR0ZXIuYXNSZWFkb25seSA9IHNpZ25hbEFzUmVhZG9ubHlGbi5iaW5kKGdldHRlcik7CiAgZ2V0dGVyLnNldCA9IChuZXdWYWx1ZSkgPT4gewogICAgaWYgKCFub2RlLmVxdWFsKG5vZGUudmFsdWUsIG5ld1ZhbHVlKSkgewogICAgICBzaWduYWxTZXRGbihub2RlLCBuZXdWYWx1ZSk7CiAgICAgIGVtaXR0ZXJSZWYuZW1pdChuZXdWYWx1ZSk7CiAgICB9CiAgfTsKICBnZXR0ZXIudXBkYXRlID0gKHVwZGF0ZUZuKSA9PiB7CiAgICBhc3NlcnRNb2RlbFNldChub2RlLnZhbHVlKTsKICAgIGdldHRlci5zZXQodXBkYXRlRm4obm9kZS52YWx1ZSkpOwogIH07CiAgZ2V0dGVyLnN1YnNjcmliZSA9IGVtaXR0ZXJSZWYuc3Vic2NyaWJlLmJpbmQoZW1pdHRlclJlZik7CiAgZ2V0dGVyLmRlc3Ryb3lSZWYgPSBlbWl0dGVyUmVmLmRlc3Ryb3lSZWY7CiAgaWYgKG5nRGV2TW9kZSkgewogICAgZ2V0dGVyLnRvU3RyaW5nID0gKCkgPT4gYFtNb2RlbCBTaWduYWw6ICR7Z2V0dGVyKCl9XWA7CiAgICBub2RlLmRlYnVnTmFtZSA9IG9wdHM/LmRlYnVnTmFtZTsKICB9CiAgcmV0dXJuIGdldHRlcjsKfQpmdW5jdGlvbiBhc3NlcnRNb2RlbFNldCh2YWx1ZSkgewogIGlmICh2YWx1ZSA9PT0gUkVRVUlSRURfVU5TRVRfVkFMVUUpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoOTUyLCBuZ0Rldk1vZGUgJiYgIk1vZGVsIGlzIHJlcXVpcmVkIGJ1dCBubyB2YWx1ZSBpcyBhdmFpbGFibGUgeWV0LiIpOwogIH0KfQpmdW5jdGlvbiBtb2RlbEZ1bmN0aW9uKGluaXRpYWxWYWx1ZSwgb3B0cykgewogIG5nRGV2TW9kZSAmJiBhc3NlcnRJbkluamVjdGlvbkNvbnRleHQobW9kZWwpOwogIHJldHVybiBjcmVhdGVNb2RlbFNpZ25hbChpbml0aWFsVmFsdWUsIG9wdHMpOwp9CmZ1bmN0aW9uIG1vZGVsUmVxdWlyZWRGdW5jdGlvbihvcHRzKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydEluSW5qZWN0aW9uQ29udGV4dChtb2RlbCk7CiAgcmV0dXJuIGNyZWF0ZU1vZGVsU2lnbmFsKFJFUVVJUkVEX1VOU0VUX1ZBTFVFLCBvcHRzKTsKfQp2YXIgbW9kZWwgPSAoKCkgPT4gewogIG1vZGVsRnVuY3Rpb24ucmVxdWlyZWQgPSBtb2RlbFJlcXVpcmVkRnVuY3Rpb247CiAgcmV0dXJuIG1vZGVsRnVuY3Rpb247Cn0pKCk7CnZhciBlbWl0RGlzdGluY3RDaGFuZ2VzT25seURlZmF1bHRWYWx1ZSA9IHRydWU7CnZhciBRdWVyeSA9IGNsYXNzIHsKfTsKdmFyIENvbnRlbnRDaGlsZHJlbiA9IG1ha2VQcm9wRGVjb3JhdG9yKCJDb250ZW50Q2hpbGRyZW4iLCAoc2VsZWN0b3IsIG9wdHMgPSB7fSkgPT4gX19zcHJlYWRWYWx1ZXMoewogIHNlbGVjdG9yLAogIGZpcnN0OiBmYWxzZSwKICBpc1ZpZXdRdWVyeTogZmFsc2UsCiAgZGVzY2VuZGFudHM6IGZhbHNlLAogIGVtaXREaXN0aW5jdENoYW5nZXNPbmx5OiBlbWl0RGlzdGluY3RDaGFuZ2VzT25seURlZmF1bHRWYWx1ZQp9LCBvcHRzKSwgUXVlcnkpOwp2YXIgQ29udGVudENoaWxkID0gbWFrZVByb3BEZWNvcmF0b3IoIkNvbnRlbnRDaGlsZCIsIChzZWxlY3Rvciwgb3B0cyA9IHt9KSA9PiBfX3NwcmVhZFZhbHVlcyh7CiAgc2VsZWN0b3IsCiAgZmlyc3Q6IHRydWUsCiAgaXNWaWV3UXVlcnk6IGZhbHNlLAogIGRlc2NlbmRhbnRzOiB0cnVlCn0sIG9wdHMpLCBRdWVyeSk7CnZhciBWaWV3Q2hpbGRyZW4gPSBtYWtlUHJvcERlY29yYXRvcigiVmlld0NoaWxkcmVuIiwgKHNlbGVjdG9yLCBvcHRzID0ge30pID0+IF9fc3ByZWFkVmFsdWVzKHsKICBzZWxlY3RvciwKICBmaXJzdDogZmFsc2UsCiAgaXNWaWV3UXVlcnk6IHRydWUsCiAgZGVzY2VuZGFudHM6IHRydWUsCiAgZW1pdERpc3RpbmN0Q2hhbmdlc09ubHk6IGVtaXREaXN0aW5jdENoYW5nZXNPbmx5RGVmYXVsdFZhbHVlCn0sIG9wdHMpLCBRdWVyeSk7CnZhciBWaWV3Q2hpbGQgPSBtYWtlUHJvcERlY29yYXRvcigiVmlld0NoaWxkIiwgKHNlbGVjdG9yLCBvcHRzKSA9PiBfX3NwcmVhZFZhbHVlcyh7CiAgc2VsZWN0b3IsCiAgZmlyc3Q6IHRydWUsCiAgaXNWaWV3UXVlcnk6IHRydWUsCiAgZGVzY2VuZGFudHM6IHRydWUKfSwgb3B0cyksIFF1ZXJ5KTsKZnVuY3Rpb24gY29tcGlsZU5nTW9kdWxlRmFjdG9yeShpbmplY3Rvciwgb3B0aW9ucywgbW9kdWxlVHlwZSkgewogIG5nRGV2TW9kZSAmJiBhc3NlcnROZ01vZHVsZVR5cGUobW9kdWxlVHlwZSk7CiAgY29uc3QgbW9kdWxlRmFjdG9yeSA9IG5ldyBOZ01vZHVsZUZhY3RvcnkyKG1vZHVsZVR5cGUpOwogIGlmICh0cnVlKSB7CiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1vZHVsZUZhY3RvcnkpOwogIH0KICBjb25zdCBjb21waWxlck9wdGlvbnMgPSBpbmplY3Rvci5nZXQoQ09NUElMRVJfT1BUSU9OUywgW10pLmNvbmNhdChvcHRpb25zKTsKICBzZXRKaXRPcHRpb25zKHsKICAgIGRlZmF1bHRFbmNhcHN1bGF0aW9uOiBfbGFzdERlZmluZWQoY29tcGlsZXJPcHRpb25zLm1hcCgob3B0cykgPT4gb3B0cy5kZWZhdWx0RW5jYXBzdWxhdGlvbikpLAogICAgcHJlc2VydmVXaGl0ZXNwYWNlczogX2xhc3REZWZpbmVkKGNvbXBpbGVyT3B0aW9ucy5tYXAoKG9wdHMpID0+IG9wdHMucHJlc2VydmVXaGl0ZXNwYWNlcykpCiAgfSk7CiAgaWYgKGlzQ29tcG9uZW50UmVzb3VyY2VSZXNvbHV0aW9uUXVldWVFbXB0eSgpKSB7CiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1vZHVsZUZhY3RvcnkpOwogIH0KICBjb25zdCBjb21waWxlclByb3ZpZGVycyA9IGNvbXBpbGVyT3B0aW9ucy5mbGF0TWFwKChvcHRpb24pID0+IG9wdGlvbi5wcm92aWRlcnMgPz8gW10pOwogIGlmIChjb21waWxlclByb3ZpZGVycy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobW9kdWxlRmFjdG9yeSk7CiAgfQogIGNvbnN0IGNvbXBpbGVyID0gZ2V0Q29tcGlsZXJGYWNhZGUoewogICAgdXNhZ2U6IDAsCiAgICBraW5kOiAiTmdNb2R1bGUiLAogICAgdHlwZTogbW9kdWxlVHlwZQogIH0pOwogIGNvbnN0IGNvbXBpbGVySW5qZWN0b3IgPSBJbmplY3Rvci5jcmVhdGUoewogICAgcHJvdmlkZXJzOiBjb21waWxlclByb3ZpZGVycwogIH0pOwogIGNvbnN0IHJlc291cmNlTG9hZGVyID0gY29tcGlsZXJJbmplY3Rvci5nZXQoY29tcGlsZXIuUmVzb3VyY2VMb2FkZXIpOwogIHJldHVybiByZXNvbHZlQ29tcG9uZW50UmVzb3VyY2VzKCh1cmwpID0+IFByb21pc2UucmVzb2x2ZShyZXNvdXJjZUxvYWRlci5nZXQodXJsKSkpLnRoZW4oKCkgPT4gbW9kdWxlRmFjdG9yeSk7Cn0KZnVuY3Rpb24gX2xhc3REZWZpbmVkKGFyZ3MpIHsKICBmb3IgKGxldCBpID0gYXJncy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgaWYgKGFyZ3NbaV0gIT09IHZvaWQgMCkgewogICAgICByZXR1cm4gYXJnc1tpXTsKICAgIH0KICB9CiAgcmV0dXJuIHZvaWQgMDsKfQp2YXIgTmdab25lQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyID0gY2xhc3MgX05nWm9uZUNoYW5nZURldGVjdGlvblNjaGVkdWxlciB7CiAgem9uZSA9IGluamVjdDIoTmdab25lKTsKICBjaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIgPSBpbmplY3QyKENoYW5nZURldGVjdGlvblNjaGVkdWxlcik7CiAgYXBwbGljYXRpb25SZWYgPSBpbmplY3QyKEFwcGxpY2F0aW9uUmVmKTsKICBhcHBsaWNhdGlvbkVycm9ySGFuZGxlciA9IGluamVjdDIoSU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUik7CiAgX29uTWljcm90YXNrRW1wdHlTdWJzY3JpcHRpb247CiAgaW5pdGlhbGl6ZSgpIHsKICAgIGlmICh0aGlzLl9vbk1pY3JvdGFza0VtcHR5U3Vic2NyaXB0aW9uKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHRoaXMuX29uTWljcm90YXNrRW1wdHlTdWJzY3JpcHRpb24gPSB0aGlzLnpvbmUub25NaWNyb3Rhc2tFbXB0eS5zdWJzY3JpYmUoewogICAgICBuZXh0OiAoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMuY2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyLnJ1bm5pbmdUaWNrKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4gewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvblJlZi5kaXJ0eUZsYWdzIHw9IDE7CiAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25SZWYuX3RpY2soKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbkVycm9ySGFuZGxlcihlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfQogIG5nT25EZXN0cm95KCkgewogICAgdGhpcy5fb25NaWNyb3Rhc2tFbXB0eVN1YnNjcmlwdGlvbj8udW5zdWJzY3JpYmUoKTsKICB9CiAgc3RhdGljIMm1ZmFjID0gZnVuY3Rpb24gTmdab25lQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyX0ZhY3RvcnkoX19uZ0ZhY3RvcnlUeXBlX18pIHsKICAgIHJldHVybiBuZXcgKF9fbmdGYWN0b3J5VHlwZV9fIHx8IF9OZ1pvbmVDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIpKCk7CiAgfTsKICBzdGF0aWMgybVwcm92ID0gybXJtWRlZmluZUluamVjdGFibGUoewogICAgdG9rZW46IF9OZ1pvbmVDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIsCiAgICBmYWN0b3J5OiBfTmdab25lQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyLsm1ZmFjLAogICAgcHJvdmlkZWRJbjogInJvb3QiCiAgfSk7Cn07CigoKSA9PiB7CiAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgc2V0Q2xhc3NNZXRhZGF0YShOZ1pvbmVDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIsIFt7CiAgICB0eXBlOiBJbmplY3RhYmxlLAogICAgYXJnczogW3sKICAgICAgcHJvdmlkZWRJbjogInJvb3QiCiAgICB9XQogIH1dLCBudWxsLCBudWxsKTsKfSkoKTsKdmFyIFBST1ZJREVEX05HX1pPTkUgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gInByb3ZpZGVab25lQ2hhbmdlRGV0ZWN0aW9uIHRva2VuIiA6ICIiLCB7CiAgZmFjdG9yeTogKCkgPT4gZmFsc2UKfSk7CmZ1bmN0aW9uIGludGVybmFsUHJvdmlkZVpvbmVDaGFuZ2VEZXRlY3Rpb24oewogIG5nWm9uZUZhY3RvcnksCiAgc2NoZWR1bGVJblJvb3Rab25lCn0pIHsKICBuZ1pvbmVGYWN0b3J5ID8/PSAoKSA9PiBuZXcgTmdab25lKF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGdldE5nWm9uZU9wdGlvbnMoKSksIHsKICAgIHNjaGVkdWxlSW5Sb290Wm9uZQogIH0pKTsKICByZXR1cm4gW3sKICAgIHByb3ZpZGU6IFpPTkVMRVNTX0VOQUJMRUQsCiAgICB1c2VWYWx1ZTogZmFsc2UKICB9LCB7CiAgICBwcm92aWRlOiBOZ1pvbmUsCiAgICB1c2VGYWN0b3J5OiBuZ1pvbmVGYWN0b3J5CiAgfSwgewogICAgcHJvdmlkZTogRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsCiAgICBtdWx0aTogdHJ1ZSwKICAgIHVzZUZhY3Rvcnk6ICgpID0+IHsKICAgICAgY29uc3Qgbmdab25lQ2hhbmdlRGV0ZWN0aW9uU2NoZWR1bGVyID0gaW5qZWN0MihOZ1pvbmVDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIsIHsKICAgICAgICBvcHRpb25hbDogdHJ1ZQogICAgICB9KTsKICAgICAgaWYgKCh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIG5nWm9uZUNoYW5nZURldGVjdGlvblNjaGVkdWxlciA9PT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoNDAyLCBgQSByZXF1aXJlZCBJbmplY3RhYmxlIHdhcyBub3QgZm91bmQgaW4gdGhlIGRlcGVuZGVuY3kgaW5qZWN0aW9uIHRyZWUuIElmIHlvdSBhcmUgYm9vdHN0cmFwcGluZyBhbiBOZ01vZHVsZSwgbWFrZSBzdXJlIHRoYXQgdGhlIFxgQnJvd3Nlck1vZHVsZVxgIGlzIGltcG9ydGVkLmApOwogICAgICB9CiAgICAgIHJldHVybiAoKSA9PiBuZ1pvbmVDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIuaW5pdGlhbGl6ZSgpOwogICAgfQogIH0sIHsKICAgIHByb3ZpZGU6IEVOVklST05NRU5UX0lOSVRJQUxJWkVSLAogICAgbXVsdGk6IHRydWUsCiAgICB1c2VGYWN0b3J5OiAoKSA9PiB7CiAgICAgIGNvbnN0IHNlcnZpY2UgPSBpbmplY3QyKFpvbmVTdGFibGVQZW5kaW5nVGFzayk7CiAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgc2VydmljZS5pbml0aWFsaXplKCk7CiAgICAgIH07CiAgICB9CiAgfSwgewogICAgcHJvdmlkZTogU0NIRURVTEVfSU5fUk9PVF9aT05FLAogICAgdXNlVmFsdWU6IHNjaGVkdWxlSW5Sb290Wm9uZSA/PyBTQ0hFRFVMRV9JTl9ST09UX1pPTkVfREVGQVVMVAogIH1dOwp9CmZ1bmN0aW9uIHByb3ZpZGVab25lQ2hhbmdlRGV0ZWN0aW9uKG9wdGlvbnMpIHsKICBjb25zdCBzY2hlZHVsZUluUm9vdFpvbmUgPSBvcHRpb25zPy5zY2hlZHVsZUluUm9vdFpvbmU7CiAgY29uc3Qgem9uZVByb3ZpZGVycyA9IGludGVybmFsUHJvdmlkZVpvbmVDaGFuZ2VEZXRlY3Rpb24oewogICAgbmdab25lRmFjdG9yeTogKCkgPT4gewogICAgICBjb25zdCBuZ1pvbmVPcHRpb25zID0gZ2V0Tmdab25lT3B0aW9ucyhvcHRpb25zKTsKICAgICAgbmdab25lT3B0aW9ucy5zY2hlZHVsZUluUm9vdFpvbmUgPSBzY2hlZHVsZUluUm9vdFpvbmU7CiAgICAgIGlmIChuZ1pvbmVPcHRpb25zLnNob3VsZENvYWxlc2NlRXZlbnRDaGFuZ2VEZXRlY3Rpb24pIHsKICAgICAgICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ1pvbmVfQ29hbGVzY2VFdmVudCIpOwogICAgICB9CiAgICAgIHJldHVybiBuZXcgTmdab25lKG5nWm9uZU9wdGlvbnMpOwogICAgfSwKICAgIHNjaGVkdWxlSW5Sb290Wm9uZQogIH0pOwogIHJldHVybiBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMoW3sKICAgIHByb3ZpZGU6IFBST1ZJREVEX05HX1pPTkUsCiAgICB1c2VWYWx1ZTogdHJ1ZQogIH0sIHpvbmVQcm92aWRlcnNdKTsKfQpmdW5jdGlvbiBnZXROZ1pvbmVPcHRpb25zKG9wdGlvbnMpIHsKICByZXR1cm4gewogICAgZW5hYmxlTG9uZ1N0YWNrVHJhY2U6IHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiID8gZmFsc2UgOiAhIW5nRGV2TW9kZSwKICAgIHNob3VsZENvYWxlc2NlRXZlbnRDaGFuZ2VEZXRlY3Rpb246IG9wdGlvbnM/LmV2ZW50Q29hbGVzY2luZyA/PyBmYWxzZSwKICAgIHNob3VsZENvYWxlc2NlUnVuQ2hhbmdlRGV0ZWN0aW9uOiBvcHRpb25zPy5ydW5Db2FsZXNjaW5nID8/IGZhbHNlCiAgfTsKfQp2YXIgWm9uZVN0YWJsZVBlbmRpbmdUYXNrID0gY2xhc3MgX1pvbmVTdGFibGVQZW5kaW5nVGFzayB7CiAgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpOwogIGluaXRpYWxpemVkID0gZmFsc2U7CiAgem9uZSA9IGluamVjdDIoTmdab25lKTsKICBwZW5kaW5nVGFza3MgPSBpbmplY3QyKFBlbmRpbmdUYXNrc0ludGVybmFsKTsKICBpbml0aWFsaXplKCkgewogICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7CiAgICBsZXQgdGFzayA9IG51bGw7CiAgICBpZiAoIXRoaXMuem9uZS5pc1N0YWJsZSAmJiAhdGhpcy56b25lLmhhc1BlbmRpbmdNYWNyb3Rhc2tzICYmICF0aGlzLnpvbmUuaGFzUGVuZGluZ01pY3JvdGFza3MpIHsKICAgICAgdGFzayA9IHRoaXMucGVuZGluZ1Rhc2tzLmFkZCgpOwogICAgfQogICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHsKICAgICAgdGhpcy5zdWJzY3JpcHRpb24uYWRkKHRoaXMuem9uZS5vblN0YWJsZS5zdWJzY3JpYmUoKCkgPT4gewogICAgICAgIE5nWm9uZS5hc3NlcnROb3RJbkFuZ3VsYXJab25lKCk7CiAgICAgICAgcXVldWVNaWNyb3Rhc2soKCkgPT4gewogICAgICAgICAgaWYgKHRhc2sgIT09IG51bGwgJiYgIXRoaXMuem9uZS5oYXNQZW5kaW5nTWFjcm90YXNrcyAmJiAhdGhpcy56b25lLmhhc1BlbmRpbmdNaWNyb3Rhc2tzKSB7CiAgICAgICAgICAgIHRoaXMucGVuZGluZ1Rhc2tzLnJlbW92ZSh0YXNrKTsKICAgICAgICAgICAgdGFzayA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pKTsKICAgIH0pOwogICAgdGhpcy5zdWJzY3JpcHRpb24uYWRkKHRoaXMuem9uZS5vblVuc3RhYmxlLnN1YnNjcmliZSgoKSA9PiB7CiAgICAgIE5nWm9uZS5hc3NlcnRJbkFuZ3VsYXJab25lKCk7CiAgICAgIHRhc2sgPz89IHRoaXMucGVuZGluZ1Rhc2tzLmFkZCgpOwogICAgfSkpOwogIH0KICBuZ09uRGVzdHJveSgpIHsKICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7CiAgfQogIHN0YXRpYyDJtWZhYyA9IGZ1bmN0aW9uIFpvbmVTdGFibGVQZW5kaW5nVGFza19GYWN0b3J5KF9fbmdGYWN0b3J5VHlwZV9fKSB7CiAgICByZXR1cm4gbmV3IChfX25nRmFjdG9yeVR5cGVfXyB8fCBfWm9uZVN0YWJsZVBlbmRpbmdUYXNrKSgpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfWm9uZVN0YWJsZVBlbmRpbmdUYXNrLAogICAgZmFjdG9yeTogX1pvbmVTdGFibGVQZW5kaW5nVGFzay7JtWZhYywKICAgIHByb3ZpZGVkSW46ICJyb290IgogIH0pOwp9OwooKCkgPT4gewogICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmIHNldENsYXNzTWV0YWRhdGEoWm9uZVN0YWJsZVBlbmRpbmdUYXNrLCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJyb290IgogICAgfV0KICB9XSwgbnVsbCwgbnVsbCk7Cn0pKCk7CnZhciBTQ0FOX0RFTEFZID0gMjAwOwp2YXIgT1ZFUlNJWkVEX0lNQUdFX1RPTEVSQU5DRSA9IDEyMDA7CnZhciBJbWFnZVBlcmZvcm1hbmNlV2FybmluZyA9IGNsYXNzIF9JbWFnZVBlcmZvcm1hbmNlV2FybmluZyB7CiAgd2luZG93ID0gbnVsbDsKICBvYnNlcnZlciA9IG51bGw7CiAgb3B0aW9ucyA9IGluamVjdDIoSU1BR0VfQ09ORklHKTsKICBsY3BJbWFnZVVybDsKICBzdGFydCgpIHsKICAgIGlmICh0eXBlb2YgUGVyZm9ybWFuY2VPYnNlcnZlciA9PT0gInVuZGVmaW5lZCIgfHwgdGhpcy5vcHRpb25zPy5kaXNhYmxlSW1hZ2VTaXplV2FybmluZyAmJiB0aGlzLm9wdGlvbnM/LmRpc2FibGVJbWFnZUxhenlMb2FkV2FybmluZykgewogICAgICByZXR1cm47CiAgICB9CiAgICB0aGlzLm9ic2VydmVyID0gdGhpcy5pbml0UGVyZm9ybWFuY2VPYnNlcnZlcigpOwogICAgY29uc3QgZG9jID0gZ2V0RG9jdW1lbnQoKTsKICAgIGNvbnN0IHdpbiA9IGRvYy5kZWZhdWx0VmlldzsKICAgIGlmICh3aW4pIHsKICAgICAgdGhpcy53aW5kb3cgPSB3aW47CiAgICAgIGNvbnN0IHdhaXRUb1NjYW4gPSAoKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCh0aGlzLnNjYW5JbWFnZXMuYmluZCh0aGlzKSwgU0NBTl9ERUxBWSk7CiAgICAgIH07CiAgICAgIGNvbnN0IHNldHVwID0gKCkgPT4gewogICAgICAgIGlmIChkb2MucmVhZHlTdGF0ZSA9PT0gImNvbXBsZXRlIikgewogICAgICAgICAgd2FpdFRvU2NhbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLndpbmRvdz8uYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsIHdhaXRUb1NjYW4sIHsKICAgICAgICAgICAgb25jZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBpZiAodHlwZW9mIFpvbmUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgWm9uZS5yb290LnJ1bigoKSA9PiBzZXR1cCgpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZXR1cCgpOwogICAgICB9CiAgICB9CiAgfQogIG5nT25EZXN0cm95KCkgewogICAgdGhpcy5vYnNlcnZlcj8uZGlzY29ubmVjdCgpOwogIH0KICBpbml0UGVyZm9ybWFuY2VPYnNlcnZlcigpIHsKICAgIGlmICh0eXBlb2YgUGVyZm9ybWFuY2VPYnNlcnZlciA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBQZXJmb3JtYW5jZU9ic2VydmVyKChlbnRyeUxpc3QpID0+IHsKICAgICAgY29uc3QgZW50cmllcyA9IGVudHJ5TGlzdC5nZXRFbnRyaWVzKCk7CiAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogICAgICBjb25zdCBsY3BFbGVtZW50ID0gZW50cmllc1tlbnRyaWVzLmxlbmd0aCAtIDFdOwogICAgICBjb25zdCBpbWdTcmMgPSBsY3BFbGVtZW50LmVsZW1lbnQ/LnNyYyA/PyAiIjsKICAgICAgaWYgKGltZ1NyYy5zdGFydHNXaXRoKCJkYXRhOiIpIHx8IGltZ1NyYy5zdGFydHNXaXRoKCJibG9iOiIpKSByZXR1cm47CiAgICAgIHRoaXMubGNwSW1hZ2VVcmwgPSBpbWdTcmM7CiAgICB9KTsKICAgIG9ic2VydmVyLm9ic2VydmUoewogICAgICB0eXBlOiAibGFyZ2VzdC1jb250ZW50ZnVsLXBhaW50IiwKICAgICAgYnVmZmVyZWQ6IHRydWUKICAgIH0pOwogICAgcmV0dXJuIG9ic2VydmVyOwogIH0KICBzY2FuSW1hZ2VzKCkgewogICAgY29uc3QgaW1hZ2VzID0gZ2V0RG9jdW1lbnQoKS5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKTsKICAgIGxldCBsY3BFbGVtZW50Rm91bmQsIGxjcEVsZW1lbnRMb2FkZWRDb3JyZWN0bHkgPSBmYWxzZTsKICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBpbWFnZXMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgIGNvbnN0IGltYWdlID0gaW1hZ2VzW2luZGV4XTsKICAgICAgaWYgKCFpbWFnZSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGlmICghdGhpcy5vcHRpb25zPy5kaXNhYmxlSW1hZ2VTaXplV2FybmluZykgewogICAgICAgIGlmICghaW1hZ2UuZ2V0QXR0cmlidXRlKCJuZy1pbWciKSAmJiB0aGlzLmlzT3ZlcnNpemVkKGltYWdlKSkgewogICAgICAgICAgbG9nT3ZlcnNpemVkSW1hZ2VXYXJuaW5nKGltYWdlLnNyYyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghdGhpcy5vcHRpb25zPy5kaXNhYmxlSW1hZ2VMYXp5TG9hZFdhcm5pbmcgJiYgdGhpcy5sY3BJbWFnZVVybCkgewogICAgICAgIGlmIChpbWFnZS5zcmMgPT09IHRoaXMubGNwSW1hZ2VVcmwpIHsKICAgICAgICAgIGxjcEVsZW1lbnRGb3VuZCA9IHRydWU7CiAgICAgICAgICBpZiAoaW1hZ2UubG9hZGluZyAhPT0gImxhenkiIHx8IGltYWdlLmdldEF0dHJpYnV0ZSgibmctaW1nIikpIHsKICAgICAgICAgICAgbGNwRWxlbWVudExvYWRlZENvcnJlY3RseSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAobGNwRWxlbWVudEZvdW5kICYmICFsY3BFbGVtZW50TG9hZGVkQ29ycmVjdGx5ICYmIHRoaXMubGNwSW1hZ2VVcmwgJiYgIXRoaXMub3B0aW9ucz8uZGlzYWJsZUltYWdlTGF6eUxvYWRXYXJuaW5nKSB7CiAgICAgIGxvZ0xhenlMQ1BXYXJuaW5nKHRoaXMubGNwSW1hZ2VVcmwpOwogICAgfQogIH0KICBpc092ZXJzaXplZChpbWFnZSkgewogICAgaWYgKCF0aGlzLndpbmRvdykgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBjb25zdCBub25PdmVyc2l6ZWRJbWFnZUV4dGVudGlvbnMgPSBbIi5zdmciXTsKICAgIGNvbnN0IGltYWdlU291cmNlID0gKGltYWdlLnNyYyB8fCAiIikudG9Mb3dlckNhc2UoKTsKICAgIGlmIChub25PdmVyc2l6ZWRJbWFnZUV4dGVudGlvbnMuc29tZSgoZXh0ZW5zaW9uKSA9PiBpbWFnZVNvdXJjZS5lbmRzV2l0aChleHRlbnNpb24pKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBjb25zdCBjb21wdXRlZFN0eWxlID0gdGhpcy53aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShpbWFnZSk7CiAgICBsZXQgcmVuZGVyZWRXaWR0aCA9IHBhcnNlRmxvYXQoY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCJ3aWR0aCIpKTsKICAgIGxldCByZW5kZXJlZEhlaWdodCA9IHBhcnNlRmxvYXQoY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCJoZWlnaHQiKSk7CiAgICBjb25zdCBib3hTaXppbmcgPSBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUoImJveC1zaXppbmciKTsKICAgIGNvbnN0IG9iamVjdEZpdCA9IGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgib2JqZWN0LWZpdCIpOwogICAgaWYgKG9iamVjdEZpdCA9PT0gYGNvdmVyYCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoYm94U2l6aW5nID09PSAiYm9yZGVyLWJveCIpIHsKICAgICAgY29uc3QgcGFkZGluZ1RvcCA9IGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgicGFkZGluZy10b3AiKTsKICAgICAgY29uc3QgcGFkZGluZ1JpZ2h0ID0gY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCJwYWRkaW5nLXJpZ2h0Iik7CiAgICAgIGNvbnN0IHBhZGRpbmdCb3R0b20gPSBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUoInBhZGRpbmctYm90dG9tIik7CiAgICAgIGNvbnN0IHBhZGRpbmdMZWZ0ID0gY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCJwYWRkaW5nLWxlZnQiKTsKICAgICAgcmVuZGVyZWRXaWR0aCAtPSBwYXJzZUZsb2F0KHBhZGRpbmdSaWdodCkgKyBwYXJzZUZsb2F0KHBhZGRpbmdMZWZ0KTsKICAgICAgcmVuZGVyZWRIZWlnaHQgLT0gcGFyc2VGbG9hdChwYWRkaW5nVG9wKSArIHBhcnNlRmxvYXQocGFkZGluZ0JvdHRvbSk7CiAgICB9CiAgICBjb25zdCBpbnRyaW5zaWNXaWR0aCA9IGltYWdlLm5hdHVyYWxXaWR0aDsKICAgIGNvbnN0IGludHJpbnNpY0hlaWdodCA9IGltYWdlLm5hdHVyYWxIZWlnaHQ7CiAgICBjb25zdCByZWNvbW1lbmRlZFdpZHRoID0gdGhpcy53aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAqIHJlbmRlcmVkV2lkdGg7CiAgICBjb25zdCByZWNvbW1lbmRlZEhlaWdodCA9IHRoaXMud2luZG93LmRldmljZVBpeGVsUmF0aW8gKiByZW5kZXJlZEhlaWdodDsKICAgIGNvbnN0IG92ZXJzaXplZFdpZHRoID0gaW50cmluc2ljV2lkdGggLSByZWNvbW1lbmRlZFdpZHRoID49IE9WRVJTSVpFRF9JTUFHRV9UT0xFUkFOQ0U7CiAgICBjb25zdCBvdmVyc2l6ZWRIZWlnaHQgPSBpbnRyaW5zaWNIZWlnaHQgLSByZWNvbW1lbmRlZEhlaWdodCA+PSBPVkVSU0laRURfSU1BR0VfVE9MRVJBTkNFOwogICAgcmV0dXJuIG92ZXJzaXplZFdpZHRoIHx8IG92ZXJzaXplZEhlaWdodDsKICB9CiAgc3RhdGljIMm1ZmFjID0gZnVuY3Rpb24gSW1hZ2VQZXJmb3JtYW5jZVdhcm5pbmdfRmFjdG9yeShfX25nRmFjdG9yeVR5cGVfXykgewogICAgcmV0dXJuIG5ldyAoX19uZ0ZhY3RvcnlUeXBlX18gfHwgX0ltYWdlUGVyZm9ybWFuY2VXYXJuaW5nKSgpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfSW1hZ2VQZXJmb3JtYW5jZVdhcm5pbmcsCiAgICBmYWN0b3J5OiBfSW1hZ2VQZXJmb3JtYW5jZVdhcm5pbmcuybVmYWMsCiAgICBwcm92aWRlZEluOiAicm9vdCIKICB9KTsKfTsKKCgpID0+IHsKICAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBzZXRDbGFzc01ldGFkYXRhKEltYWdlUGVyZm9ybWFuY2VXYXJuaW5nLCBbewogICAgdHlwZTogSW5qZWN0YWJsZSwKICAgIGFyZ3M6IFt7CiAgICAgIHByb3ZpZGVkSW46ICJyb290IgogICAgfV0KICB9XSwgbnVsbCwgbnVsbCk7Cn0pKCk7CmZ1bmN0aW9uIGxvZ0xhenlMQ1BXYXJuaW5nKHNyYykgewogIGNvbnNvbGUud2Fybihmb3JtYXRSdW50aW1lRXJyb3IoLTkxMywgYEFuIGltYWdlIHdpdGggc3JjICR7c3JjfSBpcyB0aGUgTGFyZ2VzdCBDb250ZW50ZnVsIFBhaW50IChMQ1ApIGVsZW1lbnQgYnV0IHdhcyBnaXZlbiBhICJsb2FkaW5nIiB2YWx1ZSBvZiAibGF6eSIsIHdoaWNoIGNhbiBuZWdhdGl2ZWx5IGltcGFjdCBhcHBsaWNhdGlvbiBsb2FkaW5nIHBlcmZvcm1hbmNlLiBUaGlzIHdhcm5pbmcgY2FuIGJlIGFkZHJlc3NlZCBieSBjaGFuZ2luZyB0aGUgbG9hZGluZyB2YWx1ZSBvZiB0aGUgTENQIGltYWdlIHRvICJlYWdlciIsIG9yIGJ5IHVzaW5nIHRoZSBOZ09wdGltaXplZEltYWdlIGRpcmVjdGl2ZSdzIHByaW9yaXRpemF0aW9uIHV0aWxpdGllcy4gRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgYWRkcmVzc2luZyBvciBkaXNhYmxpbmcgdGhpcyB3YXJuaW5nLCBzZWUgJHtFUlJPUl9ERVRBSUxTX1BBR0VfQkFTRV9VUkx9L05HMDkxM2ApKTsKfQpmdW5jdGlvbiBsb2dPdmVyc2l6ZWRJbWFnZVdhcm5pbmcoc3JjKSB7CiAgY29uc29sZS53YXJuKGZvcm1hdFJ1bnRpbWVFcnJvcigtOTEzLCBgQW4gaW1hZ2Ugd2l0aCBzcmMgJHtzcmN9IGhhcyBpbnRyaW5zaWMgZmlsZSBkaW1lbnNpb25zIG11Y2ggbGFyZ2VyIHRoYW4gaXRzIHJlbmRlcmVkIHNpemUuIFRoaXMgY2FuIG5lZ2F0aXZlbHkgaW1wYWN0IGFwcGxpY2F0aW9uIGxvYWRpbmcgcGVyZm9ybWFuY2UuIEZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGFkZHJlc3Npbmcgb3IgZGlzYWJsaW5nIHRoaXMgd2FybmluZywgc2VlICR7RVJST1JfREVUQUlMU19QQUdFX0JBU0VfVVJMfS9ORzA5MTNgKSk7Cn0KdmFyIFBMQVRGT1JNX0RFU1RST1lfTElTVEVORVJTID0gbmV3IEluamVjdGlvblRva2VuKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSA/ICJQbGF0Zm9ybURlc3Ryb3lMaXN0ZW5lcnMiIDogIiIpOwp2YXIgRU5BQkxFX1JPT1RfQ09NUE9ORU5UX0JPT1RTVFJBUCA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlICE9PSAidW5kZWZpbmVkIiAmJiBuZ0Rldk1vZGUgPyAiRU5BQkxFX1JPT1RfQ09NUE9ORU5UX0JPT1RTVFJBUCIgOiAiIik7CmZ1bmN0aW9uIGlzQXBwbGljYXRpb25Cb290c3RyYXBDb25maWcoY29uZmlnMikgewogIHJldHVybiAhY29uZmlnMi5tb2R1bGVSZWY7Cn0KZnVuY3Rpb24gYm9vdHN0cmFwKGNvbmZpZzIpIHsKICBjb25zdCBlbnZJbmplY3RvciA9IGlzQXBwbGljYXRpb25Cb290c3RyYXBDb25maWcoY29uZmlnMikgPyBjb25maWcyLnIzSW5qZWN0b3IgOiBjb25maWcyLm1vZHVsZVJlZi5pbmplY3RvcjsKICBjb25zdCBuZ1pvbmUgPSBlbnZJbmplY3Rvci5nZXQoTmdab25lKTsKICByZXR1cm4gbmdab25lLnJ1bigoKSA9PiB7CiAgICBpZiAoaXNBcHBsaWNhdGlvbkJvb3RzdHJhcENvbmZpZyhjb25maWcyKSkgewogICAgICBjb25maWcyLnIzSW5qZWN0b3IucmVzb2x2ZUluamVjdG9ySW5pdGlhbGl6ZXJzKCk7CiAgICB9IGVsc2UgewogICAgICBjb25maWcyLm1vZHVsZVJlZi5yZXNvbHZlSW5qZWN0b3JJbml0aWFsaXplcnMoKTsKICAgIH0KICAgIGNvbnN0IGV4Y2VwdGlvbkhhbmRsZXIgPSBlbnZJbmplY3Rvci5nZXQoSU5URVJOQUxfQVBQTElDQVRJT05fRVJST1JfSEFORExFUik7CiAgICBpZiAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSB7CiAgICAgIGlmIChlbnZJbmplY3Rvci5nZXQoUFJPVklERURfWk9ORUxFU1MpICYmIGVudkluamVjdG9yLmdldChQUk9WSURFRF9OR19aT05FKSkgewogICAgICAgIGNvbnNvbGUud2Fybihmb3JtYXRSdW50aW1lRXJyb3IoNDA4LCAiQm90aCBwcm92aWRlWm9uZUNoYW5nZURldGVjdGlvbiBhbmQgcHJvdmlkZVpvbmVsZXNzQ2hhbmdlRGV0ZWN0aW9uIGFyZSBwcm92aWRlZC4gVGhpcyBpcyBsaWtlbHkgYSBtaXN0YWtlLiBVcGRhdGUgdGhlIGFwcGxpY2F0aW9uIHByb3ZpZGVycyB0byB1c2Ugb25seSBvbmUgb2YgdGhlIHR3by4iKSk7CiAgICAgIH0KICAgIH0KICAgIGxldCBvbkVycm9yU3Vic2NyaXB0aW9uOwogICAgbmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHsKICAgICAgb25FcnJvclN1YnNjcmlwdGlvbiA9IG5nWm9uZS5vbkVycm9yLnN1YnNjcmliZSh7CiAgICAgICAgbmV4dDogZXhjZXB0aW9uSGFuZGxlcgogICAgICB9KTsKICAgIH0pOwogICAgaWYgKGlzQXBwbGljYXRpb25Cb290c3RyYXBDb25maWcoY29uZmlnMikpIHsKICAgICAgY29uc3QgZGVzdHJveUxpc3RlbmVyID0gKCkgPT4gZW52SW5qZWN0b3IuZGVzdHJveSgpOwogICAgICBjb25zdCBvblBsYXRmb3JtRGVzdHJveUxpc3RlbmVycyA9IGNvbmZpZzIucGxhdGZvcm1JbmplY3Rvci5nZXQoUExBVEZPUk1fREVTVFJPWV9MSVNURU5FUlMpOwogICAgICBvblBsYXRmb3JtRGVzdHJveUxpc3RlbmVycy5hZGQoZGVzdHJveUxpc3RlbmVyKTsKICAgICAgZW52SW5qZWN0b3Iub25EZXN0cm95KCgpID0+IHsKICAgICAgICBvbkVycm9yU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgb25QbGF0Zm9ybURlc3Ryb3lMaXN0ZW5lcnMuZGVsZXRlKGRlc3Ryb3lMaXN0ZW5lcik7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgZGVzdHJveUxpc3RlbmVyID0gKCkgPT4gY29uZmlnMi5tb2R1bGVSZWYuZGVzdHJveSgpOwogICAgICBjb25zdCBvblBsYXRmb3JtRGVzdHJveUxpc3RlbmVycyA9IGNvbmZpZzIucGxhdGZvcm1JbmplY3Rvci5nZXQoUExBVEZPUk1fREVTVFJPWV9MSVNURU5FUlMpOwogICAgICBvblBsYXRmb3JtRGVzdHJveUxpc3RlbmVycy5hZGQoZGVzdHJveUxpc3RlbmVyKTsKICAgICAgY29uZmlnMi5tb2R1bGVSZWYub25EZXN0cm95KCgpID0+IHsKICAgICAgICByZW1vdmUoY29uZmlnMi5hbGxQbGF0Zm9ybU1vZHVsZXMsIGNvbmZpZzIubW9kdWxlUmVmKTsKICAgICAgICBvbkVycm9yU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgb25QbGF0Zm9ybURlc3Ryb3lMaXN0ZW5lcnMuZGVsZXRlKGRlc3Ryb3lMaXN0ZW5lcik7CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIF9jYWxsQW5kUmVwb3J0VG9FcnJvckhhbmRsZXIoZXhjZXB0aW9uSGFuZGxlciwgbmdab25lLCAoKSA9PiB7CiAgICAgIGNvbnN0IHBlbmRpbmdUYXNrcyA9IGVudkluamVjdG9yLmdldChQZW5kaW5nVGFza3NJbnRlcm5hbCk7CiAgICAgIGNvbnN0IHRhc2tJZCA9IHBlbmRpbmdUYXNrcy5hZGQoKTsKICAgICAgY29uc3QgaW5pdFN0YXR1cyA9IGVudkluamVjdG9yLmdldChBcHBsaWNhdGlvbkluaXRTdGF0dXMpOwogICAgICBpbml0U3RhdHVzLnJ1bkluaXRpYWxpemVycygpOwogICAgICByZXR1cm4gaW5pdFN0YXR1cy5kb25lUHJvbWlzZS50aGVuKCgpID0+IHsKICAgICAgICBjb25zdCBsb2NhbGVJZCA9IGVudkluamVjdG9yLmdldChMT0NBTEVfSUQsIERFRkFVTFRfTE9DQUxFX0lEKTsKICAgICAgICBzZXRMb2NhbGVJZChsb2NhbGVJZCB8fCBERUZBVUxUX0xPQ0FMRV9JRCk7CiAgICAgICAgY29uc3QgZW5hYmxlUm9vdENvbXBvbmVudGJvb3RzdHJhcCA9IGVudkluamVjdG9yLmdldChFTkFCTEVfUk9PVF9DT01QT05FTlRfQk9PVFNUUkFQLCB0cnVlKTsKICAgICAgICBpZiAoIWVuYWJsZVJvb3RDb21wb25lbnRib290c3RyYXApIHsKICAgICAgICAgIGlmIChpc0FwcGxpY2F0aW9uQm9vdHN0cmFwQ29uZmlnKGNvbmZpZzIpKSB7CiAgICAgICAgICAgIHJldHVybiBlbnZJbmplY3Rvci5nZXQoQXBwbGljYXRpb25SZWYpOwogICAgICAgICAgfQogICAgICAgICAgY29uZmlnMi5hbGxQbGF0Zm9ybU1vZHVsZXMucHVzaChjb25maWcyLm1vZHVsZVJlZik7CiAgICAgICAgICByZXR1cm4gY29uZmlnMi5tb2R1bGVSZWY7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpIHsKICAgICAgICAgIGNvbnN0IGltYWdlUGVyZm9ybWFuY2VTZXJ2aWNlID0gZW52SW5qZWN0b3IuZ2V0KEltYWdlUGVyZm9ybWFuY2VXYXJuaW5nKTsKICAgICAgICAgIGltYWdlUGVyZm9ybWFuY2VTZXJ2aWNlLnN0YXJ0KCk7CiAgICAgICAgfQogICAgICAgIGlmIChpc0FwcGxpY2F0aW9uQm9vdHN0cmFwQ29uZmlnKGNvbmZpZzIpKSB7CiAgICAgICAgICBjb25zdCBhcHBSZWYgPSBlbnZJbmplY3Rvci5nZXQoQXBwbGljYXRpb25SZWYpOwogICAgICAgICAgaWYgKGNvbmZpZzIucm9vdENvbXBvbmVudCAhPT0gdm9pZCAwKSB7CiAgICAgICAgICAgIGFwcFJlZi5ib290c3RyYXAoY29uZmlnMi5yb290Q29tcG9uZW50KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBhcHBSZWY7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1vZHVsZUJvb3RzdHJhcEltcGw/Lihjb25maWcyLm1vZHVsZVJlZiwgY29uZmlnMi5hbGxQbGF0Zm9ybU1vZHVsZXMpOwogICAgICAgICAgcmV0dXJuIGNvbmZpZzIubW9kdWxlUmVmOwogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKSA9PiB2b2lkIHBlbmRpbmdUYXNrcy5yZW1vdmUodGFza0lkKSk7CiAgICB9KTsKICB9KTsKfQp2YXIgbW9kdWxlQm9vdHN0cmFwSW1wbDsKZnVuY3Rpb24gc2V0TW9kdWxlQm9vdHN0cmFwSW1wbCgpIHsKICBtb2R1bGVCb290c3RyYXBJbXBsID0gX21vZHVsZURvQm9vdHN0cmFwOwp9CmZ1bmN0aW9uIF9tb2R1bGVEb0Jvb3RzdHJhcChtb2R1bGVSZWYsIGFsbFBsYXRmb3JtTW9kdWxlcykgewogIGNvbnN0IGFwcFJlZiA9IG1vZHVsZVJlZi5pbmplY3Rvci5nZXQoQXBwbGljYXRpb25SZWYpOwogIGlmIChtb2R1bGVSZWYuX2Jvb3RzdHJhcENvbXBvbmVudHMubGVuZ3RoID4gMCkgewogICAgbW9kdWxlUmVmLl9ib290c3RyYXBDb21wb25lbnRzLmZvckVhY2goKGYpID0+IGFwcFJlZi5ib290c3RyYXAoZikpOwogIH0gZWxzZSBpZiAobW9kdWxlUmVmLmluc3RhbmNlLm5nRG9Cb290c3RyYXApIHsKICAgIG1vZHVsZVJlZi5pbnN0YW5jZS5uZ0RvQm9vdHN0cmFwKGFwcFJlZik7CiAgfSBlbHNlIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoLTQwMywgbmdEZXZNb2RlICYmIGBUaGUgbW9kdWxlICR7c3RyaW5naWZ5KG1vZHVsZVJlZi5pbnN0YW5jZS5jb25zdHJ1Y3Rvcil9IHdhcyBib290c3RyYXBwZWQsIGJ1dCBpdCBkb2VzIG5vdCBkZWNsYXJlICJATmdNb2R1bGUuYm9vdHN0cmFwIiBjb21wb25lbnRzIG5vciBhICJuZ0RvQm9vdHN0cmFwIiBtZXRob2QuIFBsZWFzZSBkZWZpbmUgb25lIG9mIHRoZXNlLmApOwogIH0KICBhbGxQbGF0Zm9ybU1vZHVsZXMucHVzaChtb2R1bGVSZWYpOwp9CmZ1bmN0aW9uIF9jYWxsQW5kUmVwb3J0VG9FcnJvckhhbmRsZXIoZXJyb3JIYW5kbGVyLCBuZ1pvbmUsIGNhbGxiYWNrKSB7CiAgdHJ5IHsKICAgIGNvbnN0IHJlc3VsdCA9IGNhbGxiYWNrKCk7CiAgICBpZiAoaXNQcm9taXNlMihyZXN1bHQpKSB7CiAgICAgIHJldHVybiByZXN1bHQuY2F0Y2goKGUpID0+IHsKICAgICAgICBuZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gZXJyb3JIYW5kbGVyKGUpKTsKICAgICAgICB0aHJvdyBlOwogICAgICB9KTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfSBjYXRjaCAoZSkgewogICAgbmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IGVycm9ySGFuZGxlcihlKSk7CiAgICB0aHJvdyBlOwogIH0KfQp2YXIgUGxhdGZvcm1SZWYgPSBjbGFzcyBfUGxhdGZvcm1SZWYgewogIF9pbmplY3RvcjsKICBfbW9kdWxlcyA9IFtdOwogIF9kZXN0cm95TGlzdGVuZXJzID0gW107CiAgX2Rlc3Ryb3llZCA9IGZhbHNlOwogIGNvbnN0cnVjdG9yKF9pbmplY3RvcikgewogICAgdGhpcy5faW5qZWN0b3IgPSBfaW5qZWN0b3I7CiAgfQogIGJvb3RzdHJhcE1vZHVsZUZhY3RvcnkobW9kdWxlRmFjdG9yeSwgb3B0aW9ucykgewogICAgY29uc3QgYWxsQXBwUHJvdmlkZXJzID0gW3Byb3ZpZGVab25lbGVzc0NoYW5nZURldGVjdGlvbkludGVybmFsKCksIC4uLm9wdGlvbnM/LmFwcGxpY2F0aW9uUHJvdmlkZXJzID8/IFtdLCBlcnJvckhhbmRsZXJFbnZpcm9ubWVudEluaXRpYWxpemVyLCAuLi5uZ0Rldk1vZGUgPyBbdmFsaWRBcHBJZEluaXRpYWxpemVyXSA6IFtdXTsKICAgIGNvbnN0IG1vZHVsZVJlZiA9IGNyZWF0ZU5nTW9kdWxlUmVmV2l0aFByb3ZpZGVycyhtb2R1bGVGYWN0b3J5Lm1vZHVsZVR5cGUsIHRoaXMuaW5qZWN0b3IsIGFsbEFwcFByb3ZpZGVycyk7CiAgICBzZXRNb2R1bGVCb290c3RyYXBJbXBsKCk7CiAgICByZXR1cm4gYm9vdHN0cmFwKHsKICAgICAgbW9kdWxlUmVmLAogICAgICBhbGxQbGF0Zm9ybU1vZHVsZXM6IHRoaXMuX21vZHVsZXMsCiAgICAgIHBsYXRmb3JtSW5qZWN0b3I6IHRoaXMuaW5qZWN0b3IKICAgIH0pOwogIH0KICBib290c3RyYXBNb2R1bGUobW9kdWxlVHlwZSwgY29tcGlsZXJPcHRpb25zID0gW10pIHsKICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25zUmVkdWNlcih7fSwgY29tcGlsZXJPcHRpb25zKTsKICAgIHNldE1vZHVsZUJvb3RzdHJhcEltcGwoKTsKICAgIHJldHVybiBjb21waWxlTmdNb2R1bGVGYWN0b3J5KHRoaXMuaW5qZWN0b3IsIG9wdGlvbnMsIG1vZHVsZVR5cGUpLnRoZW4oKG1vZHVsZUZhY3RvcnkpID0+IHRoaXMuYm9vdHN0cmFwTW9kdWxlRmFjdG9yeShtb2R1bGVGYWN0b3J5LCBvcHRpb25zKSk7CiAgfQogIG9uRGVzdHJveShjYWxsYmFjaykgewogICAgdGhpcy5fZGVzdHJveUxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTsKICB9CiAgZ2V0IGluamVjdG9yKCkgewogICAgcmV0dXJuIHRoaXMuX2luamVjdG9yOwogIH0KICBkZXN0cm95KCkgewogICAgaWYgKHRoaXMuX2Rlc3Ryb3llZCkgewogICAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDQwNCwgbmdEZXZNb2RlICYmICJUaGUgcGxhdGZvcm0gaGFzIGFscmVhZHkgYmVlbiBkZXN0cm95ZWQhIik7CiAgICB9CiAgICB0aGlzLl9tb2R1bGVzLnNsaWNlKCkuZm9yRWFjaCgobW9kdWxlKSA9PiBtb2R1bGUuZGVzdHJveSgpKTsKICAgIHRoaXMuX2Rlc3Ryb3lMaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKCkpOwogICAgY29uc3QgZGVzdHJveUxpc3RlbmVycyA9IHRoaXMuX2luamVjdG9yLmdldChQTEFURk9STV9ERVNUUk9ZX0xJU1RFTkVSUywgbnVsbCk7CiAgICBpZiAoZGVzdHJveUxpc3RlbmVycykgewogICAgICBkZXN0cm95TGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiBsaXN0ZW5lcigpKTsKICAgICAgZGVzdHJveUxpc3RlbmVycy5jbGVhcigpOwogICAgfQogICAgdGhpcy5fZGVzdHJveWVkID0gdHJ1ZTsKICB9CiAgZ2V0IGRlc3Ryb3llZCgpIHsKICAgIHJldHVybiB0aGlzLl9kZXN0cm95ZWQ7CiAgfQogIHN0YXRpYyDJtWZhYyA9IGZ1bmN0aW9uIFBsYXRmb3JtUmVmX0ZhY3RvcnkoX19uZ0ZhY3RvcnlUeXBlX18pIHsKICAgIHJldHVybiBuZXcgKF9fbmdGYWN0b3J5VHlwZV9fIHx8IF9QbGF0Zm9ybVJlZikoybXJtWluamVjdChJbmplY3RvcikpOwogIH07CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfUGxhdGZvcm1SZWYsCiAgICBmYWN0b3J5OiBfUGxhdGZvcm1SZWYuybVmYWMsCiAgICBwcm92aWRlZEluOiAicGxhdGZvcm0iCiAgfSk7Cn07CigoKSA9PiB7CiAgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgc2V0Q2xhc3NNZXRhZGF0YShQbGF0Zm9ybVJlZiwgW3sKICAgIHR5cGU6IEluamVjdGFibGUsCiAgICBhcmdzOiBbewogICAgICBwcm92aWRlZEluOiAicGxhdGZvcm0iCiAgICB9XQogIH1dLCAoKSA9PiBbewogICAgdHlwZTogSW5qZWN0b3IKICB9XSwgbnVsbCk7Cn0pKCk7CnZhciBfcGxhdGZvcm1JbmplY3RvciA9IG51bGw7CmZ1bmN0aW9uIGNyZWF0ZVBsYXRmb3JtKGluamVjdG9yKSB7CiAgaWYgKGdldFBsYXRmb3JtKCkpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoNDAwLCBuZ0Rldk1vZGUgJiYgIlRoZXJlIGNhbiBiZSBvbmx5IG9uZSBwbGF0Zm9ybS4gRGVzdHJveSB0aGUgcHJldmlvdXMgb25lIHRvIGNyZWF0ZSBhIG5ldyBvbmUuIik7CiAgfQogIHB1Ymxpc2hEZWZhdWx0R2xvYmFsVXRpbHMoKTsKICBwdWJsaXNoU2lnbmFsQ29uZmlndXJhdGlvbigpOwogIF9wbGF0Zm9ybUluamVjdG9yID0gdHJ1ZSA/IGluamVjdG9yIDogbnVsbDsKICBjb25zdCBwbGF0Zm9ybSA9IGluamVjdG9yLmdldChQbGF0Zm9ybVJlZik7CiAgcnVuUGxhdGZvcm1Jbml0aWFsaXplcnMoaW5qZWN0b3IpOwogIHJldHVybiBwbGF0Zm9ybTsKfQpmdW5jdGlvbiBjcmVhdGVQbGF0Zm9ybUZhY3RvcnkocGFyZW50UGxhdGZvcm1GYWN0b3J5LCBuYW1lLCBwcm92aWRlcnMgPSBbXSkgewogIGNvbnN0IGRlc2MgPSBgUGxhdGZvcm06ICR7bmFtZX1gOwogIGNvbnN0IG1hcmtlciA9IG5ldyBJbmplY3Rpb25Ub2tlbihkZXNjKTsKICByZXR1cm4gKGV4dHJhUHJvdmlkZXJzID0gW10pID0+IHsKICAgIGxldCBwbGF0Zm9ybSA9IGdldFBsYXRmb3JtKCk7CiAgICBpZiAoIXBsYXRmb3JtKSB7CiAgICAgIGNvbnN0IHBsYXRmb3JtUHJvdmlkZXJzID0gWy4uLnByb3ZpZGVycywgLi4uZXh0cmFQcm92aWRlcnMsIHsKICAgICAgICBwcm92aWRlOiBtYXJrZXIsCiAgICAgICAgdXNlVmFsdWU6IHRydWUKICAgICAgfV07CiAgICAgIHBsYXRmb3JtID0gcGFyZW50UGxhdGZvcm1GYWN0b3J5Py4ocGxhdGZvcm1Qcm92aWRlcnMpID8/IGNyZWF0ZVBsYXRmb3JtKGNyZWF0ZVBsYXRmb3JtSW5qZWN0b3IocGxhdGZvcm1Qcm92aWRlcnMsIGRlc2MpKTsKICAgIH0KICAgIHJldHVybiBmYWxzZSA/IHBsYXRmb3JtIDogYXNzZXJ0UGxhdGZvcm0obWFya2VyKTsKICB9Owp9CmZ1bmN0aW9uIGNyZWF0ZVBsYXRmb3JtSW5qZWN0b3IocHJvdmlkZXJzID0gW10sIG5hbWUpIHsKICByZXR1cm4gSW5qZWN0b3IuY3JlYXRlKHsKICAgIG5hbWUsCiAgICBwcm92aWRlcnM6IFt7CiAgICAgIHByb3ZpZGU6IElOSkVDVE9SX1NDT1BFLAogICAgICB1c2VWYWx1ZTogInBsYXRmb3JtIgogICAgfSwgewogICAgICBwcm92aWRlOiBQTEFURk9STV9ERVNUUk9ZX0xJU1RFTkVSUywKICAgICAgdXNlVmFsdWU6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFsoKSA9PiBfcGxhdGZvcm1JbmplY3RvciA9IG51bGxdKQogICAgfSwgLi4ucHJvdmlkZXJzXQogIH0pOwp9CmZ1bmN0aW9uIGFzc2VydFBsYXRmb3JtKHJlcXVpcmVkVG9rZW4pIHsKICBjb25zdCBwbGF0Zm9ybSA9IGdldFBsYXRmb3JtKCk7CiAgaWYgKCFwbGF0Zm9ybSkgewogICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcigtNDAxLCBuZ0Rldk1vZGUgJiYgIk5vIHBsYXRmb3JtIGV4aXN0cyEiKTsKICB9CiAgaWYgKCh0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUpICYmICFwbGF0Zm9ybS5pbmplY3Rvci5nZXQocmVxdWlyZWRUb2tlbiwgbnVsbCkpIHsKICAgIHRocm93IG5ldyBSdW50aW1lRXJyb3IoNDAwLCAiQSBwbGF0Zm9ybSB3aXRoIGEgZGlmZmVyZW50IGNvbmZpZ3VyYXRpb24gaGFzIGJlZW4gY3JlYXRlZC4gUGxlYXNlIGRlc3Ryb3kgaXQgZmlyc3QuIik7CiAgfQogIHJldHVybiBwbGF0Zm9ybTsKfQpmdW5jdGlvbiBnZXRQbGF0Zm9ybSgpIHsKICBpZiAoZmFsc2UpIHsKICAgIHJldHVybiBudWxsOwogIH0KICByZXR1cm4gX3BsYXRmb3JtSW5qZWN0b3I/LmdldChQbGF0Zm9ybVJlZikgPz8gbnVsbDsKfQpmdW5jdGlvbiBkZXN0cm95UGxhdGZvcm0oKSB7CiAgZ2V0UGxhdGZvcm0oKT8uZGVzdHJveSgpOwp9CmZ1bmN0aW9uIGNyZWF0ZU9yUmV1c2VQbGF0Zm9ybUluamVjdG9yKHByb3ZpZGVycyA9IFtdKSB7CiAgaWYgKF9wbGF0Zm9ybUluamVjdG9yKSByZXR1cm4gX3BsYXRmb3JtSW5qZWN0b3I7CiAgcHVibGlzaERlZmF1bHRHbG9iYWxVdGlscygpOwogIGNvbnN0IGluamVjdG9yID0gY3JlYXRlUGxhdGZvcm1JbmplY3Rvcihwcm92aWRlcnMpOwogIGlmICh0cnVlKSB7CiAgICBfcGxhdGZvcm1JbmplY3RvciA9IGluamVjdG9yOwogIH0KICBwdWJsaXNoU2lnbmFsQ29uZmlndXJhdGlvbigpOwogIHJ1blBsYXRmb3JtSW5pdGlhbGl6ZXJzKGluamVjdG9yKTsKICByZXR1cm4gaW5qZWN0b3I7Cn0KZnVuY3Rpb24gcHJvdmlkZVBsYXRmb3JtSW5pdGlhbGl6ZXIoaW5pdGlhbGl6ZXJGbikgewogIHJldHVybiB7CiAgICBwcm92aWRlOiBQTEFURk9STV9JTklUSUFMSVpFUiwKICAgIHVzZVZhbHVlOiBpbml0aWFsaXplckZuLAogICAgbXVsdGk6IHRydWUKICB9Owp9CmZ1bmN0aW9uIHJ1blBsYXRmb3JtSW5pdGlhbGl6ZXJzKGluamVjdG9yKSB7CiAgY29uc3QgaW5pdHMgPSBpbmplY3Rvci5nZXQoUExBVEZPUk1fSU5JVElBTElaRVIsIG51bGwpOwogIHJ1bkluSW5qZWN0aW9uQ29udGV4dChpbmplY3RvciwgKCkgPT4gewogICAgaW5pdHM/LmZvckVhY2goKGluaXQpID0+IGluaXQoKSk7CiAgfSk7Cn0KZnVuY3Rpb24gZXhoYXVzdGl2ZUNoZWNrTm9DaGFuZ2VzSW50ZXJ2YWwoaW50ZXJ2YWwyKSB7CiAgcmV0dXJuIHByb3ZpZGVFbnZpcm9ubWVudEluaXRpYWxpemVyKCgpID0+IHsKICAgIGNvbnN0IGFwcGxpY2F0aW9uUmVmID0gaW5qZWN0MihBcHBsaWNhdGlvblJlZik7CiAgICBjb25zdCBlcnJvckhhbmRsZXIgPSBpbmplY3QyKEVycm9ySGFuZGxlcik7CiAgICBjb25zdCBzY2hlZHVsZXIgPSBpbmplY3QyKENoYW5nZURldGVjdGlvblNjaGVkdWxlckltcGwpOwogICAgY29uc3Qgbmdab25lID0gaW5qZWN0MihOZ1pvbmUpOwogICAgZnVuY3Rpb24gc2NoZWR1bGVDaGVja05vQ2hhbmdlcygpIHsKICAgICAgbmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGlmIChhcHBsaWNhdGlvblJlZi5kZXN0cm95ZWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHNjaGVkdWxlci5wZW5kaW5nUmVuZGVyVGFza0lkIHx8IHNjaGVkdWxlci5ydW5uaW5nVGljaykgewogICAgICAgICAgICBzY2hlZHVsZUNoZWNrTm9DaGFuZ2VzKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGZvciAoY29uc3QgdmlldyBvZiBhcHBsaWNhdGlvblJlZi5hbGxWaWV3cykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGNoZWNrTm9DaGFuZ2VzSW50ZXJuYWwodmlldy5fbFZpZXcsIHRydWUpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBzY2hlZHVsZUNoZWNrTm9DaGFuZ2VzKCk7CiAgICAgICAgfSwgaW50ZXJ2YWwyKTsKICAgICAgfSk7CiAgICB9CiAgICBzY2hlZHVsZUNoZWNrTm9DaGFuZ2VzKCk7CiAgfSk7Cn0KZnVuY3Rpb24gcHJvdmlkZUNoZWNrTm9DaGFuZ2VzQ29uZmlnKG9wdGlvbnMpIHsKICByZXR1cm4gbWFrZUVudmlyb25tZW50UHJvdmlkZXJzKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSA/IFt7CiAgICBwcm92aWRlOiBVc2VFeGhhdXN0aXZlQ2hlY2tOb0NoYW5nZXMsCiAgICB1c2VWYWx1ZTogb3B0aW9ucy5leGhhdXN0aXZlCiAgfSwgb3B0aW9ucz8uaW50ZXJ2YWwgIT09IHZvaWQgMCA/IGV4aGF1c3RpdmVDaGVja05vQ2hhbmdlc0ludGVydmFsKG9wdGlvbnMuaW50ZXJ2YWwpIDogW11dIDogW10pOwp9CmZ1bmN0aW9uIGlzRGV2TW9kZSgpIHsKICByZXR1cm4gdHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgISFuZ0Rldk1vZGU7Cn0KZnVuY3Rpb24gZW5hYmxlUHJvZE1vZGUoKSB7CiAgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgewogICAgX2dsb2JhbFsibmdEZXZNb2RlIl0gPSBmYWxzZTsKICB9Cn0KdmFyIGFwcHNXaXRoRXZlbnRSZXBsYXkgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtTZXQoKTsKdmFyIEVBR0VSX0NPTlRFTlRfTElTVEVORVJTX0tFWSA9ICIiOwpmdW5jdGlvbiBzaG91bGRFbmFibGVFdmVudFJlcGxheShpbmplY3RvcikgewogIHJldHVybiBpbmplY3Rvci5nZXQoSVNfRVZFTlRfUkVQTEFZX0VOQUJMRUQsIEVWRU5UX1JFUExBWV9FTkFCTEVEX0RFRkFVTFQpOwp9CmZ1bmN0aW9uIHdpdGhFdmVudFJlcGxheSgpIHsKICBjb25zdCBwcm92aWRlcnMgPSBbewogICAgcHJvdmlkZTogSVNfRVZFTlRfUkVQTEFZX0VOQUJMRUQsCiAgICB1c2VGYWN0b3J5OiAoKSA9PiB7CiAgICAgIGxldCBpc0VuYWJsZWQgPSB0cnVlOwogICAgICBpZiAodHJ1ZSkgewogICAgICAgIGNvbnN0IGFwcElkID0gaW5qZWN0MihBUFBfSUQpOwogICAgICAgIGlzRW5hYmxlZCA9ICEhd2luZG93Ll9lanNhcz8uW2FwcElkXTsKICAgICAgfQogICAgICBpZiAoaXNFbmFibGVkKSB7CiAgICAgICAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiTmdFdmVudFJlcGxheSIpOwogICAgICB9CiAgICAgIHJldHVybiBpc0VuYWJsZWQ7CiAgICB9CiAgfV07CiAgaWYgKHRydWUpIHsKICAgIHByb3ZpZGVycy5wdXNoKHsKICAgICAgcHJvdmlkZTogRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsCiAgICAgIHVzZVZhbHVlOiAoKSA9PiB7CiAgICAgICAgY29uc3QgYXBwUmVmID0gaW5qZWN0MihBcHBsaWNhdGlvblJlZik7CiAgICAgICAgY29uc3QgewogICAgICAgICAgaW5qZWN0b3IKICAgICAgICB9ID0gYXBwUmVmOwogICAgICAgIGlmICghYXBwc1dpdGhFdmVudFJlcGxheS5oYXMoYXBwUmVmKSkgewogICAgICAgICAgY29uc3QganNBY3Rpb25NYXAgPSBpbmplY3QyKEpTQUNUSU9OX0JMT0NLX0VMRU1FTlRfTUFQKTsKICAgICAgICAgIGlmIChzaG91bGRFbmFibGVFdmVudFJlcGxheShpbmplY3RvcikpIHsKICAgICAgICAgICAgZW5hYmxlU3Rhc2hFdmVudExpc3RlbmVySW1wbCgpOwogICAgICAgICAgICBjb25zdCBhcHBJZCA9IGluamVjdG9yLmdldChBUFBfSUQpOwogICAgICAgICAgICBjb25zdCBjbGVhclN0YXNoRm4gPSBzZXRTdGFzaEZuKGFwcElkLCAockVsLCBldmVudE5hbWUsIGxpc3RlbmVyRm4pID0+IHsKICAgICAgICAgICAgICBpZiAockVsLm5vZGVUeXBlICE9PSBOb2RlLkVMRU1FTlRfTk9ERSkgcmV0dXJuOwogICAgICAgICAgICAgIHNoYXJlZFN0YXNoRnVuY3Rpb24ockVsLCBldmVudE5hbWUsIGxpc3RlbmVyRm4pOwogICAgICAgICAgICAgIHNoYXJlZE1hcEZ1bmN0aW9uKHJFbCwganNBY3Rpb25NYXApOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYXBwUmVmLm9uRGVzdHJveShjbGVhclN0YXNoRm4pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGk6IHRydWUKICAgIH0sIHsKICAgICAgcHJvdmlkZTogQVBQX0JPT1RTVFJBUF9MSVNURU5FUiwKICAgICAgdXNlRmFjdG9yeTogKCkgPT4gewogICAgICAgIGNvbnN0IGFwcFJlZiA9IGluamVjdDIoQXBwbGljYXRpb25SZWYpOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGluamVjdG9yCiAgICAgICAgfSA9IGFwcFJlZjsKICAgICAgICByZXR1cm4gKCkgPT4gewogICAgICAgICAgaWYgKCFzaG91bGRFbmFibGVFdmVudFJlcGxheShpbmplY3RvcikgfHwgYXBwc1dpdGhFdmVudFJlcGxheS5oYXMoYXBwUmVmKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBhcHBzV2l0aEV2ZW50UmVwbGF5LmFkZChhcHBSZWYpOwogICAgICAgICAgY29uc3QgYXBwSWQgPSBpbmplY3Rvci5nZXQoQVBQX0lEKTsKICAgICAgICAgIGFwcFJlZi5vbkRlc3Ryb3koKCkgPT4gewogICAgICAgICAgICBhcHBzV2l0aEV2ZW50UmVwbGF5LmRlbGV0ZShhcHBSZWYpOwogICAgICAgICAgICBpZiAodHJ1ZSkgewogICAgICAgICAgICAgIGNsZWFyQXBwU2NvcGVkRWFybHlFdmVudENvbnRyYWN0KGFwcElkKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBhcHBSZWYud2hlblN0YWJsZSgpLnRoZW4oKCkgPT4gewogICAgICAgICAgICBpZiAoYXBwUmVmLmRlc3Ryb3llZCkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBldmVudENvbnRyYWN0RGV0YWlscyA9IGluamVjdG9yLmdldChKU0FDVElPTl9FVkVOVF9DT05UUkFDVCk7CiAgICAgICAgICAgIGluaXRFdmVudFJlcGxheShldmVudENvbnRyYWN0RGV0YWlscywgaW5qZWN0b3IpOwogICAgICAgICAgICBjb25zdCBqc0FjdGlvbk1hcCA9IGluamVjdG9yLmdldChKU0FDVElPTl9CTE9DS19FTEVNRU5UX01BUCk7CiAgICAgICAgICAgIGpzQWN0aW9uTWFwLmdldChFQUdFUl9DT05URU5UX0xJU1RFTkVSU19LRVkpPy5mb3JFYWNoKHJlbW92ZUxpc3RlbmVycyk7CiAgICAgICAgICAgIGpzQWN0aW9uTWFwLmRlbGV0ZShFQUdFUl9DT05URU5UX0xJU1RFTkVSU19LRVkpOwogICAgICAgICAgICBjb25zdCBldmVudENvbnRyYWN0ID0gZXZlbnRDb250cmFjdERldGFpbHMuaW5zdGFuY2U7CiAgICAgICAgICAgIGlmIChpc0luY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZChpbmplY3RvcikpIHsKICAgICAgICAgICAgICBhcHBSZWYub25EZXN0cm95KCgpID0+IGV2ZW50Q29udHJhY3QuY2xlYW5VcCgpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBldmVudENvbnRyYWN0LmNsZWFuVXAoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfTsKICAgICAgfSwKICAgICAgbXVsdGk6IHRydWUKICAgIH0pOwogIH0KICByZXR1cm4gcHJvdmlkZXJzOwp9CnZhciBpbml0RXZlbnRSZXBsYXkgPSAoZXZlbnREZWxlZ2F0aW9uLCBpbmplY3RvcikgPT4gewogIGNvbnN0IGFwcElkID0gaW5qZWN0b3IuZ2V0KEFQUF9JRCk7CiAgY29uc3QgZWFybHlKc2FjdGlvbkRhdGEgPSB3aW5kb3cuX2Vqc2FzW2FwcElkXTsKICBjb25zdCBldmVudENvbnRyYWN0ID0gZXZlbnREZWxlZ2F0aW9uLmluc3RhbmNlID0gbmV3IEV2ZW50Q29udHJhY3QobmV3IEV2ZW50Q29udHJhY3RDb250YWluZXIoZWFybHlKc2FjdGlvbkRhdGEuYykpOwogIGZvciAoY29uc3QgZXQgb2YgZWFybHlKc2FjdGlvbkRhdGEuZXQpIHsKICAgIGV2ZW50Q29udHJhY3QuYWRkRXZlbnQoZXQpOwogIH0KICBmb3IgKGNvbnN0IGV0IG9mIGVhcmx5SnNhY3Rpb25EYXRhLmV0YykgewogICAgZXZlbnRDb250cmFjdC5hZGRFdmVudChldCk7CiAgfQogIGNvbnN0IGV2ZW50SW5mb3MgPSBnZXRBcHBTY29wZWRRdWV1ZWRFdmVudEluZm9zKGFwcElkKTsKICBldmVudENvbnRyYWN0LnJlcGxheUVhcmx5RXZlbnRJbmZvcyhldmVudEluZm9zKTsKICBjbGVhckFwcFNjb3BlZEVhcmx5RXZlbnRDb250cmFjdChhcHBJZCk7CiAgY29uc3QgZGlzcGF0Y2hlciA9IG5ldyBFdmVudERpc3BhdGNoZXIoKGV2ZW50KSA9PiB7CiAgICBpbnZva2VSZWdpc3RlcmVkUmVwbGF5TGlzdGVuZXJzKGluamVjdG9yLCBldmVudCwgZXZlbnQuY3VycmVudFRhcmdldCk7CiAgfSk7CiAgcmVnaXN0ZXJEaXNwYXRjaGVyJDEoZXZlbnRDb250cmFjdCwgZGlzcGF0Y2hlcik7Cn07CmZ1bmN0aW9uIGNvbGxlY3REb21FdmVudHNJbmZvKHRWaWV3LCBsVmlldywgZXZlbnRUeXBlc1RvUmVwbGF5KSB7CiAgY29uc3QgZG9tRXZlbnRzSW5mbyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgbENsZWFudXAgPSBsVmlld1tDTEVBTlVQXTsKICBjb25zdCB0Q2xlYW51cCA9IHRWaWV3LmNsZWFudXA7CiAgaWYgKCF0Q2xlYW51cCB8fCAhbENsZWFudXApIHsKICAgIHJldHVybiBkb21FdmVudHNJbmZvOwogIH0KICBmb3IgKGxldCBpID0gMDsgaSA8IHRDbGVhbnVwLmxlbmd0aDsgKSB7CiAgICBjb25zdCBmaXJzdFBhcmFtID0gdENsZWFudXBbaSsrXTsKICAgIGNvbnN0IHNlY29uZFBhcmFtID0gdENsZWFudXBbaSsrXTsKICAgIGlmICh0eXBlb2YgZmlyc3RQYXJhbSAhPT0gInN0cmluZyIpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBjb25zdCBldmVudFR5cGUgPSBmaXJzdFBhcmFtOwogICAgaWYgKCFpc0Vhcmx5RXZlbnRUeXBlKGV2ZW50VHlwZSkpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBpZiAoaXNDYXB0dXJlRXZlbnRUeXBlKGV2ZW50VHlwZSkpIHsKICAgICAgZXZlbnRUeXBlc1RvUmVwbGF5LmNhcHR1cmUuYWRkKGV2ZW50VHlwZSk7CiAgICB9IGVsc2UgewogICAgICBldmVudFR5cGVzVG9SZXBsYXkucmVndWxhci5hZGQoZXZlbnRUeXBlKTsKICAgIH0KICAgIGNvbnN0IGxpc3RlbmVyRWxlbWVudCA9IHVud3JhcFJOb2RlKGxWaWV3W3NlY29uZFBhcmFtXSk7CiAgICBpKys7CiAgICBjb25zdCB1c2VDYXB0dXJlT3JJbmR4ID0gdENsZWFudXBbaSsrXTsKICAgIGNvbnN0IGlzRG9tRXZlbnQgPSB0eXBlb2YgdXNlQ2FwdHVyZU9ySW5keCA9PT0gImJvb2xlYW4iIHx8IHVzZUNhcHR1cmVPckluZHggPj0gMDsKICAgIGlmICghaXNEb21FdmVudCkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmICghZG9tRXZlbnRzSW5mby5oYXMobGlzdGVuZXJFbGVtZW50KSkgewogICAgICBkb21FdmVudHNJbmZvLnNldChsaXN0ZW5lckVsZW1lbnQsIFtldmVudFR5cGVdKTsKICAgIH0gZWxzZSB7CiAgICAgIGRvbUV2ZW50c0luZm8uZ2V0KGxpc3RlbmVyRWxlbWVudCkucHVzaChldmVudFR5cGUpOwogICAgfQogIH0KICByZXR1cm4gZG9tRXZlbnRzSW5mbzsKfQpmdW5jdGlvbiBpbnZva2VSZWdpc3RlcmVkUmVwbGF5TGlzdGVuZXJzKGluamVjdG9yLCBldmVudCwgY3VycmVudFRhcmdldCkgewogIGNvbnN0IGJsb2NrTmFtZSA9IChjdXJyZW50VGFyZ2V0ICYmIGN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKERFRkVSX0JMT0NLX1NTUl9JRF9BVFRSSUJVVEUpKSA/PyAiIjsKICBpZiAoL2RcZCsvLnRlc3QoYmxvY2tOYW1lKSkgewogICAgaHlkcmF0ZUFuZEludm9rZUJsb2NrTGlzdGVuZXJzKGJsb2NrTmFtZSwgaW5qZWN0b3IsIGV2ZW50LCBjdXJyZW50VGFyZ2V0KTsKICB9IGVsc2UgaWYgKGV2ZW50LmV2ZW50UGhhc2UgPT09IEV2ZW50UGhhc2UuUkVQTEFZKSB7CiAgICBpbnZva2VMaXN0ZW5lcnMoZXZlbnQsIGN1cnJlbnRUYXJnZXQpOwogIH0KfQpmdW5jdGlvbiBoeWRyYXRlQW5kSW52b2tlQmxvY2tMaXN0ZW5lcnMoYmxvY2tOYW1lLCBpbmplY3RvciwgZXZlbnQsIGN1cnJlbnRUYXJnZXQpIHsKICBjb25zdCBxdWV1ZTIgPSBpbmplY3Rvci5nZXQoRVZFTlRfUkVQTEFZX1FVRVVFKTsKICBxdWV1ZTIucHVzaCh7CiAgICBldmVudCwKICAgIGN1cnJlbnRUYXJnZXQKICB9KTsKICB0cmlnZ2VySHlkcmF0aW9uRnJvbUJsb2NrTmFtZShpbmplY3RvciwgYmxvY2tOYW1lLCBjcmVhdGVSZXBsYXlRdWV1ZWRCbG9ja0V2ZW50c0ZuKHF1ZXVlMikpOwp9CmZ1bmN0aW9uIGNyZWF0ZVJlcGxheVF1ZXVlZEJsb2NrRXZlbnRzRm4ocXVldWUyKSB7CiAgcmV0dXJuIChoeWRyYXRlZEJsb2NrcykgPT4gewogICAgY29uc3QgaHlkcmF0ZWQgPSBuZXcgU2V0KGh5ZHJhdGVkQmxvY2tzKTsKICAgIGNvbnN0IG5ld1F1ZXVlID0gW107CiAgICBmb3IgKGxldCB7CiAgICAgIGV2ZW50LAogICAgICBjdXJyZW50VGFyZ2V0CiAgICB9IG9mIHF1ZXVlMikgewogICAgICBjb25zdCBibG9ja05hbWUgPSBjdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZShERUZFUl9CTE9DS19TU1JfSURfQVRUUklCVVRFKTsKICAgICAgaWYgKGh5ZHJhdGVkLmhhcyhibG9ja05hbWUpKSB7CiAgICAgICAgaW52b2tlTGlzdGVuZXJzKGV2ZW50LCBjdXJyZW50VGFyZ2V0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBuZXdRdWV1ZS5wdXNoKHsKICAgICAgICAgIGV2ZW50LAogICAgICAgICAgY3VycmVudFRhcmdldAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBxdWV1ZTIubGVuZ3RoID0gMDsKICAgIHF1ZXVlMi5wdXNoKC4uLm5ld1F1ZXVlKTsKICB9Owp9CnZhciBpc0h5ZHJhdGlvblN1cHBvcnRFbmFibGVkID0gZmFsc2U7CnZhciBpc0kxOG5IeWRyYXRpb25SdW50aW1lU3VwcG9ydEVuYWJsZWQgPSBmYWxzZTsKdmFyIGlzSW5jcmVtZW50YWxIeWRyYXRpb25SdW50aW1lU3VwcG9ydEVuYWJsZWQgPSBmYWxzZTsKdmFyIEFQUExJQ0FUSU9OX0lTX1NUQUJMRV9USU1FT1VUID0gMWU0OwpmdW5jdGlvbiBlbmFibGVIeWRyYXRpb25SdW50aW1lU3VwcG9ydCgpIHsKICBpZiAoIWlzSHlkcmF0aW9uU3VwcG9ydEVuYWJsZWQpIHsKICAgIGlzSHlkcmF0aW9uU3VwcG9ydEVuYWJsZWQgPSB0cnVlOwogICAgZW5hYmxlUmV0cmlldmVIeWRyYXRpb25JbmZvSW1wbCgpOwogICAgZW5hYmxlTG9jYXRlT3JDcmVhdGVFbGVtZW50Tm9kZUltcGwoKTsKICAgIGVuYWJsZUxvY2F0ZU9yQ3JlYXRlVGV4dE5vZGVJbXBsKCk7CiAgICBlbmFibGVMb2NhdGVPckNyZWF0ZUVsZW1lbnRDb250YWluZXJOb2RlSW1wbCgpOwogICAgZW5hYmxlTG9jYXRlT3JDcmVhdGVDb250YWluZXJBbmNob3JJbXBsKCk7CiAgICBlbmFibGVMb2NhdGVPckNyZWF0ZUNvbnRhaW5lclJlZkltcGwoKTsKICAgIGVuYWJsZUZpbmRNYXRjaGluZ0RlaHlkcmF0ZWRWaWV3SW1wbCgpOwogICAgZW5hYmxlQXBwbHlSb290RWxlbWVudFRyYW5zZm9ybUltcGwoKTsKICB9Cn0KZnVuY3Rpb24gZW5hYmxlSTE4bkh5ZHJhdGlvblJ1bnRpbWVTdXBwb3J0KCkgewogIGlmICghaXNJMThuSHlkcmF0aW9uUnVudGltZVN1cHBvcnRFbmFibGVkKSB7CiAgICBpc0kxOG5IeWRyYXRpb25SdW50aW1lU3VwcG9ydEVuYWJsZWQgPSB0cnVlOwogICAgZW5hYmxlTG9jYXRlT3JDcmVhdGVJMThuTm9kZUltcGwoKTsKICAgIGVuYWJsZVByZXBhcmVJMThuQmxvY2tGb3JIeWRyYXRpb25JbXBsKCk7CiAgICBlbmFibGVDbGFpbURlaHlkcmF0ZWRJY3VDYXNlSW1wbCgpOwogIH0KfQpmdW5jdGlvbiBlbmFibGVJbmNyZW1lbnRhbEh5ZHJhdGlvblJ1bnRpbWVTdXBwb3J0KCkgewogIGlmICghaXNJbmNyZW1lbnRhbEh5ZHJhdGlvblJ1bnRpbWVTdXBwb3J0RW5hYmxlZCkgewogICAgaXNJbmNyZW1lbnRhbEh5ZHJhdGlvblJ1bnRpbWVTdXBwb3J0RW5hYmxlZCA9IHRydWU7CiAgICBlbmFibGVSZXRyaWV2ZURlZmVyQmxvY2tEYXRhSW1wbCgpOwogIH0KfQpmdW5jdGlvbiBwcmludEh5ZHJhdGlvblN0YXRzKGluamVjdG9yKSB7CiAgY29uc3QgY29uc29sZTIgPSBpbmplY3Rvci5nZXQoQ29uc29sZSk7CiAgY29uc3QgbWVzc2FnZSA9IGBBbmd1bGFyIGh5ZHJhdGVkICR7bmdEZXZNb2RlLmh5ZHJhdGVkQ29tcG9uZW50c30gY29tcG9uZW50KHMpIGFuZCAke25nRGV2TW9kZS5oeWRyYXRlZE5vZGVzfSBub2RlKHMpLCAke25nRGV2TW9kZS5jb21wb25lbnRzU2tpcHBlZEh5ZHJhdGlvbn0gY29tcG9uZW50KHMpIHdlcmUgc2tpcHBlZC4gYCArIChpc0luY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZChpbmplY3RvcikgPyBgJHtuZ0Rldk1vZGUuZGVmZXJCbG9ja3NXaXRoSW5jcmVtZW50YWxIeWRyYXRpb259IGRlZmVyIGJsb2NrKHMpIHdlcmUgY29uZmlndXJlZCB0byB1c2UgaW5jcmVtZW50YWwgaHlkcmF0aW9uLiBgIDogIiIpICsgYExlYXJuIG1vcmUgYXQgJHtET0NfUEFHRV9CQVNFX1VSTH0vZ3VpZGUvaHlkcmF0aW9uLmA7CiAgY29uc29sZTIubG9nKG1lc3NhZ2UpOwp9CmZ1bmN0aW9uIHdoZW5TdGFibGVXaXRoVGltZW91dChhcHBSZWYpIHsKICBjb25zdCB3aGVuU3RhYmxlUHJvbWlzZSA9IGFwcFJlZi53aGVuU3RhYmxlKCk7CiAgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSkgewogICAgY29uc3QgdGltZW91dFRpbWUgPSBBUFBMSUNBVElPTl9JU19TVEFCTEVfVElNRU9VVDsKICAgIGNvbnN0IGNvbnNvbGUyID0gYXBwUmVmLmluamVjdG9yLmdldChDb25zb2xlKTsKICAgIGNvbnN0IG5nWm9uZSA9IGFwcFJlZi5pbmplY3Rvci5nZXQoTmdab25lKTsKICAgIGNvbnN0IHRpbWVvdXRJZCA9IG5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7CiAgICAgIHJldHVybiBzZXRUaW1lb3V0KCgpID0+IGxvZ1dhcm5pbmdPblN0YWJsZVRpbWVkb3V0KHRpbWVvdXRUaW1lLCBjb25zb2xlMiksIHRpbWVvdXRUaW1lKTsKICAgIH0pOwogICAgd2hlblN0YWJsZVByb21pc2UuZmluYWxseSgoKSA9PiBjbGVhclRpbWVvdXQodGltZW91dElkKSk7CiAgfQogIHJldHVybiB3aGVuU3RhYmxlUHJvbWlzZTsKfQp2YXIgQ0xJRU5UX1JFTkRFUl9NT0RFX0ZMQUcgPSAibmdjbSI7CmZ1bmN0aW9uIGlzQ2xpZW50UmVuZGVyTW9kZUVuYWJsZWQoZG9jKSB7CiAgcmV0dXJuIGRvYy5ib2R5Lmhhc0F0dHJpYnV0ZShDTElFTlRfUkVOREVSX01PREVfRkxBRyk7Cn0KZnVuY3Rpb24gd2l0aERvbUh5ZHJhdGlvbigpIHsKICBjb25zdCBwcm92aWRlcnMgPSBbewogICAgcHJvdmlkZTogSVNfSFlEUkFUSU9OX0RPTV9SRVVTRV9FTkFCTEVELAogICAgdXNlRmFjdG9yeTogKCkgPT4gewogICAgICBsZXQgaXNFbmFibGVkID0gdHJ1ZTsKICAgICAgaWYgKHRydWUpIHsKICAgICAgICBjb25zdCB0cmFuc2ZlclN0YXRlID0gaW5qZWN0MihUcmFuc2ZlclN0YXRlLCB7CiAgICAgICAgICBvcHRpb25hbDogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGlzRW5hYmxlZCA9ICEhdHJhbnNmZXJTdGF0ZT8uZ2V0KE5HSF9EQVRBX0tFWSwgbnVsbCk7CiAgICAgIH0KICAgICAgaWYgKGlzRW5hYmxlZCkgewogICAgICAgIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUoIk5nSHlkcmF0aW9uIik7CiAgICAgIH0KICAgICAgcmV0dXJuIGlzRW5hYmxlZDsKICAgIH0KICB9LCB7CiAgICBwcm92aWRlOiBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUiwKICAgIHVzZVZhbHVlOiAoKSA9PiB7CiAgICAgIHNldElzSTE4bkh5ZHJhdGlvblN1cHBvcnRFbmFibGVkKGZhbHNlKTsKICAgICAgaWYgKGZhbHNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGRvYyA9IGluamVjdDIoRE9DVU1FTlQpOwogICAgICBpZiAoaW5qZWN0MihJU19IWURSQVRJT05fRE9NX1JFVVNFX0VOQUJMRUQpKSB7CiAgICAgICAgdmVyaWZ5U3NyQ29udGVudHNJbnRlZ3JpdHkoZG9jKTsKICAgICAgICBlbmFibGVIeWRyYXRpb25SdW50aW1lU3VwcG9ydCgpOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBuZ0Rldk1vZGUgIT09ICJ1bmRlZmluZWQiICYmIG5nRGV2TW9kZSAmJiAhaXNDbGllbnRSZW5kZXJNb2RlRW5hYmxlZChkb2MpKSB7CiAgICAgICAgY29uc3QgY29uc29sZTIgPSBpbmplY3QyKENvbnNvbGUpOwogICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBmb3JtYXRSdW50aW1lRXJyb3IoLTUwNSwgIkFuZ3VsYXIgaHlkcmF0aW9uIHdhcyByZXF1ZXN0ZWQgb24gdGhlIGNsaWVudCwgYnV0IHRoZXJlIHdhcyBubyBzZXJpYWxpemVkIGluZm9ybWF0aW9uIHByZXNlbnQgaW4gdGhlIHNlcnZlciByZXNwb25zZSwgdGh1cyBoeWRyYXRpb24gd2FzIG5vdCBlbmFibGVkLiBNYWtlIHN1cmUgdGhlIGBwcm92aWRlQ2xpZW50SHlkcmF0aW9uKClgIGlzIGluY2x1ZGVkIGludG8gdGhlIGxpc3Qgb2YgcHJvdmlkZXJzIGluIHRoZSBzZXJ2ZXIgcGFydCBvZiB0aGUgYXBwbGljYXRpb24gY29uZmlndXJhdGlvbi4iKTsKICAgICAgICBjb25zb2xlMi53YXJuKG1lc3NhZ2UpOwogICAgICB9CiAgICB9LAogICAgbXVsdGk6IHRydWUKICB9XTsKICBpZiAodHJ1ZSkgewogICAgcHJvdmlkZXJzLnB1c2goewogICAgICBwcm92aWRlOiBQUkVTRVJWRV9IT1NUX0NPTlRFTlQsCiAgICAgIHVzZUZhY3Rvcnk6ICgpID0+IHsKICAgICAgICByZXR1cm4gaW5qZWN0MihJU19IWURSQVRJT05fRE9NX1JFVVNFX0VOQUJMRUQpOwogICAgICB9CiAgICB9LCB7CiAgICAgIHByb3ZpZGU6IEFQUF9CT09UU1RSQVBfTElTVEVORVIsCiAgICAgIHVzZUZhY3Rvcnk6ICgpID0+IHsKICAgICAgICBpZiAoaW5qZWN0MihJU19IWURSQVRJT05fRE9NX1JFVVNFX0VOQUJMRUQpKSB7CiAgICAgICAgICBjb25zdCBhcHBSZWYgPSBpbmplY3QyKEFwcGxpY2F0aW9uUmVmKTsKICAgICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICAgIHdoZW5TdGFibGVXaXRoVGltZW91dChhcHBSZWYpLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIGlmIChhcHBSZWYuZGVzdHJveWVkKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNsZWFudXBEZWh5ZHJhdGVkVmlld3MoYXBwUmVmKTsKICAgICAgICAgICAgICBpZiAodHlwZW9mIG5nRGV2TW9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbmdEZXZNb2RlKSB7CiAgICAgICAgICAgICAgICBjb3VudEJsb2Nrc1NraXBwZWRCeUh5ZHJhdGlvbihhcHBSZWYuaW5qZWN0b3IpOwogICAgICAgICAgICAgICAgcHJpbnRIeWRyYXRpb25TdGF0cyhhcHBSZWYuaW5qZWN0b3IpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICByZXR1cm4gKCkgPT4gewogICAgICAgIH07CiAgICAgIH0sCiAgICAgIG11bHRpOiB0cnVlCiAgICB9KTsKICB9CiAgcmV0dXJuIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhwcm92aWRlcnMpOwp9CmZ1bmN0aW9uIHdpdGhJMThuU3VwcG9ydCgpIHsKICByZXR1cm4gW3sKICAgIHByb3ZpZGU6IElTX0kxOE5fSFlEUkFUSU9OX0VOQUJMRUQsCiAgICB1c2VGYWN0b3J5OiAoKSA9PiBpbmplY3QyKElTX0hZRFJBVElPTl9ET01fUkVVU0VfRU5BQkxFRCkKICB9LCB7CiAgICBwcm92aWRlOiBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUiwKICAgIHVzZVZhbHVlOiAoKSA9PiB7CiAgICAgIGlmIChpbmplY3QyKElTX0hZRFJBVElPTl9ET01fUkVVU0VfRU5BQkxFRCkpIHsKICAgICAgICBlbmFibGVJMThuSHlkcmF0aW9uUnVudGltZVN1cHBvcnQoKTsKICAgICAgICBzZXRJc0kxOG5IeWRyYXRpb25TdXBwb3J0RW5hYmxlZCh0cnVlKTsKICAgICAgICBwZXJmb3JtYW5jZU1hcmtGZWF0dXJlKCJOZ0kxOG5IeWRyYXRpb24iKTsKICAgICAgfQogICAgfSwKICAgIG11bHRpOiB0cnVlCiAgfV07Cn0KZnVuY3Rpb24gd2l0aEluY3JlbWVudGFsSHlkcmF0aW9uKCkgewogIGNvbnN0IHByb3ZpZGVycyA9IFt3aXRoRXZlbnRSZXBsYXkoKSwgewogICAgcHJvdmlkZTogSVNfSU5DUkVNRU5UQUxfSFlEUkFUSU9OX0VOQUJMRUQsCiAgICB1c2VWYWx1ZTogdHJ1ZQogIH0sIHsKICAgIHByb3ZpZGU6IERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlksCiAgICB1c2VDbGFzczogRGVoeWRyYXRlZEJsb2NrUmVnaXN0cnkKICB9LCB7CiAgICBwcm92aWRlOiBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUiwKICAgIHVzZVZhbHVlOiAoKSA9PiB7CiAgICAgIGVuYWJsZUluY3JlbWVudGFsSHlkcmF0aW9uUnVudGltZVN1cHBvcnQoKTsKICAgICAgcGVyZm9ybWFuY2VNYXJrRmVhdHVyZSgiTmdJbmNyZW1lbnRhbEh5ZHJhdGlvbiIpOwogICAgfSwKICAgIG11bHRpOiB0cnVlCiAgfV07CiAgaWYgKHRydWUpIHsKICAgIHByb3ZpZGVycy5wdXNoKHsKICAgICAgcHJvdmlkZTogQVBQX0JPT1RTVFJBUF9MSVNURU5FUiwKICAgICAgdXNlRmFjdG9yeTogKCkgPT4gewogICAgICAgIGNvbnN0IGluamVjdG9yID0gaW5qZWN0MihJbmplY3Rvcik7CiAgICAgICAgY29uc3QgZG9jID0gaW5qZWN0MihET0NVTUVOVCk7CiAgICAgICAgcmV0dXJuICgpID0+IHsKICAgICAgICAgIGNvbnN0IGRlZmVyQmxvY2tEYXRhID0gcHJvY2Vzc0Jsb2NrRGF0YShpbmplY3Rvcik7CiAgICAgICAgICBjb25zdCBjb21tZW50c0J5QmxvY2tJZCA9IGdhdGhlckRlZmVyQmxvY2tzQ29tbWVudE5vZGVzKGRvYywgZG9jLmJvZHkpOwogICAgICAgICAgcHJvY2Vzc0FuZEluaXRUcmlnZ2VycyhpbmplY3RvciwgZGVmZXJCbG9ja0RhdGEsIGNvbW1lbnRzQnlCbG9ja0lkKTsKICAgICAgICAgIGFwcGVuZERlZmVyQmxvY2tzVG9KU0FjdGlvbk1hcChkb2MsIGluamVjdG9yKTsKICAgICAgICB9OwogICAgICB9LAogICAgICBtdWx0aTogdHJ1ZQogICAgfSk7CiAgfQogIHJldHVybiBwcm92aWRlcnM7Cn0KZnVuY3Rpb24gbG9nV2FybmluZ09uU3RhYmxlVGltZWRvdXQodGltZSwgY29uc29sZTIpIHsKICBjb25zdCBtZXNzYWdlID0gYEFuZ3VsYXIgaHlkcmF0aW9uIGV4cGVjdGVkIHRoZSBBcHBsaWNhdGlvblJlZi5pc1N0YWJsZSgpIHRvIGVtaXQgXGB0cnVlXGAsIGJ1dCBpdCBkaWRuJ3QgaGFwcGVuIHdpdGhpbiAke3RpbWV9bXMuIEFuZ3VsYXIgaHlkcmF0aW9uIGxvZ2ljIGRlcGVuZHMgb24gdGhlIGFwcGxpY2F0aW9uIGJlY29taW5nIHN0YWJsZSBhcyBhIHNpZ25hbCB0byBjb21wbGV0ZSBoeWRyYXRpb24gcHJvY2Vzcy5gOwogIGNvbnNvbGUyLndhcm4oZm9ybWF0UnVudGltZUVycm9yKC01MDYsIG1lc3NhZ2UpKTsKfQp2YXIgU1RBQklMSVRZX1dBUk5JTkdfVEhSRVNIT0xEID0gQVBQTElDQVRJT05fSVNfU1RBQkxFX1RJTUVPVVQgLSAxZTM7CnZhciBEZWJ1Z1Rhc2tUcmFja2VySW1wbCA9IGNsYXNzIHsKICBvcGVuVGFza3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIGFkZCh0YXNrSWQpIHsKICAgIHRoaXMub3BlblRhc2tzLnNldCh0YXNrSWQsIG5ldyBFcnJvcigiVGFzayBzdGFjayB0cmFja2luZyBlcnJvciIpKTsKICB9CiAgcmVtb3ZlKHRhc2tJZCkgewogICAgdGhpcy5vcGVuVGFza3MuZGVsZXRlKHRhc2tJZCk7CiAgfQp9OwpmdW5jdGlvbiBwcm92aWRlU3RhYmlsaXR5RGVidWdnaW5nKCkgewogIGNvbnN0IHRhc2tUcmFja2VyID0gbmV3IERlYnVnVGFza1RyYWNrZXJJbXBsKCk7CiAgY29uc3QgewogICAgb3BlblRhc2tzCiAgfSA9IHRhc2tUcmFja2VyOwogIHJldHVybiBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMoW3sKICAgIHByb3ZpZGU6IERFQlVHX1RBU0tfVFJBQ0tFUiwKICAgIHVzZVZhbHVlOiB0YXNrVHJhY2tlcgogIH0sIHByb3ZpZGVBcHBJbml0aWFsaXplcigoKSA9PiB7CiAgICBpZiAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgIW5nRGV2TW9kZSkgewogICAgICBjb25zb2xlLndhcm4oIlN0YWJpbGl0eSBkZWJ1Z2dpbmcgdXRpbGl0eSB3YXMgcHJvdmlkZWQgaW4gcHJvZHVjdGlvbiBtb2RlLiBUaGlzIHdpbGwgY2F1c2UgZGVidWcgY29kZSB0byBiZSBpbmNsdWRlZCBpbiBwcm9kdWN0aW9uIGJ1bmRsZXMuIElmIHRoaXMgaXMgaW50ZW50aW9uYWwgYmVjYXVzZSB5b3UgYXJlIGRlYnVnZ2luZyBzdGFiaWxpdHkgaXNzdWVzIGluIGEgcHJvZHVjdGlvbiBlbnZpcm9ubWVudCwgeW91IGNhbiBpZ25vcmUgdGhpcyB3YXJuaW5nLiIpOwogICAgfQogICAgY29uc3Qgbmdab25lID0gaW5qZWN0MihOZ1pvbmUpOwogICAgY29uc3QgYXBwbGljYXRpb25SZWYgPSBpbmplY3QyKEFwcGxpY2F0aW9uUmVmKTsKICAgIGxldCBfdGFza1RyYWNraW5nWm9uZSA9IG51bGw7CiAgICBpZiAodHlwZW9mIFpvbmUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIG5nWm9uZS5ydW4oKCkgPT4gewogICAgICAgIF90YXNrVHJhY2tpbmdab25lID0gWm9uZS5jdXJyZW50LmdldCgiVGFza1RyYWNraW5nWm9uZSIpOwogICAgICB9KTsKICAgIH0KICAgIG5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7CiAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGNvbnNvbGUuZGVidWcoYC0tLS0gQXBwbGljYXRpb24gZGlkIG5vdCBzdGFiaWxpemUgd2l0aGluICR7U1RBQklMSVRZX1dBUk5JTkdfVEhSRVNIT0xEIC8gMWUzfSBzZWNvbmRzIC0tLS1gKTsKICAgICAgICBpZiAodHlwZW9mIFpvbmUgIT09ICJ1bmRlZmluZWQiICYmICFfdGFza1RyYWNraW5nWm9uZSkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdab25lLmpzIGlzIHByZXNlbnQgYnV0IG5vIFRhc2tUcmFja2luZ1pvbmUgZm91bmQuIFRvIGVuYWJsZSBiZXR0ZXIgZGVidWdnaW5nIG9mIHRhc2tzIGluIHRoZSBBbmd1bGFyIFpvbmUsIGltcG9ydCAiem9uZS5qcy9wbHVnaW5zL3Rhc2stdHJhY2tpbmciIGluIHlvdXIgYXBwbGljYXRpb24uJyk7CiAgICAgICAgfQogICAgICAgIGlmIChfdGFza1RyYWNraW5nWm9uZT8ubWFjcm9UYXNrcz8ubGVuZ3RoKSB7CiAgICAgICAgICBjb25zb2xlLmdyb3VwKCJNYWNyb3Rhc2tzIGtlZXBpbmcgQW5ndWxhciBab25lIHVuc3RhYmxlOiIpOwogICAgICAgICAgZm9yIChjb25zdCB0IG9mIF90YXNrVHJhY2tpbmdab25lPy5tYWNyb1Rhc2tzID8/IFtdKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcodC5jcmVhdGlvbkxvY2F0aW9uLnN0YWNrKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTsKICAgICAgICB9CiAgICAgICAgY29uc29sZS5ncm91cCgiUGVuZGluZ1Rhc2tzIGtlZXBpbmcgYXBwbGljYXRpb24gdW5zdGFibGU6Iik7CiAgICAgICAgZm9yIChjb25zdCBlcnJvciBvZiBvcGVuVGFza3MudmFsdWVzKCkpIHsKICAgICAgICAgIGNvbnNvbGUuZGVidWcoZXJyb3Iuc3RhY2spOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7CiAgICAgIH0sIFNUQUJJTElUWV9XQVJOSU5HX1RIUkVTSE9MRCk7CiAgICAgIGFwcGxpY2F0aW9uUmVmLndoZW5TdGFibGUoKS50aGVuKCgpID0+IHsKICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsKICAgICAgfSk7CiAgICB9KTsKICB9KV0pOwp9CmZ1bmN0aW9uIGdldE1vZHVsZUZhY3RvcnkoaWQpIHsKICBjb25zdCB0eXBlID0gZ2V0UmVnaXN0ZXJlZE5nTW9kdWxlVHlwZShpZCk7CiAgaWYgKCF0eXBlKSB0aHJvdyBub01vZHVsZUVycm9yKGlkKTsKICByZXR1cm4gbmV3IE5nTW9kdWxlRmFjdG9yeTIodHlwZSk7Cn0KZnVuY3Rpb24gZ2V0TmdNb2R1bGVCeUlkKGlkKSB7CiAgY29uc3QgdHlwZSA9IGdldFJlZ2lzdGVyZWROZ01vZHVsZVR5cGUoaWQpOwogIGlmICghdHlwZSkgdGhyb3cgbm9Nb2R1bGVFcnJvcihpZCk7CiAgcmV0dXJuIHR5cGU7Cn0KZnVuY3Rpb24gbm9Nb2R1bGVFcnJvcihpZCkgewogIHJldHVybiBuZXcgUnVudGltZUVycm9yKDkyMCwgbmdEZXZNb2RlICYmIGBObyBtb2R1bGUgd2l0aCBJRCAke2lkfSBsb2FkZWRgKTsKfQp2YXIgQ2hhbmdlRGV0ZWN0b3JSZWYgPSBjbGFzcyB7CiAgc3RhdGljIF9fTkdfRUxFTUVOVF9JRF9fID0gaW5qZWN0Q2hhbmdlRGV0ZWN0b3JSZWY7Cn07CmZ1bmN0aW9uIGluamVjdENoYW5nZURldGVjdG9yUmVmKGZsYWdzKSB7CiAgcmV0dXJuIGNyZWF0ZVZpZXdSZWYoZ2V0Q3VycmVudFROb2RlKCksIGdldExWaWV3KCksIChmbGFncyAmIDE2KSA9PT0gMTYpOwp9CmZ1bmN0aW9uIGNyZWF0ZVZpZXdSZWYodE5vZGUsIGxWaWV3LCBpc1BpcGUyKSB7CiAgaWYgKGlzQ29tcG9uZW50SG9zdCh0Tm9kZSkgJiYgIWlzUGlwZTIpIHsKICAgIGNvbnN0IGNvbXBvbmVudFZpZXcgPSBnZXRDb21wb25lbnRMVmlld0J5SW5kZXgodE5vZGUuaW5kZXgsIGxWaWV3KTsKICAgIHJldHVybiBuZXcgVmlld1JlZihjb21wb25lbnRWaWV3LCBjb21wb25lbnRWaWV3KTsKICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiAoMyB8IDEyIHwgMzIgfCAxMjgpKSB7CiAgICBjb25zdCBob3N0Q29tcG9uZW50VmlldyA9IGxWaWV3W0RFQ0xBUkFUSU9OX0NPTVBPTkVOVF9WSUVXXTsKICAgIHJldHVybiBuZXcgVmlld1JlZihob3N0Q29tcG9uZW50VmlldywgbFZpZXcpOwogIH0KICByZXR1cm4gbnVsbDsKfQp2YXIgVmlld1JlZjIgPSBjbGFzcyBleHRlbmRzIENoYW5nZURldGVjdG9yUmVmIHsKfTsKdmFyIEVtYmVkZGVkVmlld1JlZiA9IGNsYXNzIGV4dGVuZHMgVmlld1JlZjIgewp9Owp2YXIgRGVmYXVsdEl0ZXJhYmxlRGlmZmVyRmFjdG9yeSA9IGNsYXNzIHsKICBzdXBwb3J0cyhvYmopIHsKICAgIHJldHVybiBpc0xpc3RMaWtlSXRlcmFibGUob2JqKTsKICB9CiAgY3JlYXRlKHRyYWNrQnlGbikgewogICAgcmV0dXJuIG5ldyBEZWZhdWx0SXRlcmFibGVEaWZmZXIodHJhY2tCeUZuKTsKICB9Cn07CnZhciB0cmFja0J5SWRlbnRpdHkgPSAoaW5kZXgsIGl0ZW0pID0+IGl0ZW07CnZhciBEZWZhdWx0SXRlcmFibGVEaWZmZXIgPSBjbGFzcyB7CiAgbGVuZ3RoID0gMDsKICBjb2xsZWN0aW9uOwogIF9saW5rZWRSZWNvcmRzID0gbnVsbDsKICBfdW5saW5rZWRSZWNvcmRzID0gbnVsbDsKICBfcHJldmlvdXNJdEhlYWQgPSBudWxsOwogIF9pdEhlYWQgPSBudWxsOwogIF9pdFRhaWwgPSBudWxsOwogIF9hZGRpdGlvbnNIZWFkID0gbnVsbDsKICBfYWRkaXRpb25zVGFpbCA9IG51bGw7CiAgX21vdmVzSGVhZCA9IG51bGw7CiAgX21vdmVzVGFpbCA9IG51bGw7CiAgX3JlbW92YWxzSGVhZCA9IG51bGw7CiAgX3JlbW92YWxzVGFpbCA9IG51bGw7CiAgX2lkZW50aXR5Q2hhbmdlc0hlYWQgPSBudWxsOwogIF9pZGVudGl0eUNoYW5nZXNUYWlsID0gbnVsbDsKICBfdHJhY2tCeUZuOwogIGNvbnN0cnVjdG9yKHRyYWNrQnlGbikgewogICAgdGhpcy5fdHJhY2tCeUZuID0gdHJhY2tCeUZuIHx8IHRyYWNrQnlJZGVudGl0eTsKICB9CiAgZm9yRWFjaEl0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX2l0SGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHQpIHsKICAgICAgZm4ocmVjb3JkKTsKICAgIH0KICB9CiAgZm9yRWFjaE9wZXJhdGlvbihmbikgewogICAgbGV0IG5leHRJdCA9IHRoaXMuX2l0SGVhZDsKICAgIGxldCBuZXh0UmVtb3ZlID0gdGhpcy5fcmVtb3ZhbHNIZWFkOwogICAgbGV0IGFkZFJlbW92ZU9mZnNldCA9IDA7CiAgICBsZXQgbW92ZU9mZnNldHMgPSBudWxsOwogICAgd2hpbGUgKG5leHRJdCB8fCBuZXh0UmVtb3ZlKSB7CiAgICAgIGNvbnN0IHJlY29yZCA9ICFuZXh0UmVtb3ZlIHx8IG5leHRJdCAmJiBuZXh0SXQuY3VycmVudEluZGV4IDwgZ2V0UHJldmlvdXNJbmRleChuZXh0UmVtb3ZlLCBhZGRSZW1vdmVPZmZzZXQsIG1vdmVPZmZzZXRzKSA/IG5leHRJdCA6IG5leHRSZW1vdmU7CiAgICAgIGNvbnN0IGFkalByZXZpb3VzSW5kZXggPSBnZXRQcmV2aW91c0luZGV4KHJlY29yZCwgYWRkUmVtb3ZlT2Zmc2V0LCBtb3ZlT2Zmc2V0cyk7CiAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IHJlY29yZC5jdXJyZW50SW5kZXg7CiAgICAgIGlmIChyZWNvcmQgPT09IG5leHRSZW1vdmUpIHsKICAgICAgICBhZGRSZW1vdmVPZmZzZXQtLTsKICAgICAgICBuZXh0UmVtb3ZlID0gbmV4dFJlbW92ZS5fbmV4dFJlbW92ZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV4dEl0ID0gbmV4dEl0Ll9uZXh0OwogICAgICAgIGlmIChyZWNvcmQucHJldmlvdXNJbmRleCA9PSBudWxsKSB7CiAgICAgICAgICBhZGRSZW1vdmVPZmZzZXQrKzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKCFtb3ZlT2Zmc2V0cykgbW92ZU9mZnNldHMgPSBbXTsKICAgICAgICAgIGNvbnN0IGxvY2FsTW92ZVByZXZpb3VzSW5kZXggPSBhZGpQcmV2aW91c0luZGV4IC0gYWRkUmVtb3ZlT2Zmc2V0OwogICAgICAgICAgY29uc3QgbG9jYWxDdXJyZW50SW5kZXggPSBjdXJyZW50SW5kZXggLSBhZGRSZW1vdmVPZmZzZXQ7CiAgICAgICAgICBpZiAobG9jYWxNb3ZlUHJldmlvdXNJbmRleCAhPSBsb2NhbEN1cnJlbnRJbmRleCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsTW92ZVByZXZpb3VzSW5kZXg7IGkrKykgewogICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGkgPCBtb3ZlT2Zmc2V0cy5sZW5ndGggPyBtb3ZlT2Zmc2V0c1tpXSA6IG1vdmVPZmZzZXRzW2ldID0gMDsKICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IG9mZnNldCArIGk7CiAgICAgICAgICAgICAgaWYgKGxvY2FsQ3VycmVudEluZGV4IDw9IGluZGV4ICYmIGluZGV4IDwgbG9jYWxNb3ZlUHJldmlvdXNJbmRleCkgewogICAgICAgICAgICAgICAgbW92ZU9mZnNldHNbaV0gPSBvZmZzZXQgKyAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBwcmV2aW91c0luZGV4ID0gcmVjb3JkLnByZXZpb3VzSW5kZXg7CiAgICAgICAgICAgIG1vdmVPZmZzZXRzW3ByZXZpb3VzSW5kZXhdID0gbG9jYWxDdXJyZW50SW5kZXggLSBsb2NhbE1vdmVQcmV2aW91c0luZGV4OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoYWRqUHJldmlvdXNJbmRleCAhPT0gY3VycmVudEluZGV4KSB7CiAgICAgICAgZm4ocmVjb3JkLCBhZGpQcmV2aW91c0luZGV4LCBjdXJyZW50SW5kZXgpOwogICAgICB9CiAgICB9CiAgfQogIGZvckVhY2hQcmV2aW91c0l0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX3ByZXZpb3VzSXRIZWFkOyByZWNvcmQgIT09IG51bGw7IHJlY29yZCA9IHJlY29yZC5fbmV4dFByZXZpb3VzKSB7CiAgICAgIGZuKHJlY29yZCk7CiAgICB9CiAgfQogIGZvckVhY2hBZGRlZEl0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX2FkZGl0aW9uc0hlYWQ7IHJlY29yZCAhPT0gbnVsbDsgcmVjb3JkID0gcmVjb3JkLl9uZXh0QWRkZWQpIHsKICAgICAgZm4ocmVjb3JkKTsKICAgIH0KICB9CiAgZm9yRWFjaE1vdmVkSXRlbShmbikgewogICAgbGV0IHJlY29yZDsKICAgIGZvciAocmVjb3JkID0gdGhpcy5fbW92ZXNIZWFkOyByZWNvcmQgIT09IG51bGw7IHJlY29yZCA9IHJlY29yZC5fbmV4dE1vdmVkKSB7CiAgICAgIGZuKHJlY29yZCk7CiAgICB9CiAgfQogIGZvckVhY2hSZW1vdmVkSXRlbShmbikgewogICAgbGV0IHJlY29yZDsKICAgIGZvciAocmVjb3JkID0gdGhpcy5fcmVtb3ZhbHNIZWFkOyByZWNvcmQgIT09IG51bGw7IHJlY29yZCA9IHJlY29yZC5fbmV4dFJlbW92ZWQpIHsKICAgICAgZm4ocmVjb3JkKTsKICAgIH0KICB9CiAgZm9yRWFjaElkZW50aXR5Q2hhbmdlKGZuKSB7CiAgICBsZXQgcmVjb3JkOwogICAgZm9yIChyZWNvcmQgPSB0aGlzLl9pZGVudGl0eUNoYW5nZXNIZWFkOyByZWNvcmQgIT09IG51bGw7IHJlY29yZCA9IHJlY29yZC5fbmV4dElkZW50aXR5Q2hhbmdlKSB7CiAgICAgIGZuKHJlY29yZCk7CiAgICB9CiAgfQogIGRpZmYoY29sbGVjdGlvbikgewogICAgaWYgKGNvbGxlY3Rpb24gPT0gbnVsbCkgY29sbGVjdGlvbiA9IFtdOwogICAgaWYgKCFpc0xpc3RMaWtlSXRlcmFibGUoY29sbGVjdGlvbikpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDAsIG5nRGV2TW9kZSAmJiBgRXJyb3IgdHJ5aW5nIHRvIGRpZmYgJyR7c3RyaW5naWZ5KGNvbGxlY3Rpb24pfScuIE9ubHkgYXJyYXlzIGFuZCBpdGVyYWJsZXMgYXJlIGFsbG93ZWRgKTsKICAgIH0KICAgIGlmICh0aGlzLmNoZWNrKGNvbGxlY3Rpb24pKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQogIG9uRGVzdHJveSgpIHsKICB9CiAgY2hlY2soY29sbGVjdGlvbikgewogICAgdGhpcy5fcmVzZXQoKTsKICAgIGxldCByZWNvcmQgPSB0aGlzLl9pdEhlYWQ7CiAgICBsZXQgbWF5QmVEaXJ0eSA9IGZhbHNlOwogICAgbGV0IGluZGV4OwogICAgbGV0IGl0ZW07CiAgICBsZXQgaXRlbVRyYWNrQnk7CiAgICBpZiAoQXJyYXkuaXNBcnJheShjb2xsZWN0aW9uKSkgewogICAgICB0aGlzLmxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoOwogICAgICBmb3IgKGxldCBpbmRleDIgPSAwOyBpbmRleDIgPCB0aGlzLmxlbmd0aDsgaW5kZXgyKyspIHsKICAgICAgICBpdGVtID0gY29sbGVjdGlvbltpbmRleDJdOwogICAgICAgIGl0ZW1UcmFja0J5ID0gdGhpcy5fdHJhY2tCeUZuKGluZGV4MiwgaXRlbSk7CiAgICAgICAgaWYgKHJlY29yZCA9PT0gbnVsbCB8fCAhT2JqZWN0LmlzKHJlY29yZC50cmFja0J5SWQsIGl0ZW1UcmFja0J5KSkgewogICAgICAgICAgcmVjb3JkID0gdGhpcy5fbWlzbWF0Y2gocmVjb3JkLCBpdGVtLCBpdGVtVHJhY2tCeSwgaW5kZXgyKTsKICAgICAgICAgIG1heUJlRGlydHkgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAobWF5QmVEaXJ0eSkgewogICAgICAgICAgICByZWNvcmQgPSB0aGlzLl92ZXJpZnlSZWluc2VydGlvbihyZWNvcmQsIGl0ZW0sIGl0ZW1UcmFja0J5LCBpbmRleDIpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCFPYmplY3QuaXMocmVjb3JkLml0ZW0sIGl0ZW0pKSB0aGlzLl9hZGRJZGVudGl0eUNoYW5nZShyZWNvcmQsIGl0ZW0pOwogICAgICAgIH0KICAgICAgICByZWNvcmQgPSByZWNvcmQuX25leHQ7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGluZGV4ID0gMDsKICAgICAgaXRlcmF0ZUxpc3RMaWtlKGNvbGxlY3Rpb24sIChpdGVtMikgPT4gewogICAgICAgIGl0ZW1UcmFja0J5ID0gdGhpcy5fdHJhY2tCeUZuKGluZGV4LCBpdGVtMik7CiAgICAgICAgaWYgKHJlY29yZCA9PT0gbnVsbCB8fCAhT2JqZWN0LmlzKHJlY29yZC50cmFja0J5SWQsIGl0ZW1UcmFja0J5KSkgewogICAgICAgICAgcmVjb3JkID0gdGhpcy5fbWlzbWF0Y2gocmVjb3JkLCBpdGVtMiwgaXRlbVRyYWNrQnksIGluZGV4KTsKICAgICAgICAgIG1heUJlRGlydHkgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAobWF5QmVEaXJ0eSkgewogICAgICAgICAgICByZWNvcmQgPSB0aGlzLl92ZXJpZnlSZWluc2VydGlvbihyZWNvcmQsIGl0ZW0yLCBpdGVtVHJhY2tCeSwgaW5kZXgpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCFPYmplY3QuaXMocmVjb3JkLml0ZW0sIGl0ZW0yKSkgdGhpcy5fYWRkSWRlbnRpdHlDaGFuZ2UocmVjb3JkLCBpdGVtMik7CiAgICAgICAgfQogICAgICAgIHJlY29yZCA9IHJlY29yZC5fbmV4dDsKICAgICAgICBpbmRleCsrOwogICAgICB9KTsKICAgICAgdGhpcy5sZW5ndGggPSBpbmRleDsKICAgIH0KICAgIHRoaXMuX3RydW5jYXRlKHJlY29yZCk7CiAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uOwogICAgcmV0dXJuIHRoaXMuaXNEaXJ0eTsKICB9CiAgZ2V0IGlzRGlydHkoKSB7CiAgICByZXR1cm4gdGhpcy5fYWRkaXRpb25zSGVhZCAhPT0gbnVsbCB8fCB0aGlzLl9tb3Zlc0hlYWQgIT09IG51bGwgfHwgdGhpcy5fcmVtb3ZhbHNIZWFkICE9PSBudWxsIHx8IHRoaXMuX2lkZW50aXR5Q2hhbmdlc0hlYWQgIT09IG51bGw7CiAgfQogIF9yZXNldCgpIHsKICAgIGlmICh0aGlzLmlzRGlydHkpIHsKICAgICAgbGV0IHJlY29yZDsKICAgICAgZm9yIChyZWNvcmQgPSB0aGlzLl9wcmV2aW91c0l0SGVhZCA9IHRoaXMuX2l0SGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHQpIHsKICAgICAgICByZWNvcmQuX25leHRQcmV2aW91cyA9IHJlY29yZC5fbmV4dDsKICAgICAgfQogICAgICBmb3IgKHJlY29yZCA9IHRoaXMuX2FkZGl0aW9uc0hlYWQ7IHJlY29yZCAhPT0gbnVsbDsgcmVjb3JkID0gcmVjb3JkLl9uZXh0QWRkZWQpIHsKICAgICAgICByZWNvcmQucHJldmlvdXNJbmRleCA9IHJlY29yZC5jdXJyZW50SW5kZXg7CiAgICAgIH0KICAgICAgdGhpcy5fYWRkaXRpb25zSGVhZCA9IHRoaXMuX2FkZGl0aW9uc1RhaWwgPSBudWxsOwogICAgICBmb3IgKHJlY29yZCA9IHRoaXMuX21vdmVzSGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHRNb3ZlZCkgewogICAgICAgIHJlY29yZC5wcmV2aW91c0luZGV4ID0gcmVjb3JkLmN1cnJlbnRJbmRleDsKICAgICAgfQogICAgICB0aGlzLl9tb3Zlc0hlYWQgPSB0aGlzLl9tb3Zlc1RhaWwgPSBudWxsOwogICAgICB0aGlzLl9yZW1vdmFsc0hlYWQgPSB0aGlzLl9yZW1vdmFsc1RhaWwgPSBudWxsOwogICAgICB0aGlzLl9pZGVudGl0eUNoYW5nZXNIZWFkID0gdGhpcy5faWRlbnRpdHlDaGFuZ2VzVGFpbCA9IG51bGw7CiAgICB9CiAgfQogIF9taXNtYXRjaChyZWNvcmQsIGl0ZW0sIGl0ZW1UcmFja0J5LCBpbmRleCkgewogICAgbGV0IHByZXZpb3VzUmVjb3JkOwogICAgaWYgKHJlY29yZCA9PT0gbnVsbCkgewogICAgICBwcmV2aW91c1JlY29yZCA9IHRoaXMuX2l0VGFpbDsKICAgIH0gZWxzZSB7CiAgICAgIHByZXZpb3VzUmVjb3JkID0gcmVjb3JkLl9wcmV2OwogICAgICB0aGlzLl9yZW1vdmUocmVjb3JkKTsKICAgIH0KICAgIHJlY29yZCA9IHRoaXMuX3VubGlua2VkUmVjb3JkcyA9PT0gbnVsbCA/IG51bGwgOiB0aGlzLl91bmxpbmtlZFJlY29yZHMuZ2V0KGl0ZW1UcmFja0J5LCBudWxsKTsKICAgIGlmIChyZWNvcmQgIT09IG51bGwpIHsKICAgICAgaWYgKCFPYmplY3QuaXMocmVjb3JkLml0ZW0sIGl0ZW0pKSB0aGlzLl9hZGRJZGVudGl0eUNoYW5nZShyZWNvcmQsIGl0ZW0pOwogICAgICB0aGlzLl9yZWluc2VydEFmdGVyKHJlY29yZCwgcHJldmlvdXNSZWNvcmQsIGluZGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIHJlY29yZCA9IHRoaXMuX2xpbmtlZFJlY29yZHMgPT09IG51bGwgPyBudWxsIDogdGhpcy5fbGlua2VkUmVjb3Jkcy5nZXQoaXRlbVRyYWNrQnksIGluZGV4KTsKICAgICAgaWYgKHJlY29yZCAhPT0gbnVsbCkgewogICAgICAgIGlmICghT2JqZWN0LmlzKHJlY29yZC5pdGVtLCBpdGVtKSkgdGhpcy5fYWRkSWRlbnRpdHlDaGFuZ2UocmVjb3JkLCBpdGVtKTsKICAgICAgICB0aGlzLl9tb3ZlQWZ0ZXIocmVjb3JkLCBwcmV2aW91c1JlY29yZCwgaW5kZXgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlY29yZCA9IHRoaXMuX2FkZEFmdGVyKG5ldyBJdGVyYWJsZUNoYW5nZVJlY29yZF8oaXRlbSwgaXRlbVRyYWNrQnkpLCBwcmV2aW91c1JlY29yZCwgaW5kZXgpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBfdmVyaWZ5UmVpbnNlcnRpb24ocmVjb3JkLCBpdGVtLCBpdGVtVHJhY2tCeSwgaW5kZXgpIHsKICAgIGxldCByZWluc2VydFJlY29yZCA9IHRoaXMuX3VubGlua2VkUmVjb3JkcyA9PT0gbnVsbCA/IG51bGwgOiB0aGlzLl91bmxpbmtlZFJlY29yZHMuZ2V0KGl0ZW1UcmFja0J5LCBudWxsKTsKICAgIGlmIChyZWluc2VydFJlY29yZCAhPT0gbnVsbCkgewogICAgICByZWNvcmQgPSB0aGlzLl9yZWluc2VydEFmdGVyKHJlaW5zZXJ0UmVjb3JkLCByZWNvcmQuX3ByZXYsIGluZGV4KTsKICAgIH0gZWxzZSBpZiAocmVjb3JkLmN1cnJlbnRJbmRleCAhPSBpbmRleCkgewogICAgICByZWNvcmQuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICAgIHRoaXMuX2FkZFRvTW92ZXMocmVjb3JkLCBpbmRleCk7CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBfdHJ1bmNhdGUocmVjb3JkKSB7CiAgICB3aGlsZSAocmVjb3JkICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IG5leHRSZWNvcmQgPSByZWNvcmQuX25leHQ7CiAgICAgIHRoaXMuX2FkZFRvUmVtb3ZhbHModGhpcy5fdW5saW5rKHJlY29yZCkpOwogICAgICByZWNvcmQgPSBuZXh0UmVjb3JkOwogICAgfQogICAgaWYgKHRoaXMuX3VubGlua2VkUmVjb3JkcyAhPT0gbnVsbCkgewogICAgICB0aGlzLl91bmxpbmtlZFJlY29yZHMuY2xlYXIoKTsKICAgIH0KICAgIGlmICh0aGlzLl9hZGRpdGlvbnNUYWlsICE9PSBudWxsKSB7CiAgICAgIHRoaXMuX2FkZGl0aW9uc1RhaWwuX25leHRBZGRlZCA9IG51bGw7CiAgICB9CiAgICBpZiAodGhpcy5fbW92ZXNUYWlsICE9PSBudWxsKSB7CiAgICAgIHRoaXMuX21vdmVzVGFpbC5fbmV4dE1vdmVkID0gbnVsbDsKICAgIH0KICAgIGlmICh0aGlzLl9pdFRhaWwgIT09IG51bGwpIHsKICAgICAgdGhpcy5faXRUYWlsLl9uZXh0ID0gbnVsbDsKICAgIH0KICAgIGlmICh0aGlzLl9yZW1vdmFsc1RhaWwgIT09IG51bGwpIHsKICAgICAgdGhpcy5fcmVtb3ZhbHNUYWlsLl9uZXh0UmVtb3ZlZCA9IG51bGw7CiAgICB9CiAgICBpZiAodGhpcy5faWRlbnRpdHlDaGFuZ2VzVGFpbCAhPT0gbnVsbCkgewogICAgICB0aGlzLl9pZGVudGl0eUNoYW5nZXNUYWlsLl9uZXh0SWRlbnRpdHlDaGFuZ2UgPSBudWxsOwogICAgfQogIH0KICBfcmVpbnNlcnRBZnRlcihyZWNvcmQsIHByZXZSZWNvcmQsIGluZGV4KSB7CiAgICBpZiAodGhpcy5fdW5saW5rZWRSZWNvcmRzICE9PSBudWxsKSB7CiAgICAgIHRoaXMuX3VubGlua2VkUmVjb3Jkcy5yZW1vdmUocmVjb3JkKTsKICAgIH0KICAgIGNvbnN0IHByZXYgPSByZWNvcmQuX3ByZXZSZW1vdmVkOwogICAgY29uc3QgbmV4dCA9IHJlY29yZC5fbmV4dFJlbW92ZWQ7CiAgICBpZiAocHJldiA9PT0gbnVsbCkgewogICAgICB0aGlzLl9yZW1vdmFsc0hlYWQgPSBuZXh0OwogICAgfSBlbHNlIHsKICAgICAgcHJldi5fbmV4dFJlbW92ZWQgPSBuZXh0OwogICAgfQogICAgaWYgKG5leHQgPT09IG51bGwpIHsKICAgICAgdGhpcy5fcmVtb3ZhbHNUYWlsID0gcHJldjsKICAgIH0gZWxzZSB7CiAgICAgIG5leHQuX3ByZXZSZW1vdmVkID0gcHJldjsKICAgIH0KICAgIHRoaXMuX2luc2VydEFmdGVyKHJlY29yZCwgcHJldlJlY29yZCwgaW5kZXgpOwogICAgdGhpcy5fYWRkVG9Nb3ZlcyhyZWNvcmQsIGluZGV4KTsKICAgIHJldHVybiByZWNvcmQ7CiAgfQogIF9tb3ZlQWZ0ZXIocmVjb3JkLCBwcmV2UmVjb3JkLCBpbmRleCkgewogICAgdGhpcy5fdW5saW5rKHJlY29yZCk7CiAgICB0aGlzLl9pbnNlcnRBZnRlcihyZWNvcmQsIHByZXZSZWNvcmQsIGluZGV4KTsKICAgIHRoaXMuX2FkZFRvTW92ZXMocmVjb3JkLCBpbmRleCk7CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBfYWRkQWZ0ZXIocmVjb3JkLCBwcmV2UmVjb3JkLCBpbmRleCkgewogICAgdGhpcy5faW5zZXJ0QWZ0ZXIocmVjb3JkLCBwcmV2UmVjb3JkLCBpbmRleCk7CiAgICBpZiAodGhpcy5fYWRkaXRpb25zVGFpbCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9hZGRpdGlvbnNUYWlsID0gdGhpcy5fYWRkaXRpb25zSGVhZCA9IHJlY29yZDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2FkZGl0aW9uc1RhaWwgPSB0aGlzLl9hZGRpdGlvbnNUYWlsLl9uZXh0QWRkZWQgPSByZWNvcmQ7CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBfaW5zZXJ0QWZ0ZXIocmVjb3JkLCBwcmV2UmVjb3JkLCBpbmRleCkgewogICAgY29uc3QgbmV4dCA9IHByZXZSZWNvcmQgPT09IG51bGwgPyB0aGlzLl9pdEhlYWQgOiBwcmV2UmVjb3JkLl9uZXh0OwogICAgcmVjb3JkLl9uZXh0ID0gbmV4dDsKICAgIHJlY29yZC5fcHJldiA9IHByZXZSZWNvcmQ7CiAgICBpZiAobmV4dCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9pdFRhaWwgPSByZWNvcmQ7CiAgICB9IGVsc2UgewogICAgICBuZXh0Ll9wcmV2ID0gcmVjb3JkOwogICAgfQogICAgaWYgKHByZXZSZWNvcmQgPT09IG51bGwpIHsKICAgICAgdGhpcy5faXRIZWFkID0gcmVjb3JkOwogICAgfSBlbHNlIHsKICAgICAgcHJldlJlY29yZC5fbmV4dCA9IHJlY29yZDsKICAgIH0KICAgIGlmICh0aGlzLl9saW5rZWRSZWNvcmRzID09PSBudWxsKSB7CiAgICAgIHRoaXMuX2xpbmtlZFJlY29yZHMgPSBuZXcgX0R1cGxpY2F0ZU1hcCgpOwogICAgfQogICAgdGhpcy5fbGlua2VkUmVjb3Jkcy5wdXQocmVjb3JkKTsKICAgIHJlY29yZC5jdXJyZW50SW5kZXggPSBpbmRleDsKICAgIHJldHVybiByZWNvcmQ7CiAgfQogIF9yZW1vdmUocmVjb3JkKSB7CiAgICByZXR1cm4gdGhpcy5fYWRkVG9SZW1vdmFscyh0aGlzLl91bmxpbmsocmVjb3JkKSk7CiAgfQogIF91bmxpbmsocmVjb3JkKSB7CiAgICBpZiAodGhpcy5fbGlua2VkUmVjb3JkcyAhPT0gbnVsbCkgewogICAgICB0aGlzLl9saW5rZWRSZWNvcmRzLnJlbW92ZShyZWNvcmQpOwogICAgfQogICAgY29uc3QgcHJldiA9IHJlY29yZC5fcHJldjsKICAgIGNvbnN0IG5leHQgPSByZWNvcmQuX25leHQ7CiAgICBpZiAocHJldiA9PT0gbnVsbCkgewogICAgICB0aGlzLl9pdEhlYWQgPSBuZXh0OwogICAgfSBlbHNlIHsKICAgICAgcHJldi5fbmV4dCA9IG5leHQ7CiAgICB9CiAgICBpZiAobmV4dCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9pdFRhaWwgPSBwcmV2OwogICAgfSBlbHNlIHsKICAgICAgbmV4dC5fcHJldiA9IHByZXY7CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBfYWRkVG9Nb3ZlcyhyZWNvcmQsIHRvSW5kZXgpIHsKICAgIGlmIChyZWNvcmQucHJldmlvdXNJbmRleCA9PT0gdG9JbmRleCkgewogICAgICByZXR1cm4gcmVjb3JkOwogICAgfQogICAgaWYgKHRoaXMuX21vdmVzVGFpbCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9tb3Zlc1RhaWwgPSB0aGlzLl9tb3Zlc0hlYWQgPSByZWNvcmQ7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9tb3Zlc1RhaWwgPSB0aGlzLl9tb3Zlc1RhaWwuX25leHRNb3ZlZCA9IHJlY29yZDsKICAgIH0KICAgIHJldHVybiByZWNvcmQ7CiAgfQogIF9hZGRUb1JlbW92YWxzKHJlY29yZCkgewogICAgaWYgKHRoaXMuX3VubGlua2VkUmVjb3JkcyA9PT0gbnVsbCkgewogICAgICB0aGlzLl91bmxpbmtlZFJlY29yZHMgPSBuZXcgX0R1cGxpY2F0ZU1hcCgpOwogICAgfQogICAgdGhpcy5fdW5saW5rZWRSZWNvcmRzLnB1dChyZWNvcmQpOwogICAgcmVjb3JkLmN1cnJlbnRJbmRleCA9IG51bGw7CiAgICByZWNvcmQuX25leHRSZW1vdmVkID0gbnVsbDsKICAgIGlmICh0aGlzLl9yZW1vdmFsc1RhaWwgPT09IG51bGwpIHsKICAgICAgdGhpcy5fcmVtb3ZhbHNUYWlsID0gdGhpcy5fcmVtb3ZhbHNIZWFkID0gcmVjb3JkOwogICAgICByZWNvcmQuX3ByZXZSZW1vdmVkID0gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHJlY29yZC5fcHJldlJlbW92ZWQgPSB0aGlzLl9yZW1vdmFsc1RhaWw7CiAgICAgIHRoaXMuX3JlbW92YWxzVGFpbCA9IHRoaXMuX3JlbW92YWxzVGFpbC5fbmV4dFJlbW92ZWQgPSByZWNvcmQ7CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBfYWRkSWRlbnRpdHlDaGFuZ2UocmVjb3JkLCBpdGVtKSB7CiAgICByZWNvcmQuaXRlbSA9IGl0ZW07CiAgICBpZiAodGhpcy5faWRlbnRpdHlDaGFuZ2VzVGFpbCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9pZGVudGl0eUNoYW5nZXNUYWlsID0gdGhpcy5faWRlbnRpdHlDaGFuZ2VzSGVhZCA9IHJlY29yZDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2lkZW50aXR5Q2hhbmdlc1RhaWwgPSB0aGlzLl9pZGVudGl0eUNoYW5nZXNUYWlsLl9uZXh0SWRlbnRpdHlDaGFuZ2UgPSByZWNvcmQ7CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KfTsKdmFyIEl0ZXJhYmxlQ2hhbmdlUmVjb3JkXyA9IGNsYXNzIHsKICBpdGVtOwogIHRyYWNrQnlJZDsKICBjdXJyZW50SW5kZXggPSBudWxsOwogIHByZXZpb3VzSW5kZXggPSBudWxsOwogIF9uZXh0UHJldmlvdXMgPSBudWxsOwogIF9wcmV2ID0gbnVsbDsKICBfbmV4dCA9IG51bGw7CiAgX3ByZXZEdXAgPSBudWxsOwogIF9uZXh0RHVwID0gbnVsbDsKICBfcHJldlJlbW92ZWQgPSBudWxsOwogIF9uZXh0UmVtb3ZlZCA9IG51bGw7CiAgX25leHRBZGRlZCA9IG51bGw7CiAgX25leHRNb3ZlZCA9IG51bGw7CiAgX25leHRJZGVudGl0eUNoYW5nZSA9IG51bGw7CiAgY29uc3RydWN0b3IoaXRlbSwgdHJhY2tCeUlkKSB7CiAgICB0aGlzLml0ZW0gPSBpdGVtOwogICAgdGhpcy50cmFja0J5SWQgPSB0cmFja0J5SWQ7CiAgfQp9Owp2YXIgX0R1cGxpY2F0ZUl0ZW1SZWNvcmRMaXN0ID0gY2xhc3MgewogIF9oZWFkID0gbnVsbDsKICBfdGFpbCA9IG51bGw7CiAgYWRkKHJlY29yZCkgewogICAgaWYgKHRoaXMuX2hlYWQgPT09IG51bGwpIHsKICAgICAgdGhpcy5faGVhZCA9IHRoaXMuX3RhaWwgPSByZWNvcmQ7CiAgICAgIHJlY29yZC5fbmV4dER1cCA9IG51bGw7CiAgICAgIHJlY29yZC5fcHJldkR1cCA9IG51bGw7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl90YWlsLl9uZXh0RHVwID0gcmVjb3JkOwogICAgICByZWNvcmQuX3ByZXZEdXAgPSB0aGlzLl90YWlsOwogICAgICByZWNvcmQuX25leHREdXAgPSBudWxsOwogICAgICB0aGlzLl90YWlsID0gcmVjb3JkOwogICAgfQogIH0KICBnZXQodHJhY2tCeUlkLCBhdE9yQWZ0ZXJJbmRleCkgewogICAgbGV0IHJlY29yZDsKICAgIGZvciAocmVjb3JkID0gdGhpcy5faGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHREdXApIHsKICAgICAgaWYgKChhdE9yQWZ0ZXJJbmRleCA9PT0gbnVsbCB8fCBhdE9yQWZ0ZXJJbmRleCA8PSByZWNvcmQuY3VycmVudEluZGV4KSAmJiBPYmplY3QuaXMocmVjb3JkLnRyYWNrQnlJZCwgdHJhY2tCeUlkKSkgewogICAgICAgIHJldHVybiByZWNvcmQ7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBudWxsOwogIH0KICByZW1vdmUocmVjb3JkKSB7CiAgICBjb25zdCBwcmV2ID0gcmVjb3JkLl9wcmV2RHVwOwogICAgY29uc3QgbmV4dCA9IHJlY29yZC5fbmV4dER1cDsKICAgIGlmIChwcmV2ID09PSBudWxsKSB7CiAgICAgIHRoaXMuX2hlYWQgPSBuZXh0OwogICAgfSBlbHNlIHsKICAgICAgcHJldi5fbmV4dER1cCA9IG5leHQ7CiAgICB9CiAgICBpZiAobmV4dCA9PT0gbnVsbCkgewogICAgICB0aGlzLl90YWlsID0gcHJldjsKICAgIH0gZWxzZSB7CiAgICAgIG5leHQuX3ByZXZEdXAgPSBwcmV2OwogICAgfQogICAgcmV0dXJuIHRoaXMuX2hlYWQgPT09IG51bGw7CiAgfQp9Owp2YXIgX0R1cGxpY2F0ZU1hcCA9IGNsYXNzIHsKICBtYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHB1dChyZWNvcmQpIHsKICAgIGNvbnN0IGtleSA9IHJlY29yZC50cmFja0J5SWQ7CiAgICBsZXQgZHVwbGljYXRlcyA9IHRoaXMubWFwLmdldChrZXkpOwogICAgaWYgKCFkdXBsaWNhdGVzKSB7CiAgICAgIGR1cGxpY2F0ZXMgPSBuZXcgX0R1cGxpY2F0ZUl0ZW1SZWNvcmRMaXN0KCk7CiAgICAgIHRoaXMubWFwLnNldChrZXksIGR1cGxpY2F0ZXMpOwogICAgfQogICAgZHVwbGljYXRlcy5hZGQocmVjb3JkKTsKICB9CiAgZ2V0KHRyYWNrQnlJZCwgYXRPckFmdGVySW5kZXgpIHsKICAgIGNvbnN0IGtleSA9IHRyYWNrQnlJZDsKICAgIGNvbnN0IHJlY29yZExpc3QgPSB0aGlzLm1hcC5nZXQoa2V5KTsKICAgIHJldHVybiByZWNvcmRMaXN0ID8gcmVjb3JkTGlzdC5nZXQodHJhY2tCeUlkLCBhdE9yQWZ0ZXJJbmRleCkgOiBudWxsOwogIH0KICByZW1vdmUocmVjb3JkKSB7CiAgICBjb25zdCBrZXkgPSByZWNvcmQudHJhY2tCeUlkOwogICAgY29uc3QgcmVjb3JkTGlzdCA9IHRoaXMubWFwLmdldChrZXkpOwogICAgaWYgKHJlY29yZExpc3QucmVtb3ZlKHJlY29yZCkpIHsKICAgICAgdGhpcy5tYXAuZGVsZXRlKGtleSk7CiAgICB9CiAgICByZXR1cm4gcmVjb3JkOwogIH0KICBnZXQgaXNFbXB0eSgpIHsKICAgIHJldHVybiB0aGlzLm1hcC5zaXplID09PSAwOwogIH0KICBjbGVhcigpIHsKICAgIHRoaXMubWFwLmNsZWFyKCk7CiAgfQp9OwpmdW5jdGlvbiBnZXRQcmV2aW91c0luZGV4KGl0ZW0sIGFkZFJlbW92ZU9mZnNldCwgbW92ZU9mZnNldHMpIHsKICBjb25zdCBwcmV2aW91c0luZGV4ID0gaXRlbS5wcmV2aW91c0luZGV4OwogIGlmIChwcmV2aW91c0luZGV4ID09PSBudWxsKSByZXR1cm4gcHJldmlvdXNJbmRleDsKICBsZXQgbW92ZU9mZnNldCA9IDA7CiAgaWYgKG1vdmVPZmZzZXRzICYmIHByZXZpb3VzSW5kZXggPCBtb3ZlT2Zmc2V0cy5sZW5ndGgpIHsKICAgIG1vdmVPZmZzZXQgPSBtb3ZlT2Zmc2V0c1twcmV2aW91c0luZGV4XTsKICB9CiAgcmV0dXJuIHByZXZpb3VzSW5kZXggKyBhZGRSZW1vdmVPZmZzZXQgKyBtb3ZlT2Zmc2V0Owp9CnZhciBEZWZhdWx0S2V5VmFsdWVEaWZmZXJGYWN0b3J5ID0gY2xhc3MgewogIHN1cHBvcnRzKG9iaikgewogICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIE1hcCB8fCBpc0pzT2JqZWN0KG9iaik7CiAgfQogIGNyZWF0ZSgpIHsKICAgIHJldHVybiBuZXcgRGVmYXVsdEtleVZhbHVlRGlmZmVyKCk7CiAgfQp9Owp2YXIgRGVmYXVsdEtleVZhbHVlRGlmZmVyID0gY2xhc3MgewogIF9yZWNvcmRzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBfbWFwSGVhZCA9IG51bGw7CiAgX2FwcGVuZEFmdGVyID0gbnVsbDsKICBfcHJldmlvdXNNYXBIZWFkID0gbnVsbDsKICBfY2hhbmdlc0hlYWQgPSBudWxsOwogIF9jaGFuZ2VzVGFpbCA9IG51bGw7CiAgX2FkZGl0aW9uc0hlYWQgPSBudWxsOwogIF9hZGRpdGlvbnNUYWlsID0gbnVsbDsKICBfcmVtb3ZhbHNIZWFkID0gbnVsbDsKICBnZXQgaXNEaXJ0eSgpIHsKICAgIHJldHVybiB0aGlzLl9hZGRpdGlvbnNIZWFkICE9PSBudWxsIHx8IHRoaXMuX2NoYW5nZXNIZWFkICE9PSBudWxsIHx8IHRoaXMuX3JlbW92YWxzSGVhZCAhPT0gbnVsbDsKICB9CiAgZm9yRWFjaEl0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX21hcEhlYWQ7IHJlY29yZCAhPT0gbnVsbDsgcmVjb3JkID0gcmVjb3JkLl9uZXh0KSB7CiAgICAgIGZuKHJlY29yZCk7CiAgICB9CiAgfQogIGZvckVhY2hQcmV2aW91c0l0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX3ByZXZpb3VzTWFwSGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHRQcmV2aW91cykgewogICAgICBmbihyZWNvcmQpOwogICAgfQogIH0KICBmb3JFYWNoQ2hhbmdlZEl0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX2NoYW5nZXNIZWFkOyByZWNvcmQgIT09IG51bGw7IHJlY29yZCA9IHJlY29yZC5fbmV4dENoYW5nZWQpIHsKICAgICAgZm4ocmVjb3JkKTsKICAgIH0KICB9CiAgZm9yRWFjaEFkZGVkSXRlbShmbikgewogICAgbGV0IHJlY29yZDsKICAgIGZvciAocmVjb3JkID0gdGhpcy5fYWRkaXRpb25zSGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHRBZGRlZCkgewogICAgICBmbihyZWNvcmQpOwogICAgfQogIH0KICBmb3JFYWNoUmVtb3ZlZEl0ZW0oZm4pIHsKICAgIGxldCByZWNvcmQ7CiAgICBmb3IgKHJlY29yZCA9IHRoaXMuX3JlbW92YWxzSGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHRSZW1vdmVkKSB7CiAgICAgIGZuKHJlY29yZCk7CiAgICB9CiAgfQogIGRpZmYobWFwMikgewogICAgaWYgKCFtYXAyKSB7CiAgICAgIG1hcDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogICAgfSBlbHNlIGlmICghKG1hcDIgaW5zdGFuY2VvZiBNYXAgfHwgaXNKc09iamVjdChtYXAyKSkpIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDAsIG5nRGV2TW9kZSAmJiBgRXJyb3IgdHJ5aW5nIHRvIGRpZmYgJyR7c3RyaW5naWZ5KG1hcDIpfScuIE9ubHkgbWFwcyBhbmQgb2JqZWN0cyBhcmUgYWxsb3dlZGApOwogICAgfQogICAgcmV0dXJuIHRoaXMuY2hlY2sobWFwMikgPyB0aGlzIDogbnVsbDsKICB9CiAgY2hlY2sobWFwMikgewogICAgdGhpcy5fcmVzZXQoKTsKICAgIGxldCBpbnNlcnRCZWZvcmUgPSB0aGlzLl9tYXBIZWFkOwogICAgdGhpcy5fYXBwZW5kQWZ0ZXIgPSBudWxsOwogICAgdGhpcy5fZm9yRWFjaChtYXAyLCAodmFsdWUsIGtleSkgPT4gewogICAgICBpZiAoaW5zZXJ0QmVmb3JlICYmIGluc2VydEJlZm9yZS5rZXkgPT09IGtleSkgewogICAgICAgIHRoaXMuX21heWJlQWRkVG9DaGFuZ2VzKGluc2VydEJlZm9yZSwgdmFsdWUpOwogICAgICAgIHRoaXMuX2FwcGVuZEFmdGVyID0gaW5zZXJ0QmVmb3JlOwogICAgICAgIGluc2VydEJlZm9yZSA9IGluc2VydEJlZm9yZS5fbmV4dDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCByZWNvcmQgPSB0aGlzLl9nZXRPckNyZWF0ZVJlY29yZEZvcktleShrZXksIHZhbHVlKTsKICAgICAgICBpbnNlcnRCZWZvcmUgPSB0aGlzLl9pbnNlcnRCZWZvcmVPckFwcGVuZChpbnNlcnRCZWZvcmUsIHJlY29yZCk7CiAgICAgIH0KICAgIH0pOwogICAgaWYgKGluc2VydEJlZm9yZSkgewogICAgICBpZiAoaW5zZXJ0QmVmb3JlLl9wcmV2KSB7CiAgICAgICAgaW5zZXJ0QmVmb3JlLl9wcmV2Ll9uZXh0ID0gbnVsbDsKICAgICAgfQogICAgICB0aGlzLl9yZW1vdmFsc0hlYWQgPSBpbnNlcnRCZWZvcmU7CiAgICAgIGZvciAobGV0IHJlY29yZCA9IGluc2VydEJlZm9yZTsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHRSZW1vdmVkKSB7CiAgICAgICAgaWYgKHJlY29yZCA9PT0gdGhpcy5fbWFwSGVhZCkgewogICAgICAgICAgdGhpcy5fbWFwSGVhZCA9IG51bGw7CiAgICAgICAgfQogICAgICAgIHRoaXMuX3JlY29yZHMuZGVsZXRlKHJlY29yZC5rZXkpOwogICAgICAgIHJlY29yZC5fbmV4dFJlbW92ZWQgPSByZWNvcmQuX25leHQ7CiAgICAgICAgcmVjb3JkLnByZXZpb3VzVmFsdWUgPSByZWNvcmQuY3VycmVudFZhbHVlOwogICAgICAgIHJlY29yZC5jdXJyZW50VmFsdWUgPSBudWxsOwogICAgICAgIHJlY29yZC5fcHJldiA9IG51bGw7CiAgICAgICAgcmVjb3JkLl9uZXh0ID0gbnVsbDsKICAgICAgfQogICAgfQogICAgaWYgKHRoaXMuX2NoYW5nZXNUYWlsKSB0aGlzLl9jaGFuZ2VzVGFpbC5fbmV4dENoYW5nZWQgPSBudWxsOwogICAgaWYgKHRoaXMuX2FkZGl0aW9uc1RhaWwpIHRoaXMuX2FkZGl0aW9uc1RhaWwuX25leHRBZGRlZCA9IG51bGw7CiAgICByZXR1cm4gdGhpcy5pc0RpcnR5OwogIH0KICBfaW5zZXJ0QmVmb3JlT3JBcHBlbmQoYmVmb3JlLCByZWNvcmQpIHsKICAgIGlmIChiZWZvcmUpIHsKICAgICAgY29uc3QgcHJldiA9IGJlZm9yZS5fcHJldjsKICAgICAgcmVjb3JkLl9uZXh0ID0gYmVmb3JlOwogICAgICByZWNvcmQuX3ByZXYgPSBwcmV2OwogICAgICBiZWZvcmUuX3ByZXYgPSByZWNvcmQ7CiAgICAgIGlmIChwcmV2KSB7CiAgICAgICAgcHJldi5fbmV4dCA9IHJlY29yZDsKICAgICAgfQogICAgICBpZiAoYmVmb3JlID09PSB0aGlzLl9tYXBIZWFkKSB7CiAgICAgICAgdGhpcy5fbWFwSGVhZCA9IHJlY29yZDsKICAgICAgfQogICAgICB0aGlzLl9hcHBlbmRBZnRlciA9IGJlZm9yZTsKICAgICAgcmV0dXJuIGJlZm9yZTsKICAgIH0KICAgIGlmICh0aGlzLl9hcHBlbmRBZnRlcikgewogICAgICB0aGlzLl9hcHBlbmRBZnRlci5fbmV4dCA9IHJlY29yZDsKICAgICAgcmVjb3JkLl9wcmV2ID0gdGhpcy5fYXBwZW5kQWZ0ZXI7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9tYXBIZWFkID0gcmVjb3JkOwogICAgfQogICAgdGhpcy5fYXBwZW5kQWZ0ZXIgPSByZWNvcmQ7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgX2dldE9yQ3JlYXRlUmVjb3JkRm9yS2V5KGtleSwgdmFsdWUpIHsKICAgIGlmICh0aGlzLl9yZWNvcmRzLmhhcyhrZXkpKSB7CiAgICAgIGNvbnN0IHJlY29yZDIgPSB0aGlzLl9yZWNvcmRzLmdldChrZXkpOwogICAgICB0aGlzLl9tYXliZUFkZFRvQ2hhbmdlcyhyZWNvcmQyLCB2YWx1ZSk7CiAgICAgIGNvbnN0IHByZXYgPSByZWNvcmQyLl9wcmV2OwogICAgICBjb25zdCBuZXh0ID0gcmVjb3JkMi5fbmV4dDsKICAgICAgaWYgKHByZXYpIHsKICAgICAgICBwcmV2Ll9uZXh0ID0gbmV4dDsKICAgICAgfQogICAgICBpZiAobmV4dCkgewogICAgICAgIG5leHQuX3ByZXYgPSBwcmV2OwogICAgICB9CiAgICAgIHJlY29yZDIuX25leHQgPSBudWxsOwogICAgICByZWNvcmQyLl9wcmV2ID0gbnVsbDsKICAgICAgcmV0dXJuIHJlY29yZDI7CiAgICB9CiAgICBjb25zdCByZWNvcmQgPSBuZXcgS2V5VmFsdWVDaGFuZ2VSZWNvcmRfKGtleSk7CiAgICB0aGlzLl9yZWNvcmRzLnNldChrZXksIHJlY29yZCk7CiAgICByZWNvcmQuY3VycmVudFZhbHVlID0gdmFsdWU7CiAgICB0aGlzLl9hZGRUb0FkZGl0aW9ucyhyZWNvcmQpOwogICAgcmV0dXJuIHJlY29yZDsKICB9CiAgX3Jlc2V0KCkgewogICAgaWYgKHRoaXMuaXNEaXJ0eSkgewogICAgICBsZXQgcmVjb3JkOwogICAgICB0aGlzLl9wcmV2aW91c01hcEhlYWQgPSB0aGlzLl9tYXBIZWFkOwogICAgICBmb3IgKHJlY29yZCA9IHRoaXMuX3ByZXZpb3VzTWFwSGVhZDsgcmVjb3JkICE9PSBudWxsOyByZWNvcmQgPSByZWNvcmQuX25leHQpIHsKICAgICAgICByZWNvcmQuX25leHRQcmV2aW91cyA9IHJlY29yZC5fbmV4dDsKICAgICAgfQogICAgICBmb3IgKHJlY29yZCA9IHRoaXMuX2NoYW5nZXNIZWFkOyByZWNvcmQgIT09IG51bGw7IHJlY29yZCA9IHJlY29yZC5fbmV4dENoYW5nZWQpIHsKICAgICAgICByZWNvcmQucHJldmlvdXNWYWx1ZSA9IHJlY29yZC5jdXJyZW50VmFsdWU7CiAgICAgIH0KICAgICAgZm9yIChyZWNvcmQgPSB0aGlzLl9hZGRpdGlvbnNIZWFkOyByZWNvcmQgIT0gbnVsbDsgcmVjb3JkID0gcmVjb3JkLl9uZXh0QWRkZWQpIHsKICAgICAgICByZWNvcmQucHJldmlvdXNWYWx1ZSA9IHJlY29yZC5jdXJyZW50VmFsdWU7CiAgICAgIH0KICAgICAgdGhpcy5fY2hhbmdlc0hlYWQgPSB0aGlzLl9jaGFuZ2VzVGFpbCA9IG51bGw7CiAgICAgIHRoaXMuX2FkZGl0aW9uc0hlYWQgPSB0aGlzLl9hZGRpdGlvbnNUYWlsID0gbnVsbDsKICAgICAgdGhpcy5fcmVtb3ZhbHNIZWFkID0gbnVsbDsKICAgIH0KICB9CiAgX21heWJlQWRkVG9DaGFuZ2VzKHJlY29yZCwgbmV3VmFsdWUpIHsKICAgIGlmICghT2JqZWN0LmlzKG5ld1ZhbHVlLCByZWNvcmQuY3VycmVudFZhbHVlKSkgewogICAgICByZWNvcmQucHJldmlvdXNWYWx1ZSA9IHJlY29yZC5jdXJyZW50VmFsdWU7CiAgICAgIHJlY29yZC5jdXJyZW50VmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgdGhpcy5fYWRkVG9DaGFuZ2VzKHJlY29yZCk7CiAgICB9CiAgfQogIF9hZGRUb0FkZGl0aW9ucyhyZWNvcmQpIHsKICAgIGlmICh0aGlzLl9hZGRpdGlvbnNIZWFkID09PSBudWxsKSB7CiAgICAgIHRoaXMuX2FkZGl0aW9uc0hlYWQgPSB0aGlzLl9hZGRpdGlvbnNUYWlsID0gcmVjb3JkOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5fYWRkaXRpb25zVGFpbC5fbmV4dEFkZGVkID0gcmVjb3JkOwogICAgICB0aGlzLl9hZGRpdGlvbnNUYWlsID0gcmVjb3JkOwogICAgfQogIH0KICBfYWRkVG9DaGFuZ2VzKHJlY29yZCkgewogICAgaWYgKHRoaXMuX2NoYW5nZXNIZWFkID09PSBudWxsKSB7CiAgICAgIHRoaXMuX2NoYW5nZXNIZWFkID0gdGhpcy5fY2hhbmdlc1RhaWwgPSByZWNvcmQ7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9jaGFuZ2VzVGFpbC5fbmV4dENoYW5nZWQgPSByZWNvcmQ7CiAgICAgIHRoaXMuX2NoYW5nZXNUYWlsID0gcmVjb3JkOwogICAgfQogIH0KICBfZm9yRWFjaChvYmosIGZuKSB7CiAgICBpZiAob2JqIGluc3RhbmNlb2YgTWFwKSB7CiAgICAgIG9iai5mb3JFYWNoKGZuKTsKICAgIH0gZWxzZSB7CiAgICAgIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaCgoaykgPT4gZm4ob2JqW2tdLCBrKSk7CiAgICB9CiAgfQp9Owp2YXIgS2V5VmFsdWVDaGFuZ2VSZWNvcmRfID0gY2xhc3MgewogIGtleTsKICBwcmV2aW91c1ZhbHVlID0gbnVsbDsKICBjdXJyZW50VmFsdWUgPSBudWxsOwogIF9uZXh0UHJldmlvdXMgPSBudWxsOwogIF9uZXh0ID0gbnVsbDsKICBfcHJldiA9IG51bGw7CiAgX25leHRBZGRlZCA9IG51bGw7CiAgX25leHRSZW1vdmVkID0gbnVsbDsKICBfbmV4dENoYW5nZWQgPSBudWxsOwogIGNvbnN0cnVjdG9yKGtleSkgewogICAgdGhpcy5rZXkgPSBrZXk7CiAgfQp9OwpmdW5jdGlvbiBkZWZhdWx0SXRlcmFibGVEaWZmZXJzRmFjdG9yeSgpIHsKICByZXR1cm4gbmV3IEl0ZXJhYmxlRGlmZmVycyhbbmV3IERlZmF1bHRJdGVyYWJsZURpZmZlckZhY3RvcnkoKV0pOwp9CnZhciBJdGVyYWJsZURpZmZlcnMgPSBjbGFzcyBfSXRlcmFibGVEaWZmZXJzIHsKICBmYWN0b3JpZXM7CiAgc3RhdGljIMm1cHJvdiA9IMm1ybVkZWZpbmVJbmplY3RhYmxlKHsKICAgIHRva2VuOiBfSXRlcmFibGVEaWZmZXJzLAogICAgcHJvdmlkZWRJbjogInJvb3QiLAogICAgZmFjdG9yeTogZGVmYXVsdEl0ZXJhYmxlRGlmZmVyc0ZhY3RvcnkKICB9KTsKICBjb25zdHJ1Y3RvcihmYWN0b3JpZXMpIHsKICAgIHRoaXMuZmFjdG9yaWVzID0gZmFjdG9yaWVzOwogIH0KICBzdGF0aWMgY3JlYXRlKGZhY3RvcmllcywgcGFyZW50KSB7CiAgICBpZiAocGFyZW50ICE9IG51bGwpIHsKICAgICAgY29uc3QgY29waWVkID0gcGFyZW50LmZhY3Rvcmllcy5zbGljZSgpOwogICAgICBmYWN0b3JpZXMgPSBmYWN0b3JpZXMuY29uY2F0KGNvcGllZCk7CiAgICB9CiAgICByZXR1cm4gbmV3IF9JdGVyYWJsZURpZmZlcnMoZmFjdG9yaWVzKTsKICB9CiAgc3RhdGljIGV4dGVuZChmYWN0b3JpZXMpIHsKICAgIHJldHVybiB7CiAgICAgIHByb3ZpZGU6IF9JdGVyYWJsZURpZmZlcnMsCiAgICAgIHVzZUZhY3Rvcnk6ICgpID0+IHsKICAgICAgICBjb25zdCBwYXJlbnQgPSBpbmplY3QyKF9JdGVyYWJsZURpZmZlcnMsIHsKICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLAogICAgICAgICAgc2tpcFNlbGY6IHRydWUKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gX0l0ZXJhYmxlRGlmZmVycy5jcmVhdGUoZmFjdG9yaWVzLCBwYXJlbnQgfHwgZGVmYXVsdEl0ZXJhYmxlRGlmZmVyc0ZhY3RvcnkoKSk7CiAgICAgIH0KICAgIH07CiAgfQogIGZpbmQoaXRlcmFibGUpIHsKICAgIGNvbnN0IGZhY3RvcnkgPSB0aGlzLmZhY3Rvcmllcy5maW5kKChmKSA9PiBmLnN1cHBvcnRzKGl0ZXJhYmxlKSk7CiAgICBpZiAoZmFjdG9yeSAhPSBudWxsKSB7CiAgICAgIHJldHVybiBmYWN0b3J5OwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcig5MDEsIG5nRGV2TW9kZSAmJiBgQ2Fubm90IGZpbmQgYSBkaWZmZXIgc3VwcG9ydGluZyBvYmplY3QgJyR7aXRlcmFibGV9JyBvZiB0eXBlICcke2dldFR5cGVOYW1lRm9yRGVidWdnaW5nKGl0ZXJhYmxlKX0nYCk7CiAgICB9CiAgfQp9OwpmdW5jdGlvbiBnZXRUeXBlTmFtZUZvckRlYnVnZ2luZyh0eXBlKSB7CiAgcmV0dXJuIHR5cGVbIm5hbWUiXSB8fCB0eXBlb2YgdHlwZTsKfQpmdW5jdGlvbiBkZWZhdWx0S2V5VmFsdWVEaWZmZXJzRmFjdG9yeSgpIHsKICByZXR1cm4gbmV3IEtleVZhbHVlRGlmZmVycyhbbmV3IERlZmF1bHRLZXlWYWx1ZURpZmZlckZhY3RvcnkoKV0pOwp9CnZhciBLZXlWYWx1ZURpZmZlcnMgPSBjbGFzcyBfS2V5VmFsdWVEaWZmZXJzIHsKICBzdGF0aWMgybVwcm92ID0gybXJtWRlZmluZUluamVjdGFibGUoewogICAgdG9rZW46IF9LZXlWYWx1ZURpZmZlcnMsCiAgICBwcm92aWRlZEluOiAicm9vdCIsCiAgICBmYWN0b3J5OiBkZWZhdWx0S2V5VmFsdWVEaWZmZXJzRmFjdG9yeQogIH0pOwogIGZhY3RvcmllczsKICBjb25zdHJ1Y3RvcihmYWN0b3JpZXMpIHsKICAgIHRoaXMuZmFjdG9yaWVzID0gZmFjdG9yaWVzOwogIH0KICBzdGF0aWMgY3JlYXRlKGZhY3RvcmllcywgcGFyZW50KSB7CiAgICBpZiAocGFyZW50KSB7CiAgICAgIGNvbnN0IGNvcGllZCA9IHBhcmVudC5mYWN0b3JpZXMuc2xpY2UoKTsKICAgICAgZmFjdG9yaWVzID0gZmFjdG9yaWVzLmNvbmNhdChjb3BpZWQpOwogICAgfQogICAgcmV0dXJuIG5ldyBfS2V5VmFsdWVEaWZmZXJzKGZhY3Rvcmllcyk7CiAgfQogIHN0YXRpYyBleHRlbmQoZmFjdG9yaWVzKSB7CiAgICByZXR1cm4gewogICAgICBwcm92aWRlOiBfS2V5VmFsdWVEaWZmZXJzLAogICAgICB1c2VGYWN0b3J5OiAoKSA9PiB7CiAgICAgICAgY29uc3QgcGFyZW50ID0gaW5qZWN0MihfS2V5VmFsdWVEaWZmZXJzLCB7CiAgICAgICAgICBvcHRpb25hbDogdHJ1ZSwKICAgICAgICAgIHNraXBTZWxmOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIF9LZXlWYWx1ZURpZmZlcnMuY3JlYXRlKGZhY3RvcmllcywgcGFyZW50IHx8IGRlZmF1bHRLZXlWYWx1ZURpZmZlcnNGYWN0b3J5KCkpOwogICAgICB9CiAgICB9OwogIH0KICBmaW5kKGt2KSB7CiAgICBjb25zdCBmYWN0b3J5ID0gdGhpcy5mYWN0b3JpZXMuZmluZCgoZikgPT4gZi5zdXBwb3J0cyhrdikpOwogICAgaWYgKGZhY3RvcnkpIHsKICAgICAgcmV0dXJuIGZhY3Rvcnk7CiAgICB9CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKDkwMSwgbmdEZXZNb2RlICYmIGBDYW5ub3QgZmluZCBhIGRpZmZlciBzdXBwb3J0aW5nIG9iamVjdCAnJHtrdn0nYCk7CiAgfQp9Owp2YXIga2V5VmFsRGlmZiA9IFtuZXcgRGVmYXVsdEtleVZhbHVlRGlmZmVyRmFjdG9yeSgpXTsKdmFyIGl0ZXJhYmxlRGlmZiA9IFtuZXcgRGVmYXVsdEl0ZXJhYmxlRGlmZmVyRmFjdG9yeSgpXTsKdmFyIGRlZmF1bHRJdGVyYWJsZURpZmZlcnMgPSBuZXcgSXRlcmFibGVEaWZmZXJzKGl0ZXJhYmxlRGlmZik7CnZhciBkZWZhdWx0S2V5VmFsdWVEaWZmZXJzID0gbmV3IEtleVZhbHVlRGlmZmVycyhrZXlWYWxEaWZmKTsKdmFyIHBsYXRmb3JtQ29yZSA9IGNyZWF0ZVBsYXRmb3JtRmFjdG9yeShudWxsLCAiY29yZSIsIFtdKTsKdmFyIEFwcGxpY2F0aW9uTW9kdWxlID0gY2xhc3MgX0FwcGxpY2F0aW9uTW9kdWxlIHsKICBjb25zdHJ1Y3RvcihhcHBSZWYpIHsKICB9CiAgc3RhdGljIMm1ZmFjID0gZnVuY3Rpb24gQXBwbGljYXRpb25Nb2R1bGVfRmFjdG9yeShfX25nRmFjdG9yeVR5cGVfXykgewogICAgcmV0dXJuIG5ldyAoX19uZ0ZhY3RvcnlUeXBlX18gfHwgX0FwcGxpY2F0aW9uTW9kdWxlKSjJtcm1aW5qZWN0KEFwcGxpY2F0aW9uUmVmKSk7CiAgfTsKICBzdGF0aWMgybVtb2QgPSDJtcm1ZGVmaW5lTmdNb2R1bGUoewogICAgdHlwZTogX0FwcGxpY2F0aW9uTW9kdWxlCiAgfSk7CiAgc3RhdGljIMm1aW5qID0gybXJtWRlZmluZUluamVjdG9yKHt9KTsKfTsKKCgpID0+IHsKICAodHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlKSAmJiBzZXRDbGFzc01ldGFkYXRhKEFwcGxpY2F0aW9uTW9kdWxlLCBbewogICAgdHlwZTogTmdNb2R1bGUKICB9XSwgKCkgPT4gW3sKICAgIHR5cGU6IEFwcGxpY2F0aW9uUmVmCiAgfV0sIG51bGwpOwp9KSgpOwpmdW5jdGlvbiBpbnRlcm5hbENyZWF0ZUFwcGxpY2F0aW9uKGNvbmZpZzIpIHsKICBjb25zdCB7CiAgICByb290Q29tcG9uZW50LAogICAgYXBwUHJvdmlkZXJzLAogICAgcGxhdGZvcm1Qcm92aWRlcnMsCiAgICBwbGF0Zm9ybVJlZgogIH0gPSBjb25maWcyOwogIHByb2ZpbGVyKFByb2ZpbGVyRXZlbnQuQm9vdHN0cmFwQXBwbGljYXRpb25TdGFydCk7CiAgaWYgKGZhbHNlKSB7CiAgICB0aHJvdyBuZXcgUnVudGltZUVycm9yKC00MDEsIG5nRGV2TW9kZSAmJiAiTWlzc2luZyBQbGF0Zm9ybTogVGhpcyBtYXkgYmUgZHVlIHRvIHVzaW5nIGBib290c3RyYXBBcHBsaWNhdGlvbmAgb24gdGhlIHNlcnZlciB3aXRob3V0IHBhc3NpbmcgYSBgQm9vdHN0cmFwQ29udGV4dGAuIFBsZWFzZSBtYWtlIHN1cmUgdGhhdCBgYm9vdHN0cmFwQXBwbGljYXRpb25gIGlzIGNhbGxlZCB3aXRoIGEgYGNvbnRleHRgIGFyZ3VtZW50LiIpOwogIH0KICB0cnkgewogICAgY29uc3QgcGxhdGZvcm1JbmplY3RvciA9IHBsYXRmb3JtUmVmPy5pbmplY3RvciA/PyBjcmVhdGVPclJldXNlUGxhdGZvcm1JbmplY3RvcihwbGF0Zm9ybVByb3ZpZGVycyk7CiAgICBpZiAoKHR5cGVvZiBuZ0Rldk1vZGUgPT09ICJ1bmRlZmluZWQiIHx8IG5nRGV2TW9kZSkgJiYgcm9vdENvbXBvbmVudCAhPT0gdm9pZCAwKSB7CiAgICAgIGFzc2VydFN0YW5kYWxvbmVDb21wb25lbnRUeXBlKHJvb3RDb21wb25lbnQpOwogICAgfQogICAgY29uc3QgYWxsQXBwUHJvdmlkZXJzID0gW3Byb3ZpZGVab25lbGVzc0NoYW5nZURldGVjdGlvbkludGVybmFsKCksIGVycm9ySGFuZGxlckVudmlyb25tZW50SW5pdGlhbGl6ZXIsIC4uLm5nRGV2TW9kZSA/IFt2YWxpZEFwcElkSW5pdGlhbGl6ZXJdIDogW10sIC4uLmFwcFByb3ZpZGVycyB8fCBbXV07CiAgICBjb25zdCBhZGFwdGVyID0gbmV3IEVudmlyb25tZW50TmdNb2R1bGVSZWZBZGFwdGVyKHsKICAgICAgcHJvdmlkZXJzOiBhbGxBcHBQcm92aWRlcnMsCiAgICAgIHBhcmVudDogcGxhdGZvcm1JbmplY3RvciwKICAgICAgZGVidWdOYW1lOiB0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUgPyAiRW52aXJvbm1lbnQgSW5qZWN0b3IiIDogIiIsCiAgICAgIHJ1bkVudmlyb25tZW50SW5pdGlhbGl6ZXJzOiBmYWxzZQogICAgfSk7CiAgICByZXR1cm4gYm9vdHN0cmFwKHsKICAgICAgcjNJbmplY3RvcjogYWRhcHRlci5pbmplY3RvciwKICAgICAgcGxhdGZvcm1JbmplY3RvciwKICAgICAgcm9vdENvbXBvbmVudAogICAgfSk7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpOwogIH0gZmluYWxseSB7CiAgICBwcm9maWxlcihQcm9maWxlckV2ZW50LkJvb3RzdHJhcEFwcGxpY2F0aW9uRW5kKTsKICB9Cn0KdmFyIFNlcmlhbGl6ZWRWaWV3Q29sbGVjdGlvbiA9IGNsYXNzIHsKICB2aWV3cyA9IFtdOwogIGluZGV4QnlDb250ZW50ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhZGQoc2VyaWFsaXplZFZpZXcpIHsKICAgIGNvbnN0IHZpZXdBc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KHNlcmlhbGl6ZWRWaWV3KTsKICAgIGlmICghdGhpcy5pbmRleEJ5Q29udGVudC5oYXModmlld0FzU3RyaW5nKSkgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMudmlld3MubGVuZ3RoOwogICAgICB0aGlzLnZpZXdzLnB1c2goc2VyaWFsaXplZFZpZXcpOwogICAgICB0aGlzLmluZGV4QnlDb250ZW50LnNldCh2aWV3QXNTdHJpbmcsIGluZGV4KTsKICAgICAgcmV0dXJuIGluZGV4OwogICAgfQogICAgcmV0dXJuIHRoaXMuaW5kZXhCeUNvbnRlbnQuZ2V0KHZpZXdBc1N0cmluZyk7CiAgfQogIGdldEFsbCgpIHsKICAgIHJldHVybiB0aGlzLnZpZXdzOwogIH0KfTsKdmFyIHRWaWV3U3NySWQgPSAwOwpmdW5jdGlvbiBnZXRTc3JJZCh0VmlldykgewogIGlmICghdFZpZXcuc3NySWQpIHsKICAgIHRWaWV3LnNzcklkID0gYHQke3RWaWV3U3NySWQrK31gOwogIH0KICByZXR1cm4gdFZpZXcuc3NySWQ7Cn0KZnVuY3Rpb24gY2FsY051bVJvb3ROb2Rlcyh0VmlldywgbFZpZXcsIHROb2RlKSB7CiAgY29uc3Qgcm9vdE5vZGVzID0gW107CiAgY29sbGVjdE5hdGl2ZU5vZGVzKHRWaWV3LCBsVmlldywgdE5vZGUsIHJvb3ROb2Rlcyk7CiAgcmV0dXJuIHJvb3ROb2Rlcy5sZW5ndGg7Cn0KZnVuY3Rpb24gY2FsY051bVJvb3ROb2Rlc0luTENvbnRhaW5lcihsQ29udGFpbmVyKSB7CiAgY29uc3Qgcm9vdE5vZGVzID0gW107CiAgY29sbGVjdE5hdGl2ZU5vZGVzSW5MQ29udGFpbmVyKGxDb250YWluZXIsIHJvb3ROb2Rlcyk7CiAgcmV0dXJuIHJvb3ROb2Rlcy5sZW5ndGg7Cn0KZnVuY3Rpb24gYW5ub3RhdGVDb21wb25lbnRMVmlld0Zvckh5ZHJhdGlvbihsVmlldywgY29udGV4dDIpIHsKICBjb25zdCBob3N0RWxlbWVudCA9IGxWaWV3W0hPU1RdOwogIGlmIChob3N0RWxlbWVudCAmJiAhaG9zdEVsZW1lbnQuaGFzQXR0cmlidXRlKFNLSVBfSFlEUkFUSU9OX0FUVFJfTkFNRSkpIHsKICAgIHJldHVybiBhbm5vdGF0ZUhvc3RFbGVtZW50Rm9ySHlkcmF0aW9uKGhvc3RFbGVtZW50LCBsVmlldywgbnVsbCwgY29udGV4dDIpOwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiBhbm5vdGF0ZUxDb250YWluZXJGb3JIeWRyYXRpb24obENvbnRhaW5lciwgY29udGV4dDIpIHsKICBjb25zdCBjb21wb25lbnRMVmlldyA9IHVud3JhcExWaWV3KGxDb250YWluZXJbSE9TVF0pOwogIGNvbnN0IGNvbXBvbmVudExWaWV3TmdoSW5kZXggPSBhbm5vdGF0ZUNvbXBvbmVudExWaWV3Rm9ySHlkcmF0aW9uKGNvbXBvbmVudExWaWV3LCBjb250ZXh0Mik7CiAgaWYgKGNvbXBvbmVudExWaWV3TmdoSW5kZXggPT09IG51bGwpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgaG9zdEVsZW1lbnQgPSB1bndyYXBSTm9kZShjb21wb25lbnRMVmlld1tIT1NUXSk7CiAgY29uc3Qgcm9vdExWaWV3ID0gbENvbnRhaW5lcltQQVJFTlRdOwogIGNvbnN0IHJvb3RMVmlld05naEluZGV4ID0gYW5ub3RhdGVIb3N0RWxlbWVudEZvckh5ZHJhdGlvbihob3N0RWxlbWVudCwgcm9vdExWaWV3LCBudWxsLCBjb250ZXh0Mik7CiAgY29uc3QgcmVuZGVyZXIgPSBjb21wb25lbnRMVmlld1tSRU5ERVJFUl07CiAgY29uc3QgZmluYWxJbmRleCA9IGAke2NvbXBvbmVudExWaWV3TmdoSW5kZXh9fCR7cm9vdExWaWV3TmdoSW5kZXh9YDsKICByZW5kZXJlci5zZXRBdHRyaWJ1dGUoaG9zdEVsZW1lbnQsIE5HSF9BVFRSX05BTUUsIGZpbmFsSW5kZXgpOwp9CmZ1bmN0aW9uIGFubm90YXRlRm9ySHlkcmF0aW9uKGFwcFJlZiwgZG9jKSB7CiAgY29uc3QgaW5qZWN0b3IgPSBhcHBSZWYuaW5qZWN0b3I7CiAgY29uc3QgaXNJMThuSHlkcmF0aW9uRW5hYmxlZFZhbCA9IGlzSTE4bkh5ZHJhdGlvbkVuYWJsZWQoaW5qZWN0b3IpOwogIGNvbnN0IGlzSW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkVmFsID0gaXNJbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWQoaW5qZWN0b3IpOwogIGNvbnN0IHNlcmlhbGl6ZWRWaWV3Q29sbGVjdGlvbiA9IG5ldyBTZXJpYWxpemVkVmlld0NvbGxlY3Rpb24oKTsKICBjb25zdCBjb3JydXB0ZWRUZXh0Tm9kZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIGNvbnN0IHZpZXdSZWZzID0gYXBwUmVmLl92aWV3czsKICBjb25zdCBzaG91bGRSZXBsYXlFdmVudHMgPSBpbmplY3Rvci5nZXQoSVNfRVZFTlRfUkVQTEFZX0VOQUJMRUQsIEVWRU5UX1JFUExBWV9FTkFCTEVEX0RFRkFVTFQpOwogIGNvbnN0IGV2ZW50VHlwZXNUb1JlcGxheSA9IHsKICAgIHJlZ3VsYXI6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksCiAgICBjYXB0dXJlOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpCiAgfTsKICBjb25zdCBkZWZlckJsb2NrcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgYXBwSWQgPSBhcHBSZWYuaW5qZWN0b3IuZ2V0KEFQUF9JRCk7CiAgZm9yIChjb25zdCB2aWV3UmVmIG9mIHZpZXdSZWZzKSB7CiAgICBjb25zdCBsTm9kZSA9IGdldExOb2RlRm9ySHlkcmF0aW9uKHZpZXdSZWYpOwogICAgaWYgKGxOb2RlICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IGNvbnRleHQyID0gewogICAgICAgIHNlcmlhbGl6ZWRWaWV3Q29sbGVjdGlvbiwKICAgICAgICBjb3JydXB0ZWRUZXh0Tm9kZXMsCiAgICAgICAgaXNJMThuSHlkcmF0aW9uRW5hYmxlZDogaXNJMThuSHlkcmF0aW9uRW5hYmxlZFZhbCwKICAgICAgICBpc0luY3JlbWVudGFsSHlkcmF0aW9uRW5hYmxlZDogaXNJbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWRWYWwsCiAgICAgICAgaTE4bkNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLAogICAgICAgIGV2ZW50VHlwZXNUb1JlcGxheSwKICAgICAgICBzaG91bGRSZXBsYXlFdmVudHMsCiAgICAgICAgYXBwSWQsCiAgICAgICAgZGVmZXJCbG9ja3MKICAgICAgfTsKICAgICAgaWYgKGlzTENvbnRhaW5lcihsTm9kZSkpIHsKICAgICAgICBhbm5vdGF0ZUxDb250YWluZXJGb3JIeWRyYXRpb24obE5vZGUsIGNvbnRleHQyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhbm5vdGF0ZUNvbXBvbmVudExWaWV3Rm9ySHlkcmF0aW9uKGxOb2RlLCBjb250ZXh0Mik7CiAgICAgIH0KICAgICAgaW5zZXJ0Q29ycnVwdGVkVGV4dE5vZGVNYXJrZXJzKGNvcnJ1cHRlZFRleHROb2RlcywgZG9jKTsKICAgIH0KICB9CiAgY29uc3Qgc2VyaWFsaXplZFZpZXdzID0gc2VyaWFsaXplZFZpZXdDb2xsZWN0aW9uLmdldEFsbCgpOwogIGNvbnN0IHRyYW5zZmVyU3RhdGUgPSBpbmplY3Rvci5nZXQoVHJhbnNmZXJTdGF0ZSk7CiAgdHJhbnNmZXJTdGF0ZS5zZXQoTkdIX0RBVEFfS0VZLCBzZXJpYWxpemVkVmlld3MpOwogIGlmIChkZWZlckJsb2Nrcy5zaXplID4gMCkgewogICAgY29uc3QgYmxvY2tzID0ge307CiAgICBmb3IgKGNvbnN0IFtpZCwgaW5mb10gb2YgZGVmZXJCbG9ja3MuZW50cmllcygpKSB7CiAgICAgIGJsb2Nrc1tpZF0gPSBpbmZvOwogICAgfQogICAgdHJhbnNmZXJTdGF0ZS5zZXQoTkdIX0RFRkVSX0JMT0NLU19LRVksIGJsb2Nrcyk7CiAgfQogIHJldHVybiBldmVudFR5cGVzVG9SZXBsYXk7Cn0KZnVuY3Rpb24gc2VyaWFsaXplTENvbnRhaW5lcihsQ29udGFpbmVyLCB0Tm9kZSwgbFZpZXcsIHBhcmVudERlZmVyQmxvY2tJZCwgY29udGV4dDIpIHsKICBjb25zdCB2aWV3cyA9IFtdOwogIGxldCBsYXN0Vmlld0FzU3RyaW5nID0gIiI7CiAgZm9yIChsZXQgaSA9IENPTlRBSU5FUl9IRUFERVJfT0ZGU0VUOyBpIDwgbENvbnRhaW5lci5sZW5ndGg7IGkrKykgewogICAgbGV0IGNoaWxkTFZpZXcgPSBsQ29udGFpbmVyW2ldOwogICAgbGV0IHRlbXBsYXRlOwogICAgbGV0IG51bVJvb3ROb2RlczsKICAgIGxldCBzZXJpYWxpemVkVmlldzsKICAgIGlmIChpc1Jvb3RWaWV3KGNoaWxkTFZpZXcpKSB7CiAgICAgIGNoaWxkTFZpZXcgPSBjaGlsZExWaWV3W0hFQURFUl9PRkZTRVRdOwogICAgICBpZiAoaXNMQ29udGFpbmVyKGNoaWxkTFZpZXcpKSB7CiAgICAgICAgbnVtUm9vdE5vZGVzID0gY2FsY051bVJvb3ROb2Rlc0luTENvbnRhaW5lcihjaGlsZExWaWV3KSArIDE7CiAgICAgICAgYW5ub3RhdGVMQ29udGFpbmVyRm9ySHlkcmF0aW9uKGNoaWxkTFZpZXcsIGNvbnRleHQyKTsKICAgICAgICBjb25zdCBjb21wb25lbnRMVmlldyA9IHVud3JhcExWaWV3KGNoaWxkTFZpZXdbSE9TVF0pOwogICAgICAgIHNlcmlhbGl6ZWRWaWV3ID0gewogICAgICAgICAgW1RFTVBMQVRFX0lEXTogY29tcG9uZW50TFZpZXdbVFZJRVddLnNzcklkLAogICAgICAgICAgW05VTV9ST09UX05PREVTXTogbnVtUm9vdE5vZGVzCiAgICAgICAgfTsKICAgICAgfQogICAgfQogICAgaWYgKCFzZXJpYWxpemVkVmlldykgewogICAgICBjb25zdCBjaGlsZFRWaWV3ID0gY2hpbGRMVmlld1tUVklFV107CiAgICAgIGlmIChjaGlsZFRWaWV3LnR5cGUgPT09IDEpIHsKICAgICAgICB0ZW1wbGF0ZSA9IGNoaWxkVFZpZXcuc3NySWQ7CiAgICAgICAgbnVtUm9vdE5vZGVzID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZW1wbGF0ZSA9IGdldFNzcklkKGNoaWxkVFZpZXcpOwogICAgICAgIG51bVJvb3ROb2RlcyA9IGNhbGNOdW1Sb290Tm9kZXMoY2hpbGRUVmlldywgY2hpbGRMVmlldywgY2hpbGRUVmlldy5maXJzdENoaWxkKTsKICAgICAgfQogICAgICBzZXJpYWxpemVkVmlldyA9IHsKICAgICAgICBbVEVNUExBVEVfSURdOiB0ZW1wbGF0ZSwKICAgICAgICBbTlVNX1JPT1RfTk9ERVNdOiBudW1Sb290Tm9kZXMKICAgICAgfTsKICAgICAgbGV0IGlzSHlkcmF0ZU5ldmVyQmxvY2sgPSBmYWxzZTsKICAgICAgaWYgKGlzRGVmZXJCbG9jayhsVmlld1tUVklFV10sIHROb2RlKSkgewogICAgICAgIGNvbnN0IGxEZXRhaWxzID0gZ2V0TERlZmVyQmxvY2tEZXRhaWxzKGxWaWV3LCB0Tm9kZSk7CiAgICAgICAgY29uc3QgdERldGFpbHMgPSBnZXRURGVmZXJCbG9ja0RldGFpbHMobFZpZXdbVFZJRVddLCB0Tm9kZSk7CiAgICAgICAgaWYgKGNvbnRleHQyLmlzSW5jcmVtZW50YWxIeWRyYXRpb25FbmFibGVkICYmIHREZXRhaWxzLmh5ZHJhdGVUcmlnZ2VycyAhPT0gbnVsbCkgewogICAgICAgICAgY29uc3QgZGVmZXJCbG9ja0lkID0gYGQke2NvbnRleHQyLmRlZmVyQmxvY2tzLnNpemV9YDsKICAgICAgICAgIGlmICh0RGV0YWlscy5oeWRyYXRlVHJpZ2dlcnMuaGFzKDcpKSB7CiAgICAgICAgICAgIGlzSHlkcmF0ZU5ldmVyQmxvY2sgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgbGV0IHJvb3ROb2RlcyA9IFtdOwogICAgICAgICAgY29sbGVjdE5hdGl2ZU5vZGVzSW5MQ29udGFpbmVyKGxDb250YWluZXIsIHJvb3ROb2Rlcyk7CiAgICAgICAgICBjb25zdCBkZWZlckJsb2NrSW5mbyA9IHsKICAgICAgICAgICAgW05VTV9ST09UX05PREVTXTogcm9vdE5vZGVzLmxlbmd0aCwKICAgICAgICAgICAgW0RFRkVSX0JMT0NLX1NUQVRFJDFdOiBsRGV0YWlsc1tERUZFUl9CTE9DS19TVEFURV0KICAgICAgICAgIH07CiAgICAgICAgICBjb25zdCBzZXJpYWxpemVkVHJpZ2dlcnMgPSBzZXJpYWxpemVIeWRyYXRlVHJpZ2dlcnModERldGFpbHMuaHlkcmF0ZVRyaWdnZXJzKTsKICAgICAgICAgIGlmIChzZXJpYWxpemVkVHJpZ2dlcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBkZWZlckJsb2NrSW5mb1tERUZFUl9IWURSQVRFX1RSSUdHRVJTXSA9IHNlcmlhbGl6ZWRUcmlnZ2VyczsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwYXJlbnREZWZlckJsb2NrSWQgIT09IG51bGwpIHsKICAgICAgICAgICAgZGVmZXJCbG9ja0luZm9bREVGRVJfUEFSRU5UX0JMT0NLX0lEXSA9IHBhcmVudERlZmVyQmxvY2tJZDsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnRleHQyLmRlZmVyQmxvY2tzLnNldChkZWZlckJsb2NrSWQsIGRlZmVyQmxvY2tJbmZvKTsKICAgICAgICAgIGNvbnN0IG5vZGUgPSB1bndyYXBSTm9kZShsQ29udGFpbmVyKTsKICAgICAgICAgIGlmIChub2RlICE9PSB2b2lkIDApIHsKICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuQ09NTUVOVF9OT0RFKSB7CiAgICAgICAgICAgICAgYW5ub3RhdGVEZWZlckJsb2NrQW5jaG9yRm9ySHlkcmF0aW9uKG5vZGUsIGRlZmVyQmxvY2tJZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5nRGV2TW9kZSAmJiB2YWxpZGF0ZU5vZGVFeGlzdHMobm9kZSwgY2hpbGRMVmlldywgdE5vZGUpOwogICAgICAgICAgICBuZ0Rldk1vZGUgJiYgdmFsaWRhdGVNYXRjaGluZ05vZGUobm9kZSwgTm9kZS5DT01NRU5UX05PREUsIG51bGwsIGNoaWxkTFZpZXcsIHROb2RlLCB0cnVlKTsKICAgICAgICAgICAgYW5ub3RhdGVEZWZlckJsb2NrQW5jaG9yRm9ySHlkcmF0aW9uKG5vZGUsIGRlZmVyQmxvY2tJZCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIWlzSHlkcmF0ZU5ldmVyQmxvY2spIHsKICAgICAgICAgICAgYW5ub3RhdGVEZWZlckJsb2NrUm9vdE5vZGVzV2l0aEpzQWN0aW9uKHREZXRhaWxzLCByb290Tm9kZXMsIGRlZmVyQmxvY2tJZCwgY29udGV4dDIpOwogICAgICAgICAgfQogICAgICAgICAgcGFyZW50RGVmZXJCbG9ja0lkID0gZGVmZXJCbG9ja0lkOwogICAgICAgICAgc2VyaWFsaXplZFZpZXdbREVGRVJfQkxPQ0tfSURdID0gZGVmZXJCbG9ja0lkOwogICAgICAgIH0KICAgICAgICBzZXJpYWxpemVkVmlld1tERUZFUl9CTE9DS19TVEFURSQxXSA9IGxEZXRhaWxzW0RFRkVSX0JMT0NLX1NUQVRFXTsKICAgICAgfQogICAgICBpZiAoIWlzSHlkcmF0ZU5ldmVyQmxvY2spIHsKICAgICAgICBPYmplY3QuYXNzaWduKHNlcmlhbGl6ZWRWaWV3LCBzZXJpYWxpemVMVmlldyhsQ29udGFpbmVyW2ldLCBwYXJlbnREZWZlckJsb2NrSWQsIGNvbnRleHQyKSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGN1cnJlbnRWaWV3QXNTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShzZXJpYWxpemVkVmlldyk7CiAgICBpZiAodmlld3MubGVuZ3RoID4gMCAmJiBjdXJyZW50Vmlld0FzU3RyaW5nID09PSBsYXN0Vmlld0FzU3RyaW5nKSB7CiAgICAgIGNvbnN0IHByZXZpb3VzVmlldyA9IHZpZXdzW3ZpZXdzLmxlbmd0aCAtIDFdOwogICAgICBwcmV2aW91c1ZpZXdbTVVMVElQTElFUl0gPz89IDE7CiAgICAgIHByZXZpb3VzVmlld1tNVUxUSVBMSUVSXSsrOwogICAgfSBlbHNlIHsKICAgICAgbGFzdFZpZXdBc1N0cmluZyA9IGN1cnJlbnRWaWV3QXNTdHJpbmc7CiAgICAgIHZpZXdzLnB1c2goc2VyaWFsaXplZFZpZXcpOwogICAgfQogIH0KICByZXR1cm4gdmlld3M7Cn0KZnVuY3Rpb24gc2VyaWFsaXplSHlkcmF0ZVRyaWdnZXJzKHRyaWdnZXJNYXApIHsKICBjb25zdCBzZXJpYWxpemFibGVEZWZlckJsb2NrVHJpZ2dlciA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFswLCAxLCAyLCA1XSk7CiAgbGV0IHRyaWdnZXJzID0gW107CiAgZm9yIChsZXQgW3RyaWdnZXIsIGRldGFpbHNdIG9mIHRyaWdnZXJNYXApIHsKICAgIGlmIChzZXJpYWxpemFibGVEZWZlckJsb2NrVHJpZ2dlci5oYXModHJpZ2dlcikpIHsKICAgICAgaWYgKGRldGFpbHMgPT09IG51bGwpIHsKICAgICAgICB0cmlnZ2Vycy5wdXNoKHRyaWdnZXIpOwogICAgICB9IGVsc2UgaWYgKGRldGFpbHMudHlwZSA9PT0gNSkgewogICAgICAgIHRyaWdnZXJzLnB1c2goewogICAgICAgICAgdHJpZ2dlciwKICAgICAgICAgIGRlbGF5OiBkZXRhaWxzLmRlbGF5CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcnMucHVzaCh7CiAgICAgICAgICB0cmlnZ2VyLAogICAgICAgICAgaW50ZXJzZWN0aW9uT2JzZXJ2ZXJPcHRpb25zOiBkZXRhaWxzLmludGVyc2VjdGlvbk9ic2VydmVyT3B0aW9ucwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQogIHJldHVybiB0cmlnZ2VyczsKfQpmdW5jdGlvbiBhcHBlbmRTZXJpYWxpemVkTm9kZVBhdGgobmdoLCB0Tm9kZSwgbFZpZXcsIGV4Y2x1ZGVkUGFyZW50Tm9kZXMpIHsKICBjb25zdCBub09mZnNldEluZGV4ID0gdE5vZGUuaW5kZXggLSBIRUFERVJfT0ZGU0VUOwogIG5naFtOT0RFU10gPz89IHt9OwogIG5naFtOT0RFU11bbm9PZmZzZXRJbmRleF0gPz89IGNhbGNQYXRoRm9yTm9kZSh0Tm9kZSwgbFZpZXcsIGV4Y2x1ZGVkUGFyZW50Tm9kZXMpOwp9CmZ1bmN0aW9uIGFwcGVuZERpc2Nvbm5lY3RlZE5vZGVJbmRleChuZ2gsIHROb2RlT3JOb09mZnNldEluZGV4KSB7CiAgY29uc3Qgbm9PZmZzZXRJbmRleCA9IHR5cGVvZiB0Tm9kZU9yTm9PZmZzZXRJbmRleCA9PT0gIm51bWJlciIgPyB0Tm9kZU9yTm9PZmZzZXRJbmRleCA6IHROb2RlT3JOb09mZnNldEluZGV4LmluZGV4IC0gSEVBREVSX09GRlNFVDsKICBuZ2hbRElTQ09OTkVDVEVEX05PREVTXSA/Pz0gW107CiAgaWYgKCFuZ2hbRElTQ09OTkVDVEVEX05PREVTXS5pbmNsdWRlcyhub09mZnNldEluZGV4KSkgewogICAgbmdoW0RJU0NPTk5FQ1RFRF9OT0RFU10ucHVzaChub09mZnNldEluZGV4KTsKICB9Cn0KZnVuY3Rpb24gc2VyaWFsaXplTFZpZXcobFZpZXcsIHBhcmVudERlZmVyQmxvY2tJZCA9IG51bGwsIGNvbnRleHQyKSB7CiAgY29uc3QgbmdoID0ge307CiAgY29uc3QgdFZpZXcgPSBsVmlld1tUVklFV107CiAgY29uc3QgaTE4bkNoaWxkcmVuID0gZ2V0T3JDb21wdXRlSTE4bkNoaWxkcmVuKHRWaWV3LCBjb250ZXh0Mik7CiAgY29uc3QgbmF0aXZlRWxlbWVudHNUb0V2ZW50VHlwZXMgPSBjb250ZXh0Mi5zaG91bGRSZXBsYXlFdmVudHMgPyBjb2xsZWN0RG9tRXZlbnRzSW5mbyh0VmlldywgbFZpZXcsIGNvbnRleHQyLmV2ZW50VHlwZXNUb1JlcGxheSkgOiBudWxsOwogIGZvciAobGV0IGkgPSBIRUFERVJfT0ZGU0VUOyBpIDwgdFZpZXcuYmluZGluZ1N0YXJ0SW5kZXg7IGkrKykgewogICAgY29uc3QgdE5vZGUgPSB0Vmlldy5kYXRhW2ldOwogICAgY29uc3Qgbm9PZmZzZXRJbmRleCA9IGkgLSBIRUFERVJfT0ZGU0VUOwogICAgY29uc3QgaTE4bkRhdGEgPSB0cnlTZXJpYWxpemVJMThuQmxvY2sobFZpZXcsIGksIGNvbnRleHQyKTsKICAgIGlmIChpMThuRGF0YSkgewogICAgICBuZ2hbSTE4Tl9EQVRBXSA/Pz0ge307CiAgICAgIG5naFtJMThOX0RBVEFdW25vT2Zmc2V0SW5kZXhdID0gaTE4bkRhdGEuY2FzZVF1ZXVlOwogICAgICBmb3IgKGNvbnN0IG5vZGVOb09mZnNldEluZGV4IG9mIGkxOG5EYXRhLmRpc2Nvbm5lY3RlZE5vZGVzKSB7CiAgICAgICAgYXBwZW5kRGlzY29ubmVjdGVkTm9kZUluZGV4KG5naCwgbm9kZU5vT2Zmc2V0SW5kZXgpOwogICAgICB9CiAgICAgIGZvciAoY29uc3Qgbm9kZU5vT2Zmc2V0SW5kZXggb2YgaTE4bkRhdGEuZGlzam9pbnROb2RlcykgewogICAgICAgIGNvbnN0IHROb2RlMiA9IHRWaWV3LmRhdGFbbm9kZU5vT2Zmc2V0SW5kZXggKyBIRUFERVJfT0ZGU0VUXTsKICAgICAgICBuZ0Rldk1vZGUgJiYgYXNzZXJ0VE5vZGUodE5vZGUyKTsKICAgICAgICBhcHBlbmRTZXJpYWxpemVkTm9kZVBhdGgobmdoLCB0Tm9kZTIsIGxWaWV3LCBpMThuQ2hpbGRyZW4pOwogICAgICB9CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKCFpc1ROb2RlU2hhcGUodE5vZGUpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKGlzRGV0YWNoZWRCeUkxOG4odE5vZGUpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKGlzTENvbnRhaW5lcihsVmlld1tpXSkgJiYgdE5vZGUudFZpZXcpIHsKICAgICAgbmdoW1RFTVBMQVRFU10gPz89IHt9OwogICAgICBuZ2hbVEVNUExBVEVTXVtub09mZnNldEluZGV4XSA9IGdldFNzcklkKHROb2RlLnRWaWV3KTsKICAgIH0KICAgIGlmIChpc0Rpc2Nvbm5lY3RlZE5vZGUodE5vZGUsIGxWaWV3KSAmJiBpc0NvbnRlbnRQcm9qZWN0ZWROb2RlKHROb2RlKSkgewogICAgICBhcHBlbmREaXNjb25uZWN0ZWROb2RlSW5kZXgobmdoLCB0Tm9kZSk7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKEFycmF5LmlzQXJyYXkodE5vZGUucHJvamVjdGlvbikpIHsKICAgICAgZm9yIChjb25zdCBwcm9qZWN0aW9uSGVhZFROb2RlIG9mIHROb2RlLnByb2plY3Rpb24pIHsKICAgICAgICBpZiAoIXByb2plY3Rpb25IZWFkVE5vZGUpIGNvbnRpbnVlOwogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShwcm9qZWN0aW9uSGVhZFROb2RlKSkgewogICAgICAgICAgaWYgKCFpc1Byb2plY3Rpb25UTm9kZShwcm9qZWN0aW9uSGVhZFROb2RlKSAmJiAhaXNJblNraXBIeWRyYXRpb25CbG9jazIocHJvamVjdGlvbkhlYWRUTm9kZSkpIHsKICAgICAgICAgICAgaWYgKGlzRGlzY29ubmVjdGVkTm9kZShwcm9qZWN0aW9uSGVhZFROb2RlLCBsVmlldykpIHsKICAgICAgICAgICAgICBhcHBlbmREaXNjb25uZWN0ZWROb2RlSW5kZXgobmdoLCBwcm9qZWN0aW9uSGVhZFROb2RlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBhcHBlbmRTZXJpYWxpemVkTm9kZVBhdGgobmdoLCBwcm9qZWN0aW9uSGVhZFROb2RlLCBsVmlldywgaTE4bkNoaWxkcmVuKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyB1bnN1cHBvcnRlZFByb2plY3Rpb25PZkRvbU5vZGVzKHVud3JhcFJOb2RlKGxWaWV3W2ldKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjb25kaXRpb25hbGx5QW5ub3RhdGVOb2RlUGF0aChuZ2gsIHROb2RlLCBsVmlldywgaTE4bkNoaWxkcmVuKTsKICAgIGlmIChpc0xDb250YWluZXIobFZpZXdbaV0pKSB7CiAgICAgIGNvbnN0IGhvc3ROb2RlID0gbFZpZXdbaV1bSE9TVF07CiAgICAgIGlmIChBcnJheS5pc0FycmF5KGhvc3ROb2RlKSkgewogICAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSB1bndyYXBSTm9kZShob3N0Tm9kZSk7CiAgICAgICAgaWYgKCF0YXJnZXROb2RlLmhhc0F0dHJpYnV0ZShTS0lQX0hZRFJBVElPTl9BVFRSX05BTUUpKSB7CiAgICAgICAgICBhbm5vdGF0ZUhvc3RFbGVtZW50Rm9ySHlkcmF0aW9uKHRhcmdldE5vZGUsIGhvc3ROb2RlLCBwYXJlbnREZWZlckJsb2NrSWQsIGNvbnRleHQyKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgbmdoW0NPTlRBSU5FUlNdID8/PSB7fTsKICAgICAgbmdoW0NPTlRBSU5FUlNdW25vT2Zmc2V0SW5kZXhdID0gc2VyaWFsaXplTENvbnRhaW5lcihsVmlld1tpXSwgdE5vZGUsIGxWaWV3LCBwYXJlbnREZWZlckJsb2NrSWQsIGNvbnRleHQyKTsKICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShsVmlld1tpXSkgJiYgIWlzTGV0RGVjbGFyYXRpb24odE5vZGUpKSB7CiAgICAgIGNvbnN0IHRhcmdldE5vZGUgPSB1bndyYXBSTm9kZShsVmlld1tpXVtIT1NUXSk7CiAgICAgIGlmICghdGFyZ2V0Tm9kZS5oYXNBdHRyaWJ1dGUoU0tJUF9IWURSQVRJT05fQVRUUl9OQU1FKSkgewogICAgICAgIGFubm90YXRlSG9zdEVsZW1lbnRGb3JIeWRyYXRpb24odGFyZ2V0Tm9kZSwgbFZpZXdbaV0sIHBhcmVudERlZmVyQmxvY2tJZCwgY29udGV4dDIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAodE5vZGUudHlwZSAmIDgpIHsKICAgICAgICBuZ2hbRUxFTUVOVF9DT05UQUlORVJTXSA/Pz0ge307CiAgICAgICAgbmdoW0VMRU1FTlRfQ09OVEFJTkVSU11bbm9PZmZzZXRJbmRleF0gPSBjYWxjTnVtUm9vdE5vZGVzKHRWaWV3LCBsVmlldywgdE5vZGUuY2hpbGQpOwogICAgICB9IGVsc2UgaWYgKHROb2RlLnR5cGUgJiAoMTYgfCAxMjgpKSB7CiAgICAgICAgbGV0IG5leHRUTm9kZSA9IHROb2RlLm5leHQ7CiAgICAgICAgd2hpbGUgKG5leHRUTm9kZSAhPT0gbnVsbCAmJiBuZXh0VE5vZGUudHlwZSAmICgxNiB8IDEyOCkpIHsKICAgICAgICAgIG5leHRUTm9kZSA9IG5leHRUTm9kZS5uZXh0OwogICAgICAgIH0KICAgICAgICBpZiAobmV4dFROb2RlICYmICFpc0luU2tpcEh5ZHJhdGlvbkJsb2NrMihuZXh0VE5vZGUpKSB7CiAgICAgICAgICBhcHBlbmRTZXJpYWxpemVkTm9kZVBhdGgobmdoLCBuZXh0VE5vZGUsIGxWaWV3LCBpMThuQ2hpbGRyZW4pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0Tm9kZS50eXBlICYgMSkgewogICAgICAgIGNvbnN0IHJOb2RlID0gdW53cmFwUk5vZGUobFZpZXdbaV0pOwogICAgICAgIHByb2Nlc3NUZXh0Tm9kZUJlZm9yZVNlcmlhbGl6YXRpb24oY29udGV4dDIsIHJOb2RlKTsKICAgICAgfQogICAgfQogICAgaWYgKG5hdGl2ZUVsZW1lbnRzVG9FdmVudFR5cGVzICYmIHROb2RlLnR5cGUgJiAyKSB7CiAgICAgIGNvbnN0IG5hdGl2ZUVsZW1lbnQgPSB1bndyYXBSTm9kZShsVmlld1tpXSk7CiAgICAgIGlmIChuYXRpdmVFbGVtZW50c1RvRXZlbnRUeXBlcy5oYXMobmF0aXZlRWxlbWVudCkpIHsKICAgICAgICBzZXRKU0FjdGlvbkF0dHJpYnV0ZXMobmF0aXZlRWxlbWVudCwgbmF0aXZlRWxlbWVudHNUb0V2ZW50VHlwZXMuZ2V0KG5hdGl2ZUVsZW1lbnQpLCBwYXJlbnREZWZlckJsb2NrSWQpOwogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBuZ2g7Cn0KZnVuY3Rpb24gY29uZGl0aW9uYWxseUFubm90YXRlTm9kZVBhdGgobmdoLCB0Tm9kZSwgbFZpZXcsIGV4Y2x1ZGVkUGFyZW50Tm9kZXMpIHsKICBpZiAoaXNQcm9qZWN0aW9uVE5vZGUodE5vZGUpKSB7CiAgICByZXR1cm47CiAgfQogIGlmICh0Tm9kZS5wcm9qZWN0aW9uTmV4dCAmJiB0Tm9kZS5wcm9qZWN0aW9uTmV4dCAhPT0gdE5vZGUubmV4dCAmJiAhaXNJblNraXBIeWRyYXRpb25CbG9jazIodE5vZGUucHJvamVjdGlvbk5leHQpKSB7CiAgICBhcHBlbmRTZXJpYWxpemVkTm9kZVBhdGgobmdoLCB0Tm9kZS5wcm9qZWN0aW9uTmV4dCwgbFZpZXcsIGV4Y2x1ZGVkUGFyZW50Tm9kZXMpOwogIH0KICBpZiAodE5vZGUucHJldiA9PT0gbnVsbCAmJiB0Tm9kZS5wYXJlbnQgIT09IG51bGwgJiYgaXNEaXNjb25uZWN0ZWROb2RlKHROb2RlLnBhcmVudCwgbFZpZXcpICYmICFpc0Rpc2Nvbm5lY3RlZE5vZGUodE5vZGUsIGxWaWV3KSkgewogICAgYXBwZW5kU2VyaWFsaXplZE5vZGVQYXRoKG5naCwgdE5vZGUsIGxWaWV3LCBleGNsdWRlZFBhcmVudE5vZGVzKTsKICB9Cn0KZnVuY3Rpb24gY29tcG9uZW50VXNlc1NoYWRvd0RvbUVuY2Fwc3VsYXRpb24obFZpZXcpIHsKICBjb25zdCBpbnN0YW5jZSA9IGxWaWV3W0NPTlRFWFRdOwogIGlmICghaW5zdGFuY2U/LmNvbnN0cnVjdG9yKSByZXR1cm4gZmFsc2U7CiAgY29uc3QgZGVmID0gZ2V0Q29tcG9uZW50RGVmKGluc3RhbmNlLmNvbnN0cnVjdG9yKTsKICByZXR1cm4gZGVmPy5lbmNhcHN1bGF0aW9uID09PSBWaWV3RW5jYXBzdWxhdGlvbi5TaGFkb3dEb20gfHwgZGVmPy5lbmNhcHN1bGF0aW9uID09PSBWaWV3RW5jYXBzdWxhdGlvbi5FeHBlcmltZW50YWxJc29sYXRlZFNoYWRvd0RvbTsKfQpmdW5jdGlvbiBhbm5vdGF0ZUhvc3RFbGVtZW50Rm9ySHlkcmF0aW9uKGVsZW1lbnQsIGxWaWV3LCBwYXJlbnREZWZlckJsb2NrSWQsIGNvbnRleHQyKSB7CiAgY29uc3QgcmVuZGVyZXIgPSBsVmlld1tSRU5ERVJFUl07CiAgaWYgKGhhc0kxOG4obFZpZXcpICYmICFpc0kxOG5IeWRyYXRpb25TdXBwb3J0RW5hYmxlZCgpIHx8IGNvbXBvbmVudFVzZXNTaGFkb3dEb21FbmNhcHN1bGF0aW9uKGxWaWV3KSkgewogICAgcmVuZGVyZXIuc2V0QXR0cmlidXRlKGVsZW1lbnQsIFNLSVBfSFlEUkFUSU9OX0FUVFJfTkFNRSwgIiIpOwogICAgcmV0dXJuIG51bGw7CiAgfSBlbHNlIHsKICAgIGNvbnN0IG5naCA9IHNlcmlhbGl6ZUxWaWV3KGxWaWV3LCBwYXJlbnREZWZlckJsb2NrSWQsIGNvbnRleHQyKTsKICAgIGNvbnN0IGluZGV4ID0gY29udGV4dDIuc2VyaWFsaXplZFZpZXdDb2xsZWN0aW9uLmFkZChuZ2gpOwogICAgcmVuZGVyZXIuc2V0QXR0cmlidXRlKGVsZW1lbnQsIE5HSF9BVFRSX05BTUUsIGluZGV4LnRvU3RyaW5nKCkpOwogICAgcmV0dXJuIGluZGV4OwogIH0KfQpmdW5jdGlvbiBhbm5vdGF0ZURlZmVyQmxvY2tBbmNob3JGb3JIeWRyYXRpb24oY29tbWVudCwgZGVmZXJCbG9ja0lkKSB7CiAgY29tbWVudC50ZXh0Q29udGVudCA9IGBuZ2g9JHtkZWZlckJsb2NrSWR9YDsKfQpmdW5jdGlvbiBpbnNlcnRDb3JydXB0ZWRUZXh0Tm9kZU1hcmtlcnMoY29ycnVwdGVkVGV4dE5vZGVzLCBkb2MpIHsKICBmb3IgKGNvbnN0IFt0ZXh0Tm9kZSwgbWFya2VyXSBvZiBjb3JydXB0ZWRUZXh0Tm9kZXMpIHsKICAgIHRleHROb2RlLmFmdGVyKGRvYy5jcmVhdGVDb21tZW50KG1hcmtlcikpOwogIH0KfQpmdW5jdGlvbiBpc0NvbnRlbnRQcm9qZWN0ZWROb2RlKHROb2RlKSB7CiAgbGV0IGN1cnJlbnRUTm9kZSA9IHROb2RlOwogIHdoaWxlIChjdXJyZW50VE5vZGUgIT0gbnVsbCkgewogICAgaWYgKGlzQ29tcG9uZW50SG9zdChjdXJyZW50VE5vZGUpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgY3VycmVudFROb2RlID0gY3VycmVudFROb2RlLnBhcmVudDsKICB9CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGFubm90YXRlRGVmZXJCbG9ja1Jvb3ROb2Rlc1dpdGhKc0FjdGlvbih0RGV0YWlscywgcm9vdE5vZGVzLCBwYXJlbnREZWZlckJsb2NrSWQsIGNvbnRleHQyKSB7CiAgY29uc3QgYWN0aW9uTGlzdCA9IGNvbnZlcnRIeWRyYXRlVHJpZ2dlcnNUb0pzQWN0aW9uKHREZXRhaWxzLmh5ZHJhdGVUcmlnZ2Vycyk7CiAgZm9yIChsZXQgZXQgb2YgYWN0aW9uTGlzdCkgewogICAgY29udGV4dDIuZXZlbnRUeXBlc1RvUmVwbGF5LnJlZ3VsYXIuYWRkKGV0KTsKICB9CiAgaWYgKGFjdGlvbkxpc3QubGVuZ3RoID4gMCkgewogICAgY29uc3QgZWxlbWVudE5vZGVzID0gcm9vdE5vZGVzLmZpbHRlcigocm4pID0+IHJuLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSk7CiAgICBmb3IgKGxldCByTm9kZSBvZiBlbGVtZW50Tm9kZXMpIHsKICAgICAgc2V0SlNBY3Rpb25BdHRyaWJ1dGVzKHJOb2RlLCBhY3Rpb25MaXN0LCBwYXJlbnREZWZlckJsb2NrSWQpOwogICAgfQogIH0KfQpmdW5jdGlvbiBib29sZWFuQXR0cmlidXRlKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iID8gdmFsdWUgOiB2YWx1ZSAhPSBudWxsICYmIHZhbHVlICE9PSAiZmFsc2UiOwp9CmZ1bmN0aW9uIG51bWJlckF0dHJpYnV0ZSh2YWx1ZSwgZmFsbGJhY2tWYWx1ZSA9IE5hTikgewogIGNvbnN0IGlzTnVtYmVyVmFsdWUgPSAhaXNOYU4ocGFyc2VGbG9hdCh2YWx1ZSkpICYmICFpc05hTihOdW1iZXIodmFsdWUpKTsKICByZXR1cm4gaXNOdW1iZXJWYWx1ZSA/IE51bWJlcih2YWx1ZSkgOiBmYWxsYmFja1ZhbHVlOwp9CnZhciBQRVJGT1JNQU5DRV9NQVJLX1BSRUZJWCA9ICLwn4Ww77iPIjsKdmFyIGVuYWJsZVBlcmZMb2dnaW5nID0gZmFsc2U7CmZ1bmN0aW9uIHN0YXJ0TWVhc3VyaW5nKGxhYmVsKSB7CiAgaWYgKCFlbmFibGVQZXJmTG9nZ2luZykgewogICAgcmV0dXJuOwogIH0KICBjb25zdCB7CiAgICBzdGFydExhYmVsCiAgfSA9IGxhYmVscyhsYWJlbCk7CiAgcGVyZm9ybWFuY2UubWFyayhzdGFydExhYmVsKTsKfQpmdW5jdGlvbiBzdG9wTWVhc3VyaW5nKGxhYmVsKSB7CiAgaWYgKCFlbmFibGVQZXJmTG9nZ2luZykgewogICAgcmV0dXJuOwogIH0KICBjb25zdCB7CiAgICBzdGFydExhYmVsLAogICAgbGFiZWxOYW1lLAogICAgZW5kTGFiZWwKICB9ID0gbGFiZWxzKGxhYmVsKTsKICBwZXJmb3JtYW5jZS5tYXJrKGVuZExhYmVsKTsKICBwZXJmb3JtYW5jZS5tZWFzdXJlKGxhYmVsTmFtZSwgc3RhcnRMYWJlbCwgZW5kTGFiZWwpOwogIHBlcmZvcm1hbmNlLmNsZWFyTWFya3Moc3RhcnRMYWJlbCk7CiAgcGVyZm9ybWFuY2UuY2xlYXJNYXJrcyhlbmRMYWJlbCk7Cn0KZnVuY3Rpb24gbGFiZWxzKGxhYmVsKSB7CiAgY29uc3QgbGFiZWxOYW1lID0gYCR7UEVSRk9STUFOQ0VfTUFSS19QUkVGSVh9OiR7bGFiZWx9YDsKICByZXR1cm4gewogICAgbGFiZWxOYW1lLAogICAgc3RhcnRMYWJlbDogYHN0YXJ0OiR7bGFiZWxOYW1lfWAsCiAgICBlbmRMYWJlbDogYGVuZDoke2xhYmVsTmFtZX1gCiAgfTsKfQp2YXIgd2FybmluZ0xvZ2dlZCA9IGZhbHNlOwpmdW5jdGlvbiBlbmFibGVQcm9maWxpbmcyKCkgewogIGlmICghd2FybmluZ0xvZ2dlZCAmJiAodHlwZW9mIHBlcmZvcm1hbmNlID09PSAidW5kZWZpbmVkIiB8fCAhcGVyZm9ybWFuY2UubWFyayB8fCAhcGVyZm9ybWFuY2UubWVhc3VyZSkpIHsKICAgIHdhcm5pbmdMb2dnZWQgPSB0cnVlOwogICAgY29uc29sZS53YXJuKCJQZXJmb3JtYW5jZSBBUEkgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGlzIHBsYXRmb3JtIik7CiAgICByZXR1cm47CiAgfQogIGVuYWJsZVBlcmZMb2dnaW5nID0gdHJ1ZTsKfQpmdW5jdGlvbiBkaXNhYmxlUHJvZmlsaW5nKCkgewogIGVuYWJsZVBlcmZMb2dnaW5nID0gZmFsc2U7Cn0KZnVuY3Rpb24gZ2V0Q2xvc2VzdENvbXBvbmVudE5hbWUobm9kZSkgewogIGxldCBjdXJyZW50Tm9kZSA9IG5vZGU7CiAgd2hpbGUgKGN1cnJlbnROb2RlKSB7CiAgICBjb25zdCBsVmlldyA9IHJlYWRQYXRjaGVkTFZpZXcoY3VycmVudE5vZGUpOwogICAgaWYgKGxWaWV3ICE9PSBudWxsKSB7CiAgICAgIGZvciAobGV0IGkgPSBIRUFERVJfT0ZGU0VUOyBpIDwgbFZpZXcubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBjdXJyZW50ID0gbFZpZXdbaV07CiAgICAgICAgaWYgKCFpc0xWaWV3KGN1cnJlbnQpICYmICFpc0xDb250YWluZXIoY3VycmVudCkgfHwgY3VycmVudFtIT1NUXSAhPT0gY3VycmVudE5vZGUpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBjb25zdCB0VmlldyA9IGxWaWV3W1RWSUVXXTsKICAgICAgICBjb25zdCB0Tm9kZSA9IGdldFROb2RlKHRWaWV3LCBpKTsKICAgICAgICBpZiAoaXNDb21wb25lbnRIb3N0KHROb2RlKSkgewogICAgICAgICAgY29uc3QgZGVmID0gdFZpZXcuZGF0YVt0Tm9kZS5kaXJlY3RpdmVTdGFydCArIHROb2RlLmNvbXBvbmVudE9mZnNldF07CiAgICAgICAgICBjb25zdCBuYW1lID0gZGVmLmRlYnVnSW5mbz8uY2xhc3NOYW1lIHx8IGRlZi50eXBlLm5hbWU7CiAgICAgICAgICBpZiAobmFtZSkgewogICAgICAgICAgICByZXR1cm4gbmFtZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlOwogIH0KICByZXR1cm4gbnVsbDsKfQpmdW5jdGlvbiDJtWFzc2VydFR5cGUodmFsdWUpIHsKfQpmdW5jdGlvbiDJtcm1bmdEZWNsYXJlRGlyZWN0aXZlKGRlY2wpIHsKICBjb25zdCBjb21waWxlciA9IGdldENvbXBpbGVyRmFjYWRlKHsKICAgIHVzYWdlOiAxLAogICAga2luZDogImRpcmVjdGl2ZSIsCiAgICB0eXBlOiBkZWNsLnR5cGUKICB9KTsKICByZXR1cm4gY29tcGlsZXIuY29tcGlsZURpcmVjdGl2ZURlY2xhcmF0aW9uKGFuZ3VsYXJDb3JlRW52LCBgbmc6Ly8vJHtkZWNsLnR5cGUubmFtZX0vybVmYWMuanNgLCBkZWNsKTsKfQpmdW5jdGlvbiDJtcm1bmdEZWNsYXJlQ2xhc3NNZXRhZGF0YShkZWNsKSB7CiAgc2V0Q2xhc3NNZXRhZGF0YShkZWNsLnR5cGUsIGRlY2wuZGVjb3JhdG9ycywgZGVjbC5jdG9yUGFyYW1ldGVycyA/PyBudWxsLCBkZWNsLnByb3BEZWNvcmF0b3JzID8/IG51bGwpOwp9CmZ1bmN0aW9uIMm1ybVuZ0RlY2xhcmVDbGFzc01ldGFkYXRhQXN5bmMoZGVjbCkgewogIHNldENsYXNzTWV0YWRhdGFBc3luYyhkZWNsLnR5cGUsIGRlY2wucmVzb2x2ZURlZmVycmVkRGVwcywgKC4uLnR5cGVzKSA9PiB7CiAgICBjb25zdCBtZXRhID0gZGVjbC5yZXNvbHZlTWV0YWRhdGEoLi4udHlwZXMpOwogICAgc2V0Q2xhc3NNZXRhZGF0YShkZWNsLnR5cGUsIG1ldGEuZGVjb3JhdG9ycywgbWV0YS5jdG9yUGFyYW1ldGVycywgbWV0YS5wcm9wRGVjb3JhdG9ycyk7CiAgfSk7Cn0KZnVuY3Rpb24gybXJtW5nRGVjbGFyZUNvbXBvbmVudChkZWNsKSB7CiAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICB1c2FnZTogMSwKICAgIGtpbmQ6ICJjb21wb25lbnQiLAogICAgdHlwZTogZGVjbC50eXBlCiAgfSk7CiAgcmV0dXJuIGNvbXBpbGVyLmNvbXBpbGVDb21wb25lbnREZWNsYXJhdGlvbihhbmd1bGFyQ29yZUVudiwgYG5nOi8vLyR7ZGVjbC50eXBlLm5hbWV9L8m1Y21wLmpzYCwgZGVjbCk7Cn0KZnVuY3Rpb24gybXJtW5nRGVjbGFyZUZhY3RvcnkoZGVjbCkgewogIGNvbnN0IGNvbXBpbGVyID0gZ2V0Q29tcGlsZXJGYWNhZGUoewogICAgdXNhZ2U6IDEsCiAgICBraW5kOiBnZXRGYWN0b3J5S2luZChkZWNsLnRhcmdldCksCiAgICB0eXBlOiBkZWNsLnR5cGUKICB9KTsKICByZXR1cm4gY29tcGlsZXIuY29tcGlsZUZhY3RvcnlEZWNsYXJhdGlvbihhbmd1bGFyQ29yZUVudiwgYG5nOi8vLyR7ZGVjbC50eXBlLm5hbWV9L8m1ZmFjLmpzYCwgZGVjbCk7Cn0KZnVuY3Rpb24gZ2V0RmFjdG9yeUtpbmQodGFyZ2V0KSB7CiAgc3dpdGNoICh0YXJnZXQpIHsKICAgIGNhc2UgRmFjdG9yeVRhcmdldC5EaXJlY3RpdmU6CiAgICAgIHJldHVybiAiZGlyZWN0aXZlIjsKICAgIGNhc2UgRmFjdG9yeVRhcmdldC5Db21wb25lbnQ6CiAgICAgIHJldHVybiAiY29tcG9uZW50IjsKICAgIGNhc2UgRmFjdG9yeVRhcmdldC5JbmplY3RhYmxlOgogICAgICByZXR1cm4gImluamVjdGFibGUiOwogICAgY2FzZSBGYWN0b3J5VGFyZ2V0LlBpcGU6CiAgICAgIHJldHVybiAicGlwZSI7CiAgICBjYXNlIEZhY3RvcnlUYXJnZXQuTmdNb2R1bGU6CiAgICAgIHJldHVybiAiTmdNb2R1bGUiOwogIH0KfQpmdW5jdGlvbiDJtcm1bmdEZWNsYXJlSW5qZWN0YWJsZShkZWNsKSB7CiAgY29uc3QgY29tcGlsZXIgPSBnZXRDb21waWxlckZhY2FkZSh7CiAgICB1c2FnZTogMSwKICAgIGtpbmQ6ICJpbmplY3RhYmxlIiwKICAgIHR5cGU6IGRlY2wudHlwZQogIH0pOwogIHJldHVybiBjb21waWxlci5jb21waWxlSW5qZWN0YWJsZURlY2xhcmF0aW9uKGFuZ3VsYXJDb3JlRW52LCBgbmc6Ly8vJHtkZWNsLnR5cGUubmFtZX0vybVwcm92LmpzYCwgZGVjbCk7Cn0KZnVuY3Rpb24gybXJtW5nRGVjbGFyZUluamVjdG9yKGRlY2wpIHsKICBjb25zdCBjb21waWxlciA9IGdldENvbXBpbGVyRmFjYWRlKHsKICAgIHVzYWdlOiAxLAogICAga2luZDogIk5nTW9kdWxlIiwKICAgIHR5cGU6IGRlY2wudHlwZQogIH0pOwogIHJldHVybiBjb21waWxlci5jb21waWxlSW5qZWN0b3JEZWNsYXJhdGlvbihhbmd1bGFyQ29yZUVudiwgYG5nOi8vLyR7ZGVjbC50eXBlLm5hbWV9L8m1aW5qLmpzYCwgZGVjbCk7Cn0KZnVuY3Rpb24gybXJtW5nRGVjbGFyZU5nTW9kdWxlKGRlY2wpIHsKICBjb25zdCBjb21waWxlciA9IGdldENvbXBpbGVyRmFjYWRlKHsKICAgIHVzYWdlOiAxLAogICAga2luZDogIk5nTW9kdWxlIiwKICAgIHR5cGU6IGRlY2wudHlwZQogIH0pOwogIHJldHVybiBjb21waWxlci5jb21waWxlTmdNb2R1bGVEZWNsYXJhdGlvbihhbmd1bGFyQ29yZUVudiwgYG5nOi8vLyR7ZGVjbC50eXBlLm5hbWV9L8m1bW9kLmpzYCwgZGVjbCk7Cn0KZnVuY3Rpb24gybXJtW5nRGVjbGFyZVBpcGUoZGVjbCkgewogIGNvbnN0IGNvbXBpbGVyID0gZ2V0Q29tcGlsZXJGYWNhZGUoewogICAgdXNhZ2U6IDEsCiAgICBraW5kOiAicGlwZSIsCiAgICB0eXBlOiBkZWNsLnR5cGUKICB9KTsKICByZXR1cm4gY29tcGlsZXIuY29tcGlsZVBpcGVEZWNsYXJhdGlvbihhbmd1bGFyQ29yZUVudiwgYG5nOi8vLyR7ZGVjbC50eXBlLm5hbWV9L8m1cGlwZS5qc2AsIGRlY2wpOwp9CnZhciBOT1RfU0VUID0gLyogQF9fUFVSRV9fICovIFN5bWJvbCgiTk9UX1NFVCIpOwp2YXIgRU1QVFlfQ0xFQU5VUF9TRVQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpOwp2YXIgQUZURVJfUkVOREVSX1BIQVNFX0VGRkVDVF9OT0RFID0gKCgpID0+IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIFNJR05BTF9OT0RFKSwgewogIGtpbmQ6ICJhZnRlclJlbmRlckVmZmVjdFBoYXNlIiwKICBjb25zdW1lcklzQWx3YXlzTGl2ZTogdHJ1ZSwKICBjb25zdW1lckFsbG93U2lnbmFsV3JpdGVzOiB0cnVlLAogIHZhbHVlOiBOT1RfU0VULAogIGNsZWFudXA6IG51bGwsCiAgY29uc3VtZXJNYXJrZWREaXJ0eSgpIHsKICAgIGlmICh0aGlzLnNlcXVlbmNlLmltcGwuZXhlY3V0aW5nKSB7CiAgICAgIGlmICh0aGlzLnNlcXVlbmNlLmxhc3RQaGFzZSA9PT0gbnVsbCB8fCB0aGlzLnNlcXVlbmNlLmxhc3RQaGFzZSA8IHRoaXMucGhhc2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5zZXF1ZW5jZS5lcnJvcmVkT3JEZXN0cm95ZWQgPSB0cnVlOwogICAgfQogICAgdGhpcy5zZXF1ZW5jZS5zY2hlZHVsZXIubm90aWZ5KDcpOwogIH0sCiAgcGhhc2VGbihwcmV2aW91c1ZhbHVlKSB7CiAgICB0aGlzLnNlcXVlbmNlLmxhc3RQaGFzZSA9IHRoaXMucGhhc2U7CiAgICBpZiAoIXRoaXMuZGlydHkpIHsKICAgICAgcmV0dXJuIHRoaXMuc2lnbmFsOwogICAgfQogICAgdGhpcy5kaXJ0eSA9IGZhbHNlOwogICAgaWYgKHRoaXMudmFsdWUgIT09IE5PVF9TRVQgJiYgIWNvbnN1bWVyUG9sbFByb2R1Y2Vyc0ZvckNoYW5nZSh0aGlzKSkgewogICAgICByZXR1cm4gdGhpcy5zaWduYWw7CiAgICB9CiAgICB0cnkgewogICAgICBmb3IgKGNvbnN0IGNsZWFudXBGbiBvZiB0aGlzLmNsZWFudXAgPz8gRU1QVFlfQ0xFQU5VUF9TRVQpIHsKICAgICAgICBjbGVhbnVwRm4oKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgdGhpcy5jbGVhbnVwPy5jbGVhcigpOwogICAgfQogICAgY29uc3QgYXJncyA9IFtdOwogICAgaWYgKHByZXZpb3VzVmFsdWUgIT09IHZvaWQgMCkgewogICAgICBhcmdzLnB1c2gocHJldmlvdXNWYWx1ZSk7CiAgICB9CiAgICBhcmdzLnB1c2godGhpcy5yZWdpc3RlckNsZWFudXBGbik7CiAgICBjb25zdCBwcmV2Q29uc3VtZXIgPSBjb25zdW1lckJlZm9yZUNvbXB1dGF0aW9uKHRoaXMpOwogICAgbGV0IG5ld1ZhbHVlOwogICAgdHJ5IHsKICAgICAgbmV3VmFsdWUgPSB0aGlzLnVzZXJGbi5hcHBseShudWxsLCBhcmdzKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGNvbnN1bWVyQWZ0ZXJDb21wdXRhdGlvbih0aGlzLCBwcmV2Q29uc3VtZXIpOwogICAgfQogICAgaWYgKHRoaXMudmFsdWUgPT09IE5PVF9TRVQgfHwgIXRoaXMuZXF1YWwodGhpcy52YWx1ZSwgbmV3VmFsdWUpKSB7CiAgICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgdGhpcy52ZXJzaW9uKys7CiAgICB9CiAgICByZXR1cm4gdGhpcy5zaWduYWw7CiAgfQp9KSkoKTsKdmFyIEFmdGVyUmVuZGVyRWZmZWN0U2VxdWVuY2UgPSBjbGFzcyBleHRlbmRzIEFmdGVyUmVuZGVyU2VxdWVuY2UgewogIHNjaGVkdWxlcjsKICBsYXN0UGhhc2UgPSBudWxsOwogIG5vZGVzID0gW3ZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMF07CiAgb25EZXN0cm95Rm5zID0gbnVsbDsKICBjb25zdHJ1Y3RvcihpbXBsLCBlZmZlY3RIb29rcywgdmlldywgc2NoZWR1bGVyLCBpbmplY3Rvciwgc25hcHNob3QgPSBudWxsKSB7CiAgICBzdXBlcihpbXBsLCBbdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwXSwgdmlldywgZmFsc2UsIGluamVjdG9yLmdldChEZXN0cm95UmVmKSwgc25hcHNob3QpOwogICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICBmb3IgKGNvbnN0IHBoYXNlIG9mIEFGVEVSX1JFTkRFUl9QSEFTRVMpIHsKICAgICAgY29uc3QgZWZmZWN0SG9vayA9IGVmZmVjdEhvb2tzW3BoYXNlXTsKICAgICAgaWYgKGVmZmVjdEhvb2sgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGNvbnN0IG5vZGUgPSBPYmplY3QuY3JlYXRlKEFGVEVSX1JFTkRFUl9QSEFTRV9FRkZFQ1RfTk9ERSk7CiAgICAgIG5vZGUuc2VxdWVuY2UgPSB0aGlzOwogICAgICBub2RlLnBoYXNlID0gcGhhc2U7CiAgICAgIG5vZGUudXNlckZuID0gZWZmZWN0SG9vazsKICAgICAgbm9kZS5kaXJ0eSA9IHRydWU7CiAgICAgIG5vZGUuc2lnbmFsID0gKCkgPT4gewogICAgICAgIHByb2R1Y2VyQWNjZXNzZWQobm9kZSk7CiAgICAgICAgcmV0dXJuIG5vZGUudmFsdWU7CiAgICAgIH07CiAgICAgIG5vZGUuc2lnbmFsW1NJR05BTF0gPSBub2RlOwogICAgICBub2RlLnJlZ2lzdGVyQ2xlYW51cEZuID0gKGZuKSA9PiAobm9kZS5jbGVhbnVwID8/PSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpKS5hZGQoZm4pOwogICAgICB0aGlzLm5vZGVzW3BoYXNlXSA9IG5vZGU7CiAgICAgIHRoaXMuaG9va3NbcGhhc2VdID0gKHZhbHVlKSA9PiBub2RlLnBoYXNlRm4odmFsdWUpOwogICAgICBpZiAobmdEZXZNb2RlKSB7CiAgICAgICAgc2V0dXBEZWJ1Z0luZm8obm9kZSwgaW5qZWN0b3IpOwogICAgICB9CiAgICB9CiAgfQogIGFmdGVyUnVuKCkgewogICAgc3VwZXIuYWZ0ZXJSdW4oKTsKICAgIHRoaXMubGFzdFBoYXNlID0gbnVsbDsKICB9CiAgZGVzdHJveSgpIHsKICAgIGlmICh0aGlzLm9uRGVzdHJveUZucyAhPT0gbnVsbCkgewogICAgICBmb3IgKGNvbnN0IGZuIG9mIHRoaXMub25EZXN0cm95Rm5zKSB7CiAgICAgICAgZm4oKTsKICAgICAgfQogICAgfQogICAgc3VwZXIuZGVzdHJveSgpOwogICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMubm9kZXMpIHsKICAgICAgaWYgKG5vZGUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChjb25zdCBmbiBvZiBub2RlLmNsZWFudXAgPz8gRU1QVFlfQ0xFQU5VUF9TRVQpIHsKICAgICAgICAgICAgZm4oKTsKICAgICAgICAgIH0KICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgY29uc3VtZXJEZXN0cm95KG5vZGUpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTsKZnVuY3Rpb24gYWZ0ZXJSZW5kZXJFZmZlY3QoY2FsbGJhY2tPclNwZWMsIG9wdGlvbnMpIHsKICBuZ0Rldk1vZGUgJiYgYXNzZXJ0Tm90SW5SZWFjdGl2ZUNvbnRleHQoYWZ0ZXJSZW5kZXJFZmZlY3QsICJDYWxsIGBhZnRlclJlbmRlckVmZmVjdGAgb3V0c2lkZSBvZiBhIHJlYWN0aXZlIGNvbnRleHQuIEZvciBleGFtcGxlLCBjcmVhdGUgdGhlIHJlbmRlciBlZmZlY3QgaW5zaWRlIHRoZSBjb21wb25lbnQgY29uc3RydWN0b3JgLiIpOwogIGlmIChuZ0Rldk1vZGUgJiYgIW9wdGlvbnM/LmluamVjdG9yKSB7CiAgICBhc3NlcnRJbkluamVjdGlvbkNvbnRleHQoYWZ0ZXJSZW5kZXJFZmZlY3QpOwogIH0KICBpZiAoZmFsc2UpIHsKICAgIHJldHVybiBOT09QX0FGVEVSX1JFTkRFUl9SRUY7CiAgfQogIGNvbnN0IGluamVjdG9yID0gb3B0aW9ucz8uaW5qZWN0b3IgPz8gaW5qZWN0MihJbmplY3Rvcik7CiAgY29uc3Qgc2NoZWR1bGVyID0gaW5qZWN0b3IuZ2V0KENoYW5nZURldGVjdGlvblNjaGVkdWxlcik7CiAgY29uc3QgbWFuYWdlciA9IGluamVjdG9yLmdldChBZnRlclJlbmRlck1hbmFnZXIpOwogIGNvbnN0IHRyYWNpbmcgPSBpbmplY3Rvci5nZXQoVHJhY2luZ1NlcnZpY2UsIG51bGwsIHsKICAgIG9wdGlvbmFsOiB0cnVlCiAgfSk7CiAgbWFuYWdlci5pbXBsID8/PSBpbmplY3Rvci5nZXQoQWZ0ZXJSZW5kZXJJbXBsKTsKICBsZXQgc3BlYyA9IGNhbGxiYWNrT3JTcGVjOwogIGlmICh0eXBlb2Ygc3BlYyA9PT0gImZ1bmN0aW9uIikgewogICAgc3BlYyA9IHsKICAgICAgbWl4ZWRSZWFkV3JpdGU6IGNhbGxiYWNrT3JTcGVjCiAgICB9OwogIH0KICBjb25zdCB2aWV3Q29udGV4dCA9IGluamVjdG9yLmdldChWaWV3Q29udGV4dCwgbnVsbCwgewogICAgb3B0aW9uYWw6IHRydWUKICB9KTsKICBjb25zdCBzZXF1ZW5jZSA9IG5ldyBBZnRlclJlbmRlckVmZmVjdFNlcXVlbmNlKG1hbmFnZXIuaW1wbCwgW3NwZWMuZWFybHlSZWFkLCBzcGVjLndyaXRlLCBzcGVjLm1peGVkUmVhZFdyaXRlLCBzcGVjLnJlYWRdLCB2aWV3Q29udGV4dD8udmlldywgc2NoZWR1bGVyLCBpbmplY3RvciwgdHJhY2luZz8uc25hcHNob3QobnVsbCkpOwogIG1hbmFnZXIuaW1wbC5yZWdpc3RlcihzZXF1ZW5jZSk7CiAgcmV0dXJuIHNlcXVlbmNlOwp9CmZ1bmN0aW9uIHNldHVwRGVidWdJbmZvKG5vZGUsIGluamVjdG9yKSB7CiAgbm9kZS5kZWJ1Z05hbWUgPSBgYWZ0ZXJSZW5kZXJFZmZlY3QgLSAke3BoYXNlRGVidWdOYW1lKG5vZGUucGhhc2UpfSBwaGFzZWA7CiAgY29uc3QgcHJldkluamVjdG9yUHJvZmlsZXJDb250ZXh0ID0gc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQoewogICAgaW5qZWN0b3IsCiAgICB0b2tlbjogbnVsbAogIH0pOwogIHRyeSB7CiAgICBlbWl0QWZ0ZXJSZW5kZXJFZmZlY3RQaGFzZUNyZWF0ZWRFdmVudChub2RlKTsKICB9IGZpbmFsbHkgewogICAgc2V0SW5qZWN0b3JQcm9maWxlckNvbnRleHQocHJldkluamVjdG9yUHJvZmlsZXJDb250ZXh0KTsKICB9Cn0KZnVuY3Rpb24gcGhhc2VEZWJ1Z05hbWUocGhhc2UpIHsKICBzd2l0Y2ggKHBoYXNlKSB7CiAgICBjYXNlIDA6CiAgICAgIHJldHVybiAiRWFybHlSZWFkIjsKICAgIGNhc2UgMToKICAgICAgcmV0dXJuICJXcml0ZSI7CiAgICBjYXNlIDI6CiAgICAgIHJldHVybiAiTWl4ZWRSZWFkV3JpdGUiOwogICAgY2FzZSAzOgogICAgICByZXR1cm4gIlJlYWQiOwogIH0KfQpmdW5jdGlvbiBjcmVhdGVDb21wb25lbnQoY29tcG9uZW50LCBvcHRpb25zKSB7CiAgbmdEZXZNb2RlICYmIGFzc2VydENvbXBvbmVudERlZihjb21wb25lbnQpOwogIGNvbnN0IGNvbXBvbmVudERlZiA9IGdldENvbXBvbmVudERlZihjb21wb25lbnQpOwogIGNvbnN0IGVsZW1lbnRJbmplY3RvciA9IG9wdGlvbnMuZWxlbWVudEluamVjdG9yIHx8IGdldE51bGxJbmplY3RvcigpOwogIGNvbnN0IGZhY3RvcnkgPSBuZXcgQ29tcG9uZW50RmFjdG9yeTIoY29tcG9uZW50RGVmKTsKICByZXR1cm4gZmFjdG9yeS5jcmVhdGUoZWxlbWVudEluamVjdG9yLCBvcHRpb25zLnByb2plY3RhYmxlTm9kZXMsIG9wdGlvbnMuaG9zdEVsZW1lbnQsIG9wdGlvbnMuZW52aXJvbm1lbnRJbmplY3Rvciwgb3B0aW9ucy5kaXJlY3RpdmVzLCBvcHRpb25zLmJpbmRpbmdzKTsKfQpmdW5jdGlvbiByZWZsZWN0Q29tcG9uZW50VHlwZShjb21wb25lbnQpIHsKICBjb25zdCBjb21wb25lbnREZWYgPSBnZXRDb21wb25lbnREZWYoY29tcG9uZW50KTsKICBpZiAoIWNvbXBvbmVudERlZikgcmV0dXJuIG51bGw7CiAgY29uc3QgZmFjdG9yeSA9IG5ldyBDb21wb25lbnRGYWN0b3J5Mihjb21wb25lbnREZWYpOwogIHJldHVybiB7CiAgICBnZXQgc2VsZWN0b3IoKSB7CiAgICAgIHJldHVybiBmYWN0b3J5LnNlbGVjdG9yOwogICAgfSwKICAgIGdldCB0eXBlKCkgewogICAgICByZXR1cm4gZmFjdG9yeS5jb21wb25lbnRUeXBlOwogICAgfSwKICAgIGdldCBpbnB1dHMoKSB7CiAgICAgIHJldHVybiBmYWN0b3J5LmlucHV0czsKICAgIH0sCiAgICBnZXQgb3V0cHV0cygpIHsKICAgICAgcmV0dXJuIGZhY3Rvcnkub3V0cHV0czsKICAgIH0sCiAgICBnZXQgbmdDb250ZW50U2VsZWN0b3JzKCkgewogICAgICByZXR1cm4gZmFjdG9yeS5uZ0NvbnRlbnRTZWxlY3RvcnM7CiAgICB9LAogICAgZ2V0IGlzU3RhbmRhbG9uZSgpIHsKICAgICAgcmV0dXJuIGNvbXBvbmVudERlZi5zdGFuZGFsb25lOwogICAgfSwKICAgIGdldCBpc1NpZ25hbCgpIHsKICAgICAgcmV0dXJuIGNvbXBvbmVudERlZi5zaWduYWxzOwogICAgfQogIH07Cn0KZnVuY3Rpb24gbWVyZ2VBcHBsaWNhdGlvbkNvbmZpZyguLi5jb25maWdzKSB7CiAgcmV0dXJuIGNvbmZpZ3MucmVkdWNlKChwcmV2LCBjdXJyKSA9PiB7CiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcmV2LCBjdXJyLCB7CiAgICAgIHByb3ZpZGVyczogWy4uLnByZXYucHJvdmlkZXJzLCAuLi5jdXJyLnByb3ZpZGVyc10KICAgIH0pOwogIH0sIHsKICAgIHByb3ZpZGVyczogW10KICB9KTsKfQp2YXIgUkVRVUVTVCA9IG5ldyBJbmplY3Rpb25Ub2tlbih0eXBlb2YgbmdEZXZNb2RlID09PSAidW5kZWZpbmVkIiB8fCBuZ0Rldk1vZGUgPyAiUkVRVUVTVCIgOiAiIiwgewogIHByb3ZpZGVkSW46ICJwbGF0Zm9ybSIsCiAgZmFjdG9yeTogKCkgPT4gbnVsbAp9KTsKdmFyIFJFU1BPTlNFX0lOSVQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIlJFU1BPTlNFX0lOSVQiIDogIiIsIHsKICBwcm92aWRlZEluOiAicGxhdGZvcm0iLAogIGZhY3Rvcnk6ICgpID0+IG51bGwKfSk7CnZhciBSRVFVRVNUX0NPTlRFWFQgPSBuZXcgSW5qZWN0aW9uVG9rZW4odHlwZW9mIG5nRGV2TW9kZSA9PT0gInVuZGVmaW5lZCIgfHwgbmdEZXZNb2RlID8gIlJFUVVFU1RfQ09OVEVYVCIgOiAiIiwgewogIHByb3ZpZGVkSW46ICJwbGF0Zm9ybSIsCiAgZmFjdG9yeTogKCkgPT4gbnVsbAp9KTsKCmV4cG9ydCB7CiAgX19zcHJlYWRWYWx1ZXMsCiAgX19zcHJlYWRQcm9wcywKICBfX29ialJlc3QsCiAgU0lHTkFMLAogIFN1YnNjcmlwdGlvbiwKICBwaXBlLAogIE9ic2VydmFibGUsCiAgU3ViamVjdCwKICBCZWhhdmlvclN1YmplY3QsCiAgRU1QVFksCiAgZnJvbSwKICBvZiwKICB0aHJvd0Vycm9yLAogIGlzT2JzZXJ2YWJsZSwKICBFbXB0eUVycm9yLAogIG1hcCwKICBjb21iaW5lTGF0ZXN0LAogIG1lcmdlTWFwLAogIG1lcmdlQWxsLAogIGNvbmNhdCwKICBkZWZlciwKICBmb3JrSm9pbiwKICBmaWx0ZXIsCiAgY2F0Y2hFcnJvciwKICBjb25jYXRNYXAsCiAgdGFrZSwKICBmaW5hbGl6ZSwKICBmaXJzdCwKICB0YWtlTGFzdCwKICBzdGFydFdpdGgsCiAgc3dpdGNoTWFwLAogIHRha2VVbnRpbCwKICB0YXAsCiAgc2V0Q3VycmVudEluamVjdG9yLAogIHNldEFsdGVybmF0ZVdlYWtSZWZJbXBsLAogIFZlcnNpb24sCiAgVkVSU0lPTiwKICBYU1NfU0VDVVJJVFlfVVJMLAogIFJ1bnRpbWVFcnJvciwKICBmb3JtYXRSdW50aW1lRXJyb3IsCiAgX2dsb2JhbCwKICBzdHJpbmdpZnksCiAgdHJ1bmNhdGVNaWRkbGUsCiAgZm9yd2FyZFJlZiwKICByZXNvbHZlRm9yd2FyZFJlZiwKICDJtcm1ZGVmaW5lSW5qZWN0YWJsZSwKICDJtcm1ZGVmaW5lSW5qZWN0b3IsCiAgZ2V0SW5qZWN0YWJsZURlZiwKICBpc0luamVjdGFibGUsCiAgTkdfUFJPVl9ERUYsCiAgTkdfSU5KX0RFRiwKICBJbmplY3Rpb25Ub2tlbiwKICBzZXRJbmplY3RvclByb2ZpbGVyQ29udGV4dCwKICBpc0Vudmlyb25tZW50UHJvdmlkZXJzLAogIE5HX0NPTVBfREVGLAogIE5HX0RJUl9ERUYsCiAgTkdfUElQRV9ERUYsCiAgTkdfTU9EX0RFRiwKICBOR19FTEVNRU5UX0lELAogIGdldENvbXBvbmVudERlZiwKICBpc1N0YW5kYWxvbmUsCiAgybXJtWluamVjdCwKICDJtcm1aW52YWxpZEZhY3RvcnlEZXAsCiAgaW5qZWN0MiBhcyBpbmplY3QsCiAgY29udmVydFRvQml0RmxhZ3MsCiAgRU5WSVJPTk1FTlRfSU5JVElBTElaRVIsCiAgSU5KRUNUT1IkMSwKICBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMsCiAgcHJvdmlkZUVudmlyb25tZW50SW5pdGlhbGl6ZXIsCiAgaW1wb3J0UHJvdmlkZXJzRnJvbSwKICBJTkpFQ1RPUl9TQ09QRSwKICBFbnZpcm9ubWVudEluamVjdG9yLAogIFIzSW5qZWN0b3IsCiAgcnVuSW5JbmplY3Rpb25Db250ZXh0LAogIGFzc2VydEluSW5qZWN0aW9uQ29udGV4dCwKICBDT05UQUlORVJfSEVBREVSX09GRlNFVCwKICBzdG9yZSwKICDJtcm1ZW5hYmxlQmluZGluZ3MsCiAgybXJtWRpc2FibGVCaW5kaW5ncywKICDJtcm1cmVzdG9yZVZpZXcsCiAgybXJtXJlc2V0VmlldywKICDJtcm1bmFtZXNwYWNlU1ZHLAogIMm1ybVuYW1lc3BhY2VNYXRoTUwsCiAgybXJtW5hbWVzcGFjZUhUTUwsCiAgY3JlYXRlSW5qZWN0b3IsCiAgSW5qZWN0b3IsCiAgRE9DVU1FTlQsCiAgRGVzdHJveVJlZiwKICBQZW5kaW5nVGFza3NJbnRlcm5hbCwKICBFdmVudEVtaXR0ZXIsCiAgTmdab25lLAogIE5vb3BOZ1pvbmUsCiAgRXJyb3JIYW5kbGVyLAogIElOVEVSTkFMX0FQUExJQ0FUSU9OX0VSUk9SX0hBTkRMRVIsCiAgcHJvdmlkZUJyb3dzZXJHbG9iYWxFcnJvckxpc3RlbmVycywKICDJtXVud3JhcFdyaXRhYmxlU2lnbmFsLAogIHNpZ25hbCwKICBhc3NlcnROb3RJblJlYWN0aXZlQ29udGV4dCwKICBDaGFuZ2VEZXRlY3Rpb25TY2hlZHVsZXIsCiAgWk9ORUxFU1NfRU5BQkxFRCwKICBQUk9WSURFRF9aT05FTEVTUywKICBQZW5kaW5nVGFza3MsCiAgRWZmZWN0U2NoZWR1bGVyLAogIGVmZmVjdCwKICB1bnRyYWNrZWQyIGFzIHVudHJhY2tlZCwKICBub1NpZGVFZmZlY3RzLAogIEluamVjdCwKICBPcHRpb25hbCwKICBTZWxmLAogIFNraXBTZWxmLAogIEhvc3QsCiAgVHlwZSwKICBSZWZsZWN0aW9uQ2FwYWJpbGl0aWVzLAogIFNpbXBsZUNoYW5nZSwKICDJtcm1TmdPbkNoYW5nZXNGZWF0dXJlLAogIFByb2ZpbGVyRXZlbnQsCiAgybXJtWdldEluaGVyaXRlZEZhY3RvcnksCiAgybXJtWluamVjdEF0dHJpYnV0ZSwKICBBdHRyaWJ1dGUyIGFzIEF0dHJpYnV0ZSwKICBJbmplY3RhYmxlLAogIEVsZW1lbnRSZWYsCiAgUXVlcnlMaXN0LAogIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LAogIExDb250ZXh0LAogIGdldExDb250ZXh0LAogIGdldERpcmVjdGl2ZXMsCiAgQWN4Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksCiAgQWN4Vmlld0VuY2Fwc3VsYXRpb24sCiAgZ2V0SG9zdEVsZW1lbnQsCiAgc2V0RG9jdW1lbnQsCiAgZ2V0RG9jdW1lbnQsCiAgQVBQX0lELAogIFBMQVRGT1JNX0lOSVRJQUxJWkVSLAogIFBMQVRGT1JNX0lELAogIEFOSU1BVElPTl9NT0RVTEVfVFlQRSwKICBDU1BfTk9OQ0UsCiAgSU1BR0VfQ09ORklHX0RFRkFVTFRTLAogIElNQUdFX0NPTkZJRywKICBtYWtlU3RhdGVLZXksCiAgVHJhbnNmZXJTdGF0ZSwKICBJU19IWURSQVRJT05fRE9NX1JFVVNFX0VOQUJMRUQsCiAgRVZFTlRfUkVQTEFZX1FVRVVFLAogIElTX0lOQ1JFTUVOVEFMX0hZRFJBVElPTl9FTkFCTEVELAogIEpTQUNUSU9OX0JMT0NLX0VMRU1FTlRfTUFQLAogIElTX0VOQUJMRURfQkxPQ0tJTkdfSU5JVElBTF9OQVZJR0FUSU9OLAogIEpTQUNUSU9OX0VWRU5UX0NPTlRSQUNULAogIERFSFlEUkFURURfQkxPQ0tfUkVHSVNUUlksCiAgU1NSX0NPTlRFTlRfSU5URUdSSVRZX01BUktFUiwKICBIeWRyYXRpb25TdGF0dXMsCiAgcmVhZEh5ZHJhdGlvbkluZm8sCiAgcmVzZXRJbmNyZW1lbnRhbEh5ZHJhdGlvbkVuYWJsZWRXYXJuZWRGb3JUZXN0cywKICBWaWV3RW5jYXBzdWxhdGlvbiwKICBDVVNUT01fRUxFTUVOVFNfU0NIRU1BLAogIE5PX0VSUk9SU19TQ0hFTUEsCiAgybVzZXRVbmtub3duRWxlbWVudFN0cmljdE1vZGUsCiAgybVnZXRVbmtub3duRWxlbWVudFN0cmljdE1vZGUsCiAgybVzZXRVbmtub3duUHJvcGVydHlTdHJpY3RNb2RlLAogIMm1Z2V0VW5rbm93blByb3BlcnR5U3RyaWN0TW9kZSwKICB1bndyYXBTYWZlVmFsdWUsCiAgYWxsb3dTYW5pdGl6YXRpb25CeXBhc3NBbmRUaHJvdywKICBnZXRTYW5pdGl6YXRpb25CeXBhc3NUeXBlLAogIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0SHRtbCwKICBieXBhc3NTYW5pdGl6YXRpb25UcnVzdFN0eWxlLAogIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0U2NyaXB0LAogIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0VXJsLAogIGJ5cGFzc1Nhbml0aXphdGlvblRydXN0UmVzb3VyY2VVcmwsCiAgX3Nhbml0aXplVXJsLAogIF9zYW5pdGl6ZUh0bWwsCiAgU2VjdXJpdHlDb250ZXh0LAogIMm1ybVzYW5pdGl6ZUh0bWwsCiAgybXJtXNhbml0aXplU3R5bGUsCiAgybXJtXNhbml0aXplVXJsLAogIMm1ybVzYW5pdGl6ZVJlc291cmNlVXJsLAogIMm1ybVzYW5pdGl6ZVNjcmlwdCwKICDJtcm1dHJ1c3RDb25zdGFudEh0bWwsCiAgybXJtXRydXN0Q29uc3RhbnRSZXNvdXJjZVVybCwKICDJtcm1c2FuaXRpemVVcmxPclJlc291cmNlVXJsLAogIMm1ybV2YWxpZGF0ZUF0dHJpYnV0ZSwKICBwcm92aWRlTmdSZWZsZWN0QXR0cmlidXRlcywKICDJtcm1cmVzb2x2ZVdpbmRvdywKICDJtcm1cmVzb2x2ZURvY3VtZW50LAogIMm1ybVyZXNvbHZlQm9keSwKICBOT19DSEFOR0UsCiAgybXJtWFkdmFuY2UsCiAgUmVuZGVyZXJTdHlsZUZsYWdzMiwKICBhbGxMZWF2aW5nQW5pbWF0aW9ucywKICBUcmFjaW5nQWN0aW9uLAogIFRyYWNpbmdTZXJ2aWNlLAogIHBlcmZvcm1hbmNlTWFya0ZlYXR1cmUsCiAgQWZ0ZXJSZW5kZXJNYW5hZ2VyLAogIGFmdGVyRXZlcnlSZW5kZXIsCiAgYWZ0ZXJOZXh0UmVuZGVyLAogIFZpZXdSZWYsCiAgaXNWaWV3RGlydHksCiAgbWFya0ZvclJlZnJlc2gsCiAgVGVtcGxhdGVSZWYsCiAgQ29tcG9uZW50UmVmJDEsCiAgQ29tcG9uZW50RmFjdG9yeSQxLAogIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciQxLAogIFJlbmRlcmVyRmFjdG9yeTIsCiAgUmVuZGVyZXIyLAogIFNhbml0aXplciwKICBpc05nTW9kdWxlLAogIGRlcHNUcmFja2VyLAogIE5PVF9GT1VORF9DSEVDS19PTkxZX0VMRU1FTlRfSU5KRUNUT1IsCiAgybXJtWRpcmVjdGl2ZUluamVjdCwKICDJtcm1aW52YWxpZEZhY3RvcnksCiAgZGV2TW9kZUVxdWFsLAogIMm1Q09OVFJPTCwKICBpbnB1dEJpbmRpbmcsCiAgb3V0cHV0QmluZGluZywKICB0d29XYXlCaW5kaW5nLAogIGluZmVyVGFnTmFtZUZyb21EZWZpbml0aW9uLAogIENvbXBvbmVudEZhY3RvcnkyIGFzIENvbXBvbmVudEZhY3RvcnksCiAgQ29tcG9uZW50UmVmMiBhcyBDb21wb25lbnRSZWYsCiAgVmlld0NvbnRhaW5lclJlZiwKICByZXNvbHZlQ29tcG9uZW50UmVzb3VyY2VzLAogIGlzQ29tcG9uZW50RGVmUGVuZGluZ1Jlc29sdXRpb24sCiAgY2xlYXJSZXNvbHV0aW9uT2ZDb21wb25lbnRSZXNvdXJjZXNRdWV1ZSwKICByZXN0b3JlQ29tcG9uZW50UmVzb2x1dGlvblF1ZXVlLAogIHJlZ2lzdGVyTmdNb2R1bGVUeXBlLAogIHNldEFsbG93RHVwbGljYXRlTmdNb2R1bGVJZHNGb3JUZXN0LAogIE5nTW9kdWxlUmVmJDEsCiAgTmdNb2R1bGVGYWN0b3J5JDEsCiAgY3JlYXRlTmdNb2R1bGUsCiAgY3JlYXRlTmdNb2R1bGVSZWYsCiAgTmdNb2R1bGVSZWYyIGFzIE5nTW9kdWxlUmVmLAogIE5nTW9kdWxlRmFjdG9yeTIgYXMgTmdNb2R1bGVGYWN0b3J5LAogIGNyZWF0ZUVudmlyb25tZW50SW5qZWN0b3IsCiAgybXJtWRlZmluZUNvbXBvbmVudCwKICDJtcm1ZGVmaW5lTmdNb2R1bGUsCiAgybXJtWRlZmluZURpcmVjdGl2ZSwKICDJtcm1ZGVmaW5lUGlwZSwKICDJtcm1SG9zdERpcmVjdGl2ZXNGZWF0dXJlLAogIMm1ybVJbmhlcml0RGVmaW5pdGlvbkZlYXR1cmUsCiAgybXJtXRlbXBsYXRlLAogIMm1ybVkb21UZW1wbGF0ZSwKICBEZWZlckJsb2NrU3RhdGUsCiAgRGVmZXJCbG9ja0JlaGF2aW9yLAogIFRpbWVyU2NoZWR1bGVyLAogIERFRkVSX0JMT0NLX0RFUEVOREVOQ1lfSU5URVJDRVBUT1IsCiAgREVGRVJfQkxPQ0tfQ09ORklHLAogIHJlbmRlckRlZmVyQmxvY2tTdGF0ZSwKICDJtcm1ZGVmZXJFbmFibGVUaW1lclNjaGVkdWxpbmcsCiAgZ2V0QXN5bmNDbGFzc01ldGFkYXRhRm4sCiAgc2V0Q2xhc3NNZXRhZGF0YUFzeW5jLAogIHNldENsYXNzTWV0YWRhdGEsCiAgQ29uc29sZSwKICBpc1NpZ25hbDIgYXMgaXNTaWduYWwsCiAgaXNXcml0YWJsZVNpZ25hbCwKICBnZXREZWZlckJsb2NrcyQxLAogIGVuYWJsZVByb2ZpbGluZywKICBnZXRUcmFuc2ZlclN0YXRlLAogIHB1Ymxpc2hFeHRlcm5hbEdsb2JhbFV0aWwsCiAgVEVTVEFCSUxJVFksCiAgVEVTVEFCSUxJVFlfR0VUVEVSLAogIFRlc3RhYmlsaXR5LAogIFRlc3RhYmlsaXR5UmVnaXN0cnksCiAgc2V0VGVzdGFiaWxpdHlHZXR0ZXIsCiAgaXNQcm9taXNlMiBhcyBpc1Byb21pc2UsCiAgaXNTdWJzY3JpYmFibGUsCiAgQVBQX0lOSVRJQUxJWkVSLAogIHByb3ZpZGVBcHBJbml0aWFsaXplciwKICBBcHBsaWNhdGlvbkluaXRTdGF0dXMsCiAgQVBQX0JPT1RTVFJBUF9MSVNURU5FUiwKICBpc0JvdW5kVG9Nb2R1bGUsCiAgQXBwbGljYXRpb25SZWYsCiAgcHJvbWlzZVdpdGhSZXNvbHZlcnMsCiAgdHJpZ2dlclJlc291cmNlTG9hZGluZywKICDJtcm1ZGVmZXIsCiAgybXJtWRlZmVyV2hlbiwKICDJtcm1ZGVmZXJQcmVmZXRjaFdoZW4sCiAgybXJtWRlZmVySHlkcmF0ZVdoZW4sCiAgybXJtWRlZmVySHlkcmF0ZU5ldmVyLAogIMm1ybVkZWZlck9uSWRsZSwKICDJtcm1ZGVmZXJQcmVmZXRjaE9uSWRsZSwKICDJtcm1ZGVmZXJIeWRyYXRlT25JZGxlLAogIMm1ybVkZWZlck9uSW1tZWRpYXRlLAogIMm1ybVkZWZlclByZWZldGNoT25JbW1lZGlhdGUsCiAgybXJtWRlZmVySHlkcmF0ZU9uSW1tZWRpYXRlLAogIMm1ybVkZWZlck9uVGltZXIsCiAgybXJtWRlZmVyUHJlZmV0Y2hPblRpbWVyLAogIMm1ybVkZWZlckh5ZHJhdGVPblRpbWVyLAogIMm1ybVkZWZlck9uSG92ZXIsCiAgybXJtWRlZmVyUHJlZmV0Y2hPbkhvdmVyLAogIMm1ybVkZWZlckh5ZHJhdGVPbkhvdmVyLAogIMm1ybVkZWZlck9uSW50ZXJhY3Rpb24sCiAgybXJtWRlZmVyUHJlZmV0Y2hPbkludGVyYWN0aW9uLAogIMm1ybVkZWZlckh5ZHJhdGVPbkludGVyYWN0aW9uLAogIMm1ybVkZWZlck9uVmlld3BvcnQsCiAgybXJtWRlZmVyUHJlZmV0Y2hPblZpZXdwb3J0LAogIMm1ybVkZWZlckh5ZHJhdGVPblZpZXdwb3J0LAogIMm1ybVhcmlhUHJvcGVydHksCiAgybXJtWF0dHJpYnV0ZSwKICBBTklNQVRJT05TX0RJU0FCTEVELAogIE1BWF9BTklNQVRJT05fVElNRU9VVCwKICDJtcm1YW5pbWF0ZUVudGVyLAogIMm1ybVhbmltYXRlRW50ZXJMaXN0ZW5lciwKICDJtcm1YW5pbWF0ZUxlYXZlLAogIMm1ybVhbmltYXRlTGVhdmVMaXN0ZW5lciwKICDJtcm1Y29tcG9uZW50SW5zdGFuY2UsCiAgybXJtWNvbnRyb2xDcmVhdGUsCiAgybXJtWNvbnRyb2wsCiAgybVjb250cm9sVXBkYXRlLAogIMm1ybVjb25kaXRpb25hbENyZWF0ZSwKICDJtcm1Y29uZGl0aW9uYWxCcmFuY2hDcmVhdGUsCiAgybXJtWNvbmRpdGlvbmFsLAogIMm1ybVyZXBlYXRlclRyYWNrQnlJbmRleCwKICDJtcm1cmVwZWF0ZXJUcmFja0J5SWRlbnRpdHksCiAgybXJtXJlcGVhdGVyQ3JlYXRlLAogIMm1ybVyZXBlYXRlciwKICDJtcm1cHJvcGVydHksCiAgybXJtWVsZW1lbnRTdGFydCwKICDJtcm1ZWxlbWVudEVuZCwKICDJtcm1ZWxlbWVudCwKICDJtcm1ZG9tRWxlbWVudFN0YXJ0LAogIMm1ybVkb21FbGVtZW50RW5kLAogIMm1ybVkb21FbGVtZW50LAogIMm1ybVlbGVtZW50Q29udGFpbmVyU3RhcnQsCiAgybXJtWVsZW1lbnRDb250YWluZXJFbmQsCiAgybXJtWVsZW1lbnRDb250YWluZXIsCiAgybXJtWRvbUVsZW1lbnRDb250YWluZXJTdGFydCwKICDJtcm1ZG9tRWxlbWVudENvbnRhaW5lckVuZCwKICDJtcm1ZG9tRWxlbWVudENvbnRhaW5lciwKICDJtcm1Z2V0Q3VycmVudFZpZXcsCiAgybXJtWRvbVByb3BlcnR5LAogIMm1ybVzeW50aGV0aWNIb3N0UHJvcGVydHksCiAgcmVnaXN0ZXJMb2NhbGVEYXRhLAogIGZpbmRMb2NhbGVEYXRhLAogIGdldExvY2FsZUN1cnJlbmN5Q29kZSwKICBnZXRMb2NhbGVQbHVyYWxDYXNlLAogIHVucmVnaXN0ZXJBbGxMb2NhbGVEYXRhLAogIExvY2FsZURhdGFJbmRleCwKICBERUZBVUxUX0xPQ0FMRV9JRCwKICBzZXRMb2NhbGVJZCwKICDJtcm1aTE4blN0YXJ0LAogIMm1ybVpMThuRW5kLAogIMm1ybVpMThuLAogIMm1ybVpMThuQXR0cmlidXRlcywKICDJtcm1aTE4bkV4cCwKICDJtcm1aTE4bkFwcGx5LAogIMm1ybVpMThuUG9zdHByb2Nlc3MsCiAgybXJtWxpc3RlbmVyLAogIMm1ybVzeW50aGV0aWNIb3N0TGlzdGVuZXIsCiAgybXJtWRvbUxpc3RlbmVyLAogIMm1ybVuZXh0Q29udGV4dCwKICDJtcm1cHJvamVjdGlvbkRlZiwKICDJtcm1cHJvamVjdGlvbiwKICDJtcm1Y29udGVudFF1ZXJ5LAogIMm1ybV2aWV3UXVlcnksCiAgybXJtXF1ZXJ5UmVmcmVzaCwKICDJtcm1bG9hZFF1ZXJ5LAogIMm1ybVjb250ZW50UXVlcnlTaWduYWwsCiAgybXJtXZpZXdRdWVyeVNpZ25hbCwKICDJtcm1cXVlcnlBZHZhbmNlLAogIMm1ybVyZWZlcmVuY2UsCiAgybXJtXN0eWxlUHJvcCwKICDJtcm1Y2xhc3NQcm9wLAogIMm1ybVzdHlsZU1hcCwKICDJtcm1Y2xhc3NNYXAsCiAgybXJtXRleHQsCiAgybXJtXRleHRJbnRlcnBvbGF0ZSwKICDJtcm1dGV4dEludGVycG9sYXRlMSwKICDJtcm1dGV4dEludGVycG9sYXRlMiwKICDJtcm1dGV4dEludGVycG9sYXRlMywKICDJtcm1dGV4dEludGVycG9sYXRlNCwKICDJtcm1dGV4dEludGVycG9sYXRlNSwKICDJtcm1dGV4dEludGVycG9sYXRlNiwKICDJtcm1dGV4dEludGVycG9sYXRlNywKICDJtcm1dGV4dEludGVycG9sYXRlOCwKICDJtcm1dGV4dEludGVycG9sYXRlViwKICDJtcm1dHdvV2F5UHJvcGVydHksCiAgybXJtXR3b1dheUJpbmRpbmdTZXQsCiAgybXJtXR3b1dheUxpc3RlbmVyLAogIMm1ybVkZWNsYXJlTGV0LAogIMm1ybVzdG9yZUxldCwKICDJtcm1cmVhZENvbnRleHRMZXQsCiAgybXJtWF0dGFjaFNvdXJjZUxvY2F0aW9ucywKICDJtcm1aW50ZXJwb2xhdGUsCiAgybXJtWludGVycG9sYXRlMSwKICDJtcm1aW50ZXJwb2xhdGUyLAogIMm1ybVpbnRlcnBvbGF0ZTMsCiAgybXJtWludGVycG9sYXRlNCwKICDJtcm1aW50ZXJwb2xhdGU1LAogIMm1ybVpbnRlcnBvbGF0ZTYsCiAgybXJtWludGVycG9sYXRlNywKICDJtcm1aW50ZXJwb2xhdGU4LAogIMm1ybVpbnRlcnBvbGF0ZVYsCiAgybXJtVByb3ZpZGVyc0ZlYXR1cmUsCiAgybXJtUV4dGVybmFsU3R5bGVzRmVhdHVyZSwKICDJtcm1c2V0Q29tcG9uZW50U2NvcGUsCiAgybXJtXNldE5nTW9kdWxlU2NvcGUsCiAgybXJtXB1cmVGdW5jdGlvbjAsCiAgybXJtXB1cmVGdW5jdGlvbjEsCiAgybXJtXB1cmVGdW5jdGlvbjIsCiAgybXJtXB1cmVGdW5jdGlvbjMsCiAgybXJtXB1cmVGdW5jdGlvbjQsCiAgybXJtXB1cmVGdW5jdGlvbjUsCiAgybXJtXB1cmVGdW5jdGlvbjYsCiAgybXJtXB1cmVGdW5jdGlvbjcsCiAgybXJtXB1cmVGdW5jdGlvbjgsCiAgybXJtXB1cmVGdW5jdGlvblYsCiAgybXJtXBpcGUsCiAgybXJtXBpcGVCaW5kMSwKICDJtcm1cGlwZUJpbmQyLAogIMm1ybVwaXBlQmluZDMsCiAgybXJtXBpcGVCaW5kNCwKICDJtcm1cGlwZUJpbmRWLAogIMm1ybV0ZW1wbGF0ZVJlZkV4dHJhY3RvciwKICDJtcm1Z2V0Q29tcG9uZW50RGVwc0ZhY3RvcnksCiAgybVzZXRDbGFzc0RlYnVnSW5mbywKICDJtcm1Z2V0UmVwbGFjZU1ldGFkYXRhVVJMLAogIMm1ybVyZXBsYWNlTWV0YWRhdGEsCiAgcmVzZXRKaXRPcHRpb25zLAogIGZsdXNoTW9kdWxlU2NvcGluZ1F1ZXVlQXNNdWNoQXNQb3NzaWJsZSwKICBjb21waWxlTmdNb2R1bGUsCiAgY29tcGlsZU5nTW9kdWxlRGVmcywKICBnZW5lcmF0ZVN0YW5kYWxvbmVJbkRlY2xhcmF0aW9uc0Vycm9yLAogIHJlc2V0Q29tcGlsZWRDb21wb25lbnRzLAogIHBhdGNoQ29tcG9uZW50RGVmV2l0aFNjb3BlLAogIHRyYW5zaXRpdmVTY29wZXNGb3IsCiAgY29tcGlsZUNvbXBvbmVudCwKICBjb21waWxlRGlyZWN0aXZlLAogIGNvbXBpbGVQaXBlLAogIERpcmVjdGl2ZSwKICBDb21wb25lbnQsCiAgUGlwZSwKICBJbnB1dCwKICBPdXRwdXQsCiAgSG9zdEJpbmRpbmcsCiAgSG9zdExpc3RlbmVyLAogIE5nTW9kdWxlLAogIE1vZHVsZVdpdGhDb21wb25lbnRGYWN0b3JpZXMsCiAgQ29tcGlsZXIsCiAgQ09NUElMRVJfT1BUSU9OUywKICBDb21waWxlckZhY3RvcnksCiAgcHJvdmlkZVpvbmVsZXNzQ2hhbmdlRGV0ZWN0aW9uLAogIHByb3ZpZGVab25lbGVzc0NoYW5nZURldGVjdGlvbkludGVybmFsLAogIExPQ0FMRV9JRCwKICBERUZBVUxUX0NVUlJFTkNZX0NPREUsCiAgVFJBTlNMQVRJT05TLAogIFRSQU5TTEFUSU9OU19GT1JNQVQsCiAgTWlzc2luZ1RyYW5zbGF0aW9uU3RyYXRlZ3ksCiAgRGVidWdFdmVudExpc3RlbmVyLAogIGFzTmF0aXZlRWxlbWVudHMsCiAgRGVidWdOb2RlLAogIERlYnVnRWxlbWVudCwKICBnZXREZWJ1Z05vZGUsCiAgT3V0cHV0RW1pdHRlclJlZiwKICBnZXRPdXRwdXREZXN0cm95UmVmLAogIGNvbXB1dGVkLAogIGxpbmtlZFNpZ25hbCwKICByZXNvdXJjZSwKICBSZXNvdXJjZUltcGwsCiAgZW5jYXBzdWxhdGVSZXNvdXJjZUVycm9yLAogIMm1SU5QVVRfU0lHTkFMX0JSQU5EX1dSSVRFX1RZUEUsCiAgRmFjdG9yeVRhcmdldCwKICBGcmFtZXdvcmssCiAgSG9zdEF0dHJpYnV0ZVRva2VuLAogIEhPU1RfVEFHX05BTUUsCiAgb3V0cHV0LAogIGlucHV0LAogIHZpZXdDaGlsZCwKICB2aWV3Q2hpbGRyZW4sCiAgY29udGVudENoaWxkLAogIGNvbnRlbnRDaGlsZHJlbiwKICBtb2RlbCwKICBRdWVyeSwKICBDb250ZW50Q2hpbGRyZW4sCiAgQ29udGVudENoaWxkLAogIFZpZXdDaGlsZHJlbiwKICBWaWV3Q2hpbGQsCiAgY29tcGlsZU5nTW9kdWxlRmFjdG9yeSwKICBQUk9WSURFRF9OR19aT05FLAogIGludGVybmFsUHJvdmlkZVpvbmVDaGFuZ2VEZXRlY3Rpb24sCiAgcHJvdmlkZVpvbmVDaGFuZ2VEZXRlY3Rpb24sCiAgRU5BQkxFX1JPT1RfQ09NUE9ORU5UX0JPT1RTVFJBUCwKICBQbGF0Zm9ybVJlZiwKICBjcmVhdGVQbGF0Zm9ybSwKICBjcmVhdGVQbGF0Zm9ybUZhY3RvcnksCiAgYXNzZXJ0UGxhdGZvcm0sCiAgZ2V0UGxhdGZvcm0sCiAgZGVzdHJveVBsYXRmb3JtLAogIGNyZWF0ZU9yUmV1c2VQbGF0Zm9ybUluamVjdG9yLAogIHByb3ZpZGVQbGF0Zm9ybUluaXRpYWxpemVyLAogIHByb3ZpZGVDaGVja05vQ2hhbmdlc0NvbmZpZywKICBpc0Rldk1vZGUsCiAgZW5hYmxlUHJvZE1vZGUsCiAgd2l0aEV2ZW50UmVwbGF5LAogIENMSUVOVF9SRU5ERVJfTU9ERV9GTEFHLAogIHdpdGhEb21IeWRyYXRpb24sCiAgd2l0aEkxOG5TdXBwb3J0LAogIHdpdGhJbmNyZW1lbnRhbEh5ZHJhdGlvbiwKICBwcm92aWRlU3RhYmlsaXR5RGVidWdnaW5nLAogIGdldE1vZHVsZUZhY3RvcnksCiAgZ2V0TmdNb2R1bGVCeUlkLAogIENoYW5nZURldGVjdG9yUmVmLAogIGluamVjdENoYW5nZURldGVjdG9yUmVmLAogIFZpZXdSZWYyLAogIEVtYmVkZGVkVmlld1JlZiwKICBEZWZhdWx0SXRlcmFibGVEaWZmZXIsCiAgSXRlcmFibGVEaWZmZXJzLAogIEtleVZhbHVlRGlmZmVycywKICBkZWZhdWx0SXRlcmFibGVEaWZmZXJzLAogIGRlZmF1bHRLZXlWYWx1ZURpZmZlcnMsCiAgcGxhdGZvcm1Db3JlLAogIEFwcGxpY2F0aW9uTW9kdWxlLAogIGludGVybmFsQ3JlYXRlQXBwbGljYXRpb24sCiAgYW5ub3RhdGVGb3JIeWRyYXRpb24sCiAgYm9vbGVhbkF0dHJpYnV0ZSwKICBudW1iZXJBdHRyaWJ1dGUsCiAgUEVSRk9STUFOQ0VfTUFSS19QUkVGSVgsCiAgc3RhcnRNZWFzdXJpbmcsCiAgc3RvcE1lYXN1cmluZywKICBlbmFibGVQcm9maWxpbmcyLAogIGRpc2FibGVQcm9maWxpbmcsCiAgZ2V0Q2xvc2VzdENvbXBvbmVudE5hbWUsCiAgybVhc3NlcnRUeXBlLAogIMm1ybVuZ0RlY2xhcmVEaXJlY3RpdmUsCiAgybXJtW5nRGVjbGFyZUNsYXNzTWV0YWRhdGEsCiAgybXJtW5nRGVjbGFyZUNsYXNzTWV0YWRhdGFBc3luYywKICDJtcm1bmdEZWNsYXJlQ29tcG9uZW50LAogIMm1ybVuZ0RlY2xhcmVGYWN0b3J5LAogIMm1ybVuZ0RlY2xhcmVJbmplY3RhYmxlLAogIMm1ybVuZ0RlY2xhcmVJbmplY3RvciwKICDJtcm1bmdEZWNsYXJlTmdNb2R1bGUsCiAgybXJtW5nRGVjbGFyZVBpcGUsCiAgYWZ0ZXJSZW5kZXJFZmZlY3QsCiAgY3JlYXRlQ29tcG9uZW50LAogIHJlZmxlY3RDb21wb25lbnRUeXBlLAogIG1lcmdlQXBwbGljYXRpb25Db25maWcsCiAgUkVRVUVTVCwKICBSRVNQT05TRV9JTklULAogIFJFUVVFU1RfQ09OVEVYVAp9OwovLyMgc291cmNlTWFwcGluZ1VSTD1jaHVuay1MRUhSWjdJSy5qcy5tYXAK",
            "encoding": "base64"
          },
          "redirectURL": "",
          "headersSize": -1,
          "bodySize": 0,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.243Z",
        "time": 12.471000023651868,
        "timings": {
          "blocked": 9.237999973002822,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 0.5109999877177179,
          "receive": 2.722000062931329,
          "_blocked_queueing": 9.161999973002821,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "createConnection",
                "scriptId": "6",
                "url": "http://localhost:4200/@vite/client",
                "lineNumber": 744,
                "columnNumber": 26
              },
              {
                "functionName": "connect",
                "scriptId": "6",
                "url": "http://localhost:4200/@vite/client",
                "lineNumber": 410,
                "columnNumber": 26
              },
              {
                "functionName": "connect",
                "scriptId": "6",
                "url": "http://localhost:4200/@vite/client",
                "lineNumber": 750,
                "columnNumber": 22
              },
              {
                "functionName": "connect",
                "scriptId": "6",
                "url": "http://localhost:4200/@vite/client",
                "lineNumber": 288,
                "columnNumber": 22
              },
              {
                "functionName": "connect",
                "scriptId": "6",
                "url": "http://localhost:4200/@vite/client",
                "lineNumber": 372,
                "columnNumber": 44
              },
              {
                "functionName": "",
                "scriptId": "6",
                "url": "http://localhost:4200/@vite/client",
                "lineNumber": 822,
                "columnNumber": 10
              }
            ]
          }
        },
        "_priority": null,
        "_resourceType": "websocket",
        "_webSocketMessages": [
          {
            "type": "receive",
            "time": 1770598270.256177,
            "opcode": 1,
            "data": "{\"type\":\"connected\"}"
          }
        ],
        "cache": {},
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "ws://localhost:4200/?token=hXrsy4jP80NF",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Upgrade",
              "value": "websocket"
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "no-cache"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Pragma",
              "value": "no-cache"
            },
            {
              "name": "Connection",
              "value": "Upgrade"
            },
            {
              "name": "Sec-WebSocket-Key",
              "value": "VKab5Tt7+/wPVlNJpkP35Q=="
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "Sec-WebSocket-Version",
              "value": "13"
            },
            {
              "name": "Sec-WebSocket-Protocol",
              "value": "vite-hmr"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "Sec-WebSocket-Extensions",
              "value": "permessage-deflate; client_max_window_bits"
            }
          ],
          "queryString": [
            {
              "name": "token",
              "value": "hXrsy4jP80NF"
            }
          ],
          "cookies": [],
          "headersSize": 590,
          "bodySize": 0
        },
        "response": {
          "status": 101,
          "statusText": "Switching Protocols",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Upgrade",
              "value": "websocket"
            },
            {
              "name": "Sec-WebSocket-Protocol",
              "value": "vite-hmr"
            },
            {
              "name": "Sec-WebSocket-Accept",
              "value": "WASCnM2uFGl8xApGCJOPDmBMDRU="
            },
            {
              "name": "Connection",
              "value": "Upgrade"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "x-unknown",
            "compression": 163
          },
          "redirectURL": "",
          "headersSize": 163,
          "bodySize": -163,
          "_transferSize": 0,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "",
        "startedDateTime": "2026-02-09T00:51:10.254Z",
        "time": 1.4380000066012144,
        "timings": {
          "blocked": -1,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0,
          "wait": 1.4380000066012144,
          "receive": 0,
          "_blocked_queueing": -1
        }
      },
      {
        "_connectionId": "16111",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "App_HmrLoad",
                "scriptId": "7",
                "url": "http://localhost:4200/main.js",
                "lineNumber": 136,
                "columnNumber": 6
              },
              {
                "functionName": "",
                "scriptId": "7",
                "url": "http://localhost:4200/main.js",
                "lineNumber": 139,
                "columnNumber": 53
              },
              {
                "functionName": "",
                "scriptId": "7",
                "url": "http://localhost:4200/main.js",
                "lineNumber": 141,
                "columnNumber": 2
              }
            ]
          }
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@ng/component?c=src%2Fapp%2Fapp.ts%40App&t=1770598270297",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/main.js"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [
            {
              "name": "c",
              "value": "src%2Fapp%2Fapp.ts%40App"
            },
            {
              "name": "t",
              "value": "1770598270297"
            }
          ],
          "cookies": [],
          "headersSize": 628,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "no-cache"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Content-Length",
              "value": "0"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "text/javascript",
            "compression": 0,
            "text": ""
          },
          "redirectURL": "",
          "headersSize": 244,
          "bodySize": 0,
          "_transferSize": 244,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.298Z",
        "time": 1.5189999830909073,
        "timings": {
          "blocked": 0.705000017311424,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.09399999999999997,
          "wait": 0.5089999889358878,
          "receive": 0.2109999768435955,
          "_blocked_queueing": 0.438000017311424,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      },
      {
        "_connectionId": "16111",
        "_initiator": {
          "type": "script",
          "stack": {
            "callFrames": [
              {
                "functionName": "LoginComponent_HmrLoad",
                "scriptId": "8",
                "url": "http://localhost:4200/chunk-K7W62EAA.js",
                "lineNumber": 111,
                "columnNumber": 6
              },
              {
                "functionName": "",
                "scriptId": "8",
                "url": "http://localhost:4200/chunk-K7W62EAA.js",
                "lineNumber": 114,
                "columnNumber": 53
              },
              {
                "functionName": "",
                "scriptId": "8",
                "url": "http://localhost:4200/chunk-K7W62EAA.js",
                "lineNumber": 116,
                "columnNumber": 2
              }
            ]
          }
        },
        "_priority": "High",
        "_resourceType": "script",
        "cache": {},
        "connection": "4200",
        "pageref": "page_46",
        "request": {
          "method": "GET",
          "url": "http://localhost:4200/@ng/component?c=src%2Fapp%2Fpages%2Flogin%2Flogin.component.ts%40LoginComponent&t=1770598270329",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br, zstd"
            },
            {
              "name": "Accept-Language",
              "value": "fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Host",
              "value": "localhost:4200"
            },
            {
              "name": "Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Referer",
              "value": "http://localhost:4200/chunk-K7W62EAA.js"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "script"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Google Chrome\";v=\"144\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            }
          ],
          "queryString": [
            {
              "name": "c",
              "value": "src%2Fapp%2Fpages%2Flogin%2Flogin.component.ts%40LoginComponent"
            },
            {
              "name": "t",
              "value": "1770598270329"
            }
          ],
          "cookies": [],
          "headersSize": 677,
          "bodySize": 0
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Access-Control-Allow-Origin",
              "value": "http://localhost:4200"
            },
            {
              "name": "Cache-Control",
              "value": "no-cache"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Content-Length",
              "value": "0"
            },
            {
              "name": "Content-Type",
              "value": "text/javascript"
            },
            {
              "name": "Date",
              "value": "Mon, 09 Feb 2026 00:51:10 GMT"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=5"
            },
            {
              "name": "Vary",
              "value": "Origin"
            }
          ],
          "cookies": [],
          "content": {
            "size": 0,
            "mimeType": "text/javascript",
            "compression": 0,
            "text": ""
          },
          "redirectURL": "",
          "headersSize": 244,
          "bodySize": 0,
          "_transferSize": 244,
          "_error": null,
          "_fetchedViaServiceWorker": false
        },
        "serverIPAddress": "[::1]",
        "startedDateTime": "2026-02-09T00:51:10.329Z",
        "time": 17.212999984622,
        "timings": {
          "blocked": 1.7910000208094716,
          "dns": -1,
          "ssl": -1,
          "connect": -1,
          "send": 0.17599999999999993,
          "wait": 14.992000008791685,
          "receive": 0.25399995502084494,
          "_blocked_queueing": 1.3940000208094716,
          "_workerStart": -1,
          "_workerReady": -1,
          "_workerFetchStart": -1,
          "_workerRespondWithSettled": -1
        }
      }
    ]
  }
}